Summary,Issue key,Issue id,Issue Type,Status,Project key,Project name,Project type,Project lead,Project lead id,Project description,Project url,Priority,Resolution,Assignee,Assignee Id,Reporter,Reporter Id,Creator,Creator Id,Created,Updated,Last Viewed,Resolved,Fix versions,Components,Due date,Votes,Labels,Labels,Labels,Description,Environment,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Watchers Id,Original estimate,Remaining Estimate,Time Spent,Work Ratio,Σ Original Estimate,Σ Remaining Estimate,Σ Time Spent,Security Level,Inward issue link (Cloners),Outward issue link (Cloners),Inward issue link (Duplicate),Outward issue link (Duplicate),Inward issue link (Relates),Inward issue link (Relates),Outward issue link (Relates),Outward issue link (Relates),Inward issue link (Resolve),Outward issue link (Resolve),Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Attachment,Custom field (APAR),Custom field (Account Create Date),Custom field (Account Environment),Custom field (Account Name/UID),Custom field (Account Owner),Custom field (Account Requester),Custom field (Adjusted Risk Rating),Custom field (Advisory ID),Custom field (Affected Package),Custom field (Affected services),Custom field (Assets Impacted),Custom field (Assigned Team),Custom field (Attached CIE),Custom field (Attachment count),Custom field (Attack Complexity),Custom field (Attack Complexity Explanation),Custom field (Attack Vector),Custom field (Attack Vector Explanation),Custom field (Automated Test Written),Custom field (Autotest Result),Custom field (Baseline end date),Custom field (Baseline start date),Custom field (Beta Plan),Custom field (Bugs of Epic count),Custom field (Bugs of Epic in Done status category count),Custom field (Bugs of Epic in In Progress status category count),Custom field (Bugs of Epic in To Do status category count),Custom field (Build Result URL),Custom field (CBI Version),Custom field (CVS Scores),Custom field (CVSS V3 Risk Rating),Custom field (Case),Custom field (Case Next Action),Custom field (Category),Custom field (Cert Alias),Custom field (Cert Component),Custom field (Cert Create Date),Custom field (Cert Type),Custom field (Change Approver),Custom field (Change Category),Custom field (Change Impact),Custom field (Change Impact Assessment),Custom field (Change Procedures),Custom field (Change Start Date-Time),Custom field (Checklist Completed),Custom field (Checklist Content YAML),Custom field (Checklist Progress),Custom field (Checklist Progress %),Custom field (Checklist Text),Custom field (Checklist Text (view-only)),Custom field (Children of Epic count),Custom field (Children of Epic in Done status category count),Custom field (Children of Epic in In Progress status category count),Custom field (Children of Epic in To Do status category count),Custom field (Comment count),Custom field (Commitment Status),Custom field (Committed CVEs),Custom field (Compass),Custom field (Component Shared),Custom field (Critsit),Custom field (Current L2 Owner),Custom field (Current L2 Owner)Id,Custom field (Custom Due date),Custom field (Customer Commitment),Custom field (Customer Followups),Custom field (Customer Name),Custom field (Customer Requested),Custom field (Customer Root Cause),Custom field (Customer Summary),Custom field (Customer Timeline),Custom field (Customer affected),Custom field (DR Rationale),Custom field (DR Submission Date),Custom field (Deployer),Custom field (Deployment End Date),Custom field (Deployment Log),Custom field (Deployment Start Date),Custom field (Deployment Steps),Custom field (Design Lead / Manager),Custom field (Design Lead / Manager)Id,Custom field (Designer),Custom field (Detection),Custom field (Development),Custom field (Deviation Type),Custom field (Device (hostname)),Custom field (Disclosure Disposition),Custom field (Disclosure Link),Custom field (Domain),Custom field (Duration),Custom field (End Date),Custom field (End date),Custom field (Environment),Custom field (Event Impact Duration),Custom field (Evidence Description),Custom field (Expire Date),Custom field (FED Resource),Custom field (FIPS enabled),Custom field (Finding #),Custom field (Five Whys),Custom field (Fix can be automated?),Custom field (Fixpack),Custom field (Followup Actions),Custom field (Found in Feds.xml File),Custom field (Full Team Name),Custom field (Hostname),Custom field (IP Address),Custom field (Impact Metrics: Availability),Custom field (Impact Metrics: Availability Explanation),Custom field (Impact Metrics: Confidentiality),Custom field (Impact Metrics: Confidentiality Explanation),Custom field (Impact Metrics: Integrity),Custom field (Impact Metrics: Integrity Explanation),Custom field (Incident Event Date),Custom field (Incident Start Date/Time),Custom field (Integration Contact Email),Custom field (Interim Corrective Actions (ICAs)),Custom field (Interim fixpack),Custom field (Is Code Blue),Custom field (Issue color),Custom field (Issue link count),Custom field (Keystore File Location),Custom field (Keystore Name),Custom field (LTC Bugzilla),Custom field (Last Certified Date),Custom field (License Key),Custom field (Location URL),Custom field (Locked forms),Custom field (MCP Package Location),Custom field (Manual Regression Result),Custom field (Need Statement),Custom field (No. of Sprints),Custom field (Non-Prod Verified),Custom field (Notes DB ID),Custom field (Notification Sender),Custom field (OS),Custom field (OS),Custom field (OS),Custom field (OS Details),Custom field (Open forms),Custom field (Operational Impact Statement),Custom field (Original Risk Rating),Custom field (Overall Progress),Custom field (PSIRT Record ID),Custom field (PSIRT Release Type),Custom field (Planned Deployement Date),Custom field (Privileges Required),Custom field (Privileges Required Explanation),Custom field (Projected Start Date),Custom field (Rank),Custom field (Record ID),Custom field (Remediation Date),Custom field (Remediation Extension Date),Custom field (Remediation Level),Custom field (Remediation Level Explanation),Custom field (Remedy-SOC Ticket #),Custom field (Request Type),Custom field (Request language),Custom field (Request participants),Custom field (Resolution Process),Custom field (Respond and Restore),Custom field (Response Due),Custom field (Restart),Custom field (Revision),Custom field (Risk),Custom field (Rollback Plan),Custom field (Rollback Procedures),Custom field (Rollback instructions),Custom field (Root Cause),Custom field (Rundeck Application Name),Custom field (SDS Version Details),Custom field (SDS_Version),Custom field (SHA),Custom field (Salesforce Ticket #),Satisfaction rating,Custom field (Scan Report Date),Custom field (Scan Results),Custom field (Secondary Reviewer),Custom field (Security Impact),Custom field (Serial Number),Custom field (Servers),Custom field (Services affected),Custom field (Severity),Custom field (Slack Channel),Custom field (Source Type),Custom field (Source of Discovery),Sprint,Custom field (Start date),Custom field (Stories of Epic count),Custom field (Stories of Epic in Done status category count),Custom field (Stories of Epic in In Progress status category count),Custom field (Stories of Epic in To Do status category count),Custom field (Story Points),Custom field (Story point estimate),Custom field (Submitted forms),Custom field (Subtask count),Custom field (Synopsis / Impact),Custom field (TFIM Partner),Custom field (Target Date),Custom field (Target Shipped Sprint),Custom field (Target end),Custom field (Target start),Custom field (Task progress),Custom field (Team),Custom field (Technical Approver),Custom field (Test Procedures),Custom field (Testing Resource),Custom field (Timeline),Custom field (Total forms),Custom field (URL),Custom field (Unique Integration ID),Custom field (Updated by users count),Custom field (User Interaction),Custom field (User Interaction Explanation),Custom field (Valid From),Custom field (Validation Steps),Custom field (Versions),Custom field (Versions),Custom field (Versions),Custom field (Versions),Custom field (Versions),Custom field (Versions),Custom field (Versions),Custom field (Versions),Custom field (Versions),Custom field (Vulnerability Description),Custom field (Vulnerability Name),Custom field (Vulnerability Reference ID),Custom field (Web Application Name),Custom field ([CHART] Date of First Response),Custom field (cert_type),Custom field (myURL),Custom field (myURL-not used),Custom field (myURL-not used),Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Comment,Status Category
"ISVA logs to QRadar show ""unconfigured"" hostname",ISAMSUP-5108,304066,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Highest,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,31/May/23 11:55 PM,15/Jun/23 10:09 PM,14/Jul/23 2:47 PM,15/Jun/23 10:09 PM,,,,0,,,,"Customer having issue with  Post upgrading webseal to ISVA 10.0.5 logs are not flowing to Qradar. Remote
Syslog Forwarding to Qradar is not happening after ISVA 10.0.5 upgrade. They are using UDP protocol.

Also they have open the case with Qradar team and confirmed in their system servername is coming as ""unconfigured"" for the upgraded ISVA appliances.

After checking the support file we have some findings

After checking /var/application.logs/rsyslog_forwarder/ it shows the error below:

{noformat}rsyslogd: omfwd/udp: socket 24: sendto() error: Network is unreachable [v8.2102.0-7.el8.1.ibm.1 try https://www.rsyslog.com/e/2354  ]
rsyslogd: omfwd: socket 24: error 101 sending via udp: Network is unreachable [v8.2102.0-7.el8.1.ibm.1 try https://www.rsyslog.com/e/2354  ]{noformat}

So in their config we see

{noformat}<?xml version=""1.0"" encoding=""UTF-8"" standalone=""yes""?>
<policy xmlns=""http://www.iss.net/isam/rsyslog_forwarder"" name=""rsyslog_forwarder2_0_0"" version=""2.0.0"" schema-version=""2.0.0"" valid=""true"" overwrite=""true"">
    <servers>
        <server server=""10.22.25.32"" port=""514"" protocol=""udp"" format=""rfc-3164"" debug=""false"">
            <sources>
                <source name=""WebSEAL:ivr-nestscheme:msg__webseald-ivr-nestscheme.log"" tag=""PRL_nestIVR_MSG Logs"" facility=""syslog"" severity=""warning""/>
                <source name=""WebSEAL:ivr-nestscheme:request.log"" tag=""PRL_nestIVR_Request Logs"" facility=""syslog"" severity=""warning""/>
            </sources>
        </server>
    </servers>
</policy>{noformat}



and looking at the support.txt I see some udp connections to that address



{noformat}udp        0      0 10.22.30.26:43516       10.22.25.32:514         ESTABLISHED
udp        0      0 10.22.30.26:60307       10.24.25.32:514         ESTABLISHED{noformat}

So we requested (PCAP) to start a network trace with

""host 10.22.25.32""

and access webseal to make sure events are generated, then wait maybe 3 or 4 minutes, and collect the data

Customer update that there is nothing getting blocked at network level. Post upgrade from ISVA 10.0.2 to 10.0.5 only they are facing this logs are not pushing to Qradar issue. Since our logs are not getting captured now this is having huge impact.

Attached support file in the link below:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013174330&path=TS013174330%2F2023-05-31%2F&filepath=TS013174330%2F2023-05-31%2FMicrosoftTeams-image_44_.png|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013174330&path=TS013174330%2F2023-05-31%2F&filepath=TS013174330%2F2023-05-31%2FMicrosoftTeams-image_44_.png]

The Fixpacks the customer already have 10.0.2.0_IF1.log,10.0.2.0_IF1.log and remove_pgsymbolic_link.login V 10.0.5.0

Below screenshot the hostname showing as unconfigured in the syslog entries. How to get a fix for this?

!Screenshot 2023-05-31 at 16.10.40.png|width=1921,height=721!",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,01/Jun/23 1:14 AM;ug:0d611a25-0ff2-486d-afc9-64342bb96b9c;Screenshot 2023-05-31 at 16.10.40.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/203362,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013174330,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,TATA CONSULTANCY SERVICES,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1c9kf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-31 15:29:35.427,,,,,01/Jun/23 1:29 AM;5b15d94b6256d01ad54eb020;Does it show unconfigured when you logon to the LMI?    Usually a reboot resolves that.,"01/Jun/23 3:03 AM;5b15d9e44c4ed14b83af8723;I’m assisting with this Sev1 now. I’ve asked the customer to login to the CLI and check the hostname that is shown. I’ve also asked for a network trace or debug rsyslog files to show whether the problem originates on the ISVA appliance.

I’m wondering if the issue is the same issue that was resolved in this v10.0.3.1 fixpack: [https://cloudidentity.atlassian.net/browse/ISAMSUP-4267?search_id=27f8f5b6-ce1e-45f9-97a3-5d4fb7fdfb5b|https://cloudidentity.atlassian.net/browse/ISAMSUP-4267?search_id=27f8f5b6-ce1e-45f9-97a3-5d4fb7fdfb5b|smart-link] ","01/Jun/23 3:35 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9e44c4ed14b83af8723] I’m doubting it’s a network problem since they have a udp connection. Also, I looked at the support file earlier the rsyslog errors that were mentioned in the description are from a few days ago. Nothing more recent.  However, it is worth checking anyway.

They  can also run a test from the LMI using  System->Test Connection","01/Jun/23 3:43 AM;5b15d9e44c4ed14b83af8723;[~accountid:5b15d94b6256d01ad54eb020] Agreed, I don’t think it’s a network problem either. All of the talk about network stuff has clouded the issue. But since they are using UDP, we should be able to see if ISVA is sending in the “unconfigured” value in the network trace. That’s the only reason why I’ve requested the network trace from the customer.",01/Jun/23 3:59 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9e44c4ed14b83af8723] that’s a good point.  That’s why I wanted to know  what the CLI shows. If it showed unconfigured then I’m sure we would send events using that name too.,15/Jun/23 10:09 PM;5ac57757d9a96536d1f0daa9;Case associated with this Jira item has been closed. Setting this items status to Done to reflect this. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Allstate Development Environment crashes with High CPU usage and then unconfigured appliance state,ISAMSUP-5065,299027,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Highest,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,11/May/23 10:13 AM,31/May/23 10:08 AM,14/Jul/23 2:47 PM,31/May/23 10:08 AM,,Support,,0,,,,"Allstate has a development appliance at 10.0.3.1 that is an All-In-One appliance with 6 Reverse Proxy instances, AAC JVM, and LMI + ISVA Runtime running on the machine.



After upgrading to 10.0.3.1 to 10.0.2.0 ",,David Hayes,jcyarbor,khansen,Nick Lloyd,Rachel Tomas,tonyferg,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,70121:0ba4f8fa-8042-4ac9-914a-4a02dabc3187,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5064,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012969633,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,oscar.jimen,6333216f748d1bfcb85982ca,,,,Allstate Insurance Company,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1be1r:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-05-11 22:59:13.523,,,,,"11/May/23 10:18 AM;5bac25aaabfcbf73d13e733b;Data in question for review:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012969633&path=TS012969633/2023-05-10/&filepath=TS012969633/2023-05-10/isva_10.0.3.1_20230510-125458_vap1019.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012969633&path=TS012969633/2023-05-10/&filepath=TS012969633/2023-05-10/isva_10.0.3.1_20230510-125458_vap1019.support]

Already told the customer they were blowing out their memory super hard with their current configuration.

Suggested the following updates:

{noformat}[system-environment-variables]
...
GLIBC_TUNABLES=glibc.malloc.tcache_count=0

...

[ssl]
...
jct-gsk-attr-name = enum:4003:1{noformat}","11/May/23 10:18 AM;5bac25aaabfcbf73d13e733b;Customer had not updated the two proxy instances with largest amount of junctions (1000+, compozed*) before the issue occurred again.","11/May/23 10:26 AM;5bac25aaabfcbf73d13e733b;Excerpt from ‘support.txt’ from support file uploaded below:

{noformat}+ top -b -n1 -m
Mem total:65900344 anon:44753276 map:223636 free:6753132
 slab:415316 buf:82972 cache:13149672 dirty:467140 write:0
Swap total:0 free:0
  PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
 2758 16.0g 15.7g 15.0g 43388 15.0g     0   128 /opt/pdweb/bin/webseald -config etc/webseald-compozed_a_e_rp13.conf -foreground -noenv
 2798 15.8g 13.5g 12.8g 43444 12.8g     0   132 /opt/pdweb/bin/webseald -config etc/webseald-compozed_a_e_rp23.conf -foreground -noenv
 2222 10.8g 1646m  737m 62100  639m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
 28332 9192m 4780m 1841m 68356 1768m     0   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms4096m -Xmx4096m -Dcom.sun.security.enableCRLDP=true-Dsun.net.maxDatagramSockets=4096 -Djdk.security.allowNonCaAnchor=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.package
 2778 8823m 6047m 5550m 43608 5507m     0   128 /opt/pdweb/bin/webseald -config etc/webseald-dev_ag_rp11.conf -foreground -noenv
 2818 8512m 6024m 5527m 43396 5485m     0   128 /opt/pdweb/bin/webseald -config etc/webseald-dev_ag_rp21.conf -foreground -noenv
 2843 4907m 1204m  741m 43232  698m     0   132 /opt/pdweb/bin/webseald -config etc/webseald-dev_emp_rp12.conf -foreground -noenv
 2868 4906m 1084m  651m 43584  608m     0   132 /opt/pdweb/bin/webseald -config etc/webseald-dev_emp_rp22.conf -foreground -noenv
 2585 2255m 1186m 71320 29740 41456     0   132 /opt/PolicyDirector/bin/pdmgrd -foreground
 1980 1736m  130m 36804 26748  9136     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
...{noformat}

As you can see the processes in question are easily eating more than the available 64GB of RAM and it’s a hardware appliance so SWAP is disabled because of APAR IJ46112","11/May/23 10:28 AM;5bac25aaabfcbf73d13e733b;This is causing major outages due to 
A ) The appliance going unconfigured

B ) The amount of time to recover due to the embedded LDAP not being available in snapshots.

I’m having to restore their environment a second time today due to the appliance crashing and becoming unrecoverable.","11/May/23 2:31 PM;5bac25aaabfcbf73d13e733b;Okay, update.

They crashed another 2 times.

Finally they took a hardware appliance from their TPT environment and repurposed it to the development environment.

We were able to restore using a snapshot (including the embedded ldap data) on this repurposed appliance and they were returned to service as of 11 PM CST.

----

The following is the data recovered on the 9072 partition from the 10.0.3.1 partition when the appliance was originally unrecoverable:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012969633&path=TS012969633/2023-05-10/&filepath=TS012969633/2023-05-10/data.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012969633&path=TS012969633/2023-05-10/&filepath=TS012969633/2023-05-10/data.zip]

They reformatted all the partitions before we could get any more data.

The following is the data after the 1st rebuild:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012969633&path=TS012969633/2023-05-10/&filepath=TS012969633/2023-05-10/isva_10.0.3.1_20230510-125458_vap1019.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012969633&path=TS012969633/2023-05-10/&filepath=TS012969633/2023-05-10/isva_10.0.3.1_20230510-125458_vap1019.support]

The following is the data after the latest 2 rebuilds:
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012969633&path=TS012969633//&filepath=TS012969633//isva_10.0.3.1_20230511-001630_vap1019.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012969633&path=TS012969633//&filepath=TS012969633//isva_10.0.3.1_20230511-001630_vap1019.support]

I had them delete the ‘compozed_a_e_rp13’ instance as for some reason their 1.3 interface is not receiving any traffic and that plus the other instances eats all the VSZ (it has a VSZ of 16g and it’s counterpart is 15.5g).

When I got off the call they were in a working validated state.

Is the appliance simply overloaded causing file corruption when the memory hits 100%?

They were running with this configuration for over a year (slowly adding applications) so why are they having such issues in the past 3 days? 

I haven’t had a chance to dig into the data as most of my day was disaster recovery.",12/May/23 8:59 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] assigning this one to you to complete this initial investigations. I can see that Jack is providing a lot of good data points for us to review and investigate. Please let Dave and I know if we can support you in anyway. ,"12/May/23 9:38 AM;5bac25aaabfcbf73d13e733b;The 1.3 interface ended up being the switch shutting down or fluxuating. It’s working as expected now.

Allstate was able to run through the night and has not had any issues today.

They are going to restore a snapshot from 5/8 to get their imported groups back from the LDAP backup in the snapshot.

----

The two compozed instances both have 1000 worker threads and over 1000 junctions. Each junction has a dedicated worker thread per server for health checks. compozed_a_e_rp13 has 1050 junctions and compozed_a_e_rp23 has 1050 junctions.

|| ||*compozed_a_e_rp13*||*compozed_a_e_rp23*||
|junctions|1050|1052|
|junctioned servers|1063|1065|
|worker-threads|1000|1000|
|enable-http2|no|no|
|max-ratelimiting-buckets|16384| |
|[ldap] cache-enabled|yes, default values| |
|[ssl] ssl-max-entries|4096000| |
|[junction] max-cached-persistent-connections|10| |
|dynamic-addresses|yes| |
|dynamic-addresses-ttl|5| |
|[gso-cache] gso-cache-enabled|no| |
|[ltpa-cache] ltpa-cache-enabled, ltpa-cache-size, ltpa-cache-entry-lifetime, ltpa-cache-entry-idle-timeout|yes, 4096, 3600, 600| |
|[certificate] accept-client-certs, cert-cache-max-entries, cert-cache-timeout|prompt_as_needed, 1024, 120| |
|[tfim-cluster:oauth-cluster] handle-pool-size|10| |
|[session] max-entries, timeout, inactive-timeout|16384, 36000, 11100| |
|[content-cache]|image/* = memory:100000
application/x-javascript = memory:500000
text/css = memory:50000
application/x-shockwave-flash = memory:100000| |
|xslt-buffer-size|131072, 14 HTTP Transformation stanzas| |
|[websocket] max-worker-thread|200|200|

The high CPU usage at startup is probably due to the dynamic-addresses and dynamic-addresses-ttl through DNS queries.

If the new memory manager by default stores 7x memory then their TLS session cache value itself would make up ~7GB of their virtual size I’d say. Except, that’s per-thread.

So they have 1000 + 1065 + 200 + 300 (default 2ndary interface) + 1 (management thread) = 2566 worker threads * 450 KB which is ~ 1.1547 GB of RAM utilization just from worker threads.","12/May/23 9:41 AM;5b15d954b0d76456f36daf33;[~accountid:5bac25aaabfcbf73d13e733b] while I go through the details of the case and your updates, is there a specific ask of L3 at the moment?","12/May/23 9:52 AM;5bac25aaabfcbf73d13e733b;The main ask would be to review the ‘data.zip’ contents to confirm if we can tell why the appliance became unrecoverable.

When it became unrecoverable it would reboot to the 10.0.3.1 partition, you could log in as ‘admin’ to the ‘unconfigured.appliance’ wizard but when you went past the ‘Change Password’ option it would automatically restart the process and show up with the CLI login prompt.

If they had been able to get past this the whole recovery process would not have been an issue.","31/May/23 10:08 AM;5b15d954b0d76456f36daf33;[~accountid:5bac25aaabfcbf73d13e733b] 

The reason the appliance was in a bad state is because all the policy files could not be successfully translated into meaningful settings.

This is the reason under /etc you see a settings.tmp and settings.bad files, but not setting.txt. Also missing is the {{policies}} directory.

And going my the messages file:  

{noformat}May  9 18:48:42 mesa_control[1141]: Bootstrapping from settings
May  9 18:48:42 mesa_config[1156]: Bootstrapping
May  9 18:48:42 mesa_config[1156]: Enabling /etc/marker.custom.appliance_info.show by creating marker file.
May  9 18:48:42 mesa_config[1156]: Enabling /etc/marker.custom.cli.logs by creating marker file.
May  9 18:48:42 mesa_config[1156]: Error: Malformed tuning parameter at line 277
May  9 18:48:42 mesa_config[1156]: Error: Parsing failed
May  9 18:48:42 mesa_config[1156]: GLGSY0004E:: GLG_events:: ||
May  9 18:48:42 mesa_control[1141]: Error: Bootstrap from settings failed{noformat}

That line 277 entry from settings.bad is:

{noformat}dca.use_proxy=false{noformat}

which makes no sense to me to be honest.

The rest is easy to explain, once the bootsrtap from settings failed, the best we could do was to fallback to the default policy. That left the appliance in the first steps/unconfigured state.

That’s the best I got.

I see that the case itself is already resolved, so going to do the same with this item.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
DSess/services/DSess - causing ISAM to have slow responses and errors V10.0.4,ISAMSUP-5045,297678,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Highest,,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,04/May/23 8:11 PM,27/Jun/23 12:27 PM,14/Jul/23 2:47 PM,,10.0.7,Support,,0,,,,"This ticket is related to ISAM DSess session issue. 

Client opened a ticket: TS007891275

In this ticket they were at ISAM 9.0.7. This issue is not solved even, now we are on 10.0.4 version. 

We have added the support files, glowroot traces and printscreens. 



1.Issue seems about DSC , when federation runtime tried to call (during either token endpoint call or during /authsvc) it showed slowness upto 14 seconds

[2.|http://2.To]To review what is going on following data is collected( since I joined when appliance already started so couldn't collect java cores)

[3.|http://3.At]At present the following data request : Support file from all federation appliance and policy server appliance and one of the reverse proxy appliance

4.glowroot export

5.cpu /memory export for last 24 hours",,Dave Bachmann,David Hayes,Dermot Daly,gaozhiyu,Kerry Gunn,khansen,Nick Lloyd,Norton Brainard,Prabhjeet.Multani,prashant_kamat,Sumana Srinath Narasipur,tonyferg,Tushar Prasad,Virag Patel,Yutaka Kanemoto,5af0531368ebd52c36627c3b,5b232b2fd85e5b59b066f57f,6092ac9ff6c0960069d47a67,5bc692938f60c6286d183dd6,5b15d9f03993e9196502f607,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ff48f4aa9d0300107ccded2,627a7fb30d1e73006f7c21cf,5b15d9ef27631840ea300110,5af05450e6f95a2c1c89193d,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,5b15d9ec6d76184b7d989c83,,,,,,,,,,,,,ISAMSUP-5118,,,,ISAMSUP-5058,,13/Jun/23 12:25 PM;tushar.prasad;dscthreadll.txt;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/205684,09/May/23 4:40 PM;tushar.prasad;image-20230509-063829.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/199900,09/May/23 4:40 PM;tushar.prasad;image-20230509-063909.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/199899,12/May/23 8:51 PM;tushar.prasad;image-20230512-105059.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200505,20/May/23 6:01 PM;viragpatel;image-20230520-074825.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/201701,,,,,,,,,,,IJ47319,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012925605,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,RAIFFEISEN BANK S.A.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-06-08T16:28:00.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012925605&path=TS012925605%2F2023-05-04%2F&filepath=TS012925605%2F2023-05-04%2Ftrace-20230504-112856-292.zip,,,,,,,,,,,,,,,,,,,,,,,0|i1b5uv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-04 12:55:21.321,,,,,"04/May/23 10:55 PM;5c53d3ac23f5bf672621c868;HI

I have been with the customer but when I joined customer had already restarted the appliances

Environment:

Customer has Primary (127.116) , Secondary (127.117 ) and Quaternary (18.5) and tertiary (18.6) (Quaternry and tertiary are in DR network)

All support files taken post the appliance restart

Federation runtime running on 116 and 117 and two other appliances

116-> isva_10.0.4.0_20230504-121255_ciam-ps1.rbro.rbg.cc.support_unpack

117-> isva_10.0.4.0_20230504-121558_ciam-ps2.rbro.rbg.cc.support_unpack

fed runtime → isva_10.0.4.0_20230504-121738_ciam-ps4.rbro.rbg.cc.support_unpack

one of the rp → 

isva_10.0.4.0_20230504-122406_ciam-rp1.rbro.rbg.cc.support_unpack



fixpack details: Saturday, April 22, 2023 at 2:27:56 AM|10.0.4.0_IF1|10.0.4.0_IF1|Yes|Installed|This fixpack contains security and defect fixes for IBM Security Verify Access. Applying it will restart the appliance automatically.|1682119676





dsc details:

 <dsc worker_threads=""800"" maximum_session_lifetime=""3600"" client_grace_period=""600"" connection_idle_timeout=""0"">

rp session timeout is 3600

Federation session store is using legacy dsc configuration( they need to start using the update one)

customer has this trace enabled

com.tivoli.am.fim.utils.jdbc.*=FINEST



Few points:



1.every midnight customer needs to start appliance otherwise they get into the issue where DSC calls take time

This indicates perhaps they have memory leak. I don’t have data but will proceed to capture at next steps

However, there is an item already which discusses about dsc memory leak

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4925|https://cloudidentity.atlassian.net/browse/ISAMSUP-4925|smart-link] 

which is applicable to this env as customer is at 10.0.4.0 (does customer need a separate fixpack at IF1)



Still it doesn’t tell how would this memory leak will impact slowness","04/May/23 10:58 PM;5c53d3ac23f5bf672621c868;{noformat}Trace export
/sps/oauth/oauth20/introspect
CIAM-PS1-runtime
Transaction type: 	Web
Transaction name: 	/sps/oauth/oauth20/introspect
Start: 	2023-05-04 4:28:21.945 pm (+08:00)
Duration: 	9,875.6 milliseconds
Request http method: 	POST
Request parameters:
token_type_hint: 	access_token

token: 	VQZ9Ys
Response code: 	200
Breakdown:	total (ms)	count
http request
9,875.6	1
http client
2.7	3
jdbc query
1.9	4
jdbc commit
1.6	4
logging
0.77	58
jdbc get connection
0.050	4
 switch to tree view
JVM Thread Stats
CPU time: 58.9 milliseconds
Blocked time: 9,803.0 milliseconds
Waited time: 0.0 milliseconds

Trace entries (69)
Query stats (1)
Profile (10){noformat}

[https://ecurep.mainz.de.ibm.com/rest/download/TS012925605/2023-05-04/trace-20230504-112821-945.zip_unpack/trace-20230504-112821-945.html?fileSize=436560|https://ecurep.mainz.de.ibm.com/rest/download/TS012925605/2023-05-04/trace-20230504-112821-945.zip_unpack/trace-20230504-112821-945.html?fileSize=436560]","04/May/23 11:25 PM;61409dc154762c006932ffc7;client are on ISVA 10.0.4 and also installed Fix Pack 10.0.4.0 IF1.

The Slow traces problem start to appear around 11:15 Romanian Time.

The Reboot was done between 11:31 and 11:43 Romanian Time.

The Application was back online, with customer access, after 11:47",05/May/23 9:20 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9517dab4c51f61b5190] adding this one to your backlog as it is DSess specific. Can you please assess this and confirm if this is something that we can assist with. ,05/May/23 9:32 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9517dab4c51f61b5190] please note that this item is a Sev1. Appreciate your focus on this one today.,"05/May/23 11:19 AM;5b15d9517dab4c51f61b5190;I have identified an issue (IJ46634) in DSC in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4681|https://cloudidentity.atlassian.net/browse/ISAMSUP-4681|smart-link] and am currently working on a fix

The issue exists in all current versions",05/May/23 11:30 AM;5c53d3ac23f5bf672621c868;great thanks [~accountid:5b15d9517dab4c51f61b5190] ,"05/May/23 11:32 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9517dab4c51f61b5190] 

pls also consider:

If customer performs nightly restart daily they don’t face the issue. They were at 907X before and were doing a nightly restart for past 1 and half years. and that prevented the issue.

The moment they miss the nightly restart, the next or subsequent day they face slowness.","05/May/23 5:27 PM;5b15d9517dab4c51f61b5190;Following discussion on slack

We have recently fixed a memory leak issue in the DSC

The fixpack for 10.0.4.0 is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4925|https://cloudidentity.atlassian.net/browse/ISAMSUP-4925|smart-link] 

It should be applied immediately

I am currently working on IJ46634 and hope to have a fix next week

So the next steps will be to apply that fix

Can we get a support file from the Primary node shortly before the nightly restart","05/May/23 5:35 PM;5b15d9517dab4c51f61b5190;IJ46144  should be applied to all master nodes in a cluster - 1 at a time starting with the primary

The fixpack restarts the DSC - by sending an abort signal to running DSC

Immediately on restart DSC will retrieve all the sessions from the downstream master server

So the fixpack shouldnt be applied to the secondary until see the “Entering active mode.” message in the primary DSC log

Like

{noformat}2023-03-28-11:40:52.772+10:00I----- 0x38A0A26A /opt/dsc/bin/dscd WARNING wds server AMWSMSServer.cpp 1583 0x7f0d7b58f700 DPWDS0618W   Entering active mode.{noformat}

 ","06/May/23 12:17 AM;61409dc154762c006932ffc7;[~accountid:5b15d9517dab4c51f61b5190] the customer has applied fix in lower env and does not want to go live without maintenance window.



Also they have few questions

So this IJ46634 fix our issue? We need to know how it will solve our issue or more info about this fixpack, also how we can test it before we applied it to out production environment? We can't afford to setup a maintainence window without knowing for sure that it will solve this bug.","06/May/23 1:33 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9517dab4c51f61b5190] 

Customer had another instance around dsc (event nightly restart didn’t help)

they provided a support file just before restart



/ecurep/sf/TS012/925/TS012925605/2023-05-05/



All the appliances restarted to resolve the issue



Customer yet to apply memory fix.



can we expedite performance fix  ","06/May/23 1:58 AM;6092ac9ff6c0960069d47a67;[~accountid:5ac57757d9a96536d1f0daa9] and [~accountid:5b15d9517dab4c51f61b5190] , as per Tushar’s message below, customer experienced another outage so can we prioritise the performance fix?  Thanks","06/May/23 2:19 AM;5c53d3ac23f5bf672621c868;reviewed erros and seems config db was hit badly

requested customer to readjust the tuning asap

{noformat}Status:



1.Joined the call where the issue happened  and reviewed the support file and found that although calls to dsc were slow but due to internal config db ( it ran out of connection) causing complete failures) . 

configdb seems doesn't have basic tuning applied which would have prevented it.



reviewed some of the trace files opened



I saw this and alarm as this will cause failures in the env.



log severe: com.ibm.isam.scim.ScimServlet - Error encountered while attempting to ... nd(s) with 662 remaining waiting requests and 50 current total connections used.

Error encountered while attempting to set the SCIM request attributes : com.ibm.websphere.ce.cm.ConnectionWaitTimeoutException: J2CA0045E: Connection not available while invoking method createOrWaitForConnection for resource jdbc/config. Timed out waiting for 30,001 millisecond(s) with 662 remaining waiting requests and 50 current total connections used.



configuration database is an internal database and it seems you have running a default connections 



although DSC requests are slow, but these errors will cause the failures



log finer: c.t.a.f.u.jdbc.JdbcStatementUtils - RETURN



log severe: c.t.a.f.o.a.d.i.ClientInstanceDAOJdbcCacheImpl - java.lang.RuntimeExc ... .ibm.ws.rsadapter.AdapterUtil.toSQLException(AdapterUtil.java:854) ... 57 more

java.lang.RuntimeException: Cannot get a good connection from the database.

	at com.tivoli.am.fim.utils.sql.DataSourceWithRetry.getConnection(DataSourceWithRetry.java:166)

	at com.tivoli.am.fim.utils.sql.SQLExecutor.invoke(SQLExecutor.java:156)

	at com.tivoli.am.fim.utils.sql.SQLExecutor.select(SQLExecutor.java:96)

	at com.tivoli.am.fim.utils.sql.SQLExecutor.selectSingle(SQLExecutor.java:64)

	at com.tivoli.am.fim.liberty.rte.oconfig.dao.db.LazyDBOConfigDAO.getOConfigByExternalName(LazyDBOConfigDAO.java:145)

	at com.tivoli.am.fim.liberty.rte.oconfig.dao.db.CachingLazyDBOConfigDAO.getOConfigByExternalName(CachingLazyDBOConfigDAO.java:112)

	at com.tivoli.am.fim.utils.jdbc.JdbcStatementUtils.execute(JdbcStatementUtils.java:297)

	at com.tivoli.am.fim.utils.jdbc.JdbcStatementUtils.execute(JdbcStatementUtils.java:236)

	at com.tivoli.am.fim.utils.jdbc.JdbcStatementUtils.selectSingleResult(JdbcStatementUtils.java:99)

	at com.tivoli.am.fim.oauth20.appliance.dao.impl.ClientInstanceDAOJdbcImpl.getClientInstanceById(ClientInstanceDAOJdbcImpl.java:69)

	at com.tivoli.am.fim.oauth20.appliance.dao.impl.ClientInstanceDAOJdbcCacheImpl.getClientInstanceById(ClientInstanceDAOJdbcCacheImpl.java:77)

	at com.tivoli.am.rba.usc.handlers.UserAuthorizationGrantHandler.addClientName(UserAuthorizationGrantHandler.java:364)

	at com.tivoli.am.rba.usc.handlers.UserAuthorizationGrantHandler.grantDataToJson(UserAuthorizationGrantHandler.java:349)

	at com.tivoli.am.rba.usc.handlers.UserAuthorizationGrantHandler.getGrantJson(UserAuthorizationGrantHandler.java:331)

	at com.tivoli.am.rba.usc.handlers.UserAuthorizationGrantHandler.actionGet(UserAuthorizationGrantHandler.java:127)

	at com.tivoli.am.rba.usc.UserSelfCareDelegateProtocol.processRequest(UserSelfCareDelegateProtocol.java:146)

	at com.tivoli.am.fim.fedmgr2.proper.FederationManager.doInitialRequestOnDelegate(FederationManager.java:476)

	at com.tivoli.am.fim.fedmgr2.proper.FederationManager.finishProcessingWithDelegateId(FederationManager.java:311)

	at com.tivoli.am.fim.fedmgr2.proper.FederationManager.processRequest(FederationManager.java:164)

	at com.tivoli.am.fim.fedmgr2.servlet.SSOPSServletBase.doRequest(SSOPSServletBase.java:129)

	at com.tivoli.am.fim.fedmgr2.servlet.SPSCommandDispatcher.invoke(SPSCommandDispatcher.java:391)

	at com.tivoli.am.fim.war.runtime.liberty.LibertyRuntimeServlet.doGet(LibertyRuntimeServlet.java:56)

	at javax.servlet.http.H





---



You need to do the tuning of the config db ( seems you are at the basic tuning for config db and seems its under stress)





-----Here are the steps to apply the recommended tunings



isam_cluster.config.connectionManager.agedTimeout = 3600s
isam_cluster.config.connectionManager.connectionTimeout = 20s
isam_cluster.config.connectionManager.maxIdleTime = 300s
isam_cluster.config.connectionManager.maxPoolSize = 127
isam_cluster.config.connectionManager.minPoolSize = 10
isam_cluster.config.connectionManager.reapTime = 180s
isam_cluster.config.properties.blockingReadConnectionTimeout = 30s
isam_cluster.config.connectionManager.purgePolicy = FailingConnectionOnly
isam_cluster.config.connectionManager.enableSharingForDirectLookups : false
-------





This needs to be applied through Advanced tuning parameter on all Federation appliances, including masters ( needs to be done immediately)





Steps:

Goto LMI -> System settings -> Advanced Tuning Parameters

click on New



in the Key part  put --> isam_cluster.config.connectionManager.agedTimeout

In the value part put --> 3600s

similarly repeat for other parameters I listed above.










and deploy the changes and restart the Federation runtime



For restart of federation runtime 



LMI --> Federation -> runtime parameters -> Runtime status



restart the runtime from here





--





review 



https://www.ibm.com/docs/en/was-liberty/base?topic=SSEQTP_liberty/com.ibm.websphere.liberty.autogen.nd.doc/ae/rwlp_config_connectionManager.htm





Action Plan:



1.Customer will need to apply config db tuning ASAP



2.customer to review optional hvdb tuning



at present the max pool setting for hvdb is set to 100



customer can increase it to 300 or 400



by adding this Advanced tuning



isam_cluster.hvdb.connectionManager.maxPoolSize = 400
3.customer will continue to monitor process size and apply memory fix. {noformat}",06/May/23 2:58 AM;5c53d3ac23f5bf672621c868;recent failures looks to be caused by configdb issue. provided tuning parameters.,08/May/23 7:50 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9517dab4c51f61b5190] can we please push this one to the top of your backlog. I have added the escalated label to ensure that we are tracking this item more closely. ,08/May/23 3:59 PM;5b15d9517dab4c51f61b5190;Agree with [~accountid:5c53d3ac23f5bf672621c868] that recent failure was not related to DSC,"08/May/23 9:52 PM;61409dc154762c006932ffc7;the client has reported incident

and uploaded images before and after incident

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012925605&path=TS012925605%2F2023-05-08%2F&filepath=TS012925605%2F2023-05-08%2FAfter_the_restart.png.png|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012925605&path=TS012925605%2F2023-05-08%2F&filepath=TS012925605%2F2023-05-08%2FAfter_the_restart.png.png]",09/May/23 10:42 AM;5ac57757d9a96536d1f0daa9;[~accountid:61409dc154762c006932ffc7] can you please confirm that the latest incident is related to the DSC. If not can you please work with the customer to isolate what this new issue might be and assist them to isolate what this happening here. ,"09/May/23 12:30 PM;5c53d3ac23f5bf672621c868;[~accountid:5ac57757d9a96536d1f0daa9] 

1.I didn’t see any configdb issue yesterday( May 9 around 14.19 customer time)

*Caused by: com.ibm.websphere.ce.cm.ConnectionWaitTimeoutException: J2CA0045E: Connection not available while invoking method createOrWaitForConnection for resource jdbc/config. Timed out waiting for 30,000 millisecond(s) with 495 remaining waiting requests and 50 current total connections used.*

*at com.ibm.ws.rsadapter.AdapterUtil.toSQLException(AdapterUtil.java:854)*



2.here the DSC is not down but its response time increases to 14 to 18 seconds.

One of the source we use to identity is through glowroot reports . it seems its not uploaded to confirm that it was indeed DSC slowness.

I will request them to upload a report just before restart

----

--May  8 14:19:04 : starting pid 15058, tty '': '/etc/rc.shutdown'

May  8 14:19:32 mesa_config[15072]: All modules ready to shutdown after 1 seconds

May  8 14:21:12 : starting pid 9853, tty '': '/etc/rc.shutdown'

May  8 14:23:09 mesa_config[9867]: All modules ready to shutdown after 1 seconds

----

-","09/May/23 1:59 PM;5b15d9517dab4c51f61b5190;There are a large sockets in TIME_WAIT after connection to DSC (18260 socket_number__before.png)

This is due to the LMI->Cluster Configuration->session cache setting

Connection idle timeout  set to 0 

this is the dsc.conf line 

connection-idle-timeout = 0

With value 0 - DSC sends a http connection: close header in every response

causing every request to DSC to open a new setting

setting it to a non 0 value will allow sockets to be reused for multiple requests

It will keep the connection open for the idle-timeout period after a request to allow the connection to be reused

The DSC has a limit of 1000 requests over a persistent connection - will close the connection after 1000 requests no matter how large the connection-idle-timeout is

Recommend setting it to a small value like 5 seconds

This may help with response times","09/May/23 4:34 PM;5c53d3ac23f5bf672621c868;thanks [~accountid:5b15d9517dab4c51f61b5190] 

customer is also using dsess legacy setting for federation runtime

[https://www.ibm.com/docs/en/sva/10.0.4?topic=configuration-advanced-properties#aac_advcfgprop__d249e2114|https://www.ibm.com/docs/en/sva/10.0.4?topic=configuration-advanced-properties#aac_advcfgprop__d249e2114|smart-link] ","09/May/23 4:40 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9517dab4c51f61b5190] 



Customer has uploaded the glowroot



[https://ecurep.mainz.de.ibm.com/rest/download/TS012925605/2023-05-09/trace-20230508-141856-519.zip_unpack/trace-20230508-141856-519.html?fileSize=474036|https://ecurep.mainz.de.ibm.com/rest/download/TS012925605/2023-05-09/trace-20230508-141856-519.zip_unpack/trace-20230508-141856-519.html?fileSize=474036]



here is the sequence (a brief)

1.

!image-20230509-063829.png|width=833,height=369!



then towards the end there are these errors



!image-20230509-063909.png|width=1591,height=232!



seems to match with what was observed in last occurrences","10/May/23 12:23 PM;5c53d3ac23f5bf672621c868;# *Status*: *ISVA Case* -> *TS012925605* -> DSC slowness

# *Summary* : The environment is working fine today without any issue and no restart were required.
# customer applied the fix *IJ46144_10040.fixpack* on 8th may and they see stability in memory growth and have not faced the issue for now.

# *Action plan* : Customer monitoring the env

# The important recommendation is a tuning paramenter which will help DSC to resue the sockets *connection-idle-timeout=5* .This will help with performance and less socket usage

# *Action plan:* ( Customer yet to implement) They will update night of thursday or friday

# Customer already applied config db tuning -> no config db connection issue observed

# *Action plan*: Customer to continue to monitor

# failover-over-read=no and persistent-failover-on-read=no

# *Action plan*: customer chose to not apply and test in lower environment and do it later. Customer to update. Customer has been informed about the importance

# isam_cluster.hvdb.connectionManager.maxPoolSize = 400

# *Action Plan:* customer will test and apply later.Customer has been informed about the importance

# post Friday call with ISVA support customer has started to monitor DSC process using SNMP which helped them a lot

*Action Plan:* Customer to continue to monitor and await performance fix",10/May/23 2:53 PM;5b15d9517dab4c51f61b5190;The IJ46634 fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-5058|https://cloudidentity.atlassian.net/browse/ISAMSUP-5058|smart-link] ,"10/May/23 4:45 PM;5c53d3ac23f5bf672621c868;thanks [~accountid:5b15d9517dab4c51f61b5190] 



just to confirm 

1.this fix is compatible at 10.0.4.0 IF1

[2.|http://2.is] can be applied on top of the memory fix provided earlier

3. needs to be applied on all master nodes running DSC","10/May/23 5:33 PM;5c53d3ac23f5bf672621c868;From the descript:



1.This fix addresses both memory and performance fix

2.should be okay to just install on top of the old memory fix

3.since its dsess related. so should be applied on all master nodes, starting from primary

4 and looks to be compatible with 1041 IF1","10/May/23 7:13 PM;5b15d9517dab4c51f61b5190;Yes its ok to install on top of the old memory fix

(Its the same memory fix - I included it in case memory fix hadnt been applied - so would only need 1 fixpack)

Yes  apply on all master nodes, 1 at at time starting with the master

Wait for master to log the becoming active message in dscd.log  - before applying to secondary

Yes compatible with 10.0.4.0 IF1","11/May/23 4:16 PM;5c53d3ac23f5bf672621c868;current action plan suggested to the customer

----

----

{noformat}DSC issue Next Action plan
1.Customer to continue to install the performance fix IJ46634_10040IF1.fixpack. Provided on 10 May and we got confirmation that it was installed in pre live env. and we were waiting for it to be promoted to Production.
2.The Performance fix IJ46634_10040IF1.fixpack addresses . The fix addresses DSC race condition when sessions are expiring which will improve DSC responses to the requests. -> waiting for a confirmation when it will get applied
3.enable DSC local cache in Federation runtime. The federation runtime exposes option to maintain a local cache to store DSC sessions and that will help not to make frequent calls to DSC.
 3.1 DSC caching in federation runtime is enabled by using the configuration localCacheEnabled https://www.ibm.com/docs/en/sva/10.0.4?topic=configuration-advanced-properties
3.2 a note here
       distributedSessionCache.localCacheEnabled
A switch that dictates whether a local cache of distributed sessions is maintained. If this setting is disabled a higher load is placed on the distributed session cache server. The local cache should only be enabled if all requests from the same client is guaranteed to be sent to the same runtime server (otherwise known as stickiness). Session inconsistencies might occur if the local cache is enabled and stickiness is not maintained. All sessions are still stored in the distributed session cache when it is enabled.
Data type: Boolean
3.3 Steps to enable it
3.4 goto LMI of the primary master node and then to federation -> advanced configuration
3.5 distributedSessionCache.localCacheEnabled  -> set to true
3.6 distributedSessionCache.localCacheSize = 8192
3.7 also update the configuration from legacy to those one -> to store user sessions ( http sessions) of federation runtime , you should set session.store to true as mentioned here https://www.ibm.com/docs/en/sva/10.0.4?topic=configuration-advanced-properties.
     3.7.1 set session.store to true and set distributedSessionCache.enabled to false
3.8 you have an Advanced tuning parameter set to distributedSessionCache.localCacheEnabled=false -> this is not required ( LMI -> system settings -> Advanced tuning parameter -> delete it)
3.9 save and deploy changes
3.10 validate the fixpack is applied and also the above changes propagated to other federation appliances.
3.11 caution : you should avoid checking  current DSC sessions LMI -> web -> Distributed session cache (until absolutely necessary ) , it puts additional load onto DSC. (edited) 
ibm.com{noformat}



also customer passed in the glowroot which showed delays during apiauthsvc( wherein authentication server session is configured to be stored in dsc)

{noformat}5601|authsvc.stateMgmt.cookieless|authsvc.sessionCache.enable|true|N|N|Boolean||authsvc
12505|sps.authService.stateIdSource.authsvc|sps.authService.stateIdSource.authsvc|BodyandQuery|N|N|String|BodyandQuery,BodyOnly|sps.authService
12506|sps.authService.stateIdSource.apiauthsvc|sps.authService.stateIdSource.apiauthsvc|BodyandQuery|N|N|String|BodyandQuery,BodyOnly|sps.authService
15603|authsvc.stateMgmt.lifetime|authsvc.sessionCache.lifetime|3600|N|N|Integer||authsvc
15602|authsvc.stateMgmt.store|authsvc.sessionCache.backend|DSC|N|N|String|DSC,DMap,Memory|authsvc
15604|authsvc.stateMgmt.memory.maxSessions|authsvc.sessionCache.maxSessions|1000|N|N|Integer||authsvc
15605|authsvc.stateMgmt.memory.cleanupWait|authsvc.sessionCache.cleanupWait|0|N|N|Integer||authsvc
15606|authsvc.stateMgmt.memory.cleanupThread.batchSize|authsvc.cleanupThread.batchSize|0|N|N|Integer||authsvc{noformat}","12/May/23 8:51 PM;5c53d3ac23f5bf672621c868;* Customer has applied the performance tuning fix and running okay since last night
* they also enabled dsc federation caches as per the plan
* removing legacy configuration didn’t work . they will open a new case and recreate in prre prod to work it out
* failover-on-read and persistent-failover-on-read caused issue and can be recreated in pre prod . this will be worked via a different case.

In the meantime I managed to grab a screenshot of the number of sessions in DSC

!image-20230512-105059.png|width=1730,height=776!

monitoring the env.

Thanks [~accountid:5b15d9517dab4c51f61b5190] for the fix and hope that solves the problem

[~accountid:5ac57757d9a96536d1f0daa9] since Peter is on leave can be have a backup assigned ","13/May/23 5:42 AM;5b17571b91981f4fdde632c1;* For ISVA Support (for now):
** From all TS012925605 iswga/pstack/<number>.txt dced files
** {noformat}-rw-rw-r--. 1 <user> sftpusers 456669 May 11 18:39 2023-05-11/isva_10.0.4.0_20230512-023047_ciam-ps1.rbro.rbg.cc.support_unpack/iswga/pstack/1723.txt
-rw-rw-r--. 1 <user> sftpusers 475077 May 12 08:19 2023-05-12/isva_10.0.4.0_20230512-160853_ciam-ps1.rbro.rbg.cc.support_unpack/iswga/pstack/1755.txt
-rw-rw-r--. 1 <user> sftpusers 435161 May 12 08:30 2023-05-12/isva_10.0.4.0_20230512-162054_ciam-ps2.rbro.rbg.cc.support_unpack/iswga/pstack/29867.txt
-rw-rw-r--. 1 <user> sftpusers 436687 May 12 10:07 2023-05-12/isva_10.0.4.0_20230512-180723_ciam-ps1-dr.rbro.rbg.cc.support_unpack/iswga/pstack/117351.txt
-rw-rw-r--. 1 <user> sftpusers 435292 May 12 10:10 2023-05-12/isva_10.0.4.0_20230512-181041_ciam-ps2-dr.rbro.rbg.cc.support_unpack/iswga/pstack/118563.txt{noformat}
*** L2 checking/asking if any of these times correlates to failing times
**** Otherwise this could be just info

{noformat}>> 2023-05-11/isva_10.0.4.0_20230512-023047_ciam-ps1.rbro.rbg.cc.support_unpack/iswga/pstack/1723.txt.filter-p
 780	
				#0  0x00007f6f4a2af3fc in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
				#1  0x00007f6f4b8ce62d in AMWSMSList::consume() () from /usr/lib64/libamdsc_server.so
				#2  0x00007f6f4b8cefb2 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#3  0x00007f6f4b8cf089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#4  0x00007f6f4a2a917a in start_thread () from /lib64/libpthread.so.0
				#5  0x00007f6f49dc0df3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-160853_ciam-ps1.rbro.rbg.cc.support_unpack/iswga/pstack/1755.txt.filter-p
 750	
				#0  0x00007f39a510a3fc in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
				#1  0x00007f39a672962d in AMWSMSList::consume() () from /usr/lib64/libamdsc_server.so
				#2  0x00007f39a6729fb2 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#3  0x00007f39a672a089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#4  0x00007f39a510417a in start_thread () from /lib64/libpthread.so.0
				#5  0x00007f39a4c1bdf3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-162054_ciam-ps2.rbro.rbg.cc.support_unpack/iswga/pstack/29867.txt.filter-p
 800	
				#0  0x00007fbd8afcc3fc in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
				#1  0x00007fbd8c5eb62d in AMWSMSList::consume() () from /usr/lib64/libamdsc_server.so
				#2  0x00007fbd8c5ebfb2 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#3  0x00007fbd8c5ec089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#4  0x00007fbd8afc617a in start_thread () from /lib64/libpthread.so.0
				#5  0x00007fbd8aadddf3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-180723_ciam-ps1-dr.rbro.rbg.cc.support_unpack/iswga/pstack/117351.txt.filter-p
 800	
				#0  0x00007fb12d9593fc in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
				#1  0x00007fb12ef7862d in AMWSMSList::consume() () from /usr/lib64/libamdsc_server.so
				#2  0x00007fb12ef78fb2 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#3  0x00007fb12ef79089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#4  0x00007fb12d95317a in start_thread () from /lib64/libpthread.so.0
				#5  0x00007fb12d46adf3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-181041_ciam-ps2-dr.rbro.rbg.cc.support_unpack/iswga/pstack/118563.txt.filter-p
 801	
				#0  0x00007f58b3b153fc in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
				#1  0x00007f58b513462d in AMWSMSList::consume() () from /usr/lib64/libamdsc_server.so
				#2  0x00007f58b5134fb2 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#3  0x00007f58b5135089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#4  0x00007f58b3b0f17a in start_thread () from /lib64/libpthread.so.0
				#5  0x00007f58b3626df3 in clone () from /lib64/libc.so.6

================================================================================

>> 2023-05-11/isva_10.0.4.0_20230512-023047_ciam-ps1.rbro.rbg.cc.support_unpack/iswga/pstack/1723.txt.filter-p
  16	
				#0  0x00007f6f4a2af74a in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
				#1  0x00007f6f4b441bfe in ZCondition::wait() () from /usr/lib64/libpdz.so
				#2  0x00007f6f4b4417d9 in ZCondition::wait() () from /usr/lib64/libpdz.so
				#3  0x00007f6f4b6b8b70 in AMWSMSReplica::waitForUpdates() () from /usr/lib64/libamdsc_interface.so
				#4  0x00007f6f4b6ab9b8 in AMWSMSSessionCache::waitForUpdates() () from /usr/lib64/libamdsc_interface.so
				#5  0x00007f6f4b6a7171 in DSess::getUpdates() () from /usr/lib64/libamdsc_interface.so
				#6  0x00007f6f4b6a2e95 in DSessWrapper::getUpdates() () from /usr/lib64/libamdsc_interface.so
				#7  0x00007f6f4a8a38a1 in tivsec_axiscpp::ServerAxisEngine::invoke() () from /usr/lib64/libtivsec_axis_server.so
				#8  0x00007f6f4a8a40d2 in tivsec_axiscpp::ServerAxisEngine::process() () from /usr/lib64/libtivsec_axis_server.so
				#9  0x00007f6f4a8c0156 in process_request() () from /usr/lib64/libtivsec_axis_server.so
				#10 0x00007f6f4b8ce293 in AMWSMSServiceClient::processRequest() () from /usr/lib64/libamdsc_server.so
				#11 0x00007f6f4b8ceff8 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#12 0x00007f6f4b8cf089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#13 0x00007f6f4a2a917a in start_thread () from /lib64/libpthread.so.0
				#14 0x00007f6f49dc0df3 in clone () from /lib64/libc.so.6
   1	
				#0  0x00007f6f4a2af74a in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
				#1  0x00007f6f4b441bfe in ZCondition::wait() () from /usr/lib64/libpdz.so
				#2  0x00007f6f4b4417d9 in ZCondition::wait() () from /usr/lib64/libpdz.so
				#3  0x00007f6f4b6ae691 in AMWSMSSessionCache::getUpdates() () from /usr/lib64/libamdsc_interface.so
				#4  0x00007f6f4b6b5f2a in AMWSMSReplicator::processDsessRequest() () from /usr/lib64/libamdsc_interface.so
				#5  0x00007f6f4b6b6b14 in AMWSMSReplicator::processRequest() () from /usr/lib64/libamdsc_interface.so
				#6  0x00007f6f4b8ceff8 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#7  0x00007f6f4b8cf089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#8  0x00007f6f4a2a917a in start_thread () from /lib64/libpthread.so.0
				#9  0x00007f6f49dc0df3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-160853_ciam-ps1.rbro.rbg.cc.support_unpack/iswga/pstack/1755.txt.filter-p
  20	
				#0  0x00007f39a510a74a in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
				#1  0x00007f39a629cbfe in ZCondition::wait() () from /usr/lib64/libpdz.so
				#2  0x00007f39a629c7d9 in ZCondition::wait() () from /usr/lib64/libpdz.so
				#3  0x00007f39a6513b70 in AMWSMSReplica::waitForUpdates() () from /usr/lib64/libamdsc_interface.so
				#4  0x00007f39a65069b8 in AMWSMSSessionCache::waitForUpdates() () from /usr/lib64/libamdsc_interface.so
				#5  0x00007f39a6502171 in DSess::getUpdates() () from /usr/lib64/libamdsc_interface.so
				#6  0x00007f39a64fde95 in DSessWrapper::getUpdates() () from /usr/lib64/libamdsc_interface.so
				#7  0x00007f39a56fe8a1 in tivsec_axiscpp::ServerAxisEngine::invoke() () from /usr/lib64/libtivsec_axis_server.so
				#8  0x00007f39a56ff0d2 in tivsec_axiscpp::ServerAxisEngine::process() () from /usr/lib64/libtivsec_axis_server.so
				#9  0x00007f39a571b156 in process_request() () from /usr/lib64/libtivsec_axis_server.so
				#10 0x00007f39a6729293 in AMWSMSServiceClient::processRequest() () from /usr/lib64/libamdsc_server.so
				#11 0x00007f39a6729ff8 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#12 0x00007f39a672a089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#13 0x00007f39a510417a in start_thread () from /lib64/libpthread.so.0
				#14 0x00007f39a4c1bdf3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-162054_ciam-ps2.rbro.rbg.cc.support_unpack/iswga/pstack/29867.txt.filter-p

>> 2023-05-12/isva_10.0.4.0_20230512-180723_ciam-ps1-dr.rbro.rbg.cc.support_unpack/iswga/pstack/117351.txt.filter-p

>> 2023-05-12/isva_10.0.4.0_20230512-181041_ciam-ps2-dr.rbro.rbg.cc.support_unpack/iswga/pstack/118563.txt.filter-p

================================================================================

>> 2023-05-11/isva_10.0.4.0_20230512-023047_ciam-ps1.rbro.rbg.cc.support_unpack/iswga/pstack/1723.txt.filter-p
   6	
				#0  0x00007f6f49db5a71 in poll () from /lib64/libc.so.6
				#1  0x00007f6f4b8d0644 in waitForIO() () from /usr/lib64/libamdsc_server.so
				#2  0x00007f6f4b8d0d59 in AMWSMSSocket::socketRead() () from /usr/lib64/libamdsc_server.so
				#3  0x00007f6f4b8d0d92 in AMWSMSSocketTCP::recv() () from /usr/lib64/libamdsc_server.so
				#4  0x00007f6f4b8d39a6 in AMWSMSTransport::readFromClient() () from /usr/lib64/libamdsc_server.so
				#5  0x00007f6f4b8d4759 in AMWSMSTransport::shouldCloseConnection() () from /usr/lib64/libamdsc_server.so
				#6  0x00007f6f4b8ce328 in AMWSMSServiceClient::processRequest() () from /usr/lib64/libamdsc_server.so
				#7  0x00007f6f4b8ceff8 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#8  0x00007f6f4b8cf089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#9  0x00007f6f4a2a917a in start_thread () from /lib64/libpthread.so.0
				#10 0x00007f6f49dc0df3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-160853_ciam-ps1.rbro.rbg.cc.support_unpack/iswga/pstack/1755.txt.filter-p
  31	
				#0  0x00007f39a4c10a71 in poll () from /lib64/libc.so.6
				#1  0x00007f39a672b644 in waitForIO() () from /usr/lib64/libamdsc_server.so
				#2  0x00007f39a672bd59 in AMWSMSSocket::socketRead() () from /usr/lib64/libamdsc_server.so
				#3  0x00007f39a672bd92 in AMWSMSSocketTCP::recv() () from /usr/lib64/libamdsc_server.so
				#4  0x00007f39a672e9a6 in AMWSMSTransport::readFromClient() () from /usr/lib64/libamdsc_server.so
				#5  0x00007f39a672f759 in AMWSMSTransport::shouldCloseConnection() () from /usr/lib64/libamdsc_server.so
				#6  0x00007f39a6729328 in AMWSMSServiceClient::processRequest() () from /usr/lib64/libamdsc_server.so
				#7  0x00007f39a6729ff8 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#8  0x00007f39a672a089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#9  0x00007f39a510417a in start_thread () from /lib64/libpthread.so.0
				#10 0x00007f39a4c1bdf3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-162054_ciam-ps2.rbro.rbg.cc.support_unpack/iswga/pstack/29867.txt.filter-p

>> 2023-05-12/isva_10.0.4.0_20230512-180723_ciam-ps1-dr.rbro.rbg.cc.support_unpack/iswga/pstack/117351.txt.filter-p

>> 2023-05-12/isva_10.0.4.0_20230512-181041_ciam-ps2-dr.rbro.rbg.cc.support_unpack/iswga/pstack/118563.txt.filter-p

================================================================================

>> 2023-05-12/isva_10.0.4.0_20230512-160853_ciam-ps1.rbro.rbg.cc.support_unpack/iswga/pstack/1755.txt.filter-p
   1	
				#0  0x00007f39a4c10a71 in poll () from /lib64/libc.so.6
				#1  0x00007f39a672b644 in waitForIO() () from /usr/lib64/libamdsc_server.so
				#2  0x00007f39a672bd59 in AMWSMSSocket::socketRead() () from /usr/lib64/libamdsc_server.so
				#3  0x00007f39a283a207 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#4  0x00007f39a276b158 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#5  0x00007f39a276d01d in ?? () from /usr/lib64/libgsk8ssl_64.so
				#6  0x00007f39a270de84 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#7  0x00007f39a25fd38a in gsk_secure_soc_read () from /usr/lib64/libgsk8ssl_64.so
				#8  0x00007f39a672b479 in AMWSMSSocketTLS::recv() () from /usr/lib64/libamdsc_server.so
				#9  0x00007f39a65119f3 in AMWSMSReplicator::processRequest() () from /usr/lib64/libamdsc_interface.so
				#10 0x00007f39a6729ff8 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#11 0x00007f39a672a089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#12 0x00007f39a510417a in start_thread () from /lib64/libpthread.so.0
				#13 0x00007f39a4c1bdf3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-162054_ciam-ps2.rbro.rbg.cc.support_unpack/iswga/pstack/29867.txt.filter-p
   2	
				#0  0x00007fbd8aad2a71 in poll () from /lib64/libc.so.6
				#1  0x00007fbd8c5ed644 in waitForIO() () from /usr/lib64/libamdsc_server.so
				#2  0x00007fbd8c5edd59 in AMWSMSSocket::socketRead() () from /usr/lib64/libamdsc_server.so
				#3  0x00007fbd886fc207 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#4  0x00007fbd8862d158 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#5  0x00007fbd8862f01d in ?? () from /usr/lib64/libgsk8ssl_64.so
				#6  0x00007fbd885cfe84 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#7  0x00007fbd884bf38a in gsk_secure_soc_read () from /usr/lib64/libgsk8ssl_64.so
				#8  0x00007fbd8c5ed479 in AMWSMSSocketTLS::recv() () from /usr/lib64/libamdsc_server.so
				#9  0x00007fbd8c3d39f3 in AMWSMSReplicator::processRequest() () from /usr/lib64/libamdsc_interface.so
				#10 0x00007fbd8c5ebff8 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#11 0x00007fbd8c5ec089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#12 0x00007fbd8afc617a in start_thread () from /lib64/libpthread.so.0
				#13 0x00007fbd8aadddf3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-180723_ciam-ps1-dr.rbro.rbg.cc.support_unpack/iswga/pstack/117351.txt.filter-p
   2	
				#0  0x00007fb12d45fa71 in poll () from /lib64/libc.so.6
				#1  0x00007fb12ef7a644 in waitForIO() () from /usr/lib64/libamdsc_server.so
				#2  0x00007fb12ef7ad59 in AMWSMSSocket::socketRead() () from /usr/lib64/libamdsc_server.so
				#3  0x00007fb12b089207 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#4  0x00007fb12afba158 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#5  0x00007fb12afbc01d in ?? () from /usr/lib64/libgsk8ssl_64.so
				#6  0x00007fb12af5ce84 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#7  0x00007fb12ae4c38a in gsk_secure_soc_read () from /usr/lib64/libgsk8ssl_64.so
				#8  0x00007fb12ef7a479 in AMWSMSSocketTLS::recv() () from /usr/lib64/libamdsc_server.so
				#9  0x00007fb12ed609f3 in AMWSMSReplicator::processRequest() () from /usr/lib64/libamdsc_interface.so
				#10 0x00007fb12ef78ff8 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#11 0x00007fb12ef79089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#12 0x00007fb12d95317a in start_thread () from /lib64/libpthread.so.0
				#13 0x00007fb12d46adf3 in clone () from /lib64/libc.so.6

>> 2023-05-12/isva_10.0.4.0_20230512-181041_ciam-ps2-dr.rbro.rbg.cc.support_unpack/iswga/pstack/118563.txt.filter-p
   1	
				#0  0x00007f58b361ba71 in poll () from /lib64/libc.so.6
				#1  0x00007f58b5136644 in waitForIO() () from /usr/lib64/libamdsc_server.so
				#2  0x00007f58b5136d59 in AMWSMSSocket::socketRead() () from /usr/lib64/libamdsc_server.so
				#3  0x00007f58b1245207 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#4  0x00007f58b1176158 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#5  0x00007f58b117801d in ?? () from /usr/lib64/libgsk8ssl_64.so
				#6  0x00007f58b1118e84 in ?? () from /usr/lib64/libgsk8ssl_64.so
				#7  0x00007f58b100838a in gsk_secure_soc_read () from /usr/lib64/libgsk8ssl_64.so
				#8  0x00007f58b5136479 in AMWSMSSocketTLS::recv() () from /usr/lib64/libamdsc_server.so
				#9  0x00007f58b4f1c9f3 in AMWSMSReplicator::processRequest() () from /usr/lib64/libamdsc_interface.so
				#10 0x00007f58b5134ff8 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
				#11 0x00007f58b5135089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
				#12 0x00007f58b3b0f17a in start_thread () from /lib64/libpthread.so.0
				#13 0x00007f58b3626df3 in clone () from /lib64/libc.so.6{noformat}","13/May/23 6:38 AM;5b17571b91981f4fdde632c1;* VMWare tunings should be reviewed by true VMWare support



* WARN  o.glowroot.agent.impl.TraceCollector - not storing a trace because of an excessive backlog of 150 traces already waiting to be stored (this warning will be logged at most once a minute, 84 warnings were suppressed since it was last logged)
** This is NOT good
*** Could negatively be impacting performance
**** VMWare thoughput","13/May/23 9:34 AM;5b17571b91981f4fdde632c1;* For IBM ISVA Support only
** Only if absolutely necessary no other option
*** Zero guarantees
*** Malloc performance will revert to ISAM 9.0.7.* and ISVA pre-10.0.3
*** Fixpacks
**** [https://ibm.ent.box.com/folder/207410857363|https://ibm.ent.box.com/folder/207410857363|smart-link] 
**** [https://ibm.ent.box.com/folder/207412070584|https://ibm.ent.box.com/folder/207412070584|smart-link]  
***** {color:#bf2600}*GLIBC_TUNABLES=glibc.malloc.tcache_count=0*{color}
****** /etc/profile
****** etc/environment","13/May/23 12:54 PM;5b17571b91981f4fdde632c1;* Counts of 2023-05-12 dscd.log messages

{noformat}192	0x38A0A29C /opt/dsc/bin/dscd ERROR wds server AMWSMSReplicator.cpp 369 	DPWDS0668E   Unable to read replicator protocol header from the remote node.
13	0x38A0A29C /opt/dsc/bin/dscd ERROR wds server AMWSMSReplicator.cpp 369 	DPWDS0668E   Unable to read replicator protocol header from the remote node.--------------------------------------------/bin/chown

--

15	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 1, has detected node 0 has started with time offset 0.
15	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 2, has detected node 1 has started with time offset 0.
15	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 2, has detected node 3 has started with time offset 0.
14	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 0, has detected node 1 has started with time offset 0.
14	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 3, has detected node 2 has started with time offset 0.
13	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 1, has detected node 2 has started with time offset 0.
3	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 1, has detected node 0 has started with time offset 1.
3	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 1, has detected node 2 has started with time offset 1.
2	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 0, has detected node 1 has started with time offset -1.
2	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 2, has detected node 1 has started with time offset 1.
2	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 3, has detected node 2 has started with time offset 1.
1	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 0, has detected node 1 has started with time offset 1.
1	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 2, has detected node 1 has started with time offset -1.
1	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 2, has detected node 3 has started with time offset -1.
1	0x38A0A2AB /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 492 	DPWDS0683W   This server node 2, has detected node 3 has started with time offset 1.

--

64	0x38A0A26A /opt/dsc/bin/dscd WARNING wds server AMWSMSServer.cpp 1583 	DPWDS0618W   Entering active mode.
1	0x38A0A26A /opt/dsc/bin/dscd WARNING wds server AMWSMSServer.cpp 1583 	DPWDS0618W   Entering active mode.--------------------------------------------/bin/chown

--

44	0x38A0A25C /opt/dsc/bin/dscd WARNING wds server dscd.cpp 285 	DPWDS0604W   The distributed session cache server has started.

--

26	0x38A0A25D /opt/dsc/bin/dscd WARNING wds server dscd.cpp 321 	DPWDS0605W   The distributed session cache server has been stopped.
7	0x38A0A25D /opt/dsc/bin/dscd WARNING wds server dscd.cpp 321 	DPWDS0605W   The distributed session cache server has been stopped.--------------------------------------------/bin/chown

--

30	0x38A0A269 /opt/dsc/bin/dscd WARNING wds server AMWSMSServer.cpp 1579 	DPWDS0617W   Entering standby mode.

--

22	0x38A0A302 /opt/dsc/bin/dscd ERROR wds admin AMWSMSSocket.cpp 1196 	DPWDS0770E   Function call, gsk_secure_soc_init, failed error: 0000019a GSK_ERROR_BAD_MESSAGE.
3	0x38A0A302 /opt/dsc/bin/dscd ERROR wds admin AMWSMSSocket.cpp 1196 	DPWDS0770E   Function call, gsk_secure_soc_init, failed error: 00000196 GSK_ERROR_IO.
3	0x38A0A302 /opt/dsc/bin/dscd ERROR wds admin AMWSMSSocket.cpp 1196 	DPWDS0770E   Function call, gsk_secure_soc_init, failed error: 0000019e GSK_ERROR_BAD_CERT.
1	0x38A0A302 /opt/dsc/bin/dscd ERROR wds admin AMWSMSSocket.cpp 1196 	DPWDS0770E   Function call, gsk_secure_soc_init, failed error: 000001a4 GSK_ERROR_SOCKET_CLOSED.

--

19	0x38A0A297 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1173 	DPWDS0663W   Waiting for catchup before entering standby mode.

--

6	0x38A0A290 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1028 	DPWDS0656W   Unable to connect to destination 10.241.127.117:2027
5	0x38A0A290 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1028 	DPWDS0656W   Unable to connect to destination 10.241.18.5:2027
3	0x38A0A290 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1028 	DPWDS0656W   Unable to connect to destination 10.241.127.116:2027
3	0x38A0A290 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1028 	DPWDS0656W   Unable to connect to destination 10.241.18.6:2027

--

15	0x38A0A297 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1172 	DPWDS0663W   Waiting for catchup before entering standby mode.

--

5	0x38A0A290 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1027 	DPWDS0656W   Unable to connect to destination 10.241.127.117:2027
5	0x38A0A290 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1027 	DPWDS0656W   Unable to connect to destination 10.241.18.5:2027
3	0x38A0A290 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1027 	DPWDS0656W   Unable to connect to destination 10.241.127.116:2027
2	0x38A0A290 /opt/dsc/bin/dscd WARNING wds server AMWSMSReplicator.cpp 1027 	DPWDS0656W   Unable to connect to destination 10.241.18.6:2027

--{noformat}","15/May/23 7:56 AM;5b17571b91981f4fdde632c1;{noformat}TS012925605/2023-05-12	DPWWA2852E:

      8 Glowroot_error_and_slowtrace_example/msg__webseald-default.log
      8 msg_webseald-default.log
  11648 var/pdweb/cards/log/msg__webseald-cards.log
   1008 var/pdweb/default/log/msg__webseald-default.log
 146242 var/pdweb/oauth/log/msg__webseald-oauth.log{noformat}



{noformat}TS012925605/2023-05-12	DPWNS1051E:

     90 Glowroot_error_and_slowtrace_example/msg__webseald-default.log
     90 msg_webseald-default.log
      1 var/pdweb/cards/log/msg__webseald-cards.log
  60568 var/pdweb/default/log/msg__webseald-default.log
      8 var/pdweb/oauth/log/msg__webseald-oauth.log{noformat}



{noformat}TS012925605/2023-05-12	0x38B9A427:

  <Message ID=""DPWNS1063E   "" prefix=""yes"">
    <!-- code amweb_s_ses_dsess_delete_failed -->
    <MsgText msgIndex=""1063"" varFormat=""C"">
        An attempt to delete a session failed with error code 0x<Variable formatSpec=""%1$08lx"">%08lx</Variable>. (0x38b9a427)

    101 Glowroot_error_and_slowtrace_example/msg__webseald-default.log
    101 msg_webseald-default.log
  62755 var/pdweb/default/log/msg__webseald-default.log{noformat}



{noformat}TS012925605/2023-05-12	0x38a0a13c:

  <Message ID=""DPWDS0316E   "" prefix=""yes"">
    <!-- code amdsess_s_no_response_returned -->
    <MsgText msgIndex=""316"" varFormat=""C"">
        The distributed session cache server did not return a response. (0x38a0a13c)

    256 Glowroot_error_and_slowtrace_example/msg__webseald-default.log
    256 msg_webseald-default.log
  58103 var/pdweb/default/log/msg__webseald-default.log{noformat}","15/May/23 8:31 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] sorry for having to send another one of Pete’s support ticket your way. I spoke with Pete on Friday and he indicated that this was best aligned with you if additional support is needed. 


[~accountid:5c53d3ac23f5bf672621c868] if we can please ensure that any new/additional issues are managed via independent items it will assist us to apply focus where it is most needed to assist our customer.","15/May/23 9:14 AM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] reading the history of the case, it looks like the next steps are with the customer?","15/May/23 10:58 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

I am able to recreate the issue in local lab



I am for now trying at 10.0.4.0 , with glowroot installed and when I hit the request , the response builds up and the majority of the delay is from Federation runtime → DSC

I am going to try the fixpack Bill suggested and see if it improves much 



[http://isva-l2-docker1.fyre.ibm.com:4000/transaction/traces?agent-id=TP-Run2-8KDSC-runtime&transaction-type=Web&last=172800000&limit=5000&modal-agent-id=TP-Run2-8KDSC-runtime&modal-trace-id=018818ef29f91983c55d5f32eb9a80ba|http://isva-l2-docker1.fyre.ibm.com:4000/transaction/traces?agent-id=TP-Run2-8KDSC-runtime&transaction-type=Web&last=172800000&limit=5000&modal-agent-id=TP-Run2-8KDSC-runtime&modal-trace-id=018818ef29f91983c55d5f32eb9a80ba]



The majority of the delay continues to be in DSCSession.java

As on my Recreate Action plan is this:

1.use Bill’s suggest on glibc and see if that helps

2.evaluate to use redis

From L3:

1.could you check whether a http connection reuse would be feasible in DSCSession.java ( [~accountid:5bc692938f60c6286d183dd6] ) may have some history around it.



I will keep updated","15/May/23 12:04 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 



I tried in my load test env and see positive results around



--

* Only if absolutely necessary no other option
** Zero guarantees
** Malloc performance will revert to ISAM 9.0.7.* and ISVA pre-10.0.3
** Fixpacks
*** [https://ibm.ent.box.com/folder/207410857363|https://ibm.ent.box.com/folder/207410857363|smart-link]
*** [https://ibm.ent.box.com/folder/207412070584|https://ibm.ent.box.com/folder/207412070584|smart-link]
**** {color:#bf2600}*GLIBC_TUNABLES=glibc.malloc.tcache_count=0*{color}
***** /etc/profile
***** etc/environment

Is this going to be applied on only primary masters which hosts DSCD or on reverse proxy as well?



now this looks to be a last option as, only other option left is Redis(with architecture change)","15/May/23 12:21 PM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] 

Like discussed:

Once you have comparable data from the redis run, it’ll be easier to decide DSC vs Redis.

{quote}_Is this going to be applied on only primary masters which hosts DSCD or on reverse proxy as well?_{quote}

I’d say as long as the appliances are all at the same version/IF, it makes sense to have the same environment variables on all (DSC and WRP)

So far I haven’t seen what the downside is to the glibc malloc tunable running over a period of time. Maybe [~accountid:5b17571b91981f4fdde632c1] has additional input.","15/May/23 5:31 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

At this point,I couldn’t do a very distinctive performance comparison between DSC and redis ( as my redis infra may not be good to do a performance test)

Incase, dev has an infra around redis I can do a test.



The load test seems to behave better when load is less. ( when glibc is set) but it slows down when env is 2x of the load.



I will work with customer to get around redis and test in their lower env","15/May/23 5:32 PM;5c53d3ac23f5bf672621c868;As Bill Suggested, before moving to Redis



could you suggest glibc for the customer to try ( in my test at some point it has better behavior)","15/May/23 5:56 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

Here is the action plan:



1.Apply Glibc in customer env , on top of Peter’s performance fix (as this is our last option before redis)

2. In parallel help customer to prepare  redis in pre prod env and test it","15/May/23 6:03 PM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] sounds like a plan.

Are they going to make the glibc change and then monitor for confirmation one way or the other? How long does it usually take for the problem to manifest after a reset (restart of services or appliance)?","15/May/23 11:28 PM;5ff48f4aa9d0300107ccded2;[~accountid:5b15d954b0d76456f36daf33] [~accountid:5b15d9f03993e9196502f607] [~accountid:5ac577587028785d133fbc46] [~accountid:5af0531368ebd52c36627c3b] 

I need to ask for a clear direction we need to take on this case at this point.  The glibc change was recommended to the customer, and they will test it in a lower environment, but Bill H pointed out there were no guarantees that this would resolve anything.

We need to provide a clear next step that will drive us to a true resolution at this point.  

In supports opinion, we have two paths that we can take:

# Continue troubleshooting this issue with the code so that a code fix can be found, and request all information needed to investigate the issue.
## One caveat to this, is that the customer is very focused on not impacting performance.  Any logging/tracing that is requested to identify the issue must have a very minimal impact on performance.
## Another caveat is that a current possible workaround that we’ve given them is to regularly restart the DSC, which could also limit our ability to gather pertinent logs that we need.
# Admit the limitation of DSC and continue the conversation and direction to the customer to move session storage to Redis.  
## This would be a significant undertaking for the customer involving testing and configuration in the lower environments and a while before the change made it to production.
### If we are not fully confident in this resolving this issue for good, we will have very negatively impacted our customers time and money and not resolving the issue.
## Do we have any performance data for 10.0.4 that would compare DSC vs Redis that we could share with the customer backing our recommendation?",16/May/23 6:20 AM;5ff48f4aa9d0300107ccded2;The bank just reported another outage even while regularly restarting the DSC. They will look to apply the glib change at this point as nothing else has worked.,"16/May/23 1:43 PM;5b15d954b0d76456f36daf33;[~accountid:5ff48f4aa9d0300107ccded2] ,

[~accountid:5c53d3ac23f5bf672621c868]  [~accountid:5b232b2fd85e5b59b066f57f] and I had a discussion about the current status and action plan. Please find a summary below

* Get current status from customer:
** If glibc changes were implemented and what effect it had
** If any restarts had to be performed during day time - frequency and triggers
* Collect data in case of additional outages, with the working theory that DSC is the bottleneck
** DSC trace. With the IJ46634_10040IF1.fixpack in place, this should have minimal impact
** DSC core to potentially identify the internal processes where the delay is
** Runtime jvm core dum to correlate with DSC core
* Other considerations
** Is the customer able to run their production systems from the other partition (9.0.7.x) until the root cause and any potential solutions are worked out?
*** This is based on a 24 hour restart of services being slightly better than the current (monitor DSC memory usage and restart as many times as needed)

To answer some of your questions:

_>> Admit the limitation of DSC and continue the conversation and direction to the customer to move session storage to Redis._  

* In my opinion that discussion is outside the scope of support as it would potentially involve architecture, sizing, scaling etc for a new deployment. I’m also not entirely sure what guarantees we can give that this will resolve the current problem they are facing.

_>> Do we have any performance data for 10.0.4 that would compare DSC vs Redis that we could share with the customer backing our recommendation?_

* This is more  [~accountid:5af0531368ebd52c36627c3b] 's area of expertise. or [~accountid:5ac57757d9a96536d1f0daa9] might be able to confirm if any such benchmarking was done as part of 10.0.4.0 release/performance testing.

[~accountid:5c53d3ac23f5bf672621c868] please feel free to add if I missed anything else we discussed.","16/May/23 3:50 PM;5c53d3ac23f5bf672621c868;{noformat}Hi

Incase the issue is faced even applying glibc fix

We would need the following information before you restart the systems incase issue occurs.



1. DSC core from pid through cli

This you need to do perform from the master node where dsc is runnig,before the systems are restarted( estimated time is 1 to 2 minute)

1.1 open CLI to master node on port 22
1.2 diagnostics monitor top -vi
1.3 find the below process id of dscd process
1.3 example   896   840 root     S    3756m 63.0   1  0.0 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
1.4 here the process id is 896
1.5 exit vi using :q!
1.6 generate dsc core dump by running from cli
1.7  diagnostics core_dumps generate 896
1.8 you will get a response 
A core file has been generated and will be available in the next support file
to be generated



2.Generate java dumps on federation node (time is 1 to 2 mins)
   2.1 goto CLI of federation  runtime ( try to capture it on all the federation nodes, can be done in parallel on all nodes)
    2.2 goto CLI of federation runtime ->  diagnostics java_dumps runtime thread 
    2.3 do the same step on other runtime before restart
   2.5 . continue to step 3

3. Enable DSC trace (time is 1 to 2 mins)
    1. As the performance fix has improvement around tracing . this you can do whenever you are restarting the dsc (since you start DSC any time you can enable this trace right when you receive from me. 
    2. goto LMI -> cluster configuration -> session cache -> set trace level to 1
    3. save
4. check with network team whether they have network sniffer. we would also like to review the network flow around the appliances. A network sniffer will help to capture that. 
5. In parallel could you involve VMWare support to review vmware settings if they are set at optimal level ( this is based on lot of connection issues we saw ) and would like to confirm that vmware settings with the help of vmware support.
{noformat}","17/May/23 6:31 PM;5b15d954b0d76456f36daf33;Summary of call with the customer:

# Production is running without any outage for the past two days with the hourly restart workaround in place.
# They are matching the pre-prod environment with prod (same fixes and tuning parameters). Last time they tried to do this, a new problem has arisen (going to open a new case for that)
# Once pre-prod is up and running without any errors, they will stress test that environment to recreate the DSC outage issue seen in prod. ([~accountid:5c53d3ac23f5bf672621c868]  has kindly offered to help them with setting up such a test)
# Customer has configured their test env with redis. Functional testing is in progress, but their preferred solution is to receive a fix from us for DSC outage in prod.
# Depending on the outcome of steps 2 and 3 above, we’ll work on isolating and identifying the root cause through incremental changes to configuration and/or test fix(es).","17/May/23 11:02 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

I reproduced the issue and including support file from local lab



One of the support file has dscd core



[https://ibm.ent.box.com/folder/208024208468|https://ibm.ent.box.com/folder/208024208468|smart-link] 



if the core could give an idea around any issue in dsc that will be to look into

also, i included java core into the runtime

core is in isva_10.0.4.0_20230517-203000_isva1010.support



{noformat}-r--r--r--    1 root     www-data     34893 May 16 15:39 map_-mesa_cli.7924
-r--r--r--    1 root     www-data     29624 May 16 23:38 map_wrp-watchdog-default1.6041
-rw-rw-r--    1 root     www-data     42019 May 16 23:38 map_webseald-default1.6049
-r--r--r--    1 root     www-data     34893 May 17 13:29 map_-mesa_cli.22190
-r--r--r--    1 root     www-data     34893 May 17 13:48 map_-mesa_cli.30472
-rw-rw-r--    1 root     www-data     40666 May 17 14:44 map_webseald-default.17982
-r--r--r--    1 root     www-data     34893 May 17 14:50 map_-mesa_cli.20914
-r--r--r--    1 root     www-data     34893 May 17 17:37 map_-mesa_cli.16419
-r--r--r--    1 root     www-data     29624 May 17 19:55 map_wrp-watchdog-default.9251
-rw-rw-r--    1 root     www-data     40666 May 17 19:55 map_webseald-default.9259
-rw-r--r--    1 root     www-data 3905513040 May 17 20:15 core_dscd{noformat}","19/May/23 9:34 AM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] unfortunately neither support file you shared has the actual core file. Nor does it even show up in the file listing (ls.txt)

Is it possible that the support containing the core is different to what you shared? I asked Virag to look for it in the local infrastructure you have, but he couldn’t locate it either.

[~accountid:5b17571a82e05b22cc7d5d9e] can you share the summary of last night’s call? Where the customer is at with preparing the pre-prod environment for DSC outage issue recreate?","19/May/23 2:59 PM;5b17571a82e05b22cc7d5d9e;Hi Bhavan,

it seems customer is more interested in setting up redis and use it in prod earliest.

customer yet not performed stress test in pre live environment to reproduce the DSC hang issue. However they have emphasized on why the below settings in session cache configuration broke the flow with HTTP 500 Internal server error.

{noformat}# The length of time that a connection can remain idle before it is closed. A # value of 0 indicates that each connection will only ever be used for a single # request

connection-idle-timeout = 5{noformat}

Looking at the dsc trace, i found that dsc served requests during the http 500 error received.

{noformat}2023-05-17-12:43:37.535+03:00I----- /opt/dsc/bin/dscd DEBUG4 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSSessionCache.cpp 549 0x7f36e7bb9700
[] default-webseald-ciam-rp3-pre.rbro.rbg.cc ENTER createSession(default:TpoJ2yr2x07xUmbEaKUtik/sQT5mNGDukYblZRpy2/p3WtEMvYw=)
2023-05-17-12:43:37.535+03:00I----- /opt/dsc/bin/dscd DEBUG3 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSSession.cpp 588 0x7f36e7bb9700
[] Session: updateUserName(default:TpoJ2yr2x07xUmbEaKUtik/sQT5mNGDukYblZRpy2/p3WtEMvYw=) user ->unauthenticated)
2023-05-17-12:43:37.535+03:00I----- /opt/dsc/bin/dscd DEBUG1 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSSessionCache.cpp 636 0x7f36e7bb9700
[] createSession default:TpoJ2yr2x07xUmbEaKUtik/sQT5mNGDukYblZRpy2/p3WtEMvYw= user unauthenticated expires 2023-05-17:13:43:37+0300
2023-05-17-12:43:37.535+03:00I----- /opt/dsc/bin/dscd DEBUG2 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSSessionCache.cpp 224 0x7f36e7bb9700
[] createSession default:TpoJ2yr2x07xUmbEaKUtik/sQT5mNGDukYblZRpy2/p3WtEMvYw= Session Datacom.tivoli.am.eb.credential value 'BAKs3DCCA68MADCCA6kwggO' instance 'sms' policy 1
com.tivoli.am.eb.auth-type value '(null)' instance 'sms' policy 1
com.tivoli.am.webseal.orig-auth-type value '(null)' instance 'webseal' policy 1
com.tivoli.am.webseal.mpa-type value '0x0' instance 'webseal' policy 1
com.tivoli.am.webseal.lifetime-extended value 'false' instance 'webseal' policy 1
com.tivoli.am.webseal.refresh-failover value 'false' instance 'webseal' policy 0
com.tivoli.am.webseal.force-reauth value 'false' instance 'webseal' policy 1
com.tivoli.am.webseal.orig-session-key value '(null)' instance 'webseal' policy 0
com.tivoli.am.webseal.inactivity-timeout value '0x708' instance 'webseal' policy 1
com.tivoli.am.webseal.custom-inactivity-timeout value 'false' instance 'webseal' policy 1
com.tivoli.am.webseal.custom-lifetime-timeout value 'false' instance 'webseal' policy 1
com.tivoli.am.webseal.otp value '(null)' instance 'webseal' policy 0
com.tivoli.am.webseal.auth-data value '(null)' instance 'webseal' policy 0
com.tivoli.am.webseal.permitted-junctions value '' instance 'webseal' policy 0
com.tivoli.am.webseal.cookie-jar.stored-cookies value '' instance 'webseal' policy 0
com.tivoli.am.webseal.cookie-jar.managed-cookies value 'reset#;;;' instance 'webseal' policy 0
com.tivoli.am.eb.user-name value 'unauthenticated' instance 'sms' policy 1
com.tivoli.am.sms.user-uuid value '(null)' instance 'sms' policy 1
com.tivoli.am.eb.expiry value '0x6464afd9' instance 'sms' policy 1
com.tivoli.am.sms.concurrent-session-key-class value 'com.tivoli.am.eb.user-name' instance 'sms' policy 1
com.tivoli.am.sms.concurrent-session-key-instance value 'sms' instance 'sms' policy 1
com.tivoli.am.sms.session-index value '4c44001c-f497-11ed-8c6e-0050569b1638' instance 'sms' policy 1
com.tivoli.am.eb.version value '0x1' instance 'sms' policy 1
com.tivoli.am.sms.class value 'com.tivoli.am.eb' instance 'sms' policy 1
com.tivoli.am.sms.creation-time value '0x6464a1c9' instance 'sms' policy 0
com.tivoli.am.eb.is-inactive value 'false' instance 'sms' policy 1
com.tivoli.am.eb.last-access value '0x6464a1c9' instance 'sms' policy 0
com.tivoli.am.webseal.multi-domain-session value 'false' instance 'webseal' policy 1
com.tivoli.am.webseal.flush-sms-session value 'false' instance 'webseal' policy 0
com.tivoli.am.webseal.version value '0x1' instance 'webseal' policy 0
2023-05-17-12:43:37.535+03:00I----- /opt/dsc/bin/dscd DEBUG4 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSSessionCache.cpp 641 0x7f36e7bb9700
[] default-webseald-ciam-rp3-pre.rbro.rbg.cc createSession(default:TpoJ2yr2x07xUmbEaKUtik/sQT5mNGDukYblZRpy2/p3WtEMvYw=) EXIT status 38c5812c{noformat}



I noticed create/get/update session requests on dsc returned mainly below status code: 

{noformat}38c5812c
38c58138{noformat}

could you pls help me what is the meaning of above dsc status code as i could not find it anywhere? customer worry is tht if they move to redis will this above config will also show the same issue or not..

thanks","20/May/23 6:01 PM;5b17571a82e05b22cc7d5d9e;Hi Bhavan,

Here is the *current status, summary and need help from L3* to identify this issue further.

Customer restored *Pre Live environment* with the given hotfixes and all recommended configuration changes. We did troubleshooting during last call and following observed.

Navigate to Cluster Configuration → Session cache

!image-20230520-074825.png|width=551,height=279!

{noformat}When connection idle timeout set to 0 then everything works fine. All requests from webseal passed successfully during sanity test. 

When connection idle timeout set to 6 then the first request always fail. next request worked, again after few seconds same request failed,.. basically observed many failures.{noformat}

*NOTE: this is not DSC hang recreation, however many failures may have contributed to it.* 

*Observation from provided data during the recreate:*

Customer environment details:

{noformat}Total 5 appliance with 2 Master and 3 nodes hosting RP
DSC running on Primary & Secondary master{noformat}

We used only Primary master & 1 RP appliance to do some testing.

As soon as we change connection idle timeout =6 and deployed the changes the RP started showing errors while creating session to DSC via /mga junction.

*request.log shows* *HTTP 503 Service Unavailable during 1st attempt and HTTP 200 on next attempt*

{noformat}10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:14:36 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 503 1271 - 13241 1 -
10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:14:39 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 200 530 33a20f9a-f61d-11ed-80fe-0050569b3c40 127466 1 -

10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:15:09 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 503 1271 - 7724 1 -
10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:15:09 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 200 530 45910558-f61d-11ed-80fe-0050569b3c40 111103 1 -

10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:15:22 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 503 1271 - 16216 1 -
10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:15:23 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 200 520 4d5c1264-f61d-11ed-80fe-0050569b3c40 154374 1 -{noformat}

the *RP message log shows* error around the same timestamp for all attempts as above:

{noformat}2023-05-19-11:14:36.827+03:00I----- 0x38A0A135 webseald ERROR wds client AMWSMSSOAPCall.cpp 107 0x7f49d3965700 -- DPWDS0309E   An error was returned from the SOAP server in cluster dsess when calling the createSession interface: DPWDS0316E   The distributed session cache server did not return a response. (pd / wds) (code: 0x38a0a13c). 
2023-05-19-11:14:36.827+03:00I----- 0x38B9A425 webseald ERROR wns session WSRemoteCache.cpp 2744 0x7f49d3965700 -- DPWNS1061E   An attempt to create a session failed with error code 0x38a0a13c.

2023-05-19-11:15:09.277+03:00I----- 0x38A0A135 webseald ERROR wds client AMWSMSSOAPCall.cpp 107 0x7f49c2d35700 -- DPWDS0309E   An error was returned from the SOAP server in cluster dsess when calling the createSession interface: DPWDS0316E   The distributed session cache server did not return a response. (pd / wds) (code: 0x38a0a13c).
2023-05-19-11:15:09.277+03:00I----- 0x38B9A425 webseald ERROR wns session WSRemoteCache.cpp 2744 0x7f49c2d35700 -- DPWNS1061E   An attempt to create a session failed with error code 0x38a0a13c.

2023-05-19-11:15:22.182+03:00I----- 0x38A0A135 webseald ERROR wds client AMWSMSSOAPCall.cpp 107 0x7f49d1c32700 -- DPWDS0309E   An error was returned from the SOAP server in cluster dsess when calling the createSession interface: DPWDS0316E   The distributed session cache server did not return a response. (pd / wds) (code: 0x38a0a13c).
2023-05-19-11:15:22.182+03:00I----- 0x38B9A425 webseald ERROR wns session WSRemoteCache.cpp 2744 0x7f49d1c32700 -- DPWNS1061E   An attempt to create a session failed with error code 0x38a0a13c.{noformat}

*also captured the RP routing trace which shows the error:*

{noformat}2023-05-19-11:14:36.826+03:00I----- webseald DEBUG9 wns authn /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp 1024 0x7f49d3965700
[10.202.6.251] max-concurrent-web-sessions policy from cred = (null)
2023-05-19-11:14:36.826+03:00I----- webseald DEBUG9 wns authn /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp 872 0x7f49d3965700
[10.202.6.251] WSCredsCacheEntry::getSessOwner = unauthenticated
2023-05-19-11:14:36.826+03:00I----- webseald DEBUG9 wns authn /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp 966 0x7f49d3965700
[10.202.6.251] WSCredsCacheEntry::getAutoDisplaceSessions = 1
2023-05-19-11:14:36.826+03:00I----- webseald DEBUG8 wns session /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp 2821 0x7f49d3965700
[10.202.6.251] ENTER am_dsess_create_session: key=rR60UuTLSdm1iBg4h4rWlvyKw8ZwBWkDbbE6neoel3nJyc1wMWc=, sessPol=0,session=
Session 0x7f49c406db48, size=30:
   instances[0]
      data_class=com.tivoli.am.eb.credential
      instance=sms
      replication=1
      value_len=-1
      value=BAKs3DCCA68MADCCA6kwggOlAgIQBAIBADCCA5owggOWMC8MGEFaTl9DUkVEX0FVVEhfRVBPQ0hfVElNRTATMBECAQQMCjE2ODQ0ODQwNzYEADAtDBVBWk5fQ1JFRF9CUk9XU0VSX0lORk8wFDASAgEEDAtKYXZhLzE3LjAuNgQAMCYMEkFaTl9DUkVEX0lQX0ZBTUlMWTAQMA4CAQQMB0FGX0lORVQEADArDBBBWk5fQ1JFRF9NRUNIX0lEMBcwFQIBBAwOSVZfVU5BVVRIX1YzLjAEADAzDBxBWk5fQ1JFRF9ORVRXT1JLX0FERFJFU1NfQklOMBMwEQIBBAwKMHgwYWNhMDZmYgQAMDUMHEFaTl9DUkVEX05FVFdPUktfQUREUkVTU19TVFIwFTATAgEEDAwxMC4yMDIuNi4yNTEEADAxDBlBWk5fQ1JFRF9QUklOQ0lQQUxfRE9NQUlOMBQwEgIBBAwLUkJSTy1SQkctQ0MEADAzDBdBWk5fQ1JFRF9QUklOQ0lQQUxfTkFNRTAYMBYCAQQMD3VuYXV0aGVudGljYXRlZAQAMC0MEUFaTl9DUkVEX1FPUF9JTkZPMBgwFgIBBAwPU1NLOiBUTFNWMTI6IDMwBAAwLgwSQVpOX0NSRURfVVNFUl9JTkZPMBgwFgIBBAwPdW5hdXRoZW50aWNhdGVkBAAwJwwQQVpOX0NSRURfVkVSU0lPTjATMBECAQQMCjB4MDAwMDEwMDQEADA8DBFTTVNfU0VTU0lPTl9SRUFMTTAnMCUCAQQMHklTQU0tRGlzdHJpYnV0ZWQtU2Vzc2lvbi1DYWNoZQQAMDQMGHRhZ3ZhbHVlX2xvZ2luX3VzZXJfbmFtZTAYMBYCAQQMD3VuYXV0aGVudGljYXRlZAQAMEcMFnRhZ3ZhbHVlX3Nlc3Npb25faW5kZXgwLTArAgEEDCQzMWNiNjJlOC1mNjFkLTExZWQtODBmZS0wMDUwNTY5YjNjNDAEADCBxQwYdGFndmFsdWVfdXNlcl9zZXNzaW9uX2lkMIGoMIGlAgEEDIGdWTJsaGJTMXljREl0Y0hKbExuSmljbTh1Y21KbkxtTmpMV1JsWm1GMWJIUUFfWkdjdjdBQUFBQUlBQUFBMDdDOW5aSWlpQU54SmZ3QUFjbEkyTUZWMVZFeFRaRzB4YVVKbk5HZzBjbGRzZG5sTGR6aGFkMEpYYTBSaVlrVTJibVZ2Wld3emJrcDVZekYzVFZkalBRPT06ZGVmYXVsdAQA
   instances[1]
      data_class=com.tivoli.am.eb.auth-type
      instance=sms
      replication=1
      value_len=-1
      value=(null)
   instances[2]
      data_class=com.tivoli.am.webseal.orig-auth-type
      instance=webseal
      replication=1
      value_len=-1
      value=(null)
   instances[3]
      data_class=com.tivoli.am.webseal.mpa-type
      instance=webseal
      replication=1
      value_len=-1
      value=0x0
   instances[4]
      data_class=com.tivoli.am.webseal.lifetime-extended
      instance=webseal
      replication=1
      value_len=-1
      value=false
   instances[5]
      data_class=com.tivoli.am.webseal.refresh-failover
      instance=webseal
      replication=0
      value_len=-1
      value=false
   instances[6]
      data_class=com.tivoli.am.webseal.force-reauth
      instance=webseal
      replication=1
      value_len=-1
      value=false
   instances[7]
      data_class=com.tivoli.am.webseal.orig-session-key
      instance=webseal
      replication=0
      value_len=-1
      value=(null)
   instances[8]
      data_class=com.tivoli.am.webseal.inactivity-timeout
      instance=webseal
      replication=1
      value_len=-1
      value=0x708
   instances[9]
      data_class=com.tivoli.am.webseal.custom-inactivity-timeout
      instance=webseal
      replication=1
      value_len=-1
      value=false
   instances[10]
      data_class=com.tivoli.am.webseal.custom-lifetime-timeout
      instance=webseal
      replication=1
      value_len=-1
      value=false
   instances[11]
      data_class=com.tivoli.am.webseal.otp
      instance=webseal
      replication=0
      value_len=-1
      value=(null)
   instances[12]
      data_class=com.tivoli.am.webseal.auth-data
      instance=webseal
      replication=0
      value_len=-1
      value=(null)
   instances[13]
      data_class=com.tivoli.am.webseal.permitted-junctions
      instance=webseal
      replication=0
      value_len=-1
      value=
   instances[14]
      data_class=com.tivoli.am.webseal.cookie-jar.stored-cookies
      instance=webseal
      replication=0
      value_len=-1
      value=
   instances[15]
      data_class=com.tivoli.am.webseal.cookie-jar.managed-cookies
      instance=webseal
      replication=0
      value_len=-1
      value=reset#;;;
   instances[16]
      data_class=com.tivoli.am.eb.user-name
      instance=sms
      replication=1
      value_len=-1
      value=unauthenticated
   instances[17]
      data_class=com.tivoli.am.sms.user-uuid
      instance=sms
      replication=1
      value_len=-1
      value=(null)
   instances[18]
      data_class=com.tivoli.am.eb.expiry
      instance=sms
      replication=1
      value_len=-1
      value=0x64673dfc
   instances[19]
      data_class=com.tivoli.am.sms.concurrent-session-key-class
      instance=sms
      replication=1
      value_len=-1
      value=com.tivoli.am.eb.user-name
   instances[20]
      data_class=com.tivoli.am.sms.concurrent-session-key-instance
      instance=sms
      replication=1
      value_len=-1
      value=sms
   instances[21]
      data_class=com.tivoli.am.sms.session-index
      instance=sms
      replication=1
      value_len=-1
      value=31cb62e8-f61d-11ed-80fe-0050569b3c40
   instances[22]
      data_class=com.tivoli.am.eb.version
      instance=sms
      replication=1
      value_len=-1
      value=0x1
   instances[23]
      data_class=com.tivoli.am.sms.class
      instance=sms
      replication=1
      value_len=-1
      value=com.tivoli.am.eb
   instances[24]
      data_class=com.tivoli.am.sms.creation-time
      instance=sms
      replication=0
      value_len=-1
      value=0x64672fec
   instances[25]
      data_class=com.tivoli.am.eb.is-inactive
      instance=sms
      replication=1
      value_len=-1
      value=false
   instances[26]
      data_class=com.tivoli.am.eb.last-access
      instance=sms
      replication=0
      value_len=-1
      value=0x64672fec
   instances[27]
      data_class=com.tivoli.am.webseal.multi-domain-session
      instance=webseal
      replication=1
      value_len=-1
      value=false
   instances[28]
      data_class=com.tivoli.am.webseal.flush-sms-session
      instance=webseal
      replication=0
      value_len=-1
      value=false
   instances[29]
      data_class=com.tivoli.am.webseal.version
      instance=webseal
      replication=0
      value_len=-1
      value=0x1

2023-05-19-11:14:36.827+03:00I----- webseald DEBUG8 wns session /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp 2831 0x7f49d3965700
[10.202.6.251] RETURN am_dsess_create_session: sessVer=0, clearOnRead=0, status=0x38a0a13c{noformat}

_This is what think is happening but need your help to chk the DSC client code and confirm the behavior._

{noformat}it seems DSC server is closing the connection after 6 seconds once connection becomes idle, however DSC Client (RP) instance use the stale connection to send the request and it fails. During next attempt, it makes a new connection and process successfully.

Again after 6 seconds, the issue reappears.{noformat}

IBM Support files from Pre Live environment:

{noformat}Primary master hosting DSC: 
/ecurep/sf/TS013/049/TS013049870/2023-05-19/isva_10.0.4.0_20230519-111832_ciam-ps1-pre.rbro.rbg.cc.support_unpack/

RP instance:
/ecurep/sf/TS013/049/TS013049870/2023-05-19/isva_10.0.4.0_20230519-111705_ciam-rp2-pre.rbro.rbg.cc.support_unpack/
instance name: default with routing trace{noformat}

Could you pls confirm if this is defect?","20/May/23 6:05 PM;5b17571a82e05b22cc7d5d9e;Also got the IBM Support file from Production environment:

{noformat}Primary Master hosting DSC:
/ecurep/sf/TS013/049/TS013049870/2023-05-19/isva_10.0.4.0_20230519-115700_PROD_ciam-ps1.rbro.rbg.cc.support_unpack/

Normal node hosting RP default instance:
/ecurep/sf/TS013/049/TS013049870/2023-05-19/isva_10.0.4.0_20230519-120843_PROD_ciam-rp1.rbro.rbg.cc.support_unpack/{noformat}

the intention to collect IBM support file is to see if customer see same behavior in production as currently they hv connection idle timeout set to 5. I am yet to review it.","22/May/23 2:02 AM;5b17571a82e05b22cc7d5d9e;Hi Bhavan,

Observation from the Production IBM support file taken last Friday.
*msg__webseald-default.log*

{noformat}start time: 2023-05-19-08:01:45
end time: 2023-05-19-12:09:58{noformat}

Just within ~4 hours i see ~760 errors where dsc did not return response error seen in logs for 

{noformat}getSession
createSession
terminateSession{noformat}

And this is just one instance. there are other appliances as well.

*Also I could reproduce this issue in my test environment as well.*

_I would need your help to get some findings before the next call with customer on Monday. We can have webex session Monday morning once I start my day to discuss the findings over weekend._","22/May/23 10:01 AM;5b15d954b0d76456f36daf33;[~accountid:5b17571a82e05b22cc7d5d9e] thanks for continuing to work this. I’m happy to have a discussion when you want.

Although I’m getting the message from the escalation/management chain that the customer is happy with the restart workaround in place. They are also pursuing the redis solution more than they want to fix this DSC issue.

I need to know and make sure we are all in sync to be able to prioritize this item correctly. Can you confirm next time you speak to the customer?","23/May/23 12:08 PM;5b17571a82e05b22cc7d5d9e;[~accountid:5b15d954b0d76456f36daf33] management team is still working on proposing the solution however i have been asked to work with L3 to continue working on this and get it fixed. Customer might continue to use DSC with different architecture. 
Lets connect today so i can share my observation and we can get this fixed asap for customer.","23/May/23 2:44 PM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] [~accountid:5b17571a82e05b22cc7d5d9e] 

Thanks for the call. Like discussed, let’s use this item to focus on the production hang issue. Next steps for which include working with the customer to recreate the problem in pre-prod - then traces, cores etc.

For the pre-prod 503 issue, since the customer has opened a separate case, let’s do the same and keep it out of this item.","23/May/23 6:21 PM;5b17571a82e05b22cc7d5d9e;[https://cloudidentity.atlassian.net/browse/ISAMSUP-5091|https://cloudidentity.atlassian.net/browse/ISAMSUP-5091|smart-link] 

for the http 503 service unavailable error ","23/May/23 7:15 PM;5b15d954b0d76456f36daf33;Thanks [~accountid:5b17571a82e05b22cc7d5d9e] 

Let me know when you have the data for this case from the stress test - from the customer’s and/or your local.","23/May/23 7:44 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 



I did a load run again and extracted the dsc core dump and runtime java dump . 

[https://ibm.box.com/s/m3sadt9lzcftudp1zhvxidfhr6pcqr4g|https://ibm.box.com/s/m3sadt9lzcftudp1zhvxidfhr6pcqr4g|smart-link] 

may be if it can give some insight

I also uploaded dscd binary



the local env is at the same level 10.0.40 IF1 plus memory and performance fix of peter",24/May/23 1:05 PM;5b15d954b0d76456f36daf33;Thanks [~accountid:5c53d3ac23f5bf672621c868] I’ll let you know what I find.,"25/May/23 6:47 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

could we also work on our stand on DSessProxyPool size?

by default its 64 and there is no way to increase it.

all the java core that I uploaded onto the box, majority on them are blocked on Dsessproxypool.

I am not saying 64 is not a good default value, but at some time we need to understand there should be a way to increase it and match it with DSC worker threads.



At server side, DSC worker threads 64 is not many times enough and on similar lines , DSeSSProxy pool size of 64 may not be enough



since customer is now progressing towards dedicated DSC . We need to look into the above parameter as well from Federation java code end","26/May/23 1:21 PM;5b15d954b0d76456f36daf33;Sounds good [~accountid:5c53d3ac23f5bf672621c868] 

I’ll work on exposing the dscclient.properties file so that whatever parameyare there can be customised. Once that is done, hopefully the customer can deploy it in their lower env","30/May/23 12:11 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

Customer said they are able to reproduce the issue.



but now seems what data they need to gather: 

Here is the list I documented earlier. Do we need anything other than these?



{noformat}1. DSC core from pid through cli

This you need to do perform from the master node where dsc is runnig,before the systems are restarted( estimated time is 1 to 2 minute)

1.1 open CLI to master node on port 22
1.2 diagnostics monitor top -vi
1.3 find the below process id of dscd process
1.3 example   896   840 root     S    3756m 63.0   1  0.0 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
1.4 here the process id is 896
1.5 exit vi using :q!
1.6 generate dsc core dump by running from cli
1.7  diagnostics core_dumps generate 896
1.8 you will get a response 
A core file has been generated and will be available in the next support file
to be generated



2.Generate java dumps on federation node (time is 1 to 2 mins)
   2.1 goto CLI of federation  runtime ( try to capture it on all the federation nodes, can be done in parallel on all nodes)
    2.2 goto CLI of federation runtime ->  diagnostics java_dumps runtime thread 
    2.3 do the same step on other runtime before restart
   2.5 . continue to step 3

3. Enable DSC trace (time is 1 to 2 mins)
    1. As the performance fix has improvement around tracing . this you can do whenever you are restarting the dsc (since you start DSC any time you can enable this trace right when you receive from me. 
    2. goto LMI -> cluster configuration -> session cache -> set trace level to 1
    3. save

provide support file from , RP,DSC,Fed nodes(which should cover all of their appliances in pre prod){noformat}",30/May/23 12:18 PM;5b15d954b0d76456f36daf33;That sounds like a good list to start with [~accountid:5c53d3ac23f5bf672621c868] ,30/May/23 12:33 PM;5b15d954b0d76456f36daf33;Let me know if you see any similarities between your local recreate and theirs. Especially now that they have overcome the 503 issue in pre-prod.,"31/May/23 8:06 PM;61409dc154762c006932ffc7;Please find attached in the archive ""Trace_Enable_DSC"" all the required files as stated below: 

    Trace level Changed to ""1"" on PS1 and PS2. 

    On the tests peak we've collected the following files:

2.1 PS1

    Support File (isva_10.0.4.0_20230530-111017_ciam-ps1-pre.rbro.rbg.cc.support)

    Java Dump (javacore.20230530.105803.3111.0001.txt javacore.20230530.110917.3111.0002.txt)

    Core Dump for DSC Process (included in the support file)

    Glowroot Screenshot for the response time

    Glworoot Example of slowest traces.

2.2 PS2

    Support File (isva_10.0.4.0_20230530-111429_ciam-ps2-pre.rbro.rbg.cc.support)

    Java Dump (javacore.20230530.105819.3373.0001.txt javacore.20230530.110925.3373.0002.txt)

    Core Dump for DSC Process (included in the support file)

    Glowroot Screenshot for the response time

    Glworoot Example of slowest traces.

2.3 RP1

    Support File (isva_10.0.4.0_20230530-111652_ciam-rp1-pre.rbro.rbg.cc.support)

    Java Dump (javacore.20230530.105825.7256.0001.txt javacore.20230530.110941.7256.0002.txt)

2.4 RP2

    Support File (isva_10.0.4.0_20230530-112244_ciam-rp2-pre.rbro.rbg.cc.support)

    Java Dump (javacore.20230530.105831.6693.0001.txt javacore.20230530.110946.6693.0002.txt)

2.5 RP3

    Support File (isva_10.0.4.0_20230530-112822_ciam-rp3-pre.rbro.rbg.cc.support)

    Java Dump (javacore.20230530.105838.6692.0001.txt javacore.20230530.105955.6692.0002.txt javacore.20230530.110952.6692.0003.txt)

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012925605&path=TS012925605/2023-05-30/&filepath=TS012925605/2023-05-30/Trace_Enable_DSC.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012925605&path=TS012925605/2023-05-30/&filepath=TS012925605/2023-05-30/Trace_Enable_DSC.zip]","01/Jun/23 3:50 PM;5b15d954b0d76456f36daf33;I’ll go over all the support files and see what I find.

Does any part of theirs match your env [~accountid:5c53d3ac23f5bf672621c868] ?","05/Jun/23 2:59 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: cf6cc1d8e97c8c8d6f3db06dd9db8130bc463f9c
   * description: ISAMSUP-5045 ATP to set DSC client proxy pool size

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/977502.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5045) which we publish.","05/Jun/23 3:25 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: eb1b041efc5ccc02935619a6b0d803ccd5d34c92
   * description: ISAMSUP-5045 Update proxy pool size for containers

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/977774.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5045) which we publish.","05/Jun/23 6:22 PM;5b15d954b0d76456f36daf33;While I continue investigating the previously supplied customer files, there is something for them to try in the pre-live environment.

A couple of questions about their recreate of the problem:

* Is there a specific load or time limit before the issue manifests?
* Has L2 confirmed that the issue is the same in prod and pre-prod?

Linked item [https://cloudidentity.atlassian.net/browse/ISAMSUP-5118|https://cloudidentity.atlassian.net/browse/ISAMSUP-5118|smart-link] has a fix pack that allows configuring the DSC proxy pool size. This defines how many proxy pool handles can be cached by a client to improve performance.

See the description for more details and how to set this. Can you have them apply the fix and see what if any changes occur to the recreate? You might need to tweak the value of the ATP to see any different results.

Let me know what you find.","05/Jun/23 6:40 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

this was my update into the case

{noformat}HI



I had a look at the existing core files , majority of the threads were waiting on to get the database pools.



even glowroot had profiles waiting onto to get the db pool connection.



PS1 javacore 1 -> showed 1102 threads wherein 634(58%) majority waiting for db connection ( mostly around oauth flows)



PS1 javacore 2 -> showed around 1434 threads with 1050(74%) majority of these waiting on free db connection.



Although we do see delays, but don't see threads stuck on DSess calls.



In summary, this test shows lot of threads do get stuck on getting db calls.





could you confirm:



1.does the problem go away if you only do a cluster restart in the pre live env?

2.we do need to make sure that pre live , db is also having same maintenance as prod

   which means, disable the cleanup threads from product and use scripts

   make sure tables are cleared of expired entries and database maintenance are performed (in terms of reorg/runstate) and locktimeout is attached at the db level

{noformat}



their pre live core dump didn’t look what I seen in my env.



so confirming from them and waiting for their update",05/Jun/23 7:50 PM;5b15d954b0d76456f36daf33;Thanks [~accountid:5c53d3ac23f5bf672621c868] . I had the same suspicion that those cores weren’t showing anything in DSC holding resources or delaying responses.,"08/Jun/23 4:28 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c841d267bcebca257528a017582609eed7b365f5
   * description: Merge pull request #5980 from ISAM/ISAMSUP-5045

ISAMSUP-5045

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1117448.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230608062526-c841d267.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","08/Jun/23 5:38 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c841d267bcebca257528a017582609eed7b365f5
   * description: Merge pull request #5980 from ISAM/ISAMSUP-5045

ISAMSUP-5045

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1119466.


This build has not been published as the commit is not currently within a branch (20230608061858-b734e6ab) which we publish.","08/Jun/23 5:44 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c841d267bcebca257528a017582609eed7b365f5
   * description: Merge pull request #5980 from ISAM/ISAMSUP-5045

ISAMSUP-5045

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1119617.


This build has not been published as the commit is not currently within a branch (20230608062526-c841d267) which we publish.","13/Jun/23 12:29 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

As discussed Yesterday, Customer has requested I am confirming them 2.30 pm SGT.

----

This is the action plan provided to them

{noformat}We need some time as we need to be very sure on what to collect without affecting production platform.



we are trying to finalize everything they need to turn on/off collect when the recreate happens in prod
We are making use of an internal recreate where we see slow traces at DSC . and then run tracing against it and review and then finalize the tracing to be generated in production.
We are also targeting a call on Thursday with Customer side(your team) L2 and L3 team 
We have also prepared a fix at the Federation runtime(which can be applied in prelive and tested)
This fix tunes or increase the connection pool size which federation uses to connect to DSC
At present the pool size is fixed at 64 ,and we are increasing at 128 
There is a fixpack uploaded has name DSC_Client_Tuning_10040_IF1.fixpack
DSC_Client_Tuning_10040_IF1.fixpack needs to be applied on all the Federation appliances
once the fix is applied, the ATP needs to be set which is 
                          Name:  isam_cluster.dsc.client_proxy_pool_size

value: 128
You need to set ATP on all Federation appliances
once the ATP changes are deployed you need to restart Federation runtime
once you have applied ATP , rerun the load test (just to make sure fix is working ){noformat}

In the meantime, I did another test and pulled out threads from dsc core

In the thread dump , 

[^dscthreadll.txt]

I see log of these threads

Thread 1974 (Thread 0x7f54ae5ab700 (LWP 21549)):
#0  0x00007f54d58273fc in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
No symbol table info available.
#1  0x00007f54d6e4662d in AMWSMSList::consume(bool) () from /usr/lib64/libamdsc_server.so
No symbol table info available.
#2  0x00007f54d6e46fb2 in AMWSMSService::workerThreadRun() () from /usr/lib64/libamdsc_server.so
No symbol table info available.
#3  0x00007f54d6e47089 in start_worker_thread () from /usr/lib64/libamdsc_server.so
No symbol table info available.
#4  0x00007f54d582117a in start_thread () from /lib64/libpthread.so.0
No symbol table info available.
#5  0x00007f54d5338df3 in clone () from /lib64/libc.so.6
No symbol table info available.





grep -i "" AMWSMSList::consume"" dscthreadll.txt |wc -l
1967



I have a configuration of 2k worker thread for dsc

It could be a normal consume and produce model but just highlighting","13/Jun/23 1:52 PM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] that sounds like a plan.

I had looked at the dsc core when you first supplied it. None of those threads seem like they are doing anything unexpected. Mostly waiting to service requests.","15/Jun/23 7:07 PM;5c53d3ac23f5bf672621c868;--update to the customer



Please find the instructions to collect data during the issue



# when you stop the workaround, note down the time
# Enable DSC tracing at trace level **only click on update ( don't do save)
# Observe the environment when the issue occurs
# Upon issue occurrence-> note down the time (make sure the issue shows slowness)
# collect 1 set federation runtime thread dump
# goto CLI of federation runtime ( try to capture it on all the federation nodes, can be done in parallel on all nodes).
# goto CLI of federation runtime -> diagnostics java_dumps runtime thread
# 
# Update DSC tracing to trace level 4 **only click on update (don't do save)
# collect 1 set of runtime thread dumps
#  goto CLI of federation runtime ( try to capture it on all the federation nodes, can be done in parallel on all nodes).
# goto CLI of federation runtime -> diagnostics java_dumps runtime thread
# collect DSC core dump
# open CLI to master node on port 22
# diagnostics monitor top -vi
# find the below process id of dscd process
# example  896  840 root    S   3756m 63.0  1 0.0 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
# here the process id is 896
# exit vi using :q!
# generate dsc core dump by running from cli
# diagnostics core_dumps generate 896
# you will get a response""A core file has been generated and will be available in the next support file""
# to be generated
# Post DSC core file generation
# Disable DSC tracing
# goto dsc trace setting and set 0 and click update
# restore your environment by the usual serivce restart that you follow
# collect support file at Federation runtime nodes, Reverse proxy nodes, DSC appliances











As a separate activity:

1.whenever you see fine , change the connection-idle-timeout to value in pre-live

2.you can apply the dsc client fix on all federation runtime

----

----

--","16/Jun/23 5:34 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] [~accountid:5b15d9517dab4c51f61b5190] 



* Customer tried to receated the issue in prelive(to me it looks similar to what they oberved in production) and they found similar slow traces related to Dsc which they found in production env
* They have provided data , along with dsc cores, dsc traces , java cores at this location
* /ecurep/sf/TS012/925/TS012925605/2023-06-15/DSC_PRELIVE_15_06_2023.zip_unpack/
* dsc core is present at this location
** /ecurep/sf/TS012/925/TS012925605/2023-06-15/DSC_PRELIVE_15_06_2023.zip_unpack/DSC_PRELIVE_15_06_2023/PS1-PRE/isva_10.0.4.0_20230615-161120_ciam-ps1-pre.rbro.rbg.cc.support_unpack/var/support/
** dscd.log.7:[] Trace level set to 1
** they only provided dsc logs with trace level set to 1. ( they haven’t set it to level 4)
** javacores are located in each individual box, 
** I reviewed here
** /ecurep/sf/TS012/925/TS012925605/2023-06-15/DSC_PRELIVE_15_06_2023.zip_unpack/DSC_PRELIVE_15_06_2023/PS1-PRE/javacore.20230615.160626.31595.0011.txt
** count of blocked thread
** {noformat}javacore.20230615.160626.31595.0011.txt
     130
javacore.20230615.160715.31595.0012.txt
     244
javacore.20230615.160805.31595.0013.txt
     244
javacore.20230615.160910.31595.0014.txt
     222
javacore.20230615.161002.31595.0015.txt
     211
javacore.20230615.161041.31595.0016.txt
     260{noformat}
* for all cores from 11 to 16 these are the threads and the numbers of these threads blocked
* {noformat}cat blockedthreads.log|grep -i 'owned by:'|awk -F"":"" '{print $(NF-2)}'|awk -F""("" '{print $1}'|sort -nr|uniq -c
 245  ""Default Executor-thread-4767""
  15  ""Default Executor-thread-4679""
  10  ""Default Executor-thread-4556""
  10  ""Default Executor-thread-4484""
 207  ""Default Executor-thread-4460""
  15  ""Default Executor-thread-4345""
  18  ""Default Executor-thread-4329""
 201  ""Default Executor-thread-4299""
 115  ""Default Executor-thread-4261""
  15  ""Default Executor-thread-4253""
 234  ""Default Executor-thread-4251""
 226  ""Default Executor-thread-4165""{noformat}
* once such thread is""Default Executor-thread-4261 , on this 115 others were waiting on
* {noformat}3XMTHREADINFO      ""Default Executor-thread-4261"" J9VMThread:0x0000000002D4A400, omrthread_t:0x00007FE7F4032828, java/lang/Thread:0x000000041CAC83A8, state:R, prio=5
3XMJAVALTHREAD            (java/lang/Thread getId:0x7844, isDaemon:true)
3XMTHREADINFO1            (native thread ID:0x38CC, native priority:0x5, native policy:UNKNOWN, vmstate:CW, vm thread flags:0x00000081)
3XMTHREADINFO2            (native stack address range from:0x00007FE7B7746000, to:0x00007FE7B7786000, size:0x40000)
3XMCPUTIME               CPU usage total: 0.884294057 secs, current category=""Application""
3XMHEAPALLOC             Heap bytes allocated since last GC cycle=3851544 (0x3AC518)
3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at org/apache/cxf/transport/http/osgi/HTTPTransportActivator.addToSortedInfos(HTTPTransportActivator.java:187(Compiled Code))
5XESTACKTRACE                   (entered lock: org/apache/cxf/transport/http/osgi/HTTPTransportActivator@0x0000000404685260, entry count: 1)
4XESTACKTRACE                at org/apache/cxf/transport/http/osgi/HTTPTransportActivator.updated(HTTPTransportActivator.java:182(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/jaxws/client/LibertyCustomizeBindingOutInterceptor.customizeHttpConduitProperties(LibertyCustomizeBindingOutInterceptor.java:256(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/jaxws/client/LibertyCustomizeBindingOutInterceptor.customizeClientProperties(LibertyCustomizeBindingOutInterceptor.java:214(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/jaxws/client/LibertyCustomizeBindingOutInterceptor.handleMessage(LibertyCustomizeBindingOutInterceptor.java:72(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/phase/PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:273(Compiled Code))
5XESTACKTRACE                   (entered lock: org/apache/cxf/phase/PhaseInterceptorChain@0x00000007BE5E06C8, entry count: 1)
4XESTACKTRACE                at org/apache/cxf/endpoint/ClientImpl.doInvoke(ClientImpl.java:531(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/endpoint/ClientImpl.invoke(ClientImpl.java:464(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/endpoint/ClientImpl.invoke(ClientImpl.java:367(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/endpoint/ClientImpl.invoke(ClientImpl.java:320(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/frontend/ClientProxy.invokeSync(ClientProxy.java:89(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/jaxws/JaxWsClientProxy.invoke(JaxWsClientProxy.java:134(Compiled Code))
4XESTACKTRACE                at com/sun/proxy/$Proxy125.createSession(Bytecode PC:39(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/sms/client/DSessProxy.createSession(DSessProxy.java:129(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/sms/client/DSessSession$CreateSessionMethod.handleRequest(DSessSession.java:472(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/sms/client/DSessProxyPool.handleRequest(DSessProxyPool.java:205(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/sms/client/DSessSession.storeSession(DSessSession.java:120(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/session/dsc/DSCSessionData.storeSession(DSCSessionData.java:129(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/session/dsc/DSCSessionStore.getSession(DSCSessionStore.java:310(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/session/dsc/DSCSession.<init>(DSCSession.java:103(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/authsvc/protocol/delegate/cache/impl/DelegateSessionCacheDSC.retrieveSession(DelegateSessionCacheDSC.java:84(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/authsvc/protocol/delegate/cache/impl/DelegateSessionCacheDSC.querySessionCache(DelegateSessionCacheDSC.java:66(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/authsvc/protocol/delegate/RestAuthSvcDelegate.processRequest(RestAuthSvcDelegate.java:707(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/proper/FederationManager.doInitialRequestOnDelegate(FederationManager.java:476(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/proper/FederationManager.finishProcessingWithDelegateId(FederationManager.java:311(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/proper/FederationManager.processRequest(FederationManager.java:164(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/servlet/SSOPSServletBase.doRequest(SSOPSServletBase.java:129(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/servlet/SPSCommandDispatcher.invoke(SPSCommandDispatcher.java:391(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/war/runtime/liberty/LibertyRuntimeServlet.doGet(LibertyRuntimeServlet.java:56(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/war/runtime/liberty/LibertyRuntimeServlet.doPut(LibertyRuntimeServlet.java:113(Compiled Code))
4XESTACKTRACE                at javax/servlet/http/HttpServlet.service(HttpServlet.java:709(Compiled Code))
4XESTACKTRACE      {noformat}
* similarly Default Executor-thread-4767 on which 245 threads were blocked
* {noformat}XMTHREADINFO      ""Default Executor-thread-4767"" J9VMThread:0x0000000002FEEC00, omrthread_t:0x00007FE7F44A2E28, java/lang/Thread:0x00000004276219A8, state:R, prio=5
3XMJAVALTHREAD            (java/lang/Thread getId:0x7A9E, isDaemon:true)
3XMTHREADINFO1            (native thread ID:0x4211, native priority:0x5, native policy:UNKNOWN, vmstate:CW, vm thread flags:0x00000081)
3XMTHREADINFO2            (native stack address range from:0x00007FE7B72B0000, to:0x00007FE7B72F0000, size:0x40000)
3XMCPUTIME               CPU usage total: 0.631833313 secs, current category=""Application""
3XMHEAPALLOC             Heap bytes allocated since last GC cycle=1037936 (0xFD670)
3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at org/apache/cxf/transport/http/osgi/HTTPTransportActivator.addToSortedInfos(HTTPTransportActivator.java:187(Compiled Code))
5XESTACKTRACE                   (entered lock: org/apache/cxf/transport/http/osgi/HTTPTransportActivator@0x0000000404685260, entry count: 1)
4XESTACKTRACE                at org/apache/cxf/transport/http/osgi/HTTPTransportActivator.updated(HTTPTransportActivator.java:182(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/jaxws/client/LibertyCustomizeBindingOutInterceptor.customizeHttpConduitProperties(LibertyCustomizeBindingOutInterceptor.java:256(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/jaxws/client/LibertyCustomizeBindingOutInterceptor.customizeClientProperties(LibertyCustomizeBindingOutInterceptor.java:214(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/jaxws/client/LibertyCustomizeBindingOutInterceptor.handleMessage(LibertyCustomizeBindingOutInterceptor.java:72(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/phase/PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:273(Compiled Code))
5XESTACKTRACE                   (entered lock: org/apache/cxf/phase/PhaseInterceptorChain@0x00000007BB729B78, entry count: 1)
4XESTACKTRACE                at org/apache/cxf/endpoint/ClientImpl.doInvoke(ClientImpl.java:531(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/endpoint/ClientImpl.invoke(ClientImpl.java:464(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/endpoint/ClientImpl.invoke(ClientImpl.java:367(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/endpoint/ClientImpl.invoke(ClientImpl.java:320(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/frontend/ClientProxy.invokeSync(ClientProxy.java:89(Compiled Code))
4XESTACKTRACE                at org/apache/cxf/jaxws/JaxWsClientProxy.invoke(JaxWsClientProxy.java:134(Compiled Code))
4XESTACKTRACE                at com/sun/proxy/$Proxy125.getSession(Bytecode PC:36(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/sms/client/DSessProxy.getSession(DSessProxy.java:178(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/sms/client/DSessSession$RetrieveSessionMethod.handleRequest(DSessSession.java:518(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/sms/client/DSessProxyPool.handleRequest(DSessProxyPool.java:205(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/sms/client/DSessSession.retrieveSession(DSessSession.java:152(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/session/dsc/DSCSessionData.retrieveSession(DSCSessionData.java:110(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/session/dsc/DSCSessionStore.getSession(DSCSessionStore.java:315(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/session/dsc/DSCSession.<init>(DSCSession.java:103(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/authsvc/protocol/delegate/cache/impl/DelegateSessionCacheDSC.retrieveSession(DelegateSessionCacheDSC.java:84(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/authsvc/protocol/delegate/cache/impl/DelegateSessionCacheDSC.querySessionCache(DelegateSessionCacheDSC.java:66(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/authsvc/protocol/delegate/RestAuthSvcDelegate.processRequest(RestAuthSvcDelegate.java:707(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/proper/FederationManager.doInitialRequestOnDelegate(FederationManager.java:476(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/proper/FederationManager.finishProcessingWithDelegateId(FederationManager.java:311(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/proper/FederationManager.processRequest(FederationManager.java:164(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/servlet/SSOPSServletBase.doRequest(SSOPSServletBase.java:129(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/fedmgr2/servlet/SPSCommandDispatcher.invoke(SPSCommandDispatcher.java:391(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/war/runtime/liberty/LibertyRuntimeServlet.doGet(LibertyRuntimeServlet.java:56(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/war/runtime/liberty/LibertyRuntimeServlet.doPut(LibertyRuntimeServlet.java:113(Compiled Code))
4XESTACKTRACE                at javax/servlet/http/HttpServlet.service(HttpServlet.java:709(Compiled Code))
4XESTACKTRACE                at javax/servlet/http/HttpServlet.service(HttpServlet.java:791(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/webcontainer/servlet/ServletWrapper.service(ServletWrapper.java:1258(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/webcontainer/servlet/ServletWrapper.handleRequest(ServletWrapper.java:746(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/webcontainer/servlet/ServletWrapper.handleRequest(ServletWrapper.java:443(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/webcontainer/filter/WebAppFilterChain.invokeTarget(WebAppFilterChain.java:183(Compiled Code))
4XESTACKTRACE                at com/ibm/ws/webc{noformat}","19/Jun/23 12:45 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] [~accountid:5b15d9517dab4c51f61b5190] 



what would be next action plan here? do we need to request data from production or another test run in pre live is enough.



thanks

tushar","19/Jun/23 1:25 PM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] had a quick look at the dsc logs. It seems they have more sessions/requests coming from webseal than the federation runtime (19 thousand odd hits for default: replicaset vs 180 odd FIM_…)

Also saw that RP1 has 1500 worker threads but the DSC has only 800. Assuming requests are coming simultaneously from RP1 to RP3 and Federation runtimes (which don’t have a specific limit on the worker threads), that seems like a whole lot more client threads/requests compared to the server. That will inevitably result in slowness. Plus the fact that they are storing unauth sessions doesn’t help.

If they are to do another run in the pre-live env, it might as well be with an increased DSC worker thread count. I’m not sure what that number to increase to is. Consideration needs to be given to other services on that box (it has PS and Federation runtime too). May be 8192.

Also do we know where did the 1500 number come from for WebSEALs?","19/Jun/23 3:17 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 1500 is what they have been running in production.

not sure why they scaled down from production 8000 worker threads to 800 in prelive. –  > correction production has 800 threads( may be I misred earlier configuraiton but validated from existing support file)

does dsc trace reveal anything? or trace level 4 is also needed from prelive?

at this point, webseal sessions/requests blocking dsc to serve federation runtime( due to lack of threads) resulting in thread blocks at federation runtime",19/Jun/23 3:22 PM;5c53d3ac23f5bf672621c868;corrected → production has 800 DSC worker threads ,"19/Jun/23 3:33 PM;5c53d3ac23f5bf672621c868;/ecurep/sf/TS012/925/TS012925605/2023-05-04/isva_10.0.4.0_20230504-122406_ciam-rp1.rbro.rbg.cc.support_unpack/var/pdweb/default/etc/webseald-default.conf

been there in production

webseald-default.conf:worker-threads = 1500","19/Jun/23 3:59 PM;5c53d3ac23f5bf672621c868;If I recall:

they have 4 rp appliances(with multiple instances)

/ecurep/sf/TS012/925/TS012925605/2023-05-12/ls

on one RP appliance

they got 3 instances

default has 1500 and uses dsess

{noformat}./cards/etc/webseald-cards.conf
worker-threads = 300
# - Each stream will need a worker-thread to process the one request/response
worker-thread-hard-limit = 100
worker-thread-soft-limit = 90
dsess-enabled = no
# If more than max-worker-threads are in use WebSEAL will immediately close the
# WebSocket threads operate independently from the [server] worker-threads.
max-worker-threads = 0
idle-worker-threads = 0
./oauth/etc/webseald-oauth.conf
worker-threads = 1500
# - Each stream will need a worker-thread to process the one request/response
worker-thread-hard-limit = 100
worker-thread-soft-limit = 90
dsess-enabled = no
# If more than max-worker-threads are in use WebSEAL will immediately close the
# WebSocket threads operate independently from the [server] worker-threads.
max-worker-threads = 20
idle-worker-threads = 0
./default/etc/webseald-default.conf
worker-threads = 1500
# - Each stream will need a worker-thread to process the one request/response
worker-thread-hard-limit = 100
worker-thread-soft-limit = 90
dsess-enabled = yes
# If more than max-worker-threads are in use WebSEAL will immediately close the
# WebSocket threads operate independently from the [server] worker-threads.
max-worker-threads = 5
idle-worker-threads = 0{noformat}



so there are 4 rp appliances → 1 instanc uses dsess with 1500 worker threads

4 *1500 = 6000

4 fed runtime each with 64 proxy pool → 256



seems they would need at minimum 6256++","19/Jun/23 4:04 PM;5c53d3ac23f5bf672621c868;For pre-live env:



They have 3 rps



{noformat}/ecurep/sf/TS012/925/TS012925605/2023-06-15/DSC_PRELIVE_15_06_2023.zip_unpack/DSC_PRELIVE_15_06_2023/RP1-PRE/isva_10.0.4.0_20230615-161910_ciam-rp1-pre.rbro.rbg.cc.support_unpack/var/pdweb/{noformat}

{noformat}for i in `find . -name webseald-*.conf -exec ls {} \;`;do echo $i;egrep 'worker-thread|dsess-enabled' $i;done
./cards/etc/webseald-cards.conf
worker-threads = 300
# - Each stream will need a worker-thread to process the one request/response
worker-thread-hard-limit = 100
worker-thread-soft-limit = 90
dsess-enabled = no
# If more than max-worker-threads are in use WebSEAL will immediately close the
# WebSocket threads operate independently from the [server] worker-threads.
max-worker-threads = 0
idle-worker-threads = 0
./oauth/etc/webseald-oauth.conf
worker-threads = 1500
# - Each stream will need a worker-thread to process the one request/response
worker-thread-hard-limit = 100
worker-thread-soft-limit = 90
dsess-enabled = no
# If more than max-worker-threads are in use WebSEAL will immediately close the
# WebSocket threads operate independently from the [server] worker-threads.
max-worker-threads = 20
idle-worker-threads = 0
./default/etc/webseald-default.conf
worker-threads = 1500
# - Each stream will need a worker-thread to process the one request/response
worker-thread-hard-limit = 100
worker-thread-soft-limit = 90
dsess-enabled = yes
# If more than max-worker-threads are in use WebSEAL will immediately close the
# WebSocket threads operate independently from the [server] worker-threads.
max-worker-threads = 5
idle-worker-threads = 0{noformat}

pre live they have 3 rps with 1500 using dsc

3*1500=4500

2 to 3 fed runtime = 3*64=192 



looks pre live more than 5k would be okay



[~accountid:5b15d954b0d76456f36daf33] what you think?



I can request them to run a test again with bumped up threads and collect the same data which was requested for production",19/Jun/23 6:07 PM;5b15d954b0d76456f36daf33;Sounds good [~accountid:5c53d3ac23f5bf672621c868] those numbers and the potential reason for slowness are the working theory we have based on recent pre-live data,20/Jun/23 12:27 PM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] let me know how the test runs go. Also can you create an APAR for the proxy pool caching ATP? Just so we can track it.,"23/Jun/23 11:13 AM;5c53d3ac23f5bf672621c868;the last comment by customer

--

Hi Tushar,



We noticed a remarkable difference between the first test (the one where we replicated the incident) and the other two tests where we only managed to get a few slowtraces.



But between the last two tests that involved different settings, we didn't notice any big differences.



We expect that after you analyse the statistics collected after the last two tests, you will tell us which results were better.



thanks

----

still needs to go through the data",23/Jun/23 11:22 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] APAR IJ47319 created for DSC Proxy pool ATP,"23/Jun/23 1:31 PM;5b15d954b0d76456f36daf33;_>> We noticed a remarkable difference between the first test (the one where we replicated the incident) and the other two tests where we only managed to get a few slowtraces._

[~accountid:5c53d3ac23f5bf672621c868], I’m not sure what is it they have changed between those two, but I assume you are analysing that. Will wait for more information.","24/Jun/23 1:02 AM;5c53d3ac23f5bf672621c868;There are some stats retrieved from the Logs (could you help to assess along with the load testers)



From the Analysis:



It showed the on 15th jun load test was less



15th June(/mga requests)

Total Noof requests(an estimate). Total N0 of Requests > 6 seconds total No. of requests(400,500,503)

RP1. 19610 11312 12243

RP2 19362 10939 12202

RP3 12689 10313 7776



Summary of June 15

The Total requests received by all for /mga (RP1+RP2+RP3) 51k. and Total Requests for /mga resulted in either 400/500/503 are 32k (which is high) and number of requests more than 6 seconds (includes all time of response) 32k



* No of 400/500/503 responses very high
* number of more than 6 seconds very high





Same stat post 8192 requests increase on 20th June Data



20th June(/mga ,only /mga requests)

Total No. of requests(an estimate). Total No. of Requests > 6 seconds. total No. of requests(400,500,503)

RP1. 15787 741 5321

RP2 14687 784 5009

RP3 15860 746 5734



Total requests around /mga 46k , No of requests with error response at ~15k and total number of requests with more than 6 seconds response time is around 2k (very significant improvement





There is also an observation of 20th June data

If I consider total number of requests each RP received(including /mga and non mage requests which will create authenticated and unauthenticated session by reverse proxy into DSC) has some interesting observation



Total No. of requests(an estimate). Total No. of Requests > 6 seconds.

RP1. 141526 828

RP2 140627 873

RP3 142092 818





The Important thing to note here is that total number of requests on 3 rp is around 424k



and on 15th June the request including /mga 61k



on 20th June there was a huge jump is is 7 times in mga+non mga requests. which would have put a more load on DSC but still DSC and federation showed better performance on 20th june of test when dsc threads were increased to 8192







* *Summary*
* *Increase webseal worker threads to 8192 has provided a good improvement*
* Still can't tell if its enough for production as during production cluster restart helps to better the performance
* the same situation is set to be seen in pre live testing where performance improvement is seen when cluster service is restarted
* Load Tester team needs to be checked on why there are huge jump on total number of requests , we need to keep non /mga requests at the same par between 15th and 20 june to further observe performance improvement
* Customer team needs to check
* Whether during performance test and restart of cluster services stabilizes the issue
* Load Tester team to see whether they further need to adjust non /mga requests to not overshoot like 20th June or if there can be a similar balance could be maintained between /mga and non /mga requests",In Progress
Webseal is non responsive and the user experiences extreme slowness ,ISAMSUP-5028,296339,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Highest,Done,Peter Horner,5b15d9517dab4c51f61b5190,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,26/Apr/23 1:05 PM,10/May/23 9:11 PM,14/Jul/23 2:47 PM,10/May/23 9:11 PM,,,,0,,,,"HI

I was on the webex when the problem occurred on 20th at around 5 pm SGT

Problem:

The customer has experienced reverse proxy extreme slowness which means the backend application were taking a very long time.

I have tried to determine the following during webex:

1.threads stats. → with the slowness build up , the thread showed to be at 402 ( out of 2400) but eventually even server task command was getting stuck 

2.CPU mHz was around 6204 mHz ( there was spike around 50% to lower 80%) refer to the picture

3.when I checked ps -vi  only reported very low cpu stats( , see the picture) 85% was idle and reverse proxy taking 14.9 percent

4. inability to run server task command against that webseal was alarming





All the relevant support files are located at

/ecurep/sf/TS011/995/TS011995343/2023-04-20

*only refer to these as customer had a support file create issue which I fixed by removing rolled over logs then only I could get these

Date and time of the issue:

1.x18gcldwseal2a. → from 4.30 to 5 pm SGT ( time of the exact issue at 4.55.20 pm SGT)

support file is here

isva_10.0.4.0_20230420-174826_x18gcldwseal2a.vsi.sgp.dbs.com.support_unpack

two core files located

{noformat}-rwxrwxr-x 1 ecuunpck swsupt 5199257056 Apr 20 09:48 ./isva_10.0.4.0_20230420-174826_x18gcldwseal2a.vsi.sgp.dbs.com.support_unpack/var/support/core_webseald
-rwxrwxr-x 1 ecuunpck swsupt 5200250384 Apr 20 10:05 ./isva_10.0.4.0_20230420-180528_x18gcldwseal1a.vsi.sgp.dbs.com.support_unpack/var/support/core_webseald
{noformat}

-rw-r--r--    1 root     www-data 5199257056 Apr 20 17:48 core_webseald

it was collected at similar other occurrence.

version information is 10.0.4.0 (without any IF)



changed ssl-max-entries=ssl-max-entries = 1048576



some of the backends have show a high response time and customer disabled max-cached-persistent-connections for junction to 0



but still haven’t helped.



I am working onto  see the request.log on what happened just before the issue.



can someone from l3 help to look into the core dump to see if any userful pattern could be found ",,BRIANORO,Nick Lloyd,,,,,,,,,,,,,,6154906364ff01007106e189,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,26/Apr/23 1:15 PM;tushar.prasad;image-20230426-031430.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197916,26/Apr/23 1:15 PM;tushar.prasad;image-20230426-031512.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197917,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011995343,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,DBS Singapore,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1axrz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-26 15:42:34.486,,,,,"26/Apr/23 1:12 PM;5c53d3ac23f5bf672621c868;one of the gdp is on l3 system at /ecurep/TS011995343. ([l3pmrsupport.tivlab.austin.ibm.com|http://l3pmrsupport.tivlab.austin.ibm.com])

/ecurep/sf/TS011/995/TS011995343/2023-04-20/isva_10.0.4.0_20230420-174826_x18gcldwseal2a.vsi.sgp.dbs.com.support_unpack/var/support/



grep ""#0""  threadapplybtfull.txt|awk '{print $4}'|sort -nr|uniq -c
      2 tcgetpgrp
      4 putpwent
   1837 pthread_cond_wait@@GLIBC_2.3.2
    171 pthread_cond_timedwait@@GLIBC_2.3.2
     14 fts_sort
      1 connect
      1 _nss_files_parse_pwent
      1 __pthread_enable_asynccancel
    557 __pthread_cleanup_upto
      1 __open_catalog","26/Apr/23 1:15 PM;5c53d3ac23f5bf672621c868;one of the cpu graph

!image-20230426-031430.png|width=2160,height=1122!



during the problem the cpu line stays flat(with very little fluctuations )



but system reports something on this line

!image-20230426-031512.png|width=2160,height=1122!

you can assume there is little bit of fluctuations","26/Apr/23 1:36 PM;5c53d3ac23f5bf672621c868;I had seen a crash ( the way I know is )



I was looking into ps -vi during the issue and then later  ps -vi ( the process id changed and the logs showed startup of rp)

current junction stats

{noformat} 4 tcp
    152 ssl
      1 local{noformat}","26/Apr/23 5:40 PM;5c53d3ac23f5bf672621c868;557 __pthread_cleanup_upto

Thread 928 (LWP 25426):
#0  0x00007fa5dd30a75d in __pthread_cleanup_upto () from /lib64/libpthread.so.0
No symbol table info available.
#1  0x00007fa5dd305286 in __pthread_mutex_unlock_full () from /lib64/libpthread.so.0
No symbol table info available.
#2  0x00007fa5dd2f8378 in std::string::_Rep::_S_empty_rep_storage () from /usr/lib64/libstdc++.so.6
No symbol table info available.
#3  0x0000000000000000 in ?? ()
No symbol table info available.","27/Apr/23 1:42 AM;5b15d94b6256d01ad54eb020;This Jira was  created over 12 ago ( at the time I typed this).  [~accountid:5c53d3ac23f5bf672621c868] Have you talked  to anyone in L3  about this  yet?   [~accountid:5b232b2fd85e5b59b066f57f]   I’m surprised this wasn’t updated.

I looked at the case and it looks like you are waiting the customer to apply the pstack fixpack the next time the occurs. We can start looking at the support files  but in the meantime I’m changing response due back to L2.","27/Apr/23 2:05 AM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868] The support file you referred to,

isva_10.0.4.0_20230420-174826_x18gcldwseal2a.vsi.sgp.dbs.com.support

doesn’t have any webseal logs.","27/Apr/23 11:24 AM;5b15d9517dab4c51f61b5190;The core files from 20230420 show lots of threads in mutex waits trying to write gskit trace

Trace files filling all files within a minute

{noformat}/var/pdweb/prod/server-root/lib/junction-root:
total 268204

-rw-------    1 ivmgr    ivmgr      4554507 Apr 20 17:48 gskit.trace.out
-rw-r-----    1 ivmgr    ivmgr     30000058 Apr 20 17:48 gskit.trace.out.1
-rw-r-----    1 ivmgr    ivmgr     30000059 Apr 20 17:48 gskit.trace.out.2
-rw-r-----    1 ivmgr    ivmgr     30000145 Apr 20 17:48 gskit.trace.out.3
-rw-r-----    1 ivmgr    ivmgr     30000037 Apr 20 17:48 gskit.trace.out.4
-rw-r-----    1 ivmgr    ivmgr     30000102 Apr 20 17:48 gskit.trace.out.5
-rw-r-----    1 ivmgr    ivmgr     30000105 Apr 20 17:48 gskit.trace.out.6
-rw-r-----    1 ivmgr    ivmgr     30000053 Apr 20 17:48 gskit.trace.out.7
-rw-r-----    1 ivmgr    ivmgr     30000017 Apr 20 17:48 gskit.trace.out.8
-rw-r-----    1 ivmgr    ivmgr     30000017 Apr 20 17:48 gskit.trace.out.9{noformat}

gskit trace settings

{noformat}GSK_TRACE_FILE = gskit.trace.out
GSKTRACE_NOBUFFERING = YES
GSK_TRACE_FILE_SIZE = 30000000
GSK_TRACE_FILE_NUMBER = 10{noformat}

It looks like gskit trace  has been left enabled for years

If not being used for problem determination - gskit trace should be disabled

But if you need gskit trace - then making the files bigger may help (a bit)

Since wrapping all 10 files within a minute - suggest making files 10 times bigger

{{GSK_TRACE_FILE_SIZE = 300000000}}","27/Apr/23 11:35 AM;5c53d3ac23f5bf672621c868;Thanks [~accountid:5b15d9517dab4c51f61b5190] 

I was thinking something was enabled. I checked for routing but missed to check on gskit.

that’s very helpful ","27/Apr/23 11:35 AM;5b15d9517dab4c51f61b5190;If gsk_secure_soc_init is blocked (by waiting for mutex) - it would also explain why server task commands fail -

as it will timeout on the ssl handshake.","10/May/23 7:55 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9517dab4c51f61b5190] 

thanks for your help. that was the exact problem and it helped stabilize env.



the Jira can be closed",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Ministry of Finance Singapore faced service disruption on 3rd Jan ,ISAMSUP-4686,274643,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Highest,Done,Peter Horner,5b15d9517dab4c51f61b5190,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,05/Jan/23 11:47 AM,22/Feb/23 7:51 PM,14/Jul/23 2:47 PM,22/Feb/23 7:51 PM,,,,0,,,,"HI

Here is the context of the information 

Singapore government use containerized verify access  in AWS EKS

The flow they faced disruption : 

At around 12 pm SGT, they started to get error TAM_OP=error  and the users couldn’t be sent to the login page

Brief summary of the flow:

1.Government as agency which connects to /authorize endpoint(protected by webseal)

2.this request will result in login with tam_op=login

At the time of the issue , tam_op was thrown as error tam_op=error



Customer tried to restart services started from DSC at around 12.45  but they again faced issue in sometime and they attempted 2 more attempts to restart all the container services which helped to resolve the issue at around 15.00



None of the logs are persisted in to the containers and all are sent to the cloud watch.

There are DSC errors observed which is provided in the screenshot here:

S:\sf\TS011\699\TS011699124\2023-01-04\kibana_screenshot.zip



Due to PI restrictions by customer.  snapshots and support files are not provided freely and we have some delay and we are working on to get it addressed.



In the meantime, tech sales team visited customer and prepared a document which is attached into the case.



Basically they started to observe DSC error when the users started to raise the issue which was around 12 pm SGT



graph is shown here



[https://ecurep.mainz.de.ibm.com/rest/download/TS011699124/2023-01-04/kibana_screenshot/kibana screenshot/wrp2.PNG?fileSize=256391&clientId=ae5|https://ecurep.mainz.de.ibm.com/rest/download/TS011699124/2023-01-04/kibana_screenshot/kibana%20screenshot/wrp2.PNG?fileSize=256391&clientId=ae5]



I am requesting other log from cloud watch which will give an idea on what happened during this time.



The Verify Access version is 10.0.4.0",,cholt@us.ibm.com,khansen,Nick Lloyd,Nilesh Amrutkar,prashant_kamat,Tushar Prasad,,,,,,,,,,5b15d994dda5f94d06b985b2,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b1757156d76184b7d98a0c3,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011699124,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,ministry of finance Singapore,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17eqn:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-05 03:45:51.712,,,,,"05/Jan/23 1:45 PM;5b15d9517dab4c51f61b5190;[~accountid:5c53d3ac23f5bf672621c868] I am on vacation till monday but had a quick look. 

I see in exception1.png remote connection terminated ssl handshake. 

This can happen for a number of reasons

# DSC took too long - usually due to not enough threads to handle all the clients. Dont have config - default is 64 - if its default increase to 200 - I would suggest increasing regardless
# The request to the primary DSC failed - so retrying to secondary. If the request in the log was to the secondary DSC and  secondary DSC is still connected to primary DSC - then this error is expected. Only primary will respond . Secondary will only respond after it logs a becoming active message in DSC log

Since it starts working after DSCs are restarted - we can rule out any issues with certificates

In the wrp.png I see error 0x38cf042f

Not sure if this applies as it is a configuration error [https://philipnye.com/2015/06/02/isam-eai-server-error-0x38cf042f/|https://philipnye.com/2015/06/02/isam-eai-server-error-0x38cf042f/|smart-link] - more likely because of DSC issues

The errors in wrp1.png are session not found - if a session create fails - it still tries to delete the session - in case the session was created in the DSC and the error was in the response side of the request. If the original create was never process by the DSC the not found is expected.

wrp3 errors are sms (DSC) unavailable. When a network error occurs - wrp has to determine - if it was a transient error (network) or a failover (eg DSC restarted). So until it wrp has reconnected to a DSC  (by a successful joinreplicaset) all requests fail with unavailable.

wrp5.png is a DSC restart failure because wasnt shutdown cleanly. So operating system wont let it bind to one of the ports it is configured to listen on. Only solution is to wait till operating system times out and cleans up - then restart container.

wrp6 is one DSC failing to communicate with another DSC - usually when the second DSC is being restarted","05/Jan/23 2:25 PM;5c53d3ac23f5bf672621c868;just got the snapshot files for two set of containers:

S:\sf\TS011\699\TS011699124\2023-01-05\



some brief:

Problem: Reverse proxy / federation runtime fails to complete OIDC op flow and results in TAM_OP error Env: Customer has deployed verify access 10.0.4.0 container image in AWS EKS env which had been running fine for many months and faced issue when customer came back after 1 and half week of change freeze The have two sets multiple pods of reverse proxy running with its two dsc pod and 1 config container reverse proxy storing sessions in DSC(authenticated as well as unauthenticated) multiple pods of federation runtime running with its own config container and dsc pods federation runtime storing http session into DSC





so far. no message logs has been provided other than some screenshots","05/Jan/23 4:58 PM;5c53d3ac23f5bf672621c868;HI



I had a look at some configuration setting from snapshot file.(while I continue to wait for message logs which are crucial to give some indication)



Highlighting some red flags from DSC



initial configuration reviewDSC :



# DSC worker thread is configured at default 64 . Since this is a production env . A load is anticipated and hence this setting should have been tuned.
## Running with low worker threads will cause dsc to unable to process request under high load
# Session timeout at DSC is set at 7200 and in webseal its set at 7200 ,  session timeout of DSC > session timeout setting for reverse proxy
## Unnecessary expired session checks . Reverse proxy has a local copy of session cache which should have expiry less then dsc otherwise rp will think the session is not expire and will make unwanted session updates for entries which are already expired.
# No unauth timeout has been specified. Since unauthenticated sessions are stored in DSC . There are no unauth timeout specified and when not then 7200 will be applicable which is not required at all and will put additional load.  recommendation is to specify both. Unauth-max-entries and unauth-timeout .
## When the settings are not specified explicitly , it will share with authenticated entries.







some configuration of webseal to note :

dsess-enabled = yes

user-session-ids = yes

create-unauth-sessions = yes

timeout = 7200





Similarly dsc configuration from snapshot



<dsc worker_threads=""64"" max_session_lifetime=""7200"" client_grace=""600"" service_port=""443"" replication_port=""444"" connection_idle_timeout=""0"">

<servers>

<server idx=""0"" ip=""ndi-spcp-wr





*Note:*



The below is not an issue . It’s a configuration which suggests that when authorize endpoint is accessed it will get redirected for login. But I will still need pdweb.debug

From the production to confirm the flow



customer has local response redirect enabled --> local-response-redirect-uri = /spservice/.   --> this points that webseal will redirect the response



which explains redirect with error macro



""""/spservice/?TAM_OP=error&URL=%2Ffed%2Fsps%2Fo","06/Jan/23 1:31 PM;5b209ff1a56d9112a2a6f638;Received ACL information attached on /authorize endpoint.

* Object show

/ecurep/sf/TS011/699/TS011699124/2023-01-06/TS011699124_UNAUTH_ACL_AuthorizeEndPoint_Screenshot.png

* ACL definition of isam_oauth_unauth

/ecurep/sf/TS011/699/TS011699124/2023-01-05/5-jan_IBM_request.zip_unpack/5-jan IBM request/ibm request acl for authorization2.PNG

* They could not set pdweb.debug trace from pdadmin command.

/ecurep/sf/TS011/699/TS011699124/2023-01-05/5-jan_IBM_request.zip_unpack/5-jan IBM request/unable to see trace.PNG

* Log files

/ecurep/sf/TS011/699/TS011699124/2023-01-05/Log11_2_.zip_unpack/Log11/

/ecurep/sf/TS011/699/TS011699124/2023-01-05/Archive.zip_unpack/","06/Jan/23 4:45 PM;5c53d3ac23f5bf672621c868;thanks [~accountid:5b15d9517dab4c51f61b5190] 



Indeed they are running on a low dsc worker threads . ",07/Jan/23 5:05 AM;5b15d94b6256d01ad54eb020;I moved the response due back to L2 since it looks like Peter’s suggestion is the correct change to try first.,22/Feb/23 7:51 PM;5b15d9517dab4c51f61b5190;Customer has agreed to close case - so closing this item,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
GSO provisioning using Registry Direct API on Container deployments.,ISAMSUP-4966,293188,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Highest,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,adarsh.nair,605c0c04b18de50071046740,adarsh.nair,605c0c04b18de50071046740,10/Apr/23 6:21 PM,22/May/23 1:19 PM,14/Jul/23 2:47 PM,22/May/23 1:19 PM,,Support,,0,,,,"Customer has below query.

GSO provisioning using Registry Direct API on Container deployments

What options we have for provisioning GSO in ISVA container deployment as there is no Authorization server to configure TAM API and Registry Direct API doesn’t support GSO credentials.

Do we have pdadmin API in container based deployments?

 This requirement is support Oracle EBS with form based SSO as there are no other supporting SSO mechanisms.

[https://www.ibm.com/docs/en/sva/10.0.5?topic=reference-registry-direct-java-api|https://www.ibm.com/docs/en/sva/10.0.5?topic=reference-registry-direct-java-api|smart-link] 

As per the doc 'Registry Direct Java API provides attribute *read-only* Global Sign On (Single Sign On resource credential) support. It does not create, enable, disable, or delete the users that are enabled for Global Sign On.'",,Tushar Prasad,Yutaka Kanemoto,,,,,,,,,,,,,,5c53d3ac23f5bf672621c868,5b15d9ec6d76184b7d989c83,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012650892,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,adarsh.nair,605c0c04b18de50071046740,,,,THE GREAT EASTERN LIFE ASSURANCE COMPANY LIMITED,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1aelz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-10 14:15:57.696,,,,,11/Apr/23 12:15 AM;5b15d94b6256d01ad54eb020;The Registry Direct API can connect to an auth server or as the name implies directly to an LDAP server.  Can explain in more detail how you are wanting to use the API?,"11/Apr/23 7:34 PM;605c0c04b18de50071046740;The customer is looking  for options available for provisioning GSO resources in container deployment using TAM API.
In container environment there is no authz server available. 
The Policy server port is not exposed.


As per the documentation for Registry Direct Java API '*This API provides attribute read-only Global Sign On (Single Sign On resource credential) support.'*
[https://www.ibm.com/docs/en/sva/10.0.5?topic=reference-registry-direct-java-api|https://www.ibm.com/docs/en/sva/10.0.5?topic=reference-registry-direct-java-api|smart-link] 

So how can customer provision GSO resources in container deployment ?
","12/Apr/23 5:15 AM;5b15d9e581c3df12acf53c4a;As the name suggest, Registry Direct API does not need Policy Server or Authorization server, it goes directory to registry server i.e. LDAP server, so there should not be any difference in container environment.","21/Apr/23 3:28 PM;605c0c04b18de50071046740;In container environment Policy server port is not exposed so TAM/Verify Access Admin API's which require Policy server to be accessible will fail.
Authorization server component is not available.
so Svrsslcfg is not an option…so existing Admin API’s and AuthorizationContext apis will not work.
please correct me If I’m wrong.

Registry Direct API does not require Svrsslcfg, but 

*Does Registry Direct Api provide an option to create GSO resource?*
*If so which RGY API ?*

looking for RGY direct API  equivalent to below pdadmin commands.
*Could you please help with a working set of equivalent Registry direct API’s for below pdadmin commands?*

{noformat}rsrccred create resource_name rsrcuser resource_userid rsrcpwd resource_password rsrctype {web|group} user user_name

user create –gsouser  user_name dn cn sn password [groups]{noformat}


As per the documentation, we can pass RgyAttributes object in createNativeUser and 	createUser methods.

{noformat}createNativeUser​(java.lang.String userId, java.lang.String userNativeId, char[] password, boolean bypassPasswordPolicy, RgyAttributes rgyAttributes, java.util.Set<java.lang.String> groupIds){noformat}


I tried below piece of code ..but it resulted in error

{noformat}import java.util.ArrayList;
import java.util.;
import java.net.;
import http://java.io .;
import com.tivoli.pd.rgy.ldap.;
import com.tivoli.pd.rgy.*;

public final class rgyregistrypmr
{
 public static void main (String [] argv)
    {

URL propertiesUrl = null;
try {
propertiesUrl = new URL(""file:///root/pdjrte-10.0.2.0/pdjrte/java/export/rgy/testapi.properties"");
}
catch (MalformedURLException e) {
e.printStackTrace();
System.exit(1);
}

RgyRegistry rgyRegistry = null;
try {
RgyRegistry lrgyRegistry =  LdapRgyRegistryFactory.getRgyRegistryInstance(propertiesUrl, null);

String mypass = ""P@ssword"";
Set<String>  groupset= new HashSet<String>();
RgyAttributes rgyAttributes = lrgyRegistry.newRgyAttributes();
//rgyAttributes.putAttribute(RgyAttributes.IS_GSO_USER_NAME,RgyAttributes.BOOL_TRUE_VALUE);
rgyAttributes.putAttribute(RgyAttributes.COMMON_NAME_NAME,""gso3"");
rgyAttributes.putAttribute(RgyAttributes.SURNAME_NAME,""xyzzz"");

rgyAttributes.putAttribute(RgyAttributes.RES_CRED_ID,""T:gsorsrc"");
rgyAttributes.putAttribute(RgyAttributes.RES_CRED_OBJ_CLASS,""secResCreds"");
rgyAttributes.putAttribute(RgyAttributes.RES_CRED_TYPE,""1"");
rgyAttributes.putAttribute(RgyAttributes.RES_CRED_UID,""testuser"");
rgyAttributes.putAttribute(RgyAttributes.RES_CRED_VALID,""TRUE"");
rgyAttributes.putAttribute(RgyAttributes.RESOURCE_CREDENTIALS_NAME,""abcd"");

//RgyUser user1 = lrgyRegistry.createUser(""Default"",""gso3"",""cn=gso2,o=ibm,c=in"", mypass.toCharArray(),true,rgyAttributes,groupset);

RgyUser user1 = lrgyRegistry.createNativeUser(""gso3"", ""cn=gso3,o=ibm,c=in"", mypass.toCharArray(),true,rgyAttributes,groupset);

}
catch (RgyException e) {
e.printStackTrace();
System.exit(1);
}
    }
}

{noformat}

/opt/IBM/ibm-java-x86_64-80/bin/java -cp /root/pdjrte-10.0.2.0/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:. rgyregistrypmr


{noformat}Apr 20, 2023 10:08:07 PM com.tivoli.pd.rgy.ldap.LdapRgyRegistry constructor
INFO: Full version = 10.0.2.0
com.tivoli.pd.rgy.exception.ObjectClassViolationRgyException: HPDAA0323E   The operation violates the schema rules for the registry.
        at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.jndiToRgyExceptionAndExpireTime(LdapRgyRegistry.java:1080)
        at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.jndiToRgyException(LdapRgyRegistry.java:932)
        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr$JndiOperation.retryJndiOperation(LdapRgyHandleMgr.java:2451)
        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.add(LdapRgyHandleMgr.java:1947)
        at com.tivoli.pd.rgy.ldap.LdapRgyUserMgr.createNativeUser(LdapRgyUserMgr.java:1591)
        at com.tivoli.pd.rgy.ldap.LdapRgyUserMgr.createUserInternal(LdapRgyUserMgr.java:1920)
        at com.tivoli.pd.rgy.ldap.LdapRgyUserMgr.createNativeUser(LdapRgyUserMgr.java:1787)
        at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.createNativeUser(LdapRgyRegistry.java:336)
        at rgyregistrypmr.main(rgyregistrypmr.java:47)
Caused by: javax.naming.directory.SchemaViolationException: [LDAP: error code 65 - GLPRDB050E Attribute secResCreds was not found in the schema definition.
]; remaining name 'cn=gso3,o=ibm,c=in'
        at com.sun.jndi.ldap.LdapCtx.mapErrorCode(LdapCtx.java:3302)
        at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:3217)
        at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:3008)
        at com.sun.jndi.ldap.LdapCtx.c_createSubcontext(LdapCtx.java:853)
        at com.sun.jndi.toolkit.ctx.ComponentDirContext.p_createSubcontext(ComponentDirContext.java:353)
        at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.createSubcontext(PartialCompositeDirContext.java:280)
        at javax.naming.directory.InitialDirContext.createSubcontext(InitialDirContext.java:213)
        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr$AddJndiOperation.invoke(LdapRgyHandleMgr.java:2023)
        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr$JndiOperation.retryJndiOperation(LdapRgyHandleMgr.java:2443)
        ... 6 more{noformat}",24/Apr/23 8:18 PM;605c0c04b18de50071046740;Could you please update?,"25/Apr/23 1:42 AM;5b15d9e581c3df12acf53c4a;[https://www.ibm.com/docs/en/sva/10.0.2?topic=reference-registry-direct-java-api|https://www.ibm.com/docs/en/sva/10.0.2?topic=reference-registry-direct-java-api|smart-link] 

h1. Registry Direct Java API

Last Updated: 2022-03-01

The Registry Direct API directly accesses the underlying Security Verify Access registry rather than through Authorization servers or Policy Server.

This API also provides access to most of the underlying registry user attributes and the attributes available through the traditional Security Verify Access Java™ API.

The advantages of this API are as follows:

* Removes the dependency on the Policy Server, a single point of failure.
* Provides more attribute access for developers.
* Improves performance and scalability.

*_This API provides attribute read-only Global Sign On (Single Sign On resource credential) support. It does not create, enable, disable, or delete the users that are enabled for Global Sign On._*",22/May/23 1:19 PM;5ac57757d9a96536d1f0daa9;Case closed. Closing WI.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
After upgrade to 10.0.5.0 STS chain returns error for /tfimsso junction.,ISAMSUP-4806,282970,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Highest,Done,Peter Horner,5b15d9517dab4c51f61b5190,adarsh.nair,605c0c04b18de50071046740,adarsh.nair,605c0c04b18de50071046740,21/Feb/23 4:04 PM,09/Mar/23 7:35 AM,14/Jul/23 2:47 PM,09/Mar/23 7:35 AM,10.0.6,,,0,,,,"After upgrade to 10.0.5.0 STS chain returns error for /tfimsso junction.

for the original Federation STS issue, customer has uploaded new set of support files from Federation component of both 10.0.4.0(working) and 10.0.5.0(non-working)

from 10.0.4.0 message logs I could see below extension related messages 'Adding the extensions from bundle' during Fed runtime startup.

S:\sf\TS011\921\TS011921981\2023-02-14\isva_10.0.4.0_20230214-193311_pdcoe1vas02-m_Federation.support_unpack\tmp\liberty_runtime_dump.zip_unpack\logs\messages.log

{noformat}Line  43: [2/14/23, 19:12:56:755 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.transports.http.3.2 (159) [org.apache.cxf.transport.http.HTTPTransportFactory, org.apache.cxf.transport.http.HTTPWSDLExtensionLoader, org.apache.cxf.transport.http.policy.HTTPClientAssertionBuilder, org.apache.cxf.transport.http.policy.HTTPServerAssertionBuilder, org.apache.cxf.transport.http.policy.NoOpPolicyInterceptorProvider]
	Line  44: [2/14/23, 19:12:56:766 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.core.3.2 (163) [org.apache.cxf.phase.PhaseManager, org.apache.cxf.workqueue.WorkQueueManager, org.apache.cxf.buslifecycle.BusLifeCycleManager, org.apache.cxf.endpoint.ServerRegistry, org.apache.cxf.endpoint.EndpointResolverRegistry, org.apache.cxf.headers.HeaderManager, org.apache.cxf.service.factory.FactoryBeanListenerManager, org.apache.cxf.endpoint.ServerLifeCycleManager, org.apache.cxf.endpoint.ClientLifeCycleManager, org.apache.cxf.resource.ResourceManager, org.apache.cxf.catalog.OASISCatalogManager, org.apache.cxf.transport.http.HTTPTransportFactory, org.apache.cxf.common.util.ASMHelper, org.apache.cxf.common.spi.ClassLoaderService, org.apache.cxf.transport.http.HTTPConduitFactory, org.apache.cxf.transport.ConduitInitiator]
	Line  45: [2/14/23, 19:12:56:790 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.ws.addr.2.6.2 (246) [org.apache.cxf.ws.addressing.policy.AddressingAssertionBuilder, org.apache.cxf.ws.addressing.policy.UsingAddressingAssertionBuilder, org.apache.cxf.ws.addressing.policy.AddressingPolicyInterceptorProvider, org.apache.cxf.ws.addressing.impl.AddressingWSDLExtensionLoader, org.apache.cxf.ws.addressing.WSAddressingFeature$WSAddressingFeatureApplier, org.apache.cxf.ws.addressing.MAPAggregator$MAPAggregatorLoader]
	Line  46: [2/14/23, 19:12:56:793 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.bindings.soap.2.6.2 (248) [org.apache.cxf.binding.soap.SoapBindingFactory, org.apache.cxf.binding.soap.SoapTransportFactory]
	Line  47: [2/14/23, 19:12:56:796 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.bindings.xml.2.6.2 (254) [org.apache.cxf.binding.xml.XMLBindingFactory, org.apache.cxf.binding.xml.wsdl11.XMLWSDLExtensionLoader]
	Line  48: [2/14/23, 19:12:56:798 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.frontend.jaxws.2.6.2 (256) [org.apache.cxf.jaxws.context.WebServiceContextResourceResolver]
	Line  49: [2/14/23, 19:12:56:800 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.management.2.6.2 (258) [org.apache.cxf.management.InstrumentationManager]
	Line  50: [2/14/23, 19:12:56:803 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.transports.http.2.6.2 (264) [org.apache.cxf.transport.http.HTTPTransportFactory, org.apache.cxf.transport.http.HTTPWSDLExtensionLoader, org.apache.cxf.transport.http.policy.HTTPClientAssertionBuilder, org.apache.cxf.transport.http.policy.HTTPServerAssertionBuilder, org.apache.cxf.transport.http.policy.NoOpPolicyInterceptorProvider]
	Line  51: [2/14/23, 19:12:56:810 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator    {noformat}

In 10.0.5.0 it's missing.
S:\sf\TS011\921\TS011921981\2023-02-14\isva_10.0.5.0_20230214-201226_pdcoe1vas02-m.Federation.support_unpack\tmp\liberty_runtime_dump.zip_unpack\logs\messages.log

from 10.0.5.0 trace log not much information available.

S:\sf\TS011\921\TS011921981\2023-02-14\isva_10.0.5.0_20230214-201226_pdcoe1vas02-m.Federation.support_unpack\tmp\liberty_runtime_dump.zip_unpack\logs\trace.log

{noformat}[2/14/23, 20:07:57:737 AEDT] 00000027 id=00000000 com.tivoli.am.fim.sts.jaxws.handlers.RemoveSoapActionHandler > handleMessage ENTRY
[2/14/23, 20:07:57:738 AEDT] 00000027 id=00000000 com.tivoli.am.fim.sts.jaxws.handlers.RemoveSoapActionHandler 3 handleMessage Removed SOAPAction HTTP header with value [""null""]
[2/14/23, 20:07:57:738 AEDT] 00000027 id=00000000 com.tivoli.am.fim.sts.jaxws.handlers.RemoveSoapActionHandler 3 handleMessage RemoveSoapActionHandler::handleMessage():	ArrayList	http_header_content_type_string={content-type}	content_type_value_object.getClass().getName()={java.util.ArrayList}	content_type_value_object.toString()={[text/xml; charset=UTF-8]}

[2/14/23, 20:07:57:738 AEDT] 00000027 id=00000000 com.tivoli.am.fim.sts.jaxws.handlers.RemoveSoapActionHandler < handleMessage RETURN
[2/14/23, 20:07:57:752 AEDT] 00000027 id=00000000 javax.xml.soap                                               W Using deprecated META-INF/services mechanism with non-standard property: javax.xml.soap.MetaFactory. Property javax.xml.soap.SAAJMetaFactory should be used instead.{noformat}

10.0.5.0 tfimsso log gives following error
 

{noformat}Failed to generate the Kerberos token: The given SOAPAction null does not match an operation. [code 71]{noformat}

S:\sf\TS011\921\TS011921981\2023-02-14\pdweb.sso.tfim-DUP0001.log

{noformat}2023-02-14-20:07:57.516+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCall.cpp:107: Executing SOAP Call: RequestSecurityToken

2023-02-14-20:07:57.516+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCluster.cpp:537: AMWSOAPCluster::getMember(): Called

2023-02-14-20:07:57.516+11:00I----- thread(5) trace.pdweb.sso.tfim:4 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCluster.cpp:679: AMWSOAPCluster::getMember(): Returning https://e1-intfedaac.auth.bcz.gov.au:443/TrustServerWS/SecurityTokenServiceWST13 (Only one at Pri 9)

2023-02-14-20:07:57.516+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPHandleMgr.cpp:312: Located a SOAP handle for thread: 0x7f9e6c495700

2023-02-14-20:07:57.775+11:00I----- thread(5) trace.pdweb.sso.tfim:5 /build/isam/src/i4w/pdwebrte/sso/tfim/AMWTFIMSOAPCall.cpp:121: Failed to generate the Kerberos token: The given SOAPAction null does not match an operation. [code 71]
2023-02-14-20:07:57.775+11:00I----- thread(5) trace.pdweb.sso.tfim:8 /build/isam/src/i4w/pdwebrte/sso/tfim/AMWTFIMClient.cpp:358: EXIT AMWTFIMClient::requestSecurityToken err=38a0a1c6
2023-02-14-20:07:57.775+11:00I----- thread(5) trace.pdweb.sso.tfim:6 /build/isam/src/i4w/pdwebrte/sso/tfim/amw_tfimsso.cpp:185: EXIT{noformat}

10.0.4.0 STS call returns a JWT

{noformat}2023-02-14-19:25:41.886+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCall.cpp:107: Executing SOAP Call: RequestSecurityToken

2023-02-14-19:25:41.886+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCluster.cpp:537: AMWSOAPCluster::getMember(): Called

2023-02-14-19:25:41.886+11:00I----- thread(5) trace.pdweb.sso.tfim:4 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCluster.cpp:679: AMWSOAPCluster::getMember(): Returning https://e1-intfedaac.auth.bcz.gov.au:443/TrustServerWS/SecurityTokenServiceWST13 (Only one at Pri 9)

2023-02-14-19:25:41.886+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPHandleMgr.cpp:312: Located a SOAP handle for thread: 0x7f65c8cb5700

2023-02-14-19:25:46.244+11:00I----- thread(5) trace.pdweb.sso.tfim:8 /build/isam/src/i4w/pdwebrte/sso/tfim/AMWTFIMClient.cpp:358: EXIT AMWTFIMClient::requestSecurityToken err=00000000
2023-02-14-19:25:46.244+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/sso/tfim/AMWTFIMClient.cpp:376: token[  0]: expires=""Tue 14 Feb 2023 08:25:46 PM AEDT"" token=Bearer eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL2UxLWVpc3RzLmF1dGguYmN6Lmdvdi5hdSIsImV4cCI6MTY3NjM2Njc0NiwianRpIjoieGVkWmI4ZkVYRTNpa1F6QjM4dGpkTERDcHhURjJyeEIiLCJpYXQiOjE2NzYzNjMxNDZ9.e2k05loVs0Q-4gqPauMjFK2gYr3OXhYZ9wKjX2E5pws

2023-02-14-19:25:46.244+11:00I----- thread(5) trace.pdweb.sso.tfim:6 /build/isam/src/i4w/pdwebrte/sso/tfim/amw_tfimsso.cpp:185: EXIT amw_tfimsso_request_security_token 0x{noformat}",,Nick Lloyd,prashant_kamat,Tushar Prasad,Virag Patel,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4827,,,,,,,,,,,,,,,,,IJ45663,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011921981,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,adarsh.nair,605c0c04b18de50071046740,,,,DEPARTMENT OF HOME AFFAIRS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2023-03-02T16:36:28.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":5,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS011921981&path=TS011921981%2F0-all_data%2F,,,,,,,,,,,,,,,,,,,,,,,0|i18nnv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-28 00:05:47.921,,,,,"23/Feb/23 12:49 PM;605c0c04b18de50071046740;[~accountid:5b15d9517dab4c51f61b5190] ,
Could you please update.","28/Feb/23 10:05 AM;5b15d9517dab4c51f61b5190;An issue has been identified by development in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4817|https://cloudidentity.atlassian.net/browse/ISAMSUP-4817|smart-link] which is likely the issue.

So next step is to provide a fix for that issue","02/Mar/23 11:17 AM;5b15d9517dab4c51f61b5190;The fix in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4817|https://cloudidentity.atlassian.net/browse/ISAMSUP-4817|smart-link] doesn’t seem to resolve the issue

I cannot find in the support files the working 10.0.4.0 case

The 2023-02-13/isva_10.0.4.0_2023-02-03 support file has an intfed webseal instance but no tfim junction junctions

The 2023-02-14/isva_10.0.4.0_2023-02-14 support file has an intfed webseal instance but no tfim junction junctions

I am looking for [tfimsso:/<junction>] sections in the webseal config file

I cannot find the 10.0.4.0 working trace in any of the support files

Can you either point me at it on ecurep or supply a new 10.0.4.0 support file

I need the webseal configuration that was used when the trace was generated

I am trying to setup on 10.0.4.0 and 10.0.5.0

I am having issues with jwt tfim junction on both 10.0.4.0 and 10.0.5.0

(token-type = urn:ietf:params:oauth:token-type:jwt)

Other tfimsso types are working","02/Mar/23 11:59 AM;5b15d9517dab4c51f61b5190;[~accountid:605c0c04b18de50071046740] [~accountid:5b17571a82e05b22cc7d5d9e] 

No longer need a new support file. - got working on 10.0.4.0 - found issue on 10.0.5.0 all thanks to [~accountid:5af4ad7d4dd24c579110120b] 

We have found the cause

Please open an APAR “Issue with jwt tfim junctions on 10.0.5.0”

Please include that the following message gets logged in the webseal log file

<timestamp>I----- 0x38CF0B24 webseald ERROR wwa soap AMWTFIMSOAPCall.cpp 118 0x7f9dd8150700 -- DPWWA2852E   An error occurred when attempting to communicate with the SOAP server URL [https://localhost:443/TrustServerWS/SecurityTokenServiceWST13:|https://localhost:443/TrustServerWS/SecurityTokenServiceWST13:] The given SOAPAction null does not match an operation. (error code: 71/0x47).","02/Mar/23 2:20 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: b44e783c203ace495db76898208687379636800e
   * description: ISAMSUP-4806 APAR TBA jwt tfim junction issue

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85840334.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4806) which we publish.","02/Mar/23 4:36 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a553caafb1a81a26dead7a96c091ade2c9081fe7
   * description: Merge pull request #5719 from ISAM/ISAMSUP-4806

ISAMSUP-4806 APAR TBA jwt tfim junction issue

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85845402.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230302063327-a553caaf.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","02/Mar/23 5:58 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a553caafb1a81a26dead7a96c091ade2c9081fe7
   * description: Merge pull request #5719 from ISAM/ISAMSUP-4806

ISAMSUP-4806 APAR TBA jwt tfim junction issue

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85849570.


This build has not been published as the commit is not currently within a branch (20230302063327-a553caaf) which we publish.",02/Mar/23 10:35 PM;5b17571a82e05b22cc7d5d9e;APAR created successfully with number: IJ45663,"03/Mar/23 10:09 AM;5b15d9517dab4c51f61b5190;[~accountid:5b17571a82e05b22cc7d5d9e] [~accountid:605c0c04b18de50071046740] 

Fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4827|https://cloudidentity.atlassian.net/browse/ISAMSUP-4827|smart-link] ","09/Mar/23 3:52 AM;5b17571a82e05b22cc7d5d9e;customer confirmed issue is resolved with given fixpack

thank you Peter for your quick help.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Reverse proxy error message does not log userid when concurrent-session-threads-hard-limit is reached for user session.,ISAMSUP-4802,282579,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Highest,Done,Peter Horner,5b15d9517dab4c51f61b5190,adarsh.nair,605c0c04b18de50071046740,adarsh.nair,605c0c04b18de50071046740,20/Feb/23 2:55 PM,28/Apr/23 11:34 AM,14/Jul/23 2:47 PM,28/Apr/23 11:34 AM,10.0.6,Support,,0,,,,"customer have set the ""concurrent-session-threads-soft-limit = number_of_threads"" at 5 and the ""concurrent-session-threads-hard-limit = number_of_threads"" at 20.

They see that userid is logged in the error message when concurrent threads per session when the soft limit is reached whereas the concurrent threads per session hard limit does not show the userid.

Customer would like to have user id logged  when concurrent threads per session for the hard limit is reached as well.

See: [https://www.ibm.com/docs/en/sva/10.0.1?topic=stanza-concurrent-session-threads-hard-limit|https://www.ibm.com/docs/en/sva/10.0.1?topic=stanza-concurrent-session-threads-hard-limit|smart-link] 

The soft limit returns information about the session owner as shown below:
""The session, owned by User1, has reached it's soft limit of 6 concurrent requests"".
See: [https://www.ibm.com/docs/en/SSPREK_9.0.1/com.ibm.isam.doc/messages/messages/DPWAD0421W.html|https://www.ibm.com/docs/en/SSPREK_9.0.1/com.ibm.isam.doc/messages/messages/DPWAD0421W.html|smart-link] 

What we have noticed though is no information has been provided about the session owner when the hard limit has been reached. The message returned is:
""The maximum number of concurrent requests which can be processed for this session has been reached.""
See: [https://www.ibm.com/docs/en/SSPREK_9.0.1/com.ibm.isam.doc/messages/messages/DPWAD0420E.html|https://www.ibm.com/docs/en/SSPREK_9.0.1/com.ibm.isam.doc/messages/messages/DPWAD0420E.html|smart-link] 

Is there any way we can find the session owner when the hard limit has been reached?

We may have multiple users reach close to the hard limit so we cannot determine exactly which user has reached the hard limit.",,Nick Lloyd,prashant_kamat,Tushar Prasad,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4854,,,,,,,,,,,,,,,,,IJ45539,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012180465,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,adarsh.nair,605c0c04b18de50071046740,,,,BENDIGO AND ADELAIDE BANK LTD,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-03-07T17:41:03.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18l97:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-02-21 06:50:59.704,,,,,"21/Feb/23 4:50 PM;5b15d9517dab4c51f61b5190;The solution is to change the message to include the username.

Please open an APAR “the concurrent threads per session hard limit message should include username”

I am not sure if I can change the existing message (since it has already been translated/documented)

I will check with Development.

So the solution may change the message identifier

i.e may change from DPWAD0420E to DPWADnnnnE



I see from the case their test environment is at 10.0.4.0

I will need either a support file or a list of their current fixpacks to produce a compatible fixpack","22/Feb/23 12:21 PM;605c0c04b18de50071046740;[~accountid:5b15d9517dab4c51f61b5190] ,
APAR IJ45539 created.

Customer needs a fix on 10.0.4.0.
they have 10.0.4.0_IF1 installed.

they have below query.

========

Will that still work when upgrading to 10.0.5.0?

========

",22/Feb/23 2:06 PM;5b15d9517dab4c51f61b5190;I will need to build 2 fixpacks - 1 for 10.0.4.0 IF1 and 1 for 10.0.5.0,"24/Feb/23 12:41 PM;605c0c04b18de50071046740;[~accountid:5b15d9517dab4c51f61b5190] ,
Customer is looking for an update.","24/Feb/23 2:25 PM;5b15d9517dab4c51f61b5190;[~accountid:605c0c04b18de50071046740] 

I am still working on the fix.

But there is a way to find the user with existing information.

When the hard limit is reached we return a 500 error. The user is logged in request.log

So look for 500 errors in request.log at the time the DPWAD0420E is logged

eg with a hard limit of 3 I made 5 concurrent requests and this is what was logged in request.log

{noformat}from=192.168.115.248 192.168.115.248 - sec_master 24/Feb/2023:14:15:39 +1000 ""GET /ihs/slowframes.html HTTP/2"" 200 260
from=192.168.115.248 192.168.115.248 - sec_master 24/Feb/2023:14:15:39 +1000 ""GET /ihs/cgi/slowApp.cgi?delay=5 HTTP/2"" 500 1469
from=192.168.115.248 192.168.115.248 - sec_master 24/Feb/2023:14:15:39 +1000 ""GET /ihs/cgi/slowApp.cgi?delay=6 HTTP/2"" 500 1469
from=192.168.115.248 192.168.115.248 - sec_master 24/Feb/2023:14:15:39 +1000 ""GET /ihs/cgi/slowApp.cgi?delay=2 HTTP/2"" 200 2069
from=192.168.115.248 192.168.115.248 - sec_master 24/Feb/2023:14:15:39 +1000 ""GET /ihs/cgi/slowApp.cgi?delay=3 HTTP/2"" 200 2069
from=192.168.115.248 192.168.115.248 - sec_master 24/Feb/2023:14:15:39 +1000 ""GET /ihs/cgi/slowApp.cgi?delay=4 HTTP/2"" 200 2069
{noformat}","06/Mar/23 11:43 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: aae2f03fe1234b03c6700cbe9c844d9d262e3745
   * description: ISAMSUP-4802 IJ45539 include user in concurrent session hard limit msg

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86049538.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4802) which we publish.","07/Mar/23 5:41 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 7d3c64fa11c9fbc37b0d91cf53b6bdf7ae54f9dd
   * description: ISAMSUP-4802 IJ45539 include user in concurrent session hard limit msg (#5726)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86151782.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230307073804-7d3c64fa1.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","07/Mar/23 7:04 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 7d3c64fa11c9fbc37b0d91cf53b6bdf7ae54f9dd
   * description: ISAMSUP-4802 IJ45539 include user in concurrent session hard limit msg (#5726)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86156536.


This build has not been published as the commit is not currently within a branch (20230307073804-7d3c64fa1) which we publish.","09/Mar/23 5:13 PM;5b15d9517dab4c51f61b5190;[~accountid:605c0c04b18de50071046740] 

The 10.0.4.0 IF1 version of the fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4854|https://cloudidentity.atlassian.net/browse/ISAMSUP-4854|smart-link] 

I should have the 10.0.5.0 version of the fixpack tomorrow","10/Mar/23 10:42 AM;5b15d9517dab4c51f61b5190;[~accountid:605c0c04b18de50071046740] 

The 10.0.5.0 version of the fixpack has been added to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4584|https://cloudidentity.atlassian.net/browse/ISAMSUP-4584|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
502 Bad Gateway Error after upgrade to ISVA 10.0.5,ISAMSUP-4706,275815,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Highest,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,13/Jan/23 12:52 AM,23/Jan/23 11:16 AM,14/Jul/23 2:47 PM,23/Jan/23 11:16 AM,,Support,,0,,,,"Customer upgrade from 10.0.4 version to 10.0.5 and now they can't access any of the junctions or the Splash page for the Web seals.  Every page returns back a 502 Bad Gateway

We also see the errors in the event logs:
GLGSY0032E - The attempt to update the route, inet default via 10.4.36.193 dev 1.2 metric 0 table main, has failed.

GLGSY0032E - The attempt to update the route, inet default via 10.4.36.193 dev 1.2 metric 0 table main, has failed.

!image-20230112-145259.png|width=1920,height=391!



We had a meeting with customer (Nick and I), there are no configuration changes between versions. It just got corrupted for some reason we don’t understand.



Junctions are: 

!image-20230112-145322.png|width=1707,height=609!



They tried to taking AWS Load Balancer out … and getting the following error.

!image-20230112-145344.png|width=1499,height=902!



Management URL:  [https://usawstism002_mgt.nventco.com|https://usawstism002_mgt.nventco.com]   ->   10.4.36.140

Application URL: [https://usawstism002_app.nventco.com|https://usawstism002_app.nventco.com]  ->  10.4.36.140

URLS:

[https://usawstism002_app.nventco.com/HoffmanConnect/webapp/wcs/stores/servlet/StandardHomeView?langId=-1&catalogId=10001&storeId=10001|https://usawstism002_app.nventco.com/HoffmanConnect/webapp/wcs/stores/servlet/StandardHomeView?langId=-1&catalogId=10001&storeId=10001]

or

[https://usawstism002_app.nventco.com/connect/webapp/wcs/stores/servlet/StandardHomeView?langId=-1&catalogId=10001&storeId=10001|https://usawstism002_app.nventco.com/connect/webapp/wcs/stores/servlet/StandardHomeView?langId=-1&catalogId=10001&storeId=10001]



*From the pcap trace.*

!image-20230112-145408.png|width=1189,height=157!



Unsure if related but does seem like something is off with the TCP Stack. What's with that FIN,ACK????",,Brandon Garay,khansen,Nick Lloyd,tonyferg,Tushar Prasad,William Hannon Jr,,,,,,,,,,60e721f12d49fd00698bb49d,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,,,,,,13/Jan/23 12:54 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230112-145259.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/177360,13/Jan/23 12:54 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230112-145322.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/177358,13/Jan/23 12:54 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230112-145344.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/177359,13/Jan/23 12:54 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230112-145408.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/177357,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011728036,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,HOFFMAN ENCLOSURES INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"10.0.5 Support File version: S:\sf\TS011\728\TS011728036\2023-01-05\isva_10.0.5.0_20230105-153517_USAWSTISM002.nventco.com.support_unpack\

10.0.4 Support File version: S:\sf\TS011\728\TS011728036\2023-01-11\isva_10.0.4.0_20230111-165520_USAWSTISM002.nventco.com.support_unpack\

Pcap trace on 10.0.5 : S:\sf\TS011\728\TS011728036\2023-01-10\trace01.pcap",,,,,,,,,,,,,,,,,,,,,,,0|i17llz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-13 15:02:19.544,,,,,"14/Jan/23 1:02 AM;5b17571b91981f4fdde632c1;* Where are the matching pdweb.snoop and ip traces?
** They were delivered separately","14/Jan/23 1:18 AM;60e721f12d49fd00698bb49d;Can be accesed via: 

*_S:\sf\TS011\728\TS011728036\2023-01-05\isva_10.0.5.0_20230105-153517_USAWSTISM002.nventco.com.support_unpack\var\pdweb\Default\trace\_*

One problem here is that we can not spot any 502 error on the traces. And we have seen the behaviour from the webex with the customer.","18/Jan/23 1:56 AM;5b17571b91981f4fdde632c1;{quote}*William Hannon Jr*  January 13, 2023, 9:02 AM

Where are the matching pdweb.snoop and ip traces?

   They were delivered separately{quote}



{quote}Can be accesed via:

*_S:\sf\TS011\728\TS011728036\2023-01-05\isva_10.0.5.0_20230105-153517_USAWSTISM002.nventco.com.support_unpack\var\pdweb\Default\trace\_*{quote}



{noformat}2023-01-05/isva_10.0.5.0_20230105-153517_USAWSTISM002.nventco.com.support_unpack/var/pdweb/Default/trace/pdweb.debug.log
2023-01-05/isva_10.0.5.0_20230105-153517_USAWSTISM002.nventco.com.support_unpack/var/pdweb/Default/trace/pdweb.snoop.log

2023-01-06/isva_10.0.5.0_20230106-123048_USAWSTISM002.nventco.com.support_unpack/var/pdweb/Default/trace/pdweb.debug.log
2023-01-06/isva_10.0.5.0_20230106-123048_USAWSTISM002.nventco.com.support_unpack/var/pdweb/Default/trace/pdweb.snoop.log

2023-01-10/trace01.pcap

2023-01-11/isva_10.0.4.0_20230111-165520_USAWSTISM002.nventco.com.support_unpack/var/tcptrace/trace01.pcap
2023-01-11/isva_10.0.4.0_20230111-165520_USAWSTISM002.nventco.com.support_unpack/var/tcptrace/trace02.pcap
2023-01-11/isva_10.0.4.0_20230111-165520_USAWSTISM002.nventco.com.support_unpack/var/tcptrace/trace03.pcap
2023-01-11/isva_10.0.4.0_20230111-165520_USAWSTISM002.nventco.com.support_unpack/var/tcptrace/trace04.pcap
2023-01-11/isva_10.0.4.0_20230111-165520_USAWSTISM002.nventco.com.support_unpack/var/tcptrace/trace05.pcap{noformat}

So I ask again where are the matching pdweb.snoop.log* and ip traces (*.pcap) *FROM THE SAME CAPTURE TIME?*","18/Jan/23 2:42 AM;5b17571b91981f4fdde632c1;* For each pdweb.snoop capture, what was the total duration in seconds for each capture?","18/Jan/23 2:57 AM;60e721f12d49fd00698bb49d;I can ask for a recreation on 10.0.5 while enabling pdweb.snoop traces and pcap again.

Customer just made an update to the case:

*_“I need a response for level 3.  This ticket needs to be escalated as I'm missing deadlines now. I need a meeting with level 3. This ticket needs to be resolved by the end of the week”_*

Can I have your availability for a call maybe tomorrow with customer? I’ll ask Nick as SME as well.","18/Jan/23 3:39 AM;5b17571b91981f4fdde632c1;* Waiting for your answers
** Otherwise that will be the answers I give the customer","18/Jan/23 3:43 AM;5b17571b91981f4fdde632c1;* What do you notice?

{noformat}2023-01-05/isva_10.0.5.0_20230105-101838_USAWSTISM002.nventco.com.support_unpack/var/pdweb/Default/etc/webseald-Default.conf
2023-01-05/isva_10.0.5.0_20230105-153517_USAWSTISM002.nventco.com.support_unpack/var/pdweb/Default/etc/webseald-Default.conf
2023-01-06/isva_10.0.5.0_20230106-123048_USAWSTISM002.nventco.com.support_unpack/var/pdweb/Default/etc/webseald-Default.conf

2023-01-11/isva_10.0.4.0_20230111-165520_USAWSTISM002.nventco.com.support_unpack/var/pdweb/Default/etc/webseald-Default.conf{noformat}","18/Jan/23 3:48 AM;5b17571b91981f4fdde632c1;* request.log questions
** How many 502’s are in the request.logs for the failing timeframe?
** What status codes AND counts are in the request.logs for the failing timeframe","18/Jan/23 4:13 AM;5b17571b91981f4fdde632c1;{quote}I can ask for a recreation on 10.0.5 while enabling pdweb.snoop traces and pcap again.{quote}

* Before you ask the customer for another recreation
** You really need to answer all the questions that I have asked
*** Everything has a purpose","18/Jan/23 4:15 AM;5b17571b91981f4fdde632c1;* What are the socket termination points in front of WebSEAL
** Please list each one
*** Do any of these termination points have ability to log private keys?","18/Jan/23 6:45 AM;60e721f12d49fd00698bb49d;[~accountid:5b15d9e6dda5f94d06b985b4] Can I get some help here, please?","18/Jan/23 9:32 AM;5b17571b91981f4fdde632c1;For each (old *and* new) IP trace file

* Require it to be documented
** *With* AWS load-balancer
*** Time of problem
*** IP address of client
**** Request client har file
**** IP trace
*** IP address of load-balancer
** *Without* AWS load-balancer
*** Time of problem
*** IP address of client
**** Request client har file
**** IP trace
* Please provide all data in this Jira WI
** Will not process until available","18/Jan/23 11:33 AM;5b17571b91981f4fdde632c1;* 2022-01-17  ISVA 10.0.4.0 data
** Both with and without application load balancer
*** All FIN are Seq=1, ACK=169 regardless of order
*** The Client Hello plays not part to the closure","19/Jan/23 3:19 AM;5b17571b91981f4fdde632c1;* TS011728036/2023-01-17
** alb (Application Load Balancer)

{noformat}frame.number	time_delta	frame.time_epoch	ip.src	tcp.srcport	ip.dst	tcp.dstport	eth.src	eth.dst	_ws.col.Protocol	tcp.len	tcp.payload	tcp.window_size	tcp.seq	tcp.nxtseq	tcp.ack	_ws.col.Info	tls.handshake.session_id_length	tls.handshake.session_id	tcp.stream	frame.time

    40	   0.0000	1673995211.135101080	    <IP1>.36.232	22510	    <IP1>.36.200	  443			TCP    	    0	    1	 26883	    0	    1	    0	22510 → 443 [SYN] Seq=0 Win=26883 Len=0 MSS=8961 SACK_PERM TSval=3063361283 TSecr=0 WS=256			3	Jan 17, 2023 22:40:11.135101000 GMT
    41	   0.0001	1673995211.135190964	    <IP1>.36.200	  443	    <IP1>.36.232	22510			TCP    	    0	    1	 28960	    0	    1	    1	443 → 22510 [SYN, ACK] Seq=0 Ack=1 Win=28960 Len=0 MSS=1460 SACK_PERM TSval=3992533775 TSecr=3063361283 WS=128			3	Jan 17, 2023 22:40:11.135191000 GMT
    42	   0.0004	1673995211.135569096	    <IP1>.36.232	22510	    <IP1>.36.200	  443			TCP    	    0	    1	 27136	    1	    1	    1	22510 → 443 [ACK] Seq=1 Ack=1 Win=27136 Len=0 TSval=3063361284 TSecr=3992533775			3	Jan 17, 2023 22:40:11.135569000 GMT
    43	   0.0001	1673995211.135659933	    <IP1>.36.232	22510	    <IP1>.36.200	  443			TLSv1  	  168	    7	 27136	    1	  169	    1	Client Hello	0		3	Jan 17, 2023 22:40:11.135660000 GMT
    44	   0.0000	1673995211.135680914	    <IP1>.36.200	  443	    <IP1>.36.232	22510			TCP    	    0	    1	 30080	    1	    1	  169	443 → 22510 [ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992533775 TSecr=3063361284			3	Jan 17, 2023 22:40:11.135681000 GMT

           0.000593185 seconds after Client Hello acknowledged, server FIN

    45	   0.0006	1673995211.136274099	    <IP1>.36.200	  443	    <IP1>.36.232	22510			TCP    	    0	    1	 30080	    1	    2	  169	443 → 22510 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992533776 TSecr=3063361284			3	Jan 17, 2023 22:40:11.136274000 GMT
    46	   0.0001	1673995211.136344910	    <IP1>.36.200	  443	    <IP1>.36.232	22510			TCP    	    0	    1	 30080	    2	    2	  169	443 → 22510 [RST, ACK] Seq=2 Ack=169 Win=30080 Len=0 TSval=3992533776 TSecr=3063361284			3	Jan 17, 2023 22:40:11.136345000 GMT{noformat}



* Failing FINs

{noformat}    45	   0.0006	1673995211.136274099	    <IP1>.36.200	  443	    <IP1>.36.232	22510			TCP    	    0	    1	 30080	    1	    2	  169	443 → 22510 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992533776 TSecr=3063361284			3	Jan 17, 2023 22:40:11.136274000 GMT
   127	   0.0007	1673995241.159113884	    <IP1>.36.200	  443	    <IP1>.36.232	37256			TCP    	    0	    1	 30080	    1	    2	  169	443 → 37256 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992563799 TSecr=3063391307			18	Jan 17, 2023 22:40:41.159114000 GMT
   220	   0.0006	1673995271.180074930	    <IP1>.36.200	  443	    <IP1>.36.232	41360			TCP    	    0	    1	 30080	    1	    2	  169	443 → 41360 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992593820 TSecr=3063421328			29	Jan 17, 2023 22:41:11.180075000 GMT
   470	   0.0006	1673995301.202675104	    <IP1>.36.200	  443	    <IP1>.36.232	54392			TCP    	    0	    1	 30080	    1	    2	  169	443 → 54392 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992623842 TSecr=3063451350			45	Jan 17, 2023 22:41:41.202675000 GMT
   244	   0.0006	1673995275.308310986	    <IP1>.36.200	  443	    <IP1>.36.247	 4782			TCP    	    0	    1	 30080	    1	    2	  169	443 → 4782 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747776903 TSecr=2604304088			32	Jan 17, 2023 22:41:15.308311000 GMT
   265	   0.0006	1673995277.229320049	    <IP1>.36.200	  443	    <IP1>.36.247	 4790			TCP    	    0	    1	 30080	    1	    2	  169	443 → 4790 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747778824 TSecr=2604306009			35	Jan 17, 2023 22:41:17.229320000 GMT
   181	   0.0006	1673995265.490466118	    <IP1>.36.200	  443	    <IP1>.36.247	11098			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11098 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747767085 TSecr=2604294271			25	Jan 17, 2023 22:41:05.490466000 GMT
   206	   0.0006	1673995268.196337938	    <IP1>.36.200	  443	    <IP1>.36.247	11112			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11112 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747769791 TSecr=2604296976			27	Jan 17, 2023 22:41:08.196338000 GMT
   213	   0.0006	1673995270.437206030	    <IP1>.36.200	  443	    <IP1>.36.247	11124			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11124 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747772032 TSecr=2604299217			28	Jan 17, 2023 22:41:10.437206000 GMT
   230	   0.0007	1673995272.232475996	    <IP1>.36.200	  443	    <IP1>.36.247	11126			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11126 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747773827 TSecr=2604301012			30	Jan 17, 2023 22:41:12.232476000 GMT
   237	   0.0006	1673995273.747495890	    <IP1>.36.200	  443	    <IP1>.36.247	11138			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11138 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747775342 TSecr=2604302527			31	Jan 17, 2023 22:41:13.747496000 GMT
   143	   0.0006	1673995252.092520952	    <IP1>.36.200	  443	    <IP1>.36.247	17790			TCP    	    0	    1	 30080	    1	    2	  169	443 → 17790 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747753687 TSecr=2604280873			20	Jan 17, 2023 22:40:52.092521000 GMT
   433	   0.0008	1673995298.002070904	    <IP1>.36.200	  443	    <IP1>.36.247	36710			TCP    	    0	    1	 30080	    1	    2	  169	443 → 36710 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747799597 TSecr=2604326782			43	Jan 17, 2023 22:41:38.002071000 GMT
   477	   0.0005	1673995302.772643089	    <IP1>.36.200	  443	    <IP1>.36.247	36712			TCP    	    0	    1	 30080	    1	    2	  169	443 → 36712 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747804367 TSecr=2604331552			46	Jan 17, 2023 22:41:42.772643000 GMT
   135	   0.0007	1673995243.754204035	    <IP1>.36.200	  443	    <IP1>.36.247	42096			TCP    	    0	    1	 30080	    1	    2	  169	443 → 42096 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747745349 TSecr=2604272535			19	Jan 17, 2023 22:40:43.754204000 GMT
    91	   0.0006	1673995231.415271997	    <IP1>.36.200	  443	    <IP1>.36.247	52776			TCP    	    0	    1	 30080	    1	    2	  169	443 → 52776 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747733010 TSecr=2604260196			15	Jan 17, 2023 22:40:31.415272000 GMT
   152	   0.0007	1673995255.216232061	    <IP1>.36.200	  443	    <IP1>.36.247	55474			TCP    	    0	    1	 30080	    1	    2	  169	443 → 55474 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747756811 TSecr=2604283996			21	Jan 17, 2023 22:40:55.216232000 GMT
   160	   0.0006	1673995257.190917969	    <IP1>.36.200	  443	    <IP1>.36.247	55486			TCP    	    0	    1	 30080	    1	    2	  169	443 → 55486 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747758786 TSecr=2604285971			22	Jan 17, 2023 22:40:57.190918000 GMT
   167	   0.0006	1673995261.440814018	    <IP1>.36.200	  443	    <IP1>.36.247	55488			TCP    	    0	    1	 30080	    1	    2	  169	443 → 55488 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747763036 TSecr=2604290221			23	Jan 17, 2023 22:41:01.440814000 GMT
   174	   0.0006	1673995263.060323954	    <IP1>.36.200	  443	    <IP1>.36.247	55504			TCP    	    0	    1	 30080	    1	    2	  169	443 → 55504 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747764655 TSecr=2604291840			24	Jan 17, 2023 22:41:03.060324000 GMT
   340	   0.0006	1673995291.467236042	    <IP1>.36.200	  443	    <IP1>.36.247	64998			TCP    	    0	    1	 30080	    1	    2	  169	443 → 64998 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747793062 TSecr=2604320247			39	Jan 17, 2023 22:41:31.467236000 GMT{noformat}","19/Jan/23 7:33 AM;5b17571b91981f4fdde632c1;* Full analysis of non-Server Hello transactions
** 2023-01-11/isva_10.0.4.0_20230111-165520_USAWSTISM002.nventco.com.support_unpack/var/tcptrace/trace_all
*** Some valid transactions were getting through only period failures
** {noformat}#	Client FIN first !!!
153295	   0.0001	1668764284.781517029	    <IP1>.36.200	  443	     <IP1>.9.153	38582			TCP    	    0	    1	 29056	    1	    2	    2	443 → 38582 [FIN, ACK] Seq=1 Ack=2 Win=29056 Len=0 TSval=2512579660 TSecr=241031174			10664	
154507	   0.0002	1668764344.777283907	    <IP1>.36.200	  443	     <IP1>.9.153	38634			TCP    	    0	    1	 29056	    1	    2	    2	443 → 38634 [FIN, ACK] Seq=1 Ack=2 Win=29056 Len=0 TSval=2512639656 TSecr=241091170			10706	
160616	   0.0002	1668764404.776819944	    <IP1>.36.200	  443	     <IP1>.9.153	38890			TCP    	    0	    1	 29056	    1	    2	    2	443 → 38890 [FIN, ACK] Seq=1 Ack=2 Win=29056 Len=0 TSval=2512699655 TSecr=241151170			10979	
161049	   0.0001	1668764464.778887033	    <IP1>.36.200	  443	     <IP1>.9.153	38900			TCP    	    0	    1	 29056	    1	    2	    2	443 → 38900 [FIN, ACK] Seq=1 Ack=2 Win=29056 Len=0 TSval=2512759657 TSecr=241211172			11007	
161259	   0.0001	1668764524.775675058	    <IP1>.36.200	  443	     <IP1>.9.153	38904			TCP    	    0	    1	 29056	    1	    2	    2	443 → 38904 [FIN, ACK] Seq=1 Ack=2 Win=29056 Len=0 TSval=2512819654 TSecr=241271169			11023	

*#	Client Hello -> Server Fatal Alert
152956	   0.0000	1668764266.365657091	    <IP1>.36.200	  443	     <IP1>.9.153	38576			TCP    	    0	    1	 29056	    8	    9	   49	443 → 38576 [FIN, ACK] Seq=8 Ack=49 Win=29056 Len=0 TSval=2512561244 TSecr=241012758			10652	
160479	   0.0001	1668764387.708631039	    <IP1>.36.200	  443	     <IP1>.9.153	38884			TCP    	    0	    1	 29056	    8	    9	  122	443 → 38884 [FIN, ACK] Seq=8 Ack=122 Win=29056 Len=0 TSval=2512682587 TSecr=241134101			10973	
152647	   0.0001	1668764266.219702959	    <IP1>.36.200	  443	     <IP1>.9.153	38540			TCP    	    0	    1	 30080	    8	    9	  534	443 → 38540 [FIN, ACK] Seq=8 Ack=534 Win=30080 Len=0 TSval=2512561098 TSecr=241012612			10635	
152657	   0.0001	1668764266.224317074	    <IP1>.36.200	  443	     <IP1>.9.153	38542			TCP    	    0	    1	 30080	    8	    9	  534	443 → 38542 [FIN, ACK] Seq=8 Ack=534 Win=30080 Len=0 TSval=2512561103 TSecr=241012617			10636	
152668	   0.0001	1668764266.228573084	    <IP1>.36.200	  443	     <IP1>.9.153	38544			TCP    	    0	    1	 30080	    8	    9	  534	443 → 38544 [FIN, ACK] Seq=8 Ack=534 Win=30080 Len=0 TSval=2512561107 TSecr=241012621			10637	
152845	   0.0001	1668764266.319889069	    <IP1>.36.200	  443	     <IP1>.9.153	38564			TCP    	    0	    1	 30720	    8	    9	  830	443 → 38564 [FIN, ACK] Seq=8 Ack=830 Win=30720 Len=0 TSval=2512561198 TSecr=241012712			10646	
152946	   0.0001	1668764266.361882925	    <IP1>.36.200	  443	     <IP1>.9.153	38574			TCP    	    0	    1	 30848	    8	    9	  919	443 → 38574 [FIN, ACK] Seq=8 Ack=919 Win=30848 Len=0 TSval=2512561240 TSecr=241012754			10651	{noformat}
** 2023-01-17/alb/alb-trace0
*** All failed which is different than 2023-01-11
** {noformat}#	Client Hello -> Server FIN
    45	   0.0006	1673995211.136274099	    <IP1>.36.200	  443	    <IP1>.36.232	22510			TCP    	    0	    1	 30080	    1	    2	  169	443 → 22510 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992533776 TSecr=3063361284			3	Jan 17, 2023 22:40:11.136274000 GMT
    91	   0.0006	1673995231.415271997	    <IP1>.36.200	  443	    <IP1>.36.247	52776			TCP    	    0	    1	 30080	    1	    2	  169	443 → 52776 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747733010 TSecr=2604260196			15	Jan 17, 2023 22:40:31.415272000 GMT
   127	   0.0007	1673995241.159113884	    <IP1>.36.200	  443	    <IP1>.36.232	37256			TCP    	    0	    1	 30080	    1	    2	  169	443 → 37256 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992563799 TSecr=3063391307			18	Jan 17, 2023 22:40:41.159114000 GMT
   135	   0.0007	1673995243.754204035	    <IP1>.36.200	  443	    <IP1>.36.247	42096			TCP    	    0	    1	 30080	    1	    2	  169	443 → 42096 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747745349 TSecr=2604272535			19	Jan 17, 2023 22:40:43.754204000 GMT
   143	   0.0006	1673995252.092520952	    <IP1>.36.200	  443	    <IP1>.36.247	17790			TCP    	    0	    1	 30080	    1	    2	  169	443 → 17790 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747753687 TSecr=2604280873			20	Jan 17, 2023 22:40:52.092521000 GMT
   152	   0.0007	1673995255.216232061	    <IP1>.36.200	  443	    <IP1>.36.247	55474			TCP    	    0	    1	 30080	    1	    2	  169	443 → 55474 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747756811 TSecr=2604283996			21	Jan 17, 2023 22:40:55.216232000 GMT
   160	   0.0006	1673995257.190917969	    <IP1>.36.200	  443	    <IP1>.36.247	55486			TCP    	    0	    1	 30080	    1	    2	  169	443 → 55486 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747758786 TSecr=2604285971			22	Jan 17, 2023 22:40:57.190918000 GMT
   167	   0.0006	1673995261.440814018	    <IP1>.36.200	  443	    <IP1>.36.247	55488			TCP    	    0	    1	 30080	    1	    2	  169	443 → 55488 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747763036 TSecr=2604290221			23	Jan 17, 2023 22:41:01.440814000 GMT
   174	   0.0006	1673995263.060323954	    <IP1>.36.200	  443	    <IP1>.36.247	55504			TCP    	    0	    1	 30080	    1	    2	  169	443 → 55504 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747764655 TSecr=2604291840			24	Jan 17, 2023 22:41:03.060324000 GMT
   181	   0.0006	1673995265.490466118	    <IP1>.36.200	  443	    <IP1>.36.247	11098			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11098 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747767085 TSecr=2604294271			25	Jan 17, 2023 22:41:05.490466000 GMT
   206	   0.0006	1673995268.196337938	    <IP1>.36.200	  443	    <IP1>.36.247	11112			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11112 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747769791 TSecr=2604296976			27	Jan 17, 2023 22:41:08.196338000 GMT
   213	   0.0006	1673995270.437206030	    <IP1>.36.200	  443	    <IP1>.36.247	11124			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11124 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747772032 TSecr=2604299217			28	Jan 17, 2023 22:41:10.437206000 GMT
   220	   0.0006	1673995271.180074930	    <IP1>.36.200	  443	    <IP1>.36.232	41360			TCP    	    0	    1	 30080	    1	    2	  169	443 → 41360 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992593820 TSecr=3063421328			29	Jan 17, 2023 22:41:11.180075000 GMT
   230	   0.0007	1673995272.232475996	    <IP1>.36.200	  443	    <IP1>.36.247	11126			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11126 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747773827 TSecr=2604301012			30	Jan 17, 2023 22:41:12.232476000 GMT
   237	   0.0006	1673995273.747495890	    <IP1>.36.200	  443	    <IP1>.36.247	11138			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11138 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747775342 TSecr=2604302527			31	Jan 17, 2023 22:41:13.747496000 GMT
   244	   0.0006	1673995275.308310986	    <IP1>.36.200	  443	    <IP1>.36.247	 4782			TCP    	    0	    1	 30080	    1	    2	  169	443 → 4782 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747776903 TSecr=2604304088			32	Jan 17, 2023 22:41:15.308311000 GMT
   265	   0.0006	1673995277.229320049	    <IP1>.36.200	  443	    <IP1>.36.247	 4790			TCP    	    0	    1	 30080	    1	    2	  169	443 → 4790 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747778824 TSecr=2604306009			35	Jan 17, 2023 22:41:17.229320000 GMT
   340	   0.0006	1673995291.467236042	    <IP1>.36.200	  443	    <IP1>.36.247	64998			TCP    	    0	    1	 30080	    1	    2	  169	443 → 64998 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747793062 TSecr=2604320247			39	Jan 17, 2023 22:41:31.467236000 GMT
   433	   0.0008	1673995298.002070904	    <IP1>.36.200	  443	    <IP1>.36.247	36710			TCP    	    0	    1	 30080	    1	    2	  169	443 → 36710 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747799597 TSecr=2604326782			43	Jan 17, 2023 22:41:38.002071000 GMT
   470	   0.0006	1673995301.202675104	    <IP1>.36.200	  443	    <IP1>.36.232	54392			TCP    	    0	    1	 30080	    1	    2	  169	443 → 54392 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3992623842 TSecr=3063451350			45	Jan 17, 2023 22:41:41.202675000 GMT
   477	   0.0005	1673995302.772643089	    <IP1>.36.200	  443	    <IP1>.36.247	36712			TCP    	    0	    1	 30080	    1	    2	  169	443 → 36712 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=747804367 TSecr=2604331552			46	Jan 17, 2023 22:41:42.772643000 GMT{noformat}
** 2023-01-17/without_alb/trace01-DUP0001
*** All failed which is different than 2023-01-11
** {noformat}#	After SYN, ACK
    23	   0.0007	1673981460.053282976	    <IP1>.36.200	  443	    <IP1>.36.232	28244			TCP    	    0	    1	 29056	    1	    2	    1	443 → 28244 [FIN, ACK] Seq=1 Ack=1 Win=29056 Len=0 TSval=3978782693 TSecr=3049610225			3	Jan 17, 2023 18:51:00.053283000 GMT
    81	   0.0005	1673981480.483110905	    <IP1>.36.200	  443	    10.19.3.119	50991			TCP    	    0	    1	 29312	    1	    2	    1	443 → 50991 [FIN, ACK] Seq=1 Ack=1 Win=29312 Len=0			7	Jan 17, 2023 18:51:20.483111000 GMT
    96	   0.0008	1673981483.023808956	    <IP1>.36.200	  443	    10.19.3.119	50992			TCP    	    0	    1	 29312	    1	    2	    1	443 → 50992 [FIN, ACK] Seq=1 Ack=1 Win=29312 Len=0			9	Jan 17, 2023 18:51:23.023809000 GMT
   109	   0.0007	1673981484.686141014	    <IP1>.36.200	  443	    10.19.3.119	50993			TCP    	    0	    1	 29312	    1	    2	    1	443 → 50993 [FIN, ACK] Seq=1 Ack=1 Win=29312 Len=0			10	Jan 17, 2023 18:51:24.686141000 GMT
   115	   0.0007	1673981486.292150021	    <IP1>.36.200	  443	    10.19.3.119	50994			TCP    	    0	    1	 29312	    1	    2	    1	443 → 50994 [FIN, ACK] Seq=1 Ack=1 Win=29312 Len=0			11	Jan 17, 2023 18:51:26.292150000 GMT
   176	   0.0007	1673981496.638101101	    <IP1>.36.200	  443	    10.19.3.119	50996			TCP    	    0	    1	 29312	    1	    2	    1	443 → 50996 [FIN, ACK] Seq=1 Ack=1 Win=29312 Len=0			15	Jan 17, 2023 18:51:36.638101000 GMT
   272	   0.0007	1673981499.469708920	    <IP1>.36.200	  443	    10.19.3.119	50997			TCP    	    0	    1	 29312	    1	    2	    1	443 → 50997 [FIN, ACK] Seq=1 Ack=1 Win=29312 Len=0			28	Jan 17, 2023 18:51:39.469709000 GMT
   285	   0.0007	1673981504.938690901	    <IP1>.36.200	  443	    10.19.3.119	50999			TCP    	    0	    1	 29312	    1	    2	    1	443 → 50999 [FIN, ACK] Seq=1 Ack=1 Win=29312 Len=0			30	Jan 17, 2023 18:51:44.938691000 GMT
   332	   0.0007	1673981516.541835070	    <IP1>.36.200	  443	    10.19.3.119	51002			TCP    	    0	    1	 29312	    1	    2	    1	443 → 51002 [FIN, ACK] Seq=1 Ack=1 Win=29312 Len=0			36	Jan 17, 2023 18:51:56.541835000 GMT
   338	   0.0007	1673981519.030318022	    <IP1>.36.200	  443	    10.19.3.119	51003			TCP    	    0	    1	 29312	    1	    2	    1	443 → 51003 [FIN, ACK] Seq=1 Ack=1 Win=29312 Len=0			37	Jan 17, 2023 18:51:59.030318000 GMT

*#	Client Hello -> Server FIN
    60	   0.0007	1673981473.989129066	    <IP1>.36.200	  443	    <IP1>.36.247	 9824			TCP    	    0	    1	 30080	    1	    2	  169	443 → 9824 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=733975584 TSecr=2590502900			5	Jan 17, 2023 18:51:13.989129000 GMT
    76	   0.0006	1673981480.472383976	    <IP1>.36.200	  443	    <IP1>.36.247	42348			TCP    	    0	    1	 30080	    1	    2	  169	443 → 42348 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=733982067 TSecr=2590509383			8	Jan 17, 2023 18:51:20.472384000 GMT
   123	   0.0006	1673981490.079830885	    <IP1>.36.200	  443	    <IP1>.36.232	50446			TCP    	    0	    1	 30080	    1	    2	  169	443 → 50446 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3978812720 TSecr=3049640252			12	Jan 17, 2023 18:51:30.079831000 GMT
   300	   0.0007	1673981510.503106117	    <IP1>.36.200	  443	    <IP1>.36.247	22718			TCP    	    0	    1	 30080	    1	    2	  169	443 → 22718 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=734012098 TSecr=2590539414			32	Jan 17, 2023 18:51:50.503106000 GMT
   346	   0.0007	1673981520.120302916	    <IP1>.36.200	  443	    <IP1>.36.232	11264			TCP    	    0	    1	 30080	    1	    2	  169	443 → 11264 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=3978842760 TSecr=3049670292			38	Jan 17, 2023 18:52:00.120303000 GMT
   438	   0.0006	1673981540.532687902	    <IP1>.36.200	  443	    <IP1>.36.247	 5036			TCP    	    0	    1	 30080	    1	    2	  169	443 → 5036 [FIN, ACK] Seq=1 Ack=169 Win=30080 Len=0 TSval=734042127 TSecr=2590569443			42	Jan 17, 2023 18:52:20.532688000 GMT

    67	   0.0007	1673981477.823723078	    <IP1>.36.200	  443	    10.19.3.119	50990			TCP    	    0	    1	 30336	    1	    2	  518	443 → 50990 [FIN, ACK] Seq=1 Ack=518 Win=30336 Len=0			6	Jan 17, 2023 18:51:17.823723000 GMT
   280	   0.0005	1673981502.427984953	    <IP1>.36.200	  443	    10.19.3.119	50998			TCP    	    0	    1	 30336	    1	    2	  518	443 → 50998 [FIN, ACK] Seq=1 Ack=518 Win=30336 Len=0			29	Jan 17, 2023 18:51:42.427985000 GMT
   293	   0.0004	1673981508.625302076	    <IP1>.36.200	  443	    10.19.3.119	51000			TCP    	    0	    1	 30336	    1	    2	  518	443 → 51000 [FIN, ACK] Seq=1 Ack=518 Win=30336 Len=0			31	Jan 17, 2023 18:51:48.625302000 GMT
   327	   0.0005	1673981514.137289047	    <IP1>.36.200	  443	    10.19.3.119	51001			TCP    	    0	    1	 30336	    1	    2	  518	443 → 51001 [FIN, ACK] Seq=1 Ack=518 Win=30336 Len=0			35	Jan 17, 2023 18:51:54.137289000 GMT
   353	   0.0007	1673981521.176521063	    <IP1>.36.200	  443	    10.19.3.119	51004			TCP    	    0	    1	 30336	    1	    2	  518	443 → 51004 [FIN, ACK] Seq=1 Ack=518 Win=30336 Len=0			39	Jan 17, 2023 18:52:01.176521000 GMT{noformat}","19/Jan/23 7:58 AM;5b17571b91981f4fdde632c1;* Increase WebSEAL file descriptor limits
** No guarantee but worth trying
*** EDIT: After some more analysis, I found if the number of file descriptors have exceeded the limit then a FIN is sent by the Server. But, in this case it doesn't appear that the file descriptors have exceeded the limit. For what other scenarios can this happen?
",20/Jan/23 2:22 AM;5b17571b91981f4fdde632c1;* Can this close now?,20/Jan/23 2:24 AM;5b15d9e6dda5f94d06b985b4;[~accountid:5b17571b91981f4fdde632c1] What did we discuss process wise regarding an APAR for the lack of message now that there is not a default?  New Jira?,"20/Jan/23 2:30 AM;5b17571b91981f4fdde632c1;* New Jira
** Turning this on could be very noisy
*** Potential for lot of answered
** Should be architected
*** At a minimum potentially disabled until enabled
**** Then customer can enable
***** Then we can monitor the number of messages",23/Jan/23 11:16 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
After upgrading to 10.0.3.1 LDAP connections don't always appear to be using ATPs for pools and timeouts.,ISAMSUP-5167,308018,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,22/Jun/23 7:47 AM,13/Jul/23 9:28 PM,14/Jul/23 11:44 AM,,,,,0,Escalated,,,"The customer is having issues with LDAP connections to the LDAP alias server filling the pool.

They were not seeing this in 10.0.1 but when they upgraded to 10.0.3.1 in production they started seeing the runtime hang.   Support files show there were 200 connections to the Alias LDAP server, and the threads were waiting on an LDAP handle. 

The customer already has set:

runtime_profile.jvm_option. ==> -Dcom.sun.jndi.ldap.connect.pool.maxsize=200
runtime_profile.jvm_option. ==> -Dcom.sun.jndi.ldap.connect.pool.timeout=5000
runtime_profile.jvm_option. ==> -Dcom.sun.jndi.ldap.connect.timeout=10000
runtime_profile.jvm_option. ==> -Dcom.sun.jndi.ldap.read.timeout=5000
sysctl.net.ipv4.tcp_keepalive_time = 30
sysctl.net.ipv4.tcp_keepalive_intvl = 75
sysctl.net.ipv4.tcp_keepalive_probes = 9



The customer has many complex mapping rules, but for this case it appears to be a complex of issues. that are calling to many different LDAP servers.


The customer collected javaheaps when it was reported to be unresponsive.

This showed 5 thread from UserLookupHelper.java:475 that were stuck in waiting 

and 156 from UserLookupHelper.java:637 that were waiting.



Which was called from a variety of their mapping rules, all using different invocations of userlookuphelper.

I’ve asked the customer to call shutdown on the ULH and close any attribUtil objects just for good measure.    

I did not see 200 connections in this pools to the the LDAP servers the ULH should be talking to, so I don’t know why the ATP is not being used for a larger pool and timeouts, I’m not 100% sure they were in 10.0.1 but the customer says they were.

The customer has had a long history of issues like this such as 
[ISAMSUP-3076|https://cloudidentity.atlassian.net/browse/ISAMSUP-3076]
[ISAMSUP-3261|https://cloudidentity.atlassian.net/browse/ISAMSUP-3261]
[ISAMSUP-3355|https://cloudidentity.atlassian.net/browse/ISAMSUP-3355]
[ISAMSUP-3644|https://cloudidentity.atlassian.net/browse/ISAMSUP-3644]

The customer also has mapping rules that are calling the LDAP alias service with calls like IDMappingExtUtils.lookupAliasesForUserAsStringArray
 

I suspect a threading issue that leads to a corruption and looping on the LDAP handles.

I would like to rule out know issues like [https://cloudidentity.atlassian.net/browse/ISAMSUP-4029|https://cloudidentity.atlassian.net/browse/ISAMSUP-4029|smart-link] [https://cloudidentity.atlassian.net/browse/ISAMSUP-5129|https://cloudidentity.atlassian.net/browse/ISAMSUP-5129|smart-link] ,   [https://cloudidentity.atlassian.net/browse/ISAMSUP-5100|https://cloudidentity.atlassian.net/browse/ISAMSUP-5100|smart-link] , and [https://cloudidentity.atlassian.net/browse/ISAMSUP-4616|https://cloudidentity.atlassian.net/browse/ISAMSUP-4616|smart-link] 

The fix pack needs to also contain the fixes for  [https://cloudidentity.atlassian.net/browse/ISAMSUP-4438|https://cloudidentity.atlassian.net/browse/ISAMSUP-4438|smart-link] and [https://cloudidentity.atlassian.net/browse/ISAMDEV-9955|https://cloudidentity.atlassian.net/browse/ISAMDEV-9955|smart-link] 

 for 10.0.3.1",,Annelise Quap,David Hayes,Dermot Daly,khansen,Nick Lloyd,Nilesh Amrutkar,Norton Brainard,prashant_kamat,Tushar Prasad,,,,,,,5b15d950d9936c61022057fe,5b232b2fd85e5b59b066f57f,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b1757156d76184b7d98a0c3,5ff48f4aa9d0300107ccded2,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,ISAMSUP-5170,,,,,,13/Jul/23 11:56 AM;ashashiv;image-20230713-010933.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/211006,12/Jul/23 9:39 PM;ashashiv;javacore.20230712.073453.7899.0001.txt;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/210886,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012840862,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,,,,Nedbank Limited,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cxpz:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-06-22 06:45:34.951,,,,,22/Jun/23 7:52 AM;5b15d950d9936c61022057fe;[~accountid:5af4ad7d4dd24c579110120b]   This is the Jira opened for TS012840862   That was cross mentioned in [https://cloudidentity.atlassian.net/browse/ISAMSUP-5096|https://cloudidentity.atlassian.net/browse/ISAMSUP-5096|smart-link],"22/Jun/23 4:45 PM;5b1757156d76184b7d98a0c3;Also wanted to confirm if these are 2 different fixes or related to each other?

ldapreadtmo_fedalias_10031.fixpack
ldap_readtmo_10031-2.fixpack","22/Jun/23 6:52 PM;5af4ad7d4dd24c579110120b;<My notes>

|| || || ||
|ISAMSUP-3030|[https://github.ibm.com/ISAM/isam/pull/5227/files|https://github.ibm.com/ISAM/isam/pull/5227/files]|(10050)|
|ISAMDEV-6935|[https://github.ibm.com/ISAM/isam/commit/3a7139a88099babb804f044f8b97e394a5464b0d|https://github.ibm.com/ISAM/isam/commit/3a7139a88099babb804f044f8b97e394a5464b0d]|(10040)|
|ISAMSUP-3261|[https://github.ibm.com/ISAM/isam/pull/4333/files|https://github.ibm.com/ISAM/isam/pull/4333/files]
[https://github.ibm.com/ISAM/isam/commit/8830f00e784a7a5bffa983644708cb83c68efa13|https://github.ibm.com/ISAM/isam/commit/8830f00e784a7a5bffa983644708cb83c68efa13]
Also delete the additional assignment of getId outside of if else. Line 311 - this.lookupKey = connection.getId();|(10030) + new deletion change tbd|
|ISAMSUP-4616|[https://github.ibm.com/ISAM/isam/pull/5638|https://github.ibm.com/ISAM/isam/pull/5638]|(10060)|
|ISAMSUP-4179|[https://github.ibm.com/ISAM/isam/pull/5280/files|https://github.ibm.com/ISAM/isam/pull/5280/files]|(10050)|
|ISAMSUP-3514|[https://github.ibm.com/ISAM/isam/pull/5279|https://github.ibm.com/ISAM/isam/pull/5279]|(10050)|
| | | |
|{color:#ff5630}ISAMSUP-4029{color}|[https://github.ibm.com/ISAM/isam/pull/5313|https://github.ibm.com/ISAM/isam/pull/5313] - not changing this in this fixpack|(10050) (10040IF1)|
|Debug in UserLookUpHelperStore| | |
|test fix 
LDAPRgyServer.java|{noformat}    //Utilize the connection pool setting provided by oracle
    contextInit.put(""com.sun.jndi.ldap.connect.pool.timeout"", ""20000"");
    contextInit.put(""com.sun.jndi.ldap.connect.timeout"", ""20000"");
    contextInit.put(""com.sun.jndi.ldap.connect.pool.maxsize"", ""2"");
    contextInit.put(""com.sun.jndi.ldap.read.timeout"", ""5000"");


    rgyLogger.logp(RgyLogger.FINEST, cls, meth,
                ""Debug000 Manually update timeouts connect.pool.timeout 20000, connect.timout is 20000 pool.max is 2, read timeout 5000"");{noformat}| |



Plan to test the following in this order - 
3 versions of fixpacks:

# with all the above changes + No changes from ISAMSUP4029
# with all the above changes + with changes from ISAMSUP4029 (To test whether the crews get refreshed between 2 ulh inits and searches) 
# with all the above changes + implement new rgy object store based on the minimum set of properties","22/Jun/23 6:54 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

Here is a fixpack that contains multiple fixes related to LDAP connections , UserLookUpHelper and the IJ40141 missing class exception.

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5170|https://cloudidentity.atlassian.net/browse/ISAMSUP-5170|smart-link]

name: ldap_conn_multiplefixes_10031 version: 10031 fixpack: [https://ibm.box.com/s/lw70rrv9cl7qqc41msz5koqtnsvy2rrh|https://ibm.box.com/s/lw70rrv9cl7qqc41msz5koqtnsvy2rrh|smart-link]  checksum: [https://ibm.box.com/s/ymdy9eamrq0yitrckpr5lb7r5li7bs9z|https://ibm.box.com/s/ymdy9eamrq0yitrckpr5lb7r5li7bs9z|smart-link]  files changed: /opt/IBM/wlp/usr/extension/lib/isam/common/com.ibm.security.access.common_8.0.0.jar Installing this fixpack wil restart AAC/Fed runtime.

Installing this fixpack will restart AAC/Fed runtime.

Let me know how you go with this fixpack.","30/Jun/23 9:46 PM;614dd52af1c1740068534813;Hi [~accountid:5af4ad7d4dd24c579110120b] 
The fixpack didn’t work (ldap_conn_multiplefixes_10031.fixpack)

We got some traces with the below settings suggested by Annelise:
com.tivoli.pd.rgy.*=all:com.ibm.security.access.ldap.impl.*=all:com.tivoli.am.fim.ldap.worker.impl.IdServiceWorkerImpl.*=all

Would that helps to troubleshoot?

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-06-29%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-06-29%2F]


","30/Jun/23 9:52 PM;614dd52af1c1740068534813;Support file
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-06-28%2Fisva_10.0.3.1_20230628-082549_105isamidpr10.africa.nedcor.net.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-06-28%2Fisva_10.0.3.1_20230628-082549_105isamidpr10.africa.nedcor.net.support_unpack%2F]","01/Jul/23 12:57 AM;5b15d950d9936c61022057fe;The customer reported that they had another timeout today. 

”””
6/30/2023 9:36 AM | *Public* | *Nolan Roets (Customer)*

We had another timeout and took the dump and it is uploaded with the support file
”””



[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862/2023-06-30/&filepath=TS012840862/2023-06-30/isva_10.0.3.1_20230630-151623_105isamidpr09.africa.nedcor.net.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862/2023-06-30/&filepath=TS012840862/2023-06-30/isva_10.0.3.1_20230630-151623_105isamidpr09.africa.nedcor.net.support]","01/Jul/23 1:55 AM;5b15d950d9936c61022057fe;Did you include the changes in [https://github.ibm.com/ISAM/isam/commit/41d6306ad0f70d3ba41659c20d24b455b84796c8|https://github.ibm.com/ISAM/isam/commit/41d6306ad0f70d3ba41659c20d24b455b84796c8] [https://cloudidentity.atlassian.net/browse/ISAMSUP-5100|https://cloudidentity.atlassian.net/browse/ISAMSUP-5100|smart-link] /ISAMSUP-3030 or did the customer not install it correctly?   I’m still seeing the default timeout value:

[6/29/23, 8:18:07:186 SAST] 000049a5 id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl 3 logSearchArguments Search parameters: name[cn=Users,ou=Client,CN=TFIM] filter[(principalName=9252612890)] controls[CountLimit: 0 DerefLinkFlag: false Returning Attributes: null ReturningObjFlag: false SearchScope: 2 *TimeLimit: 0*]

I also did not see the messages like:

{{Bind context the following attribs}}

But that could have rolled out of the logs.

Could the old files still be cached in the liberty cache?  Does that need to be refreshed?","01/Jul/23 3:17 AM;5b15d950d9936c61022057fe;Also should the line be * 1000 not 100?    Such that a timeout of 10 is 10000 ms not 1 second 1000ms ?
env.put(""com.sun.jndi.ldap.read.timeout"", """"+(_bindParameters.getIdleTimeOut() * 100));

Could this be somehow be conflicting with runtime_profile.jvm_option. ==> -Dcom.sun.jndi.ldap.read.timeout=5000

If the customer applied the fixpack shouldn’t we be seeing something like

com.ibm.security.access.ldap.impl.LdapServerImpl 3 logSearchArguments Search parameters: name[cn=Users,ou=Client,CN=TFIM] filter[(principalName=9252612890)] controls[CountLimit: 0 DerefLinkFlag: false Returning Attributes: null ReturningObjFlag: false SearchScope: 2 *TimeLimit: 10000*]


Do we also need to set the controls? Like in trysearch?

{noformat}[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 am.fim.identity.service.client.ldap.IdServiceLocalLdapClient > getUserAlias ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.tivoli.am.fim.ldap.worker.impl.IdServiceWorkerImpl       > getUserAlias ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.tivoli.am.fim.ldap.worker.impl.IdServiceWorkerImpl       3 getUserAlias uid: com.tivoli.am.fim.identity.service.client.types.impl.UserIdDescriptorImpl@5057dd96 |UserId: 5900076416 |AliasType:SELF |UserAliases: null
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.tivoli.am.fim.ldap.worker.impl.IdServiceWorkerImpl       > getSelfUserAlias ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.tivoli.am.fim.ldap.worker.impl.IdServiceWorkerImpl       > findUser ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.tivoli.am.fim.ldap.utils.UserUtil                        > userExists ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.tivoli.am.fim.ldap.utils.UserUtil                        > userExists ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.tivoli.am.fim.ldap.utils.UserUtil                        > getOurUserDn ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl             > trySearch ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl             > escapeLDAPSearchFilter ENTRY (principalName=5900076416)
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl             < escapeLDAPSearchFilter RETURN (principalName=5900076416)
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl             3 logSearchArguments Search parameters: name[cn=Users,ou=Client,CN=TFIM] filter[(principalName=5900076416)] controls[CountLimit: 0 DerefLinkFlag: false Returning Attributes: null ReturningObjFlag: false SearchScope: 2 TimeLimit: 0]
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl             > trySearchUnalteredFilter ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl             > checkValidState ENTRY
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl             3 checkValidState Already  bound
[6/29/23, 8:17:50:703 SAST] 00004b8c id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl             < checkValidState RETURN
[6/29/23, 8:17:50:704 SAST] 00004b8c id=00000000 com.ibm.security.access.ldap.impl.LdapServerImpl             3 trySearchUnalteredFilter Attempting search.  retries: 0
{noformat}



Maybe it is another call altogether that is hanging.       I’m not certain how all these connections interact.

The javacore [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-06-30%2Fisva_10.0.3.1_20230630-151623_105isamidpr09.africa.nedcor.net.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-06-30%2Fisva_10.0.3.1_20230630-151623_105isamidpr09.africa.nedcor.net.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F]


Maybe we should also have UserLookupHelper/UserLookupUtil/LdapRgyRegistry/PDrgy also read the com.sun.jndi.ldap.read.timeout to always set an override?
I’m thinking it is a better practice to always use a timeout rather than default to wait forever to prevent these types of cases.   We should also have a way to override the default timeout, but I think waiting forever by default is just a problem for any connection.  Do you think it is a good idea/practice to always has a timeout set for all reads of all types.    I would much rather have cases about a customer that needs to increase a timeout than to have cases from customers that have outages due to the app hanging. ","03/Jul/23 7:15 AM;5af4ad7d4dd24c579110120b;<notes>

These calls don't look like the calls are in LDAPServerImpl.java
(But could also need to check reset LDAP server to drop all existing connections and refresh config.
Its via pdrgy - {{LdapRgyServer.getHandle}} 



{noformat}3XMHEAPALLOC             Heap bytes allocated since last GC cycle=0 (0x0)
3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at java/net/SocketInputStream.socketRead0(Native Method)
4XESTACKTRACE                at java/net/SocketInputStream.socketRead(Bytecode PC:8(Compiled Code))
4XESTACKTRACE                at java/net/SocketInputStream.read(Bytecode PC:114(Compiled Code))
4XESTACKTRACE                at java/net/SocketInputStream.read(Bytecode PC:11(Compiled Code))
4XESTACKTRACE                at java/io/BufferedInputStream.fill(Bytecode PC:217(Compiled Code))
4XESTACKTRACE                at java/io/BufferedInputStream.read1(Bytecode PC:44(Compiled Code))
4XESTACKTRACE                at java/io/BufferedInputStream.read(Bytecode PC:49(Compiled Code))
5XESTACKTRACE                   (entered lock: java/io/BufferedInputStream@0x0000000606E46628, entry count: 1)
4XESTACKTRACE                at com/sun/jndi/ldap/Connection.run(Bytecode PC:141(Compiled Code))
4XESTACKTRACE                at java/lang/Thread.run(Bytecode PC:13)
3XMTHREADINFO3           Native callstack:{noformat}

{noformat}3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at java/lang/Object.wait(Native Method)
4XESTACKTRACE                at java/lang/Object.wait(Bytecode PC:3(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyServer.getHandle(LdapRgyServer.java:935(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyHandleMgr.setupHandle(LdapRgyHandleMgr.java:742(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyHandleMgr$JndiOperation.retryJndiOperation(LdapRgyHandleMgr.java:2438(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyHandleMgr.searchAndFetch(LdapRgyHandleMgr.java:1644(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyHandleMgr.searchAndFetch(LdapRgyHandleMgr.java:1619(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyEntityMgr.locateSecEntityUsingId(LdapRgyEntityMgr.java:496(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyEntityMgr.getFullSecEntity(LdapRgyEntityMgr.java:567(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyUserMgr.getFullUser(LdapRgyUserMgr.java:781(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyUserMgr.getUser(LdapRgyUserMgr.java:417(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyUserMgr.getUser(LdapRgyUserMgr.java:364(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyUserMgr.getUser(LdapRgyUserMgr.java:882(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyRegistry.getUser(LdapRgyRegistry.java:475(Compiled Code))
4XESTACKTRACE                at com/ibm/security/access/user/UserLookupHelper.getUser(UserLookupHelper.java:473(Compiled Code))
4XESTACKTRACE                at jdk/internal/reflect/GeneratedMethodAccessor226.invoke(Bytecode PC:40(Compiled Code))
4XESTACKTRACE                at jdk/internal/reflect/DelegatingMethodAccessorImpl.invoke(Bytecode PC:6(Compiled Code))
4XESTACKTRACE                at java/lang/reflect/Method.invoke(Bytecode PC:61(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/MemberBox.invoke(MemberBox.java:126(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/NativeJavaMethod.call(NativeJavaMethod.java:225(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/optimizer/OptRuntime.call1(OptRuntime.java:32(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/gen/nidLogin_9._c_script_0(nidLogin:359(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/gen/nidLogin_9.call(nidLogin(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/ContextFactory.doTopCall(ContextFactory.java:405(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/ScriptRuntime.doTopCall(ScriptRuntime.java:3508(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/gen/nidLogin_9.call(nidLogin(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/gen/nidLogin_9.exec(nidLogin(Compiled Code))
4XESTACKTRACE                at com/ibm/security/access/javascript/JSCode.execute(JSCode.java:123(Compiled Code))
4XES{noformat}

Update fixpack version with com.tivoli.pd.rgy.jar changes 

{noformat}        //Utilize the connection pool setting provided by oracle
        contextInit.put(""com.sun.jndi.ldap.connect.pool.timeout"", ""20000"");
        contextInit.put(""com.sun.jndi.ldap.connect.timeout"", ""20000"");
        contextInit.put(""com.sun.jndi.ldap.connect.pool.maxsize"", ""2"");
        contextInit.put(""com.sun.jndi.ldap.read.timeout"", ""5000"");

        rgyLogger.logp(RgyLogger.FINEST, cls, meth,
                    ""Debug000 Manually update timeouts connect.pool.timeout 20000, connect.timout is 20000 pool.max is 2, read timeout 5000"");
        {noformat}","04/Jul/23 9:02 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

I’ve updated the fixpack with another timeout change - 

with hard coded timeouts in rgy handler - 

    ""com.sun.jndi.ldap.connect.pool.timeout"", ""20000""
    ""com.sun.jndi.ldap.connect.timeout"", ""20000""
    ""com.sun.jndi.ldap.connect.pool.maxsize"", ""2""
    ""com.sun.jndi.ldap.read.timeout"", ""5000""

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5170|https://cloudidentity.atlassian.net/browse/ISAMSUP-5170|smart-link]  

Restart AAC
also - Reset connections from LDAP side - close all connections from LDAP 

Can we get the trace from this environment. 

Thanks","05/Jul/23 7:50 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] upon installation of fixpack, customer is getting error

[7/5/23, 9:40:20:646 SAST] 00000026 id=00000000 com.ibm.security.access.user.UserLookupHelper I search com.tivoli.pd.rgy.exception.ServerDownRgyException: HPDAA0278E None of the configured LDAP servers of the appropriate type for the operation can be contacted.

at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.getBestServerWithRecovery(LdapRgyHandleMgr.java:698)

at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.setupHandle(LdapRgyHandleMgr.java:737)

at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr$JndiOperation.retryJndiOperation(LdapRgyHandleMgr.java:2438)

at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.searchAndFetch(LdapRgyHandleMgr.java:1644)

at com.tivoli.pd.rgy.ldap.LdapRgyServerInfo.determineLdapServerType(LdapRgyServerInfo.java:1033)

at com.tivoli.pd.rgy.ldap.LdapRgyServerInfo.getLdapServerType(LdapRgyServerInfo.java:438)

at com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo.fetch(LdapRgySuffixInfo.java:363)

at com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo.ensureFetched(LdapRgySuffixInfo.java:528)

at com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo.get(LdapRgySuffixInfo.java:571)

at com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo.get(LdapRgySuffixInfo.java:483)

at com.tivoli.pd.rgy.ldap.LdapRgyEntityMgr.listNativeEntities(LdapRgyEntityMgr.java:1552)

at com.tivoli.pd.rgy.ldap.LdapRgyUserMgr.listNativeUsers(LdapRgyUserMgr.java:933)

at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.listNativeUsers(LdapRgyRegistry.java:754)

at com.ibm.security.access.user.UserLookupHelper.search(UserLookupHelper.java:737)

at com.ibm.security.access.user.UserLookupHelper.search(UserLookupHelper.java:711)

at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)

at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)

at [com.ibm.ws|http://com.ibm.ws].

We have latest support file for review

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-07-05%2Fisva_10.0.3.1_20230705-095843_nbpisamidete2.africa.nedcor.net.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-07-05%2Fisva_10.0.3.1_20230705-095843_nbpisamidete2.africa.nedcor.net.support_unpack%2F]","05/Jul/23 7:52 PM;5b1757156d76184b7d98a0c3;Latest response from customer

----

I did upload the support file where we had the issues, also rolled back the fixpack afterwards.

I think there needs to be some focus and priority given to this as this is the 3rd fixpack that is not working or either breaking working functionality.

This is a SEV1 and feels like it is treated as a side issue.","06/Jul/23 8:56 AM;5af4ad7d4dd24c579110120b;<Notes>



TODO- {{Adding hard coded values}} in LdapRgyServer.java 

{noformat}                //Adding hard coded values - 
                ldapContext.addToEnvironment(""com.sun.jndi.ldap.connect.pool.timeout"", ""20000"");
                ldapContext.addToEnvironment(""com.sun.jndi.ldap.connect.timeout"", ""20000"");
                ldapContext.addToEnvironment(""com.sun.jndi.ldap.connect.pool.maxsize"", ""2"");
                ldapContext.addToEnvironment(""com.sun.jndi.ldap.read.timeout"", ""5000"");
                rgyLogger.logp(RgyLogger.FINEST, cls, meth,
                ""Debug000 Manually update timeouts connect.pool.timeout 20000, connect.timout is 20000 pool.max is 2, read timeout 5000"");{noformat}

in connect and rebind in addition changes included on  - June 22nd comment.

Trace from test env to see if reaches this code base -

{noformat}at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.jndiToRgyExceptionAndExpireTime(LdapRgyRegistry.java:1068)
	at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.jndiToRgyException(LdapRgyRegistry.java:932)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.parseName(LdapRgyHandleMgr.java:2329)
	at com.tivoli.pd.rgy.ldap.LdapRgyUserMgr.getNativeUser(LdapRgyUserMgr.java:869)
	at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.getNativeUser(LdapRgyRegistry.java:526)
	at com.ibm.security.access.user.UserLookupHelper.getUserByNativeId(UserLookupHelper.java:507)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
{noformat}",06/Jul/23 1:12 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] one to keep an eye on over the coming days. ,"06/Jul/23 4:42 PM;5af4ad7d4dd24c579110120b;Hi Nilesh

I have updated the Fixpck in [https://cloudidentity.atlassian.net/browse/ISAMSUP-5170|https://cloudidentity.atlassian.net/browse/ISAMSUP-5170|smart-link] - does not give any error for pd.rgy access in my tests. 

But haven't been able to successfully test the timeouts.
If you have an environment please test with the hard coded values for these timeouts take any effect.

If the customer is willing to test this you can send the fix pack if not reach out to [~accountid:5b232b2fd85e5b59b066f57f] as he might look into this issue whilst I am away till 11th on leave.


change is -

{noformat}                    //Adding hard coded values - 
                    ldapContext.addToEnvironment(""com.sun.jndi.ldap.connect.pool.timeout"", ""20000"");
                    ldapContext.addToEnvironment(""com.sun.jndi.ldap.connect.timeout"", ""20000"");
                    ldapContext.addToEnvironment(""com.sun.jndi.ldap.connect.pool.maxsize"", ""2"");
                    ldapContext.addToEnvironment(""com.sun.jndi.ldap.read.timeout"", ""5000"");
                    rgyLogger.logp(RgyLogger.FINEST, cls, meth,
                    ""Debug000 Manually update timeouts connect.pool.timeout 20000, connect.timout is 20000 pool.max is 2, read timeout 5000"");
{noformat}

[~accountid:5b232b2fd85e5b59b066f57f] 

I have updated the fix pack and here is the git branch with all the changes - 
[https://github.ibm.com/ISAM/isam/tree/ISAMSUP-5170_Nedbank10031|https://github.ibm.com/ISAM/isam/tree/ISAMSUP-5170_Nedbank10031] 

I have a test environment on Jenkins -
10.0.3.1 ISVA

IP- 10.160.20.247
admin/admin

ISDS - 10.160.20.46
cn=root / Coastmuq 

[https://10.160.21.247/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1|https://10.160.21.247/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1] 

Testing with user lookup helper, federated directory to SDS. 

Used ‘ps -ef|grep slapd’ to get the PID for the Directory server 
‘gdb > attach PID’

It cant reach that snippet where the context would set these timeout parameters. 
","06/Jul/23 8:50 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] [~accountid:5b232b2fd85e5b59b066f57f] Customer installed latest fixpack. However got the same issue of now able to connect ldap.

Latest support file

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-07-06%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862%2F2023-07-06%2F]","08/Jul/23 2:09 AM;5b15d950d9936c61022057fe;[~accountid:5af4ad7d4dd24c579110120b] [~accountid:5b232b2fd85e5b59b066f57f] The customer has uploaded a new support file [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862/2023-07-07/&filepath=TS012840862/2023-07-07/isva_10.0.3.1_20230707-170603_105isamidpr09.africa.nedcor.net.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012840862&path=TS012840862/2023-07-07/&filepath=TS012840862/2023-07-07/isva_10.0.3.1_20230707-170603_105isamidpr09.africa.nedcor.net.support]

With several javacores take in series to help narrow down what is actually hung. ","08/Jul/23 3:47 AM;5b15d950d9936c61022057fe;The customer indicated this was working in 10.0.1 which also had the  synchronized in [https://cloudidentity.atlassian.net/browse/ISAMDEV-4165|https://cloudidentity.atlassian.net/browse/ISAMDEV-4165|smart-link] is is possible that something changed after that which is not handling being serialized well which leads to a queue/hang like behavior?

Looking at the series of javacores it appears that many threads are waiting on that synchronized and the threads they are waiting on is potentially stuck in a LDAP/JNDI retry loop??

{noformat}3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at java/lang/Object.wait(Native Method)
4XESTACKTRACE                at java/lang/Object.wait(Bytecode PC:3(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyServer.getHandle(LdapRgyServer.java:935(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyHandleMgr.setupHandle(LdapRgyHandleMgr.java:742(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyHandleMgr$JndiOperation.retryJndiOperation(LdapRgyHandleMgr.java:2438(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyHandleMgr.searchAndFetch(LdapRgyHandleMgr.java:1644(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyHandleMgr.searchAndFetch(LdapRgyHandleMgr.java:1619(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyEntityMgr.locateSecEntityUsingId(LdapRgyEntityMgr.java:496(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyEntityMgr.getFullSecEntity(LdapRgyEntityMgr.java:567(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyUserMgr.getFullUser(LdapRgyUserMgr.java:781(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyUserMgr.getUser(LdapRgyUserMgr.java:417(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyUserMgr.getUser(LdapRgyUserMgr.java:364(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyUserMgr.getUser(LdapRgyUserMgr.java:882(Compiled Code))
4XESTACKTRACE                at com/tivoli/pd/rgy/ldap/LdapRgyRegistry.getUser(LdapRgyRegistry.java:475(Compiled Code))
4XESTACKTRACE                at com/ibm/security/access/user/UserLookupHelper.getUser(UserLookupHelper.java:473(Compiled Code))
4XESTACKTRACE                at jdk/internal/reflect/GeneratedMethodAccessor313.invoke(Bytecode PC:40(Compiled Code)){noformat}

 

These types of calls seem to be stuck in this wait for at least the 2 mins from the first javacore to the last but the CPU usage time increases so that is why I’m asking could this be a stuck loop?",10/Jul/23 5:47 PM;5b1757156d76184b7d98a0c3;[~accountid:5b232b2fd85e5b59b066f57f] Can you please have a look into this? Asha looks to be on leave.,11/Jul/23 1:02 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b1757156d76184b7d98a0c3] - Asha should be back today. [~accountid:5af4ad7d4dd24c579110120b] - please take a look. ,"11/Jul/23 4:56 PM;5c53d3ac23f5bf672621c868;I agree with Annelise , There is a very bad thread blocks at the thread point mentioned.



I believe, customer should also use this



{noformat}
prps.put(""ldap.connection-inactivity"",""10"");
prps.put(""ldap.authn-timeout"",""5""); --> not effective 
prps.put(""ldap.search-timeout"",""5""); --> not effective
prps.put(""ldap.timeout"",""8""); --> not effective{noformat}



I am yet to see how above override jndi or the other way","11/Jul/23 11:15 PM;5c53d3ac23f5bf672621c868;looks these properties are of no effect



[https://cloudidentity.atlassian.net/browse/ISAMDEV-1548|https://cloudidentity.atlassian.net/browse/ISAMDEV-1548|smart-link] 



# ldap.authn-timeout 
# ldap.search-timeout 
# ldap.timeout ","11/Jul/23 11:43 PM;5c53d3ac23f5bf672621c868;important one is {{ldap.connection-inactivity}}

when not set, I am assuming its 0","12/Jul/23 12:58 AM;5b1757156d76184b7d98a0c3;Summary of Today's L2 discusion:

This is the tcp level tuning customer already has

[sysctl.net|http://sysctl.net/].ipv4.tcp_keepalive_time  = 30
[sysctl.net|http://sysctl.net/].ipv4.tcp_keepalive_intvl  = 75
[sysctl.net|http://sysctl.net/].ipv4.tcp_keepalive_probes  = 9

JNDI setting

runtime_profile.jvm_option. = -Dcom.sun.jndi.ldap.connect.timeout=10000
runtime_profile.jvm_option. = -Dcom.sun.jndi.ldap.read.timeout=5000
runtime_profile.jvm_option. = -Dcom.sun.jndi.ldap.connect.pool.maxsize=400
runtime_profile.jvm_option. = -Dcom.sun.jndi.ldap.connect.pool.timeout=5000
runtime_profile.jvm_option.= -Dcom.sun.jndi.ldap.connect.pool=true
runtime_profile.jvm_option.= -Dcom.sun.jndi.ldap.connect.pool.protocol=plain ssl

# jndi settings are still in place
# settings set through fixpack didnt apply or not in effect
# No prps settings in placeAction Plan:

Can we suggest to rollback existing fixpack?
Keep the initial jndi settings.
Set prps to search and auth timeout

prps.put(""ldap.connection-inactivity"",""10000"");
prps.put(""ldap.max-server-connections"",""400"");
prps.put(""ldap.search-timeout"",""5000"");
prps.put(""ldap.timeout"",""5000"");
prps.put(""ldap.authn-timeout"",""5"");

Monitor the environment and collect another javacores if issue occurs.

[~accountid:5af4ad7d4dd24c579110120b] do you feel this will work?","12/Jul/23 10:23 AM;5af4ad7d4dd24c579110120b;<>

A similar stack in another of their item where they have changed the net.ipv4.tcp_retries1 = 3 net.ipv4.tcp_retries2= 3

[https://cloudidentity.atlassian.net/browse/ISAMSUP-3076|https://cloudidentity.atlassian.net/browse/ISAMSUP-3076|smart-link] 

Tracking - 

LdapRgyHandleMgr.java--> retryJndiOperation 
result = invoke(handleState); 
// Do the search
                    namingEnumeration = handleState.getLdapContext().search(
                        getBaseName(), filter, searchControls);
LdapContext ldapContext = handle.getLdapContext();
ldapContext = getLdapContext(bindDn, password, controls, expireTime, keepExpired);


Other - 

{noformat}Thread Name : Default Executor-thread-3886

State : Blocked

Waiting for Monitor Lock on java/lang/String@0x00000006041750D8

Java Stack :
at com/tivoli/am/fim/authsvc/protocol/delegate/AuthSvcDelegate.processRequest(AuthSvcDelegate.java:632(Compiled Code))
at com/tivoli/am/fim/fedmgr2/proper/FederationManager.doInitialRequestOnDelegate(FederationManager.java:476(Compiled Code))
at com/tivoli/am/fim/fedmgr2/proper/FederationManager.finishProcessingWithDelegateId(FederationManager.java:311(Compiled Code))
at com/tivoli/am/fim/fedmgr2/proper/FederationManager.processRequest(FederationManager.java:164(Compiled Code))
at com/tivoli/am/fim/fedmgr2/servlet/SSOPSServletBase.doRequest(SSOPSServletBase.java:129(Compiled Code))
at com/tivoli/am/fim/fedmgr2/servlet/SPSCommandDispatcher.invoke(SPSCommandDispatcher.java:401(Compiled Code))
at com/tivoli/am/fim/war/runtime/liberty/LibertyRuntimeServlet.doGet(LibertyRuntimeServlet.java:56(Compiled Code))
at javax/servlet/http/HttpServlet.service(HttpServlet.java:686(Compiled Code))
at javax/servlet/http/HttpServlet.service(HttpServlet.java:791(Compiled Code)){noformat}

What are the types of flows - this will help us narrow down the recreate -

Is it infomap authentication calls with getUser - (do we have they their javascript) 
Is it federation flows? 

Setting properties can be tried even with the current fixpack in place and get the javacore if they see the behavior -

Set prps to search and auth timeout

[^javacore.20230712.073453.7899.0001.txt]

prps.put(""ldap.connection-inactivity"",""10000"");
prps.put(""ldap.max-server-connections"",""400"");
prps.put(""ldap.search-timeout"",""5000"");
prps.put(""ldap.timeout"",""5000"");
prps.put(""ldap.authn-timeout"",""5"");","13/Jul/23 12:01 AM;5af4ad7d4dd24c579110120b;<notes>
I have a recreate now with a similar stack trace as in the customer env.

rgy logger still doesn't work so I’ve added system out and rebuilding since 10.0.3.1 builds fail with -

{noformat}cd lib && mk MAKEFILE_PASS=STANDARD gather_all
cp -p libtivsec_msgstatic.a /build/isam/ship/amd64_linux_2/opt/IBM/Tivoli/SecUtilities//lib/.
cp: cannot stat 'libtivsec_msgstatic.a': No such file or directory
>> ERROR: mk: ""/build/isam/tools/common/ode/rules_mk/bld.install.mk"", line 136: Command from !cp -p      libtivsec_msgstatic.a      /build/isam/ship/amd64_linux_2/opt/IBM/Tivoli/SecUtilities//lib/.! returned non-zero (1)
>> ERROR: mk: Aborting{noformat}

I cant build anything locally, will have to push changes to travis to get the jars 
Im trying to add system.out calls in place of rgy logger trace in LDAPRgyServer.java where the context attributes are added.","13/Jul/23 1:27 AM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] 

sysctl.net.ipv4.tcp_keepalive_intvl = 75 This is default value. This means every 75 seconds a keep alive is sent. The customer would like to know what would be an appropriate lower value? sysctl.net.ipv4.tcp_keepalive_probes = 9 This is default value. count of probes. The customer would like to know what would be an appropriate lower value?

The customer is using the below code for server connections.  They are asking how one adds the same server tunings to the script and why? (Are these actually set in the script or via lmi directly?)

{noformat}var userLookupHelper = new UserLookupHelper();

var ldapConnection = ServerConnectionFactory

.getLdapConnectionByName(""ISAM LDAP User Registry"");

// userLookupHelper.init(ldapConnection, ""Default"");

userLookupHelper.init(ldapConnection, domain);

return userLookupHelper;

{noformat}","13/Jul/23 11:56 AM;5af4ad7d4dd24c579110120b;<>

Advanced tuning params - 

{noformat}runtime_profile.jvm_option. ==> -Dcom.sun.jndi.ldap.connect.pool.maxsize=200
runtime_profile.jvm_option. ==> -Dcom.sun.jndi.ldap.connect.pool.timeout=5000
runtime_profile.jvm_option. ==> -Dcom.sun.jndi.ldap.connect.timeout=10000
runtime_profile.jvm_option. ==> -Dcom.sun.jndi.ldap.read.timeout=5000
sysctl.net.ipv4.tcp_keepalive_time  = 30
sysctl.net.ipv4.tcp_keepalive_intvl  = 75
sysctl.net.ipv4.tcp_keepalive_probes  = 9{noformat}

Infomap javascript test1 -

{noformat}    var prps = new java.util.Properties();
    prps.put(""ldap.enable-last-login"",""true"");
    prps.put(""ldap.connection-inactivity"",""10"");
    prps.put(""ldap.max-server-connections"",""400"");
    error - 
Cannot convert {ldap.enable-last-login=true, ldap.max-server-connections=400, ldap.connection-inactivity=10} to java.lang.Integer (InfomapRemoteULH#61) (InfomapRemoteULH#83)
{noformat}

infomap javascript test3 - 

{noformat}        var  userLookupHelper = new UserLookupHelper();
        var RemoteLDAP = ""test"";
        var ldapServerConnection = ServerConnectionFactory().getLdapConnectionByName(RemoteLDAP);
        userLookupHelper.init(ldapServerConnection ,""Default"");
        var user = userLookupHelper.getUser(username);
         {noformat}

!image-20230713-010933.png|width=536,height=239!



[https://10.160.21.247/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest3|https://10.160.21.247/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest3] 

When PID is attached - request times out in 120 seconds - (2 minutes)
Start -  

Thu 13 Jul 2023 11:03:03 AEST

End - date

Thu 13 Jul 2023 11:05:04 AEST

reduced http-timeout and https-timeout to 60 seconds and now my browser requests timeout in 8 seconds which is connection timeout but not conclusive.
rest calls still just hang until the first one is processed doesnt timeout at any connection/idle timeout.

Using Jmeter requests just queue up and don't proceed to next one unless the first one times out.
","13/Jul/23 9:28 PM;5b1757156d76184b7d98a0c3;Summary of the todays call.

Customer will implement discussed settings in QA/Dev environment in couple of days and then apply stress test
Once done with that QA/Dev environment will go for change in production.
Next status call on Monday

# Customer to continue implement change
sysctl.net.ipv4.tcp_keepalive_intvl = from 75 to 10
sysctl.net.ipv4.tcp_retries2 = from 15 to 3
# Customer to add 2 more jndi Tuning Paramters
runtime_profile.jvm_option. = -Dcom.sun.jndi.ldap.connect.pool=true
runtime_profile.jvm_option.= -Dcom.sun.jndi.ldap.connect.pool.protocol=plain ssl
# Customer to modify scripts to add these prps 

prps.put(""ldap.connection-inactivity"",""10"");
prps.put(""ldap.max-server-connections"",""400"");

Few of the examples we could find in support file where prps used
./InfoMap_FALCON_2FApost.js:  prps.put(""ldap.enable-last-login"",""true"");
./InfoMap_FALCON_2FApost.js:  prps.put(""mgmt_domain"",""External"");
./OIDC_util_user.js:// // prps.put(""ldap.enable-last-login"", ""true"");
./OIDC_util_user.js:// prps.put(""ldap.login-failures-persistent"", ""true"");
./OIDC_util_user.js:// prps.put(""mgmt_domain"", ""External"");
./OIDC_util_user.js:// // prps.put(""ldap.enable-last-login"", ""true"");
./OIDC_util_user.js:// prps.put(""ldap.login-failures-persistent"", ""true"");
./OIDC_util_user.js:// prps.put(""mgmt_domain"", domain);
./InfoMap_nidLogin.js:        prps.put(""ldap.enable-last-login"",""true"");
./InfoMap_nidLogin.js:        prps.put(""mgmt_domain"",""External"");
./InfoMap_SBE_2FApost.js:  prps.put(""ldap.enable-last-login"",""true"");
./InfoMap_SBE_2FApost.js:  prps.put(""mgmt_domain"",""External"");
./InfoMap_nidPasswordReset.js:    prps.put(""ldap.enable-last-login"",""true"");
./InfoMap_nidPasswordReset.js:    prps.put(""mgmt_domain"",""External"");
./OIDC_util_wstrust.js:         // prps.put(""ldap.enable-last-login"", ""true"");
./OIDC_util_wstrust.js:         prps.put(""ldap.login-failures-persistent"", ""true"");
./OIDC_util_wstrust.js:         prps.put(""mgmt_domain"", ""External"");
./OIDC_util_wstrust.js:         prps.put(""ldap.late-lockout-notification"", ""true"");

# i. Customer to monitor VIP connections towards SDS during the issue.
ii.Incase there is one VIP IP , Is there a chance to provide a host to ip mapping and observe it?
# Action on Support:
L2,L3 and Dev to check internally about timeout issue observed in javacore file.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
high CPU and high response times during BMO performance test,ISAMSUP-5142,306736,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,15/Jun/23 6:11 AM,11/Jul/23 2:57 AM,14/Jul/23 2:47 PM,11/Jul/23 2:57 AM,,,,0,,,,"BMO is running a performance test.

11,400 requests per minute
2 AAC instances
CPU is bouncing around 96% during load
Response times start fast, less than 100 milliseconds, and then creep higher than 5 seconds as test proceeds

Customer states this is an established authentication flow that worked fine on old appliances (that were upgraded from ISAM 8, 9). The problem is exhibited on new ISVA v10.0.3.1 appliances. Customer attached support files from the old and new appliances.

2023-06-14/isva_10.0.3.1_20230614-144606_isamocbfbmga001.srv.bmogc.net.support - *new appliance that exhibited problem*

2023-06-14/isva_10.0.3.1_20230614-155937_isambcclpfmga04-mgmt.srv.bmogc.net.support - *old appliance that did not have problem*",,Dave Bachmann,Nick Lloyd,William Hannon Jr,,,,,,,,,,,,,5af0531368ebd52c36627c3b,5b15d9e6dda5f94d06b985b4,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,15/Jun/23 6:38 AM;whannon;image-20230614-202852.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/206185,15/Jun/23 7:10 AM;rmknowle;image-20230614-210955.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/206198,16/Jun/23 12:41 AM;whannon;image-20230615-144101.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/206406,17/Jun/23 7:53 AM;rmknowle;image-20230616-215226.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/206785,17/Jun/23 7:53 AM;rmknowle;image-20230616-215253.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/206786,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013324852,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Reagan Knowles,5b15d9e44c4ed14b83af8723,,,,BANK OF MONTREAL,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cpwv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-06-14 20:38:21.997,,,,,"15/Jun/23 6:38 AM;5b17571b91981f4fdde632c1;* Appliance CPU rrd graph 60 MAX
** VMWare does *NOT* give you what you need immediately
*** Slowly over time
**** They need to make sure they have proper ramp up to ensure VMWare CPU available
!image-20230614-202852.png|width=1769,height=976!

* dmesg.txt was only 45 seconds long 
** lost any useful message
*** uptime  → 14:46:27 up  4:52,  0 users,  load average: 0.29, 0.12, 4.92
**** Up 4 mininutes 52 seconds
***** Restart lost the data
* Right after each run completes
** BMO VMWare team must immediately capture these graphs for the LOWEST granularity possible for all instances
*** If not done immediately then it will be lost and rounded 
*** VMWare guest MHZ percentage usage graph
*** VMWare host   MHZ available                 graph
* BMO has Dynatrace enabled
** Would like to know how we can leverage this with the customer","15/Jun/23 6:45 AM;5b15d9e44c4ed14b83af8723;Tuning parameters are different between the “working” and “problem” appliances.

Also, the CPU resources are not the same between the working and problem appliances. The problem appliances have half the CPU resources. Customer will increase CPU resources right now to prepare for next test.","15/Jun/23 6:46 AM;5b17571b91981f4fdde632c1;{quote}Tuning parameters are different between the “working” and “failing” appliances{quote}

* Nice job
** ISVA L3 and development standing down for now
*** Reagan agrees","15/Jun/23 6:59 AM;5b17571b91981f4fdde632c1;* Email from Chris Chow (BMO)

{quote}Update from Chris Chow:

Thanks a lot Dave.Regarding this weekend PERF test, it is confirmed we are experiencing high CPU in both WGA (~80%) and AAC (100%).{quote}



* Understand AAC CPU was not configured the same.
* What about the WGA %80 CPU
** Is the customer concerned about WGA %80 CPU
*** What is the prior history of this run for the WGA?
** Is more investigation required?



* Only file uploaded to ECUREP
** TS013324852/2023-06-14/isva_10.0.3.1_20230614-144606_isamocbfbmga001.srv.bmogc.net.support
*** No WebSEAL conf files
**** If the WGA CPU is still a concern","15/Jun/23 7:07 AM;5b15d9e44c4ed14b83af8723;Ugly picture of the differences between tuning parameters. Red/Left side is the problem appliance. Green/Right side is the old working appliance.


!image-20230614-210955.png|width=1653,height=785!","15/Jun/23 10:51 AM;5b15d9936d76184b7d989c82;** Note: prior to this evening’s testing, the customer relayed that the CPU cores were increased by an order of 3-fold prior to this evening's load tests...

** also, they said they made some tuning adjustments, but will need to see which from the support file… they noted that some diffs were from using defaults for some settings, vs changing to explicitly setting the tunings (so they could definitively see what they are set to)…



first load test (100 TPS) started at 6:47 Central / 7:47 Eastern... customer indicated that it would take roughly 20 minutes to reach the 100 TPS mark... 

the 100 TPS test ramped up to 100 TPS about 20 minutes into the testing as predicted... the intent was to let the testing run at that plateau for about 30 minutes... the customer is actively capturing a few java cores along the way... and then multiple sets at the end of the run… 

it was noted that the VMWare resource reporting for CPU, while trending in the same direction as Dynatrace reporting, varied… Dynatrace reporting lower utilization than the VMWare resource reporting… the customer will be uploading graphs from both… 

support file upload for the 100TPS test:

[2023-06-15/isva_10.0.3.1_20230614-204403_isamocbfbmga001.srv.bmogc.net.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013324852&path=TS013324852/2023-06-15/&filepath=TS013324852/2023-06-15/isva_10.0.3.1_20230614-204403_isamocbfbmga001.srv.bmogc.net.support]

since the 100TPS test ran to completion w/o toppling the CPU, then a subsequent test was initiated after support file generation from the first test, but this time, ramping up to 180 TPS...



second load test (180 TPS) started at 7:52 Central / 8:52 Eastern... customer indicated that it would take roughly 30 minutes to reach the 180 TPS mark...

the 180 TPS testing folded in first time login... or something to that effect... this was from customer conversation during testing... they are seeing slightly longer response times based on some portion of the first time login flow... but not delays that are concerning enough to be considered a problem... might need to follow-up to confirm exactly where the delays were noted... there was mention of the /api junction... the customer did not seem overly concerned about this, but did make note of it…

the customer is letting the 180 TPS test cook for longer… over an hour… they have collected one set of java cores while running at peak, and will collect another, and then another support file… and should still also be ending CPU/memory charts per the conversation on the call…. ","15/Jun/23 11:49 AM;5b17571b91981f4fdde632c1;{quote}it was noted that the VMWare resource reporting for CPU, while trending in the same direction as Dynatrace reporting, varied… Dynatrace reporting lower utilization than the VMWare resource reporting… the customer will be uploading graphs from both…{quote}

* Which is why you never trust the guest CPU
** Including the appliance CPU graphs
*** The total percentage used will not be accurate
**** Because VMWare can add or remove CPU without guest knowledge
*** The breakdown of user vs system percentage should be accurate
* The VMWare charts are the most accurate CPU data
** And the VMWare host MHZ available will show if overcommitted","15/Jun/23 2:51 PM;5b15d9936d76184b7d989c82;** Note: customer uploaded support file following the 180 TPS load test:

[2023-06-15/isva_10.0.3.1_20230614-215824_isamocbfbmga001.srv.bmogc.net.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013324852&path=TS013324852/2023-06-15/&filepath=TS013324852/2023-06-15/isva_10.0.3.1_20230614-215824_isamocbfbmga001.srv.bmogc.net.support]

also a zip file with screenshots from resource monitoring:

[2023-06-15/Test1_cpu_screenshots.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013324852&path=TS013324852/2023-06-15/&filepath=TS013324852/2023-06-15/Test1_cpu_screenshots.zip]","15/Jun/23 2:57 PM;5b15d9e44c4ed14b83af8723;[~accountid:5af0531368ebd52c36627c3b] [~accountid:5b17571b91981f4fdde632c1] Correct me if I’m wrong, after adding more CPU and memory, the latest tests from BMO achieved their goal - 180 transactions per second. The customer uploaded new support files from the latest tests, but I don’t know what problem they want us to investigate/pursue. I have asked the customer to explicitly state the problem they want us to investigate.","15/Jun/23 10:48 PM;5b17571b91981f4fdde632c1;* Where are the times
** the run information
** when the run was fully ramped up
** when they started any diagnostics","15/Jun/23 10:55 PM;5b17571b91981f4fdde632c1;* The 2306015 two support files are from *ONE* system 
** Why this one system?
*** Why 01:14:00 minutes apart
** Why two support files
*** What is the purpose of each support file
* Or is more data arriving?","16/Jun/23 12:41 AM;5b17571b91981f4fdde632c1;* Why the two ramps?
** Continuously?

!image-20230615-144101.png|width=890,height=989!","16/Jun/23 1:21 AM;5b17571b91981f4fdde632c1;* Here are javacore primary stacks flow
** Higher level then serializes as needed

{noformat}----------------------------------------------------
at com/tivoli/am/fim/om/ObjectManager$Configuration.getObject(ObjectManager.java:165)
----------------------------------------------------
at com/tivoli/am/fim/om/ObjectManager.get(ObjectManager.java:104)
----------------------------------------------------
at com/tivoli/am/fim/fedmgr2/proper/FederationManager.getInstance(FederationManager.java:89)
----------------------------------------------------
at com/tivoli/am/fim/fedmgr2/servlet/SSOPSServletBase.doRequest(SSOPSServletBase.java:128)
----------------------------------------------------
at com/tivoli/am/fim/fedmgr2/servlet/SPSCommandDispatcher.invoke(SPSCommandDispatcher.java:401)
at com/tivoli/am/fim/fedmgr2/servlet/SPSCommandDispatcher.invoke(SPSCommandDispatcher.java:442)
----------------------------------------------------
at com/tivoli/am/fim/war/runtime/liberty/LibertyRuntimeServlet.doGet(LibertyRuntimeServlet.java:56)
at com/tivoli/am/fim/war/runtime/liberty/LibertyRuntimeServlet.doPost(LibertyRuntimeServlet.java:92)
----------------------------------------------------
at javax/servlet/http/HttpServlet.service(HttpServlet.java:686)
at javax/servlet/http/HttpServlet.service(HttpServlet.java:706)
----------------------------------------------------
at javax/servlet/http/HttpServlet.service(HttpServlet.java:791)
----------------------------------------------------
at com/ibm/ws/webcontainer/servlet/ServletWrapper.service(ServletWrapper.java:1258)
----------------------------------------------------
at com/ibm/ws/webcontainer/servlet/ServletWrapper.handleRequest(ServletWrapper.java:746)
----------------------------------------------------
at com/ibm/ws/webcontainer/servlet/ServletWrapper.handleRequest(ServletWrapper.java:443)
----------------------------------------------------
at com/ibm/ws/webcontainer/filter/WebAppFilterChain.invokeTarget(WebAppFilterChain.java:183)
----------------------------------------------------
at com/ibm/ws/webcontainer/filter/WebAppFilterChain.doFilter(WebAppFilterChain.java:79)
at com/ibm/ws/webcontainer/filter/WebAppFilterChain.doFilter(WebAppFilterChain.java:94)
----------------------------------------------------
at com/ibm/ws/webcontainer/filter/WebAppFilterManager.doFilter(WebAppFilterManager.java:1002)
----------------------------------------------------
at com/ibm/ws/webcontainer/filter/WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1140)
at com/ibm/ws/webcontainer/filter/FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:201)
----------------------------------------------------
at com/ibm/ws/webcontainer/filter/WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1011)
at com/ibm/ws/webcontainer/filter/WebAppFilterChain.doFilter(WebAppFilterChain.java:91)
----------------------------------------------------
at com/ibm/ws/webcontainer/servlet/CacheServletWrapper.handleRequest(CacheServletWrapper.java:75)
at com/ibm/ws/webcontainer/filter/WebAppFilterManager.doFilter(WebAppFilterManager.java:1002)
----------------------------------------------------
at com/ibm/ws/webcontainer40/servlet/CacheServletWrapper40.handleRequest(CacheServletWrapper40.java:85)
at com/ibm/ws/webcontainer/filter/WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1140)
----------------------------------------------------
at com/ibm/ws/webcontainer/WebContainer.handleRequest(WebContainer.java:938)
at com/ibm/ws/webcontainer/filter/WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1011)
----------------------------------------------------{noformat}",16/Jun/23 2:24 AM;5b17571b91981f4fdde632c1;No unusual error messages during the loudest.,"16/Jun/23 2:28 AM;5b17571b91981f4fdde632c1;* For IBM ISVA Support only

{color:#bf2600}From Chris Chow 09:55 AM{color}

Hi Everyone,

 Last night with the new CPU/Memory setting we were able to hit target 180TPS for short period of time, before other layer hitting issue.

 During this test we observe 80% CPU usage on both CWGA and AAC. Internally we will discuss from server standpoint see can we increase more CPU core etc.

 We had the collected data uploaded to the PMR. I want to confirm did IBM see anything special or anything we need to concern?



-Chris","16/Jun/23 2:50 AM;5b17571b91981f4fdde632c1;* For IBM ISVA Support only
** The customer has chosen not to respond to L2 via SalesForce
*** ISVA L2 and L3 have completed analysis based
**** More information/details from customer","16/Jun/23 3:45 AM;5b17571b91981f4fdde632c1;* Additional questions (or may be repeated … sorry)
** Required for each and every performance run
*** Performance test characteristics
*** Which ISVA hostnames of *ALL* appliances involved
**** WebSEAL(s)
**** AAC(s)
*** Start time yy/mm/dd hh:mm:ss of run
*** Start time yy/mm/dd hh:mm:ss of when fully ramped up for test
*** End   time yy/mm/dd hh:mm:ss of clean (without ramp down, diagnostics, etc.)  performance test 
*** Start/End time yy/mm/dd hh:mm:ss for each step diagnostic data collections
*** Final end time yy/mm/dd hh:mm:ss
*** Support files from *ALL* appliances involved
**** Upload to IBM ECUREP
*** Loadrunner report
**** Upload to IBM ECUREP
*** Any observations, findings or corrections needed during test
**** Post to IBM SalesForce case
*** Would be very helpful
**** VMWare
***** VMWare host available MHZ lowest granularity (close to completion of test)
***** VMWare guest MHZ percentage lowest granularity (close to completion of test)
**** Dynatrace
***** Any high level reports or details of the run
*** Plus any other requested steps by ISVA Support
* If required data is missing
** It *may delay* the ability for ISVA Support to properly start reviewing the customer’s data
* Customer needs to have someone responsible to response to *all*  ISVA Support questions *in the SalesForce case*
** Who is this person who will help drive across the teams?



[~accountid:5b15d9e44c4ed14b83af8723] [~accountid:5b15d9936d76184b7d989c82] [~accountid:5af0531368ebd52c36627c3b] 

* Please feel free to add anything else
** Once the list is completed
*** We can go back to customer and ask for all the missing parts
*** And make sure they have next time","16/Jun/23 12:27 PM;5af0531368ebd52c36627c3b;INTERNAL DISCUSSION ONLY

I have been looking at the javacores that were collected from 16:15:32 to 16:18:27 as well as from 19:51:09 to 20:37:47 and from 21:45:00 to 21:49:20.

In almost all of them I see that all but one of the active worker threads is in com/tivoli/am/fim/om/ObjectManager$Configuration.getObject while one of them owns the lock on com/tivoli/am/fim/fedmgr2/proper/FederationManager@0x00000005049E0568 and is doing a Mesa call to getJksPassword.

{noformat}3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at java/lang/Object.wait(Native Method)
4XESTACKTRACE                at java/util/concurrent/TimeUnit.timedWait(Bytecode PC:27)
4XESTACKTRACE                at java/lang/ProcessImpl.waitFor(Bytecode PC:38)
4XESTACKTRACE                at com/tivoli/am/fim/appliance/mesa/MesaCommand.runCommand(MesaCommand.java:241(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/appliance/mesa/MesaCommand.<init>(MesaCommand.java:76)
4XESTACKTRACE                at com/tivoli/am/fim/appliance/mesa/MesaConfigArray.call(MesaConfigArray.java:74)
4XESTACKTRACE                at com/tivoli/am/fim/utils/Password.getJksPassword(Password.java:164)
4XESTACKTRACE                at com/tivoli/am/fim/kess/service/jks/mgmt/KessServiceClientConfiguration.processJKSFiles(KessServiceClientConfiguration.java:1128)
4XESTACKTRACE                at com/tivoli/am/fim/kess/service/jks/mgmt/KessServiceClientConfiguration.readInAllJKSFiles(KessServiceClientConfiguration.java:966)
4XESTACKTRACE                at com/tivoli/am/fim/kess/service/jks/mgmt/KessServiceClientConfiguration.<init>(KessServiceClientConfiguration.java:251)
4XESTACKTRACE                at com/tivoli/am/fim/kess/service/jks/worker/KessServiceJksWorkerFactory.postConstruct(KessServiceJksWorkerFactory.java:64)
4XESTACKTRACE                at jdk/internal/reflect/NativeMethodAccessorImpl.invoke0(Native Method)
4XESTACKTRACE                at jdk/internal/reflect/NativeMethodAccessorImpl.invoke(Bytecode PC:100(Compiled Code))
4XESTACKTRACE                at jdk/internal/reflect/DelegatingMethodAccessorImpl.invoke(Bytecode PC:6(Compiled Code))
4XESTACKTRACE                at java/lang/reflect/Method.invoke(Bytecode PC:61(Compiled Code))
4XESTACKTRACE                at com/tivoli/am/fim/om/ObjectManager$Configuration.getObject(ObjectManager.java:172(Compiled Code))
5XESTACKTRACE                   (entered lock: com/tivoli/am/fim/kess/service/jks/worker/KessServiceJksWorkerFactory@0x000000050062C210, entry count: 1){noformat}

So we are getting serialized waiting on this Mesa call to get the JKS password to read in the configuration.

I remember Soum running into this a year or two ago, and I thought we fixed this.","17/Jun/23 2:31 AM;5b17571b91981f4fdde632c1;* For ISVA L3 Support only
** [https://cloudidentity.atlassian.net/browse/ISAMSUP-3280|https://cloudidentity.atlassian.net/browse/ISAMSUP-3280|smart-link] 
** [https://cloudidentity.atlassian.net/browse/ISAMSUP-3248|https://cloudidentity.atlassian.net/browse/ISAMSUP-3248|smart-link]","17/Jun/23 7:41 AM;5b15d9e44c4ed14b83af8723;When I first joined this afternoon's call, they were hitting AAC error regarding the max session limit. The have two AAC instances, both using 150k for the Maximum Session Count. We checked the working legacy environment and the value was unset, which means the default value of 250k will be used. BMO then increased the ""Maximum Session Count"" in the new environment and the max session limit errors no longer appeared.

*Current problem:* Some requests going through AAC show slow response times. Customer has a report showing the slowest 10% or responses averaged 10.4 seconds. The two AAC instances are serving OTP requests around 130 transactions per second. I'll add screenshots showing an overview of the slowest 10% and 5% or responses.

Today's test was 45.5k transactions per minute or 758 transactions per second. However, not all of these transactions involved an OTP flow that involved the AAC instances.

Today's test used two AAC instances. They have a Primary Master in the cluster that is not yet in the AAC pool, it is just acting as the cluster Primary Master. In the future, they plan to add this third ISVA appliance to the mix, so they will have three total AAC instances serving the OTP flows.

New support files attached to the case, including all ISVA appliances
*June 16*

{noformat}AAC appliances:
	isva_10.0.3.1_20230616-164823_isamocbfbmga001.srv.bmogc.net.support_unpack
	isva_10.0.3.1_20230616-164828_isamocbfbmga002.srv.bmogc.net.support_unpack

WebSEAL appliances:
	isva_10.0.3.1_20230616-164900_isambcclpfwga04.srv.bmogc.net.support_unpack	
	isva_10.0.3.1_20230616-164917_isambcclpfwga05.srv.bmogc.net.support_unpack
	isva_10.0.3.1_20230616-164935_isambcclpfwga06.srv.bmogc.net.support_unpack

You can ignore this one. It's from a failing test where AAC ""Maximum Session Count"" was set too low, 150k.
	isva_10.0.3.1_20230616-152553_isamocbfbmga001.srv.bmogc.net.support_unpack{noformat}

Stop/Start times for the test (after the Maximum Session Count error was corrected)

{noformat}Test started : 03:51 PM 
Test ended : 04:42 PM {noformat}

*Outstanding requests:* I've asked the customer to attach the CPU/Memory graphs from Dynatrace, VM host, ESX host","17/Jun/23 7:53 AM;5b15d9e44c4ed14b83af8723;Response times for the slowest 5% of responses


!image-20230616-215226.png|width=1608,height=686!

Response times for the slowest 10% of responses:


!image-20230616-215253.png|width=1621,height=722!","17/Jun/23 11:14 AM;5af0531368ebd52c36627c3b;I’ve been looking at the two sets of javacores that they collected, on the two AAC appliances.

Overall, 24% of the active worker threads (those in handleRequest) were blocked waiting in getObject to get the lock so they can call Password.getJksPassword and fork a process to run a Mesa Command.  [~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5ac57757d9a96536d1f0daa9] I think we need to understand why this code is repeatedly loading the Jks Password from a file instead of using the caching support in PasswordJksKeystoreHelper.java

See example stack in my comment [https://cloudidentity.atlassian.net/browse/ISAMSUP-5142?focusedCommentId=667871|https://cloudidentity.atlassian.net/browse/ISAMSUP-5142?focusedCommentId=667871|smart-link] 

I had thought Soum found this and it was fixed a couple of years ago, but maybe this is another instance of the same problem.

Apart from our contribution to the problem, 74% of the active worker threads were executing custom Javascript code such as AuthSvcCredential_BHOB_132 which ends up calling out to another service such as an audit service.  Almost all of these threads end up waiting in HttpClient.doRequest for an answer from the other service.  This part should be under BMO’s control.","17/Jun/23 10:31 PM;5af0531368ebd52c36627c3b;I believe DynaTrace is supposed to be able to show them where the worker threads are spending their time, just like GlowRoot does.  So they really should be looking at the Dynatrace profiling information for their AAC servers to see how they can optimize their custom JavaScript.

The rough breakdown of BMO custom JavaScript, which all waiting on HTTP calls to other services, is

67% publishAuditevents
10% OTPGenerate_BHOB
9% OTPGetMethods_BHOB
8% AuthSvcCredential_BHOB
4% OTPDeliver_BHOB



[~accountid:5b15d9e44c4ed14b83af8723] could you pass this along in the Case?  And if they pull you into any calls today remind them that they should be able to use Dynatrace to see where they are spending the time in their custom JavaScript.",18/Jun/23 2:08 AM;5b15d9e44c4ed14b83af8723;I forwarded Dave’s update to the customer.,18/Jun/23 5:35 AM;5af0531368ebd52c36627c3b;Thanks.  You could also mention that the majority of the active worker threads were waiting in the BMO custom JavaScript.  I should have included that point in my update along with the breakdown.,"20/Jun/23 5:09 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** Customer had separate transactions per second (TPS) testing on 
*** WebSEAL
**** Resolved and met in other 
*** WebSEAL and AAC
**** Believe they met the TPS WebSEAL and AAC testing
**** Customer then brought slow responses from Dynatrace
***** Suggested and discussed with Dave Bachmann to scale more horizontally
****** To reduce the wait time on resource
***** The customer is now planning on adding a third AAC server
****** Let's see how this goes","27/Jun/23 3:44 AM;5b15d9e44c4ed14b83af8723;FYI - I’m out the rest of this week. If you need L2, then please reach out to Gabriel Bell, he’s my backup for this case. I asked the customer for an update and am waiting to hear back. I’ll return on July 3.  [~accountid:5b15d99b4c20165700edecad] ","08/Jul/23 2:47 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** L3 requested L2 request SalesForce case closure to force customer update/status.","11/Jul/23 2:57 AM;5b15d9e44c4ed14b83af8723;We haven’t received a response from the customer since June 19, so I closed the Salesforce case.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
How to enable TLS 10.0 on ISVA 10' FELB,ISAMSUP-5148,307456,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,,Peter Horner,5b15d9517dab4c51f61b5190,Seiji Kikuchi,5c2c1788ab1c1d35825c4da1,Seiji Kikuchi,5c2c1788ab1c1d35825c4da1,19/Jun/23 7:26 PM,22/Jun/23 7:34 PM,14/Jul/23 2:47 PM,,,,,0,,,,"Hello,

The customer is using FELB (Front End Load Balacer) of ISVA.
They upgraded their system from ISAM 9 to ISVA 10.0.5.
After upgrade, one of terminal cannot connect with ""server not found"" error.
Problem terminal can connect to ISAM 9 and worked with no problem, but it does not work with ISVA 10.

The customer checked Internet option of problem terminal (IE). But there are only following encryption.

* Use SSL 2.0
* Use SSL 3.0
* Use TLS 1.0
So the customer's IE seems very old.
It seems problem terminal cannot use TLS 1.1 or 1.2 and have problem.

Is ISVA 10's FELB enabled to use TLS 1.0 by default?
If TLS 1.0 is disabled, is there a way to enable Week encryption such as TLS 1.0?

Thanks and regards,",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013287862,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Seiji Kikuchi,5c2c1788ab1c1d35825c4da1,,,,MURATA KIKAI,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cu9r:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-19 11:26:57.184,,,,,"19/Jun/23 9:26 PM;5b15d9517dab4c51f61b5190;There is an advanced  tuning parameter 

felb.enable.sslv3          Enable SSLv3 support for the front-end load balancer.  Valid values are true or false.

I haven’t tried it myself","20/Jun/23 6:54 PM;5c2c1788ab1c1d35825c4da1;Hello Peter-san,  [~accountid:5b15d9517dab4c51f61b5190] 
Thank you for your support.

I do not find description of felb.enable.sslv3. Is this an enable/disable parameter for only SSL v3? Or is it also contains TLS 1.0?
If only for SSL V3, is there similar parameters for TLS 1.x?
Because the customer also wants to try TLS 1.0.

Also I found following technote. It is described for ISAM 9.
 TLS, SSL and Cipher Specifications for the ISAM Front End Load Balancer
 [https://www.ibm.com/support/pages/tls-ssl-and-cipher-specifications-isam-front-end-load-balancer|https://www.ibm.com/support/pages/tls-ssl-and-cipher-specifications-isam-front-end-load-balancer]
Can we use the parameters written in Technote with ISVA 10?
If yes, I would like to confirm followings.

* It seems that there are specifications for each encryption type as shown below, but should we set everything we want to use to ""true""?
  virtual.force-sslv3, virtual.force-tlsv10, virtual.force-tlsv11, virtual.force-tlsv12
Because there is also a parameter called ""virtual.no-xxxx"", and it is unclear what value should be set for each parameter.
* Are the values of these parameters True or False?

Thanks and regards,","20/Jun/23 10:54 PM;5b15d9517dab4c51f61b5190;I found the advanced tuning parameter in the latest source code - so its still available for ISVA 10

I will set up a felb and verify the use of the parameters mentioned in the link","22/Jun/23 7:34 PM;5c2c1788ab1c1d35825c4da1;Hello Peter-san,  [~accountid:5b15d9517dab4c51f61b5190] 
Thank you for your support.

Thanks for confirming that the parameters in the technote are also in ISVA 10.
What are the possible values for these parameters? (True or false or other value)
The customer would like to know how to configure TLS, SSL and Cipher on FELB as soon as possible, so any information would be greatly appreciated.

Thanks and regards,",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Memory growth observed after Upgrade to ISVA 10.0.5.0 IF1,ISAMSUP-5123,305017,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,,David Hayes,5b232b2fd85e5b59b066f57f,adarsh.nair,605c0c04b18de50071046740,adarsh.nair,605c0c04b18de50071046740,06/Jun/23 12:46 PM,06/Jul/23 1:09 PM,14/Jul/23 2:47 PM,,,Support,,0,Growth,,,"Customer upgraded from 9.0.7.1 to version 10.0.5.0 and observe steady memory growth.They take reboot of the system to temporarily bring down the memory.This cycle is observed all the time after upgrade.

from the webseal message logs L2 could see below messages in webseal messages below message logged total 7k times starting from ""2023-05-03""

{noformat}2023-05-08-06:31:08.013+03:00I----- 0x38CF0B23 webseald ERROR wwa soap AMWSOAPCall.cpp 434 0x7fb0c19a8700 -- DPWWA2851E   An error was returned from the SOAP server in cluster cluster1 when calling the ping interface: DPWWA1082E   Invalid HTTP status code present in response.  The response could have been sent either by a third-party server or by a local resource, such as a CGI program. (pd / wwa) (code: 0x38cf043a).{noformat}

So support asked customer to apply IF1 as below APAR is fixed in 10.0.5.0 IF1

*IJ46144*
*DSC MEMORY LEAK WHEN RETURNING SOAPFAULT*


As per latest webseal message logs we no longer see above message in Webseal  logs..but still they observe the same pattern of memory growth.


This issue is observed in both Prod and Preprod environment.
following components are running on the system facing the issue.
Rev proxy,Fed/AAC runtime
On few systems they have Policy Server as well running.
The Federation runtime tracing is not enabled.

Here are few process  {{top_memory.log}}

{noformat}isva_10.0.5.0_20230605-092539_GIWSEALPP01.support_unpack
isva_10.0.5.0_20230605-092539_GIWSEALPP01.support_unpack/var/application.logs/cli/top_memory.log
Mon Jun  5 09:26:35 +03 2023

/usr/bin/top -b -n1 -m
Mem total:8146684 anon:2187480 map:196616 free:3718236
slab:189836 buf:189508 cache:1747308 dirty:8512 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1725 3988m 2536m  923m 72300  849m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1231 3907m 1317m 1125m 66084 1034m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2675 1589m  320m  140m 37948 97900     0   128 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
1011 1216m  125m 40908 27216 12564     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
2620 1067m  190m 46872 29456 17160     0   132 /opt/PolicyDirector/bin/pdmgrd -foreground
2749  920m  112m 45364 28072 16412     0   132 wga_notifications -foreground
931  746m  115m 20960 10832 11212  2124   132 /usr/sbin/wga_clustermgrd
705  696m 87232 20244  8472 10752   840   132 /usr/sbin/mesa_eventsd -m 1000
2656  417m 49084 29676 23056  8344  1860   132 /usr/sbin/wga_servertaskd

##########
isva_10.0.5.0_20230605-094328_GIWSEALPP02.support_unpack
isva_10.0.5.0_20230605-094328_GIWSEALPP02.support_unpack/var/application.logs/cli/top_memory.log
Mon Jun  5 09:44:25 +03 2023

/usr/bin/top -b -n1 -m
Mem total:8146692 anon:2244412 map:192588 free:3670248
slab:192960 buf:193704 cache:1744024 dirty:8036 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1742 3986m 2533m  917m 69068  846m     0   120 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1304 3921m 1319m 1106m 63244 1020m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2109 1589m  322m  148m 34424  104m     0   132 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2164  920m  112m 47164 28004 18212     0   132 wga_notifications -foreground
1097  705m  121m 38656 27412  9884     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
706  696m 86760 13900  8804  4252   840   132 /usr/sbin/mesa_eventsd -m 1000
2072  620m  240m  133m  5188  123m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
910  594m 93228 14640 11492  5028  2124   132 /usr/sbin/wga_clustermgrd
2101  414m 55880 14612  7776  6808     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground

##########
isva_10.0.5.0_20230605-094524_HIWSEALPP01.support_unpack
isva_10.0.5.0_20230605-094524_HIWSEALPP01.support_unpack/var/application.logs/cli/top_memory.log
Mon Jun  5 09:47:01 +03 2023

/usr/bin/top -b -n1 -m
Mem total:8146692 anon:2132856 map:184700 free:3574020
slab:188400 buf:144104 cache:2011892 dirty:8588 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1711 3981m 2508m  860m 70276  782m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1248 3945m 1308m 1101m 64968 1019m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2001 1587m  292m  107m 34524 64848     0   128 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2044  920m  112m 47004 28372 18016     0   132 wga_notifications -foreground
1180  705m  121m 37884 27016  9768     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
795  696m 87344 15976  8668  6416   840   132 /usr/sbin/mesa_eventsd -m 1000
1968  620m  240m  134m  5284  124m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
1005  530m 93100 14560 11348  5040  2132   132 /usr/sbin/wga_clustermgrd
1993  414m 55880 14652  7828  6792     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground

##########
isva_10.0.5.0_20230605-094541_HIWSEALPP02.support_unpack
isva_10.0.5.0_20230605-094541_HIWSEALPP02.support_unpack/var/application.logs/cli/top_memory.log
Mon Jun  5 09:46:12 +03 2023

/usr/bin/top -b -n1 -m
Mem total:8146692 anon:2126916 map:180528 free:4049088
slab:187372 buf:147720 cache:1542220 dirty:333736 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1710 3980m 2509m  854m 69088  782m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1257 3854m 1325m 1104m 63240 1021m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
1997 1587m  291m  104m 34348 61556     0   128 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2349  920m  112m 47552 28464 18368     0   132 wga_notifications -foreground
795  696m 86652 13824  8616  4268   836   132 /usr/sbin/mesa_eventsd -m 1000
1193  640m  119m 36700 27344  8240     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
1964  620m  240m  132m  5064  122m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
1016  530m 93068 18780 11468  9092  2124   132 /usr/sbin/wga_clustermgrd
1989  414m 55880 14484  7668  6784     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground

##########
isva_10.0.5.0_20230605-095625_HIWSEALPR02.support_unpack
isva_10.0.5.0_20230605-095625_HIWSEALPR02.support_unpack/var/application.logs/cli/top_memory.log
Mon Jun  5 09:57:55 +03 2023

/usr/bin/top -b -n1 -m
Mem total:8118912 anon:1508408 map:179036 free:4626540
slab:206472 buf:140608 cache:1542100 dirty:229288 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1692 3980m 2507m  843m 71440  770m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1250 3811m  716m  495m 65600  414m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
1988 1661m  371m  120m 34668 77556     0   128 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2087  920m  110m 47396 28304 18404     0   132 wga_notifications -foreground
795  696m 87928 14248  8592  4712   836   132 /usr/sbin/mesa_eventsd -m 1000
1186  640m  119m 38768 27340 10304     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
1955  620m  240m  134m  5196  124m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
1004  466m 93032 14680 11364  5016  2124   132 /usr/sbin/wga_clustermgrd
1980  414m 55884 14608  7808  6792     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground

##########
isva_10.0.5.0_20230605-095636_HIWSEALPR01.support_unpack
isva_10.0.5.0_20230605-095636_HIWSEALPR01.support_unpack/var/application.logs/cli/top_memory.log
Mon Jun  5 09:58:05 +03 2023

/usr/bin/top -b -n1 -m
Mem total:8118920 anon:1526316 map:179036 free:4596996
slab:206920 buf:142436 cache:1545504 dirty:225180 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1691 3980m 2511m  842m 70896  771m     0   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1251 3816m  724m  515m 65368  433m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
1986 1661m  370m  117m 34584 73712     0   132 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2347  920m  111m 47204 28504 18008     0   132 wga_notifications -foreground
1187  705m  121m 38392 27460  9792     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
794  696m 87816 16956  8572  7372   832   132 /usr/sbin/mesa_eventsd -m 1000
1955  620m  240m  132m  5056  122m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
1003  530m 93100 14556 11244  5004  2124   132 /usr/sbin/wga_clustermgrd
1973  414m 55888 14500  7700  6796     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground

##########
isva_10.0.5.0_20230605-095652_GIWSEALPR02.support_unpack
isva_10.0.5.0_20230605-095652_GIWSEALPR02.support_unpack/var/application.logs/cli/top_memory.log
Mon Jun  5 09:57:26 +03 2023

/usr/bin/top -b -n1 -m
Mem total:8146252 anon:1707588 map:182892 free:4346832
slab:196204 buf:190408 cache:1598024 dirty:332304 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1859 5020m 2562m  970m 68548  899m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1427 4830m  715m  488m 62544  408m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2361 2685m  431m  178m 34520  133m     0   128 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2966  920m  111m 46060 28264 16784     0   132 wga_notifications -foreground
1214  897m  122m 38876 27104 10520     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
725  696m 87232 16160  8488  6648   836   132 /usr/sbin/mesa_eventsd -m 1000
2305  620m  240m  132m  5212  123m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
942  594m 93164 14832 11564  5032  2124   132 /usr/sbin/wga_clustermgrd
2353  414m 55888 14500  7676  6824     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground

##########
isva_10.0.5.0_20230605-095709_GIWSEALPR01.support_unpack
isva_10.0.5.0_20230605-095709_GIWSEALPR01.support_unpack/var/application.logs/cli/top_memory.log
Mon Jun  5 09:57:47 +03 2023

/usr/bin/top -b -n1 -m
Mem total:8146244 anon:1652676 map:195896 free:4306340
slab:198740 buf:193872 cache:1676540 dirty:230064 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1855 5019m 2560m  961m 71216  887m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1309 4835m  722m  514m 64864  425m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2537 2685m  432m  182m 37500  138m     0   124 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
1046 2240m  140m 46616 27300 18244     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
2472 1100m  222m 50512 29292 20888     0   132 /opt/PolicyDirector/bin/pdmgrd -foreground
2709  920m  111m 48560 28172 19464     0   132 wga_notifications -foreground
953  810m  115m 16980 10964  7172  2124   132 /usr/sbin/wga_clustermgrd
724  696m 87232 14300  8716  4608   844   132 /usr/sbin/mesa_eventsd -m 1000
2517  417m 49092 32216 23536 10348  1860   132 /usr/sbin/wga_servertaskd

##########

{noformat}

You can find images of memory and CPU graph(for 3days/7days/30days) and support files here.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-05%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-05%2F]

",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5130,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013082124,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,SAUDI ARABIAN MONETARY AGENCY BANKING TECHNOLOGY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-05%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1cfdb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-07 02:55:12.404,,,,,"07/Jun/23 12:55 PM;5b232b2fd85e5b59b066f57f;[~accountid:605c0c04b18de50071046740] - based on your analysis - have you been able to narrow down which process is growing? Based on what is in the description and from what I can see in ecurep, it doesn’t seem that any process is growing by any significant amount - but this may just be due to not capturing top output at the right points in time. Growth can clearly be seen in the graphs over several days to a week - but we need to narrow down which process it is coming from. We will need a capture of top after restart and then after a reasonable amount of time has passed so that we can identify the process which is growing. ",07/Jun/23 12:55 PM;5b232b2fd85e5b59b066f57f;Also - is the customer using EC crypto operations anywhere in their deployment? There is a known leak here in Java (REF: [https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|smart-link] ). ,"07/Jun/23 1:08 PM;605c0c04b18de50071046740;Shall I ask customer to 

# {noformat}Restart their appliances.
Take support file from all appliances after restart
generate support file every day.{noformat}

Or do you suggest any alternative?

Could you please be more specific as to what do you mean by 'EC crypto operations anywhere in their deployment' ?
Are you asking to check SAML/OIDC federation where any encryption is performed using EC ciphers?
Do we need to check the signing part also or just the encryption part ?

","07/Jun/23 3:42 PM;5b232b2fd85e5b59b066f57f;Hi Adarsh. 

I’ve had another look at the customer’s graphs - it seems there is only an issue in pre-prod environments, not prod - is that correct? There are a lot of support files and images uploaded from a range of Appliances - which ones should we be looking at?

It looks like in the pre-prod environment they have a reasonable rate of growth after around 3 days. What we would need is a support file after restart and once everything should have started up and stablised, then one at the 3 day mark (assuming no restarts in between). ","07/Jun/23 4:26 PM;605c0c04b18de50071046740;[~accountid:5b232b2fd85e5b59b066f57f] ,
Customer had mentioned 'We are facing the issue on both preprod and production environments.'

here are the files from Prod and Pre prod env.

Pre prod graph images(CPU and memory)

{noformat}CPU-30_days-_PreProd-GIWSEALPP01.PNG     CPU-3_days-_PreProd-HIWSEALPP01.PNG      Memory-30_days-_PreProd-GIWSEALPP01.PNG  Memory-3_days-_PreProd-HIWSEALPP01.PNG
CPU-30_days-_PreProd-GIWSEALPP02.PNG     CPU-3_days-_PreProd-HIWSEALPP02.PNG      Memory-30_days-_PreProd-GIWSEALPP02.PNG  Memory-3_days-_PreProd-HIWSEALPP02.PNG
CPU-30_days-_PreProd-HIWSEALPP01.PNG     CPU-7_days-_PreProd-GIWSEALPP01.PNG      Memory-30_days-_PreProd-HIWSEALPP01.PNG  Memory-7_days-_PreProd-GIWSEALPP01.PNG
CPU-30_days-_PreProd-HIWSEALPP02.PNG     CPU-7_days-_PreProd-GIWSEALPP02.PNG      Memory-30_days-_PreProd-HIWSEALPP02.PNG  Memory-7_days-_PreProd-GIWSEALPP02.PNG
CPU-3_days-_PreProd-GIWSEALPP01.PNG      CPU-7_days-_PreProd-HIWSEALPP01.PNG      Memory-3_days-_PreProd-GIWSEALPP01.PNG   Memory-7_days-_PreProd-HIWSEALPP01.PNG
CPU-3_days-_PreProd-GIWSEALPP02.PNG      CPU-7_days-_PreProd-HIWSEALPP02.PNG      Memory-3_days-_PreProd-GIWSEALPP02.PNG   Memory-7_days-_PreProd-HIWSEALPP02.PNG{noformat}

Pre prod support files.


{noformat}GIWSEALPP01
isva_10.0.5.0_20230605-092539_GIWSEALPP01.support_unpack
GIWSEALPP02
isva_10.0.5.0_20230605-094328_GIWSEALPP02.support_unpack
HIWSEALPP01
isva_10.0.5.0_20230605-094524_HIWSEALPP01.support_unpack
HIWSEALPP02
isva_10.0.5.0_20230605-094541_HIWSEALPP02.support_unpack{noformat}

Prod graph images(CPU and memory)

{noformat}CPU-30_days-_Prod-GIWSEALPR01.PNG     CPU-3_days-_Prod-GIWSEALPR01.PNG      CPU-7_days-_Prod-GIWSEALPR01.PNG      Memory-30_days-_Prod-HIWSEALPR01.PNG  Memory-7_days-_Prod-HIWSEALPR01.PNG
CPU-30_days-_Prod-GIWSEALPR02.PNG     CPU-3_days-_Prod-GIWSEALPR02.PNG      CPU-7_days-_Prod-GIWSEALPR02.PNG      Memory-30_days-_Prod-HIWSEALPR02.PNG  Memory-7_days-_Prod-HIWSEALPR02.PNG
CPU-30_days-_Prod-HIWSEALPR01.PNG     CPU-3_days-_Prod-HIWSEALPR01.PNG      CPU-7_days-_Prod-HIWSEALPR01.PNG      Memory-3_days-_Prod-HIWSEALPR01.PNG
CPU-30_days-_Prod-HIWSEALPR02.PNG     CPU-3_days-_Prod-HIWSEALPR02.PNG      CPU-7_days-_Prod-HIWSEALPR02.PNG      Memory-3_days-_Prod-HIWSEALPR02.PNG

{noformat}

Prod support files

{noformat}GIWSEALPR01
isva_10.0.5.0_20230605-095709_GIWSEALPR01.support_unpack
GIWSEALPR02
isva_10.0.5.0_20230605-095652_GIWSEALPR02.support_unpack
HIWSEALPR01
isva_10.0.5.0_20230605-095636_HIWSEALPR01.support_unpack
HIWSEALPR02
isva_10.0.5.0_20230605-095625_HIWSEALPR02.support_unpack{noformat}


Will ask customer to provide the support files as you mentioned.","12/Jun/23 1:07 PM;605c0c04b18de50071046740;[~accountid:5b232b2fd85e5b59b066f57f] ,

Customer has uploaded support files as requested earlier which is '_support file after restart and once everything should have started up and stablised, then one at the 3 day mark (assuming no restarts in between)'_.


We can see considerable increase in memory growth of java runtime process.Attaching the snippet from top_memory.log for each system.

*GIWSEALPP01*

isva_10.0.5.0_20230608-090302_GIWSEALPP01.support_unpack
Thu Jun  8 09:05:00 +03 2023

* {noformat}/usr/bin/top -b -n1 -m
Mem total:8146692 anon:1342284 map:200084 free:4768584
slab:179912 buf:39588 cache:1728796 dirty:8288 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1668 3970m 2499m  787m 76680  705m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1256 3818m  724m  505m 71088  412m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2098 1588m  291m  106m 37644 63244     0   124 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
1034 1216m  122m 37164 27208  8864     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
2041  995m  181m 47424 29376 17784     0   132 /opt/PolicyDirector/bin/pdmgrd -foreground
958  810m  115m 16944 10980  7136  2124   132 /usr/sbin/wga_clustermgrd
2157  773m  100m 43136 27904 14740     0   132 wga_notifications -foreground
706  696m 87348 14168  8532  4624   836   132 /usr/sbin/mesa_eventsd -m 1000
2090  414m 55888 14512  7680  6796     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground

{noformat}

isva_10.0.5.0_20230611-115622_GIWSEALPP01.support_unpack
Sun Jun 11 11:58:16 +03 2023

* {noformat}/usr/bin/top -b -n1 -m
Mem total:8146692 anon:1950980 map:183596 free:3500580
slab:222264 buf:173240 cache:2196132 dirty:8112 write:0
Swap total:2057212 free:2043900
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1668 3978m 2509m  854m 69240  784m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1256 3908m 1233m 1016m 63700  933m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2098 1588m  292m  107m 37688 64312     0   124 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
1034 1216m  122m 37544 27204  9252     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
2041 1059m  182m 49040 29396 19400     0   132 /opt/PolicyDirector/bin/pdmgrd -foreground
2157  920m  112m 48376 28536 19288     0   132 wga_notifications -foreground
958  810m  115m 15420  9420  5612   564   132 /usr/sbin/wga_clustermgrd
706  696m 87348 13280  8048  4160   368   132 /usr/sbin/mesa_eventsd -m 1000
2090  414m 55888 12752  7688  5036     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground{noformat}

#############

*GIWSEALPP02*

isva_10.0.5.0_20230608-090452_GIWSEALPP02.support_unpack
Thu Jun  8 09:05:49 +03 2023

* {noformat}/usr/bin/top -b -n1 -m
Mem total:8146692 anon:1391980 map:193620 free:4947340
slab:171280 buf:38568 cache:1524176 dirty:7896 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1766 3960m 2496m  782m 76520  700m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1348 3803m  683m  484m 70736  391m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2108 1587m  289m  102m 34348 59352     0   128 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2163  773m 98.8m 39976 27684 11684     0   132 wga_notifications -foreground
706  696m 86648 13672  8452  4252   836   132 /usr/sbin/mesa_eventsd -m 1000
1130  641m  120m 37152 26952  9040     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
2071  620m  240m  130m  5092  120m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
909  594m 93228 16804 11480  7044  2124   132 /usr/sbin/wga_clustermgrd
2100  414m 55880 14476  7688  6776     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground{noformat}

isva_10.0.5.0_20230611-121834_GIWSEALPP02.support_unpack
Sun Jun 11 12:19:28 +03 2023

* {noformat}/usr/bin/top -b -n1 -m
Mem total:8146692 anon:2019068 map:174228 free:1767792
slab:199884 buf:165120 cache:3904864 dirty:7280 write:0
Swap total:2057212 free:2052860
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1766 3969m 2507m  852m 68556  783m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1348 3855m 1214m  991m 62760  913m     0   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2108 1588m  291m  106m 34396 63260     0   128 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2163  920m  110m 43872 28004 14920     0   132 wga_notifications -foreground
1130  705m  121m 37832 26976  9708     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
706  696m 86648 13196  7944  3796   368   132 /usr/sbin/mesa_eventsd -m 1000
2071  620m  240m  131m  6336  121m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
909  594m 93228 15252  9920  5492   564   132 /usr/sbin/wga_clustermgrd
2100  414m 55880 14500  7688  6800     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground

{noformat}

#############

*HIWSEALPP01*

isva_10.0.5.0_20230608-090619_HIWSEALPP01.support_unpack
Thu Jun  8 09:07:57 +03 2023

* {noformat}/usr/bin/top -b -n1 -m
Mem total:8146692 anon:1375700 map:191788 free:4970984
slab:177792 buf:37644 cache:1507088 dirty:8768 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1700 3971m 2498m  762m 76328  681m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1252 3818m  689m  491m 70728  398m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
1991 1588m  289m  102m 34444 59068     0   132 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2340  775m 99.6m 41968 27992 13336     0   132 wga_notifications -foreground
1188  705m  121m 37768 27316  9324     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
794  696m 87820 14444  8744  4768   832   132 /usr/sbin/mesa_eventsd -m 1000
1955  620m  240m  130m  5332  120m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
1005  530m 93100 14576 11380  4992  2120   132 /usr/sbin/wga_clustermgrd
1983  414m 55880 14456  7680  6776     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground{noformat}

isva_10.0.5.0_20230611-115352_HIWSEALPP01.support_unpack
Sun Jun 11 11:55:30 +03 2023

* {noformat}/usr/bin/top -b -n1 -m
Mem total:8146692 anon:2023920 map:178136 free:1304204
slab:200252 buf:137116 cache:4386380 dirty:8508 write:0
Swap total:2057212 free:2055676
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
1700 3980m 2509m  853m 70484  775m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1252 3861m 1216m 1008m 64988  928m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
1991 1588m  291m  106m 34492 63248     0   132 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2340  920m  112m 46864 28532 17676     0   132 wga_notifications -foreground
1188  705m  121m 38156 27276  9712     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
794  696m 87820 13968  8232  4312   364   132 /usr/sbin/mesa_eventsd -m 1000
1955  620m  240m  130m  6444  120m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
1005  530m 93100 14596 11392  5012  2120   132 /usr/sbin/wga_clustermgrd
1983  414m 55880 14456  7680  6776     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground

{noformat}

#############

*HIWSEALPP02*

isva_10.0.5.0_20230608-095942_HIWSEALPP02.support_unpack
Thu Jun  8 10:00:14 +03 2023

* {noformat}/usr/bin/top -b -n1 -m
Mem total:8146684 anon:1418448 map:195680 free:4903584
slab:176476 buf:40752 cache:1518704 dirty:10368 write:0
Swap total:2057212 free:2057212
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
2251 3974m 2505m  796m 76316  714m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1615 3819m  691m  494m 70532  401m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2540 1588m  290m  107m 34536 64196     0   128 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2582  773m  100m 43720 27800 15312     0   132 wga_notifications -foreground
794  696m 87232 14080  8768  4388   836   132 /usr/sbin/mesa_eventsd -m 1000
2504  620m  240m  134m  6536  124m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
1461  576m  119m 35980 27240  7548     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
1004  466m 92936 14588 11476  4984  2120   132 /usr/sbin/wga_clustermgrd
2532  414m 55880 14580  7804  6776     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground{noformat}

isva_10.0.5.0_20230611-115406_HIWSEALPP02.support_unpack
Sun Jun 11 11:54:36 +03 2023

* {noformat}/usr/bin/top -b -n1 -m
Mem total:8146684 anon:2009948 map:174596 free:1423920
slab:195756 buf:138172 cache:4283952 dirty:12584 write:0
Swap total:2057212 free:2051324
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
2251 3981m 2512m  856m 68840  784m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
1615 3858m 1210m  988m 63104  911m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.
2540 1588m  291m  108m 34528 65300     0   128 /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground -noenv
2582  920m  112m 45212 28468 16112     0   132 wga_notifications -foreground
794  696m 87232 13600  8324  3928   368   132 /usr/sbin/mesa_eventsd -m 1000
1461  640m  119m 36652 27260  8196     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
2504  620m  240m  134m  6536  124m     0   132 /usr/sbin/slapd -d 0 -s 0 -h ldap://127.0.0.1:390 -f /etc/openldap/slapd-replica.conf -u ldap -g ldap
1004  466m 92936 13040  9916  3436   560   132 /usr/sbin/wga_clustermgrd
2532  414m 55880 14588  7804  6784     0   132 wga_watchdogd wrp-watchdog-wga -log_entry file path=/var/pdweb/wga/log/msg__webseald-wga.log,hi_water=1,flush_interval=1 -cfg /var/pdweb/wga/etc/webseald-wga.conf /opt/pdweb/bin/webseald -config etc/webseald-wga.conf -foreground{noformat}

#############

CPU and memory graph collected on 2023-06-08

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-08%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-08%2F]

Node1:GIWSEALPP01

Node2:GIWSEALPP02

Node3:HIWSEALPP01

Node4:HIWSEALPP02

{noformat}Node1-CPU.PNG  Node2-CPU.PNG  Node3-CPU.PNG  Node4-CPU.PNG

Node1-memory.PNG  Node2-memory.PNG  Node3-memory.PNG  Node4-memory.PNG{noformat}


CPU and memory graph collected on 2023-06-11

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-11%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-11%2F]

{noformat}GIWSEALPP01-CPU-3days.PNG  GIWSEALPP02-CPU-3days.PNG  HIWSEALPP01-CPU-3days.PNG  HIWSEALPP02-CPU-3days.PNG

GIWSEALPP01-Memory-3days.PNG  GIWSEALPP02-Memory-3days.PNG  HIWSEALPP01-Memory-3days.PNG  HIWSEALPP02-Memory-3days.PNG{noformat}


Support data after restart 
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-08%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-08%2F]

Support data after 3days.
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-11%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-11%2F]


also customer’s response on crypto operations

====

Neither crypto operation nor JWT operations have been used

====","12/Jun/23 1:59 PM;5b232b2fd85e5b59b066f57f;[~accountid:605c0c04b18de50071046740] - thanks. 

The data from your last post looks like it is all from pre-prod environments (i.e. “pp” in appliance name) - is this correct? What is the analysis of production support files? Do we see the same growth there after 3 days? ","12/Jun/23 2:05 PM;605c0c04b18de50071046740;[~accountid:5b232b2fd85e5b59b066f57f] ,
The support files are from PP environment.I will check with customer on Production environment.
But since we have support files from PP,wouldn't that be enough.
earlier they had mentioned they face issue in both Prod and PP environment.","13/Jun/23 10:49 AM;5b232b2fd85e5b59b066f57f;[~accountid:605c0c04b18de50071046740] - I didn’t see any growth in the original data from the production environment. If this is still the case, we can then use that to potentially isolate the difference which may be causing the issue in pre-prod. ","19/Jun/23 1:00 PM;605c0c04b18de50071046740;[~accountid:5b232b2fd85e5b59b066f57f] ,
customer has uploaded latest graph from one of their Prod system.They do observe the memory growth but not as rapidly as what they observe for their Preprod environment.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-17%2F&filepath=TS013082124%2F2023-06-17%2FISAM_PROD-Mem_Graph_slowly_increase.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-17%2F&filepath=TS013082124%2F2023-06-17%2FISAM_PROD-Mem_Graph_slowly_increase.PNG]


Let me know if any further information is required.
","20/Jun/23 12:13 PM;605c0c04b18de50071046740;[~accountid:5b232b2fd85e5b59b066f57f] ,

Could you please update.",21/Jun/23 2:25 PM;5b232b2fd85e5b59b066f57f;[~accountid:605c0c04b18de50071046740] - do we have support files capturing the period of growth in the prod environment? ,"21/Jun/23 3:49 PM;605c0c04b18de50071046740;[~accountid:5b232b2fd85e5b59b066f57f] ,
here is customer update.

========
As we mentioned before, restart on production it is require long process for raising CR and getting approval for this activity. we have the same pattern on preprod and we can restart whenever needed.

kindly let's focus on preprod, we uploaded preprod support files before and after restart.

we uploaded another set from preprod for today.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-19%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013082124&path=TS013082124%2F2023-06-19%2F]

======

Customer wants to  focus on the Preprod env first as we have the support files from Pre prod as requested earlier.?",22/Jun/23 2:24 PM;5b232b2fd85e5b59b066f57f;There is a recently discovered memory issue in the version of Java which ships with 10.0.5. A fix-pack is available here → [https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|smart-link] . Have the customer try this in their non-production environment and see if there is any improvement. ,"22/Jun/23 2:28 PM;605c0c04b18de50071046740;[~accountid:5b232b2fd85e5b59b066f57f] ,

Customer is on 10.0.5.0 IF1. Will this fix work on IF1 ?",22/Jun/23 2:29 PM;5b232b2fd85e5b59b066f57f;yes,"22/Jun/23 2:30 PM;605c0c04b18de50071046740;thanks.
Will share the fix with customer.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Advanced Tuning Parameter 'wga_rte.embedded.ldap.include.in.snapshot' does not include embedded LDAP data when set to 'true',ISAMSUP-5064,299019,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,11/May/23 9:33 AM,13/May/23 4:53 AM,14/Jul/23 2:47 PM,13/May/23 4:53 AM,,Support,,0,,,,"The bilt-in Advanced Tuning Parameter 'wga_rte.embedded.ldap.include.in.snapshot' does not successfully create a compressed archive of the embedded LDAP when it is set to 'true' and a snapshot is created.

The resultant zip file is a 7kb empty compressed archive that is not sufficient to rebuild the embedded LDAP.

This causes IBM Support to have to perform a best-effort rebuild of the environment which includes using 'pdadmin local> config show' to get numerous passwords, recreating Reverse Proxy instances, and reverse engineering the secUUIDs for built in users, groups, and security daemons to prevent ACLs and other policies from being unusable.

This also caused an additional 7 hour delay in return to service for the Allstate team when they had to restore their Agency development environment.",,David Hayes,jcyarbor,khansen,Nick Lloyd,Rachel Tomas,tonyferg,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,70121:0ba4f8fa-8042-4ac9-914a-4a02dabc3187,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5065,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012987961,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,Allstate Insurance Company,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bdzz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.2,ISVA 10.0.3.1,ISVA 10.0.5.0,,,,,,,,,,,2023-05-11 02:37:43.106,,,,,"11/May/23 9:39 AM;5bac25aaabfcbf73d13e733b;Steps to reproduce:

# Create appliance at 10.0.5.0
# Activate Base module
# Configure policy server
# Update Advanced Tuning Parameter ‘wga_rte.embedded.ldap.include.in.snapshot’ to ‘true’
# Create snapshot
## Download snapshot and try to uncompress the openldap.zip
# Unconfigure the runtime component
# Configure the runtime component
# Apply snapshot from step 5
# Try to restart the runtime component and log into Policy Administration
## Policy Administration will receive an ‘Authentication mechanism is unavailable’
## msg__pdmgrd_utf8.log will show an 0x31 error","11/May/23 9:40 AM;5bac25aaabfcbf73d13e733b;This caused a 7 hour outage (including recovery) for Allstate’s development teams in their Agency environment and caused L2 to have to perform out of scope work to recover their LDAP data. Not recovering that data would have been an unacceptable customer service experience and would have probably made Allstate never consider ISV* again. The issue reached upper management, passed the 2nd line of the Allstate Administrative team.","11/May/23 12:37 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] can you please run with this one and confirm Jacks findings. I spoke with [~accountid:5b15d9517dab4c51f61b5190] about this and he advised the following - 

“The tuning parameter to enable LDAP data in snapshot is working to put it in but is not restoring it on applying the snapshot. . The file he is talking about being empty is actually encrypted - so need to do his recreate steps. not sure if its really empty as stated”

Appreciate your support in regards to this one. 

[~accountid:5b232b2fd85e5b59b066f57f] FYI.","11/May/23 12:44 PM;5bac25aaabfcbf73d13e733b;To be clear, the reason I thought it was empty is because the file is a .zip file but you cannot decompress it using zip utilities.

If it’s simply encrypted that’s fine. 

We still need to understand why it’s not restoring as expected.","11/May/23 3:09 PM;5bac25aaabfcbf73d13e733b;So, very strange, but the snapshot restored the LDAP data on a different appliance when Allstate took the appliance ‘VAP1025’ removed it from the cluster, literally re-racked it as it was a HW appliance, changed the mgmt IP, hostname, and recreated a standalone cluster.

Granted that was the same thing we did with the original appliance but this time the embedded LDAP data took.

So, not sure if that was a fluke or not but it did work, thankfully. I still think this needs to be investigated as my recreate steps can be used to easily recreate the problem.",12/May/23 6:37 AM;5b15d9e581c3df12acf53c4a;Will investigate…..,"13/May/23 2:34 AM;5b15d9e581c3df12acf53c4a;I happened to have a ready  10.0.3.1 ( I know the issue is on 10.0.5.0 ) where I created a snapshot and I see the following after unzipping the snapshot file:



….

go-> ls -l snapshot10031/ldap
total 72
-rw-rw-r--@ 1 mrahman  staff  29937 May 12 11:24 1.ldif
-rw-rw-r--@ 1 mrahman  staff    355 May 12 11:24 2.ldif

……….

……….

.

Here is from code where snapshot of embedded ldap is done:

{noformat}/*
 * Ensure that the snapshot contains the local LDAP data. The embedded LDAP
 * data will only be included (in non-docker environments) if the tuning
 * parameter wga_rte.embedded.ldap.include.in.snapshot is set.
 * In the extracted snapshot, this corresponds to a directory at the root
 * level named 'ldap' which contains a set of .ldif files.
 */{noformat}



……………………………………….

I know that I did the test in 10.0.3.1 but as far as I see, code is same in 10.0.3.1 and 10.0.5.0

Do you not see that same thing? 

I am not sure what openldap.zip is doing here, but looking at the code, seems like all the stuff is being stored in ./ldap directory as indicated in the comment above.

If you look at your snapshot, is there stuff in ./ldap  good?

I will look more into the existence of openldap.zip file and it’s reason….","13/May/23 2:57 AM;5b15d9e581c3df12acf53c4a;OK, openldap.zip contains data in /etc/openldap/dynamic directory only.

* The following function is called whenever a new snapshot is created.  It
* will be used to create an encrypted backup of the /etc/openldap/dynamic
* directory.  We need to include an encrypted version of this directory as
* some of the files contain clear text passwords.  It will also be
* optionally used to snapshot the user registry data.","13/May/23 4:32 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d9e581c3df12acf53c4a] ,

Allstate had the issue at 10.0.3.1. I used both 10.0.3.1 as well as 10.0.5.0 in my environment to recreate.

Let me review the customer’s uploaded snapshot and see if I can’t find the data in question.

Thanks for the clarification on the ‘openldap.zip’ as I misinterpreted that as the actual compressed LDAP data.","13/May/23 4:38 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d9e581c3df12acf53c4a] ,

I think we can resolve this JIRA.

The ATP works as expected.

I validated that the customer’s snapshot just did not have the LDAP data in it as there was not an ‘snapshot/ldap’ directory.

I checked in my environment and there is a ‘ldap’ directory with the LDIF files.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
httpClientV2 sending incorrect headers,ISAMSUP-5061,298912,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,10/May/23 11:05 PM,26/Jun/23 2:14 PM,14/Jul/23 2:47 PM,,,Support,12/May/23 12:00 AM,0,,,,"The client has an infoMap that makes multiple calls to httpClientV2.  The client found that “cached” headers are being sent by httpClientV2, even though a new header object is being created. 

We have recreated the issue in L2 and will provide more information in a subsequent update.  

The basic flow is: 

Call 1
1) Define a new header object
2) Add a header using addHeader (say header1) 
3) Make an httpClientV2 call

Call 2
4) Define a new header object
5) Add a header using addHeader (say header2) 
6) Make an httpClientV2 call

Go back to Call 1

The issue starts here.  Even though a new header object is defined in Call1 - Step 1, the httpClientV2 call is sending the header that was defined in Call2 - Step 5.

Tracing in the infomap shows that the “header” object sent to the call is correct.   It only contains the one header that is added (header1).  

Somehow, the httpClientV2 code is sending header1 and header2 in the call, even though header2 was not in what was sent to httpClientV2.

It seems to be getting some cached value.  

Tracing in the infomap does not show the issue.  The issue was spotted by looking at what was sent to the target server.  

[~accountid:5b15d9e6dda5f94d06b985b4] will add more information to this JIRA. ",,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,06/Jun/23 8:35 AM;gvacek;apache-logs.txt;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204040,06/Jun/23 8:37 AM;gvacek;trace.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204041,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012505830,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,FBI,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bddj:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-05-10 22:52:03.575,,,,,11/May/23 8:52 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] seems that L2 team has been able to provide clear recreate steps for this issue. Can you please complete the initial assessment of this issue and confirm if we have something to fix here. ,"11/May/23 8:07 PM;5b15d954b0d76456f36daf33;[~accountid:5c87cb8d88f9ec6ae0afb306] there are no support files (from the customer or your recreate) in this case for me to look at.

If you haven’t already, are you able to turn on this trace spec on the runtime profile and recreate the problem. That should show what we received at the httpClient.

{noformat}com.ibm.security.access.httpclient.*=ALL{noformat}

Also, is the problem with all operations or one or more of GET / POST / PUT / PATCH?","12/May/23 10:43 PM;5b15d9e6dda5f94d06b985b4;L2’s recreate lab:
LMI: [https://9.30.219.58:9445/wga/reverseproxy|https://isva1040lmi.kvm.org:9445/wga/reverseproxy] (admin/admin) You are welcome to set traces as needed.
WRP: [https://9.30.219.58:4432/dashboard/AAC/InfomapDebugger.html|https://isva1040wrp.kvm.org:4432/dashboard/AAC/InfomapDebugger.html] (iuser / bighulk99) This will fire the Info Map which calls HttpClientV2().  You will see a “moveon” button.  Press to complete the Info Map.

The mapping rule is named InfomapDebugger.  You are welcome to add trace as needed.  The code in question is:


{noformat}function getDateAndTime(username, password) {
    trace(""INFOMAPDEBUGGER:"", ""ENTERING getDateAndTime"");

    var serverFactory = new ServerConnectionFactory();
    var webService = serverFactory.getWebConnectionByName(DateAndTime_CONNECTION_NAME);
    var wsUrl      = webService.getUrl();
    var wsKeystore = webService.getKeystore();
    var wsUser     = webService.getUser();
    var wsPasswd   = webService.getPasswd();
    var isSsl      = webService.isSsl();
 
    trace(""INFOMAPDEBUGGER:"", "" url      = "" + wsUrl);
    trace(""INFOMAPDEBUGGER:"", "" keystore = "" + wsKeystore);
    trace(""INFOMAPDEBUGGER:"", "" user     = "" + wsUser);
    trace(""INFOMAPDEBUGGER:"", "" passwd   = "" + wsPasswd);
    if (isSsl) trace(""INFOMAPDEBUGGER:"", "" SSL      = YES"");
    if (!isSsl) trace(""INFOMAPDEBUGGER:"", "" SSL     = NO"");

    //var response = HttpClient.httpGet(wsUrl);
    var headers  = new Headers();
    trace(""INFOMAPDEBUGGER:"", ""NEW HEADERS ONE = "" + headers);
    var new_headers_dummy = headers.getHeaders();
    trace(""INFOMAPDEBUGGER:"", ""NEW HEADERS DUMMY ONE = "" + new_headers_dummy);

    addHeader(headers, ""Accept"", ""application/json"");
    //headers.addHeader(""Accept"",       ""application/json"");
    var dummy = headers.getHeaders();
    trace(""INFOMAPDEBUGGER:"", ""headers = "" + dummy);

    //var response = HttpClient.httpGet(wsUrl, headers, ""webService"", wsUser, wsPasswd, wsKeystore, null, ""TLSv1.2"");
    var first = wsUrl+""?attempt=1"";
    var response = HttpClientV2.httpGet(first, headers, ""webService"", wsUser, wsPasswd, wsKeystore, null, ""TLSv1.2"");
    //var data     = JSON.parse(response.getBody());
    //trace(""INFOMAPDEBUGGER:"", "" JSON response ["" + JSON.stringify(data) + ""]"");
    var retHeaders = response.getHeaders();
    var jsession = retHeaders.get('set-cookie');
    if (jsession == null) {
       rc = false;
       return;
    }

    // Adding var NSL
    var headers = new Headers();
    trace(""INFOMAPDEBUGGER:"", ""NEW HEADERS TWO = "" + headers);
    var new_headers_dummy_two = headers.getHeaders();
    trace(""INFOMAPDEBUGGER:"", ""NEW HEADERS DUMMY TWO = "" + new_headers_dummy_two);
    addHeader(headers, ""Cookie"", jsession);
    //headers.addHeader('Cookie:', jsession);

    var second = wsUrl+""?attempt=2"";
    var response = HttpClientV2.httpGet(second, headers, ""webService"", wsUser, wsPasswd, wsKeystore, null, ""TLSv1.2"");
    trace(""INFOMAPDEBUGGER:"", ""EXITING getDateAndTime"");
}{noformat}



Each call to “var headers = new Headers();” does create a new object.  You will see as we dump out the headers the trace indicates the correct works correctly.  What is actually sent out the wire though is not the same.

We have not tested for POST/PUT/PATCH.","06/Jun/23 9:00 AM;5c87cb8d88f9ec6ae0afb306;[~accountid:5b15d954b0d76456f36daf33] 
I captured traces that included {{com.ibm.security.access.httpclient.*=ALL}}.  It really didn’t show much, but it may be helpful.  I have attached the trace.log file. 

I have also attached a file called apache-logs.txt.  This file has snippets from some logging that Nick enabled on his Apache server.  The HTTP_<name> entries are the headers that are sent to the server. 

We are setting the “Accept” header in the initial “var headers = new Headers();” variable.  This is used for the first http call in the infomap.

We are setting the “Cookie” header in the second “var headers = new Headers();” variable.  This is used for the second http call in the infomap.  

We are not seeing any issues related to the Accept header.  

The infomap does two calls and I invoked the infomap twice.  

First Call - attempt 1. (All Good!) 
    No Cookie value set
    No Cookie value received  

First Call - attempt 2 
     Cookie value set to JSESSIONID=1234567
     Cookie value received incorrectly doubled to JSESSIONID=1234567,JSESSIONID=1234567

Second Call - Attempt 1
      No Cookie value set
      Cookie value received incorrectly as JSESSIONID=1234567.  

Second Call - Attempt 2 
      Cookie value set to JSESSIONID=1234567
     Cookie value received incorrectly doubled to JSESSIONID=1234567,JSESSIONID=1234567

 

In looking at the trace.log, the headers being sent to httpclient look good.  The issue doesn’t seem to be with what is being sent to the httpclient, but with what it is sending to the target server.   For some reason, that header set in the second “var headers = new Headers();” is incorrect.  

In my mind, it’s like it’s bleading over into the other variable and both variables are being used.   
",06/Jun/23 10:16 AM;5b15d954b0d76456f36daf33;Thanks [~accountid:5c87cb8d88f9ec6ae0afb306] I’ll go over the information and see what I can find.,"26/Jun/23 2:14 PM;5b15d954b0d76456f36daf33;[~accountid:5c87cb8d88f9ec6ae0afb306] like you said there isn’t much in the trace to show any root cause.

I’m going to have to debug this further either by creating a diagnostic fixpack or modifying the jars directly. Will let you know what I find.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Error in Logs: DPWNS0165E The certificate revocation check result was undetermined... ,ISAMSUP-5054,298628,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,10/May/23 2:48 AM,13/Jun/23 12:05 PM,14/Jul/23 2:47 PM,13/Jun/23 12:05 PM,,Support,10/May/23 12:00 AM,0,escalated,,,"The client is seeing the following errors: 

2023-05-03-17:43:19.793+01:00I----- 0x38B9A0A5 webseald ERROR wns general WsSslListener.cpp 1772 0x7f4c42db7700 -- DPWNS0165E   The certificate revocation check result was und
etermined. The subject issuer is '[Class=]GSKVALMethod::X509[Issuer=]CN=RSAGroupProdExtSubCA,OU=Company,O=Directory[#=]680000003e2a9a7b340878168400000000003e[Subject=]CN=CCSEX
T00295,OU=Company,O=Directory'.

2023-05-03-17:46:17.668+01:00I----- 0x38B9A0A5 webseald ERROR wns general WsSslListener.cpp 1772 0x7f4c43208700 -- DPWNS0165E   The certificate revocation check result was und
etermined. The subject issuer is '[Class=]GSKVALMethod::X509[Issuer=]CN=RSAGroupProdExtSubCA,OU=Company,O=Directory[#=]680000003dd63e3e887159a96d00000000003d[Subject=]CN=CCSEX
T00293,OU=Company,O=Directory'.

These are the two client certificates that he uses in his production environment. 

Upon review of the PCAP file, we find that we are doing a search with the following base object: 
baseObject: [LWUKLVPE02.uk.rsa-ins.com|https://LWUKLVPE02.uk.rsa-ins.com]:3890/cn=RSAGroupProdExtSubCAou=Companyo=Directory

This results in an invalidDNsyntax error from LDAP.

NOTE:  The commas between cn=,ou=,o= are missing.  

We thought that this might be because the initial CRL: 


{noformat}searchRequest

baseObject: CN=RSAGroupProdExtRootCA,OU=Company,O=Directory

scope: baseObject (0)

derefAliases: neverDerefAliases (0)

sizeLimit: 0

timeLimit: 0

typesOnly: False

Filter: (|(|(|(authorityRevocationList;binary=*)(authorityRevocationList=*))(certificateRevocationList;binary=*))(certificateRevocationList=*))

attributes: 4 items{noformat}



Returned the following: 

{{01b0 81 81 30 7f 30 7d a0 7b a0 79 86 77 6c 64 61 70 ..0.0}.{.y.wldap 01c0 3a 2f 2f 2f 4c 57 55 4b 4c 56 50 45 30 32 2e 75 :///LWUKLVPE02.u 01d0 6b 2e 72 73 61 2d 69 6e 73 2e 63 6f 6d 3a 33 38 k.rsa-ins.com:38 01e0 39 30 2f 63 6e 3d 52 53 41 47 72 6f 75 70 50 72 90/cn=RSAGroupPr 01f0 6f 64 45 78 74 52 6f 6f 74 43 41 2c 6f 75 3d 43 odExtRootCA,ou=C 0200 6f 6d 70 61 6e 79 2c 6f 3d 44 69 72 65 63 74 6f ompany,o=Directo 0210 72 79 3f 63 65 72 74 69 66 69 63 61 74 65 72 65 ry?certificatere}}

NOTE: ldap:*///*[LWUKLVPE02.uk.rsa-ins.com:3890|http://LWUKLVPE02.uk.rsa-ins.com:3890]

But, this is all working fine in the pre-prod environment, so that doesn’t seem to be the issue.  

I will provide more information / analysis in the next update. ",,BRIANORO,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,tonyferg,,,,,,,,,6154906364ff01007106e189,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,10/May/23 3:00 AM;gvacek;Screenshot 2023-05-09 at 11.27.34 AM.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200063,10/May/23 3:00 AM;gvacek;Screenshot 2023-05-09 at 11.52.13 AM.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200064,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012923790,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,Celerity Limited,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"/ecurep/sf/TS012/923/TS012923790/2023-05-04/isva_10.0.2.0_20230504-100948_LWUKLVPC15.support_unpack

/ecurep/sf/TS012/923/TS012923790/2023-05-04/trace01.pcap

*** The following is for the pre-prod environment that is working:  ***
/ecurep/sf/TS012/923/TS012923790/2023-05-09/trace01_PREPROD.pcap

/ecurep/sf/TS012/923/TS012923790/2023-05-09/isva_10.0.2.0_20230509-163938_LWUKAPRE01.support_unpack",,,,,,,,,,,,,,,,,,,,,,,0|i1bbn3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-05-10 16:25:21.3,,,,,"10/May/23 3:00 AM;5c87cb8d88f9ec6ae0afb306;For the /ecurep/sf/TS012/923/TS012923790/2023-05-04/trace01.pcap file, the issue can be seen using the following filter: 
{{ip.addr==10.119.38.101 && tcp.port==3890}}

!Screenshot 2023-05-09 at 11.52.13 AM.png|width=1381,height=153!

I had the client send a pcap for the working case.  It also returns a value with an ldap:/// entry.  The “weird” thing to me is that for the working case, there isn’t a second searchRequest that is being done.  So, there is no error in the pre-prod environment. 

For the /ecurep/sf/TS012/923/TS012923790/2023-05-09/trace01_PREPROD.pcap file, the working search can be seen using the following filter: 
{{ip.addr==10.119.144.86  && tcp.port==7135}}

!Screenshot 2023-05-09 at 11.27.34 AM.png|width=1495,height=235!


I’ve compared the two configs and cannot see anything different that would explain this issue.  

For certain, we are sending a search with an incorrectly formatted DN: 
baseObject: [LWUKLVPE02.uk.rsa-ins.com|https://LWUKLVPE02.uk.rsa-ins.com]:3890/cn=RSAGroupProdExtSubCAou=Companyo=Directory","10/May/23 3:42 AM;5c87cb8d88f9ec6ae0afb306;Confirmed that /// is valid: 
""...

{noformat}LDAP URL referring to the University
   of Michigan entry, available from an LDAP server of the client's
   choosing:

     ldap:///o=University%20of%20Michigan,c=US{noformat}

""
[https://www.rfc-editor.org/rfc/rfc2255|https://www.rfc-editor.org/rfc/rfc2255|smart-link] ","11/May/23 2:25 AM;5b15d9e581c3df12acf53c4a;Before I jump deep into the details of the logs/traces, can you please give answer to the following which might lead me to correct path:

Now, for various reason, an application can , sometimes justifiably, may not be able to determine the revocation status of a Certificate, without getting into why an application can not determine the CRL status, we know that WebSEAL dealt with it before and for that reason, we have have a config option about how to deal with it:



If, after OCSP or CRL checking, the revocation status of a browser supplied

certificate is undetermined, WebSEAL can be configured to ignore this, log

the fact, or log the fact and reject the connection by setting

undetermined-revocation-cert-action to ""ignore"", ""log"" or ""reject""

respectively.

*_undetermined-revocation-cert-action = log_*

The following configuration item is used to control whether SSL errors

originating from a connection with a client are logged.

suppress-client-ssl-errors = false



========================================

Did you guys check or think about these options or the issue is more than just a failure to check CRL but there is a deeper issue here?","11/May/23 2:32 AM;5b15d9e6dda5f94d06b985b4;Yes, we thought about these options.  The CRL is returned.  Note the contents from the pcap the CRL contains:

ldaps:///[LWUKLVPE02.uk.rsa-ins.com|https://lwuklvpe02.uk.rsa-ins.com/]:3890/cn=RSAGroupProdExtSubCA,ou=Company,o=Directory (This is correct syntax per RFC)

The code then issues a search to [LWUKLVPE02.uk.rsa-ins.com|https://lwuklvpe02.uk.rsa-ins.com/]:3890 using a base DN of,

cn=RSAGroupProdExtSubCAou=Companyo=Directory (The commas are gone).



Some parsing functions is removing the commas so WRP sends a bad base DN.","11/May/23 6:29 AM;5b15d9e581c3df12acf53c4a;Their certificates were not part of the support file.

If they are not willing share that then can they share the details of the certificates?

I am assuming there must be some information, specially regarding crl stuff could be wrong?

Even in the same failing scenarios, some searches are working.

Knowing some history around the context will also help. 

Were these certificates are new? always worked in similar configuration or is it because right after some update that they are seeing this  issue?","11/May/23 6:52 AM;5c87cb8d88f9ec6ae0afb306;Hi Motiur, 

Why do you think this has something to do with the certificates themselves?  The CRL information is coming from what is in LDAP and not from the certificate.   

The simplistic view of this case is: 
1) We do an LDAP search to get the CRL list from LDAP (As configured in the proxy config) 
2) LDAP returns a result with a CRL list
3) We INCORRECTLY build a follow-up search that causes an error (in WebSEAL and LDAP), ending the CRL flow.    The baseDN is incorrectly formatted. 

It’s 3) that is causing the issue.  Can we focus on that part of the issue?  Figuring out why we get data from LDAP and build a corrupted follow-up search?  Why are the commas missing?  What is the code trying to do?  

All of the data is in the PCAP.  And, if you want to see the CERTS, they are shown in the PCAP and the GSKIT trace. 

My thought is: 
1) There is a parser issue in the code
OR
2) For some reason, we are doing a second search when we are not supposed to.  

The history is 
1) They got this working in pre-prod
2) They followed the same steps in prod, but are seeing this issue.

I reviewed the data returned from LDAP in the working (pre-prod) and non-working (prod) environments.  I could not see anything that let me know why we are doing the second search. 

I’m hoping that the actual code can provide some more clues.  ","12/May/23 12:18 AM;60f541a6d0134900692d91b7;Hi, [~accountid:5b15d9e581c3df12acf53c4a] The customer is looking for any suggestion or workaround, please let me know ??","12/May/23 1:36 AM;5b15d9e581c3df12acf53c4a;yea, the very fact that in pre-prod it is working lead me to believe that issue is not in the ISVA code, rather in configuration or in certificates itself. Code base is same for both pre-prod and prod? right? they are not using different version of ISVA or anything?

In any case, the reason for me to gather as much information as possible is for the fact that WebSEAL code does not directly deals with CRL or any such certificate processing,  WebSEAL simply calls GSKit and GSKit handles all these certificates related issues, after doing all our due diligence, we normally engage GSKit L3 but before we go to GSKit , we need to have all the possible informations that we can.

Certificates, via extension, do contains some information, I am not sure all these information do shows up in pcap or traces or not.

If Customer is not willing to share theirs certs, or refusing, let me know,  so I can convey that information when GSKit ask?","12/May/23 2:01 AM;5c87cb8d88f9ec6ae0afb306;Okay.  We’ll request the certificates. 
","12/May/23 2:15 AM;5b15d9e581c3df12acf53c4a;Also, please , can you get one more clarification:

On Pre-Prod, where it is working…..are they using same sets of certificates where it is in failing scenario i.e. in prod?

If it is same sets of certificates and same code base i.e. ISVA, then we know that GSKit is processing it wrong…..

If sets of certificates are different in pre-prod then please do get. IP trace and GSKit trace from both environments so that we can send both sets of files to GSKit for analysis.","12/May/23 2:21 AM;5c87cb8d88f9ec6ae0afb306;We Both versions are using the same code base.  

The client certificates used in PROD are NOT the same as the client certificates used in NON-PROD.  

We can request GKIT traces from PreProd 

","12/May/23 10:27 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9e581c3df12acf53c4a] The client is requesting what traces would help identify the difference with the CRL checking between the two environments. A ldap client trace ([https://www.ibm.com/support/pages/enabling-ldap-client-trace-isam-appliance-reverse-proxy|https://www.ibm.com/support/pages/enabling-ldap-client-trace-isam-appliance-reverse-proxy]) and a routing trace ([https://www.ibm.com/support/pages/enabling-routing-trace-isam-appliance-reverse-proxy|https://www.ibm.com/support/pages/enabling-routing-trace-isam-appliance-reverse-proxy]).  But, if there is any other traces? ","13/May/23 1:46 AM;5b15d9e581c3df12acf53c4a;Currently, all indication is with GSKit,  so most important is:

IP Trace

GSKit Trace

It is good to have LDAP trace if possible but most important is IP/Network Trace and GSKit trace and access to certificates.

I noticed that Certificates, as much as I can deduce, set of certificates are different in pre-prod and prod environment.

But still for comparison and help in debugging,  similar traces from both environment will be helpful …",13/May/23 2:29 AM;5c87cb8d88f9ec6ae0afb306;Is there another ISVA component that would be good?  Like a routing trace?  ,"13/May/23 3:14 AM;5b15d9e581c3df12acf53c4a;Not really, since the issue is being dealt in gskit code ( not in our ISVA code ), so ISVA trace will be not that revealing but, of course, gskit trace will.","13/May/23 4:26 AM;5c87cb8d88f9ec6ae0afb306;While we wait for new data, could you please go ahead and engage the GSKIT L3 Team?

We have a .pcap and gskit trace already: 
/ecurep/sf/TS012/923/TS012923790/0-all_data/trace_gskit.log

/ecurep/sf/TS012/923/TS012923790/0-all_data/trace01.pcap


It looks like I can find the invalid DN in the trace: 

{noformat}
NpercentDecode00204652454400016453D2CE022C001030303030374644373039454644373030^AdS??P^[^F^A@^YNpercentDecode00204652454400016453D2CE022C001030303030374644373039454644373030^AdS??P^[^F^A@^XPconvertDCtoHost00204652454400016453D2
CE022C001030303030374644373039454644373030^AdS??P^[^F^A@^WPconvertDCtoHost00204652454400016453D2CE022C001030303030374644373039454644373030^AdS??P^[^F^A^A^V^Nldapclient.cpp^C??ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupP
rodExtSubCAou=Companyo=Directory?certificaterevocationlist;binary00204652454400016453D2CE022C001030303030374644373039454644373030^AdS??P^[^F^A@^VLsearchByURI00204652454400016453D2CE022D001030303030374644373039454644373030^AdS?{noformat}


They may be able to tell something from what we already have. ","13/May/23 6:13 AM;5b15d9e581c3df12acf53c4a;I do not want to take a chance and misinterpret gskit trace, so I sent it to GSKit L3, hope to hear something soon…..

In the mean time, I was able to get this certificate information from gskit trace:

Look at the Certificate extension including CRL information, let’s what GSKit says

================

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            68:00:00:00:3e:2a:9a:7b:34:08:78:16:84:00:00:00:00:00:3e
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: O=Directory, OU=Company, CN=RSAGroupProdExtSubCA
        Validity
            Not Before: Apr 26 09:01:57 2023 GMT
            Not After : Apr 26 09:11:57 2026 GMT
        Subject: O=Directory, OU=Company, CN=CCSEXT00295
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    00:bf:a8:95:10:19:c4:0e:18:8d:66:d5:27:3c:5f:
                    d3:6f:0e:54:6d:a7:6d:05:45:ff:86:a7:f5:53:2f:
                    d4:b1:28:22:c4:52:6e:a6:82:7a:55:1c:c7:01:79:
                    48:18:c9:39:81:72:8a:a4:bc:d5:e1:6b:d2:94:35:
                    eb:38:7c:0d:65:41:0e:d9:58:2b:3d:5a:9a:d8:99:
                    ad:75:49:08:ca:62:d5:60:0e:77:d1:aa:f4:49:7b:
                    d9:55:f0:e7:d5:5b:9c:e2:ce:57:b0:b6:7a:26:76:
                    f7:c3:43:66:71:73:92:2e:1a:c2:85:ab:26:31:2a:
                    17:28:8b:d9:b6:46:67:ec:0b:1e:d1:d8:e8:52:f6:
                    d9:cd:ef:88:ea:99:66:60:08:ff:f5:89:d8:b9:7e:
                    b5:38:b9:c9:1b:82:d0:24:7f:f1:50:49:45:ae:ed:
                    37:7f:a8:fd:f7:e7:3d:cb:98:0f:81:23:53:5d:ac:
                    14:76:42:c4:b8:f5:53:0c:af:55:b4:fb:81:55:03:
                    9b:0f:11:db:70:db:7e:a3:f2:e9:0f:fb:c3:5a:ea:
                    4b:3c:df:5c:e6:40:5f:46:2d:4a:af:d6:15:75:96:
                    cc:b5:8e:a0:6b:4d:65:18:7c:f6:35:13:2d:be:89:
                    96:46:6a:e3:b9:a0:a0:e1:04:95:87:1b:db:b3:a9:
                    d8:79
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment
            X509v3 Extended Key Usage:
                TLS Web Client Authentication
            X509v3 Subject Key Identifier:
                AA:60:1E:BE:6C:CC:C2:CF:76:DA:30:E1:09:E0:A9:1A:0E:41:D7:DF
            X509v3 Authority Key Identifier:
                keyid:2F:6A:C7:4E:BD:E7:AF:11:C6:C0:F0:3F:81:C5:C6:BF:DE:6D:84:7D

        *_X509v3 CRL Distribution Points:
        
                Full Name:
                  URI:http://LWUKWVPI249.opd.ads.uk.rsa-ins.com/CertEnroll/RSAGroupProdExtSubCA.crl
                  URI:file:////LWUKWVPI249/CRLDistributionSubCA/RSAGroupProdExtSubCA.crl
                  URI:ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCA,ou=Company,o=Directory?certificaterevocationlist;binary_*

            Authority Information Access:
                CA Issuers - URI:http://LWUKWVPI249.opd.ads.uk.rsa-ins.com/CertEnroll/LWUKWVPI249.opd.ads.uk.rsa-ins.com_RSAGroupProdExtSubCA.crt
                CA Issuers - URI:file:////LWUKWVPI249/CRLDistributionSubCA/LWUKWVPI249.opd.ads.uk.rsa-ins.com_RSAGroupProdExtSubCA.crt

            X509v3 Basic Constraints: critical
                CA:FALSE
    Signature Algorithm: sha256WithRSAEncryption
         76:d6:6e:ca:f6:24:15:cf:e0:b2:5e:46:3e:7c:61:0f:7c:0a:
         cd:4c:ef:0b:af:24:ad:51:3d:d1:cb:55:db:c9:27:9b:2d:1c:
         f9:0a:f9:b2:72:a5:19:9b:ba:2f:43:00:b6:8b:94:0e:ba:e1:
         4c:b4:85:90:5f:56:96:08:a6:e2:34:d0:03:8d:dc:94:42:2d:
         9e:ca:db:a6:0f:2b:19:cb:9e:b4:22:a6:b2:6b:93:81:81:a9:
         e2:02:56:d8:f3:6e:13:5c:1f:7e:42:a7:ce:a0:f4:ee:87:bf:
         b4:fa:a7:8e:b9:0a:ee:f0:ae:d1:fc:d5:3a:ba:69:65:67:e0:
         ee:1c:9b:32:a9:7b:03:38:af:59:49:a8:b8:86:c6:2f:9f:8a:
         d2:fc:c7:d6:ea:d3:04:90:f3:66:43:ea:8c:fb:bb:1c:5f:c8:
         b0:0f:cf:7d:73:cf:90:8a:46:18:52:d2:4a:b7:47:64:1b:12:
         93:02:32:bd:64:7b:95:29:45:8b:f9:f1:94:15:5c:2c:5a:1f:
         43:4f:ad:5a:02:f4:34:9a:a3:ea:2b:91:ee:b9:82:03:24:ad:
         ae:36:7f:b4:d8:d8:63:65:d9:8e:08:4d:b2:7a:53:ef:63:3a:
         07:84:35:be:8e:ea:6c:48:2d:79:51:cc:ac:f8:81:6e:64:c3:
         cf:fc:09:63

========================",13/May/23 6:31 AM;5c87cb8d88f9ec6ae0afb306;Thx.  I have requested pcap and gskit data from both environments.  ,"17/May/23 1:49 AM;5c87cb8d88f9ec6ae0afb306;The client provided the requested data: 


Here are the file names for your identification & reference:

*PROD*

isva_10.0.2.0_20230516-113854_LWUKLVPC15.support

trace01_prod.pcap

CCSEXT00295.pfx is the prod client certificate, the password to import this cert is Testing123



*PPD*

isva_10.0.2.0_20230516-110746_LWUKAPRE01.support

trace01_ppd.pcap

CCSEXT00003.pfx is the ppd client certificate, the password to import this cert is g56Etumisl*W7St*th&#

These are in the following ecurep dirctory: 
/ecurep/sf/TS012/923/TS012923790/2023-05-16

The ldap client and gskit traces are in the support files. 

I haven’t reviewed them yet but am doing that now. ","17/May/23 2:19 AM;5c87cb8d88f9ec6ae0afb306;Upon review of the data, the client captured what was requested.

The ldapclient trace for the failure case shows: 

{noformat}
2023-05-16T11:25:26.968821+1:00 T-1310746880 ldap_url_parse(ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCA,ou=Company,o=Directory?certificaterevocationlist;binary)
2023-05-16T11:25:26.968826+1:00 T-1310746880 ldap_url_parse_internal(ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCA,ou=Company,o=Directory?certificaterevocationlist;binary)
2023-05-16T11:25:26.968832+1:00 T-1310746880 ldap_url_parse_internal: return(SUCCESS)
2023-05-16T11:25:26.968909+1:00 T-1310746880 ldap_url_search_st: ld(0x7fca8006dbd0), url(ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCAou=Companyo=Directory?certificaterevocationlist;binary), attrsonly(0) timeout((nil)), res(0
x7fca040090d8)
2023-05-16T11:25:26.968915+1:00 T-1310746880 ldap_url_search_direct: ld(0x7fca8006dbd0), url(ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCAou=Companyo=Directory?certificaterevocationlist;binary), attrsonly(0)
2023-05-16T11:25:26.968919+1:00 T-1310746880 ldap_url_parse(ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCAou=Companyo=Directory?certificaterevocationlist;binary)
2023-05-16T11:25:26.968923+1:00 T-1310746880 ldap_url_parse_internal(ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCAou=Companyo=Directory?certificaterevocationlist;binary)
2023-05-16T11:25:26.968928+1:00 T-1310746880 ldap_url_parse_internal: return(SUCCESS){noformat}

This trace is  /ecurep/sf/TS012/923/TS012923790/2023-05-16/isva_10.0.2.0_20230516-113854_LWUKLVPC15.support_unpack/var/pdweb/CCS/log/trace__ldapclient.log 



In both the working and non-working cases, a CRL list is returned with an ldap:/// entry.  Only in the non-working case do we follow-up with a search that builds an incorrect DN.","17/May/23 4:01 AM;5b15d9e581c3df12acf53c4a;Any idea where the certificate: 'CN=CCSEXT00293,OU=Company,O=Directory' is coming from?

It is not present in any of the keytab files in ISVA, so it must be coming from some where else?

In the meantime, I am awaiting response from GSKit.","17/May/23 4:07 AM;5c87cb8d88f9ec6ae0afb306;That is the client certificate that is used to initiate the flow.  So, it’s coming from the browser. ","17/May/23 6:39 AM;5b15d9e581c3df12acf53c4a;I initially thought that one of the box is webseal but it seems that webseal IP address is: 10.119.198.87

but the communication in pacp we are looking at is between:

10.119.200.109. and 10.119.38.101

I can understand, one of that is LDAP i.e. 10.119.38.101 but  what IP is: 10.119.200.109?","17/May/23 6:42 AM;5b15d9e581c3df12acf53c4a;Oh, I see that 10.119.200.109 is the ISAM primary of the cluster……","18/May/23 7:14 PM;60f541a6d0134900692d91b7;Hi[~accountid:5b15d9e581c3df12acf53c4a] any update on this issue the customer is looking for any suggestion or workaround, please let me know ??",19/May/23 1:34 AM;5b15d9e581c3df12acf53c4a;W are still  waiting to hear feedback from GSKit Team regarding the CRL related search issue?,"22/May/23 12:56 PM;5b15d9e581c3df12acf53c4a;GSKit L3 just asked for access to this ticket in Ecurep, I provided ( i.e. invited to access this ticket in ecurep), I hope they can access the information , analyze the data and provide us guidance soon.",24/May/23 12:54 AM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9e581c3df12acf53c4a] Any update from the gskit L3 team the client is looking for an update??,24/May/23 1:42 AM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] [~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5ac57757d9a96536d1f0daa9] The client has escalated and awaiting for a response !!!,24/May/23 2:52 AM;5b15d9e581c3df12acf53c4a;We are still awaiting response from GSKit L3.,"25/May/23 3:42 AM;5b15d9e581c3df12acf53c4a;FYI:

I pinged GSKit L3 today also asking status or  if they need any more information.



================================================

Here is the GSKit Ticket:



Hi Motiur, 

 

Priority 2 GSKit L3 ticket G3583 has been created for this issue. 

 

Regards,

 

GSKit L3 Support, IBM Security Systems

 

            Wiki: [+https://w3.ibm.com/w3publisher/gskit+|https://w3.ibm.com/w3publisher/gskit]

            Slack: #GSKit-Users



* Always reply with history to 



 ","25/May/23 7:42 PM;60f541a6d0134900692d91b7;Thanks, ok I hope they respond to us soon, Client responded and they are anxious for an answer/workaround

""The current business impact is that we will not start CCS users migration from old setup to new until this Invalid DN syntax issue is resolved. Customer is putting a lot of pressure to resolve this issue on priority basis""","30/May/23 7:32 PM;60f541a6d0134900692d91b7;Hello [~accountid:5b15d9e581c3df12acf53c4a] The client is requesting for a Webex session, or could you give me feedback for this information??


Can we have quick webex session to understand the response like what action is needed from which team. May I know from which source or destination the server [LWUKWVPI249.opd.ads.uk.rsa-ins.com|https://LWUKWVPI249.opd.ads.uk.rsa-ins.com] on port - 80 should be reachable?","30/May/23 7:55 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] They also updated for further analysis.

# System is set to reject connections when certificate revocation is not able to be validated.
# As it is not rejecting connections using valid certificates then the CRL list must be getting accessed correctly.
# I performed the CRL test checks on the day of PROD LDAP servers patching happened on 20th May 2023 when LDAP services were in stopped state, CRL check result getting was undetermined which we were expecting. That means all good at functionality level.

“The only issue right now is getting *Invalid DN syntax* message in LDAP audit log file. I did connectivity check between ISAM & Sub CA server of PPD & PROD on port 80. In PPD connectivity is working on port 80 where as in case of PROD this connectivity is missing. I am following up with firewall & application team on this port requirement issue.”","30/May/23 10:56 PM;5b15d9e581c3df12acf53c4a;Here is the response from the GSKit:

==========================

HI Fergus, 

 

Here is the response form GSKit L3: 

 

None of the Certificate CRL Distribution Points (CDP) are reachable or are produce results.

 

Example of HTTP CDP not working.

 

 

53614|230505|01:44:14.556|    501b|00007FD709EFD700|    gskhttppollchannel.cpp [414]

                                                                          

            getaddrinfo failed: host - [LWUKWVPI249.opd.ads.uk.rsa-ins.com|http://LWUKWVPI249.opd.ads.uk.rsa-ins.com]  port - 80; error - Name or service not known; errno 11

     

The LDAP CDP is misconfigured with a name form LDAP:/// which should be LDAP://

 

The DN X500 LDAP name form do not work.

 

The customer should check that the CRL Server is reachable and working correctly.  The customer should correct the misconfigured LDAP CDP.

 

Regards,



GSKit L3 Support, IBM Security Systems



            Wiki: [+https://w3.ibm.com/w3publisher/gskit+|https://w3.ibm.com/w3publisher/gskit]

            Slack: #GSKit-Users

===================================",31/May/23 6:39 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] I have said the same to client but they are asking for a Webex session and more information to understand the response like what action is needed from which team. May I know from which source or destination the server [LWUKWVPI249.opd.ads.uk.rsa-ins.com|https://LWUKWVPI249.opd.ads.uk.rsa-ins.com] on port - 80 should be reachable?,"31/May/23 10:41 PM;5b15d9e581c3df12acf53c4a;[~accountid:60f541a6d0134900692d91b7] This is not an issue that can be resolved via webex.

This is a problem with their client certificate that is presented by client/browser itself.

One of the Certificate that causing invalid DN Syntax is cut/paste in a comment by me on May 12, where the certificate  itself contains the following CDP extension:



 *_X509v3 CRL Distribution Points:_* 

*_Full Name:_* 

*_URI:http://LWUKWVPI249.opd.ads.uk.rsa-ins.com/CertEnroll/RSAGroupProdExtSubCA.crl URI:file:////LWUKWVPI249/CRLDistributionSubCA/RSAGroupProdExtSubCA.crl URI:ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCA,ou=Company,o=Directory?certificaterevocationlist;binary_*



They should contact who ever issued this certificate to correct the  

*_URI:ldap:///LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCA,ou=Company,o=Directory?certificaterevocationlist;binary_*

to

*_URI:ldap://LWUKLVPE02.uk.rsa-ins.com:3890/cn=RSAGroupProdExtSubCA,ou=Company,o=Directory?certificaterevocationlist;binary_*



This Certificate’s issuer:

Issuer: O=Directory, OU=Company, CN=RSAGroupProdExtSubCA",31/May/23 11:43 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] Thank you I will update this to client,"01/Jun/23 6:03 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] The client says that we are referring the same thing about removing the single slash and they are using same Microsoft syntax to define the URI path is used in the PRE-PROD setup & it is working with 3 slashes. “I have forwarded your response to CCS Application/PKI team about client certificate.”
Response from CCS Application team is as follows:
*This is basically saying the same thing (i.e. get CDL distribution points updated on the certificates).*","02/Jun/23 2:20 AM;5b15d9e581c3df12acf53c4a;Look at the RFC-5280, how LDAP:/// can be confusing……………

[https://www.ietf.org/rfc/rfc5280.txt|https://www.ietf.org/rfc/rfc5280.txt]



{noformat}If the DistributionPointName contains a general name of type URI, the
   following semantics MUST be assumed: the URI is a pointer to the
   current CRL for the associated reasons and will be issued by the
   associated cRLIssuer.  When the HTTP or FTP URI scheme is used, the
   URI MUST point to a single DER encoded CRL as specified in
   [RFC2585].  HTTP server implementations accessed via the URI SHOULD
   specify the media type application/pkix-crl in the content-type
   header field of the response.  When the LDAP URI scheme [RFC4516] is
   used, the URI MUST include a <dn> field containing the distinguished
   name of the entry holding the CRL, MUST include a single <attrdesc>
   that contains an appropriate attribute description for the attribute
   that holds the CRL [RFC4523], and SHOULD include a <host>
   (e.g., <ldap://ldap.example.com/cn=example%20CA,dc=example,dc=com?
   certificateRevocationList;binary>).  Omitting the <host> (e.g.,
   <ldap:///cn=CA,dc=example,dc=com?authorityRevocationList;binary>) has
   the effect of relying on whatever a priori knowledge the client might
   have to contact an appropriate server.  When present,
   DistributionPointName SHOULD include at least one LDAP or HTTP URI.

   If the DistributionPointName contains the single value
   nameRelativeToCRLIssuer, the value provides a distinguished name
{noformat}



In a Windows Domain environment, a domain client may be able to find the location but outside a windows domain, this scheme will fall apart.","06/Jun/23 11:05 PM;60f541a6d0134900692d91b7;Hello [~accountid:5b15d9e581c3df12acf53c4a] , The client now says, 

“It was working earlier as well, the thing is we were getting Invalid DN syntax in LDAP server audit log file. After opens the port 80 between ISAM & Sub CA server, Invaild DN syntax issue resolved on LDAP server side. Same client certificate was used earlier & now as well. The only differences now is number of logs getting generated in PRE-PROD & PROD setup. Pre-Prod have hundreds of lines logged where as in PROD only 7 lines being logged in audit log file of LDAP server for the same action.
LDAP URI is not yet changed in PROD setup, still have 3 slashses ( / ) in the CDP configuration.

What causing this difference in number of lines logged in ldap server audit file?”



{noformat}PROD LDAP audit log sample: 

AuditV3--2023-06-06T04:03:31.992000+1:00--V3 Search--bindDN: cn=CCS-webseald/10.119.200.109,cn=SecurityDaemons,secAuthority=Default--client: 10.119.200.109:28902--connectionID: 2661--received: 2023-06-06T04:03:31.991000+1:00--No such object

 base: cn=Policy,cn=Policies,principalName=CCSEXT00000,cn=Users,secAuthority=Default

 scope: baseObject

 derefAliases: neverDerefAliases

 typesOnly: false

 filter: (objectclass=SECPOLICY)

 attributes: passwordMinLength, secPwdSpaces, passwordMaxRepeatedChars, passwordMinAlphaChars, passwordMinOtherChars, passwordMaxAge, secAcctExpires, timeExpireLockout, secAcctLife, secAcctInactivity, maxFailedLogins, passwordMinAge, passwordMinDiffChars, passwordTimeReuse, numberWarnDays, passwordReuseNum, secTODAccess, secMaxWebSessions


PRE-PROD LDAP audit log sample:

AuditV3--2023-06-06T10:42:05.459000+1:00--V2 Bind--bindDN: cn=ccs_crl_reader,ou=company,o=directory--client: 10.119.218.64:23350--connectionID: 552--received: 2023-06-06T10:42:05.458000+1:00--Success

name: cn=ccs_crl_reader,ou=company,o=directory

authenticationChoice: simple

AuditV3--2023-06-06T10:42:05.461000+1:00--V2 Search--bindDN: cn=ccs_crl_reader,ou=company,o=directory--client: 10.119.218.64:23350--connectionID: 552--received: 2023-06-06T10:42:05.460000+1:00--Success

base: CN=RSAGroupPreProdExtRootCA,OU=Company,O=Directory

scope: baseObject

derefAliases: neverDerefAliases

typesOnly: false

filter: (|(authorityrevocationlist;binary=*)(authorityrevocationlist=*)(certificaterevocationlist;binary=*)(certificaterevocationlist=*))

attributes: authorityRevocationList;binary, authorityRevocationList, certificateRevocationList;binary, certificateRevocationList

numberOfEntriesReturned: 1

AuditV3--2023-06-06T10:42:05.907000+1:00--V2 Search--bindDN: cn=ccs_crl_reader,ou=company,o=directory--client: 10.119.218.64:23350--connectionID: 552--received: 2023-06-06T10:42:05.906000+1:00--Success

base: CN=RSAGroupPreProdExtRootCA,OU=Company,O=Directory

scope: baseObject

derefAliases: neverDerefAliases

typesOnly: false

filter: (|(authorityrevocationlist;binary=*)(authorityrevocationlist=*)(certificaterevocationlist;binary=*)(certificaterevocationlist=*))

attributes: authorityRevocationList;binary, authorityRevocationList, certificateRevocationList;binary, certificateRevocationList

numberOfEntriesReturned: 1

AuditV3--2023-06-06T10:42:06.107000+1:00--V3 Bind--bindDN: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default--client: 10.119.218.64:23358--connectionID: 553--received: 2023-06-06T10:42:06.107000+1:00--Success

controlType: 1.3.6.1.4.1.42.2.27.8.5.1

criticality: false

name: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default

authenticationChoice: simple

AuditV3--2023-06-06T10:42:06.108000+1:00--V3 Unbind--bindDN: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default--client: 10.119.218.64:23358--connectionID: 553--received: 2023-06-06T10:42:06.108000+1:00--Success

AuditV3--2023-06-06T10:42:06.109000+1:00--V3 Bind--bindDN: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default--client: 10.119.218.64:23360--connectionID: 554--received: 2023-06-06T10:42:06.109000+1:00--Success

controlType: 1.3.6.1.4.1.42.2.27.8.5.1

criticality: false

name: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default

authenticationChoice: simple

AuditV3--2023-06-06T10:42:06.114000+1:00--V3 Search--bindDN: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default--client: 10.119.218.64:23360--connectionID: 554--received: 2023-06-06T10:42:06.111000+1:00--No such object

base: cn=Policy,secAuthority=Default,CN=CCSEXT00003,OU=Company,O=Directory

scope: baseObject

derefAliases: neverDerefAliases

typesOnly: false

filter: (objectclass=SECPOLICY)

attributes: passwordMinLength, secPwdSpaces, passwordMaxRepeatedChars, passwordMinAlphaChars, passwordMinOtherChars, passwordMaxAge, secAcctExpires, timeExpireLockout, secAcctLife, secAcctInactivity, maxFailedLogins, passwordMinAge, passwordMinDiffChars, passwordTimeReuse, numberWarnDays, passwordReuseNum, secTODAccess, secMaxWebSessions

AuditV3--2023-06-06T10:42:06.119000+1:00--V3 Search--bindDN: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default--client: 10.119.218.64:23360--connectionID: 554--received: 2023-06-06T10:42:06.114000+1:00--Success

base: cn=Default,cn=Policies,secAuthority=Default

scope: baseObject

derefAliases: neverDerefAliases

typesOnly: false

filter: (objectclass=SECPOLICY)

attributes: passwordMinLength, secPwdSpaces, passwordMaxRepeatedChars, passwordMinAlphaChars, passwordMinOtherChars, passwordMaxAge, secAcctExpires, timeExpireLockout, secAcctLife, secAcctInactivity, maxFailedLogins, passwordMinAge, passwordMinDiffChars, passwordTimeReuse, numberWarnDays, passwordReuseNum, secTODAccess, secMaxWebSessions

numberOfEntriesReturned: 1

AuditV3--2023-06-06T10:42:06.123000+1:00--V3 Search--bindDN: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default--client: 10.119.218.64:23360--connectionID: 554--received: 2023-06-06T10:42:06.121000+1:00--Success

base: secAuthority=Default,CN=CCSEXT00003,OU=Company,O=Directory

scope: baseObject

derefAliases: neverDerefAliases

typesOnly: false

filter: (objectclass=SECUSER)

numberOfEntriesReturned: 1

AuditV3--2023-06-06T10:42:06.126000+1:00--V3 Search--bindDN: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default--client: 10.119.218.64:23360--connectionID: 554--received: 2023-06-06T10:42:06.124000+1:00--Success

base: CN=CCSEXT00003,OU=Company,O=Directory

scope: baseObject

derefAliases: neverDerefAliases

typesOnly: false

filter: (objectclass=*)

attributes: ibm-allGroups

numberOfEntriesReturned: 1

AuditV3--2023-06-06T10:42:06.132000+1:00--V3 Search--bindDN: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default--client: 10.119.218.64:23360--connectionID: 554--received: 2023-06-06T10:42:06.127000+1:00--Success

base: secAuthority=DEFAULT,cn=CCS-Users,ou=Company,o=Directory

scope: baseObject

derefAliases: neverDerefAliases

typesOnly: false

filter: (objectclass=*)

numberOfEntriesReturned: 1

AuditV3--2023-06-06T10:42:06.138000+1:00--V3 Search--bindDN: cn=ccs-webseald/LWUKAPRE01,cn=SecurityDaemons,secAuthority=Default--client: 10.119.218.64:23360--connectionID: 554--received: 2023-06-06T10:42:06.137000+1:00--Success

base: CN=CCSEXT00003,OU=Company,O=Directory

scope: baseObject

derefAliases: neverDerefAliases

typesOnly: false

filter: (|(objectclass=EPERSON)(objectclass=PERSON))

attributes: objectClass

numberOfEntriesReturned: 1{noformat}","07/Jun/23 1:23 AM;5b15d9e581c3df12acf53c4a;As far as LDAP Audit log goes, that should be a configuration issue of the CDP LDAP Server itself.

But as GSKit suggested in their earlier email, they should check the accessibility of LDAP directly, i.e. not via ISVA but directly accessing the LDAP CDP and make sure that there is no access issues at all.

Make sure they can access via port 3890 directly to the LDAP server

Make sure they can ping the LDAP server ( i.e. [*_LWUKLVPE02.uk.rsa-ins.com:3890_*|http://LWUKLVPE02.uk.rsa-ins.com:3890] ) from ISAV box.

Please NOTE the GSKit email:

Here is the response form GSKit L3: 

 

None of the Certificate CRL Distribution Points (CDP) are reachable or are produce results.

 

Example of HTTP CDP not working.

 

 

53614|230505|01:44:14.556|    501b|00007FD709EFD700|    gskhttppollchannel.cpp [414]

                                                                          

            getaddrinfo failed: host - [LWUKWVPI249.opd.ads.uk.rsa-ins.com|http://lwukwvpi249.opd.ads.uk.rsa-ins.com/]  port - 80; error - Name or service not known; errno 11

     

The LDAP CDP is misconfigured with a name form LDAP:/// which should be LDAP://

 

The DN X500 LDAP name form do not work.

 

*_The customer should check that the CRL Server is reachable and working correctly.  The customer should correct the misconfigured LDAP CDP._*

 

Regards,

 

GSKit L3 Support, IBM Security Systems

 

            Wiki: [+https://w3.ibm.com/w3publisher/gskit+|https://w3.ibm.com/w3publisher/gskit]

            Slack: #GSKit-Users

===================================","07/Jun/23 10:12 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] the client updated “Can someone help to identify & fix the configuration issue of the CDP LDAP Server itself?
 they have a opened a separate ticket (TS012995937) opened with IBM SDS/LDAP team as well. I again checked the connectivity from two ISVA nodes (LWUKLVPC14, LWUKLVPC15) to two LDAP Servers (LWUKLVPE02, LWUKLVPE03) on port 3890 & ssl port 6360, all looks good. Same thing has been checked from Sub CA Server to LDAP Server on port 3890, not found any connectivity issues.”",07/Jun/23 10:13 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] [~accountid:5c87cb8d88f9ec6ae0afb306]  Should we tell them it should be identified by their LDAP admin and not ISVA issue??  ,"07/Jun/23 10:20 PM;5c87cb8d88f9ec6ae0afb306;Yes, they should work with the SDS team to see if there is a difference in their audit configuration. 

From and ISVA perspective, we would need to look at ldap client traces (or pcap files) to see if we are doing more LDAP queries than they expect.  

I suggest that they open a new case for this investigation.  
",13/Jun/23 12:05 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Need updated version of create_luna_keystore_fix_10031.fixpack,ISAMSUP-5042,297531,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,David Hayes,5b232b2fd85e5b59b066f57f,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,04/May/23 4:03 AM,22/May/23 12:23 PM,14/Jul/23 2:47 PM,22/May/23 12:23 PM,,,04/May/23 12:00 AM,0,,,,AT&T will be deleting and recreating their HSM configuration on a 10.0.5.0 appliance.  They are requesting a version of create_luna_keystore_fix_10031.fixpack that will work on 10.0.5.0.,,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-3983,ISAMSUP-3832,,,ISAMDEV-8211,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012917637,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,AT&T ,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1b52f:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-05-04 23:09:29.992,,,,,05/May/23 9:09 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] I believe this falls int your area of knowledge having worked with the AT&Ts teams Luna deployment in the past. Can you please confirm if the identified fix pack is still required or have all fixes been integrated into the 10.0.5 release? ,"05/May/23 10:31 AM;5b232b2fd85e5b59b066f57f;[~accountid:5c87cb8d88f9ec6ae0afb306] - there is no need for a fixpack at 10.0.5 as the fix for this was delivered in 10.0.4 under [https://cloudidentity.atlassian.net/browse/ISAMDEV-8211|https://cloudidentity.atlassian.net/browse/ISAMDEV-8211|smart-link] 

Is the customer having an issue - or was this just pre-emptive? ","05/May/23 10:11 PM;5c87cb8d88f9ec6ae0afb306;The customer indicates that they are deleting and recreating luna keystores to fix an hsm issue.  So, this appears to be preemptive.  

As for the fix delivered in [https://cloudidentity.atlassian.net/browse/ISAMDEV-8211|https://cloudidentity.atlassian.net/browse/ISAMDEV-8211|smart-link], is that specific to containers? ","10/May/23 2:02 AM;5c87cb8d88f9ec6ae0afb306; [~accountid:5b232b2fd85e5b59b066f57f] 

Can you please clarify if we need the fixpack or not?  If a fixpack is needed, can you please let me know when it will be available?","10/May/23 9:51 AM;5b232b2fd85e5b59b066f57f;[~accountid:5c87cb8d88f9ec6ae0afb306] - the DEV work item was raised due to an issue identified when testing the docker implementation; this issue is also applicable to non-docker and therefore so is the fix. 

The customer does not need a fix-pack for 10.0.5 for this issue. ",10/May/23 10:35 PM;5c87cb8d88f9ec6ae0afb306;Thank you for the clarification. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Confirmation require for the Interface IDMappingExtCache put method caching life time.,ISAMSUP-5000,295708,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,21/Apr/23 6:26 AM,06/May/23 1:41 AM,14/Jul/23 2:47 PM,06/May/23 1:41 AM,,Support,,0,,,,"The following below are the information of the interface & method customer is referring to need to confirm. Customer listed 3 questions below the interface. Please provide confirmation in answering those 3-question listed below. I haven’t found too much information in documentation neither in old cases.

*com.tivoli.am.fim.trustserver.sts.utilities*
*Interface IDMappingExtCache*
*All Known Implementing Classes:*
*IDMappingExtCacheDMAPImpl*

{noformat}void put(java.lang.String lookupKey,
         java.lang.String entry,
         int lifetime)
         
Stores an association for a given state id in a cache.

Parameters:
lookupKey - - The key that will be later used to lookup the entry. The max key length is 109 characters.
entry - - The entry to store in a cache. The maximum length of entry is specific to the database being used.
lifetime - - The length of time we should store the association in seconds	{noformat}

These are the three questions we need your confirmation.

# What is the maximum value I can use to set the lifetime parameter on the put method? 
# Assumed totally blackout no power and my business continuity plan/disaster recovery power generator also go down without power. My AAC appliance finally got restart after 24 hours without power. Just before the blackout happen to put a few records with lifetime value to 259200. Are the caches stored using the put (java.lang.String lookupKey, java.lang.String entry,int lifetime) method remain after the cool boot of the appliance 24hour after?
# If the records in question 2 still exist, then how long the caches will be remained before it expires?



Regarding the IDMappingExtCache... I found an old internal defect from several years ago where IBM Development increased the maximum lifetime from 23 days to a longer time period. I see they wanted the lifetime to expire at 90 days. However, they didn't explicitly state the value of the new maximum lifetime. 

See this work item that is related: [https://rtp-rtc6.tivlab.raleigh.ibm.com:9443/jazz/web/projects/ISAM#action=com.ibm.team.workitem.viewWorkItem&id=117432|https://rtp-rtc6.tivlab.raleigh.ibm.com:9443/jazz/web/projects/ISAM#action=com.ibm.team.workitem.viewWorkItem&id=117432]",,Brandon Garay,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,60e721f12d49fd00698bb49d,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012722757,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,ROYAL BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1au2f:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-20 21:50:41.992,,,,,"21/Apr/23 7:50 AM;5b15d94b6256d01ad54eb020;For (1.)  The largest value that an 'int' in java will hold is:  2,147,483,647

Internally that old defect you referred to allows you to use that max value.  

I don’t know about the other two questions.  My expectation would be that the cache is cleared when you restart but maybe this is a persistent cache.   Maybe somebody else can answer that.",24/Apr/23 8:36 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] assigning this item to you to review and assist to move forwards.,"24/Apr/23 1:49 PM;5b15d954b0d76456f36daf33;[~accountid:60e721f12d49fd00698bb49d]  Looks like Q1 is ok for now?

Do we have a copy of their mapping rule snipper where this cache is being used?

For the main part the cache is part of DMAP. Its creation/storage has two options → HVDB or Redis (You can set this from the AAC → Advanced Configuration screen in LMI)

In either case, a power outage or even a restart of the runtime profile or the appliance itself would not automatically invalidate the cache. 

As for the removal of entries from the cache, it happens when the end of lifetime is reached.

You should be able to validate both those things locally by setting a small lifetime (10 mins or so) and then shutting down the appliance and/or restarting runtime etc.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unable to Import Certificates plus neither able to create Certificate DB,ISAMSUP-4996,295659,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Bill Tyler,5b15d94b6256d01ad54eb020,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,20/Apr/23 10:42 PM,06/Jul/23 4:09 AM,14/Jul/23 2:47 PM,06/Jul/23 4:09 AM,,,,0,,,,"Unable to Import Certificates plus neither able to create Certificate DB. Customer has a numbers appliances which in a GCP kubernetes cluster. They recently upgraded from 10,0,2 to 10,0,4 to 10,0,5. They are unable to import the following certificates in neither pem nor crt:

*DigiCert Global Root G2*

Valid until: 15/Jan/2038

Serial #: 03:3A:F1:E6:A7:11:A9:A0:BB:28:64:B1:1D:09:FA:E5

SHA1 Fingerprint: DF:3C:24:F9:BF:D6:66:76:1B:26:80:73:FE:06:D1:CC:8D:4F:82:A4

SHA256 Fingerprint: CB:3C:CB:B7:60:31:E5:E0:13:8F:8D:D3:9A:23:F9:DE:47:FF:C3:5E:43:C1:14:4C:EA:27:D4:6A:5A:B1:CB:5F



*DigiCert Global G2 TLS RSA SHA256 2020 CA1*

Issuer: DigiCert Global Root G2

Valid until: 29/Mar/2031

Serial #: 0c:f5:bd:06:2b:56:02:f4:7a:b8:50:2c:23:cc:f0:66

SHA1 Fingerprint: 1B:51:1A:BE:AD:59:C6:CE:20:70:77:C0:BF:0E:00:43:B1:38:26:12

SHA256 Fingerprint: C8:02:5F:9F:C6:5F:DF:C9:5B:3C:A8:CC:78:67:B9:A5:87:B5:27:79:73:95:79:17:46:3F:C8:13:D0:B6:25:A9



They get the following error:



!image-20230420-123856.png|width=540,height=625!

They have tried to create another certificate db and get the following error:



!image-20230420-124053.png|width=595,height=572!

!image-20230420-124120.png|width=602,height=220!",,David Flynn,Dermot Daly,Gabe,khansen,Nick Lloyd,Reagan Knowles,tonyferg,Tushar Prasad,Virag Patel,William Hannon Jr,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,,21/Apr/23 5:03 AM;gabrbell;DigiCertGlobalRootG2.pem;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197170,20/Apr/23 10:42 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230420-123856.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197075,20/Apr/23 10:42 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230420-124053.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197076,20/Apr/23 10:42 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230420-124120.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197074,22/Apr/23 2:02 AM;khansen;image-20230421-160159.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197331,22/Apr/23 2:05 AM;khansen;image-20230421-160501.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197332,22/Apr/23 2:11 AM;khansen;image-20230421-161117.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197339,25/Apr/23 2:20 AM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230424-161728.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197592,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012730794,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,KESKINAINEN ELAKEVAKUUTUSYHTIO,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"IBM Support file location:
/ecurep/sf/TS012/730/TS012730794/2023-04-18/isva_10.0.5.0_20230418-163548_isvaconfig-846f6559ff-5nl7f.support_unpack/

Captured screenshot with the errors:
https://ecurep.mainz.de.ibm.com/ae5/#id=TS012730794&path=TS012730794%2F2023-04-18%2F&filepath=TS012730794%2F2023-04-18%2Fscreen_1.png

screenshots available at regarding new cert database creation which also does not work:
the Next button doesn't do anything.
/ecurep/sf/TS012/730/TS012730794/2023-04-19/",,,,,,,,,,,,,,,,,,,,,,,0|i1atrr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-20 17:13:28.163,,,,,"20/Apr/23 11:56 PM;614dd566a995ad0073ec0622;The customer has seven environments or clusters. Issue in config container in all clusters.  Their dev environment consists of 1 config, 1 runtime, 1 dsc and 5-6 WRP containers.  ","21/Apr/23 3:13 AM;5b17571b91981f4fdde632c1;* *GSKKM_ERR_ASN*
** An asn.1 encoding/decoding error occurred.



* For ISVA L3 Support only
* [~accountid:5b232b2fd85e5b59b066f57f]  Suggesting L3 GC take this problem then it could be discussed with L3 GSKit directly","21/Apr/23 3:23 AM;5b17571b91981f4fdde632c1;* L2 please show me your complete Jira search performed
** How many hits?
* [https://cloudidentity.atlassian.net/browse/ISAMSUP-4685|https://cloudidentity.atlassian.net/browse/ISAMSUP-4685|smart-link] ","21/Apr/23 3:47 AM;5b15d94b6256d01ad54eb020;Also how is the certificate formatted?   If you are using this style it should work.

""------BEGIN CERTIFICATE------""
…
""------END CERTIFICATE------""",21/Apr/23 5:03 AM;5b15d99b4c20165700edecad;That is the format for this pem. I tested importing this on both a VM and Docker 10.0.5.0 with no issues. ,"21/Apr/23 1:25 PM;5b17571a82e05b22cc7d5d9e;it seems customer has escalated this issue as they can’t use their dev environment because the current certs are expiring in a day and may face issue in prod as well soon.

looks like pdsrv cert database has issue as they can’t import digi root ca signer cert (tried pem and crt format) and nor able to create new database. 

seems something went wrong while they moved from older version to v10.0.5 during upgrade process.","21/Apr/23 3:58 PM;5b17571a82e05b22cc7d5d9e;when i try to read all .p12 file then it gives error as below

CTGSK2002W An ASN.1 encoding/decoding error occurred. ","21/Apr/23 6:48 PM;614dd566a995ad0073ec0622;Customer has just uploaded a snapshot of the dev environment before workaround applied(Not sure what workaround they are talking about, I will clarify). They are currently trying to recreate the pdsrv again. They also stated:

# Version 10.0.2 was built using a Kubernetes deployment and monolithic docker image.
# Version 10.0.4 we changed the deployments to use lightweight containers (unable to verify if problem started already here or after 10.0.5)","21/Apr/23 10:50 PM;5b15d99b4c20165700edecad;It look like all of their certs are returning the encoding/decoding error. Maybe importing the pdsrv.p12 from a working appliance will get them over this hurdle but it looks like they have a bigger issue. 

$ gsk8capicmd -cert -list -db STS_signing_keys.p12 -stashed
CTGSK3026W The key file ""STS_signing_keys.p12"" does not exist or cannot be read.
CTGSK2002W An ASN.1 encoding/decoding error occurred.",21/Apr/23 11:01 PM;614dd566a995ad0073ec0622;I wonder do they have a functioning db or applicable cert in any appliance? Communication is very challenging at times with this customer. I have asked to export and reimport a good cert but apparently they have tried that or so I believe. I suspect all their clusters both prod and non-prod could now be 10.0.5 with potentially damaged cert dbs. We could ask for a cert db or cert from a good 10.0.2 machine or maybe they can build a 10.0.2 machine using a 10.0.2 snapshot? But this could go right down to the gskit code itself?,"22/Apr/23 12:03 AM;5b17571b91981f4fdde632c1;* *Second request*
** This is required



* {color:#bf2600}*L2 please show me all of your complete Jira search(s) performed*{color}
** How many hits?","22/Apr/23 12:09 AM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] I don’t understand this question? If you asking if I searched for this issue in the Jira DB in general then yes I did and found one result as stated by myself when I replied earlier to the same question: [https://cloudidentity.atlassian.net/browse/ISAMSUP-4685|https://cloudidentity.atlassian.net/browse/ISAMSUP-4685|smart-link] . There is also this Jira from a similar PMR: [https://cloudidentity.atlassian.net/browse/ISAMSUP-4016|https://cloudidentity.atlassian.net/browse/ISAMSUP-4016|smart-link] 



[~accountid:5b17571b91981f4fdde632c1] I did a search a few days ago. I can’t remember what keywords I used but I remember the results were rather sparse and not much use.",22/Apr/23 12:43 AM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] Ok. I will try to re emulate my search with strings used and results attached.,"22/Apr/23 12:59 AM;614dd566a995ad0073ec0622;DPWAP0194E : [https://cloudidentity.atlassian.net/browse/ISAMDEV-728|https://cloudidentity.atlassian.net/browse/ISAMDEV-728|smart-link] 

pdsrv.p12: [https://cloudidentity.atlassian.net/browse/ISAMDEV-9956|https://cloudidentity.atlassian.net/browse/ISAMDEV-9956|smart-link] 

GSKKM_ERR_ASN : [https://cloudidentity.atlassian.net/browse/ISAMSUP-4353|https://cloudidentity.atlassian.net/browse/ISAMSUP-4353|smart-link] 



[https://cloudidentity.atlassian.net/browse/ISAMSUP-4016|https://cloudidentity.atlassian.net/browse/ISAMSUP-4016|smart-link] 

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4685|https://cloudidentity.atlassian.net/browse/ISAMSUP-4685|smart-link] 



I got 4686 from a similar PMR.  Not sure how I got 4016.  [~accountid:5b17571b91981f4fdde632c1] ",22/Apr/23 1:05 AM;614dd566a995ad0073ec0622;[https://cloudidentity.atlassian.net/browse/ISAMSUP-4165|https://cloudidentity.atlassian.net/browse/ISAMSUP-4165|smart-link] Maybe an import via cli? Is that possible? [~accountid:5b17571b91981f4fdde632c1] Reviewing other Jiras.,22/Apr/23 1:30 AM;614dd566a995ad0073ec0622;[https://cloudidentity.atlassian.net/browse/ISAMDEV-728|https://cloudidentity.atlassian.net/browse/ISAMDEV-728|smart-link]  Maybe the cert exists in some form already? Have they deleted the previous cert if it already or similar exists? Not sure if we have checked that?,22/Apr/23 1:33 AM;614dd566a995ad0073ec0622;[https://cloudidentity.atlassian.net/browse/ISAMSUP-4273|https://cloudidentity.atlassian.net/browse/ISAMSUP-4273|smart-link] Is there a CSR in the store?,"22/Apr/23 1:34 AM;5b17571b91981f4fdde632c1;* Still have not shown me the URL or query you used
** Guessing you are using the search box
*** When you search that way you ONLY search Comments *NOT Description*
**** Therefore your search would be ineffective



* In the Jira Search box to the left is a magnifying glass
** Click it
*** Opens a frame
**** At the bottom of the frame click “*Advanced issue search”*
***** Advanced issue search is *VERY powerful* down to specific field searches
* In the Jira Advance search box (shaded gray)
** && (and) means all must be true
** ||    (or)    means only one must be true
** Search #1 remove everything then add
*** {color:#bf2600}*(project = 'ISAM Support' || project = 'ISAM Development') &&* {color}
**** Notice the && (and) on the end
***** We are not done with the search yet
*** Now we want to search for one more item … appended to prior text
**** {color:#bf2600}*(summary ~ 'GSKKM_ERR_ASN' || text ~ 'GSKKM_ERR_ASN')*{color}
***** summary is for description search
***** text is for comments search
***** both are required
*** Click blue search button
**** Review all hits
***** *** PLEASE NOTE *** it will not search pictures
****** That is why you need to add proper text in work items for searchability
** Search #2 Same prior steps … different search
*** Notice different parentheses grouping
**** {color:#bf2600}*(project = 'ISAM Support' || project = 'ISAM Development') &&* {color}
**** {color:#bf2600}*( (summary ~ 'certificate' || text ~ 'certificate') && (summary ~ 'import' || text ~ 'import') && (summary ~ 'fail' || text ~ 'fail') )*{color}
*** Click blue search button
**** Review all hits","22/Apr/23 2:02 AM;5b15d901fa615349cb01778b;!image-20230421-160159.png|width=1163,height=525!","22/Apr/23 2:05 AM;5b15d901fa615349cb01778b;!image-20230421-160501.png|width=1149,height=608!",22/Apr/23 2:06 AM;5b17571b91981f4fdde632c1;Gave has next steps ,"22/Apr/23 2:09 AM;5b15d99b4c20165700edecad;Using Bill’s first search there two hits not including this Jira. 

[https://cloudidentity.atlassian.net/issues/?jql=(project+%3D+'ISAM+Support'+||+project+%3D+'ISAM+Development')+%26%26+(summary+~+'GSKKM_ERR_ASN'+||+text+~+'GSKKM_ERR_ASN')&atlOrigin=eyJpIjoiNzZhNjZhZjljYzZiNGRkZDgwMjNlZDA3MTdjMDg0NmIiLCJwIjoiaiJ9|https://cloudidentity.atlassian.net/issues/?jql=%28project+%3D+%27ISAM+Support%27+%7C%7C+project+%3D+%27ISAM+Development%27%29+%26%26+%28summary+%7E+%27GSKKM_ERR_ASN%27+%7C%7C+text+%7E+%27GSKKM_ERR_ASN%27%29&atlOrigin=eyJpIjoiNzZhNjZhZjljYzZiNGRkZDgwMjNlZDA3MTdjMDg0NmIiLCJwIjoiaiJ9]

A Jira that could be related to this issue is [https://cloudidentity.atlassian.net/browse/ISAMSUP-4353|https://cloudidentity.atlassian.net/browse/ISAMSUP-4353|smart-link] which discusses the IJ38857_10031_V3.fixpack. 

This fixpack was mentioned in the case but IJ38857 was included in 10.0.4.0 IF01. This APAR  updated the GSKit version could be the source of the current issue. 

We should start with a GSKit trace from the LMI to get a better understanding of what is going on here. 

 enable_LMI_gskit_trc
[https://ibm.ent.box.com/folder/145754462235|https://ibm.ent.box.com/folder/145754462235|smart-link] 
",22/Apr/23 2:10 AM;5b17571b91981f4fdde632c1;Thank you Gabe.,"22/Apr/23 2:11 AM;5b15d901fa615349cb01778b;!image-20230421-161117.png|width=1157,height=487!",22/Apr/23 2:19 AM;5b15d901fa615349cb01778b;So is this APAR IJ38857 which should be in 10.0.5?,22/Apr/23 2:22 AM;614dd566a995ad0073ec0622;[https://cloudidentity.atlassian.net/browse/ISAMSUP-4685|https://cloudidentity.atlassian.net/browse/ISAMSUP-4685|smart-link] Sashing algorithm?  4016 and 4353 both mention that IJ38857 fixpack. I haven’t conducted the search as specified by William yet. I’m finished on this Jira today. I will advise customer we are still investigating.,22/Apr/23 2:40 AM;614dd566a995ad0073ec0622;Customer has advised they have implemented a workaround and will continue working on main issue next week. I don’t know what this workaround is. I can ask next week.,22/Apr/23 2:48 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d901fa615349cb01778b]  IJ38857 is in 10.0.5.0,"22/Apr/23 3:02 AM;5b15d94b6256d01ad54eb020;Regarding Gabe’s comment  gskit tracing.  To use enable_LMI_gskit_trc  I need to rebuild for  10.0.5.0.

Update:

10.0.5.0 version is here in case we end up needing it.

[https://ibm.ent.box.com/folder/204431369092|https://ibm.ent.box.com/folder/204431369092|smart-link] ",22/Apr/23 3:17 AM;5b15d901fa615349cb01778b;Thank you Bill Tyler sad we lost a whole day on this,"25/Apr/23 2:20 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] 

I added the following into the advanced box below:

(project = 'ISAM Support' || project = 'ISAM Development') && (summary ~ 'GSKKM_ERR_ASN' || text ~ 'GSKKM_ERR_ASN')

((summary ~ 'certificate' || text ~ 'certificate') && (summary ~ 'import' || text ~ 'import') && (summary ~ 'fail' || text ~ 'fail'))

and got back my own case? So what am I doing wrong?



!image-20230424-161728.png|width=1416,height=658!","25/Apr/23 2:31 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622]  Did you find out what their work around was?  I know that import works so I’m guessing this issue is caused by the certificate itself. Like an unsupported format.

Regarding the search, that’s okay if you got your case back as long as you got a few more too.  If you only got yours then maybe that’s all there is.","25/Apr/23 2:44 AM;614dd566a995ad0073ec0622;My searches only returned my case.



The customer’s temporary workaround in the lower environments was:

# Backup current pdsrv (export signer certificates, extract personal certs).
# Recreate pdsrv and import certificates.
# Create new certificate keystore for certificates currently used via rt_profile_keys.
# Point server connections to use newly created keystore.

I am assuming that they also created a new certificate db for the certificates in rt_profile_keys, as a keystore and certificate db I assume are different or are the same? They obviously got around the problem of creating a certificate db also.","25/Apr/23 2:47 AM;5b15d94b6256d01ad54eb020;In my  case just doing the simple search  returned  [https://cloudidentity.atlassian.net/browse/ISAMSUP-4353|https://cloudidentity.atlassian.net/browse/ISAMSUP-4353|smart-link]   

Which is the one with the APAR we were discussing.

I tend to start with the  simple search  and if nothing shows up, then use the advanced search.","25/Apr/23 2:57 AM;5b15d94b6256d01ad54eb020;Try this in Advanced search:   project = ISAMSUP  AND text ~ ""GSKKM_ERR_ASN""

For me it returned three cases including yours.","25/Apr/23 3:00 AM;614dd566a995ad0073ec0622;I submitted project = ISAMSUP AND text ~ ""GSKKM_ERR_ASN"" exactly and only case is returned.",25/Apr/23 3:02 AM;5b15d94b6256d01ad54eb020;That’s strange. I pasted in exactly what I used.,25/Apr/23 3:32 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] So are you investigating what the root cause is currently?,25/Apr/23 3:43 AM;5b15d94b6256d01ad54eb020;No.  There isn’t enough information to do that. ,25/Apr/23 3:45 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] And how can I help in that endeavour?,"25/Apr/23 3:55 AM;5b15d94b6256d01ad54eb020;Recreate the problem which isn’t very likely.  It’s also unlikely that we come up with a root cause.   

We don’t a have gskit trace of the problem.  The  default profile has no tracing. So we don’t have much to go on.

This was a problem with either the certificate or the key store.   That’s all we know.  For their work around did they  import the same certificates into the new key store that they had trouble with before?   Or did they create both a new certificate and a new keystore?",25/Apr/23 3:57 AM;5b15d9e44c4ed14b83af8723;Gabe earlier mentioned a fixpack in this Jira to get GSKit traces from the LMI. Has that been provided/discussed with the customer?,25/Apr/23 3:59 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9e44c4ed14b83af8723] I provided L2 with a 10.0.5.0 version on Friday.  By that time they said they had a work around.  So if want to recreate the problem  and add gskit tracing along with LMI tracing we can look at it.,25/Apr/23 4:10 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Yes that fixpack for lmi gskit tracing was mentioned. I did not ask the customer because I believe I did not get firm direction to use it. But I will ask now. I believe this is the 10.0.5 version: [https://ibm.ent.box.com/folder/204431369092|https://ibm.ent.box.com/folder/204431369092|smart-link] ? Do we need to turn on lmi tracing in the lmi or something similar to enable it? I presume a normal support file will collect data?,25/Apr/23 4:14 AM;5b15d94b6256d01ad54eb020;Yes we  need both gskit tracing and LMI tracing.,25/Apr/23 4:21 AM;614dd566a995ad0073ec0622;I only have gskit tracing per reverse proxy: [https://www.ibm.com/support/pages/collecting-gskit-trace-reverse-proxy-webseal-isam-appliance|https://www.ibm.com/support/pages/collecting-gskit-trace-reverse-proxy-webseal-isam-appliance] ? Implement for every rp? I would use this for lmi tracing: [https://www.ibm.com/docs/en/sva/10.0.4?topic=settings-configuring-tracing-local-management-interface|https://www.ibm.com/docs/en/sva/10.0.4?topic=settings-configuring-tracing-local-management-interface|smart-link] ,25/Apr/23 4:56 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] No I need it for  LMI tracing. Use the fix pack I provided on friday.,"26/Apr/23 2:14 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Is this fixpack compatible with:

[https://www.ibm.com/docs/en/sva/10.0.5?topic=support-docker-image-security-verify-access|https://www.ibm.com/docs/en/sva/10.0.5?topic=support-docker-image-security-verify-access|smart-link] 



The customer moved the .fixpack file to /var/shared/fixpacks and restarted their configuration pod. From their logs they saw that the fixpack was applied but the configuration container did not start and they were unable to access the LMI.",26/Apr/23 2:25 AM;5b15d94b6256d01ad54eb020;You didn’t say this was docker.  I’ll need to look into that.,26/Apr/23 3:47 AM;614dd566a995ad0073ec0622;I apologise. I mentioned in description it was a kubernetes cluster. I thought that was automatically docker images?,26/Apr/23 4:09 AM;5b15d94b6256d01ad54eb020;Not a big problem.   I’m surprised the fixpack had that effect.  ,02/May/23 4:50 AM;5b15d94b6256d01ad54eb020;I was out a couple of days so I need tolook into what changes I need to make for this issue with docker.,05/May/23 9:30 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020] I am removing the escalated label from this engagement as I believe the customer has moved forwards. I do want to note that this item is still on us to assess. Can you please outline next steps to ensure that everyone is in sync as to what direction we are taking this. ,05/May/23 7:20 PM;614dd566a995ad0073ec0622;Customer is asking for update.,"06/May/23 2:39 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] we have been discussing this with the gskit L3 team to try to find out  what the common causes are for this error.

The next thing we need to do is get a gskit trace.  I’m trying to test that today.","06/May/23 7:53 AM;5b15d94b6256d01ad54eb020;I tested a couple of different variations of the fix pack to try to get it work in the container  and that didn’t work.  But did work was edit the the environment variables  for the container using:

I added the following:

GSK_TRACE_FILE=/var/application.logs.local/lmi/gskit.trc
GSKTRACE_NOBUFFERING=YES
GSK_TRACE_FILE_SIZE=262144000
GSK_TRACE_FILE_NUMBER=100	



Afterward I did have the file:   /var/application.logs.local/lmi/gskit.trc



Please try that and retest and send in a new support file making sure you include the gskit.trc",08/May/23 7:30 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Just to clarify. The customer edits the environmental variables as you have documented below and then applies the fixpack previously supplied to them to obtain the gskit trace /var/application.logs.local/lmi/gskit.trc in the resultant support file?,"10/May/23 1:28 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] yes, they just need to add them to the container.  Then retest and send in a support file.",10/May/23 1:48 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Do they need to apply the fixpack we gave them?,"10/May/23 1:49 AM;5b15d94b6256d01ad54eb020;No,  as I mentioned the  enable gskit fix pack doesn’t work on containers.","15/May/23 11:45 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] 

The customer followed our instruction. They believed the gskit trace might have stopped for some reason? Anyhow I ran the gskit analyzer against the trc file and opened the xhtml in edge whose results are shown below. As one can see not much to go on other a statement that no issues found? 



AnalysisAPI Settings(2)Handshakes(3)Advanced Users
API Operations
Handshake Profiling
Malloc Profiling
Function Profiling
Environment Init Profiling
Key Store Certificates
Processes and Threads(2)
HandleLeaks(2)
Trace Statistics

Trace File : S:\sf\TS012\730\TS012730794\2023-05-15\isva_10.0.5.0_20230515-142401_isvaconfig-679679b5bb-6qd4p.support_unpack\var\application.logs.local\lmi\gskit.trc
Platform : Linux isvaconfig-679679b5bb-6qd4p 5.10.162+ #1 SMP Thu Feb 9 16:00:42 UTC 2023 x86_64
GSKit Version(s) :
Trace is unbuffered

No known problems found
For further assistance, Please contact L3 Support","16/May/23 12:54 AM;5b15d94b6256d01ad54eb020;I think they are correct.  Doesn't look like we caught the error.

The error occurred at :  5/15/23, 14:22:13:655 EEST

The trace ran from:  

230515|11:15:51.275

to

230515|11:15:51.929

With the environment variables set I don’t know why it stopped but the log does show

“GSKTrace turned off”",16/May/23 12:59 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Maybe think on it and come back with suggestions? I suppose we could ask them to try and catch the error again?,"16/May/23 1:16 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] find out what settings they used.  Did they make any changes to the following?

GSK_TRACE_FILE=/var/application.logs.local/lmi/gskit.trc
GSKTRACE_NOBUFFERING=YES
GSK_TRACE_FILE_SIZE=262144000
GSK_TRACE_FILE_NUMBER=100

--

Updt:  [~accountid:614dd566a995ad0073ec0622] I did find these environment variables in one of the logs and they set them exactly  as I listed above. So I need to track down where that got disabled.",16/May/23 4:39 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] I see you left this Jira at L2? Do i still need to ask customer anything? I see you confirmed in a subsequent update to your post that you confirmed from the logs that they did set the variables as requested? ,"16/May/23 4:47 AM;5b15d94b6256d01ad54eb020;No that is for you to update when you are ready for L3 to look at it.   The problem in this case is that since the GSK env variables are global it affects all processes that use gskit. The support file didn’t have any webseal logs but did list a number  of instances so we include those as well in the support file. I think what happened is some other process (maybe webseal) disabled the gskit tracing.  

For now leave it set to L3 and I’ll look into it some more.",18/May/23 12:46 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] The customer would like to recreate the rt_profile_keys certificate db but they are unable to remove it either by lmi or rest api. Can you create a fixpack to remove or is there such a fixpack provided of course they can back that certificate db.,18/May/23 12:59 AM;5b15d94b6256d01ad54eb020;I think we can do that.  Let me check into it.,24/May/23 7:33 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622]  FYI  I’m just about done with the fix pack for this.   I ran some test today and it looked good.,"25/May/23 3:55 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] Here is the fixpack.  I tested it out and I think it works.  Please double check by testing it also before shipping it out.

It removes  rt_profile_keys.p12 and  rt_profile_keys.sth  and rebuilds them.

[https://ibm.ent.box.com/folder/209415157194|https://ibm.ent.box.com/folder/209415157194|smart-link] ",06/Jun/23 7:10 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Any progress on this case? The customer highlighted that the keystores change from kdb to p12 files in 10.0.3 and later; unsure if it is any relevance to this case. ,06/Jun/23 11:32 PM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] Why are you asking me that?  There isn’t anything for me to do.  This Jira item has been with you since May 24th.   I provided a fix pack for you to test prior to you sending it out.   Did you do that?,"07/Jun/23 12:59 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Yes; thanks for the recent fixpack. If you review your previous post on the 15th of May; I understood you were going to continue to look at the data collected at the previous attempt to collect gskit logs:

 “Bill Tyler 

15 May 2023 at 18:47

No that is for you to update when you are ready for L3 to look at it. The problem in this case is that since the GSK env variables are global it affects all processes that use gskit. The support file didn’t have any webseal logs but did list a number of instances so we include those as well in the support file. I think what happened is some other process (maybe webseal) disabled the gskit tracing.

For now leave it set to L3 and I’ll look into it some more.

Edit·Delete·👍1

David Flynn 

15 May 2023 at 18:39

[~accountid:5b15d94b6256d01ad54eb020] I see you left this Jira at L2? Do i still need to ask customer anything? I see you confirmed in a subsequent update to your post that you confirmed from the logs that they did set the variables as requested?“","07/Jun/23 1:14 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622]  that changes when you said:   “customer would like to recreate the rt_profile_keys certificate db”

That fix pack should have resolved it.",07/Jun/23 1:23 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Ok. Let me review again. ,13/Jun/23 8:59 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] The original issue was they could not import certificates nor create a certificate database? Eventually they could recreate pdsrv and thanks to your fixpack recreate rt_profile_keys,14/Jun/23 12:03 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] thanks for the update. What is their status now?   Are they still having problems?,16/Jun/23 10:57 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Their last update was two weeks ago. They were wondering was the transition from kdb to p12 from 10.02. to 10.0.3 the root cause issue. I didn’t relay as I thought you would have taken such into account anyways if even relevant. I will ask what is their current status.,20/Jun/23 1:06 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] The fixpack worked but ldap issues appeared. Whether it is related to fixpack is unsure. So they rebuilt from scratch to 10.0.5. This has worked apparently. They closed the case. So I reopened to ask for confirmation as their post was not clear. But my question appears to be stuck at internal so I don’t think I can no longer contact the customer.,20/Jun/23 1:07 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] I can now post public on PMR. I will await reply from customer.,04/Jul/23 2:58 PM;5b232b2fd85e5b59b066f57f;[~accountid:614dd566a995ad0073ec0622] - whats the status of this? I note that the case is closed - can we close out the WI?,06/Jul/23 4:09 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] it doesn’t sound like we need this Jira any more since the case is closed. I’m closing this one.  You can reopen if the customer reopens the case or you can open a new jira.,,,,,,,,,,,,,Done
Webseal URL decoding issue on backend response after upgrade to v10.0.5,ISAMSUP-4941,291731,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Virag Patel,5b17571a82e05b22cc7d5d9e,Virag Patel,5b17571a82e05b22cc7d5d9e,03/Apr/23 2:47 AM,17/Apr/23 11:53 PM,14/Jul/23 9:36 AM,17/Apr/23 11:53 PM,10.0.6,Support,,0,whitelist,,,"customer has recently upgraded from v10.0.4 to v10.0.5 and observing different behavior regarding the url decoding in location header.

the issue is particularly with the URL macro. Backend is passing URL macro to webseal in encoded form as URL=*%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize*

However webseal is passing above URL macro to client browser as 

URL=*/mga/sps/oauth/oauth20/authorize*



*With v10.0.5*

Backend → Webseal passes below http response

2023-03-29-08:42:09.755+00:00I----- *thread(22)* trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: *----------------- PD <=== BackEnd -----------------*
Thread 22; fd 258; local 100.64.83.56:33218; remote 100.64.84.10:9443
HTTP/1.1 302 Found
connection: close
content-language: en-US
content-length: 0
date: Wed, 29 Mar 2023 08:42:09 GMT
location: [https://alb-cp-websphere-dev.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize%3Fredirect_uri%3Dhttps%253A%252F%252Fesvc.sgsingpass.com%252Fisam%252Fsps%252Foidc%252Frp%252FOIDC20_1FA%252Fredirect%252Fdevcorppass%26response_type%3Dcode%26state%3DqKMgL1W1EZ%26scope%3Dopenid%26client_id%3DM6v0qhxOfRyO5I5ulvdQ%26esrvcID%3DM6v0qhxOfRyO5I5ulvdQ&TAM_OP=login|https://alb-cp-websphere-dev.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize%3Fredirect_uri%3Dhttps%253A%252F%252Fesvc.sgsingpass.com%252Fisam%252Fsps%252Foidc%252Frp%252FOIDC20_1FA%252Fredirect%252Fdevcorppass%26response_type%3Dcode%26state%3DqKMgL1W1EZ%26scope%3Dopenid%26client_id%3DM6v0qhxOfRyO5I5ulvdQ%26esrvcID%3DM6v0qhxOfRyO5I5ulvdQ&TAM_OP=login]



and then webseal to Client 

2023-03-29-08:42:09.757+00:00I----- *thread(22)* trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: *----------------- Browser <=== PD -----------------*
Thread 22; fd 256; local 100.64.83.56:9080; remote 127.0.0.6:60877
HTTP/1.1 302 Found
content-language: en-US
content-length: 0
date: Wed, 29 Mar 2023 08:42:09 GMT
location: [https://cp-id.spcp.gov.sg/cpauth/login/eservlogin?URL=/mga/sps/oauth/oauth20/authorize?redirect_uri=https%3A%2F%2Fesvc.sgsingpass.com%2Fisam%2Fsps%2Foidc%2Frp%2FOIDC20_1FA%2Fredirect%2Fdevcorppass&response_type=code&state=qKMgL1W1EZ&scope=openid&client_id=M6v0qhxOfRyO5I5ulvdQ&esrvcID=M6v0qhxOfRyO5I5ulvdQ&TAM_OP=login|https://cp-id.spcp.gov.sg/cpauth/login/eservlogin?URL=/mga/sps/oauth/oauth20/authorize?redirect_uri=https%3A%2F%2Fesvc.sgsingpass.com%2Fisam%2Fsps%2Foidc%2Frp%2FOIDC20_1FA%2Fredirect%2Fdevcorppass&response_type=code&state=qKMgL1W1EZ&scope=openid&client_id=M6v0qhxOfRyO5I5ulvdQ&esrvcID=M6v0qhxOfRyO5I5ulvdQ&TAM_OP=login]



==========

customer mentioned that with v10.0.4 the URL macro is in encoded form as the backend is passing.

and expecting same behavior after upgrade to v10.0.5

pls note that customer is using the http transformation rule to update the location header but i noticed from the collected pdweb traces that the encoding issue is happening even before the http transformation rule is executed.",,adarsh.nair,,,,,,,,,,,,,,,605c0c04b18de50071046740,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,08/Apr/23 5:24 AM;mrahman;URL_Decoding_issue_in_HTTPTransformation_10050.fixpack;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/195202,10/Apr/23 12:48 PM;ug:14b3bc06-75b9-4ef6-9f48-405affebd15a;pdweb-10.0.5.0_withfix-andparameter.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/195253,04/Apr/23 4:10 PM;ug:14b3bc06-75b9-4ef6-9f48-405affebd15a;pdweb_10040.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/194035,04/Apr/23 4:10 PM;ug:14b3bc06-75b9-4ef6-9f48-405affebd15a;pdweb_10050.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/194036,,,,,,,,,,,,IJ46365,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS012415861,TS012513689",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Virag Patel,5b17571a82e05b22cc7d5d9e,,,,"DEFENCE SCIENCE & TECHNOLOGY, MINISTRY OF FINANCE (THE ACCOUNT-GENERAL'S OFFICE)",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-04-15T04:02:58.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"v10.0.4 traces available at: 
/ecurep/sf/TS012/415/TS012415861/2023-03-29/isva1004/

v10.0.5 traces available at:
/ecurep/sf/TS012/415/TS012415861/2023-03-29/isva1005/",,,,,,,,,,,,,,,,,,,,,,,0|i1a5q7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-03 02:55:50.867,,,,,"03/Apr/23 2:50 AM;5b17571a82e05b22cc7d5d9e;Collected below traces from both version

* pdweb.debug
* pdweb.http.trasnformation
* pdweb 

*v10.0.5 reproduction done at*

2023-03-29-08:42:09.755+00:00I----- thread(22) 

*v10.0.4 reproduction done at*

2023-03-29-08:15:17.569+00:00I----- thread(14)","03/Apr/23 3:13 AM;5b17571a82e05b22cc7d5d9e;Noticed that with v10.0.5

pdweb debug shows response from backend as

{noformat}2023-03-29-08:42:09.755+00:00I----- thread(22) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- PD <=== BackEnd -----------------
Thread 22; fd 258; local 100.64.83.56:33218; remote 100.64.84.10:9443
HTTP/1.1 302 Found
connection: close
content-language: en-US
content-length: 0
date: Wed, 29 Mar 2023 08:42:09 GMT
location: https://alb-cp-websphere-dev.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize%3Fredirect_uri%3Dhttps%253A%252F%252Fesvc.sgsingpass.com%252Fisam%252Fsps%252Foidc%252Frp%252FOIDC20_1FA%252Fredirect%252Fdevcorppass%26response_type%3Dcode%26state%3DqKMgL1W1EZ%26scope%3Dopenid%26client_id%3DM6v0qhxOfRyO5I5ulvdQ%26esrvcID%3DM6v0qhxOfRyO5I5ulvdQ&TAM_OP=login{noformat}

and the pdweb.httptransformation shows as

{noformat}2023-03-29-08:42:09.756+00:00I----- thread(22) trace.pdweb.http.transformation:9 /build/isam/src/i4w/pdweb/webseald/http/transformation/xslt/XMLHTTPMessage.cpp:88: ENTER XMLHTTPMessage::doHeaders Adding header Name = location, Value = https://alb-cp-websphere-dev.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=/mga/sps/oauth/oauth20/authorize?redirect_uri=https%3A%2F%2Fesvc.sgsingpass.com%2Fisam%2Fsps%2Foidc%2Frp%2FOIDC20_1FA%2Fredirect%2Fdevcorppass&response_type=code&state=qKMgL1W1EZ&scope=openid&client_id=M6v0qhxOfRyO5I5ulvdQ&esrvcID=M6v0qhxOfRyO5I5ulvdQ&TAM_OP=login{noformat}

so URL macro is in decoded form even before the actual execution of the logic implemented in the rule file","03/Apr/23 3:16 AM;5b17571a82e05b22cc7d5d9e;Noticed that with v10.0.4
pdweb debug shows response from backend as


{noformat}2023-03-29-08:15:17.569+00:00I----- thread(14) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- PD <=== BackEnd -----------------
Thread 14; fd 258; local 100.64.82.25:36476; remote 100.64.84.10:9443
HTTP/1.1 302 Found
connection: close
content-language: en-US
content-length: 0
date: Wed, 29 Mar 2023 08:15:17 GMT
location: https://alb-cp-websphere-dev.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize%3Fredirect_uri%3Dhttps%253A%252F%252Fesvc.sgsingpass.com%252Fisam%252Fsps%252Foidc%252Frp%252FOIDC20_1FA%252Fredirect%252Fdevcorppass%26response_type%3Dcode%26state%3DTGyrpiIIRj%26scope%3Dopenid%26client_id%3DM6v0qhxOfRyO5I5ulvdQ%26esrvcID%3DM6v0qhxOfRyO5I5ulvdQ&TAM_OP=login{noformat}

and the pdweb.httptransformation shows as

{noformat}2023-03-29-08:15:17.569+00:00I----- thread(14) trace.pdweb.http.transformation:9 /build/isam/src/i4w/pdweb/webseald/http/transformation/xslt/XMLHTTPMessage.cpp:79: ENTER XMLHTTPMessage::doHeaders Adding header Name = location, Value = https://alb-cp-websphere-dev.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize%3Fredirect_uri%3Dhttps%253A%252F%252Fesvc.sgsingpass.com%252Fisam%252Fsps%252Foidc%252Frp%252FOIDC20_1FA%252Fredirect%252Fdevcorppass%26response_type%3Dcode%26state%3DTGyrpiIIRj%26scope%3Dopenid%26client_id%3DM6v0qhxOfRyO5I5ulvdQ%26esrvcID%3DM6v0qhxOfRyO5I5ulvdQ&TAM_OP=login{noformat}","03/Apr/23 3:23 AM;5b17571a82e05b22cc7d5d9e;IBM Support file and http transformation rules are located in different directory:
S:\sf\TS012\415\TS012415861\2023-03-27\","03/Apr/23 12:55 PM;605c0c04b18de50071046740;I have another customer with same issue case# TS012513689 .
XMLHTTPResponse created by Webseal even before the transformation is applied is showing decoded location parameter in 10.0.5.0.


10.0.4.0

snoop
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-31%2F&filepath=TS012513689%2F2023-03-31%2F10-0-4-pdweb.out|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-31%2F&filepath=TS012513689%2F2023-03-31%2F10-0-4-pdweb.out]

{noformat}(150) 2023-03-31-07:16:42.725 BackEnd (10.189.8.36:9443) to WebSEAL (10.189.6.200:34778) sending 1679 bytes
HTTP/1.1 302 Found
location: https://alb-cp-websphere-stg.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize%3Fresponse_type%3Dcode%26scope%3Dopenid%26client_id%3DIuxE9FFBE4cQUtEPPMVG%26nonce%3Dx4ClxVQbeSONVmK9yvA%26state%3DIyX5Jf1NHCAAYyZ9DkuuQe3Kr-6nnApptjkB2Lg2oi8%26redirect_uri%3Dhttps%3A%2F%2Fcorppass-sit.ssg-wsg.gov.sg%2FOIDCcallback%26esrvcID%3DIuxE9FFBE4cQUtEPPMVG&TAM_OP=login{noformat}

http transformation log
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-31%2F&filepath=TS012513689%2F2023-03-31%2F10-0-4-transformation.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-31%2F&filepath=TS012513689%2F2023-03-31%2F10-0-4-transformation.log]

{noformat}2023-03-31-07:16:42.725+00:00I----- thread(150) trace.pdweb.http.transformation:9 /build/isam/src/i4w/pdweb/webseald/http/transformation/xslt/XMLHTTPResponse.cpp:131: XMLHTTPResponse::import constructed XMLHTTPResponse: <?xml version=""1.0"" encoding='UTF-8'?><HTTPResponse><Credential><Attributes></Attributes></Credential><ResponseLine><Version>HTTP/1.1</Version><StatusCode>302</StatusCode><Reason>Found</Reason></ResponseLine><Headers><Header name=""content-language"">en-US</Header><Header name=""content-length"">0</Header><Header name=""date"">Fri, 31 Mar 2023 07:16:42 GMT</Header><Header name=""location""><https://alb-cp-websphere-stg.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize%3Fresponse_type%3Dcode%26scope%3Dopenid%26client_id%3DIuxE9FFBE4cQUtEPPMVG%26nonce%3Dx4ClxVQbeSONVmK9yvA%26state%3DIyX5Jf1NHCAAYyZ9DkuuQe3Kr-6nnApptjkB2Lg2oi8%26redirect_uri%3Dhttps%3A%2F%2Fcorppass-sit.ssg-wsg.gov.sg%2FOIDCcallback%26esrvcID%3DIuxE9FFBE4cQUtEPPMVG&TAM_OP=login</Header>>{noformat}

10.0.5.0

snoop
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-31%2F&filepath=TS012513689%2F2023-03-31%2F10-0-5-pdweb.out|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-31%2F&filepath=TS012513689%2F2023-03-31%2F10-0-5-pdweb.out]

{noformat}(28) 2023-03-31-09:25:00.869 BackEnd (100.64.84.30:9443) to WebSEAL (100.64.82.6:44522) sending 1497 bytes
HTTP/1.1 302 Found
location: https://alb-cp-websphere-dev.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize%3Fredirect_uri%3Dhttps%253A%252F%252Fesvc.sgsingpass.com%252Fisam%252Fsps%252Foidc%252Frp%252FOIDC20_1FA%252Fredirect%252Fdevcorppass%26response_type%3Dcode%26state%3Dz7l5fzilSB%26scope%3Dopenid%26client_id%3DM6v0qhxOfRyO5I5ulvdQ%26esrvcID%3DM6v0qhxOfRyO5I5ulvdQ&TAM_OP=login{noformat}

http transformation log
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-31%2F&filepath=TS012513689%2F2023-03-31%2F10-0-5-transformation.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-31%2F&filepath=TS012513689%2F2023-03-31%2F10-0-5-transformation.log]

{noformat}2023-03-31-09:25:00.869+00:00I----- thread(28) trace.pdweb.http.transformation:9 /build/isam/src/i4w/pdweb/webseald/http/transformation/xslt/XMLHTTPResponse.cpp:131: XMLHTTPResponse::import constructed XMLHTTPResponse: <?xml version=""1.0"" encoding='UTF-8'?><HTTPResponse><Credential><Attributes></Attributes></Credential><ResponseLine><Version>HTTP/1.1</Version><StatusCode>302</StatusCode><Reason>Found</Reason></ResponseLine><Headers><Header name=""content-language"">en-US</Header><Header name=""content-length"">0</Header><Header name=""date"">Fri, 31 Mar 2023 09:25:00 GMT</Header><Header name=""location""><https://alb-cp-websphere-dev.spcp.gov.sg:9443/cpauth/login/eservlogin?URL=/mga/sps/oauth/oauth20/authorize?redirect_uri=https%3A%2F%2Fesvc.sgsingpass.com%2Fisam%2Fsps%2Foidc%2Frp%2FOIDC20_1FA%2Fredirect%2Fdevcorppass&response_type=code&state=z7l5fzilSB&scope=openid&client_id=M6v0qhxOfRyO5I5ulvdQ&esrvcID=M6v0qhxOfRyO5I5ulvdQ&TAM_OP=login</Header>>{noformat}","04/Apr/23 12:34 AM;5b15d9e581c3df12acf53c4a;Before I  start digging into it, can you clarify few points here:



a) It seems to be only a url encoding issue  i.e. in

ISVA 10.0.4.0. an URL of the form

URL=*%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize*

is getting decoded  correctly,  in 10.0.5..0  to 

URL=*/mga/sps/oauth/oauth20/authorize*

but, decoding was NOT done in 10.0.4.0 and url as sent as it was undecoded i.e.

URL=*%2Fmga%2Fsps%2Foauth%2Foauth20%2Fauthorize*

is that correct?

b)

If above is correct,  can you look into 10.0.5.0 README and see is there any APAR that modified that behavior and probably there is an config option there? 

There must be an APAR that changed the behavior, please see whether you can identify that APAR or not…..

c)

Is the issue happening all the time or is it for a specific case?

A quick look at the traces seems to indicate that some case, RP is sending encoded URL to browser?

Any idea why?



Also, traces does not have conf file so I can not do a quick config option related digging,  traces with config file is really helpful, remember webseal has thousand and one option, it is very difficult sometimes to correlate all traces/logs without config gile

d)

Worst case, is there a simple way to reproduce it? if so, can you provide the steps please?

e)

You want to try the following to root out any know issues related to URL macro

There is a change in 10.0.5.0 regarding dealing with URL macro compare to prior to 10.0.5.0 release 

Please set the following:

[server]

allow-url-macro-to-be-relative = true



f)

Please do provide full trace i.e. “pdweb”

this will capture everything including source code lines etc, that way it is easier to see where or possibly which function is modifying the url………



g)

Is there any differences in config file in 10.0.40 and 10.0.5.0?

There could be an option which is different betweenn these two installations??","04/Apr/23 4:10 PM;605c0c04b18de50071046740;Hi,
This happens only when HTTP transformation to modify the location header(sent from backend to webseal) is triggered.The location header being sent from backend to Webseal is not decoded and sent to client in 10040 while it is decoded in 10050 and sent to client after http transformation.So Customer is facing issues due to this behaviour in 10050.

I used same rule from customer and modified the host port mappings as per my env.

I recreated the issue and attaching the pdweb logs as asked.

the constructed XMLHTTPResponse even before the xsl is applied is different in 10040 and 10050.
In the snoop it is visible that backend is sending encoded values in response to webseal in both cases.

constructed XMLHTTPResponse 10040

{noformat}<Header name=""location""><https://www.mmfa.com/testxsl/login/eservlogin?ABC=https%3A%2F%2Fwww.mmfa.com%2Ftestxsl%2Fass%3Fredirect_uri%3Dhttp%3A%2F%2Fesvc.sgsingpass.com%2Fisam%2Fsps%2Foidc%2Frp%2FOIDC20_1FA%2Fredirect%2Fstgcorppass%26response_type%3Dcode%26state%3DWyE4kcJTF0%26scope%3Dopenid%26client_id%3DCHZJT55E1qfs3Zj8K2dt&success</Header>>{noformat}

constructed XMLHTTPResponse 10050

{noformat}<Header name=""location""><https://www.mmfa.com/testxsl/login/eservlogin?ABC=https://www.mmfa.com/testxsl/ass?redirect_uri=http://esvc.sgsingpass.com/isam/sps/oidc/rp/OIDC20_1FA/redirect/stgcorppass&response_type=code&state=WyE4kcJTF0&scope=openid&client_id=CHZJT55E1qfs3Zj8K2dt&success</Header>>{noformat}


steps to recreate the issue.

# create new webseal instance.
# create transparent path junction(/testxsl in my case) to backend.Backend should send 302 response and location header with encoded values when accessed.
# attach unauth acl to junction.just so that login is not needed.
# configure http transformation to modify response for that junction.

you can use below rule. just modify the host port as per your env.

updatelocationheader.xsl

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-27%2Fisva_10.0.4.0_20230327-012658_ndi-cp-wrp-isam-config-6b646cdbb5-86t8j.support_unpack%2Fvar%2Fpdweb%2Fshared%2Fxslt%2Fhttp-transformation%2F&filepath=TS012513689%2F2023-03-27%2Fisva_10.0.4.0_20230327-012658_ndi-cp-wrp-isam-config-6b646cdbb5-86t8j.support_unpack%2Fvar%2Fpdweb%2Fshared%2Fxslt%2Fhttp-transformation%2Fupdatelocationheader.xsl|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F2023-03-27%2Fisva_10.0.4.0_20230327-012658_ndi-cp-wrp-isam-config-6b646cdbb5-86t8j.support_unpack%2Fvar%2Fpdweb%2Fshared%2Fxslt%2Fhttp-transformation%2F&filepath=TS012513689%2F2023-03-27%2Fisva_10.0.4.0_20230327-012658_ndi-cp-wrp-isam-config-6b646cdbb5-86t8j.support_unpack%2Fvar%2Fpdweb%2Fshared%2Fxslt%2Fhttp-transformation%2Fupdatelocationheader.xsl]

[http-transformations:updatelocationheader]
request-match = response:GET /testxsl/*

Once the HTTP transformation is triggered the issue is recreated.

links to support file  from customer environment.
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F0-all_data%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012513689&path=TS012513689%2F0-all_data%2F]","07/Apr/23 3:30 AM;5b15d9e581c3df12acf53c4a;I need to do some more investigation…..amazingly, cannot see any relevant code change that might cause this issue…..still looking","07/Apr/23 3:35 AM;5b15d9e581c3df12acf53c4a;OK,  I found some changes, let me do some more digging and I will update soon………","08/Apr/23 5:24 AM;5b15d9e581c3df12acf53c4a;[~accountid:605c0c04b18de50071046740] 

Can you please do a quick test in your reproduction box with this fixpack and let me know the  result?

It is for 10.0.5.0 GA

Name: URL_Decoding_issue_in_HTTPTransformation_10050.fixpack

[^URL_Decoding_issue_in_HTTPTransformation_10050.fixpack]

Use the following config option in your  test:

[server]

disallow-url-decoding-in-httptransformation = yes



Default value is no/false","10/Apr/23 12:48 PM;605c0c04b18de50071046740;[~accountid:5b15d9e581c3df12acf53c4a] ,
I tested the fix on 10.0.5.0. It seems to be working.
attaching the pdweb log

constructed XMLHTTPResponse 10050 + fix and webseal config.

{noformat}<Header name=""location""><http://www.mmfa.com/testxsl/login/eservlogin?ABC=https%3A%2F%2Fwww.mmfa.com%2Ftestxsl%2Fass%3Fredirect_uri%3Dhttp%3A%2F%2Fesvc.sgsingpass.com%2Fisam%2Fsps%2Foidc%2Frp%2FOIDC20_1FA%2Fredirect%2Fstgcorppass%26response_type%3Dcode%26state%3DWyE4kcJTF0%26scope%3Dopenid%26client_id%3DCHZJT55E1qfs3Zj8K2dt&success</Header>>{noformat}


Let me know if this can be shared with customer.","10/Apr/23 9:49 PM;5b15d9e581c3df12acf53c4a;[~accountid:605c0c04b18de50071046740] Good to hear tat it worked.

Yes, it can be shared with the customer.

Please do open an APAR.","11/Apr/23 1:27 AM;5b17571a82e05b22cc7d5d9e;APAR IJ46365 is created

reverse proxy does not process location header with encoded URL from backend server correctly","13/Apr/23 4:47 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5b50f89981017455b684b631c4e40781afe4fc2b
   * description: ISAMSUP-4941 Provide backward compatibility option for not decoding headers in httptransformation

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/91290.


This build has not been published as the commit is not currently within a branch (ISMSUP-4941) which we publish.","13/Apr/23 4:48 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has failed for the following commit: 
   * id: 89cd3c2a4f7a6459feeaa38e62612ee7c973f043
   * description: Merge pull request #5832 from ISAM/ISMSUP-4941

ISAMSUP-4941 Provide backward compatibility option for not decoding h…

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/92781.

","15/Apr/23 4:01 AM;5b15d9e581c3df12acf53c4a;will be fixed in 10.0.6.0

Let me know  customer feedback on the fixpack","15/Apr/23 4:14 PM;5b17571a82e05b22cc7d5d9e;[~accountid:605c0c04b18de50071046740] any update from your customer.

my customer closed the case as he moved to different project",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Certificate database troubles with GSKit Close Notfy Fix,ISAMSUP-4931,291221,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,David Hayes,5b232b2fd85e5b59b066f57f,Kenji Seta,5b209ff1a56d9112a2a6f638,Kenji Seta,5b209ff1a56d9112a2a6f638,29/Mar/23 4:07 PM,24/May/23 10:41 AM,14/Jul/23 2:47 PM,22/May/23 12:29 PM,,,,0,,,,"The customer started to verify following fixpack.

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4650|https://cloudidentity.atlassian.net/browse/ISAMSUP-4650|smart-link] 

The original issue was resolved but there are several side effects after fixpack applied.

1 Cannot create certificate database.

  On “SSL Certificates” page on LMI, create new certificate database (e.g. dummy)

!image-20230329-054120.png|width=558,height=130!

2 Failed to renew LMI server certificate

  On CLI, renew LMI server certificate

{noformat}ksisam10.battle.mil:lmi> reset_lmi_cert 
Enter 'YES' to confirm: YES

An invalid password was provided, the key database has been corrupted or it is of the wrong type. Expected database type: CMS

Ensure that the database is of the correct type and that the correct password was given.
chmod: /opt/IBM/wlp/usr/servers/default/certs/lmi.jks: No such file or directory{noformat}

3 Failed to deploy changes after changing password for LMI user by RESTAPI (customer’s case)



These are caused that gskit generates newer version of CMS database. The ikeycmd cannot handle newer version.

After fixpack installed.

{noformat}# gsk8capicmd_64 -keydb -create -db a.db -pw password -stash
# gsk8capicmd_64 -keydb -list -db a.db -stashed
Currently supported key database types:
  cms
  pkcs11
  pkcs12
  csp
  pkcs7

KDB file format is CMS version 6
hdmac:
    57 8C 09 5E 59 81 8B 50 B9 87 62 42 C3 2A 5A 4C
    56 49 84 88 22 BE B8 D3 FC 80 3C 0B 0E 2A AB D6
    14 00 FB 6B D3 4A B3 5D 00 00 00 00 00 00 00 00
dbmac:
    F0 91 92 AC 5B 7F 00 00 00 00 00 00 00 00 00 00
    70 D6 AE 01 00 00 00 00 00 00 00 00 00 00 00 00
    01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
KDB password does not expire.

Record count 0, Record size 5000
Expected KDB file size is 144 bytes
Actual KDB file size is 144 bytes.
File size is as expected, good.

# ls -la a.*
-rw-------    1 root     root           144 Mar 29 14:46 a.crl
-rw-------    1 root     root           144 Mar 29 14:46 a.db
-rw-------    1 root     root           144 Mar 29 14:46 a.rdb
-rw-------    1 root     root           193 Mar 29 14:46 a.sth{noformat}

With this key db, ikeyman command is failed.

{noformat}# /usr/lib/jvm/ibm-jre/bin/ikeycmd -keydb -convert -db a.db -stashed -target a.jks -new_fo
rmat jks

An invalid password was provided, the key database has been corrupted or it is of the wrong type. Expected database type: CMS

Ensure that the database is of the correct type and that the correct password was given.
chmod: /opt/IBM/wlp/usr/servers/default/certs/lmi.jks: No such file or directory{noformat}



Following are same operation after fixpack uninstalled

{noformat}# gsk8capicmd_64 -keydb -create -db a.db -pw password -stash
# gsk8capicmd_64 -keydb -list -db a.db -stashed
Currently supported key database types:
  cms
  pkcs11
  pkcs12
  csp
  pkcs7

KDB file format is CMS version 4
hdmac:
    5F 52 5D FB AC AA 30 96 5E 81 06 0E 08 51 B0 C7
    0C 9F 3E 41
dbmac:
    EA 5B 2D B5 BF AF 05 3B 2E 27 4F 1D BD EC 9F 96
    81 A3 51 5F
KDB password does not expire.

Record count 0, Record size 5000
Expected KDB file size is 88 bytes
Actual KDB file size is 88 bytes.
File size is as expected, good.

# ls -la a.*
-rw-------    1 root     root            88 Mar 29 14:56 a.crl
-rw-------    1 root     root            88 Mar 29 14:56 a.db
-rw-------    1 root     root            88 Mar 29 14:56 a.rdb
-rw-------    1 root     root           193 Mar 29 14:56 a.sth
# /usr/lib/jvm/ibm-jre/bin/ikeycmd -keydb -convert -db a.db -stashed -target a.jks -new_fo
rmat jks
{noformat}",,David Hayes,khansen,Nick Lloyd,prashant_kamat,Tushar Prasad,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4447,ISAMSUP-4650,,,ISAMSUP-4968,,29/Mar/23 4:07 PM;seta;image-20230329-054120.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193144,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012556074,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Kenji Seta,5b209ff1a56d9112a2a6f638,,,,"HONDA MOTOR CO., LTD.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a2of:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-04-03 02:39:38.415,,,,,29/Mar/23 4:08 PM;5b209ff1a56d9112a2a6f638;[https://cloudidentity.atlassian.net/browse/ISAMSUP-4447|https://cloudidentity.atlassian.net/browse/ISAMSUP-4447|smart-link] ,"03/Apr/23 12:39 PM;5b232b2fd85e5b59b066f57f;Hi Kenji. There was always a risk of hitting issues given the version of GSKit shipped in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4650|https://cloudidentity.atlassian.net/browse/ISAMSUP-4650|smart-link]  (8.0.55.31) is beyond what is contained in currently published ISVA releases - so an ISVA with this version of GSKit hasn’t gone through a full development / test cycle. 

I’ve done some investigating, and apparently this version of GSKit introduced stronger default encryption which may cause issues with the version of Java running on the Appliance. I’m looking into what can be done.",07/Apr/23 10:25 AM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b232b2fd85e5b59b066f57f] are there any progress?,11/Apr/23 11:22 AM;5b232b2fd85e5b59b066f57f;I’m currently evaluating whether the code changes required for this version of GSKit can be backported all the way back to 10.0.1.,"19/Apr/23 10:21 AM;5b209ff1a56d9112a2a6f638;Hi L3, could you please let customer know current status?",26/Apr/23 11:32 AM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b232b2fd85e5b59b066f57f] are there any updates which we can provide customer?,"26/Apr/23 1:53 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:5b209ff1a56d9112a2a6f638] - I have attempted to backport and have been working on a test fix but have had several issues which I am still working through. At this stage, I don’t have a fix-pack for the customer to try and as mentioned earlier, it may end up being the case that we can’t backport the dependencies to 10.0.1. I’m still trying and will give you an update end of week. ","27/Apr/23 1:45 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b209ff1a56d9112a2a6f638] - new fix-pack available at [https://cloudidentity.atlassian.net/browse/ISAMSUP-4968|https://cloudidentity.atlassian.net/browse/ISAMSUP-4968|smart-link]

This appears to resolve the issue reported by the customer. Please confirm in your lab environment before passing on to customer. 

Please note that due to the dependencies involved with backporting this and the limited testing available when using personal fix-packs, there may be other unforeseen issues. Also note this fix-pack is only for 10.0.1.0_GA","01/May/23 3:32 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b232b2fd85e5b59b066f57f] thank you for providing new testfix. I am executing small test for certificate database operation.

When I create self-signed certificate (New button on Personal Certificates tab), it took 2 minutes. (without fixpack, it finished immediately) 

I completed following tests now.

||*SSL Certificates*|| ||
|Create Key DB|OK|
|Export Key DB|OK|
|Import Key DB|OK|
|Import CA cert|OK|
|Load CA cert|OK|
|Create self-signed cert|OK - long time (2m)|
|Import personal cert|OK|
|Export personal cert|OK|
|Extract personal cert|OK|","08/May/23 11:05 AM;5b209ff1a56d9112a2a6f638;I am sorry, forgot to change response due. corrected.",08/May/23 11:45 AM;5b232b2fd85e5b59b066f57f;Hi [~accountid:5b209ff1a56d9112a2a6f638] - I see the same in my lab environment. I’m doing some tests to try and understand why it takes so long to create a self-signed cert - will let you know what I find. ,"08/May/23 3:14 PM;5b232b2fd85e5b59b066f57f;For my reference - conversion to jks is failing: 

{noformat}May  8 01:25:15 mesa_config[20501]: Debug: /bin/gsk8capicmd_64 -cert -export -db /var/isam.staging/admin/pdweb/shared/keytab/pdsrv.kdb -stashed -label test2 -target /tmp/tmp.pJPA8k
...
May  8 01:27:15 mesa_config[20501]: Error: DPWAP0003I   An error occurred while executing the command: /usr/lib/jvm/jre-1.7.0-ibm.x86_64/bin/ikeycmd -cert -import -db /tmp/tmp.pJPA8k -label test2 -new_label test2 -target /var/isam.staging/admin/pdweb/shared/keytab/jks/pdsrv.jks -target_pw V8DXkNTjjMmDvGd3PZejlciqM1cazsbS (0xffffffff)
...{noformat}

Manually running the command results in a pw prompt - I suspect we are timing out on this: 

{noformat}# /usr/lib/jvm/jre-1.7.0-ibm.x86_64/bin/ikeycmd -cert -import -db /tmp/tmp.pJPA8k -label test2 -new_label test2 -target /var/isam.staging/admin/pdweb/shared/keytab/jks/pdsrv.jks -target_pw V8DXkNTjjMmDvGd3PZejlciqM1cazsbS
A password is required to access the source key database.
Please enter a password:{noformat}

src/i4w/pdweb/wapi/api/wapikdb.cpp","08/May/23 4:21 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b209ff1a56d9112a2a6f638] - there are some incompatibilities with the newer versions of GSKit (which resolve the close-notify issue) and how keystores are managed in old ISVA versions (i.e. 10.0.1). These incompatibilities are resulting in the slow cert operations (due to the conversion to JKS failing) - and possibly other issues we haven’t yet identified. Looking at the code and dependencies, I don’t believe it will be possible to fully integrate newer GSKit with ISVA v10.0.1. 

Is this environment purely a WebSEAL / RP environment - or does it also run AAC / FED? If it is purely WebSEAL / RP, the failure to covert to jks should not really have any impact (other than the slow creation and import of certs) since WebSEAL / RP does not use the jks certs. ","12/May/23 4:13 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b232b2fd85e5b59b066f57f] The customer uses/will use federation and AAC.
Will the gskit fix (close_notify with warning alert) be included in next release of ISVA appliance?

If so, we can explain customer that the work around is available in next release and request them to upgrade.",15/May/23 12:29 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b209ff1a56d9112a2a6f638] - yes - it will be in 10.0.6,24/May/23 10:41 AM;5b209ff1a56d9112a2a6f638;[~accountid:5b232b2fd85e5b59b066f57f] customer asks us how gskit behavior change will be written in release notes of 10.0.6. Will this change be recorded in release notes?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Need fixpack_hostentry_xxxx for 10.0.3.1,ISAMSUP-4893,288118,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,David Hayes,5b232b2fd85e5b59b066f57f,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,17/Mar/23 10:32 PM,12/Apr/23 12:24 AM,14/Jul/23 2:47 PM,12/Apr/23 12:23 AM,,Support,21/Mar/23 12:00 AM,0,,,,"AT&T is seeing the issue resolved in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4293|https://cloudidentity.atlassian.net/browse/ISAMSUP-4293|smart-link] on a 10.0.3.1 environment.  They say this this happened after upgrading a system from 9.0.7.0.  

It appears that AT&T is the only customer who has hit this issue.

The support file for 10.0.3.1 shows that the client has two other fixpacks installed: 

Saturday, December 17, 2022 at 12:39:17 AM|URL_macro_is_not_server_relative_10031|URL_macro_is_not_server_relative_10031|Yes|Installed|URL in macro is not relative in 10.0.3.1|1671237557
Saturday, December 17, 2022 at 12:39:44 AM|SERVER_STATUS_FIX|Server_Status_Fix|Yes|Installed|This fixpack corrects a problem with Liberty server status command not executing correctly.|1671237584

They are concerned that they may see this on other 10.0.3.1 systems. It would be preferable for them to have a fixpack that could be installed on any 10.0.3.1 system.  I realize that this might not be possible if the fixpack rebuilds host data based on current values. ",,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4896,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012462872,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,AT&T Services Inc,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,/ecurep/sf/TS012/462/TS012462872/2023-03-16/isva_10.0.3.1_20230316-205324_zlty29270.vci.att.com.support_unpack,,,,,,,,,,,,,,,,,,,,,,,0|i19ixj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-17 14:52:16.418,,,,,"18/Mar/23 12:52 AM;5b15d94b6256d01ad54eb020;I took a look at that fixpack and it looks like a one off fix pack for ATT.  It adds 9 host entries to the hosts  file.  



We can build a new one for 10.0.3.1  but the question is, do they need that exact same set of hosts  ( names / ip addresses )?","18/Mar/23 2:04 AM;5c87cb8d88f9ec6ae0afb306;Hi Bill, 

I’d build the fixpack based off the ./etc/policies/cml/common/hosts/hosts3_0_0.xml file.  

I did check the host file in the fixpack against the host file in ./etc/policies/cml/common/hosts/hosts3_0_0.xml.  They appear to be the same, so it looks like these might be a consistent set of host entries. 

If they need another list of hosts for a different appliance, they can request another fixpack, or they could use the fixpack that you provide and manually change the hosts after applying the fixpack. 

Thanks!
Gary",20/Mar/23 8:19 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] this one might be something that can be provided fairly quickly. I am wondering why AT&T need a fix pack to update their host file though? ,"20/Mar/23 12:21 PM;5b232b2fd85e5b59b066f57f;[~accountid:5c87cb8d88f9ec6ae0afb306] - fix-pack available here: [https://cloudidentity.atlassian.net/browse/ISAMSUP-4896|https://cloudidentity.atlassian.net/browse/ISAMSUP-4896|smart-link]  . Note that as per the 9.0.7.2 fix-pack, this will effectively reset the /etc/hosts file; the customer will need to subsequently re-enter their host information. ",20/Mar/23 10:54 PM;5c87cb8d88f9ec6ae0afb306;Sent Fixpack to Client. ,"21/Mar/23 12:59 AM;5c87cb8d88f9ec6ae0afb306;@tonyferg

There is some issue specific to the AT&T environment.  


The following entry gets removed: 
 <host addr=""127.0.0.1"">
        <hostnames name=""localhost""/>

The LMI doesn’t allow them to re-add that value, thus the fixpack.  

So far, they have seen it on 2 of their environments.  No other customer has seen this issue, so it must be specific to something that AT&T is doing.  

It could be human error on their part, or something that one of their many ansible scripts is doing. ","21/Mar/23 10:49 AM;5b232b2fd85e5b59b066f57f;I think the actual issue here is that we don’t allow for duplicate hostnames to be set through the LMI. I suspect this is legacy behaviour from pre IPv6 support. Given that ISVA now also supports IPv6, the duplicate hostname check should ideally be modified to allow duplicates across the different address protocols but still maintain uniqueness within each individual protocol - i.e. it should be possible to specify a single IPv4 mapping and a single IPv6 mapping per hostname through the LMI as this is now supported at a lower level. However, given this has only affected AT&T (I suspect one of their automated scripts may be unintentionally deleting the localhost mapping) and we have a valid work around in the fix-pack, at this stage I don’t think investment in changing the behaviour to allow duplicate entries is justified. ",12/Apr/23 12:24 AM;5b15d901fa615349cb01778b;case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
IJ22570 missing from 10.0.x - Bind Password Being Overwritten,ISAMSUP-4879,287425,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,14/Mar/23 11:59 PM,26/Jun/23 11:37 AM,14/Jul/23 2:47 PM,26/Jun/23 11:37 AM,10.0.7,,,0,,,,"Seeing behavior described in: 
[https://www.ibm.com/support/pages/apar/IJ22570|https://www.ibm.com/support/pages/apar/IJ22570|smart-link] 



The client is seeing this behavior in 10.0.3.0 and 10.0.4.0.  I am seeing this in 10.0.5.0 (Docker).  


The “Remote Management Authentication” password is working fine until a reboot.  Then a ****** is used, resulting in a bind failure.  This requires you to set the password again.

I can recreate this locally in 10.0.5.0 using Docker.  

I will update the ldap_debug log later.  I will need to recreate again.  ",,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,15/Mar/23 12:37 AM;gvacek;ldap_debug.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190050,,,,,,,,,,,,,,,IJ46740,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012427140,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,US Dept of Homeland Security,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2023-06-17T08:56:16.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":5,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19er3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-17 02:59:36.785,,,,,"15/Mar/23 12:41 AM;5c87cb8d88f9ec6ae0afb306;I was able to recreate the issue.  It didn’t seem tied to the “save” button, but when I enabled “user mapping”.  

Before that, I was able to restart the container and the bind credentials worked.

But, when I enabled “user mapping”, the LMI restarted and the bind credentials were wrong.

The actual password is ‘bighulk99’.  The trace shows the working case where ‘bighulk99' is used and the non-working cases where '********' is used.  

","17/Mar/23 3:37 AM;5c87cb8d88f9ec6ae0afb306;Hi Bhavan, 
The customer is asking for an update.  I told them that we were investigating.    Do you have an update?","17/Mar/23 12:59 PM;5b15d954b0d76456f36daf33;I still think what I said in the original item holds → if you are modifying something in that page, it is not unreasonable to expect that you know the bind password and supply it.

This is very similar to what we do elsewhere in the LMI (eg:  Web → Runtime → Federated Directories)

I’m not really sure about the reboot part of the issue, which seems new in this case. I’ll have a closer look at that.","30/Mar/23 10:09 PM;5c87cb8d88f9ec6ae0afb306;Hi Bhavan, 

Have you been able to look at this more?  Client is looking for an update. ","31/Mar/23 4:55 PM;5b15d954b0d76456f36daf33;Gary, no I haven’t investigated further. But if you have a recreate of the problem, it is reasonable to create an APAR.

From what you described it looks like policy translation on startup is causing the issue. And will likely be where any potential fix will be.","15/Apr/23 4:43 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d954b0d76456f36daf33] ,

Any update on this case? It’s been a few weeks and the customer is asking for an update.","17/Apr/23 3:54 PM;5b15d954b0d76456f36daf33;[~accountid:5bac25aaabfcbf73d13e733b] I’m still working on the root cause. Once I have an understanding of it, I’ll outline the next steps.",09/May/23 9:35 PM;5b232b2fd85e5b59b066f57f;@bkumar - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"10/May/23 2:15 PM;5b15d954b0d76456f36daf33;I don’t think a reboot or restart is required to see the problem.

Making any unrelated change on the Management Authentication page and deploying the changes saves the encrypted equivalent of ***** to the policy files.

Go ahead and create a new APAR.

In terms of a fix, best we can do is force the password field to be blank on any change and expect the admin to fill it in on Save. ",11/May/23 2:21 AM;5c87cb8d88f9ec6ae0afb306;APAR IJ46740 has been created for this issue. ,18/May/23 11:00 PM;5c87cb8d88f9ec6ae0afb306;Hi Bhavan.  Any update on when a fix will be available?,"23/May/23 2:45 PM;5b15d954b0d76456f36daf33;[~accountid:5c87cb8d88f9ec6ae0afb306] this might be touch and go for 10.0.6, but should be in the one after.

But if the customer needs something as a personal fix, we can consider that.","24/May/23 5:12 AM;5c87cb8d88f9ec6ae0afb306;Hi [~accountid:5b15d954b0d76456f36daf33] , 

I should have been more clear.  The client would like to get an iFix for 10.0.5.0.  

",26/May/23 1:52 PM;5b15d954b0d76456f36daf33;Personal fix should be fine. Just make sure they are at 10.0.5.0_IF1 because I’ll build this with that as the base.,13/Jun/23 12:18 PM;5b232b2fd85e5b59b066f57f;@bkumar - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"13/Jun/23 12:31 PM;5b15d954b0d76456f36daf33;Testing a potential fix. If it works, will make it available as a personal fix pack.","14/Jun/23 4:18 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 4fbb9f19af63a01bf53913545562e8150eb1286d
   * description: ISAMSUP-4879 Don't overwrite bind password if unchanged

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1312255.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4879) which we publish.","14/Jun/23 7:14 PM;5b15d954b0d76456f36daf33;[~accountid:5c87cb8d88f9ec6ae0afb306] linked item [https://cloudidentity.atlassian.net/browse/ISAMSUP-5139|https://cloudidentity.atlassian.net/browse/ISAMSUP-5139|smart-link] has a fixpack that should correct this behaviour.

It can be applied at 10.0.5.0 GA or IF1. On non-container versions it automatically restarts the LMI.

Can you have the customer try it?",15/Jun/23 1:42 AM;5c87cb8d88f9ec6ae0afb306;I have provided the fixpack to the client.  ,"15/Jun/23 10:49 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f549f68481b5ebba17dda16164caba86e7818888
   * description: Merge pull request #5985 from ISAM/ISAMSUP-4879

ISAMSUP-4879 Don't overwrite bind password if unchanged

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1360234.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230615004709-f549f684.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","15/Jun/23 12:04 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f549f68481b5ebba17dda16164caba86e7818888
   * description: Merge pull request #5985 from ISAM/ISAMSUP-4879

ISAMSUP-4879 Don't overwrite bind password if unchanged

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1361668.


This build has not been published as the commit is not currently within a branch (20230615004709-f549f684) which we publish.","16/Jun/23 8:59 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f549f68481b5ebba17dda16164caba86e7818888
   * description: Merge pull request #5985 from ISAM/ISAMSUP-4879

ISAMSUP-4879 Don't overwrite bind password if unchanged

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1360234.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230615225708-f549f684.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","16/Jun/23 10:18 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f549f68481b5ebba17dda16164caba86e7818888
   * description: Merge pull request #5985 from ISAM/ISAMSUP-4879

ISAMSUP-4879 Don't overwrite bind password if unchanged

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1411334.


This build has not been published as the commit is not currently within a branch (20230615225708-f549f684) which we publish.","17/Jun/23 8:56 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f549f68481b5ebba17dda16164caba86e7818888
   * description: Merge pull request #5985 from ISAM/ISAMSUP-4879

ISAMSUP-4879 Don't overwrite bind password if unchanged

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1454260.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230616225320-f549f684.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","17/Jun/23 10:13 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f549f68481b5ebba17dda16164caba86e7818888
   * description: Merge pull request #5985 from ISAM/ISAMSUP-4879

ISAMSUP-4879 Don't overwrite bind password if unchanged

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1456086.


This build has not been published as the commit is not currently within a branch (20230616225320-f549f684) which we publish.","22/Jun/23 12:12 PM;5b15d954b0d76456f36daf33;[~accountid:5c87cb8d88f9ec6ae0afb306] as far as the APAR and this item go, I’m done with both. Will wait for the customer’s feedback before closing.",26/Jun/23 11:37 AM;5b15d954b0d76456f36daf33;Case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Multiple tables missing from HVDB after upgrade to 10.0.4,ISAMSUP-4870,287237,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Carlos Rosales,5bb2c13f59e46d7be31a9e54,Carlos Rosales,5bb2c13f59e46d7be31a9e54,14/Mar/23 1:01 AM,08/Jun/23 1:39 AM,14/Jul/23 2:47 PM,08/Jun/23 1:39 AM,,,,0,,,,"Customer upgraded from 10.0.0.1 to 10.0.4, the customer is using internal Config and HVDB databases, after the upgrade multiple tables from the HVDB are missing, this is the customer HVDB schema



{noformat} Schema |              Name              | Type  |  Owner   |    Size    | Description
--------+--------------------------------+-------+----------+------------+-------------
 public | authenticators                 | table | www-data | 8192 bytes |
 public | crypto_auth_methods            | table | www-data | 8192 bytes |
 public | fido_attestation_certs         | table | www-data | 8192 bytes |
 public | fido_authenticators            | table | www-data | 8192 bytes |
 public | hvdb_schema_updates            | table | www-data | 8192 bytes |
 public | mmfa_auth_txn_ctx_attrs_data   | table | www-data | 8192 bytes |
 public | mmfa_auth_txn_ctx_attrs_data_v | table | www-data | 8192 bytes |
 public | mmfa_auth_txn_data             | table | www-data | 8192 bytes |
 public | mmfa_auth_txn_parameters_data  | table | www-data | 8192 bytes |
 public | oauth20_dynamic_client         | table | www-data | 8192 bytes |
 public | oauth_authenticators           | table | www-data | 0 bytes    |
 public | pwd_vault                      | table | www-data | 8192 bytes |
 public | registered_auth_methods        | table | www-data | 8192 bytes |
 public | scim_eas_ext_methods           | table | www-data | 0 bytes    |
 public | scim_eas_ext_users             | table | www-data | 0 bytes    |
 public | u2f_tokens                     | table | www-data | 8192 bytes |
(16 rows)

{noformat}



Compared to my lab HVDB schema 19 tables are missing which are:

alias_svc_aliasuserpartner   
auth_txn_obl_ctx_attrs_data  
auth_txn_obl_ctx_attrs_data_v
auth_txn_obl_data            
auth_txn_obl_parameters_data 
dmap_entries  

oauth20_token_cache          
oauth20_token_extra_attribute

oauth_scope                 
oauth_trusted_client        

rba_device                  
rba_device_fingerprint      
rba_rte_db_maintenance_meta
rba_user_attr_session       
rba_user_attr_session_data  
rba_user_device             
rba_user_usage_data         

user_attributes           
user_attributes_values        

and one table with different name db_schema_updates in my 10.0.4 lab and in customer environment is hvdb_schema_updates 

The Federation/AAC runtime logs show errors 

{noformat}[3/12/23, 12:19:09:281 EDT] 00000049 ategy.commands.StartTokenCleanupThreadCmd$TokenCleanupThread I org.postgresql.util.PSQLException: ERROR: relation ""oauth20_token_cache"" does not exist{noformat}

the var/messages log shows the upgrade completed successfully 

{noformat}Mar 12 12:15:03 iss-lum[9070]: id=update time=""2023-03-12 12:15:03"" fw=sam.winwholesale.com pri=6 op=install issueid=7000001 name=Update_Installation pkgid=XPU_WGA_FIRM_10_0_4_0 msg=""The update was successfully installed. The install log file is '/var/spool/updates/logs/XPU_WGA_FIRM_10_0_4_0_install_result_20230312-121503.log'"" 
Mar 12 12:15:03 iss-lum[9070]: msg=""Chain install(s) successfully completed."" {noformat}

var/postgresql/logs/hvdb/server/postgresql-Sun.log shows multiple error

{noformat}2023-03-12 16:18:32 GMT:www-dataERROR:  relation ""hvdb_schema_updates"" does not exist at character 32
2023-03-12 16:18:32 GMT:www-dataSTATEMENT:  SELECT COUNT(DSU_VERSION) FROM HVDB_SCHEMA_UPDATES
2023-03-12 16:18:32 GMT:www-dataERROR:  relation ""db_schema_updates"" does not exist at character 32
2023-03-12 16:18:32 GMT:www-dataSTATEMENT:  SELECT COUNT(DSU_VERSION) FROM DB_SCHEMA_UPDATES
2023-03-12 16:18:32 GMT:www-dataERROR:  relation ""hvdb_schema_updates"" does not exist at character 30
2023-03-12 16:18:32 GMT:www-dataSTATEMENT:  SELECT MAX(DSU_VERSION) FROM HVDB_SCHEMA_UPDATES
2023-03-12 16:18:32 GMT:www-dataWARNING:  there is no transaction in progress
2023-03-12 16:18:32 GMT:www-dataWARNING:  there is no transaction in progress
2023-03-12 16:18:32 GMT:www-dataWARNING:  there is no transaction in progress
2023-03-12 16:18:32 GMT:www-dataWARNING:  there is no transaction in progress
2023-03-12 16:18:32 GMT:www-dataWARNING:  there is no transaction in progress
2023-03-12 16:18:32 GMT:www-dataERROR:  relation ""oauth20_token_cache"" does not exist
2023-03-12 16:18:32 GMT:www-dataSTATEMENT:  CREATE INDEX OAUTH20CACHE_LIFETIME  ON OAUTH20_TOKEN_CACHE (LIFETIME ASC);
2023-03-12 16:18:32 GMT:www-dataERROR:  relation ""oauth20_token_cache"" does not exist
2023-03-12 16:18:32 GMT:www-dataSTATEMENT:  CREATE INDEX OAUTH20CACHE_UCID      ON OAUTH20_TOKEN_CACHE (USERNAME, CLIENT_ID);
2023-03-12 16:18:32 GMT:www-dataERROR:  relation ""oauth20_token_extra_attribute"" does not exist{noformat}



I think the customer will need a fixpack to create the tables on the HVDB database.",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012419030,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Carlos Rosales,5bb2c13f59e46d7be31a9e54,,,,WINWHOLESALE INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012419030&path=TS012419030%2F2023-03-13%2Fisva_10.0.4.0_20230313-091236_sam.winwholesale.com.support_unpack%2F,,,,,,,,,,,,,,,,,,,,,,,0|i19dm7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-13 17:55:30.624,,,,,14/Mar/23 3:55 AM;5b15d94b6256d01ad54eb020;I started to look into this. I  think most of those tables (if not all) should have been in the prior release.   Do they have a recent support file from before the upgrade?   I don’t know if we can simply create the tables.  There might been data in the prior release that is still needed.  If so we might be able to get it from the other partition.  I haven’t found any reason yet why the tables weren’t migrated.  ,"14/Mar/23 4:27 AM;5bb2c13f59e46d7be31a9e54;Hi [~accountid:5b15d94b6256d01ad54eb020] thanks for the initial update, the customer did a roll back since it was on their production environment and was affecting users, now they are back at 10.0.0.1, I will ask for a support file from that version. I will also change this Jira severity as the customer downgraded to sev2 after the rollback.",14/Mar/23 4:52 AM;5b15d94b6256d01ad54eb020;Thanks Carlos.  That was probably their best option at this point.   Did they the update in a  test environment before applying it in production?,"17/Mar/23 10:50 PM;5bb2c13f59e46d7be31a9e54;yes, they did the upgrade on dev and qa environment and they both are working fine, I got the 10.0.0.1 support file and the hvdb data seems to be correct, 35 rows, which I believe is the right amount of tables, for me that confirms that something happened during the upgrade that caused some rows to be gone, customer is going to try to upgrade again this weekend,

The 10.0.0.1 support file is @ [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012419030&path=TS012419030%2F2023-03-16%2Fisva_10.0.0.1_20230316-144352_sam.winwholesale.com.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012419030&path=TS012419030%2F2023-03-16%2Fisva_10.0.0.1_20230316-144352_sam.winwholesale.com.support_unpack%2F] if you want to take a look.","22/Mar/23 2:45 AM;60e721f12d49fd00698bb49d;Customer upgraded again from 10.0.0.1 to 10.0.4 again this weekend. 

Same behavior.

FBTOAU209E  The token request with applies to: [applies_to] and issuer: [issuer] failed. 

""Ensure that your OAuth 2.0 trust chains have been correctly configured.""

We were thinking it could be a one-time thing but if it happened again then it's something else, but not sure what could be.

Customer noticed that this gets added on 10.0.4 ""allow-query-string-token = false"" in the config file. (this is from dev). I just found it on the 10.0.4 support file from production environment as well. Is this something to worry about this issue ?

Customer wasn’t able to generate new support file from 10.0.4 as he rolled back quickly to do not interrupt business.

Thoughts? ","22/Mar/23 5:18 AM;5b15d99182e05b22cc7d5947;Hello L2,

Can customer try upgrading to a lower version? Seems they should try upgrading to 10.0.2.0. Since 10.0.0.1 is a interm release they should be able to upgrade to 10.0.2.0.

Thanks!","22/Mar/23 11:40 PM;5bb2c13f59e46d7be31a9e54;Hi George,

I have sent the question to the customer.","23/Mar/23 1:06 AM;5b15d99182e05b22cc7d5947;Hello L2,

If upgrade to 10.0.2.0 fails then the validity of environment comes into question. Also are they using internal or external databases for this environment?

Thanks!","23/Mar/23 1:15 AM;5bb2c13f59e46d7be31a9e54;Hi George,

customer is using internal DBs, already told them that for production environments they need to use external DBs, they confirmed that will run the test to upgrade to 10.0.2 this weekend.","23/Mar/23 2:48 AM;5b15d99182e05b22cc7d5947;Hello L2,

Actually they might try upgrading to 10.0.1.0 first before 10.0.2.0. Just realized 10.0.0.1 is only interm release from 10.0.0.0GA. 

# What is history of this environment? Did they upgrade from a 907x? 
# The list of missing tables provided in Jira description look to be only AAC related. Are they using AAC? or rather can we document which licenses they are using for this appliance?
# Do they have more than one appliance in production? If yes did they upgrade all appliances and only one is having issue? Please provide details.



Thanks!","23/Mar/23 10:59 PM;5bb2c13f59e46d7be31a9e54;Hi George,

I send the request to the customer to upgrade to 10.0.1.0

Regarding your questions:

# The server started at 9.0.5.0 version, then 9.0.7.2 and then 10.0.0.1
# the activated license for the server are 

activation.wga.enabled = true
activation.wga.trial =
activation.mga.enabled = true
activation.mga.trial =
activation.federation.enabled = true
activation.federation.trial = 

the customer realized there was an issue because after the upgrade OAuth tokens where not working, this is the initial customer problem description

“After doing firmware upgrade to 10.0.4 the /mga junction is failing to hand out access tokens. 08:48:12.161 POST [https://sam.winwholesale.com/mga/sps/oauth/oauth20/token|https://sam.winwholesale.com/mga/sps/oauth/oauth20/token] 500 41 ms 08:48:12.180 Error: FBTOAU209E The token request with applies to: [{0}] and issuer: [{1}] failed.”



3. There are 2 clustered servers on the environment, customer says they found the issue on both primary and secondary, however I only got a support file from the primary master, I requested that if the problem happens again after the upgrade to get a support file from each of the servers.","24/Mar/23 2:08 AM;5b15d99182e05b22cc7d5947;Hello Carlos,

Suggest getting support files from both servers before they upgrade and after. 

Thanks!","28/Mar/23 1:42 AM;5bb2c13f59e46d7be31a9e54;Hi George,

Customer upgraded to 10.0.1 successfully, new support files from 10.0.1 have been provided and I can see the hvdb table definitions ok, 36 rows total, customer will later upgrade to 10.0.2, do you think is still needed to upgrade to 10.0.2 or could they try go directly to 10.0.4?","28/Mar/23 7:43 AM;5b15d99182e05b22cc7d5947;Hello Carlos,

Do the upgraded 10.0.1.0 tables now include the all of the documented missing tables ?

In regards to next upgrade would recommend they move to 10.0.2.0 next using same procedures (ie gather support files before and after upgrade). 

If 10.0.2.0 is successful and verified then they can try 10.0.4.0 upgrade. 

Thanks!","04/Apr/23 2:05 AM;5bb2c13f59e46d7be31a9e54;Hi George,

The upgrade to 10.0.1.0 did included all the missing tables (36 rows in total) so at this version everything was working fine, however customer did the upgrade to 10.0.2 this weekend and the tables are gone again, the HVDB.dat file shows 16 tables in total

{noformat}                                  List of relations
 Schema |              Name              | Type  |  Owner   |    Size    | Description 
--------+--------------------------------+-------+----------+------------+-------------
 public | authenticators                 | table | www-data | 8192 bytes | 
 public | crypto_auth_methods            | table | www-data | 8192 bytes | 
 public | fido_attestation_certs         | table | www-data | 8192 bytes | 
 public | fido_authenticators            | table | www-data | 8192 bytes | 
 public | hvdb_schema_updates            | table | www-data | 8192 bytes | 
 public | mmfa_auth_txn_ctx_attrs_data   | table | www-data | 8192 bytes | 
 public | mmfa_auth_txn_ctx_attrs_data_v | table | www-data | 8192 bytes | 
 public | mmfa_auth_txn_data             | table | www-data | 8192 bytes | 
 public | mmfa_auth_txn_parameters_data  | table | www-data | 8192 bytes | 
 public | oauth20_dynamic_client         | table | www-data | 8192 bytes | 
 public | oauth_authenticators           | table | www-data | 0 bytes    | 
 public | pwd_vault                      | table | www-data | 8192 bytes | 
 public | registered_auth_methods        | table | www-data | 8192 bytes | 
 public | scim_eas_ext_methods           | table | www-data | 0 bytes    | 
 public | scim_eas_ext_users             | table | www-data | 0 bytes    | 
 public | u2f_tokens                     | table | www-data | 8192 bytes | 
(16 rows){noformat}

According to the messages.log the upgrade was successful 

{noformat}Apr  2 11:46:35 firmxpu: Firmware update succeeded
Apr  2 11:46:35 iss-lum[9733]: GLGUP9007I:: GLG_events:: |id=XPU_WGA_FIRM_10_0_2_0|
Apr  2 11:46:35 iss-lum[9733]: id=update time=""2023-04-02 11:46:35"" fw=sam.winwholesale.com pri=6 op=install issueid=7000001 name=Update_Installation pkgid=XPU_WGA_FIRM_10_0_2_0 msg=""The update was successfully installed. The install log file is '/var/spool/updates/logs/XPU_WGA_FIRM_10_0_2_0_install_result_20230402-114635.log'"" 
Apr  2 11:46:36 iss-lum[9733]: msg=""Chain install(s) successfully completed."" {noformat}

but I can see the following error message during the upgrade procedure 

{noformat}Apr  2 11:43:37 wga_dbhacd: Error: DPWAP0003I   An error occurred while executing the command: /usr/bin/pg_rewind --source-server=hostaddr='127.0.0.1' port=2046 user='www-data' dbname='hvdb' connect_timeout=10 -D /var/postgresql/hvdb/data -P (0x1){noformat}



While this server is the primary master of the cluster the var/postgresql/logs/hvdb/wga_dbhac.log.5 shows the following errors

{noformat}2023-04-02-11:43:26.059-04:00I----- 0x38A702C0 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 2379 0x7f4e31105900 WGAWA0704I   main: Startup of Database High Availability Daemon
2023-04-02-11:43:26.059-04:00I----- 0x38A702C2 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 1573 0x7f4e1ef00700 WGAWA0706I   monitorThread: Starting as Primary
2023-04-02-11:43:26.059-04:00I----- 0x38A70036 WebSEAL-Mgmt-API ERROR wga Common wga_dbhac.cpp 613 0x7f4e1ef00700 WGAWA0054E   An error occurred while executing the system call: connect/poll (0x6f) Connection refused
2023-04-02-11:43:26.060-04:00I----- 0x38A702CF WebSEAL-Mgmt-API WARNING wga dbhacd wga_dbhac.cpp 1510 0x7f4e1ef00700 WGAWA0719W   monitorThread: Failed to send command 'T' to the other node.
2023-04-02-11:43:26.562-04:00I----- 0x38A702C9 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 1716 0x7f4e1ef00700 WGAWA0713I   monitorThread: Remote server running in write mode
2023-04-02-11:43:26.562-04:00I----- 0x38A702C7 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 1748 0x7f4e1ef00700 WGAWA0711I   monitorThread: Copying database from other server.
2023-04-02-11:43:38.426-04:00I----- 0x38A702CD WebSEAL-Mgmt-API WARNING wga dbhacd wga_dbhac.cpp 1291 0x7f4e1ef00700 WGAWA0717W   monitorThread: The command failed: /usr/bin/pg_rewind
2023-04-02-11:43:38.591-04:00I----- 0x38A702C8 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 1753 0x7f4e1ef00700 WGAWA0712I   monitorThread: The database is not usable.
2023-04-02-11:43:39.093-04:00I----- 0x38A702C9 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 1716 0x7f4e1ef00700 WGAWA0713I   monitorThread: Remote server running in write mode
2023-04-02-11:43:39.093-04:00I----- 0x38A702C7 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 1748 0x7f4e1ef00700 WGAWA0711I   monitorThread: Copying database from other server.
2023-04-02-11:43:42.172-04:00I----- 0x38A702C4 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 1768 0x7f4e1ef00700 WGAWA0708I   monitorThread: Running in read mode
2023-04-02-11:43:42.725-04:00I----- 0x38A702C5 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 1774 0x7f4e1ef00700 WGAWA0709I   monitorThread: Swapping from read mode to write mode
2023-04-02-11:44:13.073-04:00I----- 0x38A70036 WebSEAL-Mgmt-API ERROR wga Common wga_dbhac.cpp 689 0x7f4e1ef00700 WGAWA0054E   An error occurred while executing the system call: read/poll (0x6e) Connection timed out
2023-04-02-11:44:13.073-04:00I----- 0x38A702CF WebSEAL-Mgmt-API WARNING wga dbhacd wga_dbhac.cpp 1531 0x7f4e1ef00700 WGAWA0719W   monitorThread: Failed to send command 'r' to the other node.
2023-04-02-11:46:46.614-04:00I----- 0x38A702C1 WebSEAL-Mgmt-API NOTICE wga dbhacd wga_dbhac.cpp 2391 0x7f4e31105900 WGAWA0705I   main: Shutdown of Database High Availability Daemon{noformat}



Based on the above logs I thought that maybe the secondary master is trying to take over during the upgrade procedure causing the issues with the DB, I asked the customer if will be possible to demote the secondary master to be a regular node on 10.0.1 version, then try the upgrade with a single master and if the upgrade succeeds then promote the node to secondary master again, what do you think?","04/Apr/23 7:21 AM;5b15d99182e05b22cc7d5947;Hello Carlos,

Your suggestion sounds reasonable. However might try upgrading secondary after its demoted to regular node then promote back to secondary master after primary upgrade (or is this already recommended?).

Please remind customer they need to move to external database as soon as possible for production. Issues like these are difficult to resolve since database is internal to appliance can cannot be directly maintained. 

<L2 and L3 only>

So it seems this issue is a timing issue. Im guessing  database upgrade procedures might have changed starting in 10.0.2.0.  Possibly new tables added. Otherwise the issue should had been seen in 10.0.1.0.

In the scenario above is the secondary up and running (as a 10.0.1.0 version) when primary is  being upgraded?  Or did they upgrade secondary first?

Go ahead and document exact upgrade steps they are using for their 2 node primary and secondary master cluster in case we need to reproduce issue for a closer look.

</L2 and L3 only>

Thanks!","10/Apr/23 11:49 PM;5bb2c13f59e46d7be31a9e54;Hi George,

that is correct the idea is to demote the secondary, upgrade primary and then the secondary that is now a regular node and then promote it to the secondary.

I have reminded the customer that for production environments is recommended to have external DBs.","19/Apr/23 4:24 AM;5bb2c13f59e46d7be31a9e54;Hi George,

Customer is back with the results and when going to 10.0.2 the problem is back, the support files show the primary master with the HVDB with only 16 rows again, the support file can be found @ /ecurep/sf/TS012/419/TS012419030/2023-04-16/isva_10.0.2.0_20230416-124021_sam.winwholesale.com.support_unpack/",20/Apr/23 1:29 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33]  assigning this item to you for your assessment. Can you please work with [~accountid:5b15d99182e05b22cc7d5947]  if you need assistance with progressing the item?,"24/Apr/23 10:59 AM;5b15d954b0d76456f36daf33;This is the upgrade path for that appliance : 9.0.5.0 → 9.0.7.2 → 10.0.0.1 → 10.0.4.0. I put a local appliance through a similar upgrade and it all worked as expected.

The tables could not be added correctly because the 10.0.4.0 upgrade process ran into a problem:

{noformat}Execute: SELECT MAX(DSU_VERSION) FROM HVDB_SCHEMA_UPDATES
Failed: ERROR:  relation ""hvdb_schema_updates"" does not exist
LINE 1: SELECT MAX(DSU_VERSION) FROM HVDB_SCHEMA_UPDATES
                                     ^
MAX(VERSION)=''{noformat}

That seems like a very odd error because the {{hvdb_schema_updates}} table missing at the start of the upgrade is not possible. Especially since this appliance was upgraded multiple times and such an error did not occur before.

Because we could not determine the last update that was applied, the 10.0.4.0 upgrade attempted to install all/any updates from the beginning.

I could not see any evidence of fixpacks in their support file, but did they have any applied at any of those versions? Especially at 10.0.0.1 which might have attempted to modify the hvdb?

If they are currently back at the 10.0.0.1 partition, can you get them to supply a snapshot file?","25/Apr/23 4:07 AM;5bb2c13f59e46d7be31a9e54;Hi Bhavan,

I think customer is now on 10.0.1, I will confirm this information, there was a proposed path to upgrade that was from 10.0.0.1 to 10.0.1 and then to 10.0.2, the upgrade from 10.0.0.1 → 10.0.1 was successful, now trying to upgrade to anything higher than that results on the tables problem. I have requested the snapshot which I believe will be from 10.0.1 version.","08/Jun/23 1:39 AM;5b15d901fa615349cb01778b;customer stopped responding, closing case.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Need to understand why oauth-eas WS-Trust Response is not cached.,ISAMSUP-4866,287119,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,David Hayes,5b232b2fd85e5b59b066f57f,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,13/Mar/23 9:28 AM,15/Mar/23 2:13 AM,14/Jul/23 2:47 PM,15/Mar/23 2:13 AM,,,,0,,,,"ISV SaaS is running WGA internally for API protection.  The WRP config is set for,

{noformat}[oauth-eas]
eas-enabled = true
cache-size = 1000
default-mode = OAuth20Bearer
mode-param = mode
realm-name = ISAM
bad-request-rsp-file = oauth_template_rsp_400_bad_request.html
unauthorized-rsp-file = oauth_template_rsp_401_unauthorized.html
bad-gateway-rsp-file = oauth_template_rsp_502_bad_gateway.html
trace-component = pdweb.oauth
apply-tam-native-policy = false
credential-attributes =

[tfim-cluster:oauth-cluster]
handle-pool-size = 33
handle-idle-timeout = 240
timeout = 240
basic-auth-user = easuser
ssl-keyfile = pdsrv
ssl-keyfile-stash = pdsrv.sth
max-wait-time = 0
server = 9,https://10.124.105.51/TrustServerWS/SecurityTokenServiceWST13
server = 9,https://10.124.105.54/TrustServerWS/SecurityTokenServiceWST13
server = 9,https://10.124.105.57/TrustServerWS/SecurityTokenServiceWST13
basic-auth-passwd = **obfuscated**{noformat}



Note: The servers above are not ISVA AAC Runtimes.  They are a custom WS-Trust service but this is documented as supported.",,Dave Bachmann,khansen,rodrigjo,tonyferg,Tushar Prasad,,,,,,,,,,,5af0531368ebd52c36627c3b,5b15d901fa615349cb01778b,5ac62e6b7e77b53741206133,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4864,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012403774,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,IBM CORP,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19cwj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-13 03:24:44.997,,,,,"13/Mar/23 9:34 AM;5b15d9e6dda5f94d06b985b4;*Various data*
WRP config: [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012403774&path=TS012403774%2F2023-03-10%2F&filepath=TS012403774%2F2023-03-10%2Fwrp.conf|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012403774&path=TS012403774%2F2023-03-10%2F&filepath=TS012403774%2F2023-03-10%2Fwrp.conf]

Sample thread showing response not being cached: [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012403774&path=TS012403774%2F2023-03-10%2F&filepath=TS012403774%2F2023-03-10%2F2063.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012403774&path=TS012403774%2F2023-03-10%2F&filepath=TS012403774%2F2023-03-10%2F2063.log]

Trace lines of interest:


{noformat}2023-03-10-15:59:13.228+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCall.cpp:107: Executing SOAP Call: RequestSecurityToken
2023-03-10-15:59:13.399+00:00I----- thread(2063) trace.pdweb.oauth:7 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/AMWOAuthModule.cpp:544: AMWOAuthModule::authorize Returned from SOAP call, status[0x0] rawRstr[0x7fd379a3f660]
2023-03-10-15:59:13.399+00:00I----- thread(2063) trace.pdweb.oauth:7 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/AMWOAuthModule.cpp:557: AMWOAuthModule::authorize SOAP call worked!
2023-03-10-15:59:13.399+00:00I----- thread(2063) trace.pdweb.oauth:7 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/AMWOAuthModule.cpp:560: AMWOAuthModule::authorize Returned rawRstr as a string[<wst:RequestSecurityTokenResponse xmlns:wsu=""http://docs.oasis-open.org/wss/2004
/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"" xmlns:wst=""http://docs.oasis-open.org/ws-sx/ws-trust/200512"" Id=""b2150d7e-75d4-441f-969d-e469d098d7feuuid843ce376-0157-1e0c-81b2-a7679b4a2d02""><wsp:AppliesTo xmlns:wsa=""http://www.w3.org/2005/08/addressing"" xmlns:wsp=""http
://schemas.xmlsoap.org/ws/2004/09/policy""><wsa:EndpointReference><wsa:Address>https://localhost/sps/oauth/oauth20</wsa:Address></wsa:EndpointReference></wsp:AppliesTo><wst:RequestedSecurityToken xmlns:wst=""http://docs.oasis-open.org/ws-sx/ws-trust/200512"">`<stsuuser:STSU
niversalUser xmlns:stsuuser=""urn:ibm:names:ITFIM:1.0:stsuuser"">
2023-03-10-15:59:13.399+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:71: rstr: <wst:RequestSecurityTokenResponse xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"" xml
ns:wst=""http://docs.oasis-open.org/ws-sx/ws-trust/200512"" Id=""b2150d7e-75d4-441f-969d-e469d098d7feuuid843ce376-0157-1e0c-81b2-a7679b4a2d02""><wsp:AppliesTo xmlns:wsa=""http://www.w3.org/2005/08/addressing"" xmlns:wsp=""http://schemas.xmlsoap.org/ws/2004/09/policy""><wsa:Endpo
intReference><wsa:Address>https://localhost/sps/oauth/oauth20</wsa:Address></wsa:EndpointReference></wsp:AppliesTo><wst:RequestedSecurityToken xmlns:wst=""http://docs.oasis-open.org/ws-sx/ws-trust/200512"">`<stsuuser:STSUniversalUser xmlns:stsuuser=""urn:ibm:names:ITFIM:1.0
:stsuuser"">
2023-03-10-15:59:13.399+00:00I----- thread(2063) trace.pdweb.oauth:5 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:86: STS processing succeeded.
2023-03-10-15:59:13.399+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(method) type(urn:ibm:names:ITFIM:oauth:request) value(PUT)
2023-03-10-15:59:13.399+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(scheme) type(urn:ibm:names:ITFIM:oauth:request) value(https)
2023-03-10-15:59:13.399+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(host) type(urn:ibm:names:ITFIM:oauth:request) value(analyticsmd.ite1.idng.ibmcloudsecurity.com)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(path) type(urn:ibm:names:ITFIM:oauth:request) value(/agentbridgesvc/v1.0/agentbridge/onpremagents/workloads)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(server_name) type(urn:ibm:names:ITFIM:oauth:request) value(devidngwgaprik-devidngwgaprik-public)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(resource_name) type(urn:ibm:names:ITFIM:oauth:request) value(/WebSEAL/devidngwgaprik-devidngwgaprik-public/agentbridgesvc/v1.0
/agentbridge/onpremagents/workloads)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(access_token) type(urn:ibm:names:ITFIM:oauth:param) value(HKk2DIaCTuLv5CynOmRQ8pxBGDUZVo2g6Wu7uWxP)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(pepRequestMode) type(urn:ibm:names:ITFIM:pep:request) value(authorization)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(username) type(urn:ibm:names:ITFIM:oauth:response:attribute) value(d5b569ad-2019-4f3a-aeb6-2f2d3fe98bb4)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(entitled-tenant) type(urn:ibm:names:ITFIM:oauth:response:attribute) value(analyticsmd.ite1.idng.ibmcloudsecurity.com)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(entitlements-jwt) type(urn:ibm:names:ITFIM:oauth:response:attribute) value(eyJhbGciOiJSUzI1NiIsImtpZCI6ImFwaXNlY3VyaXR5LXN5bW1
ldHJpYy1zZWNyZXQifQ.eyJpc3MiOiJodHRwczovL2FuYWx5dGljc21kLml0ZTEuaWRuZy5pYm1jbG91ZHNlY3VyaXR5LmNvbS9vaWRjL2VuZHBvaW50L2RlZmF1bHQiLCJhdWQiOiJkNWI1NjlhZC0yMDE5LTRmM2EtYWViNi0yZjJkM2ZlOThiYjQiLCJqdGkiOiIwWlBEdkJTeW5yS1pQWlBSSU1HS3R3IiwiaWF0IjoxNjc4NDYwMDQ4LCJleHAiOjE2Nzg0Njc
zMDgsInN1YiI6ImQ1YjU2OWFkLTIwMTktNGYzYS1hZWI2LTJmMmQzZmU5OGJiNCIsImFwb2xsbyI6eyJlbnRpdGxlbWVudHMiOlsicnVuZXh0ZXJuYWxhZ2VudCJdLCJlbnRpdGxlbWVudHNfbWFzayI6IjU5MDI5NTgxMDM1ODcwNTY1MTcxMiIsImdyYW50LXR5cGUiOiJjbGllbnRfY3JlZGVudGlhbHMiLCJncmFudC1hdHRyaWJ1dGVzIjp7ImF0X2hhc2giOi
JNSy1GaF9UdXdWY2Z4MjN2dzMyeVVnIiwiZXh0Ijp7InRlbmFudElkIjoiYW5hbHl0aWNzbWQuaXRlMS5pZG5nLmlibWNsb3Vkc2VjdXJpdHkuY29tIn0sInN1YiI6ImQ1YjU2OWFkLTIwMTktNGYzYS1hZWI2LTJmMmQzZmU5OGJiNCIsInJlYWxtTmFtZSI6ImNsb3VkSWRlbnRpdHlSZWFsbSIsInVuaXF1ZVNlY3VyaXR5TmFtZSI6ImQ1YjU2OWFkLTIwMTktN
GYzYS1hZWI2LTJmMmQzZmU5OGJiNCIsImlzcyI6Imh0dHBzOi8vYW5hbHl0aWNzbWQuaXRlMS5pZG5nLmlibWNsb3Vkc2VjdXJpdHkuY29tL29pZGMvZW5kcG9pbnQvZGVmYXVsdCIsImFjdGl2ZSI6dHJ1ZSwidG9rZW5fdHlwZSI6IkJlYXJlciIsImNsaWVudF9pZCI6ImQ1YjU2OWFkLTIwMTktNGYzYS1hZWI2LTJmMmQzZmU5OGJiNCIsImF1ZCI6ImQ1YjU2
OWFkLTIwMTktNGYzYS1hZWI2LTJmMmQzZmU5OGJiNCIsImdyYW50X3R5cGUiOiJjbGllbnRfY3JlZGVudGlhbHMiLCJyZXN0cmljdEVudGl0bGVtZW50cyI6dHJ1ZSwic2NvcGUiOiJvcGVuaWQiLCJncmFudF9pZCI6ImUyN2YwYmM0LTY5ZGEtNGQ0OC04YzRiLTcxZTI1OWEwMmI0NyIsImNhdGVnb3J5IjoiZXh0ZXJuYWxBZ2VudCIsImV4cCI6MTY3ODQ2NzI
0OCwiaWF0IjoxNjc4NDYwMDQ4LCJkZWZhdWx0RW50aXRsZW1lbnRzIjpbInJ1bkV4dGVybmFsQWdlbnQiXX0sImludGVybmFsX2VudGl0bGVtZW50c19iaXRtYXNrIjpbXSwiaW50ZXJuYWwtZW50aXRsZW1lbnRzIjpbXSwiZW50aXRsZWQtdGVuYW50IjoiYW5hbHl0aWNzbWQuaXRlMS5pZG5nLmlibWNsb3Vkc2VjdXJpdHkuY29tIiwidGVuYW50LXV1aWQiOi
IwODcxMGY2Yy0zOGRlLTQxNWQtOGFmMC1iYTdlYTVmOThiN2UiLCJlbnRpdGxlbWVudHNfYml0bWFzayI6WzAsMzJdLCJpbnRlcm5hbF9lbnRpdGxlbWVudHNfbWFzayI6IjAiLCJpbnRyYXNlcnZpY2UiOmZhbHNlfX0.g2eHVJFP6hP4geqvj9HBD5NjwzH5G6PB2QsVDDznjb-zeUOiVk-DAEzjdhil9f5iPSenmQth9FKNNYHH_-MlWb_d2BPHzrdxq5haKj6R3
1aAwCwU92uD4qPyEtSybslO624cMRE7_-LV4Up9eEGzpXhQKfq94ZVIC7MsixXzAUY)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(expires) type(urn:ibm:names:ITFIM:oauth:response:attribute) value(2023-03-10T16:00:13Z)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-api/AMWOAuthRSTR.cpp:343: Attr: name(authorized) type(urn:ibm:names:ITFIM:oauth:response:decision) value(TRUE)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:1 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/AMWOAuthModule.cpp:698: 30af8587f4eec1571fc76defc37db252c130650474cdf03dd9a43a5c6b69a2a8: will not cache (d5b569ad-2019-4f3a-aeb6-2f2d3fe98bb4/MK-Fh_TuwVcfx23v
w32yUg)
2023-03-10-15:59:13.400+00:00I----- thread(2063) trace.pdweb.oauth:5 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/AMWOAuthModule.cpp:719: OAuth authorization status: permitted
2023-03-10-15:59:13.401+00:00I----- thread(2063) trace.pdweb.oauth:6 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/AMWOAuthModule.cpp:770: Exit AMWOAuthModule::authorize (0x0)
2023-03-10-15:59:13.401+00:00I----- thread(2063) trace.pdweb.oauth:6 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/AMWOAuthDataEAS.cpp:75: Enter AMWOAuthDataEAS::~AMWOAuthDataEAS
2023-03-10-15:59:13.401+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/AMWOAuthDataEAS.cpp:83: AMWOAuthDataEAS::~AMWOAuthDataEAS Deleted the _appContext
2023-03-10-15:59:13.401+00:00I----- thread(2063) trace.pdweb.oauth:6 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/AMWOAuthDataEAS.cpp:98: Exit AMWOAuthDataEAS::~AMWOAuthDataEAS
2023-03-10-15:59:13.401+00:00I----- thread(2063) trace.pdweb.oauth:9 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/amw_oauth_eas.cpp:359: azn_svc_decision_access_allowed_ext final *permission[0] (0 is permitted, 1 is not permitted)
2023-03-10-15:59:13.401+00:00I----- thread(2063) trace.pdweb.oauth:6 /build/isam/src/i4w/pdwebrte/azn/oauth-eas/amw_oauth_eas.cpp:366: Exit azn_svc_decision_access_allowed_ext (0x0){noformat}

Note on line 35 {{will not cache}}.",13/Mar/23 9:36 AM;5b15d9e6dda5f94d06b985b4;I do not quite understand the trace because the actual response is very small.  When I compare this to an L2 lab the reponse is much large and actually contains the expires attribute and others.  Not sure where all those attributes are being pulled from.,"13/Mar/23 9:56 AM;5b15d9e6dda5f94d06b985b4;Just noticed an odd tick mark in the response:

{{ws-sx/ws-trust/200512"">`<stsuuser:STSU 7niversalUser xmlns:stsuuser=""urn:ibm:names:ITFIM:1.0:stsuuser"">}}

That seems very wrong.",13/Mar/23 10:29 AM;5b15d9e6dda5f94d06b985b4;We’ve asked the developer of the code to clear up the tick mark.,13/Mar/23 1:24 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] can you please review this item for us?,"13/Mar/23 3:33 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9e6dda5f94d06b985b4] - I believe that [~accountid:5b15d94b6256d01ad54eb020] preemptively created [https://cloudidentity.atlassian.net/browse/ISAMSUP-4864|https://cloudidentity.atlassian.net/browse/ISAMSUP-4864|smart-link] to work on this issue. I’m not sure if you are aware of the findings as I cannot see anything correlating to Bill’s updates in the case itself. [~accountid:5b15d9e6dda5f94d06b985b4] - not sure if the updates in  [https://cloudidentity.atlassian.net/browse/ISAMSUP-4864|https://cloudidentity.atlassian.net/browse/ISAMSUP-4864|smart-link] fully resolve the customer issue? 

 [~accountid:5b15d94b6256d01ad54eb020] - how were updates from [https://cloudidentity.atlassian.net/browse/ISAMSUP-4864|https://cloudidentity.atlassian.net/browse/ISAMSUP-4864|smart-link] communicated to the customer? Do we know their current status? ",13/Mar/23 11:01 PM;5b15d94b6256d01ad54eb020;[~accountid:5b232b2fd85e5b59b066f57f]   I thought [~accountid:5b15d9e6dda5f94d06b985b4] would have been notified when I made him the L2 owner. Maybe that didn’t happen.,15/Mar/23 2:13 AM;5b15d9e6dda5f94d06b985b4;Closing per conversation with Jose.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Fixpacks fail to install on 10.0.5.0 docker lightweight images.,ISAMSUP-4853,286639,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Peter Horner,5b15d9517dab4c51f61b5190,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,09/Mar/23 5:55 AM,12/Apr/23 2:12 PM,14/Jul/23 2:47 PM,12/Apr/23 2:12 PM,10.0.6,Support,,0,,,,"See [https://cloudidentity.atlassian.net/browse/ISAMSUP-4782|https://cloudidentity.atlassian.net/browse/ISAMSUP-4782|smart-link] 


The /usr/bin/isva-sign program is missing from the lightweight containers.",,khansen,Tushar Prasad,,,,,,,,,,,,,,5b15d901fa615349cb01778b,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ45740,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012099225,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nick Lloyd,5b15d9e6dda5f94d06b985b4,,,,PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-03-09T15:44:40.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,Yes,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19a1n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-09 01:17:37.161,,,,,09/Mar/23 6:07 AM;5b15d9e6dda5f94d06b985b4;[~accountid:5b15d9517dab4c51f61b5190] New Jira and APAR IJ45740. {color:#ffffff}IJ45740{color},"09/Mar/23 11:17 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a21b32262eaa9b35ebc5a817da2b126c7260e4ea
   * description: ISAMSUP-4853 IJ45740 Fixpacks on 10.0.5.0 docker lightweight images

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86316792.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4853) which we publish.","09/Mar/23 2:49 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5f1efb735a34fe66309babfbaaa474933ef3ba4a
   * description: Merge pull request #5735 from ISAM/ISAMSUP-4853

ISAMSUP-4853 IJ45740 Fixpacks on 10.0.5.0 docker lightweight images

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86324058.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230309044628-5f1efb735.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","09/Mar/23 4:11 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5f1efb735a34fe66309babfbaaa474933ef3ba4a
   * description: Merge pull request #5735 from ISAM/ISAMSUP-4853

ISAMSUP-4853 IJ45740 Fixpacks on 10.0.5.0 docker lightweight images

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86326768.


This build has not been published as the commit is not currently within a branch (20230309044628-5f1efb735) which we publish.","10/Mar/23 12:55 AM;5b15d9e6dda5f94d06b985b4;[~accountid:5b15d9517dab4c51f61b5190] [~accountid:5b15d94b6256d01ad54eb020] 

Because the fix for this is going to be a new container image Matt is asking if all the fixpacks related to their 10.0.5.0 OCP rollout will be in the new image?",10/Mar/23 1:01 AM;5b15d94b6256d01ad54eb020;@Nick  I’m still working on that.  So I don’t have an answer to that at this time. ,"10/Mar/23 2:33 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5f1efb735a34fe66309babfbaaa474933ef3ba4a
   * description: Merge pull request #5735 from ISAM/ISAMSUP-4853

ISAMSUP-4853 IJ45740 Fixpacks on 10.0.5.0 docker lightweight images

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86366083.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4724) which we publish.","10/Mar/23 2:41 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5f1efb735a34fe66309babfbaaa474933ef3ba4a
   * description: Merge pull request #5735 from ISAM/ISAMSUP-4853

ISAMSUP-4853 IJ45740 Fixpacks on 10.0.5.0 docker lightweight images

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86367039.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4788) which we publish.",29/Mar/23 3:55 AM;5b15d9e6dda5f94d06b985b4;Customer is asking for status.,"29/Mar/23 8:14 AM;5b15d9517dab4c51f61b5190;Fix will be in 10.0.5.0 IF1 which we are in the process of finalizing

Should be this week",12/Apr/23 2:12 PM;5b15d9517dab4c51f61b5190;Closing - since case has been closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Reverse Proxy doesn't cache results of _kerberos-master._tcp,ISAMSUP-4848,286301,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,07/Mar/23 1:48 PM,22/May/23 1:16 PM,14/Jul/23 2:47 PM,22/May/23 1:16 PM,,,,0,,,,"Customer is using the following:



[1.it|http://1.it] uses kerberos junction

example:

{{[junction:sharek]kerberos-sso-enable = yes}}
{{kerberos-keytab-file = CSSSOKeytabNew.keytab}}
{{kerberos-principal-name = HTTP/igatexxsa@STC.CORP}}
{{kerberos-service-name = HTTP/spapp1xx@STC.CORP}}
{{kerberos-service-name = HTTP/spappxx@STC.CORP}}
{{always-send-kerberos-tokens = true}}
{{kerberos-user-identity = attr:idpuserName@attr:USER_DOMAIN}}



spnego-auth is no



which means only kerberos based junction 



When a request goes to kerberos junction.

the webseal sends the following srv record



ar  5, 2023 08:02:39.198961000 UTC		172.21.webseal	10.32-AD		Standard query 0x583f SRV _kerberos-master._tcp.STC.CORP
Mar  5, 2023 08:02:39.199949000 UTC		10.32.AD	172.21.Webseal		Standard query response 0x583f SRV _kerberos-master._tcp.STC.CORP SRV 0 100 88 rxxstcsxx.stc.corp A 10.32







AT this point, it seems the SRV record is not cached and that request doesn’t stop until a master_kdc is defined in krb5.conf



At this point, only way to stop SRV records is by putting by below



{noformat}Steps to  ensure these DNS queries don't occur



1.goto ISVA LMI

2.Web --> kerberos configuration

3.goto Realms tab

4.right click the Realm

5.New --> property

6.select  master_kdc from the list

7.put the master kdc value in that

8.save and deploy the configuration

9.restart the reverse proxy and verify that DNS requests for _kerberos-master SRV no longer present.


{noformat}



Customer doesn’t want to accept the solution as they would like to handle through DNS resolution and would like reverse proxy to cache it and dont request always(they wouldn’t want to do any change in krb5.conf)

Although, MIT document says support is not complete. but doesn’t specify which version.

The explanation is provided in the MIT doc[https://web.mit.edu/kerberos/krb5-latest/doc/admin/realm_config.html|https://web.mit.edu/kerberos/krb5-latest/doc/admin/realm_config.html|smart-link] In summary , its an attempt to get to a master server which is standard in case of kerberos client(which is used by ISVA)——explanation as per doc——
This entry should refer to those KDCs, if any, that will immediately see password changes to the Kerberos database. If a user is logging in and the password appears to be incorrect, the client will retry with the primary KDC before failing with an “incorrect password” error given.
If you have only one KDC, or for whatever reason there is no accessible KDC that would get database changes faster than the others, you do not need to define this entry. _kerberos-adm._tcp This should list port 749 on your primary KDC. Support for it is not complete at this time, but it will eventually be used by the [kadmin|https://web.mit.edu/kerberos/krb5-latest/doc/admin/admin_commands/kadmin_local.html#kadmin-1] program and related utilities. For now, you will also need the *admin_server* variable in [krb5.conf|https://web.mit.edu/kerberos/krb5-latest/doc/admin/conf_files/krb5_conf.html#krb5-conf-5].
————





latest tcp trace located at 😀 



[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011953775&path=TS011953775%2F2023-03-05%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011953775&path=TS011953775%2F2023-03-05%2F]



Having some doubt around whether , its kerberos client implementation which has some issue wiht SRV. record caching and its built in a way that it can’t do it.



could not find a direct reference whether the dns lookup can be avoided by caching srv responses.



although lot of places master_kdc  is used ",,adarsh.nair,Keiran Robinson,khansen,Nick Lloyd,prashant_kamat,,,,,,,,,,,605c0c04b18de50071046740,5ac577587028785d133fbc46,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011953775,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,Saudi Telecom,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i197yj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-03-08 16:53:00.974,,,,,07/Mar/23 2:34 PM;5c53d3ac23f5bf672621c868;L2 env has a recreate and DNS queries for _kerberos-master has been seen on every request going to backend_,"09/Mar/23 12:49 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9e581c3df12acf53c4a] 

could you help to get a response on this?

[1.At|http://1.At] this point I am not able to cite any MIT documentation or RFC which will tell why 

{noformat}_kerberos-master._tcp  or _kerberos-master._udp  entries are sent for every requests going though the junction.{noformat}

I only put in a perception that it could be how it would work and that it goes away with master_kdc

even MIT documentation says master_kdc is not to be put into krb5.conf .



then the question brings. shouldn’t the SRV resolution should be enough to tell what is master-kdc and that response should be cached (and a dns query shouldn’t be done at each request?)",09/Mar/23 2:53 AM;5b15d9e581c3df12acf53c4a;investigating…….,"09/Mar/23 7:12 AM;5b15d9e581c3df12acf53c4a;I did some preliminary investigation and I can see that as far as Kerberos goes, almost every function/call made by WebSEAL, all those methods/functions come from kerberos itself. All the caching is being done using kerberos methods. So what ever caching needed to be, all is being done in kerberos code.

So, if a caching of any items is not provided by kerberos then it is not cached.","10/Mar/23 1:28 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9e581c3df12acf53c4a] 



do we have an internal way to check around kerberos or its related dev? if any work being done or any future version handles it.



From customer point of view. they are absolutely okay in saying that they have a huge kdc setup and their master kdc can change (they would not want to make master_kdc entry)



Can we have a definite say that , master_kdc is the only way doing it otherwise they can expect those dns entries to be made for each request going through kerberos based junction?","10/Mar/23 8:00 AM;5b15d9e581c3df12acf53c4a;No, there is no internal way, you may think Developer do but no they do not, normal communication happens once a situation is escalated and via that escalation process, otherwise what we get as far as third party software is what out there for everybody.

We had that similar experience with RSA code, we had to escalated to get a fix from them and only when it was proven that there is a defect in their code.



And as far as saying anything definitely, we cannot. ","17/Mar/23 11:35 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9e581c3df12acf53c4a] 



I am able to track down kerberos bug(which seems to be opened a long time ago)



recently the developer contacted me and said that there is no near term fix for this (except putting master_kdc or negative caching)



just documenting here so that in future it can be referenced

----

{noformat}https://krbdev.mit.edu/rt/Ticket/Display.html?id=6782{noformat}

--



surely an item needs to be tracked through Dev



[~accountid:5ac577587028785d133fbc46] for future reference and whether it can be tracked separately",09/May/23 9:52 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Error: Static Routes: Route interface does not exist,ISAMSUP-4839,285797,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,03/Mar/23 8:18 PM,26/Apr/23 8:00 AM,14/Jul/23 2:47 PM,26/Apr/23 12:09 AM,,,,0,,,,"We need  a new 10.0.5 signed version of the “remove_extra_loopback”
[https://ibm.ent.box.com/folder/142087541316|https://ibm.ent.box.com/folder/142087541316|smart-link] 
[https://cloudidentity.atlassian.net/browse/ISAMSUP-131|https://cloudidentity.atlassian.net/browse/ISAMSUP-131|smart-link] 

It says version independent, but not sure if it works for ISVA 10.0.5



 Problem:

The customer accidentally deleted one of network interfaces (1.4 => 10.40.51.0/24 range)
re-added interface (1.4) is configured again, but unable to modify/add or even delete  static routing tables for each IP.
checked the routes using the REST API, and noticed some of these still exist, but reference an invalid ""interfaceUUID"":

Tried to delete using RAPI as per the [https://www.ibm.com/docs/api/v1/content/SSPREK_10.0.4/com.ibm.isva.doc/develop/rapi/Deleting_a_static_route.xml|https://www.ibm.com/docs/api/v1/content/SSPREK_10.0.4/com.ibm.isva.doc/develop/rapi/Deleting_a_static_route.xml] ,  But no joy



{noformat}DELETE /net/routes/caf5e381-fe0f-4c23-8806-0647f3b3fb4c HTTP/1.1
Host: pwga2.aquafin.be
Accept: application/json
Authorization: Basic ...
```

But it would not process my request, with the following response:
```
HTTP 400 Bad Request
[
    ""Static Routes: Route interface does not exist."",
    ""Static Routes: Route interface does not exist."",
    ""Static Routes: Route interface does not exist.""{noformat}


it seems the problem is {{interface UUID ec9e3996-8993-4070-92c7-d5120314f9dc}}



Also, The LMI does not allow  to edit anything; neither the name, disable it, nor add/modify or remove IP addresses. It results in the error {{""Static Routes: Route interface does not exist.""}}
 [https://ecurep.mainz.de.ibm.com/rest/download/TS012288075/2023-03-02/attempt_to_edit_pwga2_interface.png?fileSize=57754&clientId=ae5|https://ecurep.mainz.de.ibm.com/rest/download/TS012288075/2023-03-02/attempt_to_edit_pwga2_interface.png?fileSize=57754&clientId=ae5]",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,14/Mar/23 5:40 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;image-20230313-193823.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189866,14/Mar/23 5:40 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;image-20230313-193848.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189863,14/Mar/23 5:40 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;image-20230313-193911.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189865,15/Mar/23 12:35 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;image-20230314-143256.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190046,15/Mar/23 12:36 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;image-20230314-143619.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190049,15/Mar/23 12:35 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;remove_extra_loopback(1).log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190047,14/Mar/23 5:40 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;remove_extra_loopback.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189864,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012288075,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,IS4U Support,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i194vf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-03 23:09:08.252,,,,,"03/Mar/23 8:18 PM;614dd52af1c1740068534813;{noformat}GET /net/routes HTTP/1.1
Host: pwga2.aquafin.be
Accept: application/json
Authorization: Basic ...
```

With the following 4 routes that reference the unknown, probably previous/old, interfaceUUID:
```
{
    ""staticRoutes"": [
        {
            ""enabled"": true,
            ""address"": ""default"",
            ""maskOrPrefix"": null,
            ""gateway"": ""10.40.51.1"",
            ""interfaceUUID"": ""ec9e3996-8993-4070-92c7-d5120314f9dc"",
            ""metric"": 0,
            ""table"": ""3e28a458-511d-4a3a-a723-7f775c14bc0a"",
            ""uuid"": ""caf5e381-fe0f-4c23-8806-0647f3b3fb4c"",
            ""objType"": ""staticRoute"",
            ""comment"": null
        },
        {
            ""enabled"": true,
            ""address"": ""10.40.51.0"",
            ""maskOrPrefix"": ""24"",
            ""gateway"": ""0.0.0.0"",
            ""interfaceUUID"": ""ec9e3996-8993-4070-92c7-d5120314f9dc"",
            ""metric"": 0,
            ""table"": ""3e28a458-511d-4a3a-a723-7f775c14bc0a"",
            ""uuid"": ""4e76fb24-490a-4a59-b710-5e5085961384"",
            ""objType"": ""staticRoute"",
            ""comment"": null
        },
        {
            ""enabled"": true,
            ""address"": ""10.40.62.0"",
            ""maskOrPrefix"": ""24"",
            ""gateway"": ""10.40.51.1"",
            ""interfaceUUID"": ""ec9e3996-8993-4070-92c7-d5120314f9dc"",
            ""metric"": 0,
            ""table"": ""3a4790b2-f255-4b70-8b68-fca4c584aab9"",
            ""uuid"": ""547ea747-2ad0-4c1c-b3f1-efe955ad287a"",
            ""objType"": ""staticRoute"",
            ""comment"": ""from twga1 to RTSS (ISAM Federation)""
        },
        {
            ""enabled"": true,
            ""address"": ""10.40.72.0"",
            ""maskOrPrefix"": ""24"",
            ""gateway"": ""10.40.51.1"",
            ""interfaceUUID"": ""ec9e3996-8993-4070-92c7-d5120314f9dc"",
            ""metric"": 0,
            ""table"": ""3a4790b2-f255-4b70-8b68-fca4c584aab9"",
            ""uuid"": ""84be4790-c8b8-4a02-ac20-a9637386a8fb"",
            ""objType"": ""staticRoute"",
            ""comment"": ""from awga1 en awga2 to RTSS (ISAM Federation)""{noformat}","04/Mar/23 9:09 AM;5b15d94b6256d01ad54eb020;The version independent fix packs will only work on 10.0.4.0 and older.  The signing changed for  10.0.5.0.

I’ll have to review the remove_extra_loopback fixpack to see if any other changes are needed for 10.0.5. I wrote that  a few years ago for 9.0.4.  You might need another fixpack to remove the routes with invalid  uuid’s. Some of this is done when the system boots up.  Has the system been rebooted since this problem occurred?  

Ideally, the quickest way would be to restore from a backup.  I’m guessing that’s not an option in this case.

The static routes you can’t edit are generated.  You should be able to edit the routes you enter.","06/Mar/23 7:57 PM;614dd52af1c1740068534813;Hi [~accountid:5b15d94b6256d01ad54eb020] The customer rebooted the appliance a couple of times but no joy, and unfortunately there is no ISVA Snapshot or VM snapshot available before they accidentally remove the NIC, so that's not an option either.
I think the only option would be having the fixpack?
Thanks",10/Mar/23 7:50 PM;614dd52af1c1740068534813;HI [~accountid:5b15d94b6256d01ad54eb020] . Can we have the fixpack for the ver 10.0.5? The customer is pushing for updates as it’s a production environment. Thanks,11/Mar/23 12:05 AM;5b15d94b6256d01ad54eb020;I’ve had some other issues I had deal with this week. I think  can build and get you the fix pack for the loopback issue later today.  Removing the routes will take a little longer.,"11/Mar/23 1:19 AM;5b15d94b6256d01ad54eb020;Here is the 10.0.5.0 version of the remove extra loopback.   L2 please test before distributing.

[https://ibm.ent.box.com/folder/198382332048|https://ibm.ent.box.com/folder/198382332048|smart-link] ","14/Mar/23 5:40 AM;614dd52af1c1740068534813;Hi [~accountid:5b15d94b6256d01ad54eb020] I am getting an error when trying to install the fixpack in my lab, did it work in your lab?
Got this log from my ISVA


[^remove_extra_loopback.log]

!image-20230313-193823.png|width=1894,height=342!

!image-20230313-193848.png|width=1005,height=567!

!image-20230313-193911.png|width=1046,height=692!



","14/Mar/23 5:47 AM;5b15d94b6256d01ad54eb020;Okay, let me do some testing.  I don’t see anything wrong with the script so something must be different on 10.0.5.0.

Update: That’s strange. It installed just fine on mine.","14/Mar/23 5:52 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd52af1c1740068534813] you’re not using a container are you?  Just a regular appliance?



Can you send me a support file from your appliance?","15/Mar/23 12:36 AM;614dd52af1c1740068534813;[~accountid:5b15d94b6256d01ad54eb020] attaching the support file. I installed a brand new ISVA 10.0.5 but the same error


!image-20230314-143619.png|width=1005,height=584!",15/Mar/23 12:47 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd52af1c1740068534813] I think the support file might be too big to attach.  Can you put it on l3pmrsupport?,"15/Mar/23 1:38 AM;614dd52af1c1740068534813;[~accountid:5b15d94b6256d01ad54eb020] I have sent you on Slack, is that OK?. Thanks","15/Mar/23 1:47 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd52af1c1740068534813] yes that's fine, thanks. I  thought you could tell I  downloaded it.","15/Mar/23 5:08 AM;5b15d94b6256d01ad54eb020;I  used your definition for the extra loopback in mine and got the same error.  I tracked down the reason for it.   The last part of the fixpack is:

{noformat}/usr/sbin/mesa_translate translate /etc /etc/settings.tmp
/usr/sbin/mesa_config commit /etc/settings.tmp
STATUS=3
{noformat}

STATUS=3  from mesa_config commit    means that a reboot is required.  So it didn’t really fail to install but the fixpack installer reported that it did because it expects a return code of zero.   Rebooting my appliance and the extra loopback was gone because the xml file was successfully edited.

So I think I can tweak the fixpack to eliminate that.",15/Mar/23 5:32 AM;5b15d94b6256d01ad54eb020;I updated the fixpack so you won’t get that error but a reboot will be required after installing it.  Please retest.  It worked for me in my latest test.,"21/Mar/23 7:59 PM;614dd52af1c1740068534813;Hi [~accountid:5b15d94b6256d01ad54eb020] 
The fixpack removed successfully the second loopback interface but, it did not resolve the problem, still can’t add / remove interface  from the LMI or using  API's

Wondering if we can have a fixpack to update the ""interfaceUUID"" in the routing tables?


See below the last customer response.


To re-iterate: I noticed that the old ""interfaceUUID"" is still present in the routing table ""/net/routes"" API, but I cannot modify or delete these references. These 4 routes listed in the case description, should refer to the new ""interfaceUUID"".

So I am looking for a fixpack to update to old ""interfaceUUID"" in the routing tables ""ec9e3996-8993-4070-92c7-d5120314f9dc"" (which no longer exists according to the ""/net/ifaces"" API) to the new ""interfaceUUID"" of ""5318323e-cce3-4989-ac72-183f551fffcd"", which is the newly added 1.4 interface.



As such, either the routing table needs updating, or the new interface's UUID is modified to the old one. Since I'm assuming this is an Enterprise Linux flavor OS in the back, I'll provide a similar example:

> Network interface ""ens18"" needs its UUID changed, I open the file in ""/etc/sysconfig/network-scripts/ifcfg-ens18"" and modify the respective ""UUID"" property to my desired value.
(not sure whether it's applicable as well for the ISVA firmware OS, but that'd be my approach)","21/Mar/23 10:33 PM;5b15d94b6256d01ad54eb020;It wasn’t intended to resolve the problem. It was meant to remove the extra loopback.   

{color:#4c9aff}“Wondering if we can have a fixpack to update the ""interfaceUUID"" in the routing tables?”{color}

Yes,  I need write a one off fix pack to remove the unwanted routes.  ","22/Mar/23 5:57 AM;5b15d94b6256d01ad54eb020;I know you said you tried the REST API to fix the routes but have you tried  the  cli commands?

network->routes

options  are:  add,  delete, edit, reset and show

If that doesn’t work I can start on a fixpack which  is more involved than the example.  ","22/Mar/23 6:51 AM;614dd52af1c1740068534813;[~accountid:5b15d94b6256d01ad54eb020] I am almost sure they tried using the CLI but, I will Double check",22/Mar/23 6:53 AM;5b15d94b6256d01ad54eb020;One of the options on the cli is the  route reset which clears all of the static routes. Since they don’t have very many that might be an option.   ,"26/Apr/23 7:47 AM;614dd52af1c1740068534813;reset the routes and re-added them, it's working as expected now.. Hence closing the JIRA. Thx",26/Apr/23 7:48 AM;5b15d94b6256d01ad54eb020;Great news. Thanks for the update.,26/Apr/23 8:00 AM;614dd52af1c1740068534813;Thank you for always quick and effective responses [~accountid:5b15d94b6256d01ad54eb020] . Cheers!,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Customer needs Assurance Certificate as per RBI requirement.,ISAMSUP-4820,285194,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,David Hayes,5b232b2fd85e5b59b066f57f,adarsh.nair,605c0c04b18de50071046740,adarsh.nair,605c0c04b18de50071046740,01/Mar/23 6:04 PM,27/Mar/23 10:17 AM,14/Jul/23 2:47 PM,27/Mar/23 10:17 AM,,,,0,,,,"Customer being a Financial establishment has below requirement

As per Reserve Bank of India (RBI) instructions, for critical business applications, source code audit report or assurance certificate from OEM is required to ensure that these applications (ISAM) are free from embedded malicious / fraudulent code. Hence, it is of immense importance that this report / certificate is required .Please share it on priority today itself.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012301743,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,adarsh.nair,605c0c04b18de50071046740,,,,SARASWAT CO-OPERATIVE BANK LTD,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1917f:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-03-01 19:28:27.792,,,,,"02/Mar/23 5:28 AM;5b15d94b6256d01ad54eb020;I don’t know who would provide that.  I would expect that to come from the account team or sales.  If we even offer one.

[~accountid:5ac57757d9a96536d1f0daa9] Do you know if we provide that certificate or where they could get one?",06/Mar/23 11:37 AM;5b232b2fd85e5b59b066f57f;[~accountid:5a150c74cba5b30325a6f0f0] - something you can help with? ,07/Mar/23 1:30 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:605c0c04b18de50071046740] . I don’t believe that this is something that the L3 team would usually provide. I notice that in the Case you have already suggested to the customer that they reach out to the IBM Tech Sales team - I feel that this is probably the correct approach. ,27/Mar/23 10:17 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Incorrect absolute URI filtering when 'disable-advanced-filtering = no' and script filtering is enabled with 'rewrite-absolute-with-absoute = yes',ISAMSUP-4780,280185,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Peter Horner,5b15d9517dab4c51f61b5190,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,09/Feb/23 10:47 AM,16/Feb/23 9:07 AM,14/Jul/23 2:47 PM,16/Feb/23 9:07 AM,10.0.6,Support,,0,,,,"The following HTML page is incorrectly filtered with the following configuration:


{noformat}[server]
disable-advanced-filtering = no
...
[script-filtering]
script-filter = yes
rewrite-absolute-with-absolute = yes
...
[filter-advanced-encodings]
ampersand = &amp;&lt;&gt;""'
ampersand-hex = ^a-zA-Z0-9.
ampersand-dec = ^a-zA-Z0-9.
percent = ^a-zA-Z0-9.
escaped-x = ^a-zA-Z0-9.{noformat}

The backend has an HTML page like:

{noformat}<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Strict//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"">
<html xmlns=""http://www.w3.org/1999/xhtml"">
<head>
<meta http-equiv=""Content-Type"" content=""text/html; charset=iso-8859-1"" />
<title>filtering-test</title>
<script type=""text/javascript"">
var data = {""rwsRootUrl"":""https://ad.hyperv.lab/biprws""};
</script>
</head>
<body>
filtering-test
</body>
</html>{noformat}

And when coming from WebSEAL we see:

{noformat}<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Strict//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"">
<html xmlns=""http://www.w3.org/1999/xhtml"">
<head>
<meta http-equiv=""Content-Type"" content=""text/html; charset=iso-8859-1"" />
<title>filtering-test</title>
<script type=""text/javascript"">
var data = {""rwsRootUrl"":""h&#x74;&#x74;&#x70;s://10.2.1.113/BOE/biprws""};
</script>
</head>
<body>
filtering-test
</body>
</html>{noformat}

----

The customer’s data shows that the filtering is messed up for any thing that is filtered, such as URLs in cookies, headers, and other parts of the HTML body.

The above HTML page can be put into any web server for recreation.

Recreated using an SSL junction named ‘/BOE’ that goes to a TLS server where the Virtual Host Name matches the URL in the ‘rwsRootUrl’ data.

----

This is affecting the customer’s go live.",,David Hayes,jcyarbor,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ45380,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011903689,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,"Harley-Davidson Motor Company, Inc.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i186uz:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-13 01:03:31.92,,,,,"13/Feb/23 11:03 AM;5b15d9517dab4c51f61b5190;I have reproduced the behaviour at 10.0.5.0

But it is a documentation error at [https://www.ibm.com/docs/en/sva/10.0.5?topic=reference-filter-advanced-encodings-stanza|https://www.ibm.com/docs/en/sva/10.0.5?topic=reference-filter-advanced-encodings-stanza|smart-link] 

The line in the example that says 

{{ampersand = &amp;&lt;&gt;""'}}

has been wrongly encoded in the documentation

It is supposed to say

{{ampersand = &<>""'}}

Which matches the text below the example

Explanation

Because the incorrect string contains the letters p and t they are being encoded

in my reproduction - the junction contained an l and this was also ampersand encoded

So the customer needs to change the line to be {{ampersand = &<>""'}}

Please open a DOC APAR “WebSEAL filter-advanced-encodings incorrect example”","14/Feb/23 9:06 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15d9517dab4c51f61b5190] 

APAR IJ45380 has been created for this issue.",14/Feb/23 10:41 AM;5b15d9517dab4c51f61b5190;I have made the change to the documentation - so will be in 10.0.6.0,"16/Feb/23 4:39 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d9517dab4c51f61b5190] ,

Thanks, I confirmed it resolved the issue in my environment and the customer environment. We can close this out.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISAM 9 .0.7.2 - HPDIA0114E Could not acquire a client credential,ISAMSUP-4777,279820,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,,Motiur Rahman,5b15d9e581c3df12acf53c4a,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,07/Feb/23 9:25 PM,14/Jul/23 2:58 AM,14/Jul/23 2:47 PM,,,,,0,,,,"Users intermittently getting this error while accessing a kerberos application. In this case splunk.



We advised:

{noformat}52 0x7f981e925700 -- DPWWA1519E The SSL session cache has become full and because of this existing SSL sessions will be displaced.{noformat}

ssl-max-entries = 8192000



{noformat}HPDRG0201E  Error code 0x51 was received from the LDAP server. Error text: ""Can't contact LDAP server"". HPDCO0192W  LDAP server tam_uat.bc:389 has failed. HPDCO0193W  LDAP server tam_uat.bc:389 has recovered.{noformat}

connection-inactivity = 0 in ldap.conf.



But errors is still happening. I will ask for a routing trace but unsure if this will help in resolution of this error.



David.",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,29/Apr/23 2:51 AM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230428-165125.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198620,02/May/23 8:59 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230502-105347.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198883,03/May/23 8:03 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230503-100307.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/199067,09/May/23 1:10 AM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230508-151012.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/199784,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS010996034,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,PROXIMUS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i184ln:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.2,,,,,,,,,,,,,2023-02-13 20:48:11.17,,,,,"14/Feb/23 6:48 AM;5b15d9e581c3df12acf53c4a;Please do search for previous items, this ssl session cache full issue is not some thing new and most of the time it has something to do with config options.

Make sure that if the have dsc  then dsc session time out is similar to webseal

Also, they must have made some changes that triggering it? what change they made?",14/Feb/23 7:43 PM;614dd566a995ad0073ec0622;Ok i will look into that. We have asked for pd.ivc.ira and pcap. I will investigate the dsc timeout.,16/Feb/23 9:29 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] I am having difficulty identifying the name and location of the applicable dsc timeout keys you are referring too? Customer stated at the time no changes made although [~accountid:5c53d3ac23f5bf672621c868] has stated that this customer has a complex architecture so we have requested pd.ivc.ira and pcap with debug/snoop.,"17/Feb/23 1:42 AM;5b15d9e581c3df12acf53c4a;Also search with “{{DPWWA1519E}}"" for existing Jira items, it will hit some items that talks about similar issues and what config options and values need to be checked etc……",18/Feb/23 12:22 AM;614dd566a995ad0073ec0622;[~accountid:5b15d9e44c4ed14b83af8723] [~accountid:5b15d9e581c3df12acf53c4a] [~accountid:5c53d3ac23f5bf672621c868] I just saw that ssl-max-entries = 32768 in the conf. We strongly advised them to set ssl-max-entries to 8192000. Do we advised them again more forcibly? {{DPWWA1519E}} usually correlates to this key? Still searching other Jira for {{DPWWA1519E}}.,"18/Feb/23 12:30 AM;5b15d9e44c4ed14b83af8723;If the “{{The SSL session cache has become full}}"" error continues to appear, then they need to increase ssl-max-entries. When I tell customers to increase ssl-max-entries, I give them a brief explanation like below:

“Each entry in the SSL session cache is about 250 bytes. For example, you can configure ssl-max-entries to be 4,096,000 and that will consume a little more than 1 GB of memory on the appliance.""

Note: I add the commas to 4,096,000 just for readability, remove the commas when actually updating ssl-max-entries",24/Mar/23 8:03 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] Latest trace showed possible issue with kerberos configuration. We are investigating.,21/Apr/23 10:40 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] So me and Nick analysed the case. Only the client to webseal is spnego; the webseal to the affected backend junction is a vanilla junction; no sso - just username and password. We have asked the customer explain the 401 from the splunk backend. Nick might be able to help debug the spnego flow on the client side next week hopefully.,"28/Apr/23 11:09 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] I was wondering if you help with our analysis. Is there any way to find any spnego traffic in pdweb.debug_10 for instance. Nick performed a grep for http traffic  : ‘grep ""^HTTP"" pdweb.debug_10 | sort | uniq -c 1’  and we got alot of http 401 unauthorised but how does know which ones are http 401 challenges to a spnego flow. Me and [~accountid:5b15d9e6dda5f94d06b985b4] have reverted to the customer to ask why the backend splunk server is sending a 401 back to webseal at around the same timestamp.



So focusing on pdweb.debug_10_.log; I focused on  thread 611:

And the user in question: id977320 which does appear in the pd.ira log. 

{noformat}2023-03-01-15:58:34.247+01:00I----- thread(611) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- Browser ===> PD ----------------- Thread 611; fd 284; local 10.120.133.132:443; remote 10.119.188.151:52872 POST /SHEA/app/salto/enu HTTP/1.1 accept: */* accept-encoding: gzip, deflate, br accept-language: en-GB,en;q=0.9 connection: keep-alive content-length: 205 content-type: application/x-www-form-urlencoded host: intrauat.web.bc referer: https://intrauat.web.bc/SHEA/app/salto/enu?SWECmd=Login&SWEPL=1&SRN=&SWETS= user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 origin: https://intrauat.web.bc sec-ch-ua-mobile: ?0 sec-fetch-site: same-origin sec-fetch-dest: empty sec-ch-ua-platform: ""Windows"" sec-fetch-mode: cors x-requested-with: XMLHttpRequest sec-ch-ua: ""Chromium"";v=""110"", ""Not A(Brand"";v=""24"", ""Google Chrome"";v=""110"" Cookie: PD-H-SESSION-ID=1_4_1_YaioMJ2k0Me7+g5Stfo+Sve4RElvytbr-aPqlhPIhZlL1rxa; PD-ID=drrNsHSM/gRUbbAma5TPee8vrt9tdRrDJ6beNZ/LDgGfi2baljuINQ5eFrgJ6sOcQHtDkWdiKP0OUsFTPlM6I+ZCh+f9yZS8tfw8J/n8SvMQ5Cobd4+KlgKiDbzymnsqty/6ayO76gTWS8ioWYKcDZys17CyDgdcflxztg8RT/1x85eWhAyuWto8Bzml2qWPVWhKoNTCC4tTlAAm40Eq8FHf+G+LVlqSqw4hFuH2VH47/mzCcMJrIIIYBGl6Vtll/naw7K27d6u7JzOFb8NgjGxOSxbdGrlGPo2hbV9H1fD3MeHOAW/u762Th2RuboSV; dtCookie=v_4_srv_-2D16_sn_F5HR1EUV15MGBPEUJ1MAABQ0T802HVGB; rxVisitor=167768270838955BLNQBN9BH8JFR09J6I8VEQF96PCPEI; AMWEBJCT!%2FSHEA!_sn_salto_enu=""MkJhVnJNMm8yUXJickVqYmpUM3hpMGllT1Z5SWV4UXRoc2xLY0NnTk9IMGw1TU4vNzRLNW5WdEMxZmlqRDVBOWtWREx3Nyt6K2NueFdIMEV5aFN3SU92d0pwRzA5ZmtUcVYyVTRLdWJYbVJpUXBLVWlHV3Q0eURodUJYSkJnRzU4aHlNMjk2VFhZbUoyOVNHcXY1L0d0ZE9pLzJzQnJJM0Q1UDc0cXNnOUJsV3FjZFFRY2Y0UDI3SG0zZ2JYQ0MwM2h1ZmQyKzlRaXc9OWF2R3Z1VjBnNmZ2bWdabU9MN3F2Zz09SVgraEFNN2ptcDZQTEExUGxmcWlMWEFRaXNxbnpMRkQ=""; dtLatC=6; dtSa=-; rxvt=1677684511825|1677682708392; dtPC=-16$82709197_94h-vAMLUCHOLRRARPFLVTOFKVUJMOMUGAPFM-0e0 --------------------------------------------------- 2023-03-01-15:58:34.248+01:00I----- thread(611) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- PD ===> BackEnd ----------------- Thread 611; fd 307; local 10.120.133.132:50046; remote 10.61.104.33:8920 POST /SHEA/app/salto/enu HTTP/1.1 accept: */* accept-language: en-GB,en;q=0.9 content-length: 205 content-type: application/x-www-form-urlencoded host: she-a-webi2.int.corp:8920 iv-groups: ""LANNL"",""PBGC0102"",""PBMT0992"",""PBOL0300"",""PBWT0001"",""PBWT0002"",""PCDB1001"",""PEMP0010"",""PNPA0006"",""PNPA0022"",""POMS0001"",""POMS5002"",""PPCV0001"",""PSHE0003"",""PSNS4000"",""PSOC0120"",""PMCOM0001"",""PPFE0903"",""PCBP3001"",""PIVW0001"",""PING0007"",""POES1011"",""PWSL1011"",""PDOF0002"",""PLOM0002"",""PFIONA0005"",""POAL0002"" iv-user: id977320 referer: https://intrauat.web.bc/SHEA/app/salto/enu?SWECmd=Login&SWEPL=1&SRN=&SWETS= user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 via: HTTP/1.1 intrauat.web.bc:443 origin: https://intrauat.web.bc sec-ch-ua-mobile: ?0 x-forwarded-host: intrauat.web.bc sec-fetch-site: same-origin iv_server_name: intranet-webseald-ws-a2-int.web.bc sec-fetch-dest: empty x-forwarded-for: 10.119.188.151 sec-ch-ua-platform: ""Windows"" sec-ch-ua: ""Chromium"";v=""110"", ""Not A(Brand"";v=""24"", ""Google Chrome"";v=""110"" x-requested-with: XMLHttpRequest sec-fetch-mode: cors Cookie: PD-H-SESSION-ID=1_4_1_YaioMJ2k0Me7+g5Stfo+Sve4RElvytbr-aPqlhPIhZlL1rxa; PD-ID=drrNsHSM/gRUbbAma5TPee8vrt9tdRrDJ6beNZ/LDgGfi2baljuINQ5eFrgJ6sOcQHtDkWdiKP0OUsFTPlM6I+ZCh+f9yZS8tfw8J/n8SvMQ5Cobd4+KlgKiDbzymnsqty/6ayO76gTWS8ioWYKcDZys17CyDgdcflxztg8RT/1x85eWhAyuWto8Bzml2qWPVWhKoNTCC4tTlAAm40Eq8FHf+G+LVlqSqw4hFuH2VH47/mzCcMJrIIIYBGl6Vtll/naw7K27d6u7JzOFb8NgjGxOSxbdGrlGPo2hbV9H1fD3MeHOAW/u762Th2RuboSV; dtCookie=v_4_srv_-2D16_sn_F5HR1EUV15MGBPEUJ1MAABQ0T802HVGB; rxVisitor=167768270838955BLNQBN9BH8JFR09J6I8VEQF96PCPEI; _sn_salto_enu=""MkJhVnJNMm8yUXJickVqYmpUM3hpMGllT1Z5SWV4UXRoc2xLY0NnTk9IMGw1TU4vNzRLNW5WdEMxZmlqRDVBOWtWREx3Nyt6K2NueFdIMEV5aFN3SU92d0pwRzA5ZmtUcVYyVTRLdWJYbVJpUXBLVWlHV3Q0eURodUJYSkJnRzU4aHlNMjk2VFhZbUoyOVNHcXY1L0d0ZE9pLzJzQnJJM0Q1UDc0cXNnOUJsV3FjZFFRY2Y0UDI3SG0zZ2JYQ0MwM2h1ZmQyKzlRaXc9OWF2R3Z1VjBnNmZ2bWdabU9MN3F2Zz09SVgraEFNN2ptcDZQTEExUGxmcWlMWEFRaXNxbnpMRkQ=""; dtLatC=6; dtSa=-; rxvt=1677684511825|1677682708392; dtPC=-16$82709197_94h-vAMLUCHOLRRARPFLVTOFKVUJMOMUGAPFM-0e0 --------------------------------------------------- 2023-03-01-15:58:34.264+01:00I----- thread(611) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- PD <=== BackEnd ----------------- Thread 611; fd 307; local 10.120.133.132:50046; remote 10.61.104.33:8920 HTTP/1.1 200 content-language: en content-length: 946 content-type: text/html;charset=UTF-8 date: Wed, 01 Mar 2023 14:58:33 GMT vary: accept-encoding x-frame-options: SAMEORIGIN x-content-type-options: nosniff cache-control: no-cache x-oneagent-js-injection: true swerpc: true x-xss-protection: 1; mode=block timing-allow-origin: * strict-transport-security: max-age=31536000;includeSubDomains server-timing: dtRpid;desc=""-240786096"", dtTao;desc=""1"", dtSInfo;desc=""0"" Set-Cookie: dtCookie=v_4_srv_15_sn_F5HR1EUV15MGBPEUJ1MAABQ0T802HVGB_perc_100000_ol_0_mul_1_app-3A2b5fd9cb0e0846d6_1; Domain=.web.bc; Path=/ 
{noformat}

This thread does get a 401 form splunk around the time of the issue but i do see any issues with that user validation in the logs unless you want to check? I don’t see a 401 challenge back to the browser for this thread? I suppose I or others could write a script to parse a 401 challenge from the log based on a string from a standard response. I don’t know where the issue is? Is it the 401 from splunk? Why would that cause such an error unless the user is already validated with a credential found? Are we dealing with two different errors? If one cannot be validated in PD as a valid user then one cannot attempt access to splunk to even get a 401 from splunk?","02/May/23 8:08 AM;5b15d9e581c3df12acf53c4a;I could not find any log or traces where user id977320 is having a 401 error,  as you guys could not see that in pdweb.debug log or not even in the corresponding msg__webseald-intranet.log



So, I could not co-relate those errors….



One thing will be very helpful if you can get those:

Assuming they can easily reproduce the issue then can you collect full traces in a single file i.e.

turn on “pdweb” traces via LMI and set the trace file size to a big file like 80MB or so, that way, it will be easier to trace code and see where things going wrong.

But , do make sure that they are using “ssl-max-entries” entry value as suggested by Reagan, I also so similar values in other Jira item where customer was seeing similar issues.","02/May/23 8:59 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] 

Below is the screenshot of the customer sees which a refresh resloves the error. Below is the message logs with that error. So can you look again at the traces and find what out is causing this? ssl-max-entries = 8192000 as checked in last conf file. Do i need to ask for traces with different file size if that would help?





{noformat}252+01:00I----- 0x13212072 webseald ERROR ias general azn_authn.cpp 345 0x7f3b46ec7700 -- HPDIA0114E Could not acquire a client credential. 2023-03-01-16:03:01.033+01:00I----- 0x13212072 webseald ERROR ias general azn_authn.cpp 345 0x7f3b4f18a700 -- HPDIA0114E Could not acquire a client credential. 2023-03-01-16:03:01.320+01:00I----- 0x13212072 webseald ERROR ias general azn_authn.cpp 345 0x7f3b4abb7700 -- HPDIA0114E Could not acquire a client credential. 2023-03-01-16:04:25.952+01:00I----- 0x13212072 webseald ERROR ias general azn_authn.cpp 345 0x7f3b4e3d4700 -- HPDIA0114E Could not acquire a client credential. 2023-03-01-16:04:29.533+01:00I----- 0x13212072 webseald ERROR ias general azn_authn.cpp 345 0x7f3b51598700 -- HPDIA0114E Could not acquire a client credential. 2023-03-01-16:04:29.788+01:00I----- 0x13212072 webseald ERROR ias general azn_authn.cpp 345 0x7f3b53451700 -- HPDIA0114E Could not acquire a client credential.{noformat}

!image-20230502-105347.png|width=764,height=622!","03/May/23 3:38 AM;5b15d9e581c3df12acf53c4a;I could not find the log file that you mentioned but if that log is part of the msg* file then that will not help us debug the issue as it will not tell us the whole picture.

But getting the full traces i.e. “pdweb”. and “ira” i.e. “ivc” traces along with timestamp and what they did to reproduce the issue will tell us more and will be helpful to debug.","03/May/23 8:03 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] 

These logs are there. Does that help? 



!image-20230503-100307.png|width=1517,height=955!","04/May/23 1:59 AM;5b15d9e581c3df12acf53c4a;Yes, I already checked those log/traces of the location that you mentioned above. I even traced the user id: id977320 but with these current log, I could not traced the failure at all.

If the customer can easily reproduce it then our best bet to find the issue will be to collect full traces as I explained earlier when ssl-max-entries is set to a large value.

Also do turn on ivc i.e. ira trace like before along with “pweb” full trace. This “pdweb” full trace in a large file will give us code path also which is much easier to trace find where thihgs going wrong.

When you get the new traces, please get the support file which will include the conf file so we will know exactly what setting customer was using.",04/May/23 10:51 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] The customer has two reverse proxy appliances and one PD appliance. As stated i have affirmed the ssl-max-entries on one reverse proxy is 8192000 which is the one whose support file trace we have. I will ask for new traces  with proper size and har files. Is it possible the session or thread moved to the other reverse proxy? I find it concerning that we seem to have relatively good traces taken with an error in the message log but nothing in debug or snoop to indicate why? Just to follow up from your last update; were you unable to find error or just the trace logs were simply inadequate or is it possible traces are no good for this issue?,"06/May/23 6:53 AM;5b15d9e581c3df12acf53c4a;With traces that you have, found the error but I was not able to co-relate it at all.

That’s the reason, I want full traces i.e. “pdweb” in one single file i.e.  set the file size to big, depending on how often the error occurs, if the error occurs rarely then make the file size big like 50 to 100MB , otherwise say 20MB

Also keep the “ivc” trace on.

Basically I want to follow a failure situation from start to finish…with full trace i.e. “pdweb” traces, it provides source codes with lines, so it will be much easier to follow the sequence of events…….",08/May/23 8:38 PM;614dd566a995ad0073ec0622;Ok. [~accountid:5b15d9e581c3df12acf53c4a] Sorry i need to clarify something: So i enable the pd.ivc or pd.ivc.ira trace?,"09/May/23 12:40 AM;5b15d9e581c3df12acf53c4a;let’s go with:

pd.ivc.*  ","09/May/23 1:10 AM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] Unable to filter for pd.ivc.*. Maybe i will ask customer enable all five pd.ivc traces separatley:

!image-20230508-151012.png|width=1052,height=692!",09/May/23 1:24 AM;5b15d9e44c4ed14b83af8723;[~accountid:614dd566a995ad0073ec0622] The top row in your screenshot is what you need. The row “pd.ivc” is functionally the same thing as Motiur’s request for pd.ivc.*,"14/Jul/23 2:58 AM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] 

Got logs back from customer with single instance of the aforementioned error.  It appears to be Thread 67.  It also appears this thread spans a few minutes and two different debug logs? Was the thread number reused? The ivc shows a {{principalName=id820506}} which i couldn’t find in the snoop log although for that thread I saw another principal name been referenced?



Webseal message log:

{noformat}3742 2023-06-20-13:13:59.580+02:00I----- 0x13212072 webseald ERROR ias general azn_authn.cpp 345 0x7fb3592d1700 -- HPDIA0114E Could not acquire a client credential.

{noformat}

Snoop log:

{noformat}(67) 2023-06-20-13:13:59.570 Client (10.110.82.153:57606) to WebSEAL (10.120.133.130:443) sending 8450 bytes
GET /cgi-bin/index HTTP/1.1
Host: intrauat.web.bc
Connection: keep-alive
Authorization: Negotiate YIIVawYGKwYBBQUCoIIVXzCCFVugMDAuBgkqhkiC9xIBAgIGCSqGSIb3EgECAgYKKwYBBAGCNwICHgYKKwYBBAGCNwICCqKCFSUEghUhYIIVHQYJKoZIhvcSAQICAQBughUMMIIVCKADAgEFoQMCAQ6iBwMFACAAAACjggmMYYIJiDCCCYSgAwIBBaEJGwdCR0MuTkVUoiIwIKADAgECoRkwFxsESFRUUBsPaW50cmF1YXQuZ2xiLmJjo4IJTDCCCUigAwIBEqEDAgEDooIJOgSCCTZuQki4zWwEnnk7OwsFo4oGutcz+jX6vXeKsZyr/pZnX9JMFjjjquouuauUaLH2ebToAezZAKdcPzYikeg7FO6hLpUXsacN/zkTxWNOuKv6T9RTqb+czYQ9ZrKhyKm9MzmSG+qCq41a63QAc4A0y709Ekz08ftTWMqtw64L4hVojQzsH6HC0kSex3e9Tco/i4U/m/0+idd1AKoSHiTTEQ+fSw4dyIfm88TgR8cnxYZHkkypPULxM56EC2bZWe8MlfymTmndIqFqL/XP3UrFYNp7wHR/uCyy4tK7nD6EUMrUmSpXKhMArWWl9otmG0Bkj0S5lEO7O2qxAKPQqN9wZb+ynCOszSvODsDY8vbf78aygRh0KxmawYI3lHU0ZUGXcfsJ6ZYmWfdeogJob0aWdu5Z0ULQq34xRmeiweWvd7pPb/spi86789sWOJw3c4MsMNrM8es7U/foCOH35b8QFxX0O2cSg23lZ3VGLzBt61UMRwgNuVfx0HUbp/EJ9PnsO5ZpRCr/K6lMn2+VLCvX3kG1VuNRIJmy1lkUPCgL3IZg8M1JS0WAIc3g45awlKcDaYMJjAmq1STupRqcwTRk3lhyX6A1un9juhbFGFYkjIxKFbRBS8VaD0QADVbYlNLIvOHxuR6R+CXaNpmIX2fCLn3TImdVZDX7o9plkoJzV0denTV03X9Z1a4+iiBxxZYzYrB8NoVpFpVGMhoODz+wXHtqzNYrL8KnbmLh4BgZDCFM779F2wb68hTGu+gyRXM3wQW/ftwDSaFxG4hlpswkoXo+VXnOTqATyooztgJoduYMAckJQTQmpgjDHA9s9VSPz/lSDMuw3fUC/qMFfHvb5/zsIRpL+e223Lx2UF41vFPuQbBkrqKPYPj5EI2FdTBeNz1CrtOlMLp57Ahsr9AvysCDeYvspJ3O8vBP74E8VI+4fhybMupLAkaMkGagQ4Roxi3dzBldQyC8f5DepZgop8Uh3X0zTf0ROoxgmiNfCgoTEZGRTZGf4ks1RPQ65sAWD/RRu75H10ITZV0GzKF4gNxzPXfUqx2L4tK7u5LcnQTE5JF9eLTWqlc5Vi2tQYkGPD39R+ITc4VTvdU81624HvbU/tK0aXVawWaw5QnDpRBn4OtOGrUdGhRxrp3BFl+F7p7I0FfVl3b8ZwW/gM6lS9GEnzuk2G3dlgk9eeXlqQaqjKZiHNArLiYb9f/QUSvv7i3V8g6U9zRbjn2EsWguGCy1iksOuC5I94G5cRsAvwi4uX2rjILs7twCgZ/0l4T/x4/TUuWy/bUE28HMB/FHsytPV3CJWN19yBJVBROXjd9gh6LIgVa6RPWxRdZqgkftbyFOjitwhhnkOhiNnMKR5CXb/fDpzMZvUdRSkE+dRz5gq7m7JLe25EsF9z8dCDnqO7VEmqgYPxj/BQET2ASkTOIXAgGGBLLGAuzO1qMuG15j7fvDBC7JlQEFv2UArbtmVLGArnWY1SKd2nluxqqYtkLNrQVo56/YwbQC/RDMC38X1cmyd29hCuTTkqtCmBXZ5dofOODtfoVWkR/RCa2JSTbJpR1rKnP3m17oeU0UOfOnVHP7NQC0y3TJMpRiBNGky1tT7XL64oSyD9OMfmLPPHcN1MBnlmbCCgBAmtPfA/g2taPV5NeTt38VYd5B+6CpwsIVUHcfA8m7PdhfoiswzzBiQwkx4gNxIdygqVKCMzHHfVTaCDpn/GY1R/8dZYeXpsKLukcUvHPFxhiY6GumyXf7nawBtqMKfpPSNG5YQThZpV30ilK+8vWxBT2J782C4//ask6ViHZtObJriHAckW822qeoHbKns/HZi4XvLqpFpQ7V0XhT/UoSKoFchbDWIL+V3jbRCAb6PWn+EV9rPVqHLYwW9f27ZCA+IBT75v6cvRtJQEX8PDodXtHDUxYLu2YGOrvGkPg5opta02AHkl435kFOSZVhwKOtgnMHiWzDN/mpS6M9kuc1MIa994D95HnMO3+yq1jseW6k8zbW3JOoIYMFuP7Id5B2S7gSV+NdeZxvMGBHIqWdg+fkPV7HiVxRGiajpYg1nsQEEjsHaAfAh8/Aq3IPpFD7yWIRim6SisOJ4hY/mVJCLsayJCGjXIkvuj35vk77jwqR0ec2Bj6Q+MuDgHDMFqPuXP3KUu3rwAy1n18nquz/jFHLJQkhBLI3bj++JkC4U1E3XtUH3T+5f5Dq4hfAgpieIviPRBmSmwFqnu4JhjsbY1itkNJeZO4dL9pTJ86/Vx/nskDHboMnr/wrpFXkEXRRwZpMdsrXTNQYUZHYSrU+Iy04wKZaohKvL4W88xNSpxE4mpCrOeQGM+6h2yBk2mhyxWp5BVKAYe7hXAStO0q7MjzuLarN0bnBqcjc+gzEoWId130lEiG8ZQxXP2uCEFE9N1Ax96rcFTTwogJmryRLFpyPxL+cNdJAaiSTa9+JWgR3QFFUK9cFoDEw7vECzr6O+BppsWIpWWUwTZ9CmotghWxmxfHGCEbNpS8ygEWf8fl3rFLOcxo+Pn6DAqY477+3NLkK7vrqmpbAfFnJwzTMHdDl04FVNfmDVauWG5gPWZwemOC4vYZ81Pfx/dvjxfORKT/aWakwId7+HTh+3cfUabwehZYq6LJsD2X5LvshjnT8Z07DlHJ+ADzj8MgeGswLZ/5cNJiP6rhO1Ut5hIkT6/nq8ITSFVh6g9vQOLPHxJQKU7jy5zTo0NL6dCzw954wJBpCW5rawELqFG0TfcY/mcXV3gesZEE53gMiIGpQYJTKekvkClV9O/Xsuyy31K26k/IUek5zHqWPwyVcggvQQ9uoRKvOgUhZcVq5UcPLoJ9OD8RjqrTNrJhrGKkv+24Eq+c9GGz6vhYt8zJgSJL0nooJnnDtYSbNXGdLPgQgMyxm3cMq6CMXMTKAPomzzkKdLoQMVXFPNW629R98yLrwYVWkAZ/iyq/jVQQFYwUfSyajrpukckwuKAxsXql5nrXB5OcFlOz34DlbvHYdb59VJAj6gjCY5a/EJF13mkHRlBY/gWL0araYzEsCP+Ml8tks/X8KGd/Slsks0PPg+T2wuEfmMoGLi9A0JfP0eUtXemX1HlBOKYzKu4s8vGzHI+J1cED2iu8xZ2T4LHKrW287wpit8+th+WRVdOC/TEekggthMIILXaADAgESooILVASCC1BsSHAe4iqVZ4Ypmwu1THl3PN68Vcf5lpzm2Xy0pST/pnYMlg0XSpj2+n+iY1+VQCZTK6H33CLdBcmaiZ9BKDWIhWeGKTt3WQ519gXIELu/rjtEFzuCb+PXAg5y6GVKE9cW8D5ofRVkue4r1hs/3sB8U38Ep5ZoAzqhYkIBIxuYjFTdTWysLqhB5Pd5ejnFlsX2RZeKpyQ5T8xxzXwKmxVnGDwnbUSC01u4oCoAFmA5hraYJwKQODnsvorWC48v+72/na7fN7NRCQRpSJtcoVBQ/suhZsZ8L9SpIC7H1Tqfx/nsiEs9F0Uy82PORvUYdaJG3JXshXD9FjEJ0gmyMSfi8/IzYFgZHP3wTZ/SUH/ykZsHzTzolBgSi65MAh//umSw1IM+XjCxNgpPOWy3Ewh1pV0fcB76vuQcmiFnAgmqIaYDwlXWqau+TFYtnfVPeXxazwquiPZc1wJXKRyur0+zni/Mcdrv41tA3fyHaB1EtWBhE/R7CM51PCq7TN7B9MzwVjUHZsEVstnFeCyviez5XXbt/eA7644PbaylJrQeA84V6CE8rFlx8tYVVOxkF4f8eEo9X3TJegSFEvPGZwd1TDycGdYw9iNgjdzqFUikvEUjlShuvIXtlxFqStAZQyp/MAkFhezsHRxjBj90FY17GSFXn+kjKAoqT0SPvRMbz28CZogk160iQz0RxUzeUXKUjV+P++BL4qUfyEUNUCbG6n+iiB+cXF9FgMH/wYP4pzKxFCG8YxUkAfaQYeSlWaMz95W77c84B1z8U3D4kY6gEgNia6PMyUGBLK+uT7W4pMjalpDpTFE9bpNA+2Re4lS5SHY1ZhO+bucXkkS0+dCadb0WIiFQCYze1njaPKvchUlF2EBPUxurrJgl/uT6X0nvTxV2xPv97pXCTHbe6duW0I2aaYciq85RC1WGC6qVS6Fl7GErFrIwjvyF31aZeZpqONGsP7fn0GjIfkdFoJL8l2aUem3gdt7ZLT1zyy4Z50M51cpK3zQmOKT4WS2BHyei0CtmSFS2Io7fQyd4d+A2NKMrHaxe9owp+DwQ26jUCnaCoxl6BpNH6T7XKHIGU3vhxtetTK0CYAH3s+cyRu8ODCpf7f0iKg8g1qrZaKywI5n5Hz+DVwzhMixBxSxG1NPLE3jgkrEP2V8anCiC3lbYsVy7haJIIOtDsdSIyXzF92at02h5RcMVMKOXYGhL/tqZemUbBBkO3UU8Yx93xQ2SXDaCMQIk9ua04rD39LR1rsv1c/AUJ0zSt2GaDRfA9FicD8TCQmEhRv5sqaGmEtB7edNP/6K1HisYKMVtul93UdTAc6IFHydGc/V7B/mKXOlzVIhWZkzTztTDDiUvBFThcIdC574FZbEjWoofDPrgNhw0pArk97zYukI3BCqU+CcM1ldKE15oS8M0ZW92CciRS+kwHOIAlaAS7+AGPYKlb9j9kmGJc+EKBqIxd7K7cCOpg0XDw+Zf5nQLfgT6UI3cDKd5AZuqqIvJnO7zUY4HPIFfviGnt6hDStIdW8lGP3AYDA/YrxkIhqLX/SnTkE/dgsoO4xjqjNV0kZK5tzP7x30dTfmrbdpPlyoGbbZ32tmE9Sk7J3PFBoKSx1xDvAZnxP6E+DMA82ZuxnlETFxwK6wdwW8oWt9a2H8TbIdoro+yJmm0fNsR9/ZLnvQ+o1CVaRRZ63ICRrrgdmBpn6NLeC/6rSrj/YZ7Pr5RHxsETqGV8ylYogrxN9VvWJpTvFCk+UeJf8wvlulVsDTNWaORCHv0IkHAURkp85iop79Myu5mBjU5pvpvGc76QH6YdFSMmaLOXED4LCcqUXveR+S3TkPKewcXSxXqORuVjJOzKuXFzEoV2lit8T+bvdUTF4xYRJ6TZWrlbl64t+hoWVaxyqNi/GvyqCMMtFQyEEw9mjVzvtPpxAH17SIBmrZoZmCfH4W/x5D0auyy8+EE9uPicOaVIkyYA+Dg8eXrSuylpWWP8/uHZhQ3bjz81aDCU0Za7LcUv5DjuVslr/e+MDnIG985JFz4GSF849j4wknxMl3nHR5bIHKuectQRAyz9giEP5cyzUDspL2wvkvzpagCEkYSD5zSTh2IZCOlYsZ/3+kdqM5o9LbZRpLlLG19czjinGFH8DQ3Ddgfla+Y1u/aqg8GWNoopb7ko+90tuszhXLLU98zKwTFLwpRl89mFcebDVO0wao4TPxL1IYEjJv5es5EiijNAOK7GvgX8eFKyStFe27/aIn2qIHitQ4lVJ07VYYOmh5Ux0/XzVKCy7KVmpMzofnPYMU56MlEq6XPN8UlNyhxzN1hlqIGcznXnquLS0iZ1orDS4DtnUNXILNNi4fgl9jjq0hBeLh/bvkHkUUGJGFasWbDFmDP41KIAV2dNpHKq4xNQYLIOBNym70R8uKqSzlOrSJhMLzr0ySiNymPZiSS6rW7kdjvsQVUX9iS3O2Ad6hH4Y/4CG6rOoXsdaWuf3d2XDWBfBd8noYyIQeuEibgf2/uQf0ThzeIZ/OGVx4M8hPV1soaT/W92k1FW0BtMki/+rFg/o06qqz8ikNf9sa6eQrH+pxdSEeOONnWIq0OkaLOZvl8Wz/h+loOtnmcC79Qlz4HrSkv/ef846pAbjgNbUfWq2snnvNEswcsoBtgBC/wllq3jZvOE0y0tyIytEZ+HVpRDfMODRzuUZ3H8pEAmhHn3ajhDRCCad+eMzBs9F1R7j380B6dFnMkmm/KZlthBs33cfaC0lTpgWNswdDbXsYx0BfD8Js434tq9GnwTgVg2UfaIt20AlCEer81Cam/z3NqreiK29uLj2BasRkvRvKKkZ4SG6iupTTSe7rJP9ouogFxaDlQrjNlNPqKHxkENhpLr5Ai8Oi80O2QHD37zV/1Odvv8oKwNoGTvKv+pypnh9g2K0WRDUPrDoQXHcXrVD+rUtgqj9Dj/FdhfruMcSrOuhas4LD4rnowps3d+vxGX0bPz9iQdnpPdNA4ckxYSCVq6lZz7KKO+uGAlH51MziGBug5cVuRSYfSsP2Wn8nxRv2yoqk6Epkp0VJ9H4QAl8SSCh/y6rTXxedH2bumW8St90e7g6y4fejxcgBgZK+wsaDPwZIlEBOfbw4qGwIWLTENPnBPJlBqeBoLys0z4IyEtJIgN2zSacCZp5ze5O+Ne60yJSh4mnQ1tAjp+isOyeotAfE2vFOLKQ1px93zoSge4wd7Mp0dXcIyN3vnjotJrokmAblea6bzVt7xVBWbdG+1bn77G7yAckHq/Dhk7bceFqnw3FMPNRiq7teDVnX7mjDYfGfNIZTWX3QbXkM6guiNYitCE17sXQRf6JT5n9tu2tXAJ8oxAdTBTPpnIPbTN85r6nZYN5/LmBITBMYoLp2P+PvWbRA3NbROU7v5WIEGssbVV0hi8Wuef67djE32Y2RzSvjbjWpQbmP8dHeFH2HZxXdrmHRkGX0BMOrf0x13LWse0XPfbgOl3WtszRbLr6cO23xTRr9Ni8IOXjHqbacF+7A5VRYfDe2UQS+iYNPoxZyUcgZhf22RJVDTeCkQazcV4rbWTG2khcuQ5K9BAx6RChbC9WPHvOSYKKUH0/YVGgzXBII/q0mR3lvkuW0zkmXE6/cpzSs/kXWklPsTJ1SrciieoFnv71FpKSj87kMMJlXPwotovIb8OFHfk9hAp0OdMTDcTviYAycQQlqrFhAZRLafHk+7Qhtm7b1JMDkzJtPrsYoXiWaJ/MD7Sm0mfYS14KpUtmNj+4htL2QJAggN8LEUXJCa3Xx63eFxcVLoZuT5/TrXn9Vnr8fyQZp5wpZYcKB8SaW4wS7K8N62WVBUIZD2c5m/lMLS4473uYFL/LtR/RnzgCGX
sec-ch-ua: ""Chromium"";v=""112"", ""Microsoft Edge"";v=""112"", ""Not:A-Brand"";v=""99""
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: ""Windows""
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36 Edg/112.0.1722.77
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-Dest: document
Referer: https://intrauat.web.bc/login
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en;q=0.9,en-US;q=0.8
Cookie: PD-ID=XNb79nCL85OX/SXXGPkTnc/CNBR27lI+7suj2W0znpoq/kY/i/wELQKszaajEVSzF5U+pPQi7b9qcV/1rm32fXPbNaQBVq8Po2EA/YNCYtlyOZNZuUtKU3iMHwBIXXvWNRoIeCpZGWOzTXJW5UOUL4fNoCUw/K2DmOaZ2ifBYGPZI1UWxuquFSmb88CMAIe0Jqgs9lCyvTi13a0EHt3DDAv1UbnBkKYnZ12byBpgHKgPC3U7axZQN+Yw13OVpHkUFYNyXjYAqCZeKq+6kzj7RU1U1kVzsnfEVjIuo1kKYIs=; PD-H-SESSION-ID=1_4_0_zJvr3SU5cerhZIMldySt0sBwxgE-fZGiyKPLtZpDkzm8d+Ty{noformat}

{noformat}(67) 2023-06-20-13:13:59.586 WebSEAL (10.120.133.130:443) to Client (10.110.82.153:57606) sending 8439 bytes
HTTP/1.1 500 Internal Server Error
content-length: 7638
content-type: text/html
date: Tue, 20 Jun 2023 11:13:59 GMT
p3p: CP=""NON CUR OTPi OUR NOR UNI""
cache-control: no-store
access-control-allow-origin: *
access-control-allow-credentials: true
strict-transport-security: max-age=31536000; includeSubDomains
pragma: no-cache
Set-Cookie: PD-H-SESSION-ID=1_4_0_zJvr3SU5cerhZIMldySt0sBwxgE-fZGiyKPLtZpDkzm8d+Ty; Path=/; HttpOnly
Set-Cookie: PD-ID=XNb79nCL85OX/SXXGPkTnc/CNBR27lI+7suj2W0znpoq/kY/i/wELQKszaajEVSzF5U+pPQi7b9qcV/1rm32fXPbNaQBVq8Po2EA/YNCYtlyOZNZuUtKU3iMHwBIXXvWNRoIeCpZGWOzTXJW5UOUL4fNoCUw/K2DmOaZ2ifBYGPZI1UWxuquFSmb88CMAIe0Jqgs9lCyvTi13a0EHt3DDAv1UbnBkKYnZ12byBpgHKgPC3U7axZQN+Yw13OVpHkUFYNyXjYAqCZeKq+6kzj7RU1U1kVzsnfEVjIuo1kKYIs=; Domain=.web.bc; Path=/; Secure; HttpOnly

<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"">
<html xmlns=""http://www.w3.org/1999/xhtml"">
<head>
<meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"" />

</head>
<body>
<table align=""center"" width=""690"" border=""0"" cellspacing=""0"" cellpadding=""0"">
  <tr>
    <td width=""523"" class=""MsgFrom"">Your e-application <span class=""Tag"">access</span></td>
    <td class=""Date"" width=""167""><br />
    <span class=""footer""><img src=""/images/logo_proximus_medium.png"" alt="""" width=""138"" height=""29"" align=""right"" /></span></td>
  </tr>
</table>
<table align=""center"" width=""690"" border=""0"" cellspacing=""0"" cellpadding=""0"">
  <tr>
    <td colspan=""2"" align=""left"" valign=""top""><img align=""left"" src=""/images/mail_corp_line.png"" width=""690"" height=""7"" /></td>
  </tr>
  <tr>
    <td valign=""top"" align=""left""></td>
  </tr>
</table>
<table align=""center"" width=""690"" border=""0"" cellspacing=""0"" cellpadding=""0"">
  <tr>
    <td class=""content""><br />
      <h4>Error: Erreur du serveur / Server fout / Server Error</h4>
      <p> Cher utilisateur, Beste gebruiker, Dear user,</p>
      <p> Votre requête n'a pas pu être traitée, voir ci-dessous le message d'erreur (uniquement en anglais). </p>
      <p> Uw aanvraag heeft gefaald, zie onderstaande error (alleen in het Engels) </p>
      <p> Your request has failed, see below the error message. <br />
      <p>    WAS Team. </p>
      <table width=""100%"" border=""0"" cellpadding=""0"" cellspacing=""0"">
        <!--REPEAT THIS FOR LINKS START-->
        <tr>
          <td align=""left""><table width=""100%"" border=""0"" cellpadding=""0"" cellspacing=""0"">
            <tr>
              </tr>
          </table></td>
        </tr>
        <tr>
          <td align=""left"" height=""30"" style=""padding: 5px 0 5px 0;""><hr style=""height:1px; border:none; color:#c8d2d8; background-color:#c8d2d8;"" /></td>
        </tr>
        <!--REPEAT THIS FOR LINKS END-->
      </table>
      <h6>Diagnostic Information</h6>
      <p>Method: <em>GET</em><br />
      </p>
      <p>URL: <em>/cgi-bin/index</em><br />
      </p>
      <p>Error Code: <em>0x13212072</em><br />
      </p>
      <p>Error Text: <em>HPDIA0114E   Could not acquire a client credential.</em><br />
      </p>
      <table width=""100%"" border=""0"" cellpadding=""0"" cellspacing=""0"">
        <!--REPEAT THIS FOR LINKS START-->
        <tr>
          <td align=""left""><table width=""100%"" border=""0"" cellpadding=""0"" cellspacing=""0"">
            <tr></tr>
          </table></td>
        </tr>
        <!--REPEAT THIS FOR LINKS END-->
      </table>
  </tr>
</table>
<table align=""center"" width=""690"" border=""0"" cellspacing=""0"" cellpadding=""0"">
  <tr>
    <td colspan=""2"" valign=""top"" align=""left""><img src=""/images/black_690x1.png"" width=""690"" height=""1"" /></td>
  </tr>
  <tr>
    <td width=""345"" class=""footer"">- Proximus Confidential - </td>
    <td width=""345"" align=""right"" class=""footer""><img src=""/images/logo_proximus_medium.png"" width=""138"" height=""29"" /></td>
  </tr>
</table>
</body>
</html>{noformat}

ivc log:

{noformat}2023-06-20-13:13:59.573+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:3275: CII ENTRY: ira_get_dn_utf8() parm: id820506

2023-06-20-13:13:59.573+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:3241: CII ENTRY: ira_get_dn_utf8_3() parm: id820506

2023-06-20-13:13:59.573+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:3044: CII ENTRY: ira_get_dn_utf8_4() parm: id820506

2023-06-20-13:13:59.573+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1428: CII ENTRY: ira_cache_user_get_dn() parm: id820506

2023-06-20-13:13:59.573+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:801: CII ENTRY: locate_name_entry() parm: id820506

2023-06-20-13:13:59.573+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:879: CII EXIT locate_name_entry() with status:  0x000000d2

2023-06-20-13:13:59.573+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1483: CII EXIT ira_cache_user_get_dn() with status:  0x000000d2

2023-06-20-13:13:59.573+02:00I----- thread(67) trace.pd.ivc.ira:7 /build/isam/src/i4w/pd/ivrgy/ira_entry.c:3703:
ira_ldap_search_ext_s() base: principalName=id820506,cn=Users,secAuthority=Default scope: 0 filter: (objectClass=secUser)

2023-06-20-13:13:59.573+02:00I----- thread(67) trace.pd.ivc.ira:7 /build/isam/src/i4w/pd/ivrgy/ira_ldap.c:3914:
ira_ldap_search_ext_s(): No timeout - calling ldap_search_ext_s

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:7 /build/isam/src/i4w/pd/ivrgy/ira_ldap.c:3934:
ira_ldap_search_ext_s: Returning LDAP rc x0

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:7 /build/isam/src/i4w/pd/ivrgy/ira_entry.c:3711:
LDAP rc: x0

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:1127: CII ENTRY: ira_internal_determine_suffix_order() parm: principalName=id820506,cn=Users,secAuthority=Default

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:1202: CII EXIT ira_internal_determine_suffix_order() with status:  0x00000000

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:1233: CII ENTRY: ira_suffixes_free()

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:1242: CII EXIT: ira_suffixes_free()

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1539: CII ENTRY: ira_cache_user_add() parm: id820506

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:2820: CII ENTRY: ira_cache_user_set_policy_data() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:652: CII ENTRY: locate_dn_entry() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:724: CII EXIT locate_dn_entry() with status:  0x00000000

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:2840: CII EXIT ira_cache_user_set_policy_data() with status:  0x00000000

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1626: CII EXIT ira_cache_user_add() with status:  0x00000000

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:3226: CII EXIT ira_get_dn_utf8_4() with status:  0x00000000

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:3245: CII EXIT ira_get_dn_utf8_3() with status:  0x00000000

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_auth.c:3279: CII EXIT ira_get_dn_utf8() with status:  0x00000000

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_policy.c:2396: CII ENTRY: ira_policy_check_account2() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.574+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1735: CII ENTRY: ira_cache_user_get_account_state() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.575+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:652: CII ENTRY: locate_dn_entry() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.575+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:724: CII EXIT locate_dn_entry() with status:  0x00000000

2023-06-20-13:13:59.575+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1757: CII EXIT ira_cache_user_get_account_state() with status:  0x00000000

2023-06-20-13:13:59.575+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_policy.c:1919: CII ENTRY: ira_policy_verify_valid() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.575+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_domain.c:3304: CII ENTRY: ira_internal_get_domain_DN() parm: Default

2023-06-20-13:13:59.575+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_domain.c:3344: CII EXIT ira_internal_get_domain_DN() with status:  0x00000000

2023-06-20-13:13:59.575+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:2531: CII ENTRY: ira_cache_user_get_policy() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.575+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:652: CII ENTRY: locate_dn_entry() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.576+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:724: CII EXIT locate_dn_entry() with status:  0x00000000

2023-06-20-13:13:59.576+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:2547: CII EXIT ira_cache_user_get_policy() with status:  0x000000d2

2023-06-20-13:13:59.576+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1904: CII ENTRY: ira_cache_user_get_has_policy() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.576+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:652: CII ENTRY: locate_dn_entry() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.576+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:724: CII EXIT locate_dn_entry() with status:  0x00000000

2023-06-20-13:13:59.576+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1920: CII EXIT ira_cache_user_get_has_policy() with status:  0x00000000

2023-06-20-13:13:59.577+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1944: CII ENTRY: ira_cache_user_get_not_migrated() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.577+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:652: CII ENTRY: locate_dn_entry() parm: cn=id820506,ou=users,o=belgacom,c=be

2023-06-20-13:13:59.577+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:724: CII EXIT locate_dn_entry() with status:  0x00000000

2023-06-20-13:13:59.578+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:1960: CII EXIT ira_cache_user_get_not_migrated() with status:  0x00000000

2023-06-20-13:13:59.578+02:00I----- thread(67) trace.pd.ivc.ira:8 /build/isam/src/i4w/pd/ivrgy/ira_cache.c:2612: CII ENTRY: ira_cache_global_get_policy(){noformat}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
clustermgr.conf missing on appliance(s),ISAMSUP-4772,279379,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,04/Feb/23 3:20 AM,02/May/23 10:55 PM,14/Jul/23 2:47 PM,02/May/23 10:55 PM,,Support,06/Feb/23 12:00 AM,0,,,,"The client opened this case because he cannot configure TOTP.  The investigation revealed that there is no config database started.  The client verified that he cannot view AAC → Advanced Configuration values.

The client used the CLI to force start the DBs and restart the cluster services. 

In each case, the following error was returned: 

{noformat}2023-02-03-12:44:31.655+11:00I----- 0x35E5102B WebSEAL-Mgmt-API FATAL pdz general ZProperties.cpp 606 0x7ff2930c7900

HPDPZ0043E An access function failed for configuration file /var/isam/clustermgr/etc/clustermgr.conf. The access function was fopen() and return code was 2.

Error: DPWAP0003I An error occurred while executing the command: /usr/sbin/wga_clustermgrd (0x1){noformat}



The support file confirms that the clustermgr.conf is missing: 

{noformat}/var/isam/clustermgr/etc:
-rw-rw-r--    1 root     root           703 Feb  2 15:49 clustermgr.conf.bak
-rw-rw-r--    1 root     root            50 Feb  3 08:00 clustermgr.conf.ob{noformat}



The client is running 10.0.5.0 and the cluster is a stand-alone primary at 127.0.0.1.

The client claims to have 4 nodes with this issue.  The 4 nodes were never clustered together, so they were all “stand-alone” nodes. 

I’m have no idea how the nodes got into this state.  The client claims that the last thing they did (with help of a local IBMer) was to change the ip / subnet of the appliances.  (They are in the DMZ.) 

I “thought” that there was a fixpack to rebuild the clustermgr.conf file, but I cannot find it.  Maybe I am mistaken.  Is there an easy solution to this problem?

I suggested that they rebuild the appliances, but they want to avoid that if possible.

The client sent 3 support files, one for: 

cluster, runtime application server, and verify access runtime.  (I had asked for a support file with all of the default options, but this is what I got.) 

The support files are in /ecurep/sf/TS011/964/TS011964745/2023-02-03/.",,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011964745,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,DEPARTMENT OF HEALTH,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,/ecurep/sf/TS011/964/TS011964745/2023-02-03/,,,,,,,,,,,,,,,,,,,,,,,0|i181xf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-02-06 01:17:25.533,,,,,"06/Feb/23 11:17 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c87cb8d88f9ec6ae0afb306] 

There are 4 different support files, which one should we be looking at to start with - 

Was there any prior (custom) data in config DB before upgrade or was it just the defaults?

Since you mention this happened only after changing the subnet/ip - 

I still see errors relating to DHCP IP assignment - Has that been resolved ? 
TS011964745/2023-02-03/isva_10.0.5.0_20230203-131506_s02671.support_unpack/var/log/messages 

{noformat}Feb  3 13:14:12 mesa_config[20889]: Trigger 'dhcp_lease_renewed' succeeded
Feb  3 13:14:12 mesa_config[20889]: Executing trigger 'dhcp_lease_renewed' for module snmpd
Feb  3 13:14:15 mesa_config[20889]: Trigger 'dhcp_lease_renewed' succeeded
Feb  3 13:14:15 udhcpc.gw.script: Executing: mesa_config trigger dhcp_lease_failed eth0
Feb  3 13:14:35 udhcpc[955]: sending discover

Feb  3 13:14:38 udhcpc[955]: Last message repeated 1 times
Feb  3 13:14:40 mesa_eventsd[1780]: Error: EMAIL response:unable to connect to SMTP server(n212.service.csv.au)

Feb  3 13:14:40 mesa_eventsd[1780]: Error: EMAIL response:cannot connect to smtp server (n212.service.csv.au)

Feb  3 13:14:40 mesa_eventsd[1780]: GLGER1001W:: GLG_events:: |response=email,event=GLGSI1001I,thread=19801|
Feb  3 13:14:41 udhcpc[955]: sending discover

Feb  3 13:14:44 udhcpc.gw.script: DHCP failed for eth0, getting link-local ip using zcip
Feb  3 13:14:44 zcip.gw.script: init, iface: eth0, ip: 
Feb  3 13:14:55 zcip.gw.script: config, iface: eth0, ip: 169.254.244.129{noformat}

* Check the host file entries on the appliance if they map to the new ip addresses.





In this place - I see a broken.txt for postgres - 

TS011964745/2023-02-03/isva_10.0.5.0_20230203-130434_s02671.support_unpack/var/postgresql/config/broken.txt

Here is a fixpack to clear the /var/postgresql/config/broken.txt
Restart after applying this fixpack. 

Name: clean_brokenfile
Version: *
Fixpack: [https://ibm.box.com/s/xkgcmd5wfqok9rq0hboglhckn4c58j9v|https://ibm.box.com/s/xkgcmd5wfqok9rq0hboglhckn4c58j9v|smart-link] 
Checksum: [https://ibm.box.com/s/s6gyrcquzoo24knnymps1jyykbi1elve|https://ibm.box.com/s/s6gyrcquzoo24knnymps1jyykbi1elve|smart-link]

This fixpack will clear the broken.txt allowing a restart of the config DB but doesnt guarantee any data will be moved from the previous state.



Have they tried switching it to just stand alone and not a cluster if its just one appliance? ","07/Feb/23 1:04 AM;5c87cb8d88f9ec6ae0afb306;Hello Asha, 

I’m pretty sure that the “cluster setting” is already set to stand-alone.  I will verify that with the customer.  If it’s set to “stand-alone”, should they try switching to “multi-node”?  

The support files are from the same system.  I “think” that they are: 

isva_10.0.5.0_20230203-130434_s02671.support → Cluster Selected
isva_10.0.5.0_20230203-130805_s02671.support → Runtime Application Server
isva_10.0.5.0_20230203-131142_s02671.support → Verify Access Runtime
isva_10.0.5.0_20230203-131506_s02671.support_unpack → System 

The upgrade from 10.0.4.1 to 10.0.5.0 was done by the client to see if it would resolve the issue.  However, the issue existed in 10.0.4.1.  I’ll find out if there was any custom data. 


","07/Feb/23 7:17 AM;5c87cb8d88f9ec6ae0afb306;Hi Asha, 

So, I know I opened this case about the missing clustermgr.conf file, but I’m not sure that that is the issue to be solved.  The issue to solve is why neither the config or hvdb databases appear to be working.

The client opened this case when they were at 10.0.4.0.  I an NOT SURE why they went to 10.0.5.0, because I did not request that.  

We do have a 10.0.4.0 support file: 
/ecurep/sf/TS011/964/TS011964745/2023-01-30/isva_10.0.4.0_20230130-120324_s02671.support_unpack

FWIW, the clustermgr.conf existed in the 10.0.4.0 version: 
/var/isam/clustermgr/etc:
-rw-rw-r--    1 root     root           703 Jan 19 11:54 clustermgr.conf
-rw-rw-r--    1 root     root           230 Jan 19 11:54 clustermgr.conf.bak
-rw-rw-r--    1 root     root            50 Jan 19 11:54 clustermgr.conf.obf

When the customer tried to create the support file, this error was logged: 
Jan 30 13:17:06 mesa_config[15188]: Error: DPWAP0003I   An error occurred while executing the command: /usr/bin/setuidgid pgresql:pgresql /usr/bin/pg_dump -U www-data -F c -p 2020 -f /var/postgresql/config/snapshot.Fc config (0x1)

The previous version was 10.0.3.0. 

The customer did respond that the appliance is definitely a “stand-alone” appliance (System->Cluster->Genereal)

The customer has not yet removed the broken.txt file or try to restart the db (after removing the file).

*This is what I’m thinking:*

I think that this issue should be investigated at the 10.0.4.0 install and not the 10.0.5.0 version.  (I can ask the client to boot to the other partition if needed.)  The broken.txt file isn’t in 10.0.4.0, so that would not need to be removed. 

If the issue happened sometime between 10.0.3.0 and 10.0.4.0, that would be the best place to investigate.

The client does  NOT have any support files from before January 30.  There is a snapshot from August 22.

-rw-rw-r--    1 root     root       6174073 Aug 22 10:12 isva_10.0.4.0_20220821-201219.472267_unconfigured.snapshot

Please let me know how you would like me to proceed.  I’m going to ask for the earlier snapshot to see if there is anything to be gleaned from them. 

","07/Feb/23 12:06 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c87cb8d88f9ec6ae0afb306] 

Yes lets take a step back and check the following - 

I did not find the Postgres related logs in 10040 support file, so I am not sure if there was anything that fell over during the 10031 migration.

If 10040 was already in a bad state after upgrade then 10050 would just accumulate to the issues.
From the socket logs looks like hvdb is listening on 2024 its just config db that hasn't started.

Are they able to get back to 10031? or is their available switch partition 10040? 



Iff they are not able to switch to 10031 and they are in broken state on 10040 - 

LMI tracing under Administrator settings set the LMI trace to {{com.ibm.ws.ssl.config}}.*=ALL 

Then switch the config DB to a dummy remote config DB deploy changes and restart. 
Then switch it back to local config DB deploy changes and restart.

Check the logs .





Iff they are able to switch to 10031 - 

We did have an issue with 10020/10030 to 10040 migration issue where if there were any pending certificate requests to broke the migration. So the solution was to delete all the pending cert requests before upgrade and this was the upgrade pattern suggested-


{noformat}LMI tracing under Administrator settings set the LMI trace to com.ibm.ws.ssl.config.*=ALL 
Delete certificate requests on 10020 IF1 rt_profile_keys 
(Go to SSL Certificates-->edit rt_profie_keys-->Certificate Requests tab-->Delete all cert requests from the tab, save deploy)
Upgrade to 10040 
Install this additional  fixpack on 10040: 
IJ38857_10040.fixpack https://ibm.box.com/s/9fki8rvnf8dbr1ci66djasnvi03ts1yd - Connect your Box account
IJ38857_10040.fixpack.md5 https://ibm.box.com/s/036z0hpceffhzkgpax5kzagn2stzsgpo - Connect your Box account
 Apply 10040 IF1 fixpack
 Create new cert requests the same as the ones that was deleted on 10020IF1 {noformat}","09/Feb/23 7:22 AM;5c87cb8d88f9ec6ae0afb306;I’ve suggested to the client to boot the 10.0.4.0 partition and to rebuild the config and hvdb databases by connecting to a remote db server, and then switching back to local.

It looks to me that these appliances have only been used as Reverse Proxies and have never done any AAC/Federation work.  ","24/Feb/23 9:46 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c87cb8d88f9ec6ae0afb306] 

{{hvdb databases by connecting to a remote db server}} - if they are switching it back to local and not using the remote then it can be some dummy IP and port. It need not be an existing connection.

Switch it to dummy remote deploy it and  switch it back to local. ","24/Feb/23 11:14 PM;5c87cb8d88f9ec6ae0afb306;Thx.  In the past, I’ve actually connected to a real db.  I just tested with a dummy ip/port and see that that works fine. ","23/Mar/23 11:28 PM;5c87cb8d88f9ec6ae0afb306;Hello Asha, 

The client tried the operation to switch to a remote DB and back to a config DB.  It didn’t work for him.

I received a support file and think that I have found the issue. 

*The error with the config database is:*

2023-03-05 22:35:27 GMT:FATAL: could not open log file ""/var/postgresql/logs/config/server/postgresql-Sun.log"": No such file or directory

*ls.txt shows:* 

/var/postgresql/logs/config:

total 8

drwxr-xr-x 2 pgresql pgresql 4096 Feb 23 2017 .

drwxr-xr-x 4 pgresql pgresql 4096 Feb 23 2017 ..

lrwxrwxrwx 1 pgresql pgresql 34 Jan 31 09:40 server -> /var/postgresql/config/data/pg_log



I found remove_pgsymbolic_link.fixpack.  I tried to install this on my 10.0.5.0 system and it failed.  

I received these errors: 
Mar 23 08:11:52 mesa_control[18110]: Error: Fixpack /tmp/fixpacktmpdir/remove_pgsymbolic_link.fixpack: Failed to verify signature
Mar 23 08:11:52 mesa_control[18110]: GLGFP1004E:: GLG_events:: |file=remove_pgsymbolic_link.fixpack|

Could you please provide a version of this fixpack that will work with 10.0.5.0?","23/Mar/23 11:53 PM;5af4ad7d4dd24c579110120b;[~accountid:5c87cb8d88f9ec6ae0afb306] 

Name: remove_pgsymbolic_link
Version: 10050

Fixpack: [https://ibm.box.com/s/e7g9mlnnm1oirv0shw0zx5ldi7eujhnc|https://ibm.box.com/s/e7g9mlnnm1oirv0shw0zx5ldi7eujhnc|smart-link] 
Checksum: [https://ibm.box.com/s/f3q6f6e26rrky0pdob1d1001luqrfhtg|https://ibm.box.com/s/f3q6f6e26rrky0pdob1d1001luqrfhtg|smart-link] 



See how you go wth this.",24/Mar/23 1:33 AM;5c87cb8d88f9ec6ae0afb306;Thank You!  I confirmed that it installs and that it removes the softlink.  I have passed this on to the customer. ,02/May/23 5:13 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c87cb8d88f9ec6ae0afb306] Are we good to close this jira?,"02/May/23 10:55 PM;5c87cb8d88f9ec6ae0afb306;I will close it.  The client still hasn’t tested this, but no need to keep the Jira open. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Adding resources to AAC ends with FBTRBA091E,ISAMSUP-4770,279335,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,03/Feb/23 8:18 PM,07/Mar/23 3:36 PM,14/Jul/23 2:47 PM,07/Mar/23 3:36 PM,,,,0,,,,"Customer is receiving FBTRBA091E when trying to add resources under AAc- Access control. We took management ui logs set to oracle=ALL but these showed no discernible cause.  I have been advised to to create a Oracle Db but neither the express 21.3 or the enterprise 19.3 version will install on my rhel 8 machine. I will try Debian later but unsure if it is supported. I will propose Reagan’s Technote(Once I have research it myself ): 



[https://www.ibm.com/support/pages/how-enable-oracle-tracing-isam-appliance|https://www.ibm.com/support/pages/how-enable-oracle-tracing-isam-appliance] 



{noformat}[1/4/23, 13:29:52:779 CET] 0000004b i.am.fim.distributed.jdbc.JDBCCleanupThread$CustomProperties I com.tivoli.am.fim.rte.config.exception.RuntimeConfigurationPropertyNotFoundException: FBTRTE002E The runtime configuration domain property was not found. at com.tivoli.am.fim.rte.config.impl.RuntimeConfigurationLibertyImpl.init(RuntimeConfigurationLibertyImpl.java:117) at com.tivoli.am.fim.rte.config.impl.RuntimeConfigurationLibertyImpl.setDomain(RuntimeConfigurationLibertyImpl.java:510) at com.tivoli.am.fim.rte.config.impl.RuntimeConfigurationLibertyImpl$RuntimLibertyInstanceManager.getInstance(RuntimeConfigurationLibertyImpl.java:476) at com.tivoli.am.fim.rte.config.RuntimeConfigurationFactory.getRuntimeConfiguration(RuntimeConfigurationFactory.java:56) at com.tivoli.am.fim.distributed.jdbc.JDBCCleanupThread$CustomProperties.postConstruct(JDBCCleanupThread.java:184) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.base/java.lang.reflect.Method.invoke(Unknown Source) at com.tivoli.am.fim.om.ObjectManager$Configuration.getObject(ObjectManager.java:172) at com.tivoli.am.fim.om.ObjectManager.get(ObjectManager.java:104) at com.tivoli.am.fim.distributed.jdbc.JDBCCleanupThread$CustomProperties.getInstance(JDBCCleanupThread.java:173) at com.tivoli.am.fim.distributed.jdbc.JDBCCleanupThread.init(JDBCCleanupThread.java:51) at com.tivoli.am.fim.distributed.jdbc.JDBCCleanupThread.run(JDBCCleanupThread.java:116)

{noformat}",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011725531,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,Bayerische Versorgungskammer RZ/BRZ,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i181ob:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-05 23:41:57.809,,,,,03/Feb/23 8:23 PM;614dd566a995ad0073ec0622;Not able to open that technote.,"06/Feb/23 9:41 AM;5b15d954b0d76456f36daf33;[~accountid:614dd566a995ad0073ec0622]it looks like you are still investigating the issue. 

What is the input you need from L3 at this point?","06/Feb/23 1:44 PM;5b15d954b0d76456f36daf33;The actual sql that failed with this error is trying to retrieve an attribute called {{pdadmin.username}} from a table  {{RBA_APP_CONFIG}}

When I manually deleted that entry from my local table, I get the same FBTRBA091E error.

What does their RBA_APP_CONFIG table look like?","06/Feb/23 9:57 PM;5c53d3ac23f5bf672621c868;[~accountid:614dd566a995ad0073ec0622] 



The issue looks more to be related to a table RBA_APP_CONFIG which stores the cred information required to connect to pdmgrd.

Usually It has sec_master userid and its password.



One example is:

select * from rba_app_config;

      attr_name      |                     attr_value

---------------------+----------------------------------------------------

 ac.service.location | /mga

 pdadmin.username    | sec_master

 pdadmin.password    | {obf2}bNdT1ok+iG5JSTxQ/8BraEI+LfkSuTqHGH7KN5URNxk=

 admin.domain        | Default







From the error in customer. Env , it looks like either the table is not present or something happened to the content of the table.



1.you need to request customer to go to ORACL and connect to configdb and check the content of rba_app_config



2.depending on the output , default values an be inserted and later change domain (from the UI can be used to update its right values)





Let me know how it goes",09/Feb/23 2:33 AM;614dd566a995ad0073ec0622;[~accountid:5c53d3ac23f5bf672621c868] So I asked the customer to check contents of that table. He decided to revert the config db to the internal one which solved the error. Then he created a new Oracle Db from scratch using the downloaded scripts. He then reconnected that db back to the cluster which I presume he meant he switched the config db back to the new external Oracle db. Error resurfaced. The table in question is empty which he indicated it should be? (edited) ,"09/Feb/23 11:56 PM;5c53d3ac23f5bf672621c868;[~accountid:614dd566a995ad0073ec0622] 

Has customer imported data from internal database.



As part of externalization process:



1.customer needs to export the internal database in oracle format



2. then once external oracle is created. imported that data.



could you confirm whether this was done? ( do note if RBA_APP_CONFIG) is empty then the error is expected and it only tells that customer didn’t export and import the data","10/Feb/23 12:11 AM;614dd566a995ad0073ec0622;[~accountid:5c53d3ac23f5bf672621c868] Good question. I will confirm if they went threough the proper export and import process,",15/Feb/23 2:57 AM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33] [~accountid:5c53d3ac23f5bf672621c868] When the customer performed the proper export procedure from internal to external Oracle Db; affected table was populated properly and initial issue of being unable to add resources solved. Customer is pushing for clarification on a bug as cause. Not sure how to answer. Alot appliances use Oracle as config db without this issue? ,"15/Feb/23 9:08 AM;5b15d954b0d76456f36daf33;>> _Customer is pushing for clarification on a bug as cause_

Given that things are working after _“customer performed the proper export procedure form internal to external Oracle Db“_, it’ll come down to what they did or did not do during the procedure to externalise the first time.

If they have any logs from Oracle for such an operation, you could analyse them. ",20/Feb/23 7:02 PM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33] Customer accepts but has one outstanding question. They want to know is there such a thing as a sql trace? I believe they want to see the actual sql db error from individual read /write commands ,"20/Feb/23 10:32 PM;5c53d3ac23f5bf672621c868;[~accountid:614dd566a995ad0073ec0622] 



I will leave Bhavan to put further comment on that.



From my experience. All sql tracing , needs to be collected at Database end.I am sure oracle will have deep tracing which can help to determine each sql query coming in (like we have fro db2 snapshots/statistics collection when enabled . we can track each queries). likewise similar things will be for Oracle which Oracle support can help (if in case customer needs to track at that level)","21/Feb/23 11:01 AM;5b15d954b0d76456f36daf33;_>> They want to know is there such a thing as a sql trace?_ 

If the question is about what specific SQL commands our product is executing as a result of an operation, you can set this on the default profile:

{noformat}com.ibm.security.access.managed.resources.*=ALL{noformat}

_>> I believe they want to see the actual sql db error from individual read /write commands._

This is not clear to me. At best we’ll show whatever error is returned from the database. Like Tushar said, they’ll likely be able to gather more information at the database end.",21/Feb/23 7:42 PM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33] So we add tthat to the runtime trace profile?,"21/Feb/23 7:55 PM;5b15d954b0d76456f36daf33;Depends on what and when they want to trace. If configuring info in LMI or running a flow.

You should be able to test it out for yourself.",07/Mar/23 3:36 PM;5b15d954b0d76456f36daf33;Case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA v10.0.4.0  shows  CVE-2019-11777 vulnerability,ISAMSUP-4769,279330,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,jwade,5b15d8fd6e93913e31e279fb,Virag Patel,5b17571a82e05b22cc7d5d9e,Virag Patel,5b17571a82e05b22cc7d5d9e,03/Feb/23 7:22 PM,04/Mar/23 1:26 AM,14/Jul/23 2:47 PM,04/Mar/23 1:26 AM,,Support,,0,,,,"customer performed scanning on v10.0.4 and reported this security vulnerability.



# scan report which shows the CVE-2019-11777 on ISVA appliance

164809 IBM WebSphere Application Server Liberty 17.0.0.3 < 22.0.0.8 (6602039) ""Plugin Output:

URL : [https://x.x.x.x/|https://x.x.x.x/]

Installed version : 21.0.0.6

Fixed version : 22.0.0.8 or Interim Fix PH45750"" 

The remote web application server is affected by a vulnerability. ""The version of IBM WebSphere Application Server Liberty running on the remote host is affected by a vulnerability as referenced in the 6602039 advisory.



* In the Eclipse Paho Java client library version 1.2.0, when connecting to an MQTT server using TLS and setting a host name verifier, the result of that verification is not checked. This could allow one MQTT server to impersonate another and provide the client library with incorrect information. (CVE-2019-11777)



Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version number."" Update to IBM WebSphere Application Server Liberty version 22.0.0.8 or later. 

Alternatively, upgrade to the minimal fix pack levels required by the interim fix and then apply Interim Fix PH45750. [https://www.ibm.com/support/pages/node/6602039|https://www.ibm.com/support/pages/node/6602039] CVE-2019-11777 Sep 18, 2022 03:11:01 +08 Jan 15, 2023 03:11:00 +08 Sep 11, 2019 12:00:00 +08 Jul 7, 2022 12:00:00 +08",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012021605,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Virag Patel,5b17571a82e05b22cc7d5d9e,,,,MINISTRY OF HOME AFFAIRS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i181n7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-08 16:54:30.646,,,,,"03/Feb/23 7:23 PM;5b17571a82e05b22cc7d5d9e;the message.log shows Websphere liberty version as below

{noformat}1         ********************************************************************************
2         product = WebSphere Application Server 21.0.0.6 (wlp-1.0.53.cl210620210527-1900)
3         wlp.install.dir = /opt/ibm/wlp/
4         server.config.dir = /opt/IBM/wlp/usr/servers/runtime/
5         java.home = /opt/java/jre
6         java.version = 11.0.14.1
7         java.runtime = IBM Semeru Runtime Open Edition (11.0.14.1+1)
8         os = Linux (4.18.0-348.12.2.el8.ibm.1.x86_64; amd64) (en_US)
9         process = 1630@192.168.141.61
10        ********************************************************************************{noformat}

references:

[https://www.ibm.com/support/pages/node/6602039|https://www.ibm.com/support/pages/node/6602039]

noticed ISVG product has also released security bulletin for this CVE","04/Feb/23 3:27 PM;5b17571a82e05b22cc7d5d9e;one more customer reported this issue

case# TS012046077

We are upgrading ISVA and requested to show our target version (10.0.4) not affected by CVE-2019-11777 From the security bulletin 6602039, Liberty 22.0.0.7 and below affected by CVE-2019-11777 and Liberty was used in ISVA. ([https://www.ibm.com/support/pages/security-bulletin-ibm-websphere-application-server-liberty-vulnerable-spoofing-due-eclipse-paho-cve-2019-11777|https://www.ibm.com/support/pages/security-bulletin-ibm-websphere-application-server-liberty-vulnerable-spoofing-due-eclipse-paho-cve-2019-11777|smart-link] )","07/Feb/23 11:52 PM;5b17571a82e05b22cc7d5d9e;Hi Jim,

is there any update to share with customer?",09/Feb/23 2:54 AM;5b15d8fd6e93913e31e279fb;This is fixed in ISVA 10.0.5.0.  The WebSphere Liberty version was updated to 22.0.0.9 with vulnerability fixes which was the latest supported version before the release shipped.,09/Feb/23 1:31 PM;5b17571a82e05b22cc7d5d9e;Thank you Jim for your response.,"04/Mar/23 12:42 AM;5b17571a82e05b22cc7d5d9e;hi Jim,

pls close this. thanks",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
oAuth20 token cleanup not deleting all the (expired) tokens,ISAMSUP-4765,279176,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,,David Hayes,5b232b2fd85e5b59b066f57f,Charles David Hooks,5b15d9936d76184b7d989c82,Charles David Hooks,5b15d9936d76184b7d989c82,02/Feb/23 3:50 PM,10/Jun/23 2:36 AM,14/Jul/23 2:47 PM,,,,,0,,,,"SF Case : TS011877830

Version: 10.0.3.1

Problem: oAuth20 token cleanup not deleting all the (expired) tokens

Opening description from the customer:

----

*Token cleanup is not happening properly on the OAUTH20_TOKEN_EXTRA_ATTRIBUTE table This was analyzed by our DB team and found that not all of the expired tokens are not getting deleted, there is a very huge delay in deleting, and the below query is used without proper WHERE clause to select a particular stateid as this might also behaving potential impact on the token deletes and response times. SELECT STATE_ID FROM OAUTH20_TOKEN_EXTRA_ATTRIBUTE*

----

have had several exchanges with the customers since the case was opened (and the case was opened as a sev 1, and is still a sev 1, though they are not in immediate danger at this time)…

the customer has been running for a while at 10.0.3.1 with this pair of runtime settings:

oauth20.cleanupThread.batchSize 0

oauth20.tokenCache.cleanupWait 120

and also:

{{oauth20.tokenCache.cleanupOnlyOnPrimaryMaster = false}}

** note, while they have 4 AAC hosts, the others all have oauth20 token cleanup disabled by having a cleanupWait of “0”… 

from one exchange, the customer clarified what the db admins were seeing:

----

*From Jan 9th till Jan 24 there are ~62 million records deleted(~4.5 M records per day) on OAUTH20_TOKEN_EXTRA_ATTRIBUTE table. This number is when the batchsize was set 0 and it is trying to select all the token with select * query and that query never gets completed.*

----

recently, the customer performed a manual cleanup of the expired entries from the *OAUTH20_TOKEN_EXTRA_ATTRIBUTE* table… 

during all of this, even though pretty much any Jira and case for token cleanup indicates that customers should use a batcSize of “0” for cleanup, I’d had them try a value of 2000, so that they then had:

*oauth20.cleanupThread.batchSize 2000*

*oauth20.tokenCache.cleanupWait 120*

they said following this change, the db admins observed the following on the external db side:

----

*From the database side, we are seeing (batch) deletes on oauth20_token_cache but not on OAUTH20_TOKEN_EXTRA_ATTRIBUTE table*

----

asked the customer to enable tracing specs:

*com.tivoli.am.fim.oauth20.*=ALL:com.tivoli.am.fim.utils.jdbc.*=ALL*

customer enabled for about 20 minutes or so, and uploaded a support file with traces:

/ecurep/sf/TS011/877/TS011877830/2023-02-01/isva_10.0.3.1_20230201-002610_zlp46178.enaf.vci.att.com.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/

of note, we see entries like:

[2/1/23, 0:13:54:846 GMT] 00000060 id=00000000 voli.am.fim.oauth20.appliance.dao.impl.TokenCacheDAOJdbcImpl 1 removeExpiredTokensInBatches Deleted 2000 tokens, took 89687ms.

which fits the batchSize of 2000, but is against the token_cache table… instead of what the customer expects (against the ATTRIBUTE table)..

there are singular deletes against the ATTRIBUTE table, such as:

[2/1/23, 0:10:22:496 GMT] 00000060 id=00000000 com.tivoli.am.fim.utils.jdbc.JdbcStatementUtils > execute ENTRY DELETE FROM OAUTH20_TOKEN_EXTRA_ATTRIBUTE WHERE STATE_ID = ?

[2/1/23, 0:10:22:496 GMT] 00000060 id=00000000 com.tivoli.am.fim.utils.jdbc.JdbcStatementUtils > setPreparedStatementParam ENTRY 1 uuid23cee322-017c-1f15-94e4-e3197ca4cdf7

but only a few of those…

the oauth20 cleanup entry/return inits look to follow every 120 seconds after the last one completes (the completion time various based on the amount of cleanup being effected)…

but we’re trying to tie together the oauth20 cache token cleanup with the ATTRIBUTE table cleanup (one of the other L2 staffers mentioned that when we mark a token for deletion we should be finding the state id and deleting the extra attribute associated with those tokens… and we also wondered why we don’t see a matching batch delete of the extra attributes table, or if it should be on delete cascade, which we are not seeing evidence of)

** so the main ask here is how to show the customer that the aouth20 token cache batch cleanup extends to the ATTRIBUTE table…",,David Hayes,jcyarbor,khansen,tonyferg,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011877830,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Charles David Hooks,5b15d9936d76184b7d989c82,,,,AT&T Services Inc,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,/ecurep/sf/TS011/877/TS011877830/2023-02-01/isva_10.0.3.1_20230201-002610_zlp46178.enaf.vci.att.com.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/,,,,,,,,,,,,,,,,,,,,,,,0|i180p7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-02-03 00:10:53.446,,,,,03/Feb/23 10:10 AM;5bac25aaabfcbf73d13e733b;Is there any reason we aren’t doing an ‘ON DELETE CASCADE’ for the OAUTH20_TOKEN_EXTRA_ATTRIBUTE' table since the primary key for that table is the State_ID in the ‘OAUTH20_TOKEN_CACHE’ table?,"06/Feb/23 10:51 AM;5b232b2fd85e5b59b066f57f;From the description - it sounds like they are seeing this behaviour (issue with cleanup of EXTRA_ATTRIBUTE table) when the batchsize is set to something other than 0. Do they also see this when the batchSize is set to 0? 

post 9.0.6, batchSize should never be anything other than 0 - else there are issues with the cleanup - not limited to the incorrect clean up of the EXTRA_ATTRIBUTE table. ","06/Feb/23 2:49 PM;5b15d9936d76184b7d989c82;The customer (the DB admins specifically) said that with batchSize set to “0”, it “works” to the extent that some 4 million entries are being deleted per day, but that it is not keeping up (i.e. does not complete when the cleanup runs)… they commented on the select * query… meaning that they are of the mind that the select statement, with batchSize of 0, is preventing cleanup from completing… that is the main reason I asked them to test with an explicit batchSize… they want to go back to “0”, so it should be easy to convince them to do so… and since they were OK before with enabling targeted tracing in Prod to get some data, pretty sure they’d be willing to do this again with batchSizse set to “0”… let me know if you’d like me to herd them in that direction… if the select statement gets “done” finding all records for deletion, not sure why it would start but not get done (maybe some max query runtime on the DB side?)","07/Feb/23 11:09 AM;5b232b2fd85e5b59b066f57f;So how many records are created on average each day? What is the delta between what is created vs. what can be deleted by the internal cleanup job when batchSize = 0? Have they always had cleanup turned on? How have they hit 64million records? 

There is only so much the internal cleanup job can do - if they are at 64million records, it is going to take time for the internal cleanup to work through those records and determine what needs deleting - potentially too much time. We have had this scenario in the past; and in these cases, we recommend that the cleanup is triggered manually / externally by the DBA (I’m also pretty sure this was also AT&T in the past and we provided a manual cleanup SQL script; I could be wrong but do a search through JIRA. It may have been another customer -e.g. VW). If the number of records being created is greater than the number that can be cleaned up by the internal job, then they should stick with the manual cleanup; alternatively, if the internal cleanup job can keep up with the number of records that are being created, then it should simply be a case of doing a manual cleanup to get the total number to a manageable level and then relying on the internal cleanup going forward.  ","08/Feb/23 12:06 PM;5c53d3ac23f5bf672621c868;update from AT&T ( at present I have provided them with the query to get expired entries)

I have sent an update on how to build the query to get the expired entries

* --> how many records are created on average each day?

*We have four datacenters and on average we are seeing 1.25 to 1.5M inserts happening on each DC every day.*

*So that totals to 5 to 6M tokens being created every day.*

--> what is the delta between what is created vs. what can be deleted by the internal
cleanup job when batchSize = 0?

*out of 5 ot 6 Million tokens that are being created on this table it is deleting around 1M tokens.*

answers to the above might require some investigation by the DBAs... the second question
is basically asking whether you might be aware of the break point (meaning what rate of new
and hence going to expire entries are created vs what cleanup was able to handle)... the first
question is maybe the starting point here... how many entries (that will be expiring and will
require cleanup) on a daily bases for the ATTRIBUTE table?...

*Can you provide a Query to find out how many entries (that will be expiring and willrequire cleanup) on a daily bases for the ATTRIBUTE table?*","09/Feb/23 10:12 AM;5b15d9936d76184b7d989c82;customer updated the case again this afternoon… reclarifying some numbers:

----

*Yesterday across all Datacenter we have around 4.5 to 5Million records generated.*

--> what is the delta between what is created vs. what can be deleted by the internal

cleanup job when batchSize = 0?

*Yesterday we noticed around 1.5Million deletes happended.*

*There are around 3Million token expired in extra attribute table that are yet to cleanup (on a daily basis)*

*Also we have uploaded the traces yesterday. Do we still need to increase logfile size and number of logs and enable tracing again?… and are there any known issues that we need to be aware of or get a fix for with regard to cleanup of the extra attribute table)?*

----

tracing from yesterday is available at:

/ecurep/sf/TS011/877/TS011877830/2023-02-08/RUNTIME_isva_10.0.3.1_20230208-045521_zlp46178.enaf.vci.att.com.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/

the tracing yesterday did not capture as many minutes of operation as we had been looking for (15 vs the actual 4 to 5)… the tracing does not include any of this type of entry:

StartTokenCleanupThreadCmd$TokenCleanupThread > cleanup ENTRY

but unlike the last collection, with *batchSize = 2000*, where entries for this type of operation were very sparse:

[2/1/23, 0:10:22:496 GMT] 00000060 id=00000000 com.tivoli.am.fim.utils.jdbc.JdbcStatementUtils > execute ENTRY DELETE FROM OAUTH20_TOKEN_EXTRA_ATTRIBUTE WHERE STATE_ID = ?

with last night’s collection, with *batchSize = 0*, from a trace log that covers about 75 seconds, there are over 3000 of the type of entry shown above… so there looks to be more persistent observable cleanup against the extra attribute table… it is just not keeping pace with the number of added entries (over a given span of time)…

I updated the case with the comment that they might have to move to using scheduled manual cleanup… 

and amongst ourselves, we still have Jack’s question of:

----

Is there any reason we aren’t doing an ‘ON DELETE CASCADE’ for the OAUTH20_TOKEN_EXTRA_ATTRIBUTE' table since the primary key for that table is the State_ID in the ‘OAUTH20_TOKEN_CACHE’ table?

----

and also, the question of whether we need the customer to conduct the tracing again, capturing a longer timespan of data… ","09/Feb/23 11:28 AM;5b232b2fd85e5b59b066f57f;This is all expected / old territory. The issue with batching is that the batches may be full of token records that don’t require deletion and therefore we never get to the point where we try to clean up the extra attributes before the execution window closes and the next batch cleanup triggers. Some context / history can be found here - [https://cloudidentity.atlassian.net/browse/ISAMSUP-856|https://cloudidentity.atlassian.net/browse/ISAMSUP-856|smart-link] and linked WIs (ref: Adrian’s comment October 29, 2019 at 3:48 PM). I have investigated cascade deletion in the past - ref to my comment November 1, 2019 at 11:52 AM and Adrian’s subsequent response in [https://cloudidentity.atlassian.net/browse/ISAMSUP-856|https://cloudidentity.atlassian.net/browse/ISAMSUP-856|smart-link] .

Keeping in mind this was quite some time ago and on older versions (9.0.5); however it basically all still holds true. The outcome / solution (along with fixing a bunch of other issues with the cleanup job - e.g. DB locking) was to move away from batching and effectively run the cleanup job continuously in the background by setting batchSize = 0 (in effect from 9.0.6 but not fully fixed until 9.0.7.1). At the time, Development was reluctant for me to remove batching entirely from the product - hence why it is still there - albeit in somewhat of a broken state.  

Given the volume of records being created, it sounds to me like they should be running the cleanup manually. ","10/Feb/23 4:09 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b232b2fd85e5b59b066f57f] ,

Is there a reason that we don’t have the state_id in the OAUTH20_TOKEN_EXTRA_ATTRIBUTES table as a foreign key tied to the OAUTH20_TOKEN_CACHE table and perform a ON DELETE CASCADE so that when the state_id is removed it deletes that row in the table?

Seems like the sensible database solution.

That is how those two tables are linked together. The token_id is not even included in the OAUTH20_TOKEN_EXTRA_ATTRIBUTES table.","15/Feb/23 4:29 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] 



there is update from customer .

What I have noted so far:

N number of customers have externalized the delete(that means they use run the delete at the db side)

similar  query ,helps customer with less production problem.

That also saves, runtime with delete overhead(in many cases have seen customers work efficiently )



Recently, ISVA OP has been released and they have same requirement to cleanup records.( so reallly need to see whether jdbc drivers to go drivers , doesn’t make a difference in doing same cleanup operations ) or design change around table is one of the effect ways to handle large deletes","24/Feb/23 10:20 AM;5b232b2fd85e5b59b066f57f;[~accountid:5c53d3ac23f5bf672621c868] - sorry I don’t quite understand what your update is stating / asking? 

[~accountid:5b15d9936d76184b7d989c82] - what else do you need from me?","27/Feb/23 6:59 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5b15d9936d76184b7d989c82] 



no suggestion( it was just a possibility discussion which we can defer to some other point) 

 here is the conclusion from my end: (I would like to have a solution from Dev/L3 but seems there is no way forward) so in simple words

1.any database schema change is impractical at this point 

2.There is no way product provided cleanup can improve any further

[3.AT|http://3.AT]&T has to continue using custom janitor script( or manual script to do cleanup )","12/Apr/23 12:11 AM;5b15d901fa615349cb01778b;[~accountid:5b15d9936d76184b7d989c82] - Hey Dave, what is the status of this issue?","12/Apr/23 2:41 AM;5b15d9936d76184b7d989c82;added a status ping to the SF case to check status… previously indicated to the customer that they will need to use manual cleanup of the EXTRA_ATTRIBUTES table at this time… they did not rebut, but did not concur (or say anything)… if they do no respond this time, we’ll put this one to rest…","18/Apr/23 12:14 AM;5b15d98f78cd734fe39f29a1;[~accountid:5b15d9936d76184b7d989c82] [~accountid:5b232b2fd85e5b59b066f57f] I got an email from AT&T this morning asking for help on this. They do not like the requirement that they have to manually clean up the tokens. Since they have so many expired tokens to delete, it looks like the cleanup thread is running constantly. Currently, they only have the cleanup enabled on one server in the datacenter. What would be the risk of enabling it on another server? ","18/Apr/23 11:42 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d98f78cd734fe39f29a1] enabling cleanup from multiple ISVA instances pointing to a single external DB can result in deadlock within the DB and performance degradation within ISVA; hence we don’t usually recommend this configuration. 

After manually cleaning up the table and then enabling the cleanup job, are they seeing the tables continue to grow? ",19/Apr/23 12:29 AM;5b15d98f78cd734fe39f29a1;[~accountid:5b232b2fd85e5b59b066f57f] The manual process should work for them. AT&T is just pushing back on having to do a manual process when the product is supposed to do this. One of the Expert Labs consultants believes he can help automate the manual cleanup. ,"19/Apr/23 10:39 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d98f78cd734fe39f29a1] - yep, I understand from the customer’s perspective; I’m just not sure there is a real lot we can do to improve it. We are looking at another issue raised by AT&T ( [https://cloudidentity.atlassian.net/browse/ISAMSUP-4421|https://cloudidentity.atlassian.net/browse/ISAMSUP-4421|smart-link] ) which may result in changes to the cleanup sql - but it isn’t clear where this will lead at this stage. ",10/May/23 7:19 AM;5b15d98f78cd734fe39f29a1;[~accountid:5b232b2fd85e5b59b066f57f] AT&T says the manual cleanup is not a long-term solution for them and they want the product to be able to handle this. I’m opening an enhancement request to pacify them. ,22/May/23 12:21 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] can you please review this Jira item and confirm the current status of it for us. ,22/May/23 3:38 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9936d76184b7d989c82] - does this differ from [https://cloudidentity.atlassian.net/browse/ISAMSUP-4421|https://cloudidentity.atlassian.net/browse/ISAMSUP-4421|smart-link] or are we now at the same point in both (i.e. looking at improvements to the cleanup SQL)? ,"10/Jun/23 2:36 AM;5b15d9936d76184b7d989c82;updating with bit of a slack conversation between myself and David Hayes:

Hooks:

ISAMSUP-4765, is all about (and only about (token cleanup)

ISAMSUP-4421, is triggered by updates to the OAuth definition/client, and focuses on the Oracle limit when using 'IN"" in the SQL that the list must be <1000 entries

Hayes:

ISAMSUP-4765 is simply an issue of deletion rate vs. creation rate - It looks like they are getting 6m records created a day with 4m being removed - so it is growing at a rate of 2m records / day.  Are they still manually cleaning up?

Hooks:

At this time, they are still doing manual cleanup

----

[~accountid:5b15d98f78cd734fe39f29a1] wanted to check to see whether AT&T received a version of Bao’s cleanup script?… and to confirm the customer’s current expectations…",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
" reloading the container also forces the dsess-enabled back to ""no"" value",ISAMSUP-4755,278607,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Virag Patel,5b17571a82e05b22cc7d5d9e,Virag Patel,5b17571a82e05b22cc7d5d9e,31/Jan/23 1:07 PM,27/Feb/23 4:08 PM,14/Jul/23 2:47 PM,27/Feb/23 4:08 PM,,Support,,0,,,,"container details v10.0.3 

ibmcom/verify-access for config container

ibmcom/verify-access-wrp for webseal container



problem statement:

customer initially reported issue with openshift ansible while deploying the configuration changes related to dsess-enabled parameter. 

recommended customer to instead use the REST API directly (bypassing ansible) to make sure whether it works or not. customer followed it and found issue still persists.

customer would like to set dsess-enabled=yes however it does rollback to no while reloading the container.



more details captured from customer:

After the snapshot is built, checking the config container again and also the snapshot generated itself shows the parameter is set to no:

{noformat}[ec2-user@ip-10-160-154-208 10.12.0_new]$ grep dsess-enabled var/pdweb/dto/etc/webseald-dto.conf

dsess-enabled = no

{noformat}

customer could deploy rest of the configuration changes except dsess-enabled.

For example,

We tried to deploy redis configuration first via the REST API as you have recommended.

Successfully created the redis config via REST API https://{{appliance_hostname}}/wga/redis_config/collections/ (as per documentation).

Sample request:

{noformat}{

""name"": ""ISAM_REDIS_TEST"",

""max-pooled-connections"": 50,

""idle-timeout"": 10,

""connect-timeout"": 5,

""io-timeout"": 30,

""health-check-interval"": 15,

""matching-hosts"": [

""*.macquarie.com.au""

],

""servers"": [

{

""name"": ""ISAM_Redis_Host"",

""host"": ""XXX"",

""username"": ""XXX"",

""port"": 6379,

""password"": ""XXX"",

""ssl"": {

""key-file"": ""XXX""

}

}

]

}

{noformat}

Confirmed in LMI screen the redis config was created successfully. I'm unable to put here the actual screenshot but below is the response output from the API GET call:

{noformat}[

{

""name"": ""ISAM_REDIS_TEST"",

""last_modified"": 1674714312

}

]{noformat}



We then went ahead and tried to configure dsess, now that the the redis config was created successfully, using the following APIs (as per documentation)



https://{{appliance_hostname}}/wga/reverseproxy/secure/configuration/stanza/session/entry_name/dsess-server-type

""value"": ""redis""



https://{{appliance_hostname}}/wga/reverseproxy/secure/configuration/stanza/session/entry_name/dsess-enabled

""value"": ""yes"" (also tried ""value"": ""true"")



Deployed the changes and published the snaphot via LMI, and reloaded the container.

 Unfortunately, dsess-enabled still forces back to ""no"" value. 

These changes were now independent of the ansible play and purely via REST API, yet the result is still the same. 

Looks like reloading the container also forces the dsess-enabled back to ""no"" value. Is there any other configuration/s that we can consider that's affecting the dsess? 

Can you please further check and advise?

customer has provided few screenshots for reference:
/ecurep/sf/TS011/268/TS011268072/0-all_data/",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011268072,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Virag Patel,5b17571a82e05b22cc7d5d9e,,,,Macquarie,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17x9j:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-02-19 23:03:43.894,,,,,"31/Jan/23 7:59 PM;5b17571a82e05b22cc7d5d9e;hi L3 team,

pls keep this on hold for now. i hv got some observations which i hv shared with customer to verify.",20/Feb/23 9:03 AM;5b15d954b0d76456f36daf33;[~accountid:5b17571a82e05b22cc7d5d9e] what is the latest on this one?,"27/Feb/23 4:05 PM;5b17571a82e05b22cc7d5d9e;hi Bhavan,

customer is unresponsive. pls close for it for now. if needed, i will reopen later.

thank you",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
CVE-2022-34169 & CVE-2022-1471 Vulnerability on ISVA v10.0.5 container image,ISAMSUP-4741,278065,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,jwade,5b15d8fd6e93913e31e279fb,Virag Patel,5b17571a82e05b22cc7d5d9e,Virag Patel,5b17571a82e05b22cc7d5d9e,25/Jan/23 1:24 PM,15/Mar/23 8:15 AM,14/Jul/23 2:47 PM,15/Mar/23 8:15 AM,,Support,,0,,,,"*CVE-2022-1471:*

customer has verified that this vulnerability is not due to Red Hat and the installed version is 8.7. 

The scanning tool classifies it as critical since NVD CVSS v3 Score is 9.8. 

*CVE-2022-34169:*

Customer has verified that this vulnerability is not due to Red Hat and the installed version is 8.7. 

The scanning tool classifies it as high since NVD CVSS v3 Score is 7.5. 



*Requested below information:*

We would like to understand IBM's assessment of these vulnerabilitues. 

Could this security vulnerability be essential to us or can the risk of this vulnerability be treated as low? 

In addition, we also would like to understand if there are plans to fix this vulnerability in upcoming releases. If so, what would be the target date for the same?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS011936145, TS011936134",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Virag Patel,5b17571a82e05b22cc7d5d9e,,,,"Ministry of Finance, SG",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17tyv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-25 23:41:22.609,,,,,26/Jan/23 9:41 AM;5b15d8fd6e93913e31e279fb;Can we get a copy of the report so that I can better track down where this was found.  In invesigating our Mend Open Source scans I do not see where it is reporting a vulnerability for these 2 CVEs.,26/Jan/23 1:22 PM;5b17571a82e05b22cc7d5d9e;Sure Jim. Let me request customer.,"26/Jan/23 6:40 PM;5b17571a82e05b22cc7d5d9e;Location of the report:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011936134&path=TS011936134%2F2023-01-26%2F&filepath=TS011936134%2F2023-01-26%2Faqcve_KIKMtovBSB_1674010810_0_0_566_filtered.csv|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011936134&path=TS011936134%2F2023-01-26%2F&filepath=TS011936134%2F2023-01-26%2Faqcve_KIKMtovBSB_1674010810_0_0_566_filtered.csv]



/ecurep/sf/TS011/936/TS011936134/2023-01-26/aqcve_KIKMtovBSB_1674010810_0_0_566_filtered.csv



provided csv file contains both reported vulnerabilities","02/Feb/23 1:06 AM;5b17571a82e05b22cc7d5d9e;Hi Jim,

customer is requesting update on this.",07/Feb/23 11:51 PM;5b17571a82e05b22cc7d5d9e;[~accountid:5b15d8fd6e93913e31e279fb] any update on this pls,"09/Feb/23 3:40 AM;5b15d8fd6e93913e31e279fb;For *CVE-2022-1471* we do not use snakeyaml directly in our code so we are not vulnerable to this.  We are affected because the library was down level.  The level of snakeyaml was updated in ISVA 10.0.5.0 for currency.

For *CVE-2022-34169* I will need to do more investigation because the Xalan package is not being updated.",21/Feb/23 8:33 PM;5b232b2fd85e5b59b066f57f;@jwade - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,24/Feb/23 12:10 PM;605c0c04b18de50071046740;customer has escalated. Please help with an update.,"27/Feb/23 4:00 PM;5b17571a82e05b22cc7d5d9e;Hi [~accountid:5b15d8fd6e93913e31e279fb] 

appreciate your feedback as customer is chasing for update","01/Mar/23 1:56 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b17571a82e05b22cc7d5d9e] For the *CVE-2022-1471* the issue is reported that it will be fixed in version 1.34 but no release date has been provided.  There are some code changes available but they are reported to not be complete.  Please see [https://bitbucket.org/snakeyaml/snakeyaml/issues/561/cve-2022-1471-vulnerability-in|https://bitbucket.org/snakeyaml/snakeyaml/issues/561/cve-2022-1471-vulnerability-in|smart-link]  we are not vulnerable because we do not load untrusted sources.  When the package is available we will include it in the next release for currency.

For *CVE-2022-34169* there is not fix available.  See [https://stackoverflow.com/questions/73231771/how-to-fix-vulnerabilitycve-2022-34169-in-seleniumhtmlunit-driver3-62-0-it|https://stackoverflow.com/questions/73231771/how-to-fix-vulnerabilitycve-2022-34169-in-seleniumhtmlunit-driver3-62-0-it|smart-link]   We are not vulnerable because we do not use the affected function.  When and if a new package is available we will include in the next release for currency.",01/Mar/23 12:53 PM;5b17571a82e05b22cc7d5d9e;Thank you Jim. I have shared feedback with customer.,"04/Mar/23 12:41 AM;5b17571a82e05b22cc7d5d9e;Hi Jim,

pls close this. thanks.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Failover not working for oidc,ISAMSUP-4727,276747,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,20/Jan/23 5:48 AM,01/Feb/23 11:35 AM,14/Jul/23 2:47 PM,01/Feb/23 11:35 AM,,,24/Jan/23 12:00 AM,0,,,,"This seems to be the same issue that was noticed in 10.0.0.0 and 10.0.0.1 and was addressed in [https://cloudidentity.atlassian.net/browse/ISAMSUP-2590|https://cloudidentity.atlassian.net/browse/ISAMSUP-2590|smart-link] .  

A fix was provided for 10.0.0.0 and 10.0.0.1, but it does not appear that this fix was fixed in later releases.

An RFE was opened for this: 

[https://ibmsecurity.ideas.ibm.com/ideas/ISAM-I-1025|https://ibmsecurity.ideas.ibm.com/ideas/ISAM-I-1025|smart-link] 

Can the oidc_auth_failover_fix_10010 fixpack be built for the 10.0.3.1 level?  (The client is at 10.0.3.1 with no fixpacks installed.) 

I will add details from the client’s log in an update to this JIRA.",,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-2667,,,,,,21/Jan/23 1:31 AM;gvacek;oidc_auth_failover_fix_10031.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/179556,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011888026,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,Canadian Blood Services,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17r5z:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-01-20 05:22:50.023,,,,,"20/Jan/23 5:59 AM;5c87cb8d88f9ec6ae0afb306;/ecurep/sf/TS011/888/TS011888026/2023-01-19/isva_10.0.3.1_20230119-122714_its-q-isva-4.support_unpack/var/pdweb/eda/log/msg__webseald-eda.log shows: 
2023-01-19-12:20:30.218-05:00I----- 0x38CF0800 webseald ERROR wwa cdsso AMWFailoverCookieCutter.cpp 1063 0x7fd482aa3700 -- DPWWA2048E   The original authentication method in the failover coo
kie is not recognized for failover authentication on this server. The value oidc is invalid.

This is in thread 140550701987584 in /ecurep/sf/TS011/888/TS011888026/2023-01-19/isva_10.0.3.1_20230119-122714_its-q-isva-4.support_unpack/var/pdweb/eda/trace/pdweb.log



And thread(46) in the  parsed file: 
(46) 2023-01-19-12:20:30.210 Client (10.254.184.235:59310) to WebSEAL (10.254.20.101:444) sending 3327 bytes
GET /irj/servlet/prt/portal/prteventname/Navigate/prtroot/pcd\!3aportal_content\!2fevery_user\!2fgeneral\!2fdefaultAjaxframeworkContent!2fcom.sap.portal.contentarea?ExecuteLocally=true&Cur
rentWindowId=WID1674148599795&supportInitialNavNodesFilter=true&sapDocumentRenderingMode=Edge&windowId=WID1674148599795&NavMode=0&PrevNavTarget=navurl%3A%2F%2F7aed1cfe22406b9478a8d655e
379e307 HTTP/1.1^M
Host: edaqa.blood.ca^M
Connection: keep-alive^M
sec-ch-ua: ""Not_A Brand"";v=""99"", ""Microsoft Edge"";v=""109"", ""Chromium"";v=""109""^M
sec-ch-ua-mobile: ?0^M
sec-ch-ua-platform: ""Windows""^M
Upgrade-Insecure-Requests: 1^M
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 Edg/109.0.1518.55^M
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,_/_;q=0.8,application/signed-exchange;v=b3;q=0.9^M
Sec-Fetch-Site: same-origin^M
Sec-Fetch-Mode: navigate^M
Sec-Fetch-User: ?1^M
Sec-Fetch-Dest: document^M
Referer: [https://edaqa.blood.ca/irj/servlet/prt/portal/prteventname/Navigate/prtroot/pcd!3aportal_content!2fevery_user!2fgeneral!2fdefaultAjaxframeworkContent!2fcom.sap.portal.contenta|https://edaqa.blood.ca/irj/servlet/prt/portal/prteventname/Navigate/prtroot/pcd!3aportal_content!2fevery_user!2fgeneral!2fdefaultAjaxframeworkContent!2fcom.sap.portal.contenta|smart-link] 
rea?ExecuteLocally=true&CurrentWindowId=WID1674148599795&supportInitialNavNodesFilter=true&sapDocumentRenderingMode=Edge&windowId=WID1674148599795&NavMode=0&PrevNavTarget=navurl%3A%2F%
2F7aed1cfe22406b9478a8d655e379e307^M
Accept-Encoding: gzip, deflate, br^M
Accept-Language: EN-CA,EN-US;q=0.9,EN;q=0.8^M
Cookie: dtCookie=v_4_srv_1_sn_0A28AC9596059C3284C03DCE11909DE7_perc_100000_ol_0_mul_1_app-3A0fcc9706cedb9523_1; null; PD-ID=VoqAklMqE0IUh++2s328c3CVVDZmg7Zwled/+1qpBlWHeglHHWpV/RG58j7Q
yw2Jl7W4DrC0NComvPtJDyeLdk6p8+lHQy2lqT3OJzXZRMlPfV9M8ZTF4k2Dutp845orqtFAtbCYVTJZ6vfuAoXcCqrwUljXfOl0/EbB9DviSiy+Yh3shN9tTQwx+Em0zv4rIMvrPxtLV4kwgXYkGD0ltkmDP3JkL0zE++qszM2SzcmmzUAp0lr7
PQovn6Pqah2JC7xlSZq/1AVpEQrMZthYV5xDq5SZnNNq4Yv9S2JZrYieGkJBXUtBCAYJnLPGwFDsQ+LRheGrYc5bSC2T3iLxZ6lu3xTaYcfBPHtqBtcwkFO6St+Hyzjp9rS8S/6enbrfn2VzzLiWkZO1jF5N9tdR93MXMCXY3+Bw+lhyGCpo+JDv
lYqoVgdgem/a+KqU2xy9; MYSAPSSO2=AjExMDAgABJwb3J0YWw6TmFiaWwuRHVhbGWIABNiYXNpY2F1dGhlbnRpY2F0aW9uAQAGTkRVQUxFAgADMDAwAwADRVBRBAAMMjAyMzAxMTkxNzE2BQAEAAAACAoABk5EVUFMRf8BJDCCASAGCSqGSIb3
DQEHAqCCAREwggENAgEBMQswCQYFKw4DAhoFADALBgkqhkiG9w0BBwExge0wgeoCAQEwPjA2MQswCQYDVQQGEwJDQTELMAkGA1UECBMCT04xDDAKBgNVBAoTA0NCUzEMMAoGA1UEAxMDRVJRAgRGLwmPMAkGBSsOAwIaBQCgXTAYBgkqhkiG9w0B
CQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0yMzAxMTkxNzE2NDBaMCMGCSqGSIb3DQEJBDEWBBSmmgEyjggZe8DTRBsJUF3kI54DuTAJBgcqhkjOOAQDBDAwLgIVANKs3cDjyuQ87qnW5bGuLgcrBX\!pAhUAn9dbKsqExA5Tgo0b1\!0o
eDOpsAk%3D; AMWEBJCT\!%2Fsapep\!PortalAlias=portal; AMWEBJCT\!%2Fsapep\!saplb_*=(J2EE7082720)7082750; JSESSIONID=0hEMiSDBY6qGkgH8WSNfsXPVWAjLhQH-EmwA_SAP482cDc6XSS0TrdpN5vISYHLg; JSESSIONM
ARKID=DvIzxwsXVuHSPGmSRx4NE2IxqveLpxgB1Ixf4SbAA; PD_STATEFUL_25ca7fdc-d540-11ec-b207-0050569c8cff=%2Fsapep; SAPWP_active=1; AMWEBJCT\!%2Fsapp\!sap-usercontext=sap-language=EN&sap-client=
050; AMWEBJCT\!%2Fsapp\!SAP_SESSIONID_ERQ_050=Ft4bGypAKxEVhIWXIZhwmgqgKSiYHRHtuCmGSDpZ8AI%3d; PD_STATEFUL_2bab4a3a-d540-11ec-b207-0050569c8cff=%2Fsapp; PD-S-SESSION-ID=SlMjaUfo+z4=:1_2_0
_xKq1yAtE5dOyXR2fuDxE1bgq0uq0TAjZgg7nZJcV1dwliIbK|; BIGipServer~WEB-DC2~EDA_PORTAL_IAPP.app~EDA_PORTAL_IAPP_pool=rd100o00000000000000000000ffff0afe1465o444; contentAreaFrame=null^M
X-Forwarded-For: 174.113.28.32^M

","20/Jan/23 3:22 PM;5af4ad7d4dd24c579110120b;[~accountid:5c87cb8d88f9ec6ae0afb306] 

Fixpack for 10031:

name: oidc_auth_failover_fix_10031
fixpack: [https://ibm.box.com/s/4smsed9k0fmm7hj3zvvrdobpxpwaclow|https://ibm.box.com/s/4smsed9k0fmm7hj3zvvrdobpxpwaclow|smart-link] 
checksum: [https://ibm.box.com/s/hst4dwrrdddz72wgwg6v8m4n0jakhdot|https://ibm.box.com/s/hst4dwrrdddz72wgwg6v8m4n0jakhdot|smart-link] 
version: 10031
files changed: /opt/pdwebrte/lib/libamwebrte.so","21/Jan/23 1:31 AM;5c87cb8d88f9ec6ae0afb306;Thanks Asha.  Unfortunately, the fix didn’t install on my test system.  

I have attached the log.","22/Jan/23 8:22 AM;5af4ad7d4dd24c579110120b;I’ve updated the fixpack at the same location and it installs now.
Let me know how you go with this.",24/Jan/23 2:22 AM;5c87cb8d88f9ec6ae0afb306;Thank You.  I validated that the fix installs and provided it to the customer.  ,01/Feb/23 11:35 AM;5af4ad7d4dd24c579110120b;Case closed hence closing this Jira.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
HttpClientV2 presenting wrong certificate,ISAMSUP-4711,276020,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,14/Jan/23 6:49 AM,09/Mar/23 8:47 AM,14/Jul/23 2:47 PM,09/Mar/23 5:54 AM,10.0.6,Support,,0,,,,"We have two customers who have reported that when they are using HttpClientV2 and have more than one certificate in the keystore, the certificate that is used is different than the one that is specified.  In both cases, the work-around has been to use a keystore that only includes one certificate.  

One customer is at 10.0.3.1 and one at 10.0.4.0. 

We have received data for the customer at 10.0.3.1

Here is the description from the client: 


_We use the new HttpClientV2 on AAC for calling APIs through DataPower and APIC. The DataPower requires Client Certificate for authentication. We have tried 2 methods to specify the client certificate:_
_(1) Construct RequestParameters and setClientKeyStore, setClientKeyAlias  to set the store and client certificate key, then HttpClientV2.httpPost​(RequestParameters params);_
_(2) HttpClientV2.httpPost​(java.lang.String urlstr, Headers headers, Parameters params, java.lang.String httpsTrustStore, java.lang.String basicAuthUsername, java.lang.String basicAuthPassword, java.lang.String clientKeyStore, java.lang.String clientKeyAlias)_

_From our test, if the clientKeyStore contains more than one Personel Certificate, HttpClientV2 does not always use the specified clientKeyAlias for the handshake (from Packet Trace Check), so results java.net.SocketException and Broken pipe (Write failed) and Bad Certificate in Packet Trace when using (1) RequestParameters; or javax.net.ssl.SSLHandshakeException: Received fatal alert: bad_certificate when using (2)._

_We tested that it works fine when the clientKeyStore contains the only clientKeyAlias in Personal Certificates._",,Annelise Quap,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,5b15d950d9936c61022057fe,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,16/Feb/23 7:04 AM;mrahman;AAC_Client_To_Provide_Specified_Cert_10031.fixpack;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/184226,31/Jan/23 5:04 AM;gvacek;Screenshot 2023-01-30 at 1.01.19 PM.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/180865,01/Feb/23 1:33 AM;aquap;image-20230131-153044.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181032,17/Feb/23 2:30 AM;gvacek;post-fixpack-2.pcap;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/184441,17/Feb/23 2:30 AM;gvacek;post-fixpack.pcap;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/184440,31/Jan/23 4:54 AM;gvacek;trace01.pcap;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/180864,17/Feb/23 2:32 AM;gvacek;traces (0be4127c-aae8-469f-9bb2-b28c3c1dddcd).log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/184443,31/Jan/23 4:54 AM;gvacek;traces.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/180863,,,,,,,,IJ45606,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011833001,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,Bank of Montreal,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-03-24T00:06:10.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"/ecurep/sf/TS011/833/TS011833001/2023-01-13

bmo_trace01_20220113.pcap.txt                                               
bmo_trace_-_2023-01-13T150222.633.log                                       isva_10.0.3.1_20230113-153253_isambccldvmga23.srv.bmogc.net.support_unpack
testHttpClientV2mappingrule.js.txt
",,,,,,,,,,,,,,,,,,,,,,,0|i17mtj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,ISVA 10.0.4.0,,,,,,,,,,,,2023-01-17 17:19:55.571,,,,,"14/Jan/23 6:53 AM;5c87cb8d88f9ec6ae0afb306;Test performed: 
We use a Server Connection ""test_credservice_dp"" as below:
URL: [https://iambccdpdit2.bmogc.net:9777|https://iambccdpdit2.bmogc.net:9777]
SSL: True
SSL-Truststore: isam-dt
SSL Mutual Authentication Key: [CIAMDPQAouid.bmogc.net|http://CIAMDPQAouid.bmogc.net]

The properties of the server connection are used for the HttpClientV2. From the packet trace, a different client cert ""oauth-dit"" is sent to the server.","18/Jan/23 3:19 AM;5b15d9e581c3df12acf53c4a;Need to some clarification:

In the truststore called: isam-dt, I see bunch of certificates and “oauth-dit” is one of them but I do not see a certificate named “HttpClientV2”

>>The properties of the server connection are used for the HttpClientV2. From the packet trace, a different client cert ""oauth-dit"" is sent to the server.



I am assuming that certificate name “HttpClientV2” was specified but “oauth-dit” was send instead? Is that correct? If so, should not be a certificate called HttpClientV2 there?","18/Jan/23 3:55 AM;5c87cb8d88f9ec6ae0afb306;So, the client used the following in his test: 
SSL-Truststore: isam-dt
SSL Mutual Authentication Key: [CIAMDPQAouid.bmogc.net|http://CIAMDPQAouid.bmogc.net]

The certificate that was specified and expected to be sent is: 
Certificate data:
  label:        [CIAMDPQAouid.bmogc.net|http://CIAMDPQAouid.bmogc.net]
  is default:   no
  key size:     2048
  serial number: 790000f6c8f04b3da097eecec500010000f6c8
  issuer DN:    CN=MS QA issuing CA1,O=,C=
  subject DN:   [CN=CIAMDPQAouid.bmogc.net|http://CN=CIAMDPQAouid.bmogc.net],OU=3384s1mQPe!$,O=Bank of Montreal,C=CA
  issued  on:   Thu Oct 21 16:12:44 2021
  expires on:   Sat Oct 14 00:00:00 2023



The certificate presented (causing the issue): 
Certificate data:
  label:        oauth-dit
  is default:   no
  key size:     2048
  serial number: 7900015ccb59266e824dd703a9000100015ccb
  issuer DN:    CN=MS QA issuing CA1,O=,C=
  subject DN:   [CN=oauth-dit.bmogc.net|http://CN=oauth-dit.bmogc.net],O=Bank of Montreal,C=CA
  issued  on:   Fri Jul 29 15:56:00 2022
  expires on:   Sat Jul 27 00:00:00 2024
  Public Key BER:

It’s interesting that in the trace, [CIAMDPQAouid.bmogc.net|http://CIAMDPQAouid.bmogc.net] is clearly shown.  (/ecurep/sf/TS011/833/TS011833001/2023-01-13/bmo_trace_-_2023-01-13T150222.633.log)  There is no display of oath-dit in the trace. 

The pcap shows: 
_Certificates (4569 bytes)_
                _Certificate Length: 1748_
                _Certificate: 308206d0308205b8a00302010202137900015ccb59266e824dd703a9000100015ccb300d… (_[_id-at-commonName=oauth-dit.bmogc.net_|http://id-at-commonName=oauth-dit.bmogc.net]_,id-at-organizationName=Bank of Montreal,id-at-localityName=Scarborough,id-at-stateOrProvinceName=Ontario,id-at-c_
                    _signedCertificate_
                    _algorithmIdentifier (sha256WithRSAEncryption)_
                    _Padding: 0_
                    _encrypted: 905f3695d88fd5cee807a6dee43ece09ad0a6c08d1bb29d6ba24fe7b469706b14c8e1657…_

For What It’s Worth, oath-dit seems to be the last cert in the keystore.  

Based on the behavior seen in this case (and the case with RBC), it seem that the certificate specified in the API call is not used.  I’m wondering if the code is always taking the last cert.
","18/Jan/23 5:52 AM;5b15d9e581c3df12acf53c4a;For L3

=====================

Need to investigate the cause of this exception which might lead to the answers:

From: (/ecurep/sf/TS011/833/TS011833001/2023-01-13/bmo_trace_-_2023-01-13T150222.633.log)

[1/13/23, 14:59:42:363 EST] 00000032 id=00000000 com.ibm.security.access.httpclient.Headers                   > getHeaderString(String) ENTRY Content-Type
[1/13/23, 14:59:42:363 EST] 00000032 id=00000000 com.ibm.security.access.httpclient.Headers                   < getHeaderString(String) RETURN application/json
[1/13/23, 14:59:42:363 EST] 00000032 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > getHttpClient(url, httpsTrustStore, clientKeyStore, clientKeyAlias,
 protocol) ENTRY [https://iambccdpdit2.bmogc.net:9777/CredentialServiceV3/iam/api/3_0/authenticate/credentials/scdemo1?expand=all|https://iambccdpdit2.bmogc.net:9777/CredentialServiceV3/iam/api/3_0/authenticate/credentials/scdemo1?expand=all] isam-dt isam-dt [CIAMDPQAouid.bmogc.net|http://CIAMDPQAouid.bmogc.net] null null
[1/13/23, 14:59:42:363 EST] 00000032 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 generateLookupKey() Lookup key : https:iambccdpdit2.bmogc.net:9777:
isam-dt:isam-dt:CIAMDPQAouid.bmogc.net
[1/13/23, 14:59:42:363 EST] 00000032 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < getHttpClient(url, httpsTrustStore, clientKeyStore, clientKeyAlias,
 protocol) RETURN org.apache.http.impl.client.InternalHttpClient@c3244c4e
[1/13/23, 14:59:42:375 EST] 00000032 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              I doRequest javax.net.ssl.SSLException: readHandshakeRecord
        at java.base/sun.security.ssl.SSLSocketImpl.readHandshakeRecord(Unknown Source)
        at java.base/sun.security.ssl.SSLSocketImpl.startHandshake(Unknown Source)
        at java.base/sun.security.ssl.SSLSocketImpl.startHandshake(Unknown Source)
        at org.apache.http.conn.ssl.SSLConnectionSocketFactory.createLayeredSocket(SSLConnectionSocketFactory.java:436)
        at org.apache.http.conn.ssl.SSLConnectionSocketFactory.connectSocket(SSLConnectionSocketFactory.java:384)
        at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:142)
        at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:376)
        at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:393)
        at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:236)
        at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:186)
        at org.apache.http.impl.execchain.RetryExec.execute(RetryExec.java:89)
        at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)
        at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)
        at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)
        at com.ibm.security.access.httpclient.HttpClientV2.doRequest(HttpClientV2.java:2692)
        at com.ibm.security.access.httpclient.HttpClientV2.httpPost(HttpClientV2.java:1332)
        at com.ibm.security.access.httpclient.HttpClientV2.httpPost(HttpClientV2.java:1229)
        at com.ibm.security.access.httpclient.HttpClientV2.httpPost(HttpClientV2.java:1126)
        at com.ibm.security.access.httpclient.HttpClientV2.httpPost(HttpClientV2.java:1041)
        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.base/java.lang.reflect.Method.invoke(Unknown Source)
        at org.mozilla.javascript.MemberBox.invoke(MemberBox.java:126)
        at org.mozilla.javascript.NativeJavaMethod.call(NativeJavaMethod.java:225)
        at org.mozilla.javascript.optimizer.OptRuntime.callN(OptRuntime.java:52)
        at org.mozilla.javascript.gen.test_test1_5._c_httpClientCallV103_6(test_test1:91)

…………….

……………","18/Jan/23 6:47 AM;5c87cb8d88f9ec6ae0afb306;From L2: 
To be clear, that exception is because the wrong certificate is being sent.  ","18/Jan/23 11:37 AM;5b15d9e581c3df12acf53c4a;I initially thought there could be something wrong with the certificate itself like chain of trust etc apparently I do not see any thing wrong, certificate is being rejected by SSL layer itself and before turning on SSL tracing, I want to make sure one thing:

Customer mentioned that if the certificate all by itself in the store then it works so I am assuming if “[+IAMDPQAouid.bmogc.net+|http://ciamdpqaouid.bmogc.net/]” is all by itself in the keystore then it works?

all I am trying to make sure that certificate itself is good and works when it is alone?

Can you confirm that please?","18/Jan/23 11:35 PM;5c87cb8d88f9ec6ae0afb306;Motiur, 

The initial problem description includes: 

_We tested that it works fine when the clientKeyStore contains the only clientKeyAlias in Personal Certificates._

There is no issue with the certificates themselves.  



The issue to solve is that the WRONG certificate is being sent when there are multiple personal certs in the keystore.  The HttpClientV2 api is not using the specified certificate.  Even thought the trace shows that the code knows gets the certificate that is specified is being found, a different certificate is being sent (as shown in the pcap.) 

In short: 

# Client configures HttpClientV2 to use ciamdpqaouid.bmogc.net
# HttpClientV2 uses oauth-dit.bmogc.net

That is the problem to solve.  ","20/Jan/23 4:03 AM;5b15d9e581c3df12acf53c4a;Yup, I kind of understood that Certificate is OK.

I am going through the code, and apparently, code is doing everything right, there must be something some where different, either some SSL environment or something so peculiar that I am having hard time to see…………

I found similar issues in Google search but quite not exact, let me do some more investigation , of I cannot find any clue , I will ask for SSL level debug trace……

it seems that as if client and server using same but different keystore from different location or something…..","24/Jan/23 8:33 AM;5b15d9e581c3df12acf53c4a;This is what I found in Googling:

[https://stackoverflow.com/questions/68816684/ssl-handshake-ending-with-javax-net-ssl-sslexception-readhandshakerecord|https://stackoverflow.com/questions/68816684/ssl-handshake-ending-with-javax-net-ssl-sslexception-readhandshakerecord|smart-link] 

Mainly talks about SSL related Properties were not set properly and client and server were reading from different location etc etc……","25/Jan/23 3:36 AM;5b15d9e581c3df12acf53c4a;From coding point of view, I just could not see any issue.

SSL level debug/trace information will be very helpful here, please ask customer to generate SSL traces in Java level using the ATP options as described below:

# Manage System Settings > System Settings > Advanced Tuning Parameters.
Click New.
In the Key field, enter runtime_profile.jvm_option.
In the Value field, enter the JVM debug options . For example,
-Djavax.net.debug=true
Click Save Configuration.
Deploy your changes

2)  And  also add the following to runtime traces:
*=info:com.ibm.websphere.ssl.*=all:com.ibm.ws.ssl.*=all:com.tivoli.am.rba.*=ALL:javax.naming.*=ALL

And get the full support file please with a restart so that whole initialization of SSL environment also get captured.....","25/Jan/23 3:49 AM;5c87cb8d88f9ec6ae0afb306;Nick and I are going to try to do a local recreate so that you can take whatever traces you need.  I don’t want to bother the customer since he has a workaround for now.


I do want to point out something.  In looking at the traces, this seemed interesting to me: 
{{[1/13/23, 14:59:42:171 EST] 00000032 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > buildConnectionSocketFactory(trustStore, isClientAuth, keyStore, keyStorePwd, alias, protocol, cfgKey) ENTRY java.security.KeyStore@215b281e true java.security.KeyStore@5192bc9 ciamdpqaouid.bmogc.net null iambccdpdit2.bmogc.net:9777}}

I’m not exactly sure what that trace statement is showing, but it sure doens’t look like the parameters match what is specified in the buildConnectionSocketFactory.  

Assuming it expects: 
truststore, isClientAuth, keyStore, keyStorePwd, alias, protocol, cfgKey)

What is passed doesn’t seem to match those expectations.

I’m not sure if this really means anything, but it looked quite strange to me.","26/Jan/23 2:42 AM;5b15d9e581c3df12acf53c4a;The problem that you see in the trace i.e. the portion that confuses any one whether or not correct parameters are passed is to do with how trace log prints parameter…….unfortunately, any array is passed to trace logging functions which sometimes cannot print the item exactly and prints its location instead which confuses people……..

In this case, I know that parameters seems to be correct….

Call started from. 

httpPost(String urlstr, Headers headers, Parameters params,
            String httpsTrustStore, String basicAuthUsername,
            String basicAuthPassword, String clientKeyStore,
            String clientKeyAlias, String protocol, boolean throwException, int timeout, boolean sendDataAsJson, String proxyServer)

From trace i see that:

httpsTrustStore = isam-dt

clientKeyStore = isam-dt

clientKeyAlias = [CIAMDPQAouid.bmogc.net|http://CIAMDPQAouid.bmogc.net]



Then it calls. doRequest(request, urlstr, headers, httpsTrustStore,
                basicAuthUsername, basicAuthPassword, clientKeyStore,
                clientKeyAlias, protocol, throwException, timeout, proxyServer);



which calls:

getHttpClient(url, httpsTrustStore, clientKeyStore, clientKeyAlias, protocol, proxyUrl);

Trace shows getHttpClient is using:

httpsTrustStore= isam-dt

clientKeyStore=isam-dt

clientKeyAlias=[CIAMDPQAouid.bmogc.net|http://CIAMDPQAouid.bmogc.net]



then getHttpClient() calls:

buildNewClient(url, httpsTrustStore, clientKeyStore, clientKeyAlias, protocol, proxyServer);

Here is the trace log statement:

{noformat}    _log.enterMethod(methodName, new Object[] {url, httpsTrustStore, clientKeyStore, clientKeyAlias, protocol, proxyServer});
    {noformat}

i.e. first 4 paramaters are url, truststore, keystore and alias 

url=[https://iambccdpdit2.bmogc.net:9777/CredentialServiceV3/iam/api/3_0/authenticate/credentials/scdemo1?expand=all|https://iambccdpdit2.bmogc.net:9777/CredentialServiceV3/iam/api/3_0/authenticate/credentials/scdemo1?expand=all]

{{httpsTrustStore}}=isam-dt

{{clientKeyStore}}=isam-dt

{{clientKeyAlias}}=[CIAMDPQAouid.bmogc.net|http://CIAMDPQAouid.bmogc.net]



So apparently all parameters are seems to be correct.

This issue is really puzzling.","27/Jan/23 7:26 AM;5b15d9e581c3df12acf53c4a;One more thing please:

When you setup and collect SSL debug traces, please all collect

Network trace

and most importantly, GSKit trace too.

My plan is to also engage GSKit team for any help.

There must be something so simple going on that we cannot see or something is so different that hopefully GSKit team will be able see/detect.

The error we see in tcp trace does not seem enough to find what is wrong and that’s where GSKit might be helpful.","27/Jan/23 10:06 AM;5b15d950d9936c61022057fe;I’m not sure that the -Djavax.net.debug=true ATP is working anymore, doesn’t seem to be adding any trace. 




{noformat}[1/26/23, 17:54:38:959 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              1 getKeyStoreByKeyIdentifier KeyAlias determined as personalb
[1/26/23, 17:54:38:959 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > loadKeyStore ENTRY
[1/26/23, 17:54:38:959 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              1 loadKeyStore Got store.
[1/26/23, 17:54:38:959 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              1 loadKeyStore loading store.
[1/26/23, 17:54:38:982 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < loadKeyStore RETURN
[1/26/23, 17:54:38:982 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < getKeyStoreByKeyIdentifier RETURN
[1/26/23, 17:54:38:982 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              1 getConnectionSocketFactory(httpsTrustStore, clientKeyStore, clientKeyAlias, protocol, cfgKey) KeyStore, alias and password were found, SSL client authentication is enabled.
[1/26/23, 17:54:38:982 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > buildConnectionSocketFactory(trustStore, isClientAuth, keyStore, keyStorePwd, alias, protocol, cfgKey) ENTRY java.security.KeyStore@cdf6cc35 true java.security.KeyStore@30303155 personalb null websealp.local.hostonly:443
[1/26/23, 17:54:39:124 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 getBooleanConfigValue Found the enableHostNameVerification config value of true for websealp.local.hostonly:443
[1/26/23, 17:54:39:124 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 getBooleanConfigValue Found the disablePublicSuffixVerification config value of false for websealp.local.hostonly:443
[1/26/23, 17:54:39:177 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < buildConnectionSocketFactory(trustStore, isClientAuth, keyStore, keyStorePwd, alias, protocol, cfgKey) RETURN org.apache.http.conn.ssl.SSLConnectionSocketFactory@fba0ac10
[1/26/23, 17:54:39:178 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < getConnectionSocketFactory(httpsTrustStore, clientKeyStore, clientKeyAlias, protocol, cfgKey) RETURN org.apache.http.conn.ssl.SSLConnectionSocketFactory@fba0ac10
[1/26/23, 17:54:39:221 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 getIntConfigValue Found the maxRouteConnections config value of 20 for websealp.local.hostonly:443
[1/26/23, 17:54:39:221 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 getIntConfigValue Found the maxConnections config value of 200 for websealp.local.hostonly:443
[1/26/23, 17:54:39:221 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 getIntConfigValue Found the connectionInactiveValidate config value of 2000 for websealp.local.hostonly:443
[1/26/23, 17:54:39:224 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 getIntConfigValue Found the connectTimeout config value of 5000 for websealp.local.hostonly:443
[1/26/23, 17:54:39:224 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 getIntConfigValue Found the getConnectionTimeout config value of 5000 for websealp.local.hostonly:443
[1/26/23, 17:54:39:224 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 getIntConfigValue Found the socketTimeout config value of 5000 for websealp.local.hostonly:443
[1/26/23, 17:54:39:314 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < buildNewClient(url, httpsTrustStore, clientKeyStore, clientKeyAlias, protocol, proxyServer) RETURN org.apache.http.impl.client.InternalHttpClient@c958a211
[1/26/23, 17:54:39:314 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < getHttpClient(url, httpsTrustStore, clientKeyStore, clientKeyAlias, protocol) RETURN org.apache.http.impl.client.InternalHttpClient@c958a211
[1/26/23, 17:54:39:820 CST] 00000023 id=00000000 com.tivoli.am.fim.logging.FIMLoggerFactory                   > getFIMLogger ENTRY
[1/26/23, 17:54:39:820 CST] 00000023 id=00000000 com.tivoli.am.fim.logging.FIMLoggerFactory                   < getFIMLogger RETURN
[1/26/23, 17:54:39:857 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < doRequest RETURN
[1/26/23, 17:54:39:857 CST] 00000023 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < httpPost RETURN Response code: 400
[1/26/23, 17:54:39:858 CST] 00000023 id=00000000 com.ibm.security.access.javascript.SandboxedContextFactory   > visibleToScripts(String) ENTRY
[1/26/23, 17:54:39:858 CST] 00000023 id=00000000 com.ibm.security.access.javascript.SandboxedContextFactory   2 visibleToScripts(String) Class [com.ibm.security.access.httpclient.HttpResponse] is white-listed.
[1/26/23, 17:54:39:858 CST] 00000023 id=00000000 com.ibm.security.access.javascript.SandboxedContextFactory   < visibleToScripts(String) RETURN
[1/26/23, 17:54:39:859 CST] 00000023 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY (uuidf08112af-0185-1d8f-b853-e92bb5dda77d) mXluvoPi1w :  Response: Response code: 400
[1/26/23, 17:54:39:859 CST] 00000023 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils < traceString RETURN
[1/26/23, 17:54:39:859 CST] 00000023 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY (uuidf08112af-0185-1d8f-b853-e92bb5dda77d) mXluvoPi1w :  Response body: {
    ""error_code""    : ""0x38cf0424"",
    ""error_message"" : ""Bad Request""
}

[1/26/23, 17:54:39:859 CST] 00000023 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils < traceString RETURN{noformat}","27/Jan/23 10:10 AM;5b15d950d9936c61022057fe;I’m not sure what a GSkit trace would show, as it is a Java client making an https request.    In a  simple PCAP I see the Java client sending the first personal cert in the keystore not the one it was told to use.    I can even see in the certificate request that the cert it was instructed to use is listed in the distinguished names portion., but so is the one that it is using. ","28/Jan/23 1:19 AM;5b15d9e581c3df12acf53c4a;OOOps, about GSKit, you are right, GSKit trace is not needed for this issue.

Please Open a Secondary against  Java Security, we need their guidance.

Last time I worked on similar issue and also we involved Java Security and their guidance was what I mentioned in earlier i.e.

================

SSL level debug/trace information will be very helpful here, please ask customer to generate SSL traces in Java level using the ATP options as described below:

# Manage System Settings > System Settings > Advanced Tuning Parameters.
Click New.
In the Key field, enter runtime_profile.jvm_option.
In the Value field, enter the JVM debug options . For example,
-Djavax.net.debug=true
Click Save Configuration.
Deploy your changes

# And  also add the following to runtime traces:

*=info:com.ibm.websphere.ssl.*=all:com.ibm.ws.ssl.*=all:com.tivoli.am.rba.*=ALL:javax.naming.*=ALL

And get the full support file please with a restart so that whole initialization of SSL environment also get captured.....

====================

Here is a Technote regarding Liberty Security related trace gathering:

[https://www.ibm.com/support/pages/mustgather-ssl-problems-websphere-liberty|https://www.ibm.com/support/pages/mustgather-ssl-problems-websphere-liberty|smart-link] 

* Add the following string to the <logging> element in server.xml:SSLChannel=all:com.ibm.ws.ssl.*=all:com.ibm.websphere.ssl=all:com.ibm.wsspi.ssl.*=all

* Insert the following generic JVM arguments in the jvm.options file:-Djavax.net.debug=all
* 

=================================

Some trace specification can be just typed in in the text box.

With the above specification, we were able to collect  Java low level trace before and as far as tracing goes for ISVA AAC, nothing changed.

So, let’s start with Java Security and we will follow their guidance.","28/Jan/23 1:29 AM;5b15d9e581c3df12acf53c4a;Also, another thing I noticed with the tcp trace in ecurep is that it seems to be incomplete i.e.

sequence seems like ( missing server response )

Client Hello

Server Hello

(*_Seems to be missing packets where server is supposed to send Server’s certificate, server’s Key Exchange, Certificate )_*

Then Client sending “certificate” followed by

Client → “Client Key Exchange”","31/Jan/23 12:07 AM;5c87cb8d88f9ec6ae0afb306;Hello [~accountid:5b15d9e581c3df12acf53c4a] 

I’m working on getting a trace from the recreate system.  I have the trace strings working fine, I just need to work on my certs.  I did notice something, that might provide a hint.

I see this in the client’s PCAP as well.  

*tcp.stream eq 0* shows the failing sequence.

The “CertificateRequest” shows: 
Handshake Protocol: Certificate Request
    Handshake Type: Certificate Request (13)
    Length: 38
    Certificate types count: 3
    Certificate types (3 types)
        Certificate type: RSA Sign (1)
        Certificate type: DSS Sign (2)
        Certificate type: ECDSA Sign (64)
    Signature Hash Algorithms Length: 30
    Signature Hash Algorithms (15 algorithms)
        Signature Algorithm: rsa_pkcs1_sha512 (0x0601)
        Signature Algorithm: SHA512 DSA (0x0602)
        Signature Algorithm: ecdsa_secp521r1_sha512 (0x0603)
        Signature Algorithm: rsa_pkcs1_sha384 (0x0501)
        Signature Algorithm: SHA384 DSA (0x0502)
        Signature Algorithm: ecdsa_secp384r1_sha384 (0x0503)
        Signature Algorithm: rsa_pkcs1_sha256 (0x0401)
        Signature Algorithm: SHA256 DSA (0x0402)
        Signature Algorithm: ecdsa_secp256r1_sha256 (0x0403)
        Signature Algorithm: SHA224 RSA (0x0301)
        Signature Algorithm: SHA224 DSA (0x0302)
        Signature Algorithm: SHA224 ECDSA (0x0303)
        Signature Algorithm: rsa_pkcs1_sha1 (0x0201)
        Signature Algorithm: SHA1 DSA (0x0202)
        Signature Algorithm: ecdsa_sha1 (0x0203)
    *Distinguished Names Length: 0*

It seems like the code is returning the first certificate that is valid, not the one specified in the httpClientV2 call. 

Based on a trace I did (not for this recreate), it doesn’t look like our code is involved in determining which certificate is returned, that that is done at the javax.net.ssl level.


Is there something / something else that needs to be set when creating the connection?  To make sure the specified certificate is used?

I’ll work on getting traces (from a recreate environment) today or tomorrow.  


","31/Jan/23 2:21 AM;5b15d9e581c3df12acf53c4a;[~accountid:5c87cb8d88f9ec6ae0afb306] Either I am making a mistake looking at the tcp trace or I am looking at the wrong tcp trace file, the one I am looking at is from:

/ecurep/sf/TS011/833/TS011833001/2023-01-13/isva_10.0.3.1_20230113-153253_isambccldvmga23.srv.bmogc.net.support_unpack/var/tcptrace/trace01.pcap

Is this the one you are looking at?

I do not seem to see all the packets that you are seeing ?","31/Jan/23 5:04 AM;5c87cb8d88f9ec6ae0afb306;I am using the Wireshark on the Citrix server and looking at the file that I specified in the problem description: 
/ecurep/sf/TS011/833/TS011833001/2023-01-13/bmo_trace01_20220113.pcap.txt

*tcp.stream eq 0*



I have also just added traces from my test environment to this case.  They are attached as traces.log and trace01.pcap.

You can use the following filter on the pcap *ip.addr==192.168.122.211*

The certificate I specified in my API call was: [wildcard.kvm.org|http://wildcard.kvm.org]

The Certificate request (from the server) has the following (at the end): 


!Screenshot 2023-01-30 at 1.01.19 PM.png|width=1432,height=240!

ISVA is returning: 
Certificate: 3082031830820200a003020102020847f58661a40bf7dc300d06092a864886f70d01010b… (id-at-commonName=isam,id-at-organizationName=ibm,id-at-countryName=us)



I THINK that ISVA is returning the first certificate in the keystore, on my case, rt_profile, that matches one of the certificates in the certificate request.

The correct behavior would be to return the certificate that was specified in the API call.  ",31/Jan/23 6:44 AM;5b15d9e581c3df12acf53c4a;Would you also please add the keyStore/Truststore i.e. key files that you used for both server and client please?,"31/Jan/23 10:33 AM;5b15d9e581c3df12acf53c4a;I think we all got duped by the name of the parameter in various functions/methods……

e.g. If I want to use a parameter in a method/function to look up some information, I should name the parameter something like say lookUpString instead of naming it like say userName/userID which will confuse user as what this parameter means, user might think I should provide a  user ID or some thing…………

In ISVA, when it starts up, it loads all keystore present in shared location, all of them and it initializes a mapping table with keystore name along with each and every alias/label present in that keystore, it does that so that when needed, it can easily and unambiguously find it and use it.

e.g. if you look at the trace file, you will see something like:   

[1/30/23, 12:08:13:642 CST] 0000002d id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > getKeyStoreByKeyIdentifier ENTRY
[1/30/23, 12:08:13:642 CST] 0000002d id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > getKessServiceClient ENTRY
[1/30/23, 12:08:13:642 CST] 0000002d id=00000000 com.ibm.security.access.httpclient.HttpClientV2              1 getKessServiceClient Getting the KessServiceClient.
[1/30/23, 12:08:13:643 CST] 0000002d id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < getKessServiceClient RETURN
[1/30/23, 12:08:13:643 CST] 0000002d id=00000000 com.ibm.security.access.httpclient.HttpClientV2              1 getKeyStoreByKeyIdentifier Getting the store from KeyService *_rt_profile_keys_wildcard.kvm.org_*
[1/30/23, 12:08:13:643 CST] 0000002d id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > getKessServiceClientContext ENTRY
[1/30/23, 12:08:13:643 CST] 0000002d id=00000000 com.ibm.security.access.httpclient.HttpClientV2              < getKessServiceClientContext RETURN
………………………

……………………..



Please note the string “*_rt_profile_keys_wildcard.kvm.org_*”  i.e.  “trustStore_clientKeyAlias” …because it is looking for that keyStore where this keyAlias present there by making sure that this is the right key store to use.

It assumes that various keyStore may or may not contains same keys/certs………..

So bottom line:

These paramters i.e. xyzFunction(trustStore, clientKeyAlias…………) is  not that  “use this clientKeyAlias from this trustStore” rather use this “trustStore and use this clientkeyAlias to quickly lookup and find the exact trustStore from mapping table”

So, this clientKeyAlias was never meant to be presented by the client as a certificate to the server, it meant to be used as forming a lookup string to lookup and find and use the right/correct trustStore.","01/Feb/23 1:33 AM;5b15d950d9936c61022057fe;!image-20230131-153044.png|width=1626,height=447!

Javadoc states the intended use is to specify the client key to use.  Not for looking up what trust store.

”So, this clientKeyAlias was never meant to be presented by the client as a certificate to the server, it meant to be used as forming a lookup string to lookup and find and use the right/correct trustStore.”  The Javadoc disagrees with this statement clearly the Javadoc intends for it to specify the Client key to use for client cert auth.","01/Feb/23 3:43 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b15d950d9936c61022057fe] So far , reading the code and doc related comment in the code does not seem to indicate that this particular keyAlias will be presented to the server and, looking at code, all it is doing is basically locating the keystore in the already created mapping tables.



In any case, I will do some more digging and will update.

(This cold freeze caused our schools to be closed today and tomorrow…..there by messing up my normal schedule)



Can you please add the doc link here?",01/Feb/23 5:37 AM;5b15d950d9936c61022057fe;[https://ibm-security.github.io/apidocs/verifyaccess/10.0.3.0/ISVA-javadoc/com/ibm/security/access/httpclient/HttpClientV2.html|https://ibm-security.github.io/apidocs/verifyaccess/10.0.3.0/ISVA-javadoc/com/ibm/security/access/httpclient/HttpClientV2.html|smart-link] ,"09/Feb/23 12:03 AM;5c87cb8d88f9ec6ae0afb306;Hello Motiur, 
Any updates on the investigation?","09/Feb/23 8:39 AM;5b15d9e581c3df12acf53c4a;I did more investigation, as it is designed, this alias along with keystore name is used as lookup key to find the proper ( as it load all the available keys during start up ) keys to load and initialize. That’s all this keyAlias does.

I also could not find any document where it indicate this alias (Certificate ) will be the one presented during ssl handshake, it just indicate the presence of kyeAlias indicates that SSL will be used.

Outside of this, in googling, I found that lots of design discourage using specific certificate because JSE will  present the best available certificate ( if many present ) depending on the criteria presented by the server.","09/Feb/23 11:37 PM;5c87cb8d88f9ec6ae0afb306;Who is the developer that implemented this function?  Is it worth having a discussion with them? 

If what you have discovered is how this is designed to work, it seems like our API doc is very misleading. 

It makes no sense that the only way for this to work (using the requested certificate) is to have that certificate chain in it’s OWN keystore.  ","10/Feb/23 6:42 AM;5b15d9e581c3df12acf53c4a;API doc , at least on the first glimpse, might be misleading, but, unfortunately, there is no code present to use that parameter i.e. keyAlias other than as a lookup key.

In any case, I am talking in our team, need to find out what the intent was , is it a oversight or something else…..I will update soon.",11/Feb/23 12:05 AM;5c87cb8d88f9ec6ae0afb306;Thanks!  ,"14/Feb/23 6:52 AM;5b15d9e581c3df12acf53c4a;What version of ISVA did you use to reproduce?

Also please keep your reproduction around.","16/Feb/23 3:38 AM;5b15d9e581c3df12acf53c4a;This is  quick fixpack built against ISVA 10.0.4.0

Please give this one a try in your re-create environment. also, please turn on similar trace as before.",16/Feb/23 5:00 AM;5c87cb8d88f9ec6ae0afb306;I have recreated the issue on my 10.0.3.1 system.  ,"16/Feb/23 6:21 AM;5b15d9e581c3df12acf53c4a;Oh OK, I will create one for 10.0.3.1","16/Feb/23 7:04 AM;5b15d9e581c3df12acf53c4a;[^AAC_Client_To_Provide_Specified_Cert_10031.fixpack]

Here is the ISVA 100.3.1 version.

Fixpack is supposed to restart AAC Runtime, just to be sure, after install, re-start it any way and then recreate please.","16/Feb/23 7:13 AM;5c87cb8d88f9ec6ae0afb306;Thanks.  I should have a chance to test this tomorrow.  
","17/Feb/23 2:33 AM;5c87cb8d88f9ec6ae0afb306;Hello Motiur, 

The fixpack  changed the behavior.   But I’m not sure that the behavior is exactly correct.

For my test, I specified the following certificate in my server connection: 
CN=websealp.loccal.hotonly,O=IBM,L=Austin,ST=Texas,C=US

If you filter on ‘tcp.stream eq 15’ for post-fixpack.pcap, you will see that the proxy (192.168.211.202) sends an empty certificate to the reply to the ‘certificate request’.  If you look at the ‘certificate request’, you will notice that ‘CN=websealp.loccal.hotonly,O=IBM,L=Austin,ST=Texas,C=US’ is not listed as one of the certificates.  (That is because I don’t have it in the keystore of the target proxy)

I added it to the pdsrv of the target proxy and then it was returned as the certificate.  You can filter on ‘tcp.stream eq 7’ in the post-fixpack-2.pcap file.  The certificate request now includes the certificate in the list of certificates and it is returned by WebSEAL.

*NOTE:*  I’m not expecting the connection to complete successfully.  What I’m really testing is that the specified certificate is being sent.


*My Concern:* If I remember correctly, in the customer’s environment, the certificate request does not include a list of certificates.  So, in their case, I don’t think this fix will send the certificate that was specified.

*My Question:* Why should we care if the certificate is in the ‘certificate request’?  The client is specifying what certificate they want to used, so why not just use that?

I’ve also uploaded a file called traces.log.  It should include the traces from both of the above cases.","17/Feb/23 6:08 AM;5b15d9e581c3df12acf53c4a;Gary,

Actually , it is working as it is supposed, though your test is little different from Customer’s.



In Customer’s case, issue is from client side, server side is perfect.

Client side has say, ( I am changing the name for easy writing ) Two certificates say:

PreferredCert and optionalCert, both of them  is trusted/signed by CA which already present in Server’s Truststore.

That’s why, for Customer, either cert works, ONLY problem is that they want Client to present “PreferredCert” NOT the optionalCert.

So, fix is done so that PreferredCert ( indicated by keyAlias of the API ) is presented.

===============

In your test, your certificate, it is self-signed, “CN=websealp.loccal.hotonly,O=IBM,L=Austin,ST=Texas,C=US” to be presented by Client to Server but  the CA  of this Cert ( i.e. itself ) is NOT present in the Server’s truststore, hence it is not presented because server will not accept it……

==============

As Per SSL HandShake protocol:

When Server sends “Server Hello” it does the following: ( You already know but I am writing for explanation )

Among other stuff,  Server say to Client:

Here is my server certificate:  “[gmv-1050.kvm.org|http://gmv-1050.kvm.org]”   do you trust it?

And by the way, since you configured for mutual authentication, which means you will send me your certificate, if you do, here are the CA’s that I trust i.e your certificate has to be trusted/signed by one of the CA in this list:

ie. caA

caB

caC

…….

and so on

==============================

See, in your first test, your cert i.e. “CN=websealp.loccal.hotonly,O=IBM,L=Austin,ST=Texas,C=US”  is not trusted i.e. it’s CA is NOT present /listed/ in server’s trust store……………

Once you added,  server’s ca list became:

caA

caB

caC

…………….

CN=websealp.loccal.hotonly,O=IBM,L=Austin,ST=Texas,C=US

=====================

Now it worked i.e. server’s trusted the client’s cert.

================================



Another test will be like customer’s

You can generate a CA,  generate two certificate , certA and certB, both signed by your own CA i.e. myCA, add those two certs in your client store and also add your CA i.e. myCA to server truststore and test……

Specify certB to be presented all the time and test will be like customer’s

Or

If customer has a test env, send it to customer, keep it mind that this fp is only for 10.0.3.1

===========================================



Let me know if my explanation make any sense or I missed something obvious.",21/Feb/23 2:50 AM;5c87cb8d88f9ec6ae0afb306;Can I give the fixpack to the client to see if it works for them?  ,"21/Feb/23 5:26 AM;5b15d9e581c3df12acf53c4a;Yes, please do send it to customer.","28/Feb/23 3:41 AM;5c87cb8d88f9ec6ae0afb306;Hello Motiur, 


The client indicates that the fix works in his environment.   Do I need to open an APAR for this issue?  

The customer indicates this fix conflicted with the fix for IJ45402 provided by [~accountid:5af4ad7d4dd24c579110120b] .  

This client is the one who reported both of the issues, the connection timeout and wrong cert being used.  This customer will need a fixpack that includes this fix AND the fix for IJ45402 that was provided by [~accountid:5af4ad7d4dd24c579110120b] .

","28/Feb/23 4:05 AM;5b15d9e581c3df12acf53c4a;OK, that’s a very good news that it worked.

Please do open an APAR

And yes, it does conflict with IJ45402

I did not realize the issue  about IJ45402 before, I will combine them both together and will supply a fix containing the both soon.

For now, start with opening an APAR.","28/Feb/23 4:39 AM;5c87cb8d88f9ec6ae0afb306;No worries!

APAR IJ45606 has been opened. 

Please update the case when the new “combined” fix is available. ","04/Mar/23 4:49 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 73058d596dbdb5821c43c9ed8da1b74306b8f7c5
   * description: ISAMSUP-4711 AAC Client cannot present specific certificate to server

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85986513.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4711) which we publish.","07/Mar/23 12:03 AM;5c87cb8d88f9ec6ae0afb306;Hello [~accountid:5b15d9e581c3df12acf53c4a] , 

Is the new fix available?  If so, where can I get it?

","07/Mar/23 5:57 AM;5b15d9e581c3df12acf53c4a;OK, new fixpack is available in:

[https://ibm.ent.box.com/folder/197672808662|https://ibm.ent.box.com/folder/197672808662|smart-link] 



It combine this fix plus the timeout related fix done by IJ45402

Name of the fixpack: AAC_Client_To_Provide_Specified_Cert_And_Timeout10031.fixpack

(Combine: IJ45606 + IJ45402 )

Let us know how it gopes.","09/Mar/23 3:57 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 4f9e24a23bfaf69ce593aca4892f2e925b280a90
   * description: Merge pull request #5721 from ISAM/ISAMSUP-4711

ISAMSUP-4711 AAC Client cannot present specific certificate to server

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86283585.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230308175428-4f9e24a23.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","09/Mar/23 5:21 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 4f9e24a23bfaf69ce593aca4892f2e925b280a90
   * description: Merge pull request #5721 from ISAM/ISAMSUP-4711

ISAMSUP-4711 AAC Client cannot present specific certificate to server

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86291564.


This build has not been published as the commit is not currently within a branch (20230308175428-4f9e24a23) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Policy server is running too slow and restarts automatically,ISAMSUP-4700,275572,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,Peter Horner,5b15d9517dab4c51f61b5190,Akshatha,61548f169cdb9300722d0c1f,Akshatha,61548f169cdb9300722d0c1f,11/Jan/23 8:15 PM,24/Feb/23 10:17 AM,14/Jul/23 2:47 PM,24/Feb/23 10:17 AM,,,,0,,,,"From 5:58 am on Jan 04 2023, customers monitoring tools detect that the Policy server is down intermittently. 

In event.log, we can see messages like this: 

Low: WGAWA0673I The Web runtime component has recovered. Jan 4, 2023, 9:44:22 AM 

Medium: WGAWA0674W The Web runtime component is not running. Jan 4, 2023, 9:43:52 AM

 In msg__pdmgrd.log , we can see that the policy server was automatically restarted:

 *** Error in `/opt/PolicyDirector/bin/pdmgrd': corrupted double-linked list: 0x00007fa60c0189e0

 *** ======= Backtrace: ========= .... .... .... 2023-01-04-11:54:17.130+01:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 654 0x7fcb605d7700 

WGAWA0034E The process, /opt/PolicyDirector/bin/pdmgrd, was terminated by the signal, 6. 

The process will be automatically restarted. Operations in pdadmin are very slow, such as a list.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4676,,ISAMSUP-3284,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011716038,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Akshatha,61548f169cdb9300722d0c1f,,,,"BBVA, S.A CENTRO DE TRATAMIENTO FACTURAS",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17k9r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-01-12 04:11:10.641,,,,,"11/Jan/23 8:17 PM;61548f169cdb9300722d0c1f;Policy server restarted again on restarted again on :

2023-01-05-04:52:15.138+01:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 654 0x7fcb605d7700

WGAWA0034E The process, /opt/PolicyDirector/bin/pdmgrd, was terminated by the signal, 11. The process will be automatically restarted.","11/Jan/23 8:20 PM;61548f169cdb9300722d0c1f;We asked if there is a limit in their env, in terms of memory /disk? , 

Did they see the system reaching its memory or disk limits? , 

Do they manage system reports which tell how was memory and disk utilized? 

And customer confirmed that 

{{The limit of available resources, both memory and disk, CPU or storage, was not reached at any time. }}



The first error that I can see from msg_pdmgrd.log is the following and then several restarts.

2023-01-04-11:54:17.130+01:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 654 0x7fcb605d7700

WGAWA0034E The process, /opt/PolicyDirector/bin/pdmgrd, was terminated by the signal, 6. The process will be automatically restarted.

The last error message showing on the logs is :

2023-01-05-04:52:15.138+01:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 654 0x7fcb605d7700

WGAWA0034E The process, /opt/PolicyDirector/bin/pdmgrd, was terminated by the signal, 11. The process will be automatically restarted.



From the /var/log/messages I could not find any obvious error messages occurring that cause these restarts.



However, I see HIGH CPU utilization of 88%

Jan 4 13:16:06 wga_notifications: WGAWA0043W:: WGA_events:: |1=88%,msg=High CPU utilization: 88%|

Jan 4 13:16:25 -mesa_cli[17722]: GLGRS1003I:: GLG_events:: |interface=CLI,user=admin|

Jan 4 13:16:25 mesa_config[17723]: Stopping App Server

Jan 4 13:16:25 su: + /dev/pts/0 admin:www-data

Jan 4 13:17:06 wga_notifications: WGAWA0043W:: WGA_events:: |1=87%,msg=High CPU utilization: 87%|

Jan 4 13:19:07 mesa_config[17723]: Error: Unable to stop App Server

Jan 4 13:19:08 mesa_config[17723]: Starting App Server

Jan 4 13:19:08 su: + /dev/pts/0 admin:www-data

Jan 4 13:19:08 mesa_config[17723]: Error: Unable to start App Server

Jan 4 13:19:36 wga_notifications: WGAWA0043W:: WGA_events:: |1=88%,msg=High CPU utilization: 88%|

Jan 4 13:19:57 sshd[18813]: audit connection from 192.168.35.30 port 42404 euid 0



and after the start of the app server, the utilization was fallen below the threshold value.



Jan 4 13:30:25 mesa_config[22576]: Starting App Server

Jan 4 13:30:25 su: + /dev/pts/0 admin:www-data

Jan 4 13:30:36 wga_notifications: WGAWA0650I:: WGA_events:: |1=24%,msg=The CPU utilization has fallen below the configured threshold: 24%|



and multiple segafault can be seen for Jan 5



Jan 5 04:52:13 kernel: pdmgrd[17007]: segfault at 4b1 ip 00000000000004b1 sp 00007fcb1ffdea08 error 14 in pdmgrd[400000+3000]

Jan 5 04:52:13 wga_notifications: WGAWA0674W:: WGA_events:: |<no-params>,msg=The Web runtime component is not running.|

Jan 5 04:52:13 mesa_config[20019]: GLGSY0020I:: GLG_events:: |user=IMM0784|

Jan 5 04:52:13 mesa_config[20019]: GLGSY0103I:: GLG_events:: |user=IMM0784,host=192.168.48.69|

Jan 5 04:52:43 wga_notifications: WGAWA0673I:: WGA_events:: |<no-params>,msg=The Web runtime component has recovered.|

Jan 5 04:53:05 mesa_config[20644]: GLGSY0020I:: GLG_events:: |user=IMM0784|","11/Jan/23 8:21 PM;61548f169cdb9300722d0c1f;The system was working normally but then the problem persisted.

 The policy server has been restarted several times automatically in the last few days.",11/Jan/23 8:21 PM;61548f169cdb9300722d0c1f;The latest support file is at /ecurep/sf/TS011/716/TS011716038/2023-01-11/,"12/Jan/23 2:11 PM;5b15d9517dab4c51f61b5190;This looks like IJ33801 from [https://cloudidentity.atlassian.net/browse/ISAMSUP-3267|https://cloudidentity.atlassian.net/browse/ISAMSUP-3267|smart-link] 

The Policy Server pstack file iswga/pstack/30183.txt shows most threads in a lock wait and lots of threads in KDBRefresher which are the symptoms of IJ33801

IJ33801 was fixed in 10.0.2.0 IF1 - but we didnt build a fix for 10.0.1.0

I build a IJ33801 fixpack for 10.0.1.0 IF1","12/Jan/23 5:09 PM;5b15d9517dab4c51f61b5190;[~accountid:61548f169cdb9300722d0c1f] 

I have attached the 10.0.1.0 IF1 fixpack to [https://cloudidentity.atlassian.net/browse/ISAMSUP-3284|https://cloudidentity.atlassian.net/browse/ISAMSUP-3284|smart-link] 

If this does not resolve the issue, please create and upload a new support file - so I can see if the symptom seen in the pstack file persists after the fixpack",01/Feb/23 6:27 PM;61548f169cdb9300722d0c1f;The customer has installed the fix pack in their test environments and will install it in production on February 14. ,24/Feb/23 10:17 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA 10.0.5.0 PDJRTE does not work with IBM JRE 8 or OpenJDK 11.,ISAMSUP-4693,274929,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,,Bill Tyler,5b15d94b6256d01ad54eb020,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,08/Jan/23 1:24 AM,29/Jun/23 8:16 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"Customer’s use case:
1) Working SDI integration using RgyDirect over TLS with 10.0.2.0.
2) Customer upgrades to 10.0.5.0.
3) The following is thrown:


{noformat}var e = new Packages.com.ibm.di.exception.ITDIAgentException(errorStr);
e.setEntry(work);
task.dumpEntry(work);
throw e;

2022-12-21 10:28:27,066 ERROR [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] - Initialize Error: {
        ""status"": ""fail"",
        ""connectorname"": ""lookupRegistryUser"",
        ""operation"": ""initialize"",
        ""exception"": ""com.ibm.di.utils.tam.combo.contextpool.ContextException: Could not configure the context pool: com.tivoli.pd.rgy.exception.ConfigurationErrorRgyException: HPDAA0333E   Unable to determine the registry server type.  Error message HPDAA0370E   An unexpected error occurred while using the configured key store: /opt/IBM/TDI/TDISOL_dir/cert/u-idi-massl.eu.nag.net.jks. This key store is required for mutual SSL authentication to the user registry.."",
        ""message"": ""Could not configure the context pool: com.tivoli.pd.rgy.exception.ConfigurationErrorRgyException: HPDAA0333E   Unable to determine the registry server type.  Error message HPDAA0370E   An unexpected error occurred while using the configured key store: /opt/IBM/TDI/TDISOL_dir/cert/u-idi-massl.eu.nag.net.jks. This key store is required for mutual SSL authentication to the user registry.."",
        ""class"": ""com.ibm.di.utils.tam.combo.contextpool.ContextException""
}
2022-12-21 10:28:27,078 ERROR [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] - com.ibm.di.utils.tam.combo.contextpool.ContextException: Could not configure the context pool: com.tivoli.pd.rgy.exception.ConfigurationErrorRgyException: HPDAA0333E   Unable to determine the registry server type.  Error message HPDAA0370E   An unexpected error occurred while using the configured key store: /opt/IBM/TDI/TDISOL_dir/cert/u-idi-massl.eu.nag.net.jks. This key store is required for mutual SSL authentication to the user registry..: com.ibm.di.utils.tam.combo.contextpool.ContextPoolFactory.configure(Unknown Source); com.ibm.di.utils.tam.combo.provisioning.TAMRgyObjManager.<init>(Unknown Source); com.ibm.di.utils.tam.combo.provisioning.TAMObjManagerFactory.configure(Unknown Source); com.ibm.di.utils.tam.combo.connector.registry.TAMRgyConnector.initialize(Unknown Source); com.ibm.di.server.AssemblyLineComponent.doInitialize(AssemblyLineComponent.java:1189); com.ibm.di.server.AssemblyLineComponent.initialize(AssemblyLineComponent.java:1151); com.ibm.di.server.AssemblyLine.initConnectors(AssemblyLine.java:1931); com.ibm.di.server.AssemblyLine.msInitConn(AssemblyLine.java:3603); com.ibm.di.server.AssemblyLine.executeMainStep(AssemblyLine.java:3413); com.ibm.di.server.AssemblyLine.initExecuteProlog(AssemblyLine.java:3089); com.ibm.di.server.RS.startAL(RS.java:1199); com.ibm.di.server.RS.startAL(RS.java:1150); com.ibm.di.server.RS.startAL(RS.java:1132); com.ibm.di.dispatcher.rmi.TdiDispatcher.startAssemblyLine(Unknown Source); com.ibm.di.dispatcher.rmi.TdiDispatcher.executeALRequest(Unknown Source); com.ibm.di.dispatcher.rmi.RMIDispatcherImpl.executeALRequest(Unknown Source); com.ibm.di.dispatcher.rmi.RMIDispatcherImpl_Skel.dispatch(RMIDispatcherImpl_Skel.java:66); sun.rmi.server.UnicastServerRef.oldDispatch(UnicastServerRef.java:486); sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:318); sun.rmi.transport.Transport$1.run(Transport.java:212); sun.rmi.transport.Transport$1.run(Transport.java:209); java.security.AccessController.doPrivileged(AccessController.java:770); sun.rmi.transport.Transport.serviceCall(Transport.java:208); sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:585); sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:846); sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:700); sun.rmi.transport.tcp.TCPTransport$ConnectionHandler$$Lambda$8/0x000000000883bc40.run(Unknown Source); java.security.AccessController.doPrivileged(AccessController.java:704); sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:699); java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1160); java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635); java.lang.Thread.run(Thread.java:822);
2022-12-21 10:28:27,085 INFO  [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] - CTGDIS003I *** Start dumping Entry
2022-12-21 10:28:27,086 INFO  [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] -         Operation: generic
2022-12-21 10:28:27,087 INFO  [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] -         Entry attributes:
2022-12-21 10:28:27,087 INFO  [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] -         Entry properties:
2022-12-21 10:28:27,088 INFO  [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] -                 REASON_MESSAGE: 'com.ibm.di.connector.CONNECTION_ERROR'
2022-12-21 10:28:27,088 INFO  [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] -                 REASONCODE:     '101'
2022-12-21 10:28:27,088 INFO  [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] -                 REASON_MESSAGE_ARGS:    '[Initialize Error: {
        ""status"": ""fail"",
        ""connectorname"": ""lookupRegistryUser"",
        ""operation"": ""initialize"",
        ""exception"": ""com.ibm.di.utils.tam.combo.contextpool.ContextException: Could not configure the context pool: com.tivoli.pd.rgy.exception.ConfigurationErrorRgyException: HPDAA0333E   Unable to determine the registry server type.  Error message HPDAA0370E   An unexpected error occurred while using the configured key store: /opt/IBM/TDI/TDISOL_dir/cert/u-idi-massl.eu.nag.net.jks. This key store is required for mutual SSL authentication to the user registry.."",
        ""message"": ""Could not configure the context pool: com.tivoli.pd.rgy.exception.ConfigurationErrorRgyException: HPDAA0333E   Unable to determine the registry server type.  Error message HPDAA0370E   An unexpected error occurred while using the configured key store: /opt/IBM/TDI/TDISOL_dir/cert/u-idi-massl.eu.nag.net.jks. This key store is required for mutual SSL authentication to the user registry.."",
        ""class"": ""com.ibm.di.utils.tam.combo.contextpool.ContextException""
}]'
2022-12-21 10:28:27,088 INFO  [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] -                 STATUSCODE:     '2'
2022-12-21 10:28:27,088 INFO  [AssemblyLine.AssemblyLines/tamAdd_ISAM Combo_3763371339656696802_1dc71722-2d06-11b2-6961-0000ac1f7642] - CTGDIS004I *** Finished dumping Entry
2022-12-21 10:28:27,090 DEBUG [ITIM_Dispatcher] - Inside itdiAgentException
2022-12-21 10:28:27,093 DEBUG [ITIM_Dispatcher] - After getting result from iae.getEntry
2022-12-21 10:28:27,093 DEBUG [ITIM_Dispatcher] - Before checking for result if null
2022-12-21 10:28:27,094 DEBUG [ITIM_Dispatcher] - alname=tamAdd:oprtype=add
2022-12-21 10:28:27,094 DEBUG [ITIM_Dispatcher] - In Set Defaults
2022-12-21 10:28:27,094 DEBUG [ITIM_Dispatcher] - default SEARCH_FINISHED=false
2022-12-21 10:28:27,094 DEBUG [ITIM_Dispatcher] - default CACHE_CONNECTORS=true
2022-12-21 10:28:27,094 DEBUG [ITIM_Dispatcher] - >>>>> BEGIN DUMP ENTRY{noformat}



I see errors all around with the following scenarios:

+*Fresh setup*+
java version ""1.8.0_351""
Java(TM) SE Runtime Environment (build 8.0.7.20 - pxa6480sr7fp20-20221020_01(SR7 FP20))

./pdjrtecfg -action config -host [isva1050.kvm.org|http://isva1050.kvm.org] -port 7135 -java_home /usr/local/java/ibm-java-sdk-8.0-7.20-x86_64/jre -config_type full *<=============== WORKS*

java -Djavax.net.debug=ssl,handshake com.tivoli.pd.jcfg.SvrSslCfg -action config -admin_id sec_master -admin_pwd bighulk99 -appsvr_id ISVA1050 -port 9999 -mode remote -dbdir . -policysvr isva1050.kvm.org:7135:1 -authzsvr isva1050.kvm.org:7136:1 -cfg_file ISVA1050.properties -key_file ISVA1050.ks -host [isam700.level2.org|http://isam700.level2.org] -cfg_action create

javax.net.ssl|FINE|01|main|2023-01-06 15:33:52.112 CST|Thread.java:1178|IBMJSSE2 will not allow protocol SSLv3 per com.ibm.jsse2.disableSSLv3 set to TRUE or default
javax.net.ssl|FINE|01|main|2023-01-06 15:33:52.123 CST|Thread.java:1178|IBMJSSEProvider2 Build-Level: -20220909--560
Exception in thread ""main""
*[java.lang.IllegalStateException: java.security.NoSuchAlgorithmException: SunX509 KeyManagerFactory not available <=============== FAILS*



+*Existing setup*+
java version ""1.8.0_351""
Java(TM) SE Runtime Environment (build 8.0.7.20 - pxa6480sr7fp20-20221020_01(SR7 FP20))

Configured using 10.0.2.0 PD.jar and everything works.  Replace with 10.0.5.0 PD.jar and get same as above.



+*Fresh/Existing setup using RgyDirect*+
java  rgyDirect_authenticate ../ISVA1050.properties sec_master bighulk99
Properties file = file:../ISVA1050.properties
Creating an instance of RgyRegistry for LDAP Jan 06, 2023 7:23:03 PM com.tivoli.pd.rgy.ldap.LdapRgyRegistry constructor INFO: Full version = 10.0.2.0
Creating an instance of RgyUser
Successfully Authenticated



java  rgyDirect_authenticate ../ISVA1050.properties sec_master bighulk99
Properties file = file:../ISVA1050.properties
Creating an instance of RgyRegistry for LDAP
Jan 06, 2023 7:23:46 PM com.tivoli.pd.rgy.ldap.LdapRgyRegistry constructor

INFO: Full version = 10.0.5.0

com.tivoli.pd.rgy.exception.ConfigurationErrorRgyException: HPDAA0333E   Unable to determine the registry server type.  Error message HPDAA0370E   An unexpected error occurred while using the configured key store: /root/src/amjrte/RgyDirect/ISVA1050.ks. This key store is required for mutual SSL authentication to the user registry..

        at com.tivoli.pd.rgy.ldap.LdapRgyServerInfo.configure(LdapRgyServerInfo.java:406)
        at com.tivoli.pd.rgy.ldap.LdapRgyFedServerMgr$FedServer.configure(LdapRgyFedServerMgr.java:360)
        at com.tivoli.pd.rgy.ldap.LdapRgyFedServerMgr.configure(LdapRgyFedServerMgr.java:587)
        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.configure(LdapRgyHandleMgr.java:338)
        at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.configure(LdapRgyRegistry.java:228)
        at com.tivoli.pd.rgy.ldap.LdapRgyRegistryFactory.getLdapRgyRegistryInstance(LdapRgyRegistryFactory.java:54)

        at com.tivoli.pd.rgy.ldap.LdapRgyRegistryFactory.getLdapRgyRegistryInstance(LdapRgyRegistryFactory.java:74)

        at com.tivoli.pd.rgy.ldap.LdapRgyRegistryFactory.getRgyRegistryInstance(LdapRgyRegistryFactory.java:96)

        at rgyDirect_authenticate.main(rgyDirect_authenticate.java:56)

Caused by: com.tivoli.pd.rgy.exception.UnhandledRgyException: HPDAA0370E   An unexpected error occurred while using the configured key store: /root/src/amjrte/RgyDirect/ISVA1050.ks. This key store is required for mutual SSL authentication to the user registry.

        at com.tivoli.pd.rgy.ldap.LdapRgySslSocketFactory$SocketFactoryHandle.getSSLContext(LdapRgySslSocketFactory.java:761)

        at com.tivoli.pd.rgy.ldap.LdapRgySslSocketFactory$SocketFactoryHandle.getInstance(LdapRgySslSocketFactory.java:659)

        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.getSslSocketFactoryName(LdapRgyHandleMgr.java:2750)

        at com.tivoli.pd.rgy.ldap.LdapRgyServer.getLdapContext(LdapRgyServer.java:350)

        at com.tivoli.pd.rgy.ldap.LdapRgyServer.getLdapContext(LdapRgyServer.java:232)

        at com.tivoli.pd.rgy.ldap.LdapRgyServer.getLdapContext(LdapRgyServer.java:173)

        at com.tivoli.pd.rgy.ldap.LdapRgyServer.getHandle(LdapRgyServer.java:998)

        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.setupHandle(LdapRgyHandleMgr.java:742)

        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.access$500(LdapRgyHandleMgr.java:69)

        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr$JndiOperation.retryJndiOperation(LdapRgyHandleMgr.java:2438)

        at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.searchAndFetch(LdapRgyHandleMgr.java:1644)

        at com.tivoli.pd.rgy.ldap.LdapRgyServerInfo.determineLdapServerType(LdapRgyServerInfo.java:1033)

        at com.tivoli.pd.rgy.ldap.LdapRgyServerInfo.configure(LdapRgyServerInfo.java:387)

        ... 8 more

Caused by: java.security.NoSuchAlgorithmException: SunX509 TrustManagerFactory not available <===============================================

        at sun.security.jca.GetInstance.getInstance(GetInstance.java:171)

        at javax.net.ssl.TrustManagerFactory.getInstance(TrustManagerFactory.java:11)

        at com.tivoli.pd.rgy.ldap.LdapRgySslSocketFactory$SocketFactoryHandle.getSSLContext(LdapRgySslSocketFactory.java:755)

        ... 20 more

FAILED: Unable to obtain instance of LdapRegistry



I tried to test with OpenJDK but get the following:

./pdjrtecfg -action config -host [isva1050.kvm.org|http://isva1050.kvm.org] -port 7135 -java_home /home/nlloyd/openjdk/jdk-11.0.17+8-jre -config_type full
-Djava.ext.dirs=/tmp/pdjrtecfg.3667441 is not supported.  Use -classpath instead.
Error: Could not create the Java Virtual Machine.
Error: A fatal exception has occurred. Program will exit.
nlloyd@isva-l2-docker1 [14947]java -version
openjdk version ""11.0.17"" 2022-10-18
OpenJDK Runtime Environment Temurin-11.0.17+8 (build 11.0.17+8)
OpenJDK 64-Bit Server VM Temurin-11.0.17+8 (build 11.0.17+8, mixed mode)",,Akshatha,Brandon Garay,BRIANORO,Daniel Comeau,David Flynn,Dermot Daly,khansen,lgleeson,Nick Lloyd,Surya Prakash,tonyferg,Tushar Prasad,,,,61548f169cdb9300722d0c1f,60e721f12d49fd00698bb49d,6154906364ff01007106e189,5b15d9a0dda5f94d06b985b3,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b17572378cd734fe39f2e1a,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,ISAMSUP-4461,ISAMDEV-9702,,,,,,,,,,,,,,,,,,,,, IJ46734,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS011624987, TS011918547, TS012719660",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Aaron.Richie.Dias,6194c472fe9f300068e5252f,,,,CLYDESDALE BANK PLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17gbz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-09 14:52:04.011,,,,,08/Jan/23 1:26 AM;5b15d9e6dda5f94d06b985b4;There are no customer SDI traces but is rather clear we have an in-house recerate.,"10/Jan/23 12:52 AM;5b15d94b6256d01ad54eb020;Nick,  I’ll do some testing on this too.","10/Jan/23 2:41 AM;5b15d94b6256d01ad54eb020;“-Djava.ext.dirs=/tmp/pdjrtecfg.3667441 is not supported”

java.ext.dirs   is no longer supported as of  OpenJDK  9 

I reported this in [https://cloudidentity.atlassian.net/browse/ISAMDEV-8634|https://cloudidentity.atlassian.net/browse/ISAMDEV-8634|smart-link].  

The pdjrtecfg  script we ship with 10.0.5.0    still uses it.  So java 8 should still work but anything later won’t without modification.",10/Jan/23 2:54 AM;5b15d94b6256d01ad54eb020;I don’t know what version of OpenJDK was used for testing  but  I did find a comment  indicating that  IBM java  8.0.6.2 was used. I don’t know about any newer versions.,"10/Jan/23 4:32 AM;5b15d9e6dda5f94d06b985b4;I just tested with:


java version ""1.8.0_241""
Java(TM) SE Runtime Environment (build 8.0.6.7 - pxa6480sr6fp7-20200312_01(SR6 FP7))

and get the same failure.

","10/Jan/23 5:54 AM;5b15d94b6256d01ad54eb020;I dug around in the code  and  found  that  SunX509   was added  in 10.0.3.0  for OpenJdk which explains why it causes issues with IBM Java.

It doesn’t look like they check for which  version is being used before using version specific classes.   ","10/Jan/23 6:44 AM;5b15d94b6256d01ad54eb020;*Internal comment:*

For  pdjrtecfg  

in 10.0.2.0  we created a key manager like this

KeyManagerFactory.getInstance(""IbmX509"", ""IBMJSSE2"");

In 10.0.5  we did this

KeyManagerFactory.getInstance(""SunX509"");

Since we are going with this dual  jvm support.  we are going to have check the JVM version or use a new flag and then use the appropriate one.   

The java.vendor property  looks like the most reliable way to check. If says  IBM Corporation then it’s not  OpenJDK.



Then in  pdjrtecfg  we need to eliminate the use  of java.ext.dirs since that is no longer supported in newer jvms.

--

I haven’t looked into the RGY issue yet.",24/Jan/23 11:36 AM;5b17572378cd734fe39f2e1a;[~accountid:5b15d94b6256d01ad54eb020] I have delivered a fix which should permit PD.jar to faill back to the “IBMX509” provider if it cannot find the “SunX509” provider. Are you in a position where you can test the dev branch to validate that this works as expected?,25/Jan/23 12:24 AM;5b15d94b6256d01ad54eb020;[~accountid:5b17572378cd734fe39f2e1a] Yes I can test that.,"28/Jan/23 7:48 AM;5b15d94b6256d01ad54eb020;We can let customers know that we are working on the problem and making progress.

*Internal Comment:*

Quick update.   I’ve been testing the  updated  com.tivoli.pd.rgy.jar and so far I had good results.   I ran into an issue with TLS while testing which I couldn’t resolve until I set      -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true

I think was probably due or at least partially due to using personal certificates.

I started with  com.tivoli.pd.rgy.jar  because that was the main complaint in the Jira description.  I’ll run some tests using PD.jar next which hopefully won’t take long.  However,  pdjrtecfg still uses  java.ext.dirs  which is not supported in versions of java 9 or later.  I can get around that to run other tests.","31/Jan/23 3:42 AM;5b15d94b6256d01ad54eb020;*Internal comment:*

Ran additional tests this morning with the  10.0.6 version PD.jar  and it still has issues.   I could not  run pdjrtecfg  so I used the 10.0.2  version of the  PD.jar to configure the jdk.   Running a simple java app it still fails with 

java.lang.IllegalStateException: java.security.NoSuchAlgorithmException: SunX509 KeyManagerFactory not available",16/Feb/23 6:48 AM;5b17572378cd734fe39f2e1a;[~accountid:5b15d94b6256d01ad54eb020] without any context that error is not fixable. which code is throwing the exception?,16/Feb/23 6:53 AM;5b15d94b6256d01ad54eb020;[~accountid:5b17572378cd734fe39f2e1a] that was with the first version of 10.0.6.0 that you built.  I haven’t had a chance to retest with the second one yet. I’ll retest and get you a stack if the problem is still there.,22/Feb/23 11:20 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020] I have just spoken to Lachlan about this testing and it would be appreciated if you can have this testing completed before the end of this week. Let me know if you need any support.  ,"23/Feb/23 1:54 AM;5b15d94b6256d01ad54eb020;*Internal  L3/dev comments Only*



[~accountid:5b17572378cd734fe39f2e1a] [~accountid:5ac57757d9a96536d1f0daa9] 



Using OpenJdk

Bypassing  the  pdjrtecfg  script  because  it still uses   java.ext.dirs

/data/java/OpenJDK_11/jdk-11.0.17+8/bin/java -Dpd.home=/data/home/btyler/TAM_WORK/java_test -Dpd.program.files=/etc -cp /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test2_jars/PD.jar: com.tivoli.pd.jcfg.PDJrteCfg -action config -host 192.168.124.92 -port 7135 -java_home /data/java/OpenJDK_11/jdk-11.0.17+8 -config_type full
<JAVA_HOME>/lib/ext exists, extensions mechanism no longer supported; Use -classpath instead.
.Error: Could not create the Java Virtual Machine.
Error: A fatal exception has occurred. Program will exit.



Using  the -was and -alt_config should get around that error but it doesn’t

 /data/java/OpenJDK_11/jdk-11.0.17+8/bin/java -Dfile.encoding=ISO8859-1 -Dpd.home=/data//home/btyler/TAM_WORK/java_test/test_1060_pre_release/test/tivoli/tam/PolicyDirector -Dwas.install.root=/data//home/btyler/TAM_WORK/java_test/test_1060_pre_release/test/websphere -cp /data/java/OpenJDK_11/jdk-11.0.17+8/jre/lib:/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test2_jars/PD.jar com.tivoli.pd.jcfg.PDJrteCfg -action config -was -host 192.168.124.92 -java_home /data/java/OpenJDK_11/jdk-11.0.17+8/jre -alt_config -cfgfiles_path /data//home/btyler/TAM_WORK/java_test/test_1060_pre_release/test/tivoli/tam -config_type full
<JAVA_HOME>/lib/ext exists, extensions mechanism no longer supported; Use -classpath instead.
.Error: Could not create the Java Virtual Machine.
Error: A fatal exception has occurred. Program will exit.



Using    IBM  Java  8.0-6.35


My first test  with this version of Java  got an error looking for SunJce.  But I think that was due to how I tested. I found an issue with my java/export  directory that was still copying the 10.0.5 version.  After I fixed that I get the result below which is better.

./pdrtetest.sh

* export JAVA_HOME=/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80
* JAVA_HOME=/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80
* export PATH=/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80/bin:/sbin:/bin:/usr/sbin:/usr/bin
* PATH=/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80/bin:/sbin:/bin:/usr/sbin:/usr/bin
* PDJAR=/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test2_jars/PD.jar
* PHOST=192.168.124.92
* AHOST=192.168.124.92
* JAVA_BIN=/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80/bin
* CMD=/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/pdjrtecfg
* echo 'Run: /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/pdjrtecfg'
Run: /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/pdjrtecfg
++ /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/pdjrtecfg -action config -host 192.168.124.92 -port 7135 -java_home /data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80 -config_type full
* set -e
++ dirname /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/pdjrtecfg
* exe_dir=/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release
++ cd /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release
++ pwd
* normalised_exe_dir=/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release
++ dirname /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release
* pd_home=/data/home/btyler/TAM_WORK/java_test
* tmpdir=
* java_ext_dir_flag=
* trap clean_java_ext_dir EXIT
* PDJAR=/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test2_jars/PD.jar
* java -Dpd.home=/data/home/btyler/TAM_WORK/java_test -Dpd.program.files=/etc -cp /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test2_jars/PD.jar: com.tivoli.pd.jcfg.PDJrteCfg -action config -host 192.168.124.92 -port 7135 -java_home /data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80 -config_type full
* exit 0
* clean_java_ext_dir
* '[' '!' -z '' -a -d '' ']'
* Configuration of Security Access Manager Runtime for Java is in progress. This might take several minutes. The /data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80/PolicyDirector directory does not exist. Creating the directory. Configuration of Security Access Manager Runtime for Java completed successfully.
./pdrtetest.sh: line 22: Configuration: command not found

----

h1. [pdrtetest.sh|http://pdrtetest.sh]

#!/bin/sh

#export JAVA_HOME=/data/java/ibm-java-x86_64-80
export JAVA_HOME=/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80
#export JAVA_HOME=/data/java/jdk-11.0.15+10/
#export JAVA_HOME=/data/java/OpenJDK_11/jdk-11.0.17+8
export PATH=$JAVA_HOME/bin:$PATH
#PDJAR=$HOME/java_test/pdjrte_10.0.2.0/pdjrte/java/export/pdjrte/PD.jar
#PDJAR=/data/home/btyler/TAM_WORK/java_test/10.0.5.0_test_jars/PD.jar
#PDJAR=/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test1_jars/PD.jar
PDJAR=/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test2_jars/PD.jar
PHOST=192.168.124.92
AHOST=192.168.124.92
JAVA_BIN=$JAVA_HOME/bin
#CMD=""$HOME/java_test/pdjrte_10.0.2.0/pdjrte/sbin/pdjrtecfg""
#CMD=""/data/home/btyler/TAM_WORK/java_test/10.0.5.0_test_jars/pdjrtecfg""
CMD=""/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/pdjrtecfg""
echo ""Run: $CMD""
#{{$CMD -action config -host $PHOST -port 7135 -java_home $JAVA_HOME/jre -config_type full}}
{{$CMD -action config -host $PHOST -port 7135 -java_home $JAVA_HOME -config_type full}}



pdjrtecfg  was modified to point to my test location","23/Feb/23 5:27 AM;5b15d94b6256d01ad54eb020;*Internal  L3/dev comments Only*

Another test I ran using   IBM  Java  8.0-6.35  was to configure  an application.

./pdtest.sh

* export JAVA_HOME=/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80
* JAVA_HOME=/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80
* PDJAR=/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test2_jars/PD.jar
* CFG=/data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test/cfg
* PHOST=192.168.124.92
* AHOST=192.168.124.92
* /data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80/bin/java -cp /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test2_jars/PD.jar com.tivoli.pd.jcfg.SvrSslCfg -action config -admin_id sec_master -admin_pwd passw0rd -appsvr_id SampleApp -appsvr_pwd passw0rd -host 192.168.124.92 -mode remote -port 7140 -policysvr 192.168.124.92:7135:1 -authzsvr 192.168.124.92:7136:1 -cfg_file /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test/cfg/pdtest.cfg -key_file /data/home/btyler/TAM_WORK/java_test/test_1060_pre_release/test/cfg/pdtest.ks -cfg_action create

The configuration completed successfully.

--

That  did work but I noticed an issue where the runtime was configured  in:

/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80/PolicyDirector

but  com.tivoli.pd.jcfg.SvrSslCfg  was looking for the properties file in:

/data/java/ibm-java-sdk-8.0-6.35/ibm-java-x86_64-80/jre/PolicyDirector

After I created a soft link  the jre directory back to the original location it worked as shown above.

I did not test com.tivoli.pd.jcfg.SvrSslCfg  with OpenJDK since we need to fix the issue with extensions first.","23/Feb/23 6:33 AM;5b17572378cd734fe39f2e1a;[~accountid:5b15d94b6256d01ad54eb020] have you actioned the error message? ie have you removed the

{noformat}<JAVA_HOME>/lib/ext{noformat}

directory and added every jar that was in there to the classpath? This a change in the way that the JVM functions so cannot be changed by code that Verify Access releases.","23/Feb/23 6:54 AM;5b15d94b6256d01ad54eb020;[~accountid:5b17572378cd734fe39f2e1a] 

Oracle dropped extension support as of Java 9 I think.

I have an empty  ext directory under   <JAVA_HOME>/lib  but it was added by our config at some point.   

I ran another test just now after removing that directory and  com.tivoli.pd.jcfg.PDJrteCfg   added it back. Which is what I thought would happen.   We probably  need to  remove  or revise  checkJavahome()  in  ./jcfg/PDJrteCfg.java   ( see line 705 )

WAS had a requirement for us to add an alternate location for  the PD.jar outside of the jre  directory. They defaulted to  <WAS_HOME>/tivoli/tam .  I worked on  part of that.    I think we should be taking advantage of those options in our config script.  ","23/Feb/23 7:19 AM;5b15d94b6256d01ad54eb020;[~accountid:5b17572378cd734fe39f2e1a] 

BTW   Using OpenJdk,

when the  <JAVA_HOME>/lib/ext is removed and rerunning    com.tivoli.pd.jcfg.PDJrteCfg   I get this exception:

java.lang.reflect.InvocationTargetException
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at com.tivoli.pd.jcfg.PDJrteCfg.config(PDJrteCfg.java:1300)
	at com.tivoli.pd.jcfg.PDJrteCfg.invoke(PDJrteCfg.java:584)
	at com.tivoli.pd.jcfg.PDJrteCfg.main(PDJrteCfg.java:229)
Caused by: java.lang.NoClassDefFoundError: com/ibm/misc/HexDumpEncoder
	at com.tivoli.pd.jutil.NonSslNamesCmd.sendCommand(NonSslNamesCmd.java:149)
	at com.tivoli.pd.jutil.PDCfgHelper.getMgmtDomainName(PDCfgHelper.java:388)
	... 7 more
Caused by: java.lang.ClassNotFoundException: com.ibm.misc.HexDumpEncoder
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:581)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:522)
	... 9 more",04/Mar/23 9:01 AM;5b15d94b6256d01ad54eb020;FYI: This is still being worked on.  I tested the latest iteration yesterday from dev so we are making progress.,15/Mar/23 9:25 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b17572378cd734fe39f2e1a] - do you have a related DEV WI for this that we can link to? ,24/Mar/23 9:58 PM;6194c472fe9f300068e5252f;[~accountid:5b15d94b6256d01ad54eb020] customer checking if we can provide any ETA on the fix? ,25/Mar/23 5:06 AM;5b15d94b6256d01ad54eb020;I’m hoping it will be fixed in 10.0.6 but no  guarantees on that because it’s a complicated process.  So we’re still on it.,"29/Mar/23 7:01 AM;5b15d94b6256d01ad54eb020;FYI  - quick status on this problem.

I’ve been getting a new version of the PD.jar about once a week and I’ve been testing it and reporting  back as soon as I can.  Progress is being made but as of last week there were still some issues with the jar file.  

[~accountid:5b15d9e6dda5f94d06b985b4]  Once I get a jar file that passes my tests , I can share it with L2 for additional testing if you’re interested. Hopefully that will be soon.",18/Apr/23 11:34 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d94b6256d01ad54eb020]  - any update on this one? ,18/Apr/23 11:36 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Just added my ticket also.,"18/Apr/23 11:49 PM;5b15d94b6256d01ad54eb020;[~accountid:5b232b2fd85e5b59b066f57f] Not really.  The latest jar file I tested was better, It seemed to work with IBM Java 1.8 but still had issues with OpenJDK.",19/Apr/23 9:28 AM;5b15d94b6256d01ad54eb020;Got a new jar file to test tonight  and was able to test the config with Openjdk which worked.  I haven’t done any of the other API tests yest but this is looking a lot better.,08/May/23 10:19 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] [~accountid:5b15d9e6dda5f94d06b985b4] Do we wait for 10.0.6 and create an apar so I can close my PMR?  ,09/May/23 9:35 PM;5b232b2fd85e5b59b066f57f;@btyler - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,10/May/23 4:01 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] yes this will hopefully be fixed in 10.0.6.0.  We probably should have a new APAR for documenting the fix.,10/May/23 6:29 PM;614dd566a995ad0073ec0622;IJ46734 created.,"11/May/23 5:57 PM;60f541a6d0134900692d91b7;[~accountid:5b15d94b6256d01ad54eb020] Is there any possibility for the fix in v10.0.5, the customer needs this APAR as a fix at the v10.0.5.0 ",11/May/23 10:35 PM;5b15d94b6256d01ad54eb020;They shouldn’t need the fix in 10.0.5.0  they should be able to use the 10.0.6.0  version with 10.0.5.0. ,12/May/23 7:38 PM;614dd566a995ad0073ec0622;You mean use the 10.0.6 pd jar file to configure a open jdk XX (11?) backend to talk to a 10.0.5 appliance?,"12/May/23 11:57 PM;5b15d94b6256d01ad54eb020;Yes,  in general the PD.jar file can be used with a different version Policy Server.  That’s why we are recommending using the 10.0.2.0 version until we work out the issues with  opnejdk.  However, the 10.0.2.0 version requires the IBM jdk.    We will not be back porting the  changes to 10.0.5.0. There is no reason to do that.","13/May/23 4:49 AM;5b15d9a0dda5f94d06b985b3;Hi Bill, the biggest concern is that is that till now we always told customers that the policy server must be at the same or later version than the PD.jar.     If we are telling customer that using 10.0.6 PD.jar with 10.0.5 is supported, we should make it clear that this would only apply to this version unless we want to open the door to supporting newer PD.jar with older pdmgr in general.     Just my 2 cents","13/May/23 6:31 AM;5b15d94b6256d01ad54eb020;Hi Daniel,  I understand your concern.  In general that is still true but it kind of went out the window with 10.0.3.x when the problem started due to the switch to openjdk.  Right now they have to use 10.0.2.0. But, I think you can still argue that is still followed  because we aren’t saying to use a 9.0.7.x jar  we are saying to use a 10.0.x.x  jar.  The main reason for that was when a policy server change was made the commands used could change and cause incompatibilities.  I think it has been a while since that happened.","15/May/23 9:51 PM;5b15d9a0dda5f94d06b985b3;Ok that’s find.   My comment was more meant to say that we may get many customers in this same boat.    In other words they may want the 10.0.6 PD.jar but not want to upgrade their env to use it.   In the past, we always said the policy server needs to be at the same or higher level than the PD.jar (older PD.jar was ok like the 10.0.2 we tell people to use).    If we are confident enough in changing that support statement, saying that as long as the policy server is on the same version (ie both are 10) that we will support them then that’s fine then that is fine, we can use this guidance from now on.    Or Is this strictly statement only for a 10.0.5 pdmgr?      I just want to be sure what L3 is comfortable supporting before we tell customers.     Thx!","25/May/23 7:53 PM;60f541a6d0134900692d91b7;Hi[~accountid:5b15d94b6256d01ad54eb020] [~accountid:5b15d9a0dda5f94d06b985b3] So can we tell the customer that they can apply the 10.0.6 pd.jar in their v10.0.5 appliance?
Do we need to test it??",26/May/23 12:01 AM;5b15d94b6256d01ad54eb020;[~accountid:60f541a6d0134900692d91b7] yes they will be able to use the 10.0.6.0 version of the PD.jar with 10.0.5.0  appliances.,"31/May/23 5:01 AM;5b15d94b6256d01ad54eb020;The testing I have done recently looks a lot better than previous versions. The same jar  is intended to work with  both IBM java and openjdk.  

[~accountid:5b15d9e6dda5f94d06b985b4]  (or anyone in L2 )    if you would like a pre-release version of PD.jar  for 10.0.6.0  (Internal use only) and have time to run a few tests I can provide it.  I ran  a few basic tests that included  using  configuring the runtime and an application. Then ran an app to create a few users.  ",31/May/23 6:02 AM;5b15d9e6dda5f94d06b985b4;[~accountid:5b15d94b6256d01ad54eb020] I can run some test.,31/May/23 6:25 AM;5b15d94b6256d01ad54eb020;Thanks Nick.,07/Jun/23 8:39 AM;5b15d94b6256d01ad54eb020;I believe the latest PD.jar that I tested is working so I’m going to go ahead close it. If we find any more issues we  can reopen if necessary.,"07/Jun/23 5:52 PM;60f541a6d0134900692d91b7;[~accountid:5b15d94b6256d01ad54eb020] Can we get the PD.jar that is supplied in the PDJRTE package of the 10.0.6 release separately to download, as the customer doesn't want to upgrade to ISVA 10.0.6 firmware",07/Jun/23 7:25 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Which pd.jar is working? 10.0.6? Any approximate timeline when its available?,"07/Jun/23 11:52 PM;5b15d94b6256d01ad54eb020;[~accountid:60f541a6d0134900692d91b7] customers will have to get  10.0.6.0  to get the new jar. We don’t usually distribute it separately.  They could install it in a test environment.   [~accountid:5ac57757d9a96536d1f0daa9]   Are we going to make   pdjrte-10.0.6.0.zip  available to  10.0.5.0  customers?

[~accountid:614dd566a995ad0073ec0622]   Yes the version in  pdjrte-10.0.6.0.zip  is greatly improved.   I don’t have an exact release date for 10.0.6.0 but I believe they are trying to get  it out soon.  By soon I mean a matter of a few weeks.",16/Jun/23 11:03 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Can you attach the 10.0.6 pdjar file separately to this Jira for download since 10.0.6 is now released?,19/Jun/23 6:01 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020]  IJ46734 shows no resolution nor is it listed in 1006 release notes?,"20/Jun/23 12:13 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] I’ll see if  I can get the readme updated to include that APAR.  

The functionality is discussed here though:

[https://www.ibm.com/docs/en/sva/10.0.6?topic=developing-setting-up-verify-access-runtime-java-system|https://www.ibm.com/docs/en/sva/10.0.6?topic=developing-setting-up-verify-access-runtime-java-system|smart-link] 



It will be available as a download from the appliance. I don’t know if we’ll make it a separate download or not. ","20/Jun/23 12:53 AM;5b15d9a0dda5f94d06b985b3;Hi [~accountid:5b15d94b6256d01ad54eb020] 

Just to get it on record, what do we tell customers that as for this fix but don’t want to upgrade to 10.0.6 yet.   

Can this fix be backported or not?
Is L3 willing to support using 10.0.6 PD.jar when the customer is running on older version of ISVA?   If so, what is the oldest version/fix that L3 will support using the 10.0.6 PD.jar with?

Or are neither of these options, and the customer MUST upgrade to 10.0.6 to get this fix?   

I just wanted to get an official answer on this so that we know what to tell customers when they inevitably ask.  



Thanks!","20/Jun/23 1:05 AM;5b15d94b6256d01ad54eb020;Hi [~accountid:5b15d9a0dda5f94d06b985b3],  yes,  they can use 10.0.0.6 with an older version.  I think it should be fine with any 10.0.0.x version.  I would recommend using it with 10.0.3.0 and later since the 10.0.2.0 jar works.

No it cannot be backported. It doesn’t really make sense to do that.   You don’t need to upgrade to get it. You will have install  a 10.0.6.0 appliance somewhere ( like a test env.)  so you can download the zip.  I’ll ask again if there are plans to make it available separately on fix central.  I think we should but I don’t have an answer to that yet.",20/Jun/23 2:20 AM;5b15d9a0dda5f94d06b985b3;Thanks Bill!,"29/Jun/23 2:14 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Customer attempted to run 10.0.6  on open jdk 11 machine. It completes but still not compatible. It still attempts to copy the jar files to lib/ext and this extension mechanism simply does not exist in jdk11. Result is pd.jar is not copied anywhere. ([+msg_PDJrteCfg1.log+|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012719660&path=TS012719660/2023-06-28/&filepath=TS012719660/2023-06-28/msg_PDJrteCfg1.log]) attached in PMR.

{noformat}2023.06.28 08:43:41.529 ----- PROGRAM NOTICE bcf pdjrte tracing PDJrteCfg config() main Copying files from /opt/ibm/home/showarth/pdjrte/java/export/pdjrte to /etc/alternatives/jre/lib/ext.

{noformat}

Customer is wondering are there updated instructions on using or configuring above with open jdk 11?



The y tried both 

{noformat}2023.06.28 08:43:41.529 ----- PROGRAM NOTICE bcf pdjrte tracing PDJrteCfg config() main Copying files from /opt/ibm/home/showarth/pdjrte/java/export/pdjrte to /etc/alternatives/jre/lib/ext.{noformat}

and

{noformat}pdjrtecfg -action config -interactive{noformat}

The result is the same as ext/lib is not present and shouldn't be on Java 11","29/Jun/23 2:21 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622]   We might need updated instructions on that.    I went through a lot of iterations with development to test it and get it to work.   Let me check on what I did.  A lot of this was down to the wire.

I also got that message.   That’s true that  the ext support was removed in java 9.    That’s also true that it won’t copy the PD.jar into the jre lib directory.  Because support was removed in java 9,  to use the PD.jar you will have to specify the location using  java classpath.   

In my tests I used the directory where I unziped the  pdjrte files.",29/Jun/23 8:16 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622]  I’m moving this back to L2 while you try what I suggested.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Memory usage problem with IBM Security Verify Access 10.0.3.1,ISAMSUP-4690,274892,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,06/Jan/23 10:19 PM,27/Mar/23 10:21 AM,14/Jul/23 2:47 PM,27/Mar/23 10:21 AM,,Support,,0,Growth,,,"running multiple instances of IBM Security Verify Access 10.0.3.1 for various clients. We had a problem yesterday where the PRD IBM Security Verify Access virtual appliances for one of our clients was unresponsive, and we found that the memory usage was at about 90%. We restarted the virtual appliances for that client and they are responsive, for now. As a result I was looking at one of our other IBM Security Verify Access virtual appliances for the same client, and I noticed that in two of the test virtual appliances, the memory usage has clearly been creeping up, gradually, over the last 30 days. This looks to me like a memory leak. Are you aware of any memory usage problem with IBM Security Verify Access 10.0.3.1? Do you have any tools that would help to analyse this? What may be relevant is that our client appears to run a penetration test every morning, which causes a spike in the traffic. If there is a memory leak this might be caused by the spike in the traffic, or (more likely) one of the elements of the penetration test is causing the reverse proxy to execute an unusual path in the reverse proxy software. Looking at the Extranet_DE_Broker request logs, there appears to be a penetration test run every morning. (We have asked our client whether they are aware of this.) There is lots of activity starting at 14/Dec/2022:06:07:37 which looks to me like a penetration test - such as: Line 5607 in request.log.2022-12-14-08-50-59: 18.168.224.137 - unauthenticated 14/Dec/2022:06:10:20 +0100 ""GET /cgi-bin/modules.php?mod=fm&file=../../../../../../../../../../etc/passwd%00&bn=fm_d1 HTTP/1.1"" 400 1389 ""- -"" Unusual activity in request.log.2022-12-14-08-50-59 at lines 3885 at 14/Dec/2022:06:07:13- to line 11911 at 14/Dec/2022:06:16:58. Unusual activity in request.log.2022-12-13-07-55-36 at lines 7383 at 13/Dec/2022:06:06:39 to line 15527 at 13/Dec/2022:06:32:41 18.168.224.137 - unauthenticated 13/Dec/2022:06:11:16 +0100 ""GET /cgi-bin/modules.php?mod=fm&file=../../../../../../../../../../etc/passwd%00&bn=fm_d1 HTTP/1.1"" 400 1389 ""- -"" I will attach screenshots showing the memory utilisation of various virtual appliances over the last month, and also the regular traffic spikes. I will also attempt to create and attach a support file.

Ask the customer {{Please reboot the Appliance to get the Memory usage back to a baseline, and then install this fix. This will set a Cronjob that runs 'top' every 20 minutes. You can uninstall the hotfix immediately and it will not stop the Cronjob running. To stop the Cronjob, reboot the Appliance again, which you will probably want to do to clear effects of the memory leak. The files it generates are accessible via the LMI: Monitor -> Application Log Files -> management_ui -> resource_monitor_logs }}

[https://www.secure.ecurep.ibm.com/download/?id=_2QqUz3g2UoUZ4akHYT41g8tsz6QyWecfKB4nPrx7Uo|https://www.secure.ecurep.ibm.com/download/?id=_2QqUz3g2UoUZ4akHYT41g8tsz6QyWecfKB4nPrx7Uo]

Resource monitor logs are uploaded.

[TS011543720 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011543720&path=TS011543720%2F2023-01-05%2F]

Need L3 advise",,Aaron.Richie.Dias,BRIANORO,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,William Hannon Jr,,,,,,,,6194c472fe9f300068e5252f,6154906364ff01007106e189,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011543720,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,PIREAN LTD,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17g3r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-01-17 16:47:48.478,,,,,"17/Jan/23 10:22 PM;617a5f2cf485cd0068cb98af;[~accountid:5b17571b91981f4fdde632c1] 

A couple of minor updates from customer:

# We paused for three days the Tenable penetration testing scans to one of the ISAM virtual appliances, but the memory usage still increased progressively day-by-day.

# This memory usage problem is particular to the ISAMs we have for one of our clients (Canada Life Europe), which all have a similar configuration. We do not have this problem with our other clients, which have a different ISAM configuration.","18/Jan/23 2:47 AM;5b17571b91981f4fdde632c1;* Dumping the SalesForce Detail word-for-word {color:#bf2600}*is not L2 analysis*{color}
** The cut-paste lost all format making it harder to read
*** Do you notice that?
* Now show me L2 analysis for this problem","18/Jan/23 6:17 PM;617a5f2cf485cd0068cb98af;[~accountid:5b17571b91981f4fdde632c1] The problem is what is it is in SF we cannot create a new word by word for you. 

Please reboot the Appliance to get the Memory usage back to a baseline, and then install this fix resource_monitor_by_20min_005.fixpack. This will set a Cronjob that runs 'top' every 20 minutes. You can uninstall the hotfix immediately and it will not stop the Cronjob running. To stop the Cronjob, reboot the Appliance again, which you will probably want to do to clear effects of the memory leak. The files it generates are accessible via the LMI: Monitor -> Application Log Files -> management_ui -> resource_monitor_logs

The resource monitor logs are uploaded at below 

[TS011543720 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011543720&path=TS011543720%2F2023-01-05%2F&filepath=TS011543720%2F2023-01-05%2FresourceMonitoring_5-JAN-2023.zip]

The file name is +resourceMonitoring_5-JAN-2023.zip+

Now the above is very clear. We need L3 to analyze the resource monitor logs and advise. ","19/Jan/23 10:02 AM;5b17571b91981f4fdde632c1;* Please show me your VSZ and %VSZ analysis from
** 2022-12-14/isva_10.0.3.1_20221214-130858_cle-prd-01-isam-mgt.cle.fra02.eu.onpirean.net.support
** 2023-01-05/isva_10.0.3.1_20230104-103215_cle-tst-01-isam-mgt.cle.fra02.eu.onpirean.net.support
* This is within the scope of L2","07/Feb/23 9:34 PM;617a5f2cf485cd0068cb98af;Mem: 2100324K used, 1923224K free, 4360K shrd, 108412K buff, 830424K cached
CPU:  0.0% usr  0.0% sys  0.0% nic  100% idle  0.0% io  0.0% irq  0.0% sirq
Load average: 0.26 0.07 0.02 1/1025 31288
  PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND
 1184     1 www-data S    2867m 72.8   1  0.0 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy
 1351  1340 ivmgr    S    1532m 38.9   1  0.0 /opt/pdweb/bin/webseald -config etc/webseald-Extranet_DE_Broker.conf -foreground -noenv
 1378  1368 ivmgr    S    1522m 38.6   0  0.0 /opt/pdweb/bin/webseald -config etc/webseald-VP_Broker.conf -foreground -noenv
 2230  2214 www-data S    1209m 30.7   0  0.0 oneagentos -Dcom.compuware.apm.WatchDogPort=50001 -Dcom.compuware.apm.WatchDogTimeout=900 -watchdog.restart_file_location=/var/lib/dynatrace/oneagent/agent/runtime/watchdog_restart_file
 1299  1295 ivmgr    S    1091m 27.7   0  0.0 /opt/PolicyDirector/bin/pdmgrd -foreground
 1959  1956 root     S     766m 19.4   0  0.0 wga_notifications -foreground
  721   719 root     S     628m 15.9   1  0.0 /usr/sbin/mesa_eventsd -m 1000
 1003   985 root     S     580m 14.7   0  0.0 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf
 2234  2214 www-data S     575m 14.6   0  0.0 oneagentloganalytics -Dcom.compuware.apm.WatchDogPort=50003 -Dcom.compuware.apm.WatchDogTimeout=900
 2232  2214 www-data S     491m 12.4   0  0.0 oneagentnetwork -Dcom.compuware.apm.WatchDogPort=50002 -Dcom.compuware.apm.WatchDogTimeout=900
 2214     1 www-data S     452m 11.4   0  0.0 /opt/dynatrace/oneagent/agent/lib64/oneagentwatchdog -bg -config=/opt/dynatrace/oneagent/agent/conf/watchdog.conf
 2223  2214 www-data S     435m 11.0   0  0.0 oneagentplugin -Dcom.compuware.apm.WatchDogPort=50000 -Dcom.compuware.apm.WatchDogTimeout=900
 1950  1948 ivmgr    S     420m 10.6   0  0.0 /usr/sbin/wga_servertaskd

and

Mem: 3885052K used, 138496K free, 4324K shrd, 87464K buff, 2018864K cached
CPU: 50.0% usr  0.0% sys  0.0% nic 50.0% idle  0.0% io  0.0% irq  0.0% sirq
Load average: 1.56 1.25 0.86 2/3353 11483
  PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND
  825 29241 root     R    16928  0.4   1 50.0 /usr/bin/zip -r /var/support/isva_10.0.3.1_20230104-101916_cle-tst-01-isam-mgt.cle.fra02.eu.onpirean.net.support Comment core_file_stack_trace etc isam_policy_db iswga opt support.txt tmp usr var
 1169     1 www-data S    2877m 73.0   0  0.0 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy
 1579  1568 ivmgr    S    1504m 38.2   0  0.0 /opt/pdweb/bin/webseald -config etc/webseald-Extranet_DE_Broker.conf -foreground -noenv
 1534  1525 ivmgr    S    1503m 38.1   0  0.0 /opt/pdweb/bin/webseald -config etc/webseald-Extranet_FIT3.conf -foreground -noenv
 1631  1616 ivmgr    S    1503m 38.1   1  0.0 /opt/pdweb/bin/webseald -config etc/webseald-Extranet_FIT1.conf -foreground -noenv
 1495  1482 ivmgr    S    1503m 38.1   0  0.0 /opt/pdweb/bin/webseald -config etc/webseald-Extranet_FIT4.conf -foreground -noenv
 1609  1593 ivmgr    S    1503m 38.1   1  0.0 /opt/pdweb/bin/webseald -config etc/webseald-Extranet_FIT2.conf -foreground -noenv
 1449  1438 ivmgr    S    1493m 37.9   1  0.0 /opt/pdweb/bin/webseald -config etc/webseald-VP4.conf -foreground -noenv
 1511  1499 ivmgr    S    1493m 37.9   1  0.0 /opt/pdweb/bin/webseald -config etc/webseald-VP2.conf -foreground -noenv
 1477  1466 ivmgr    S    1491m 37.8   0  0.0 /opt/pdweb/bin/webseald -config etc/webseald-VP3.conf -foreground -noenv
 1463  1452 ivmgr    S    1490m 37.8   0  0.0 /opt/pdweb/bin/webseald -config etc/webseald-VP1.conf -foreground -noenv
 1395  1391 ivmgr    S    1266m 32.1   1  0.0 /opt/PolicyDirector/bin/pdmgrd -foreground
 4644  4626 www-data S    1211m 30.7   1  0.0 oneagentos -Dcom.compuware.apm.WatchDogPort=50001 -Dcom.compuware.apm.WatchDogTimeout=900 -watchdog.restart_file_location=/var/lib/dynatrace/oneagent/agent/runtime/watchdog_restart_file
 4329  4326 root     S     766m 19.4   1  0.0 wga_notifications -foreground
  767   765 root     S     626m 15.9   0  0.0 /usr/sbin/mesa_eventsd -m 1000
 4647  4626 www-data S     509m 12.9   0  0.0 oneagentloganalytics -Dcom.compuware.apm.WatchDogPort=50002 -Dcom.compuware.apm.WatchDogTimeout=900
 4642  4626 www-data S     491m 12.4   0  0.0 oneagentnetwork -Dcom.compuware.apm.WatchDogPort=50003 -Dcom.compuware.apm.WatchDogTimeout=900
 4626     1 www-data S     452m 11.4   1  0.0 /opt/dynatrace/oneagent/agent/lib64/oneagentwatchdog -bg -config=/opt/dynatrace/oneagent/agent/conf/watchdog.conf

[~accountid:5b17571b91981f4fdde632c1] VSZ and %VSZ analysis from the files mentioned by your update.","21/Feb/23 1:16 AM;5b17571b91981f4fdde632c1;{quote}Please show me your VSZ and %VSZ analysis from

2022-12-14/isva_10.0.3.1_20221214-130858_cle-prd-01-isam-mgt.cle.fra02.eu.onpirean.net.support

2023-01-05/isva_10.0.3.1_20230104-103215_cle-tst-01-isam-mgt.cle.fra02.eu.onpirean.net.support{quote}

* Dumping data is *NOT* analysis … answer ALL OF THE QUESTIONS below:
** What does %VSZ mean to you?
** What does VSZ mean to you?
** What is the difference between %VSZ and VSZ?
* Once you understand what they are
** From the data below script or manually extract JUST these fields in this order
*** Strongly recommend scripting that you would always use the in future
*** At times there may not be any space between VSZ and %VSZ
**** Otherwise could be long, tedious and error prone
*** %VSZ
*** VSZ
*** Command
** Then show me the{color:#bf2600} *top TWO memory contenders* {color}and how did you determine it?
*** Any unanswered questions … will return back to L2
*** If the top TWO memory contenders are not present or incorrect … will return back to L2","22/Feb/23 1:51 AM;617a5f2cf485cd0068cb98af;[~accountid:5b17571b91981f4fdde632c1] Below are answers to the questions please

1.what does %VSZ to you? %VSZ. is. VSZ%total Memory

2. What does VSZ mean to you? VSZ -> is process usage in memory and on disk

3. What is the difference between %VSZ and VSZ? %VSZ is the VSZ%total memory and VSZ is the process usage in memory on disk

4. Understand

5. Manually create the below.

{noformat}Morning support file

 VSZ	%VSZ	COMMAND
 2877m	73.0	/opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy
 1504m	38.2	/opt/pdweb/bin/webseald -config etc/webseald-Extranet_DE_Broker.conf -foreground -noenv
 
Afternoon support file

  VSZ	%VSZ	COMMAND
 2867m	72.8	/opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy
 1532m	38.9	/opt/pdweb/bin/webseald -config etc/webseald-Extranet_DE_Broker.conf -foreground -noenv{noformat}

Thanks","22/Feb/23 2:04 AM;5b17571b91981f4fdde632c1;* Slight correction
** RSS/MEM is the physical amount *IN* memory
*** Unknown true size
**** Next minute could swap in a HUGE amount of memory
** VSZ is the total virtual size of the process (memory, swap)
*** Most trusted to understand process size impact","22/Feb/23 2:15 AM;5b17571b91981f4fdde632c1;* VSZ/%VSZ analysis correct
** Top %VSZ process is java
*** Which Java java process?
**** Usually described in on word
*** Look at the VSZ
**** Does that look like a very large number (compared to other customers)?","22/Feb/23 2:19 AM;5b17571b91981f4fdde632c1;* Key additional work needed for next step
** Customer is at ISVA 10.0.3.1
*** When did they upgrade to 10.0.3.1
** What ISVA level were they running previously?","22/Feb/23 5:57 PM;617a5f2cf485cd0068cb98af;[~accountid:5b17571b91981f4fdde632c1] The ISAMs had previously been upgraded to 9.0.7.2, and we upgraded them from there to 10.0.3.1 in June 2022.","22/Feb/23 10:54 PM;5b17571b91981f4fdde632c1;Correct VSZ analysis.

* So top process is Java … which Java process (usually described by one word",22/Feb/23 10:55 PM;5b17571b91981f4fdde632c1;Has the “growth” ( not proven leak yet ) been going on since June 2022?,"01/Mar/23 4:59 AM;5b17571b91981f4fdde632c1;* Now that you know
** ISAM 9.0.7.2
*** to
** ISVA 10.0.3.1
* Please review [https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|smart-link]
** For each ISVA level in between
*** {color:#bf2600}10.0.0.0{color}
*** {color:#bf2600}10.0.1.0{color}
*** {color:#bf2600}10.0.2.0{color}
*** {color:#bf2600}10.0.3.0{color}
** If you are unable to to properly review and identify potential (and very possible root cause) from [https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|smart-link]
*** Please work with other L2 who have successfully used, review and understood","01/Mar/23 5:01 AM;5b17571b91981f4fdde632c1;< So top process is Java … which Java process (usually described by one word

* Remains unanswered from 2023/02/22
** Why?
*** It may/may not not help you in the [https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|smart-link] analysis","01/Mar/23 8:40 PM;617a5f2cf485cd0068cb98af;[~accountid:5b17571b91981f4fdde632c1] Customer do not know when the problem with high memory usage started - it may have been going on since June 2022, but I do not know. I first became aware of the problem in December 2022, when we noticed that two production ISAMs were running at nearly 90% memory usage and (I think) were unresponsive.



Is there any way to get this historical information from ISAM?","02/Mar/23 12:44 AM;5b17571b91981f4fdde632c1;THIRD REQUEST:

[~accountid:6092ac9ff6c0960069d47a67] 

< So top process is Java … which Java process (usually described by one word

* Remains unanswered from 2023/02/22
** Why?
*** It may/may not not help you in the [https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|smart-link] analysis","02/Mar/23 12:50 AM;5b17571b91981f4fdde632c1;For IBM Support only:

* What would happen if I did not respond to your updates/questions
*  Probably would not go well for you or the customer
* Why are mine ignored multiple times","02/Mar/23 6:49 PM;617a5f2cf485cd0068cb98af;[~accountid:5b17571b91981f4fdde632c1] 

The top java process is 

VSZ 	%VSZ  COMMAND
2867m 72.8  /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy

It is the runtime process.

VSZ 	%VSZ  COMMAND
2867m 72.8  /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy

It is runtime process of ISAM

It is fixed with APAR IJ39126  in 10.0.5.0

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|smart-link] 

Customer need to upgrade to 10.0.5.0",02/Mar/23 9:41 PM;5b17571b91981f4fdde632c1;There is still *at least* one other ISAMSUP-4072 scenario based on your Java / Java Developer Kit that effected memory which requires you to review each release (including <V.F.R.M.> Mod level changes if noted) changes *above* their previous  ISAM/ISVA level,"02/Mar/23 11:33 PM;617a5f2cf485cd0068cb98af;{{IJ34146 10.0.4.0 10.0.3.1 SSL SESSION IDS ARE NOT BEING REUSED WHEN SSLENGINE DOES NOT RECEIVE THE PROPER SSL/TLS CLOSE NOTIFICATION MESSAGE WebSEAL backend junction java server: [ssl] jct-gsk-attr-name = enum:4003:1}}

Another is above.","08/Mar/23 3:53 AM;5b17571b91981f4fdde632c1;{quote}There is still *at least* one other ISAMSUP-4072 scenario based on your Java / Java Developer Kit answer that effected memory which requires you to review each release (including <V.F.R.M.> Mod level changes if noted) changes *above* their previous ISAM/ISVA level{quote}

* Still not completed
** Please pull all Java pointers from [https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|smart-link]",27/Mar/23 10:21 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
API Mass Assignment Vulnerability for API - apiauthsvc,ISAMSUP-4689,274823,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,jwade,5b15d8fd6e93913e31e279fb,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,06/Jan/23 4:05 PM,24/Feb/23 2:16 AM,14/Jul/23 2:47 PM,24/Feb/23 2:16 AM,,Support,,0,,,,"Hi , just received a case from a client where this vulnerability got flagged in their envt.

Can you help me analyse it and provide a mitigation if any from ISVA side. You can access the detailed report from their Auditor on the case itself(TS011691594).

Requesting you to please help ASAP since this major vulnerability as per Customer.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011691594,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,DUBAI HEALTH AUTHORITY DUBAI HEALTH AUTHORITY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17fof:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-01-10 22:21:44.916,,,,,"10/Jan/23 2:02 PM;62d0e51aec233f24684a5d3a;Hi Team, Any update on this? Thanks….",11/Jan/23 8:21 AM;5b15d8fd6e93913e31e279fb;I am starting to look into this now.  Consulting with the Ethical Hacking Team.,"11/Jan/23 8:24 AM;5b15d8fd6e93913e31e279fb;The Ethical Hacking team says this looks like an AppScan vulnerability that is false positive 99.9% of the time.

2 things we need.

# The response body from the test. That would have provided some important information.
# A recreate environment that the EHT can test in.","11/Jan/23 3:48 PM;62d0e51aec233f24684a5d3a;Thanks, 

I will convey to the client.",24/Feb/23 2:16 AM;5b15d901fa615349cb01778b;case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Two way SSL configuration for Password Synchronization Plug-in at ISVA end,ISAMSUP-5069,299421,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,,Motiur Rahman,5b15d9e581c3df12acf53c4a,adarsh.nair,605c0c04b18de50071046740,adarsh.nair,605c0c04b18de50071046740,12/May/23 4:31 PM,17/May/23 6:49 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"Customer has Password Synchronization Plug-in at ISVA end.They recently upgraded their environment from ISAM 9.0.X to 10.0.4.0
After upgrade they found that Password Synchronization Plug-in is failing.They are using two way SSL communication between ISIM and ISVA.
If they change  it to One way SSL communication(from the ISIM end) everything works.


they have following configuration at ISVA end.

{noformat}[itim]

is_enabled = true

itim-server-name = rydap192

servlet-port = 9444

principal-name = isampwdplugin

service-source-dn = erservicename=IBM Security Access Manager,o=Cuscal,ou=SPS,DC=COM

keydatabase-file = /var/pdweb/shared/keytab/password-plugin-2023.p12

keydatabase-password-file = /var/pdweb/shared/keytab/password-plugin-2023.sth{noformat}

After reviewing the packet capture, It can be seen that Rev Proxy is not sending the personal certificate.
Please refer below pcap.
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012951677&path=TS012951677%2F2023-05-12%2F&filepath=TS012951677%2F2023-05-12%2Ftrace01_2_.pcap|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012951677&path=TS012951677%2F2023-05-12%2F&filepath=TS012951677%2F2023-05-12%2Ftrace01_2_.pcap]

 Certificates Length: 0 in below packet

you can use following filter *tcp.stream eq 964* 

{noformat}Frame 6661: 342 bytes on wire (2736 bits), 342 bytes captured (2736 bits)
Linux cooked capture v1
Internet Protocol Version 4, Src: 10.161.34.38, Dst: 10.161.158.37
Transmission Control Protocol, Src Port: 19884, Dst Port: 9444, Seq: 127, Ack: 5324, Len: 274
Transport Layer Security
    TLSv1 Record Layer: Handshake Protocol: Multiple Handshake Messages
        Content Type: Handshake (22)
        Version: TLS 1.0 (0x0301)
        Length: 269
        Handshake Protocol: Certificate
            Handshake Type: Certificate (11)
            Length: 3
            Certificates Length: 0
        Handshake Protocol: Client Key Exchange
            Handshake Type: Client Key Exchange (16)
            Length: 258
            RSA Encrypted PreMaster Secret{noformat}

also in the doc there is no way to configure the label for client certificate to be passed for two way SSL communication.
[https://www.ibm.com/docs/en/sva/10.0.4?topic=reference-itim-stanza|https://www.ibm.com/docs/en/sva/10.0.4?topic=reference-itim-stanza|smart-link] 

this was working in ISAM 9.0.X most likely because of kdb keystore format and '*Set as the Default Certificate*' option was present for the Personal certs ..now with 10.0.4.0 as  keystore format has changed to p12 there is no way to define default certificate in the Personal Certs from LMI.
",,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,16/May/23 1:21 PM;ug:14b3bc06-75b9-4ef6-9f48-405affebd15a;Screenshot 2023-05-16 at 8.41.14 AM.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200824,16/May/23 1:21 PM;ug:14b3bc06-75b9-4ef6-9f48-405affebd15a;Screenshot 2023-05-16 at 8.50.23 AM.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200823,17/May/23 1:37 AM;ug:14b3bc06-75b9-4ef6-9f48-405affebd15a;Screenshot 2023-05-16 at 8.52.01 PM.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200922,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012951677,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,adarsh.nair,605c0c04b18de50071046740,,,,CyberCX Pty Ltd,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012951677&path=TS012951677%2F0-all_data%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1bgin:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-14 22:44:30.234,,,,,15/May/23 8:44 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] can you please complete the initial assessment of this one. It looks like that the provided information is solid but you may need some assistance from the L2 team to set up a ISIM deployment if we need to confirm this. [~accountid:605c0c04b18de50071046740] appreciate your support regarding getting this deployment up and running. ,"16/May/23 4:39 AM;5b15d9e581c3df12acf53c4a;Why do you think that webseal is doing something wrong here?

Which IP is 10.161.158.37? This is acting as server in the ip packets that you mentioned and seems like it cannot communicate in TLS 1.2?","16/May/23 1:21 PM;605c0c04b18de50071046740;[~accountid:5b15d9e581c3df12acf53c4a] ,

Why do you think that webseal is doing something wrong here?

{quote}Webseal is not able to present a client certificate(personal) in this case for two way SSL communication.{quote}


Which IP is 10.161.158.37? This is acting as server in the ip packets that you mentioned and seems like it cannot communicate in TLS 1.2?
 
 /ecurep/sf/TS012/951/TS012951677/2023-05-10/isva_10.0.4.0_20230510-151149_WAF0RYD2.support_unpack/etc/settings.txt

{noformat}hosts.12.address = 10.161.158.37
hosts.12.name = rydap192{noformat}

This is their ISIM server configured under the [itim] stanza

{{itim-server-name = rydap192}}

the issue is not with TLS version. If it would have been TLS version issue ideally would have resulted in SSL handshake error before going into Certificate request and Server Hello Done.

The issue is that webseal is not able to present a valid certificate.


!Screenshot 2023-05-16 at 8.41.14 AM.png|width=91.66666666666667%!

the certificate presented by Webseal is 0 length(in short it’s not able to present certificate).


!Screenshot 2023-05-16 at 8.50.23 AM.png|width=728,height=194!


there is no option under [itim] stanza to specify the client certificate to be presented.



","17/May/23 1:14 AM;5b15d9e581c3df12acf53c4a;No, in the SSL communication, WebSEAL  i.e. 10.161.34.38 is the client and 10.161.158.37 is the server, see in this exchange there is no server hello.

(or all of the packets were not captured because seems like all communication is not present in this pacap file.)

What ever cipher suite and signature algorithm is client asking, server does not have it.

In the support file, they do not have the server key files so it is hard to check.

Look at the server’s key database, those needed to be updated, I think server’s certs are really really old meaning in terms of cipher suite and signature algorithm.","17/May/23 1:37 AM;605c0c04b18de50071046740;Hi [~accountid:5b15d9e581c3df12acf53c4a] ,
Please refer below pcap.
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012951677&path=TS012951677%2F2023-05-12%2F&filepath=TS012951677%2F2023-05-12%2Ftrace01_2_.pcap|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012951677&path=TS012951677%2F2023-05-12%2F&filepath=TS012951677%2F2023-05-12%2Ftrace01_2_.pcap]

use below filter  tcp.stream eq 964
I can see Server Hello


!Screenshot 2023-05-16 at 8.52.01 PM.png|width=83.33333333333334%!

{noformat}Frame 6659: 1287 bytes on wire (10296 bits), 1287 bytes captured (10296 bits)
Linux cooked capture v1
Internet Protocol Version 4, Src: 10.161.158.37, Dst: 10.161.34.38
Transmission Control Protocol, Src Port: 9444, Dst Port: 19884, Seq: 4105, Ack: 127, Len: 1219
[4 Reassembled TCP Segments (5323 bytes): #6653(1368), #6655(1368), #6657(1368), #6659(1219)]
Transport Layer Security
    TLSv1 Record Layer: Handshake Protocol: Multiple Handshake Messages
        Content Type: Handshake (22)
        Version: TLS 1.0 (0x0301)
        Length: 5318
        Handshake Protocol: Server Hello
            Handshake Type: Server Hello (2)
            Length: 77
            Version: TLS 1.0 (0x0301)
            Random: 645db9b6824c46372d689a8dadd2382186e1ac26cf41a5c948bfbb8fe21be80a
            Session ID Length: 32
            Session ID: 645db9b626f624cd9d4c81c0dfb1ed7dacd9bce8070e1fb3a0f73f72e057e747
            Cipher Suite: TLS_RSA_WITH_AES_128_CBC_SHA (0x002f)
            Compression Method: null (0)
            Extensions Length: 5
            Extension: renegotiation_info (len=1)
            [JA3S Fullstring: 769,47,65281]
            [JA3S: 4192c0a946c5bd9b544b4656d9f624a4]
        Handshake Protocol: Certificate
        Handshake Protocol: Certificate Request
        Handshake Protocol: Server Hello Done
{noformat}


the keystore is not present in suppport file..that doesn't mean the keystore does not exist.
Please refer below file.
/ecurep/sf/TS012/951/TS012951677/2023-05-10/isva_10.0.4.0_20230510-151149_WAF0RYD2.support_unpack/iswga/*password-plugin-2023.p12.txt*
 
L2 went into webex and we could see the keystore and personal certificate.


As I already mentioned If it would have been an issue with TLS version or Cipher suite It would have resulted in SSL Handshake error.

Could you please let me know if there is any parameter under [itim] stanza where Webseal can define the client certificate that can presented to Server ?","17/May/23 1:39 AM;5b15d9e581c3df12acf53c4a;I am very sure now that it has to do with key database cipher suite and signature algorithm mismatch.

Remember, ISVA 9040 , compared to 9.X, lots got changed in terms of gskit and relevant signature and cipher suite…………

Just note that client is asking to use TSL 1.2 but server is falling  back to TLS 1.0, right there it should be noted that server is using old old TLS/certificates that are not supported by webseal anymore…….","17/May/23 1:56 AM;605c0c04b18de50071046740;[~accountid:5b15d9e581c3df12acf53c4a] ,
If they change it to One way SSL communication(from the ISIM end) everything works.
Shouldn’t the same logic apply to one way SSL communication?
","17/May/23 6:46 AM;5b15d9e581c3df12acf53c4a;Unfortunately, the information that extracted in  …../iswga/password-plugin-2023.p12.txt

is using a very very old command which does not display the critical information that we are looking at for this issue ( that was an old command mainly to extract expiration and mid life of a certificate )….

It will be really helpful to get all the key database.

Remember, one way communication is OK means that one side is good, two communication means that one of the side must be having some problem with other side’s certificate………



Also, keep it in mind that two way means both side should have the other side’s CA certificate also present in each other’s key db.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
"About the vulnerability of IBM Application Gateway. (CVE-2022-2526, CVE-2022-31626, CVE-2022-3515, CVE-2022-42898)",ISAMSUP-4798,281488,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,jwade,5b15d8fd6e93913e31e279fb,Mitsukazu Nakai,5bb6a576c39135735a7db132,Mitsukazu Nakai,5bb6a576c39135735a7db132,15/Feb/23 5:33 PM,28/Apr/23 10:46 PM,14/Jul/23 2:47 PM,28/Apr/23 10:46 PM,,,,0,,,,"* As suggested by ISVCASE-1969, I created an ISAMSUP Jira item with the same content.

As a result of image scanning with Amazon Elastic Container Registry (ECR) against IAG container image ([icr.io/ibmappgateway/ibm-application-gateway:22.0|http://icr.io/ibmappgateway/ibm-application-gateway:22.0]) bundled with ISV, 4 high vulnerability and 17 medium vulnerabilities were detected. (please see the screen shot: [https://ecurep.mainz.de.ibm.com/rest/download/TS012021637/2023-02-02/scanresult.png?fileSize=236120&clientId=ae5|https://ecurep.mainz.de.ibm.com/rest/download/TS012021637/2023-02-02/scanresult.png?fileSize=236120&clientId=ae5)] )
Could you tell us about the planned countermeasures for the following four vulnerabilities classified as High?
CVE-2022-2526
CVE-2022-31626
CVE-2022-3515
CVE-2022-42898

supplement:
CVE-2022-2526 has been fixed in ISVA10.0.5, so they think we can provide a correction module for IAG.",,Yutaka Kanemoto,,,,,,,,,,,,,,,5b15d9ec6d76184b7d989c83,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012021637,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Mitsukazu Nakai,5bb6a576c39135735a7db132,,,,YUASA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18eu3:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-02-21 15:43:42.559,,,,,22/Feb/23 1:43 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] this Jira item has been opened for a little while now without an update. Can you please review this and confirm if each of the CVEs identified are at the OS level of something that we need to look into a little more. I suspect that most will be at the OS level but it would be great to validate this.,22/Feb/23 2:12 AM;5b15d8fd6e93913e31e279fb;[~accountid:5bb6a576c39135735a7db132] The fix for CVE-2022-2526 is fixed in the ISVA appliance.  The code for the CVEs mentioned above are in the RedHat UBI 8 image that is built with the IAG container image and will be included in the next update of the container image.  I do not believe we are vulnerable to any of the issues but are affected because the UBI 8 container contains down-level versions of the libraries.,"27/Feb/23 7:55 AM;5bb6a576c39135735a7db132;Hi [~accountid:5b15d8fd6e93913e31e279fb] 
Thank you for your support.

I have reported your answer to the customer.
Could you please let me know when the fix release schedule is clarified?
Thank you.

Regards,
Mitsukazu Nakai",01/Mar/23 2:59 AM;5b15d8fd6e93913e31e279fb;Yes I will track this to determine when the new container is updated in the IBM Container Registry.,01/Mar/23 8:52 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] lets catch up on the IAG container publication to pick the latest UBI image. [~accountid:5b15d8fd6e93913e31e279fb] can you please assess each of the CVEs to confirm if it they are fixed in the latest UBI. ,29/Mar/23 8:54 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] can you please asses and confirm that the UBI image has resolved these issues? We are currently planning to deliver a new version of the IAG at the end of April. ,29/Mar/23 9:06 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5bb6a576c39135735a7db132] All CVEs listed above are reported as fixed in the RHEL 8 release so should be available in the latest RH UBI 8 image.,"31/Mar/23 6:12 PM;5bb6a576c39135735a7db132;Hi [~accountid:5b15d8fd6e93913e31e279fb] 
Thank you for letting me know the situation.

Could you please let me know once the scheduled release date of IAG's container image that incorporates the fix is decided?
Thank you.

Regards,
Mitsukazu Nakai",26/Apr/23 8:55 AM;5ac57757d9a96536d1f0daa9;[~accountid:5ac577587028785d133fbc46] can you please confirm the status of the IAG April release? Has this been published or is the work still ongoing? ,"27/Apr/23 5:40 AM;5ac577587028785d133fbc46;[~accountid:5ac57757d9a96536d1f0daa9] IAG 23.04 is available now.

{{icr.io/ibmappgateway/ibm-application-gateway:23.04}}

The four CVEs listed in this item are not reported in the new image by Twistlock or IBM Cloud Vulnerability Advisor.",27/Apr/23 6:08 AM;5b15d8fd6e93913e31e279fb;Moving to L2 to inform the customer.,"27/Apr/23 12:42 PM;5bb6a576c39135735a7db132;Thank you very much.
I have reported the customer that a new image (IAG 23.04) is available.","28/Apr/23 6:52 PM;5bb6a576c39135735a7db132;Hi [~accountid:5b15d8fd6e93913e31e279fb] 
Thank you for your support.

Since the customer closed the SF Case, would you please close this Jira item as well?
Thank you very much.

Regards,
Mitsukazu Nakai",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA 10.0.5 JVM fast memory growth. J9 / Semeru crypto operations,ISAMSUP-5062,298984,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,High,Done,David Hayes,5b232b2fd85e5b59b066f57f,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,11/May/23 4:26 AM,06/Jul/23 3:13 AM,14/Jul/23 2:47 PM,06/Jul/23 3:13 AM,10.0.6,,,0,Growth,,,"The customer is seeing two leaks, a new one introduced in 10.0.5 where the JVM PSS can grow to many times the max set heap size. (aka a native memory leak outside of the Java heap), and a logging class leak

I can recreate the larger leak due to something that changed in 10.0.5, by doing EC operations in the JVM.    We have several customers already reporting the JVM leak.  *This Jira focuses on the new JVM leak.* 

The customer had a production outage and is pushing to fix the leaks as they have escalated and raised my case to Sev 1

I’ve already advised the customer to perform periodic restart of the JVM to free the memory.

When investigating what I suspect to be the larger leak in the JVM, by the magic of having multiple customers reporting it was able to rule out several causes such as:

{noformat}Not a FIP/NoFIPS issue has been seen in both types of envs.
Not a VM related issue as has been seen on hardware appliance as well. 
This is not related to the type of DB used or if the DB is local or remote has been see different DB vendors, and with embedded as well. 
This main JVM leak is NOT related to the tracing being on as one customer sees the leak without tracing enabled.
There appears to be a specific trigger for the JVM leak that is yet unknown.
The JVM leak does not appear to be triggered by an extension like dynatrace as it has been seen in in envs that are not running dynatrace.
It is not provoked by connectivity issues to the rsyslog.
It does not appear to be a new function introduced in 10.0.5 as FRIT has not started using anything new and started seeing the main leak as soon as the upgraded to 10.0.5
The fast JVM leak does appear to be triggered by some request and actions as we have seen the rate of JVM growth dependent on the load on the server at the time. 
The machines are not CPU bound so should have time for any house keeping that needs to be done. 
There is some suspicion that the main JVM leak could be related to JNI and native crypto in Semeru Runtime Open Edition (11.0.16.1+1) and 22.0.0.9 (wlp-1.0.68.cl220920220815-1900)
Customers seeing the large JVM memory growth report their environment was stable before upgrading to 10.0.5{noformat}



FRIT is reporting that the ISVA Java runtime is frequently running out of memory to the point that they have to restart once a week.   They are seeing this across multiple environments (prod and qa) for example.

For example:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-23%2Fisva_10.0.5.0_20230323-161856_pyq1tcac1.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-23%2Fisva_10.0.5.0_20230323-161856_pyq1tcac1.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F]

(These javacores are from an OOM event that caused system wide problems on the appliance (again this is both the logging ISAMSUP-5175 and new 10.0.5 issue combined.)

 grep 3CLTEXTCLASS javacore.20230304.202144.12223.0003.txt  | grep FIMLoggerImpl  | wc -l

29283 loaded

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-24%2Fisva_10.0.5.0_20230323-193929_pyq1tcac3.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-24%2Fisva_10.0.5.0_20230323-193929_pyq1tcac3.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F]

(These javacores were collected before proactive the runtime was restarted)
Thu Mar 23 19:40:17 EDT 2023

/usr/bin/top -b -n1 -mMem total:8146964 anon:6758744 map:97156 free:129576slab:152720 buf:41400 cache:842568 dirty:8564 write:0Swap total:2056316 free:1492PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND1904 8824m 8203m 6242m 34516 6194m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a

 grep 3CLTEXTCLASS javacore.20230323.192521.1904.0001.txt | grep FIMLoggerImpl | wc -l
50090 loaded 

The customer requires an urgent fix for the new 10.0.5 leak.

And I believe I have a full JVM system core being collected as part of my monitor script. 

/opt/ibm/wlp/bin/server javadump runtime --include=heap,system,thread 
Dumping server runtime.
Server runtime dump complete in /opt/IBM/wlp/usr/servers/runtime/logs/javacore.20230510.125254.7309.0005.txt.
Server runtime dump complete in /opt/IBM/wlp/usr/servers/runtime/logs/heapdump.20230510.125254.7309.0006.phd.
Server runtime dump complete in /opt/ibm/wlp/usr/servers/runtime/The core file created by child process with pid = 13745 was not found. Expected to find core file with name ""/var/support/core_kernel-command-.13745"".

But the file /var/support/core_kernel-command-.13745 actually exists after a few seconds.",,Annelise Quap,BRIANORO,Gabe,khansen,Nick Lloyd,Prabhjeet.Multani,William Hannon Jr,,,,,,,,,5b15d950d9936c61022057fe,6154906364ff01007106e189,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5175,,ISAMSUP-5130,,12/May/23 1:34 AM;aquap;image-20230511-142003.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200372,12/May/23 1:34 AM;aquap;image-20230511-143115.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200371,12/May/23 1:34 AM;aquap;image-20230511-145014.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200370,19/May/23 4:33 PM;djhayes;image-20230519-061952.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/201499,,,,,,,,,,,,IJ47335,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012529407,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,FRB FRIT PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,Yes,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bdtb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,High,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-10 20:55:31.885,,,,,11/May/23 4:29 AM;5b15d950d9936c61022057fe;I have not loaded my traces as I have collected GB of data in my attempts to recreate these leaks.   If you want my latest data where I focused on the logging classes let me know where I should put it?  Do you want it on box? I expect that once the sequence finishes it will be over 10 GB of data. ,"11/May/23 6:55 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d950d9936c61022057fe]  I think L3pmrsupport would have enough room if you want to put it there.  I’ll create a directory under  /ecurep using the case number and you can put it there.  Do you have a heapdump  after it has grown?

Updt: Looks like it is already there and you own it so it should be ready to go.",11/May/23 7:20 AM;5b15d94b6256d01ad54eb020;The java cores under the existing case on l3pmrsupport also show that high count you mentioned.  I think that’s all we need for now for the logger issue.,"11/May/23 8:09 AM;5b15d94b6256d01ad54eb020;Internal Comment:

Took a quick look at this.  One thing new for 10.0.5.0  was adding logging to   FIDORegistrationDefinition

The logging is created using  FIMLoggerFactory.getFIMLogger()  which does a  new  FIMLoggerImpl

Not much evidence of that being the cause in the javacore though.  It would be good to take a look at a heapdump if you have one.","11/May/23 8:53 AM;5b15d950d9936c61022057fe;I have the javacores, heapdump, and core. from after it has grown from the FIMLoggerImpl   I have NOT been able to recreate the main fast memory leak.   Again this is a case where the java heap itself looks ok, but the growth is outside of the Java heap. I’m trying to get a core from the customer as well so that I can use jdmpview on it.   It will take some time to marshall all the unzipped data up to a server.  Today’s test run on my local lab is still only half way through the stress test.

I’ve been using jdmpview to look at the core
I added the JDK to my appliance and used that to pack the core directly from my appliance(*I’m not sure how it does the pathing so don’t overwrite anything when you unpack)*
 /tmp/jdk-11.0.16.1\+1/bin/jpackcore core_kernel-command-.13745.start.core /tmp/jpack.start.core.zip
Loading dump file...
VM set to 00007F53A40695F0
Read memory image from core_kernel-command-.13745.start.core
Creating archive file: /tmp/jpack.start.core.zip
Adding ""core_kernel-command-.13745.start.core""
Adding ""/opt/java/jre/bin/java""
Warning:  Could not find file ""linux-vdso.so.1"" for inclusion in archive
Adding ""/opt/java/jre/lib/libmanagement.so""
Adding ""/tmp/jdk-11.0.16.1+1/lib/J9TraceFormat.dat""
Adding ""/tmp/jdk-11.0.16.1+1/lib/OMRTraceFormat.dat""
jextract complete.

I put the zip, javacore, and heapdump of the start core but it will be missing the rest of my data from today's testing, and I’m still not 100% sure the core is complete , if you need all that it will take some time to upload.  When I started today's test it was already leaking the classes from previous days of stress.",11/May/23 8:56 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] I am adding this item to your backlog as we have spoken about need to focus on the customers reports of JVM memory growth. Can we please spend some time today on this to try and isolate where this growth may be occurring. ,11/May/23 8:58 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d950d9936c61022057fe] awesome write up by the way. Thank you for providing clear and concise details. I am hoping that this will assist with out investigation into this issue. ,"11/May/23 8:59 AM;5b15d950d9936c61022057fe;/opt/ibm/wlp/usr/servers/runtime/logs # /tmp/procwatch.sh TS012529407 10 900 50
PSS: 2951743
Rollup PSS: 2951771
Number of classes in javacore:
72816
Wed May 10 12:53:15 CDT 2023
PSS: 2949316
Rollup PSS: 2949344
 7309 4243m 3083m 2929m 90452 2816m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
Number of classes in javacore:
72830





Wed May 10 17:53:41 CDT 2023
PSS: 3043979
Rollup PSS: 3044014
 7309 4294m 3155m 3022m 91412 2909m     4   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
Number of classes in javacore:
86923","11/May/23 9:17 AM;5b15d950d9936c61022057fe;[~accountid:5b15d94b6256d01ad54eb020] I been working for almost 2 months trying to recreate and eliminate factors.  After reading all the commits in github I thought it might have been Fido but on asking the customer about this they responded “A: We were experimenting with FIDO in our development (PYD*) environment. On our other environments (PYI*, PYQ*, PYP*) we have not began to configure FIDO.

“

Again they are seeing this new 10.0.5 leak in all envs, including the docker containers, and potentially even in the LMI java process in the config container.    

[~accountid:5b232b2fd85e5b59b066f57f] I only mention this in case I jumble the two leaks as I’ve spent months trying to recreate the new 10.0.5 leak with tracing disabled without any luck, so the two leaks have been a focus.   I suspect the FIMLoggerImpl leak will be easier to track down since I can locally recreate, but unfortunately it is also low impact on the rate of growth.   The new 10.0.5 leak still eludes me and haunts me in my dreams every night. ","11/May/23 3:50 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:5b15d950d9936c61022057fe] - thanks for all the detail. So from what I understand there are 2 issues here: 

# An issue that has potentially been around for a while relating to a slow memory leak when using FIMLoggerImpl. This has been reproduced in the lab.
# A larger/faster native memory leak identified in 10.0.5. This has not been reproduced in the lab. 

I’m sure you probably have already asked and answered these questions given you have been on the trail for a while - but just for my context:-



In relation to the leak in FIMLoggerImpl: 

# How did you reproduce in the lab? Is it just a case of turning on trace levels or did you have to configure certain flows and run some load? 
# What is the rate of growth? Has anything been noticed that impacts the rate of growth?



In relation to the “new” leak in 10.0.5:

1. Is the issue restricted to the runtime JVM - or is it also seen on the default (LMI) JVM? 

2. What is the rate of growth? Has anything been noticed that impacts the rate of growth? 

3. Just to confirm - this was not seen prior to 10.0.5?

4. Have there been any changes in the environment recently leading up to the issue occurring? 



I’m in the process of working through all of the data and your findings - but answers to the above will just help my understanding. 

A few observations so far / further questions:

# I agree that there seems to be an excessive number of FIMLogger and FIMLoggerImpl classes loaded based on the cores in /ecurep/sf/TS012/529/TS012529407/0-all_data/isva_10.0.5.0_20230323-161856_pyq1tcac1.support_unpack
# There are a bunch of DB connection issues from runtime JVM (/ecurep/sf/TS012/529/TS012529407/0-all_data/isva_10.0.5.0_20230323-161856_pyq1tcac1.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/messages_23.03.05_14.32.39.0.log) around the time of the core files. Not sure if this is just a symptom of, or potentially a contributor to, the high memory use
# I can’t see any OOM or high memory usage being logged in /ecurep/sf/TS012/529/TS012529407/0-all_data/isva_10.0.5.0_20230323-161856_pyq1tcac1.support_unpack/var/log/messages. How is the customer monitoring / determining that they have high memory usage requiring regular restarts? 



Thanks. ","12/May/23 1:05 AM;5b15d94b6256d01ad54eb020;Thanks for uploading the heapdump. I took a look at it and as expected found a large number of objects of com/tivoli/am/fim/logging/FIMLoggerImpl

There are a variety of owners but the ones I looked at all call:

FIMLogger logger_ = FIMLoggerFactory.getFIMLogger

As I mentioned before,  that method does a new each time it is called.  So I’m surprised we haven’t seen this before.  That method did the same thing in previous versions.

I’ll look into this some more later today.","12/May/23 1:34 AM;5b15d950d9936c61022057fe;Correct two issues.

My current lab recreate is a 10.0.4 that was upgraded to 10.0.5 that I have configured with SAML, OIDC, AAC CBA RTSS checks, JWT encryption/decryption, runtime template page loading, Runtime font loading, rsyslog audit enabled, and an infomap login with ldap lookups.  All using the embedded DBs.  As noted my main focus has been attempting to recreate the new leak so most of the time I leave the runtime with logging off.   The env is started clean and the load sent at it for 12-16 hours where the memory would plateau at the expected size the max heap.  Then I would repeat the next iteration changing any setting that I could to match the customers config.


!image-20230511-142003.png|width=471,height=90!



To recreate the issue with the FIMLoggerImpl I simply had an env that was at the plateau that I set the trace level to _=info:com.ibm.sec.authz._=ALL:com.tivoli.am.fim.authsvc._=ALL:com.tivoli.am.fim.saml20._=ALL:com.tivoli.am.fim.trustserver.sts.modules._=ALL:com.tivoli.am.fim.trustserver.sts.utilities._=ALL

Continued to send the same load (that maintains a 20-35% CPU load on a 2 CPU 16GB VM) and watched it grow

!image-20230511-143115.png|width=1368,height=548!

From the proc I can see this rate of growth over 12 hours:


Wed May 10 12:53:15 CDT 2023
PSS: 2949316
Rollup PSS: 2949344
7309 4243m 3083m 2929m 90452 2816m 4 124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
Number of classes in javacore:
72830



Wed May 10 23:54:20 CDT 2023
PSS: 3163298
Rollup PSS: 3163328
 7309 4365m 3255m 3138m 91412 3026m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
Number of classes in javacore:
104489

About 200 MB in 12 hours under higher load than then customer reported their average.

The last load test is just finishing up its 20 hour cycle now.  I plan to let the appliance “rest” under no load to make sure I’m not just missing something by not having a deep GC cycle or timeouts. 

There will still be the normal background, but I expect the rate of shared FIMLoggerImpl and memory growth will slow when there is no load. 



In relation to the “new” leak in 10.0.5:

The issue appears to impact both runtime and LMI, at least in the containers, as the customer has shared charts showing the config and runtime containers impacted by this.  I have seen some evidence of an LMI growth on the appliance as well, but as this appears to have some sort of load trigger it is harder to observe. 
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-05-09%2F&filepath=TS012529407%2F2023-05-09%2Fcontainer-memory-usage.png|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-05-09%2F&filepath=TS012529407%2F2023-05-09%2Fcontainer-memory-usage.png]

The rate of growth is can be higher, would have to look at [https://cloudidentity.atlassian.net/browse/ISAMSUP-4936|https://cloudidentity.atlassian.net/browse/ISAMSUP-4936|smart-link] as that customer does not have logging enabled and the load for sure impacts it as servers receiving more load grow faster then those receiving less.   

The chart from pyq1tcac3 shows an increase in growth rate in this chart, the customer is unable to tell me what exactly was being tested at the time, reconstructed from the mem.rrd

!image-20230511-145014.png|width=788,height=674!

You can see the growth on 06 Mar was from 55% to 60% memory. (approx 400 MB of physical memory growth in 24 hours) This VM has 8GB of total memory and only has the runtime and LMI on it, no WebSEALs  This data was collected before a proactive restart. The runtime was the main consumer of memory.  



The customers who are reporting this state that prior to the 10.0.5 upgrade the environments were stable memory wise and they did not need to restart the runtimes every few days. 

The only reported change was the upgrade to the 10.0.5 firmware.  Customers report the config remained the same. 





further questions:

# There are even more classes loaded in my test lab now then in the customers support files.
# The DB connections doe not appear to be the cause, as this happens with embedded DB and remote with oracle and DB2, The DB connection issues  are likely due to the high memory condition as they are not see in all envs.
# There was an OOM in pyq1tcac1 between March 3 and March 5.  
0SECTION       TITLE subcomponent dump routine
NULL           ===============================
1TICHARSET     UTF-8
1TISIGINFO     Dump Event ""systhrow"" (00040000) Detail ""java/lang/OutOfMemoryError"" ""Failed to create a thread: retVal -1073741830, errno 11"" received
1TIDATETIMEUTC Date: 2023/03/05 at 01:22:02:475 (UTC)
1TIDATETIME    Date: 2023/03/04 at 20:22:02:475
1TITIMEZONE    Timezone: UTC-5 (EST)
1TINANOTIME    System nanotime: 3215149296048866
1TIFILENAME    Javacore filename:    /opt/IBM/wlp/usr/servers/runtime/logs/javacore.20230304.202144.12223.0003.txt

Please note that caused other system abnormalities before.  You can see other evidence of the system struggling with full physical memory in the hours leading to the JVM OOM.   It appears the kernel and other process may not have fully recovered. 
Since then the customer has been trying to keep up with proactive restarts.   

The customer is using the normal LMI monitoring on the appliance.  In the Openshift they have their performance team that has been providing them data.  They are also looking at the simple CLI tools like the top memory output. 
It is clear from reviewing the mem.rrd files that there is a growth. ","12/May/23 3:52 AM;5b15d950d9936c61022057fe;We have seen the issue with many FIMLoggerImpl classes but the issue was pushed back with turn off logging and don’t leave it on in production, rather than addressing the leak. ","19/May/23 4:33 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d950d9936c61022057fe] - update for end of this week (19MAY):



Investigation and testing in the lab has identified that ISVA 10.0.5 inadvertently introduced a memory leak in an updated version of openj9, which we get via the Semeru JRE - [https://github.com/eclipse-openj9/openj9/issues/16451|https://github.com/eclipse-openj9/openj9/issues/16451|smart-link] . 



Looking at the code fix for this issue, it appears that EC operations are the cause: [https://github.com/ibmruntimes/openj9-openjdk-jdk/pull/552/files|https://github.com/ibmruntimes/openj9-openjdk-jdk/pull/552/files|smart-link] 

 

The leak has been recreated in the lab on ISVA 10.0.5 by performing EC crypto operations in the runtime over a long run. The specific operations which cause the leak are not yet known; however in this recreate, the runtime is issuing/validating EC signed/encrypted JWTs, and using an EC cert on the front-end. 

 

ISVA 10.0.4 is not subject to this issue due to having a non affected version of openj9. To prove this, an instance of ISVA 10.0.4 was configured in such a way as to trigger the leak; however, the leak did not occur. Once the same appliance was upgraded to 10.0.5, the leak could be observed:



!image-20230519-061952.png|width=1053,height=616!

 

This does not definitely prove that the openj9 leak is the same one that the customer is experiencing, but there is a strong correlation and when we have an updated Semeru we will be able to quickly confirm. [~accountid:5b15d950d9936c61022057fe] - can you confirm whether the customer is utilising any EC crypto operations in their environment? 

 

We are waiting for a new build of Semeru containing the fix to become available. Current information suggest this should occur in the coming weeks (SUPPORT ONLY: [https://ibm-security.slack.com/archives/C59HR9D5X/p1684453502514659|https://ibm-security.slack.com/archives/C59HR9D5X/p1684453502514659|smart-link] ). Once this is available, we will be able to confirm that the fix resolves the leak produced in the lab and then we can look at the feasibility of providing the update in an ISVA personal fix-pack to the customer. 

  

 ","20/May/23 6:47 AM;5b15d950d9936c61022057fe;When asked about if they were using EC crypto the customer indicated that they did not believe they were. “““
5/18/2023 10:34 AM | *Public* | *Matthew Jenkins (Customer)*

*Q: How do you have the JWT setup for encryption/decryption? Are you using Ecliptic Curve to do any encryption decryption operations on the JWTs?*



A: We are using the STS to sign and in some cases encrypt JWT. As far as the ciphers, I need to look at how the clients are configured to see what encryption they asked for. But, our default is A128CBC-HS256. I'll have to do some googling to see if that would include the EC ciphers.



This from documentation I provide the API teams that we register clients for (this is how we control encryption for them, via the client registration metadata, then the mapping rules take it from there during the token processing):



Signing and Encryption Metadata

* *jwks* - Obtain encryption and/or signing keys from jwks for JWT access tokens and OIDC ID tokens (OIDC client registration specification)
* *jwks_uri* - Obtain encryption and/or signing keys from jwks_uri path (requires runtime module in TierC to have access to jwks_uri path) for JWT access tokens and OIDC ID tokens (OIDC client registration specification)
* *id_token_signed_response_alg* - Signing algorithm (default RS256) on JWT access tokens and OIDC ID tokens (OIDC client registration specification)
* *id_token_encrypted_response_alg* - Encryption algorithm (default none) for JWT access tokens and OIDC ID tokens (OIDC client registration specification)
* *id_token_encrypted_response_enc* - Encryption (default A128CBC-HS256 when id_token_encrypted_response_alg is specified) for JWT access tokens and OIDC ID tokens (OIDC client registration specification)
* *id_token_signed_response_kid* to select signing key for JWT access tokens (OIDC client registration specification)

Note for encryption and signing keys, the JWKS JWK *use* (key use) parameter is used to determine the signing and/or encryption key(s) per the OIDC client registration specification. All keys must have a *kid* (key identifier).

All JWT tokens are always signed by default with the RS256 algorithm and the global signing certificate specified for all clients unless overridden using *id_token_signed_response_alg* and/or the presence of a *sig* JWK in the *jwks* or *jwks_uri*.

To encrypt JWT tokens, the client must supply at minimum the *id_token_encrypted_response_alg* value (for example, *RSA-OAEP-256*) and the *jwks* or *jwks_uri* value, and the JWKS must have at least one key with the *use* parameter set to *enc*.

“““","20/May/23 6:50 AM;5b15d950d9936c61022057fe;Given that the customer is using FIPS.   

Do we want to ask them to try the setting {{-Djdk.nativeCrypto=false}} in a lower env to see if that has any impact?  

Will that even work in FIPS?

Given that they do not think they are using EC do we have a plan B in case this isn’t the fix rather than having them wait 3 weeks only to find it still not fixed?","26/May/23 7:37 PM;5b232b2fd85e5b59b066f57f;Hi Annelise. Researching online ([https://www.eclipse.org/openj9/docs/djdknativecrypto/|https://www.eclipse.org/openj9/docs/djdknativecrypto/|smart-link] ) , it isn’t entirely clear what {{Djdk.nativeCrypto}} actually does, or how it does it; I’m not sure how it would behave, or even what to expect, with it set to false. If the customer has a lower environment where they are seeing the same issue and are willing to do so, they can try to see if it has any impact; but again, I’m not sure what that would actually mean - we would need to look into it further before suggesting it as a possible way forward.

*UPDATE for end of this week (26MAY):* 

This week I have been trying to trigger the growth/leak in other ways by running flows that would still be using the J9 / OpenSSL integration; thus far, the original test involving issuing/validating signed/encrypted JWTs seems to lead to the quickest rate of growth/leak.

We are still waiting for the updated release of Semeru in order to put together a personal test fix-pack for the customer to try in their environment.  ","30/May/23 12:32 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:5b15d950d9936c61022057fe]. An updated version of J9 / Semeru which contains the fix has been published. We have tested this release and the results have been positive based on the issue we recreated in the lab environment. We have incorporated the updated J9 / Semeru release in a Beta version of 10.0.6. Would the customer be willing to try the 10.0.6 Beta docker image to see whether it resolves the issue that they have in their environment?  This will help us identify whether the issue recreated in the lab (and by extension this fix) is relevant to the issue the customer is seeing in their environment. 

Let me know and we can co-ordinate delivery of the Beta version to the customer. 

Thanks.",01/Jun/23 8:23 AM;5b15d950d9936c61022057fe;I’m still waiting on a response if they are willing to test. ,"03/Jun/23 3:42 AM;5b15d950d9936c61022057fe;Customer responded:

we don't have the capacity currently to test a full image. A fixpack we could do, but not a full image. Some of our options are limited at the moment as we are in a change freeze for certain things because of a high visibility product that is going live soon.","09/Jun/23 10:42 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d950d9936c61022057fe] - I have put the Semeru / J9 update into a fix-pack available here → [https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|smart-link] .

I have verified the fix in the lab and it resolves the issue recreated in the lab. 

If FRIT can apply this in their environment and let us know the results - that would be great. 

Thanks. ",10/Jun/23 1:42 AM;5b15d950d9936c61022057fe;[~accountid:5b232b2fd85e5b59b066f57f] The customer is asking if it is expected this will also be included in 10.0.6 as is?,12/Jun/23 10:46 AM;5b232b2fd85e5b59b066f57f;Yes - this fix is in 10.0.6; but we are not 100% sure that this is the issue the customer is hitting in their environment - hence the ask for them to verify the fix in their environment. ,"15/Jun/23 2:02 AM;5b15d950d9936c61022057fe;The customer has installed the fixpack in several environments and has been monitoring for the last 24 hours.   So hopefully by the end the week we should have some indication if the fixed issue is the same as they had been seeing.   They only have 20 hours of data since applying the patch but in that the rate of growth was 2-3 times slower, and the process had not reached max heap so that could just be normal initial growth and the slow leak due to the trace logger leak.

I know this case branched off to the J9 issue, but are we still working on the logging issue that I reported?","22/Jun/23 8:14 AM;5b15d950d9936c61022057fe;Update from customer, so far the rapid growth seems to be tamed with the JVM update.  They are still seeing growth which is likely related to the trace logging. 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-06-21%2F&filepath=TS012529407%2F2023-06-21%2Fqa-mem-use-6-21-2023.jpg|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-06-21%2F&filepath=TS012529407%2F2023-06-21%2Fqa-mem-use-6-21-2023.jpg]",22/Jun/23 2:30 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d950d9936c61022057fe]  - ok - good to know. Let me know of any developments. Given the path this took - would you mind branching off a new support WI for the leak in the logging and we can take a look at that also? Also - we may want to think about an APAR for tracking purposes given a few customers are hitting this? ,"23/Jun/23 4:43 AM;5b15d950d9936c61022057fe;[~accountid:5b232b2fd85e5b59b066f57f] I did open this Jira for intending it for the Logging leak.   The summary is focused on the logging part of the leak, which is slower than the EC, but still noticeable. ",26/Jun/23 1:10 PM;5b232b2fd85e5b59b066f57f;We need to separate the issues so that we can better manage them. I’ve created [https://cloudidentity.atlassian.net/browse/ISAMSUP-5175|https://cloudidentity.atlassian.net/browse/ISAMSUP-5175|smart-link] to resolve the growth / leak when trace is turned on. [~accountid:5b15d950d9936c61022057fe]  - please create an APAR under this WI so we can track the leak in J9 / Semeru crypto operations. Once it is open - let me know and I’ll update the 10.0.6 APAR list. ,27/Jun/23 12:32 AM;5b15d950d9936c61022057fe;I’ve refactored the two JIRAs for the individual roles.,27/Jun/23 12:44 AM;5b15d950d9936c61022057fe;IJ47335  ISVA JVM MEMORY LEAK FROM J9 / SEMERU,27/Jun/23 8:17 AM;5b232b2fd85e5b59b066f57f;Thanks. I’ve closed the APAR and asked for the 10.0.6 APAR list to be updated. ,"27/Jun/23 8:21 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d950d9936c61022057fe] - I’ll put this back on L2’s queue for monitoring with the customer. Feel free to close out when you feel appropriate - we will continue work under [https://cloudidentity.atlassian.net/browse/ISAMSUP-5175|https://cloudidentity.atlassian.net/browse/ISAMSUP-5175|smart-link] for the logging growth / leak. 

Thanks for all your work on this one. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
DB2 ISVA product,ISAMSUP-5047,297809,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,05/May/23 1:23 AM,22/May/23 12:22 PM,14/Jul/23 2:47 PM,22/May/23 12:22 PM,,Support,,0,,,,issue with db2 database of ISVA platform,,Ayush Singh,Dave Bachmann,David Hayes,khansen,Nick Lloyd,prashant_kamat,tonyferg,Tushar Prasad,William Hannon Jr,,,,,,,61409dc154762c006932ffc7,5af0531368ebd52c36627c3b,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,ISAMSUP-4935,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012899872,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,RAIFFEISEN BANK S.A.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012899872&path=TS012899872/2023-05-04/&filepath=TS012899872/2023-05-04/db2support-DUP0001.zip,,,,,,,,,,,,,,,,,,,,,,,0|i1b6nz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-04 15:32:56.533,,,,,05/May/23 1:26 AM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1] ,"05/May/23 1:32 AM;5b17571b91981f4fdde632c1;* TS012899872
** Identified in two Jiras as same case number
*** [https://cloudidentity.atlassian.net/browse/ISAMSUP-4935|https://cloudidentity.atlassian.net/browse/ISAMSUP-4935|smart-link]
*** [https://cloudidentity.atlassian.net/browse/ISAMSUP-5047|https://cloudidentity.atlassian.net/browse/ISAMSUP-5047|smart-link]
** Why was this duplicated?",05/May/23 5:14 PM;6092ac9ff6c0960069d47a67;[~accountid:5b17571b91981f4fdde632c1] there were 2 SF cases pointing to one Jira so [~accountid:5b15d9e6dda5f94d06b985b4] requested we open this Jira for the case TS012899872,"09/May/23 2:43 AM;5b17571b91981f4fdde632c1;* TS012899872/2023-05-04
** db2support-DUP0001.zip
*** unzip would not succeed due to potential zip bomb
**** resolved with zip
*** For DB2 Support
**** From db2support . -d HVDB -c -s 
**** Not Dave Bachmann’s request
*** How can Dave Bachmann and I join/read the DB2 Salesforce case
**** What is the DB2 SalesForce case number
** Query_plans.zip
*** Reviewed query plans with Dave Bachmann
**** No surprises or problems seen","09/May/23 2:47 AM;5b17571b91981f4fdde632c1;{quote}there were 2 SF cases pointing to one Jira so … requested we open this Jira for the case TS012899872{quote}

* Originally when the problem was opened the other case still had Case: TS012899872
** It is now removed
** Leaving Linked issues: duplicates … just incase any old updates may be still needed
* Thank you for the explanation","10/May/23 12:25 PM;5c53d3ac23f5bf672621c868;# *Status*: ISVA case -> TS012899872 , DB2 -> case TS012900740,TS012929507,TS012919048 ISVA application was affected on 4th May as a result of db2 instance related issues and transaction log growth.

# *Summary :*Customer doesn’t see a rapid transaction logs growth at DB2 side today inline with db2 support analysis that there is not very high usage. Customer still needs RCA on why delete operations where stuck on 4th May
# During the call on 9th May , customer's DBA confirmed that transaction logs are very less growth which is 10 transaction logs in 1 hour 15 mins . in line with Db2 support analysis on TS012900740.

# *Action Plan:*

# waiting further whether transaction logs growth is stabilized. Customer is monitoring.
# ISVA and DB2 support team to work together check whether there is enough data available to provide an RCA on the day of the incident why delete queries were taking huge time",22/May/23 12:22 PM;5ac57757d9a96536d1f0daa9;Closing as this issue has been resolved y the DB2 team. Please advise if there is any additional support needed for this case.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
group-search-filter value missing or not working in LDAP searches after upgraded from V10.0.3.1 to V10.0.4,ISAMSUP-4982,295063,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,,,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,17/Apr/23 11:18 PM,19/Apr/23 6:17 PM,14/Jul/23 2:47 PM,18/Apr/23 1:21 AM,,,,0,,,,"Hello Team,

The cutomer are using federated LDAP in the runtime of ISVA (ldap.conf). They are busy to migrate to a new external LDAP and have some performance (slowness) issues on LDAP side (high CPU usage). It was fine on V10.0.3.1. The slowness and (high CPU usage) issue happens after upgraded from V10.0.3.1 to V10.0.4.  They have noticed a difference between user search and group search in the ISVA requests.

_________________________________________________________________________________________________________

[server:GLDPLDAP]
basic-user-principal-attribute = cn
group-search-filter = (|(objectclass=groupOfNames)(objectclass=groupOfUniqueNames))
host = gldpldapp.be.net.intra
port = 636
bind-dn = uid=sepl001p,cn=sysaccounts,cn=users,cn=accounts,dc=prod,dc=gldp,dc=net,dc=intra
ignore-if-down = no
ssl-enabled = yes
ssl-keyfile-dn = spsrp833.oob.be.net.intra
suffix = cn=accounts,dc=prod,dc=gldp,dc=net,dc=intra

[server:GLDPLDAP-STAFF-FLID]
basic-user-principal-attribute = robi
group-search-filter = (|(objectclass=groupOfNames)(objectclass=groupOfUniqueNames))
host = gldpldapp.be.net.intra
port = 636
bind-dn = uid=sepl001p,cn=sysaccounts,cn=users,cn=accounts,dc=prod,dc=gldp,dc=net,dc=intra
ignore-if-down = no
ssl-enabled = yes
ssl-keyfile-dn = spsrp833.oob.be.net.intra
suffix = cn=staff,cn=users,cn=accounts,dc=prod,dc=gldp,dc=net,dc=intra

[server:GLDPLDAP-FUNCTIONAL-FLID]
basic-user-principal-attribute = robi
group-search-filter = (|(objectclass=groupOfNames)(objectclass=groupOfUniqueNames))
host = gldpldapp.be.net.intra
port = 636
bind-dn = uid=sepl001p,cn=sysaccounts,cn=users,cn=accounts,dc=prod,dc=gldp,dc=net,dc=intra
ignore-if-down = no
ssl-enabled = yes
ssl-keyfile-dn = spsrp833.oob.be.net.intra
suffix = cn=functional,cn=users,cn=accounts,dc=prod,dc=gldp,dc=net,dc=intra

_____________________________________________________________________________________________________________

ISVA is adding the filter defined in the default [ldap-generic-general] stanza in the user search:
*user-search-filter* = (|(objectclass=ePerson)(objectclass=Person))

LDAP log evidence:
[14/Apr/2023:11:34:42.361614894 +0200] conn=1052094 op=58 SRCH base=""cn=accounts,dc=qa,dc=gldp,dc=net,dc=intra"" scope=2 filter=""(&(|(objectClass=ePerson)(objectClass=Person))(cn=799007))"" attrs=""1.1""

But in the group search, ISVA doesn't add the filter defined in each federated LDAP (which is the same than the default [ldap-generic-general] stanza):
*group-search-filter* = (|(objectclass=groupOfNames)(objectclass=groupOfUniqueNames))

LDAP log evidence:
[14/Apr/2023:11:34:42.380582660 +0200] conn=1052094 op=60 SRCH base=""cn=accounts,dc=qa,dc=gldp,dc=net,dc=intra"" scope=2 filter=""(|(member=cn=799007,cn=staff,cn=users,cn=accounts,dc=qa,dc=gldp,dc=net,dc=intra)(uniqueMember=cn=799007,cn=staff,cn=users,cn=accounts,dc=qa,dc=gldp,dc=net,dc=intra))"" attrs=""1.1""

Both LDAP requests are working fine, but the second one (with *group-search-filter*) is slow:

The design of their external LDAP has set the users and groups at the same level:

cn=accounts,dc=qa,dc=gldp,dc=net,dc=intra

users: cn=users,cn=accounts,dc=qa,dc=gldp,dc=net,dc=intra

groups: cn=groups,cn=accounts,dc=qa,dc=gldp,dc=net,dc=intra

We would like to understand why ISVA is propagating the user search filter but not the group search filter in the LDAP requests it's generating.

Also they mentioned that their LDAP colleagues reported that ISVA is doing more bind requests than unbind requests.

Please see high level statistics below:

{{======================================================= 14/Apr/2023: 07:25:49.369536269 End of Logs: 14/Apr/2023:09:43:36.527589460 Resource Unavailable: 4638 - 4638 (T1) Idle Timeout Exceeded Binds: 7913 Unbinds: 2018 }}

Instead of releasing resources after LDAP calls, it seems ISVA is keeping some connections opened, so they are falling in an idle timeout on LDAP side.

We would like to know why ISVA doesn't raise as many unbind requests as it's doing bind requests.",,BRIANORO,Carlos Rosales,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,6154906364ff01007106e189,5bb2c13f59e46d7be31a9e54,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012732252 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,RIBAS PARTNERS FOR INNOVAT,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1aq5j:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 Problems using ISVA SP federation and IdP partner NemLogin with certificate with new ciphers,ISAMSUP-4979,294713,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,14/Apr/23 7:54 PM,25/Apr/23 5:44 PM,14/Jul/23 2:38 PM,25/Apr/23 5:44 PM,,,,0,#escalated,,,"In the version 9.0.7.1 ISAM works without any problems with Federation: VirkFederation.

When customer try the same Federation: VirkFederation on then version 10.0.4.0 they get an error, ISVA is acting as ServiceProvider and the auth request is sent to NemLogin IdP correctly. Auth response fails with tfimError, can be seen in the attached federation log file (federation_trace.log) – starting from ‘Original Exception was java.security.InvalidKeyException: Unwrapping failed’.



{noformat}[4/13/23, 12:22:46:160 CEST] 000005a1 id=00000000 com.tivoli.am.fim.liberty.schemas.util.MiscUtils             1 decryptXML Parameters: [Element: xenc:EncryptedData, Alias: fed_sign_encryption_keys_erhverv_nemlogin_prod_2023, parms: {}

[4/13/23, 12:22:46:171 CEST] 000005a1 id=00000000 m.fim.kess.service.jks.mgmt.impl.KessServiceSoftwareProvider W decryptXML org.apache.xml.security.encryption.XMLEncryptionException: Unwrapping failed{noformat}

On the reference of this Jira [https://cloudidentity.atlassian.net/browse/ISAMDEV-6945|https://cloudidentity.atlassian.net/browse/ISAMDEV-6945|smart-link] 

Does it relate to the unwrapping key?
If so, is the fix available in Version 10.0.5.0?",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4992,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012723270,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,ATP,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1ao0f:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-18 01:32:39.19,,,,,18/Apr/23 11:32 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please take a look at this one for us? ,"18/Apr/23 11:50 AM;5af4ad7d4dd24c579110120b;<Notes>
server.xml 

{noformat}  <ssl id=""defaultSSLSettings"" keyStoreRef=""defaultKeyStore"" trustStoreRef=""defaultTrustStore"" sslProtocol=""TLSv1.2"" enabledCiphers=""TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 TLS_DHE_RSA_WITH_AES_128_CBC_SHA TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 TLS_DHE_RSA_WITH_AES_256_CBC_SHA TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 TLS_RSA_WITH_AES_128_CBC_SHA TLS_RSA_WITH_AES_128_CBC_SHA256 TLS_RSA_WITH_AES_256_CBC_SHA TLS_RSA_WITH_AES_256_CBC_SHA256"" clientAuthenticationSupported=""false""/>{noformat}

Toggle -

Advanced tuning parameter -


{noformat}java.enable.ibmjceplus = false to true{noformat}

<A known error with decrypt and associated fixpack>

Name : saml_decryption_error_10.0.4.0_fix
Fixpack : [https://ibm.box.com/s/x6xijuwhxfv1yi0pg9s3ejt2juqgukas|https://ibm.box.com/s/x6xijuwhxfv1yi0pg9s3ejt2juqgukas|smart-link] 
Checksum : [https://ibm.box.com/s/1nptz9s2qecrhrgzclyew4u2n9sg1xxw|https://ibm.box.com/s/1nptz9s2qecrhrgzclyew4u2n9sg1xxw|smart-link] 



Could also be a potential known limitation -

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4294|https://cloudidentity.atlassian.net/browse/ISAMSUP-4294|smart-link]  

[https://cloudidentity.atlassian.net/browse/ISAMDEV-6882|https://cloudidentity.atlassian.net/browse/ISAMDEV-6882|smart-link]  ","18/Apr/23 11:57 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] 

Here is a fixpack that was associated with a decrypt error on 10040 -

Name : saml_decryption_error_10.0.4.0_fix
Fixpack : [https://ibm.box.com/s/x6xijuwhxfv1yi0pg9s3ejt2juqgukas|https://ibm.box.com/s/x6xijuwhxfv1yi0pg9s3ejt2juqgukas|smart-link] 
Checksum : [https://ibm.box.com/s/1nptz9s2qecrhrgzclyew4u2n9sg1xxw|https://ibm.box.com/s/1nptz9s2qecrhrgzclyew4u2n9sg1xxw|smart-link]

Can you check if the customer can try this fixpack.

Can a test be run with Advanced configuration - kess.crlEnabled set to false? 

And get the logs with com.tivoli.am.fim.*=ALL and org.apache.xml.security.encryption.*=ALL 

As for your question - {{If so, is the fix available in Version 10.0.5.0?}}  - [https://cloudidentity.atlassian.net/browse/ISAMDEV-6945|https://cloudidentity.atlassian.net/browse/ISAMDEV-6945|smart-link] is in Open and deferred status so its not fixed yet in the development stream.","18/Apr/23 5:42 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 

Thank you for the fix pack, I will share with the customer.

Some more findings and questions on this case:

{noformat}Caused by: javax.crypto.BadPaddingException: Decryption error
 at java.base/sun.security.rsa.RSAPadding.unpadOAEP(Unknown Source){noformat}

This appears to be a documented known restriction.

*Federation module: The RSA-OAEP key encryption algorithm is not supported with HSM keys*
IBM Security Verify Access does not support decryption of SAML 2.0 messages using the RSA Optional Asymmetric Encryption Padding (RSA-OAEP) key transport algorithm with Hardware Security Module (HSM) keys. The RSA-OAEP algorithm is supported with software (non-HSM) keys. For more information on RSA-OAEP, see [http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p|http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p|smart-link] .

[https://www.ibm.com/docs/en/sva/10.0.5?topic=overview-known-limitations|https://www.ibm.com/docs/en/sva/10.0.5?topic=overview-known-limitations|smart-link] 

*The customer is not using the HSM keys, just want to confirm if not using HSM keys will it still be restricted*

Please find the link below to the trace.log:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-13%2Fisva_10.0.4.0_20230413-131316_atp-00dsam04mgt.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F&filepath=TS012723270%2F2023-04-13%2Fisva_10.0.4.0_20230413-131316_atp-00dsam04mgt.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2Ftrace.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-13%2Fisva_10.0.4.0_20230413-131316_atp-00dsam04mgt.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F&filepath=TS012723270%2F2023-04-13%2Fisva_10.0.4.0_20230413-131316_atp-00dsam04mgt.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2Ftrace.log]","18/Apr/23 8:56 PM;5af4ad7d4dd24c579110120b;[~accountid:627a7fb30d1e73006f7c21cf] 

*The customer is not using the HSM keys, just want to confirm if not using HSM keys will it still be restricted* - The RSA-OAEP algorithm *is supported* with software (non-HSM) keys.","18/Apr/23 10:13 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 
Customer applied the fixpack and they are still getting an error.

Customer share the support file in the below ecurep link and also request from customer for the log with com.tivoli.am.fim.*=ALL and org.apache.xml.security.encryption.*=ALL.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-18%2F&filepath=TS012723270%2F2023-04-18%2Fisva_10.0.4.0_20230418-140041_ATP-00TSAM01.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-18%2F&filepath=TS012723270%2F2023-04-18%2Fisva_10.0.4.0_20230418-140041_ATP-00TSAM01.support]
","19/Apr/23 12:00 AM;627a7fb30d1e73006f7c21cf;Customer uploaded the logs

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-18%2F&filepath=TS012723270%2F2023-04-18%2Fisva_10.0.4.0_20230418-153506_ATP-00TSAM01.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-18%2F&filepath=TS012723270%2F2023-04-18%2Fisva_10.0.4.0_20230418-153506_ATP-00TSAM01.support]","19/Apr/23 2:21 AM;5b15d99b4c20165700edecad;Confirmed the {{java.enable.ibmjceplus}} is set to true and the Fixpack was installed. 
[https://ecurep.mainz.de.ibm.com/rest/download/TS012723270/2023-04-18/isva_10.0.4.0_20230418-153506_ATP-00TSAM01.support_unpack/etc/policies/cml/mesa/device_params/device_params2_0_0.xml?fileSize=4969&clientId=ae5|https://ecurep.mainz.de.ibm.com/rest/download/TS012723270/2023-04-18/isva_10.0.4.0_20230418-153506_ATP-00TSAM01.support_unpack/etc/policies/cml/mesa/device_params/device_params2_0_0.xml?fileSize=4969&clientId=ae5]


New trace after fixpack, ATP. 
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-18%2Fisva_10.0.4.0_20230418-153506_ATP-00TSAM01.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F&filepath=TS012723270%2F2023-04-18%2Fisva_10.0.4.0_20230418-153506_ATP-00TSAM01.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2Ftrace.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-18%2Fisva_10.0.4.0_20230418-153506_ATP-00TSAM01.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F&filepath=TS012723270%2F2023-04-18%2Fisva_10.0.4.0_20230418-153506_ATP-00TSAM01.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2Ftrace.log]","19/Apr/23 12:47 PM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}KessServiceSoftwareProvider.java:535
            Key key =
                cipher.decryptKey(
                    encryptedKey, encryptedData.getEncryptionMethod().getAlgorithm()
                );
                
                
<xenc:EncryptionMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"">
<ds:DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256"">
</ds:DigestMethod>
</xenc:EncryptionMethod>

XMLCipher.java

            KeyInfo ki = encryptedKey.getKeyInfo();
            if (ki != null) {
                ki.setSecureValidation(secureValidation);
                try {
                    String keyWrapAlg = encryptedKey.getEncryptionMethod().getAlgorithm();
                    String keyType = JCEMapper.getJCEKeyAlgorithmFromURI(keyWrapAlg);
                    if (""RSA"".equals(keyType)) {
                        key = ki.getPrivateKey();
                    } else {
                        key = ki.getSecretKey();
                    }
                }
                catch (Exception e) {
                    if (log.isLoggable(Level.FINE)) {
                        log.log(Level.FINE, e.toString());
                    }
                }
            }

{noformat}



{noformat}[4/18/23, 15:31:02:925 CEST] 000000a4 id=00000000 org.apache.xml.security.encryption.XMLCipher                 1 decryptKey JCE Key Algorithm: AES
[4/18/23, 15:31:02:925 CEST] 000000a4 id=00000000 org.apache.xml.security.encryption.XMLCipher                 1 constructCipher JCE Algorithm = RSA/ECB/OAEPPadding
[4/18/23, 15:31:02:927 CEST] 000000a4 id=00000000 m.fim.kess.service.jks.mgmt.impl.KessServiceSoftwareProvider W decryptXML org.apache.xml.security.encryption.XMLEncryptionException: Unwrapping failed
Original Exception was java.security.InvalidKeyException: Unwrapping failed{noformat}

{noformat}https://github.com/frohoff/jdk8u-jdk/blob/master/src/share/classes/com/sun/org/apache/xml/internal/security/algorithms/JCEMapper.java

        algorithmsMap.put(
            XMLCipher.RSA_OAEP,
            new Algorithm(""RSA"", ""RSA/ECB/OAEPPadding"", ""KeyTransport"")
        );
        algorithmsMap.put(
            XMLCipher.RSA_OAEP_11,
            new Algorithm(""RSA"", ""RSA/ECB/OAEPPadding"", ""KeyTransport"")
        );{noformat}

Could be a way the cipher.init is called, might need to see if it needs the digest algorithm and Nes method.","19/Apr/23 1:34 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] 

I have reviewed he trace and the error seems to be from the org.apache.xml cipher.deCryptKey to get the keyAlgorithm and the JCE mapper to get the keyType to extract the private key or secret key.

Is it feasible to get another set of trace with this 

com.tivoli.am.fim.*=ALL and org.apache.xml.*=ALL 

since we might get more trace from org.apache.xml.security.keys and also from org.apache.xml.internal.security.

Thanks","19/Apr/23 6:12 PM;627a7fb30d1e73006f7c21cf;Hi [~accountid:5af4ad7d4dd24c579110120b] 

Please find the requested trace in the below link uploaded by Customer

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-19%2F&filepath=TS012723270%2F2023-04-19%2Fisva_10.0.4.0_20230419-095640_ATP-00TSAM01.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-19%2F&filepath=TS012723270%2F2023-04-19%2Fisva_10.0.4.0_20230419-095640_ATP-00TSAM01.support]

Thanks","19/Apr/23 8:21 PM;5af4ad7d4dd24c579110120b;{noformat}Caused by: org.apache.xml.security.encryption.XMLEncryptionException: Unwrapping failed
Original Exception was java.security.InvalidKeyException: Unwrapping failed
	at org.apache.xml.security.encryption.XMLCipher.decryptKey(XMLCipher.java:1495)
	at com.tivoli.am.fim.kess.service.jks.mgmt.impl.KessServiceSoftwareProvider.decryptXML(KessServiceSoftwareProvider.java:535)
	at com.tivoli.am.fim.kess.service.jks.worker.impl.KessServiceJksWorkerImpl.decryptXML(KessServiceJksWorkerImpl.java:3884)
	... 46 more
Caused by: java.security.InvalidKeyException: Unwrapping failed
	at java.base/com.sun.crypto.provider.RSACipher.engineUnwrap(Unknown Source)
	at java.base/javax.crypto.Cipher.unwrap(Unknown Source)
	at org.apache.xml.security.encryption.XMLCipher.decryptKey(XMLCipher.java:1493)
	... 48 more
Caused by: javax.crypto.BadPaddingException: Decryption error
	at java.base/sun.security.rsa.RSAPadding.unpadOAEP(Unknown Source)
	at java.base/sun.security.rsa.RSAPadding.unpad(Unknown Source)
	at java.base/com.sun.crypto.provider.RSACipher.doFinal(Unknown Source){noformat}



Need to check trace from


{noformat}sun.security.rsa.*=ALL and com.sun.crypto.provider.=ALL {noformat}","19/Apr/23 9:22 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 
Please find the requested trace 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-19%2F&filepath=TS012723270%2F2023-04-19%2Fisva_10.0.4.0_20230419-131030_ATP-00TSAM01.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-19%2F&filepath=TS012723270%2F2023-04-19%2Fisva_10.0.4.0_20230419-131030_ATP-00TSAM01.support]","19/Apr/23 11:59 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 

Customer provided some more details:

ATP has asked for updates.
 Every second hours between 06.30 and 18.30 CEST.
Every forth hour between 18:30 and 06:30 CEST","20/Apr/23 4:42 AM;5b15d99b4c20165700edecad;It doesn’t look like “sun.security.rsa.*=ALL and com.sun.crypto.provider.*=ALL” is providing any additional information in the traces. 

I’ve tried to recreate this myself but it doesn’t appear we can embed the key in the encrypted data like they do. I tested with a ISVA IDP which doesn’t embed the key in the encrypted assertions. I’m pretty sure it would be the same with an ISAM IDP. 

Based on the stack is almost seems like the xmlsec doesn’t expect a SHA256 digest with RSA/ECB/OAEP Padding. From the specs the default is SHA-1 but I’ve seen references that SHA-256 is supported.  

{noformat}[4/19/23, 12:52:08:626 CEST] 000003f1 id=00000000 org.apache.xml.security.algorithms.JCEMapper                 1 getAlgorithm Request for URI http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p
[4/19/23, 12:52:08:626 CEST] 000003f1 id=00000000 org.apache.xml.security.encryption.XMLCipher                 1 constructCipher JCE Algorithm = RSA/ECB/OAEPPadding
[4/19/23, 12:52:08:626 CEST] 000003f1 id=00000000 org.apache.xml.security.algorithms.JCEMapper                 1 getAlgorithm Request for URI http://www.w3.org/2001/04/xmlenc#sha256{noformat}


Maybe instead “RSA/ECB/OAEPPadding"" it should be “RSA/ECB/OAEPWithSHA-256AndMGF1Padding""?

In the meantime I’m going to ask them for a trace from the ISAM 907 environment where they said this is working. My guess is ISVA 10.0.4+ is too different from ISAM 907 to compare but I want to check if they are using a SHA-1 or SHA-256 message digest with the embedded key.   ","20/Apr/23 6:46 AM;5b15d99b4c20165700edecad;Customer uploaded a trace.log from ISAM 9 and its using a SHA-1 not SHA-256 digest like the failing ISVA flow. 
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-19%2F&filepath=TS012723270%2F2023-04-19%2Ftrace.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012723270&path=TS012723270%2F2023-04-19%2F&filepath=TS012723270%2F2023-04-19%2Ftrace.log]


Response sent to ISAM 9
<xenc:EncryptionMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"">            <ds:DigestMethod Algorithm=*""http://www.w3.org/2000/09/xmldsig#sha1""*/>
         

Response sent to ISVA 10.0.4
<xenc:EncryptionMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"">                       <ds:DigestMethod Algorithm=*""http://www.w3.org/2001/04/xmlenc#sha256""*/>","20/Apr/23 8:58 AM;5af4ad7d4dd24c579110120b;<Notes>

[https://issues.apache.org/jira/browse/SANTUARIO-406|https://issues.apache.org/jira/browse/SANTUARIO-406|smart-link] 

Todo- test this change.

KessServiceSoftwareProvider.java

{{OAEPParameterSpec}} 

{noformat}import javax.crypto.spec.OAEPParameterSpec;
import javax.crypto.spec.PSource;
import java.security.spec.MGF1ParameterSpec;
 
        OAEPParameterSpec oaepParams = new OAEPParameterSpec(""SHA-256"", ""MGF1"", new MGF1ParameterSpec(""SHA-1""), PSpecified.DEFAULT);
        cipher.init(Cipher.DECRYPT_MODE, pkey, oaepParams);{noformat}

Trial2:

{noformat}XMLCipher cipher = XMLCipher.getInstance(""RSA/ECB/OAEPWITHSHA-256ANDMGF1PADDING"");{noformat}","20/Apr/23 1:46 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] [~accountid:5b15d99b4c20165700edecad] 

I have a test fixpack here -

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4992|https://cloudidentity.atlassian.net/browse/ISAMSUP-4992|smart-link] 

which changes the cipher padding to {{(""RSA/ECB/OAEPWITHSHA-256ANDMGF1PADDING"");}}

If you have a recreate please try this or if customer can try this fixpack and get the logs to see if decrypt works.

Thanks","25/Apr/23 5:44 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 

Case is closed, everything is working fine on customer’s end.

Thank you",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Partial outage for CN QA & PROD,ISAMSUP-4939,291724,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,,,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,02/Apr/23 7:50 PM,03/Apr/23 12:27 AM,14/Jul/23 2:47 PM,03/Apr/23 12:27 AM,,,,0,,,,"Problem Description:

Partial outage for CN QA & PROD

Authentication and API calls are failing



Hostnames are :

[sso.ci.ford.com.cn|https://sso.ci.ford.com.cn]

[ssoqa.ci.ford.com.cn|https://ssoqa.ci.ford.com.cn]



[2023-04-02/Prod_critical.log-2023-04-02.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012620246&path=TS012620246/2023-04-02/&filepath=TS012620246/2023-04-02/Prod_critical.log-2023-04-02.log]

----

[2023-04-02/QA_critical.log-2023-04-02.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012620246&path=TS012620246/2023-04-02/&filepath=TS012620246/2023-04-02/QA_critical.log-2023-04-02.log]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012620246,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,FORD MOTOR CO,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a5on:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,02/Apr/23 7:53 PM;61409dc154762c006932ffc7;is this due to ongoing outage for  user and group management with API client,02/Apr/23 9:53 PM;61409dc154762c006932ffc7;this can be closed have opened a ISV Jira for this,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Issues of upgrading ISAM platform,ISAMSUP-4935,291465,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,30/Mar/23 11:40 PM,02/Jun/23 1:33 PM,14/Jul/23 2:47 PM,02/Jun/23 1:33 PM,,,30/Mar/23 12:00 AM,0,,,,"Initially customer having issue while update from ISAM 9.0.7  version to ISVA 10.0.4. After the up gradation process  is done on all the appliances (Policy server and reverse proxy) and they start it up, the DB2 Database has an unusual behavior.Temporary tables are created (.TDA files) and the entire DB is filling up the entire space with the load around 98-99%.

Customer tested the manual cleanup but the problem with the high CPU appeared again after they start the automatic cleanup.

So Manual cleanup in batches of 50k and it works and having issue that during an automated cleanup the engine is performing a select on the entire table and results in resource exhaustion even during the select phase, it does not begin the delete of the objects.

As a result the customer would either benefit from help with creating a new index that could speed things up or a change in the logic(via code change most likely) so that the first statement that is executed during the automated cleanup is not leading to resource exhaustion.

Please find the automatic_cleanup.txt
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990%2F2023-03-22%2F&filepath=TS011946990%2F2023-03-22%2FAutomatic_cleanup.txt|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990%2F2023-03-22%2F&filepath=TS011946990%2F2023-03-22%2FAutomatic_cleanup.txt]",,Ayush Singh,BRIANORO,Dave Bachmann,Dermot Daly,khansen,Nick Lloyd,Norton Brainard,Prabhjeet.Multani,prashant_kamat,tonyferg,Tushar Prasad,Virag Patel,William Hannon Jr,,,61409dc154762c006932ffc7,6154906364ff01007106e189,5af0531368ebd52c36627c3b,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ff48f4aa9d0300107ccded2,627a7fb30d1e73006f7c21cf,5b15d9ef27631840ea300110,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,5b17571b91981f4fdde632c1,,,,,,,,,,,,,ISAMSUP-5047,,,,,,,,12/May/23 9:09 PM;tushar.prasad;image-20230512-105740.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200507,11/May/23 8:43 AM;whannon;live_parallellive.ddl.c10;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200212,11/May/23 8:43 AM;whannon;live_parallellive.index.c10;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200213,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011946990,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,RAIFFEISEN BANK S.A.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a43j:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-03 02:04:08.811,,,,,"30/Mar/23 11:43 PM;627a7fb30d1e73006f7c21cf;Customer shared the count of all the tables in DB2

CREATE INDEX FIDO_RPID_INDEX ON FIDO_AUTHENTICATORS(RP_ID)

DB20000I The SQL command completed successfully.



CREATE INDEX FIDO_AAGUID_INDEX ON FIDO_AUTHENTICATORS(AAGUID)

DB20000I The SQL command completed successfully.



CREATE INDEX FIDO_ENABLED_INDEX ON FIDO_AUTHENTICATORS(ENABLED)

DB20000I The SQL command completed successfully.



COMMIT

DB20000I The SQL command completed successfully.



""db2"" ""-s"" ""-v"" ""INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,201910300,'isam_access_control_db2_update_201910300.sql')""

INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,201910300,'isam_access_control_db2_update_201910300.sql')

DB20000I The SQL command completed successfully.



# Running file 'isam_access_control_db2_update_201911110.sql' version 201911110

""db2"" ""-tvf"" ""hvdb/db2/isam_access_control_db2_update_201911110.sql""

CREATE INDEX U2F_FOR_USER_IDX ON U2F_TOKENS(USERNAME, TENANT_ID)

DB20000I The SQL command completed successfully.



CREATE INDEX U2F_ALL_USERS_IDX ON U2F_TOKENS(TENANT_ID)

DB20000I The SQL command completed successfully.



CREATE INDEX AUTHN_TENANTID_IDX ON AUTHENTICATORS(TENANT_ID)

DB20000I The SQL command completed successfully.



CREATE INDEX AUTHN_USERNAME_IDX ON AUTHENTICATORS(USERNAME)

DB20000I The SQL command completed successfully.



CREATE INDEX FIDO_TENANTID_IDX ON FIDO_AUTHENTICATORS(TENANT_ID)

DB20000I The SQL command completed successfully.



CREATE INDEX OAUTH_STATEID_IDX ON OAUTH_AUTHENTICATORS(STATE_ID)

DB20000I The SQL command completed successfully.



CREATE INDEX MFA_TDATA_TENANTID_IDX ON MMFA_AUTH_TXN_DATA(TENANT_ID)

DB20000I The SQL command completed successfully.



CREATE INDEX MFA_TDATA_USERNAME_IDX ON MMFA_AUTH_TXN_DATA(USERNAME)

DB20000I The SQL command completed successfully.



CREATE INDEX MMFA_TDATA_RESULT_IDX ON MMFA_AUTH_TXN_DATA(RESULT_STATE)

DB20000I The SQL command completed successfully.



COMMIT

DB20000I The SQL command completed successfully.



""db2"" ""-s"" ""-v"" ""INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,201911110,'isam_access_control_db2_update_201911110.sql')""

INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,201911110,'isam_access_control_db2_update_201911110.sql')

DB20000I The SQL command completed successfully.



# Running file 'isam_access_control_db2_update_202008040.sql' version 202008040

""db2"" ""-tvf"" ""hvdb/db2/isam_access_control_db2_update_202008040.sql""

ALTER TABLE OAUTH20_DYNAMIC_CLIENT ADD DEFINITION_NAME VARCHAR(200)

DB20000I The SQL command completed successfully.



COMMIT

DB20000I The SQL command completed successfully.



""db2"" ""-s"" ""-v"" ""INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202008040,'isam_access_control_db2_update_202008040.sql')""

INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202008040,'isam_access_control_db2_update_202008040.sql')

DB20000I The SQL command completed successfully.



# Running file 'isam_access_control_db2_update_202010120.sql' version 202010120

""db2"" ""-tvf"" ""hvdb/db2/isam_access_control_db2_update_202010120.sql""

CREATE TABLE PWD_VAULT ( RGY_USERNAME VARCHAR(256) NOT NULL, RESOURCE_NAME VARCHAR(256) NOT NULL, USERNAME VARCHAR(256) NOT NULL, PASSWORD CLOB NOT NULL, CONSTRAINT PWD_VAULT_PK PRIMARY KEY (RGY_USERNAME, RESOURCE_NAME) )

DB20000I The SQL command completed successfully.



COMMIT

DB20000I The SQL command completed successfully.



""db2"" ""-s"" ""-v"" ""INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202010120,'isam_access_control_db2_update_202010120.sql')""

INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202010120,'isam_access_control_db2_update_202010120.sql')

DB20000I The SQL command completed successfully.



# Running file 'isam_access_control_db2_update_202103230.sql' version 202103230

""db2"" ""-tvf"" ""hvdb/db2/isam_access_control_db2_update_202103230.sql""

""db2"" ""-s"" ""-v"" ""INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202103230,'isam_access_control_db2_update_202103230.sql')""

INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202103230,'isam_access_control_db2_update_202103230.sql')

DB20000I The SQL command completed successfully.



# Running file 'isam_access_control_db2_update_202105200.sql' version 202105200

""db2"" ""-tvf"" ""hvdb/db2/isam_access_control_db2_update_202105200.sql""

DROP TABLE AUTH_SVC_SESSION_CACHE

DB20000I The SQL command completed successfully.



COMMIT

DB20000I The SQL command completed successfully.



""db2"" ""-s"" ""-v"" ""INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202105200,'isam_access_control_db2_update_202105200.sql')""

INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202105200,'isam_access_control_db2_update_202105200.sql')

DB20000I The SQL command completed successfully.



# Running file 'isam_access_control_db2_update_202105280.sql' version 202105280

""db2"" ""-tvf"" ""hvdb/db2/isam_access_control_db2_update_202105280.sql""

ALTER TABLE USER_ATTRIBUTES_VALUES add primary key (VALUES_ID, VALUE)

DB20000I The SQL command completed successfully.



COMMIT

DB20000I The SQL command completed successfully.



""db2"" ""-s"" ""-v"" ""INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202105280,'isam_access_control_db2_update_202105280.sql')""

INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202105280,'isam_access_control_db2_update_202105280.sql')

DB20000I The SQL command completed successfully.



# Running file 'isam_access_control_db2_update_202111030.sql' version 202111030

""db2"" ""-tvf"" ""hvdb/db2/isam_access_control_db2_update_202111030.sql""

CREATE INDEX MMFA_ATTRS_TXN_ID ON MMFA_AUTH_TXN_CTX_ATTRS_DATA(TXN_ID)

DB20000I The SQL command completed successfully.



COMMIT

DB20000I The SQL command completed successfully.



""db2"" ""-s"" ""-v"" ""INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202111030,'isam_access_control_db2_update_202111030.sql')""

INSERT INTO HVDB_SCHEMA_UPDATES VALUES(CURRENT_TIMESTAMP,202111030,'isam_access_control_db2_update_202111030.sql')

DB20000I The SQL command completed successfully.",03/Apr/23 12:04 PM;5b232b2fd85e5b59b066f57f;Please have the customer provide a support file from the ISVA Appliance where they have the automated cleanup configured. Thanks. ,"04/Apr/23 5:59 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 
Customer rolled back to 9.0.7 version and they will not provide the support file, until they manage to do the manual cleanup.

But they have shared the count of the tables

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990/2023-04-03/&filepath=TS011946990/2023-04-03/isamrdb.xlsx|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990/2023-04-03/&filepath=TS011946990/2023-04-03/isamrdb.xlsx]","11/Apr/23 11:42 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

Update from customer
Customer pointed out that the built-in cleanup worked and works fine with version 9.0.7 for the same userbase with roughly the same amount of data. However the problem immediately surfaces when the first appliance is restarted after the upgrade to 10.0.4. In there opinion this points to a regression between versions, and this problem should be addressed as such.



Customer is looking for the update on this case","14/Apr/23 10:44 AM;5b232b2fd85e5b59b066f57f;I notice in the case the statement _“This behavior is starting once we turn on the PS and RP. If the PS and RP are not started, the DB2 Database is not performing this kind of actions.”_ This is key information that is not included in the details in this WI. 

In the environment, where is the cleanup job running from - i.e. is it from the PS Appliance or RP Appliance, or somewhere else? 

Without support files from all ISVA instances involved with this scenario at 10.0.4 after triggering the issue, it is unlikely I will be able to further diagnose the behaviour.  

Does the customer have a non-prod environment which represents production where they can upgrade? Do they see the same issue in their non-production environments? ","21/Apr/23 5:39 PM;627a7fb30d1e73006f7c21cf;Hi [~accountid:5b232b2fd85e5b59b066f57f] ,

Update from Customer:

Customer shared the support fille from the isolate env that they used in order to test the upgrade of the platform. Note: that the cleanup parameters are all on 0 value, that was the only solution that customer had for the upgrade to works and also to avoid to have any unnecessary filles created by the DB2 database.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990/2023-04-21/&filepath=TS011946990/2023-04-21/isva_10.0.4.0_20230421-095550_ciam-ps1.rbro.rbg.cc.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990/2023-04-21/&filepath=TS011946990/2023-04-21/isva_10.0.4.0_20230421-095550_ciam-ps1.rbro.rbg.cc.support]","25/Apr/23 11:34 PM;627a7fb30d1e73006f7c21cf;Hi [~accountid:5b232b2fd85e5b59b066f57f] 

Another update from customer

----

This weekend the customer managed to upgrade the platform to version 10.0.4 in Production.

In order to be able to upgrade the platform and enjoy the full benefit of the support, the customer had to do a manual cleanup on the old version plus keep the automatic cleanup turned off in version 10.

At this moment, the customer is forced to perform a maintenance window every ~2 weeks to manually clean the tables in the DB2 database, the customer cannot perform this workaround long-term because it affect both the uptime and the cost of maintaining such a setup, requiring close monitoring etc. therefore, please assist the customer in obtaining a fix as soon as possible.","26/Apr/23 10:11 AM;5b232b2fd85e5b59b066f57f;[~accountid:627a7fb30d1e73006f7c21cf] - I am still not getting the information that I need to help. 

What I need to understand is - when the customer sees the issue, what configuration do they have set for the cleanup job? I need this information for all of the ISVA Appliances that are configured to use this database. I could get this information from support files but the customer has not provided them from all ISVA instances and when they have provided them the cleanup job is turned off. 

Please get clarification on this from the customer so we can move forward. ","26/Apr/23 10:21 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

*On what configuration do they have set for the cleanup job?* Customer shared the configuration details below:

distributedMap.cleanupWait- new value 0 – old value 60000

session.dbCleanupInterval – new value 0 - old value 86400

oauth20.tokenCache.cleanupWait –new value 0 -old value 120

authsvc.stateMgmt.HVDB.cleanupWait –new value 0 - old value 120

mmfa.transactionArchival.cleanupInterval (Available only in ISVA 10.0.4) new value 0

mmfa.authenticator.cleanupWait new value 0 - old value 36000","27/Apr/23 12:00 PM;5b232b2fd85e5b59b066f57f;[~accountid:627a7fb30d1e73006f7c21cf] - 

Is this the same across all ISVA instances that are configured to use the DB? 

What do they have set for the “cleanupOnlyOnPrimaryMaster” parameters? What are these parameters set to when they see the issue? ","02/May/23 6:04 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

Replied from Customer

*Is this the same across all ISVA instances that are configured to use the DB?*
According to the customer understanding by modifing them on primary master, they should be applied on every appliance.

*What do they have set for the “cleanupOnlyOnPrimaryMaster” parameters? What are these parameters set to when they see the issue?*

On cleanupOnlyOnPrimaryMaster they did not set this parameter, any recommendation on this parameter.

Additional Informations:

The following parameters are set on true on the Primary policy server:
*mmfa.transaction.cleanupOnlyOnPrimaryMaster*
*oauth20.tokenCache.cleanupOnlyOnPrimaryMaster*

Customer had no intervention on these two parameters on version 9.0.7, durring the upgrade or in version 10.0.4.

The issues described in this ticket appeard only if the parameters from below are not set to 0.

distributedMap.cleanupWait
session.dbCleanupInterval
oauth20.tokenCache.cleanupWait
authsvc.stateMgmt.HVDB.cleanupWait
mmfa.transactionArchival.cleanupInterval (Available only in ISVA 10.0.4)
mmfa.authenticator.cleanupWait","03/May/23 12:20 PM;5b232b2fd85e5b59b066f57f;A few additional questions / statements

* Is there more than one ISVA cluster configured to use this DB - or just a single cluster? 
* cleanupOnlyOnPrimaryMaster should be set to “true”
* What do they have set for *.cleanupThread.batchSize across the ISVA instances? 
* In the customer’s DB2 instance - what do they have set for the following: 
** {{DB2_SMS_TRUNC_TMPTABLE_THRESH}}
** {{DB2_OPT_MAX_TEMP_SIZE}}
* I understand that the issue is only seen once the cleanup jobs are activated (i.e. by setting cleanupWait / cleanupInterval). However, this may just be allowing the issue to occur, hence the additional questions around other config and structure of the environment. ","03/May/23 7:37 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

Customer raised the severity to 1 and requested an urgent webex meeting. ",03/May/23 7:53 PM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f] we have asked client do cleanup manually for now,"03/May/23 8:16 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 
Customer update

Is there more than one ISVA cluster configured to use this DB - or just a single cluster?

*No, there is only one Cluster.*

cleanupOnlyOnPrimaryMaster should be set to “true”

*mmfa.transaction.cleanupOnlyOnPrimaryMaster -->Set on True*
*oauth20.tokenCache.cleanupOnlyOnPrimaryMaster -->Set on TRUE*

What do they have set for *.cleanupThread.batchSize across the ISVA instances?

*THE PARAMETERS FROM BELOW ARE SET to ""0""*
*authsvc.stateMgmt.memory.cleanupThread.batchSize*
*deviceRegistration.cleanupThread.batchSize*
*oauth20.cleanupThread.batchSize*

In the your's DB2 instance - what do you have set for the following:

*DB2_SMS_TRUNC_TMPTABLE_THRESH --> No value set*
*DB2_OPT_MAX_TEMP_SIZE --> No value set*","03/May/23 9:05 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

We had a meeting with the customer on this issue, Customer is asking if the L3 team would join the call to resolve the issue as the severity level is 1. If possible can we have a Webex meeting with the customer?

The issue they are having is they have upgraded from ISAM 9.0.7 version to ISVA 10.0.4, DB2 transaction logs are fast, taking more space.

Yesterday they were experiencing no management for the DB logging, Disk space is full due to DB2 Transaction Logs are not getting cleaned up. Out of space in the db2 path and special folder

They are performing manual cleanup at the moment as Ayush mentioned in the previous comment.

Please find the uploaded xls file where some statements are very aggressively running on some tables that have data, slow appears. There db2 and ISAM are up but the application is not working where no request is coming up from the user as the disk space is high.



[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990%2F2023-05-03%2F&filepath=TS011946990%2F2023-05-03%2Fsql.xlsx|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990%2F2023-05-03%2F&filepath=TS011946990%2F2023-05-03%2Fsql.xlsx]",03/May/23 10:36 PM;5b15dbfa4d941a51f0da44dd;[~accountid:61409dc154762c006932ffc7] There is no one on call for isaml3 pager-duty during weekday. ,"04/May/23 12:32 AM;5b15d94b6256d01ad54eb020;In my opinion,  I don’t think this is something we can help with.  you should be contacting  DB2  L2/L3 for help at this at this point.  It looks like a tuning problem to me. ","04/May/23 7:48 AM;5b17571b91981f4fdde632c1;* Required from customer
** FIRST enable required monitor switch per ISAM Performance Tuning guide
*** Otherwise will not have required data to pursue this problem
**** There are no other alternatives
** Restart the database
** Then capture periodic db2 get snapshot for ALL on <database_name>
*** Preferably each day
** Until problem reoccurs
*** Then recapture current db2 get snapshot for ALL on <database_name>","04/May/23 3:02 PM;5c53d3ac23f5bf672621c868;**internal update 

15102|mmfa.transactionArchival.maxCompletedPerUser|FIM.TransactionArchival.MaxCompletedPerUser|50|N|N|Integer||mmfa

the value : 

TransactionArchival.MaxCompletedPerUser

has default set to 50



I know there has been improvement around it. 

but, still customer needs to review it in long term and see whether they really need value of 50  or  5 would be okay.","04/May/23 3:16 PM;5c53d3ac23f5bf672621c868;For other’s reference



* explainSQL.sh is located here
* [https://github.com/IBM-Security/performance/blob/master/IAM/scripts/ISIM_tuning_scripts/explainSQL.sh|https://github.com/IBM-Security/performance/blob/master/IAM/scripts/ISIM_tuning_scripts/explainSQL.sh|smart-link] ","05/May/23 2:03 PM;5c53d3ac23f5bf672621c868;[~accountid:5b17571b91981f4fdde632c1] [~accountid:5b232b2fd85e5b59b066f57f] 

As per your comment here : 

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4935?focusedCommentId=645329|https://cloudidentity.atlassian.net/browse/ISAMSUP-4935?focusedCommentId=645329|smart-link] 

Customer had uploaded query plans .



I see that  already have had accessed on to L3 system . Is that of any help?","05/May/23 8:45 PM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f] The client have performed the rollback on an environment that is identical with the Live Environment.

The automatic cleanup is enabled. Once we have installed the ISVA 10.0.4 only on the Primary node, the Primary DB is filling up. We have a support file just collected in that moment. Please find it attached.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990/2023-05-05/&filepath=TS011946990/2023-05-05/isva_10.0.4.0_20230505-111839_ciam-ps1.rbro.rbg.cc.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990/2023-05-05/&filepath=TS011946990/2023-05-05/isva_10.0.4.0_20230505-111839_ciam-ps1.rbro.rbg.cc.support]



meanwhile we have also requested the client to collect db2 snapshot after enabling db2 mon.","08/May/23 1:30 PM;5b232b2fd85e5b59b066f57f;[~accountid:61409dc154762c006932ffc7] - a few more questions: 

 1. When the customer upgraded the firmware to 10.0.4 - they also upgraded the DB2 HVDB schema - correct? 

2. What version of DB2 are they running? 

3. What setting do they have for the DB2 sortheap? 



For SUPPORT reference: 

[https://www.ibm.com/support/pages/tablespace-tda-files-not-being-deleted-and-are-filling-filesystem|https://www.ibm.com/support/pages/tablespace-tda-files-not-being-deleted-and-are-filling-filesystem]

[https://www.ibm.com/docs/en/db2/11.5?topic=parameters-sortheap-sort-heap-size|https://www.ibm.com/docs/en/db2/11.5?topic=parameters-sortheap-sort-heap-size|smart-link] ","08/May/23 7:40 PM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f] We have answers from customer for your questions

# When you upgraded the firmware to 10.0.4 - also have upgraded the DB2 HVDB schema - correct?                                    No, once we have upgraded the first Policy Server (Master), and start it, the DB2 is getting full. We have no time to run the HVDB schema because the db2 is already full (as per last support file). There were also cases, when we managed to run the HVDB Schema update, but the result was the same. 
# What version of DB2 are they running?                                                                                                                                    11.0.5
# What setting do they have for the DB2 sortheap? 

 Sort heap thres for shared sorts (4KB) (SHEAPTHRES_SHR) = AUTOMATIC(827259)

 Sort list heap (4KB)             (SORTHEAP) = AUTOMATIC(50000)","10/May/23 1:07 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 
Customer has provided the required details.

They have provided the results in a separate and isolate environment of ISAM, where they can do the same issue regarding the Automatic Cleanup.

* The Automatic Cleanup is enabled.
* The PS1 is upgraded to ISVA 10.0.4
* The database crushed after the upgrade.

In the attached file they shared:

* Support and Snapshot of the database before the upgrade.
* Support and Snapshot of the database after the upgrade.
* DBMon2 output before, during and after the upgrade.
All the parameters for monitoring are set to ON, to have all the information you need.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990%2F2023-05-09%2F&filepath=TS011946990%2F2023-05-09%2FDB2_Snapshots_Suport_file_Durring_and_after_upgrade.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990%2F2023-05-09%2F&filepath=TS011946990%2F2023-05-09%2FDB2_Snapshots_Suport_file_Durring_and_after_upgrade.zip]","10/May/23 12:26 PM;5c53d3ac23f5bf672621c868;# *ISVA case* TS011946990 -> Post product upgrade of ISVA from 907X to 104X , product Auto cleanup doesn't work
# Summary: Although Production customer has disabled auto cleanup and doing partial manual cleanup. Customer is able to recreate in lower environment wherein whey they upgrade the auto cleanup doesn't work.
# *Action Plan:*
# ISVA support to review and work on data uploaded by customer to assess whether an RCA could be given or further data is required.ISVA support is working on it
# ISVA support will provide a list of tables which is involved in cleanup so that customer give a current number of record counts and expired entries count from these tables
# Customer to provide db2look output from production/test env
# Customer has only 1 cleanup active out of 5 . Customer requested to give the table names and where rest of the cleanup could be done and the queries.
# Customer to resume 4 other cleanup immediately post getting information in point 4 above
# customer was told the importance of dbupdate schema to be applied in the environment and they need to do it asap.

explicitly, I have requested information about customer around expired entries in prod as well as test env.","10/May/23 12:50 PM;5af0531368ebd52c36627c3b;In the snapshot taken after the upgrade, here are the operations that contributed the most execution time.

{noformat}Dynamic SQL Snapshot Report

Dynamic SQL analysis for database: HVDB
Total number of statements processed: 168
Legend
   execTime - total seconds
   secPerExec - seconds per execution
   numExec - number of executions
   rowsR - number of rows read per execution
   rowsW - number of rows written per execution
   statement - statement executed

Skipping system statements, override this with the -a option
Skipping statements that executed in less than 0.100 second...
Truncating output to 0 characters...
  execTime secPerExec   numExec     rowsR     rowsW  statement
   24.1745     0.0015     15790         0         1  DELETE FROM OAUTH20_TOKEN_CACHE WHERE TOKEN_ID = ?
   35.8951    17.9476         2   1346642         0  SELECT TOKEN_ID FROM OAUTH20_TOKEN_CACHE WHERE LIFETIME < ((? - DATE_CREATED ) / 1000)
  426.2668     0.0001   4597991         0         0  SELECT STATE_ID FROM OAUTH20_TOKEN_CACHE WHERE STATE_ID = ?
  804.5232     0.0004   1935712         0         6  DELETE FROM OAUTH20_TOKEN_EXTRA_ATTRIBUTE WHERE STATE_ID = ?
  918.4412     0.0013    701599         2         4  DELETE FROM AUTHENTICATORS WHERE APP_INST_ID = ?
 1086.8001   271.7000         4    871802      2696  SELECT * FROM OAUTH_AUTHENTICATORS WHERE STATE_ID NOT IN (SELECT DISTINCT STATE_ID FROM OAUTH20_TOKEN_CACHE)
 2909.4713   969.8238         3         2         0  SELECT STATE_ID FROM OAUTH20_TOKEN_EXTRA_ATTRIBUTE
 {noformat}","10/May/23 12:50 PM;5af0531368ebd52c36627c3b;At the time that the snapshot was taken, there were 7 identical queries being executed.

{noformat}Executing applications

App 352 (holding 3 locks) is in UOW Executing with: SELECT * FROM MMFA_AUTH_TXN_DATA txn LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA attrs ON txn.TXN_ID = attrs.TXN_ID LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA_V vals ON attrs.ctx_attr_value_id = vals.ctx_attr_value_id WHERE TENANT_ID = ?
App 332 (holding 3 locks) is in UOW Executing with: SELECT * FROM MMFA_AUTH_TXN_DATA txn LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA attrs ON txn.TXN_ID = attrs.TXN_ID LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA_V vals ON attrs.ctx_attr_value_id = vals.ctx_attr_value_id WHERE TENANT_ID = ?
App 397 (holding 3 locks) is in UOW Executing with: SELECT * FROM MMFA_AUTH_TXN_DATA txn LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA attrs ON txn.TXN_ID = attrs.TXN_ID LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA_V vals ON attrs.ctx_attr_value_id = vals.ctx_attr_value_id WHERE TENANT_ID = ?
App 331 (holding 3 locks) is in UOW Executing with: SELECT * FROM MMFA_AUTH_TXN_DATA txn LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA attrs ON txn.TXN_ID = attrs.TXN_ID LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA_V vals ON attrs.ctx_attr_value_id = vals.ctx_attr_value_id WHERE TENANT_ID = ?
App 382 (holding 3 locks) is in UOW Executing with: SELECT * FROM MMFA_AUTH_TXN_DATA txn LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA attrs ON txn.TXN_ID = attrs.TXN_ID LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA_V vals ON attrs.ctx_attr_value_id = vals.ctx_attr_value_id WHERE TENANT_ID = ?
App 367 (holding 3 locks) is in UOW Executing with: SELECT * FROM MMFA_AUTH_TXN_DATA txn LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA attrs ON txn.TXN_ID = attrs.TXN_ID LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA_V vals ON attrs.ctx_attr_value_id = vals.ctx_attr_value_id WHERE TENANT_ID = ?
App 327 (holding 2 locks) is in UOW Executing with: SELECT * FROM MMFA_AUTH_TXN_DATA txn LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA attrs ON txn.TXN_ID = attrs.TXN_ID LEFT JOIN MMFA_AUTH_TXN_CTX_ATTRS_DATA_V vals ON attrs.ctx_attr_value_id = vals.ctx_attr_value_id WHERE TENANT_ID = ?
{noformat}","10/May/23 1:05 PM;5c53d3ac23f5bf672621c868;Thanks [~accountid:5af0531368ebd52c36627c3b] 



I am already on to check few things as few of the statement made by customer didn’t really fit how they should be running ideal env

* Check if they ran dbupdate and the indexes are present(db2look)
* check if they collect indexes and if they do reorg (as part of their db2 maintenance)
* check what cleanup were active during upgrade, seems this is a grey area where they are disabling and enabling only few cleanups( based on their own understanding) which could be the root of the issue
* check how many expired records in each related tables → I already sent them detailed commands to fetch those
* db2 support team will also be involved for this ","10/May/23 2:15 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:5c53d3ac23f5bf672621c868] - as discussed over Slack: 

A few thoughts:

# It sounds like at the moment, they don't get a chance to update the DB schema from 9.0.7 -> 10.0.4 before the DB dies; so they are in effect running 10.0.4 firmware with 9.0.7 DB schema. This is not supported and given it is such a jump from 9.0.7 to 10.0.4; it could be that having the DB schema at an older version when running 10.0.4 firmware could be contributing to the issue. They may need to turn off automated jobs or even sever the ISVA -> DB connection while they upgrade the firmware and the DB schema, then re-connect.
# In a similar vein to point #1, part of the issue could be that there is so much data in the DB that needs removing that the DB falls over when all the jobs initially trigger after an upgrade. Have they tried manually cleaning up before upgrade?
# I'm no DB2 expert - but it sounds like they have not set DB2 properties to control the growth and cleanup of DB2 temp files. I understand that this doesn't explain why the files are being created in the first place (although it might) and why the difference in behaviour to 9.0.7 - but at least it would allow the customer to control the situation and potentially ensure the environment continues functioning.
# Has the customer been able to isolate which cleanup job is causing the issue? If we could narrow this down - it would make our job a lot easier trying to understand why this is happening and how to fix it.","10/May/23 2:32 PM;5c53d3ac23f5bf672621c868;thanks [~accountid:5b232b2fd85e5b59b066f57f] 

I need to make an assessment based on these action plan and then only can answer all your queries

I have already set things in motion  last night and requested cleanup details and expired entries  in the env. with good details provided to customer on what tables are used during cleanup and the query details around them



{noformat}I am already on to check few things as few of the statement made by customer didn’t really fit how they should be running ideal env

Check if they ran dbupdate and the indexes are present(db2look)

check if they collect indexes and if they do reorg (as part of their db2 maintenance)

check what cleanup were active during upgrade, seems this is a grey area where they are disabling and enabling only few cleanups( based on their own understanding) which could be the root of the issue

check how many expired records in each related tables → I already sent them detailed commands to fetch those

db2 support team will also be involved for this {noformat}","10/May/23 11:10 PM;5c53d3ac23f5bf672621c868;[~accountid:5af0531368ebd52c36627c3b] 

1.could you help on what would be recommended runstat and reorg way of running for   ISVA HVDB?

2.based on your analysis, I am trying to get the current number of records and records required to do cleanup. Is there anything else needs to be followed up based on your action plan or any analysis needed from DB2 support?



thanks

Tushar","10/May/23 11:31 PM;5c53d3ac23f5bf672621c868;[~accountid:5af0531368ebd52c36627c3b] [~accountid:5b232b2fd85e5b59b066f57f] 



--This is one of the critical stats received from the customer’s env

{noformat}Below you can find the number of total records for the tables involved in cleanup.

As we expected we can't run the queries for counting the expired rows because when we execute the selects the CPU is going up to 100%, so we will stay at the previous plan which involves creating a parallel database from production backup file.

The statistics will be provided tomorrow.





Table                                                            TOTAL RECORDS

DMAP_ENTRIES                                               2229291

OAUTH20_TOKEN_CACHE                           4919042

OAUTH20_TOKEN_EXTRA_ATTRIBUTE   25918836

OAUTH_AUTHENTICATORS                         1215328

MMFA_AUTH_TXN_DATA                              38283637

RBA_USER_ATTR_SESSION                        0

AUTH_TXN_OBL_DATA                                 88891

RBA_DEVICE                                                   0



1.do you do a manual runstats or auto runstate on the hvdb ?

A: db2 is running automatic runstats. 



2.do you do a manual reorg?

A: we don't do it regularly. we did it twice in 6 years.



{noformat}



cleanup is going to be challenging for this customer.","11/May/23 12:41 AM;5af0531368ebd52c36627c3b;How many processors do they have allocated to their database server?  A single SQL query would only tie up a single processor, so it shouldn’t take the whole server to 100%.","11/May/23 12:46 AM;5af0531368ebd52c36627c3b;Since they’re using automatic runstats, then the statistics should be fairly current and they can just use

{noformat}db2 reorgchk current statistics on table all{noformat}

to see if any tables or indexes are in need of a reorg.","11/May/23 12:51 AM;5af0531368ebd52c36627c3b;The perfcheck_runstats.sh script will report on when runstats was done on each table and index.

It only reports the times and the statistics from the last runstats, it doesn’t actually do a runstats.

[https://github.com/IBM-Security/performance/blob/master/IAM/scripts/ISIM_tuning_scripts/perfcheck_runstats.sh|https://github.com/IBM-Security/performance/blob/master/IAM/scripts/ISIM_tuning_scripts/perfcheck_runstats.sh|smart-link] ","11/May/23 8:47 AM;5b17571b91981f4fdde632c1;* What is “live” and “parallel live” environments
** They are not identical
*** Attached two files to this work item comparing 2023-05-10 data
**** Live_parallellive.index.c10
***** *.index files
**** Live_parallellive.ddl.c10
***** *.ddl files
****** Which had to be adjusted to get best difference
** What is the reason why they are not identical?
* Which environment(s) does the problem happen in?","12/May/23 9:09 PM;5c53d3ac23f5bf672621c868;* Current Status from customer
** Customer has performed cleanup in the production environment last time and provided previous and current counts
** Customer couldn’t do runstat/rerorg and still pending to check whether reorg/runstat needed as per the script provided by Dave B.
** Here are the counts
** !image-20230512-105740.png|width=691,height=239!
[~accountid:5b17571b91981f4fdde632c1] To your questions
*** live  is a current production environment with dbupdate applied(I created those files to compare index, I didn’t find difference ) but found a single different of an index on username 
*** {noformat}CREATE INDEX ""ISAMRDB "".""IDX_MMFA_TXN_UN"" ON ""ISAMRDB "".""MMFA_AUTH_TXN_DATA""
                (LOWER(USERNAME) ASC)

                COMPRESS NO
                INCLUDE NULL KEYS ALLOW REVERSE SCANS;{noformat}
*** parallel live is a pre prod env
**** has similar configuration but the way they prepare is is this
***** has ISVA appliance at 10.0.4.0 (I can’t comment on how exactly it matches with production but they are able able to test )
***** they copy db2 data of production into pre prod(parallel env) and then they enable Autocleanup and reproduce the issue
****** *_The current action plan on this item_*
****** Customer has carried out the cleanup in production and they will replicate that data into pre prod
****** they will perform db2 maintenance(runstate,reorg,runstat)
****** then they will reactivate Autocleanup and run test scenarios. Incase they face an issue they will report with db2mon and db2snapshot data from parallel (pre prod env)","12/May/23 9:15 PM;5c53d3ac23f5bf672621c868;* Putting into a Separate thread
* There has been a major restructure of how cleanup is performed at 9071 IF5 and at 10.0.4.0 on MMFA_AUTH_TXN_DATA
* AT 9071 IF5 there was not an external manual cleanup on MMFA_AUTH_TXN_DATA
* Cleanup was done in the code with focus on parameters mmfa.transactionArchival.maxCompletedPerUser
* There were issues related to performance
** the following story help to better the performance
***  [https://cloudidentity.atlassian.net/browse/ISAMDEV-6640|https://cloudidentity.atlassian.net/browse/ISAMDEV-6640|smart-link] 
*** [https://cloudidentity.atlassian.net/browse/ISAMDEV-6658|https://cloudidentity.atlassian.net/browse/ISAMDEV-6658|smart-link] 
*** This introduced the parameter mmfa.transactionArchival.cleanupInterval at 1031(got carried to 1040)
*** When customer upgraded. then this cleanup came in picture
*** Although, there were cleanup active at 9071 IF5 
*** So there has been change in how Autocleanup worked pre 10.0.4.0 upgrade and post 10.0.4.0 upgrade",15/May/23 8:34 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] appreciate eyes on this one today. ,"15/May/23 2:30 PM;5b232b2fd85e5b59b066f57f;Waiting for feedback from customer after activating cleanup job after manual cleanup. 

Given they still have 37m records (down from 38m) after manual cleanup, I suspect the auto cleanup will still have issues. 

[~accountid:5c53d3ac23f5bf672621c868] - let me know once we hear back. ","15/May/23 5:21 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

Customer have shared the cleanup_scripts_used_by_Raiffeisen.tar.gz which contains the cleanup scripts they are using. Following cleanup scripts execution we have received a series of complains from our customers that they are not able to authorized transactions by using biometrics.

Customer also mentioned that the biometrics authorization is developed based on OATUH20 attributes. From their investigation for the customers impacted they were not able to obtain from ISAM the biometrics related attributes (tenant_id , tenant_id2, biometricsAuthN, biometricsAuthZ).

Here is the rest of the information asked:

*-View creation :*

CREATE VIEW RBRO_MMFA_TXN_CLEANUP AS (SELECT TXN_ID, DATE_LAST_USED, USERNAME, RANK() OVER(PARTITION BY USERNAME ORDER BY DATE_LAST_USED DESC) txn_age_rank FROM MMFA_AUTH_TXN_DATA WHERE RESULT_STATE!='pending')

-the details of the 2 tables used in the cleanup process for MMFA_TXN_DATA :



{noformat}describe table RBRO_MMFA_TXN_CLEANUP_T

                               Data type                    Column

Column name                    schema   Data type name     Length    Scale Nulls

------------------------------- --------- ------------------- ---------- ----- ------

TXN_ID                         SYSIBM   VARCHAR                   256    0 Yes

DATE_LAST_USED                 SYSIBM   TIMESTAMP                  10    6 No

USERNAME                       SYSIBM   VARCHAR                   256    0 Yes

TXN_AGE_RANK                   SYSIBM   BIGINT                      8    0 No{noformat}



{noformat}describe table RBRO_2_MMFA_TXN_CLEANUP_T

                               Data type                    Column

Column name                    schema   Data type name     Length    Scale Nulls

------------------------------- --------- ------------------- ---------- ----- ------

TXN_ID                         SYSIBM   VARCHAR                   256    0 Yes

DATE_LAST_USED                 SYSIBM   TIMESTAMP                  10    6 No

USERNAME                       SYSIBM   VARCHAR                   256    0 Yes

TXN_AGE_RANK                   SYSIBM   BIGINT                      8    0 No{noformat}





[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990/2023-05-12/&filepath=TS011946990/2023-05-12/cleanup_scripts_used_by_Raiffeisen.tar.gz|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011946990&path=TS011946990/2023-05-12/&filepath=TS011946990/2023-05-12/cleanup_scripts_used_by_Raiffeisen.tar.gz]","15/May/23 5:49 PM;5c53d3ac23f5bf672621c868;customer has mentioned below comment



Following cleanup scripts execution we have received a series of complains from our customers that they are not able to authorized transactions by using biometrics.



I would like to mention that the biometrics authorization is developed based on OATUH20 attributes. From our investigation for the customers impacted we where not able to obtain from ISAM the biometrics related attributes (tenant_id , tenant_id2, biometricsAuthN, biometricsAuthZ).



If these are oauth20 attributes, then they are stored as part of oauth extra attributes I am yet to see how they are removed.","15/May/23 5:52 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] 



could you take a look at /ecurep/sf/TS011/946/TS011946990/2023-05-12/cleanup_scripts_used_by_Raiffeisen.tar.gz_unpack/cleanup_scripts/



these are the cleanup commands they ran.



could you help to look into whether these are inline","15/May/23 11:07 PM;5c53d3ac23f5bf672621c868;[~accountid:5b17571b91981f4fdde632c1] [~accountid:5af0531368ebd52c36627c3b] 

Nick has helped customer with cluster restart and that seems to have worked and avoid any outage so far. and restart doesn’t impact the application.","17/May/23 7:55 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5b17571b91981f4fdde632c1] [~accountid:5af0531368ebd52c36627c3b] 

here is the box link about RCA

[https://ibm.box.com/s/d1nioap227sdlhmx6zjmd14azcwztpra|https://ibm.box.com/s/d1nioap227sdlhmx6zjmd14azcwztpra|smart-link] ",18/May/23 4:00 PM;5b15d9ef27631840ea300110;[~accountid:5b232b2fd85e5b59b066f57f] can you review the draft by Tushar and give a feedback so this RCA can be shared with customer. This needs to be sent urgently as they have regulatory requirements.,18/May/23 8:58 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9ef27631840ea300110] - doc looks good. ,22/May/23 12:33 PM;5ac57757d9a96536d1f0daa9;[~accountid:5c53d3ac23f5bf672621c868] [~accountid:5b17571a82e05b22cc7d5d9e] any outstanding actions from the L3 team regarding this Jira iitem? Can it be set to Done?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Appliance went unconfigured,ISAMSUP-5228,311615,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Motiur Rahman,5b15d9e581c3df12acf53c4a,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,13/Jul/23 4:43 AM,14/Jul/23 3:09 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"Bank of Montreal is running 10.0.3.1.    

Based on their description…
”The ESX Host crashed due to defective DIMM and this VM was gracefully migrated to another ESX Host in this Cluster ESX HA kick in to move VM.

VM was restarted by VMWare HA to another ESX Host in Cluster “

After this move, one of the ISVA appliances came up in unconfigured mode.

Looking in the logs, I see it had problems with the adapters

Jul 10 07:05:20 mesa_control[662]: Error: Bootstrap from settings failed

Jul 10 07:05:20 mesa_control[662]: Creating failed policy snapshot

Jul 10 07:05:20 mesa_config[2785]: Signature verification passed for file: /usr/sbin/mesa_config

Jul 10 07:05:20 mesa_config[2785]: Creating snapshot: /tmp/tmp.5b8IGO

Jul 10 07:05:20 mesa_config[2785]: Invoking Snapshot Pre functions

Jul 10 07:05:20 mesa_config[874]: Executing trigger 'ipv6_auto_address_active' for module events

Jul 10 07:05:20 mesa_config[874]: Trigger 'ipv6_auto_address_active' succeeded

Jul 10 07:05:20 mesa_config[874]: Executing trigger 'ipv6_auto_address_active' for module ntpd

Jul 10 07:05:20 mesa_config[874]: Trigger 'ipv6_auto_address_active' succeeded

Jul 10 07:05:20 mesa_config[874]: Executing trigger 'ipv6_auto_address_active' for module gw_net

Jul 10 07:05:20 mesa_eventsd[699]: Loading config

Jul 10 07:05:20 mesa_config[874]: Error: Could not find interface configuration for eth0

Jul 10 07:05:20 mesa_config[874]: Error: Trigger 'ipv6_auto_address_active' failed for module: gw_net

Jul 10 07:05:20 mesa_config[874]: Executing trigger 'ipv6_auto_address_active' for module snmpd

Jul 10 07:05:20 mesa_config[874]: Trigger 'ipv6_auto_address_active' succeeded

Jul 10 07:05:21 mesa_config[840]: Executing trigger 'ipv6_auto_address_active' for module events

Jul 10 07:05:21 mesa_config[840]: Trigger 'ipv6_auto_address_active' succeeded

Jul 10 07:05:21 mesa_config[840]: Executing trigger 'ipv6_auto_address_active' for module ntpd

Jul 10 07:05:21 mesa_config[840]: Trigger 'ipv6_auto_address_active' succeeded

Jul 10 07:05:21 mesa_config[840]: Executing trigger 'ipv6_auto_address_active' for module gw_net

Jul 10 07:05:21 mesa_eventsd[699]: Loading config

Jul 10 07:05:21 mesa_config[840]: Error: Could not find interface configuration for lo

Jul 10 07:05:21 mesa_config[840]: Error: Trigger 'ipv6_auto_address_active' failed for module: gw_net

Jul 10 07:05:21 mesa_config[840]: Executing trigger 'ipv6_auto_address_active' for module snmpd

Jul 10 07:05:21 mesa_config[840]: Trigger 'ipv6_auto_address_active' succeeded

Jul 10 07:05:21 mesa_config[2785]: Invoking Snapshot Post functions

Jul 10 07:05:21 mesa_config[2785]: Found version within /etc/settings.sys: 10.0.3.1

Jul 10 07:05:21 mesa_control[662]: GLGSS9001I:: GLG_events:: |interface=CLI,user=Unknown,file=isva_10.0.3.1_20230710-070520.18534_isambcclprdsc01.srv.bmogc.net.snapshot

|

Jul 10 07:05:21 mesa_control[662]: Restoring factory defaults

Jul 10 07:05:21 mesa_control[662]: Restore factory defaults succeeded


It seems that ISVA got lost in the change and somehow wasn’t able to line up the network config.     What sort of checking is ISVA doing here that is getting lost?    

They sent in an old support file which can be seen at 
/ecurep/sf/TS013/563/TS013563066/2023-07-12/isva_10.0.3.1_20221028-003814_isambcclprdsc01.srv.bmogc.net.support_unpack/

and a new one after the problem, which can be seen at 
/ecurep/sf/TS013/563/TS013563066/2023-07-10/isva_10.0.3.1_20230710-121945_isambcclprdsc01.srv.bmogc.net.support_unpack/


I checked, and the mac address seems to be the same in both for eth0.    What else is ISVA using that got messed up?     Why did this one appliance go unconfigured, while the others didn’t?     This is what BMO is asking.



Thanks
Daniel
",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013563066,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,,,,Bank of Montreal,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1djjz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-07-13 16:44:59.0,,,,,"14/Jul/23 2:44 AM;5b15d9e581c3df12acf53c4a;We were working on this issue for a while, L2 and L3 were not able to reproduce the issue at all.

Unfortunately, the area where it is failing, that area of the code does not have any meaningful existing trace points so we were not able to investigate the issue further.

Under the Jira : [https://cloudidentity.atlassian.net/browse/ISAMSUP-4034|https://cloudidentity.atlassian.net/browse/ISAMSUP-4034|smart-link]

we provided the debug fixpack. ( No code fix but we added bunch of extra trace points ) so that once installed, if the appliance fails then it will capture more traces which, would lead us to the root cause.

Unfortunately, either Customer did not install or it did not fail with the debug fixpack installed.

In the meantime, we did work with development and have them done the following:

[https://cloudidentity.atlassian.net/browse/ISAMDEV-9588|https://cloudidentity.atlassian.net/browse/ISAMDEV-9588|smart-link]

i.e. the above Jira item added those missing trace points around the area of the code where possible failure is occurring.

This item is in ISVA 10.0.6.0

Now, if the same issue happens in ISVA 10.0.6.0, hopefully , we will get better messages in /var/log/messages by default ( i.e. without debug.level=2 )

Now, those traces points are not meant to pinpoint the issue but it will take us closure to identifying the root cause and hopefully will lead to the exact solution.

 

Unfortunately, backporting the fix is not simple, hopefully, once of the customer will install ISVA 10.0.6.0 where this issue occurs and we will get some better traces.

===================================================================

We had few of these similar issues over the years. As of now, if it fails similarly on 10.0.6.0, only and only then we will get a meaningful traces ( default trace, no need for debug.level=2) .

All the failures that happened so far, we could not pin point any reason what so ever ( unfortunately ).",14/Jul/23 3:09 AM;5b15d9a0dda5f94d06b985b3;Thanks Motiur.    I’ll see what they say.   We know how reasonable BMO is. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA Backup Firmware Problem,ISAMSUP-5210,310868,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,William Hannon Jr,5b17571b91981f4fdde632c1,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,07/Jul/23 2:00 AM,14/Jul/23 3:15 AM,14/Jul/23 2:47 PM,,,,,0,,,,"

With SSH 

isva1:firmware> backup
Warning: This operation will require that the appliance is rebooted.
Are you sure you want to back up the active firmware image?
Enter 'YES' to confirm: YES
mount: mounting /dev/sda5 on /tmp/mount.vjEbg4 failed: Device or resource busy
isva1:firmware>



Creating a back up via LMI is no different



Disk Partition looks fine


{noformat}Filesystem                Size      Used Available Use% Mounted on
/dev/sda6                61.9G     28.4G     30.4G  48% /
proc                         0         0         0   0% /proc
sysfs                        0         0         0   0% /sys
mdev                      3.9G      4.0K      3.9G   0% /dev
devpts                       0         0         0   0% /dev/pts
tmpfs                     3.9G    152.0K      3.9G   0% /dev/shm
tmpfs                     3.9G    152.0K      3.9G   0% /var/run
/dev/sda1               189.7M    140.3M     35.4M  80% /boot
{noformat}



grub2 looks fine too


{noformat}/boot:
total 20
drwxr-xr-x    6 root     root          1024 Oct 11  2022 .
drwxr-xr-x   20 root     root          4096 Jul  5 21:18 ..
drwxr-xr-x    2 root     root          1024 Dec  2  2021 Part1
drwxr-xr-x    2 root     root          1024 Dec  2  2021 Part2
lrwxrwxrwx    1 root     root            11 Dec  2  2021 grub -> /boot/grub2
drwxr-xr-x    4 root     root          1024 Jul  5 21:18 grub2
drwx------    2 root     root         12288 Dec  2  2021 lost+found

/boot/grub2:
total 29
drwxr-xr-x    4 root     root          1024 Jul  5 21:18 .
drwxr-xr-x    6 root     root          1024 Oct 11  2022 ..
-rw-r--r--    1 root     root             0 Dec  2  2021 comment1
-rw-r--r--    1 root     root             0 Dec  2  2021 comment2
drwxr-xr-x    2 root     root          1024 Dec  2  2021 fonts
-rw-r--r--    1 root     root          6909 Jul  5 21:17 grub.cfg
lrwxrwxrwx    1 root     root            20 Dec  2  2021 grub.conf -> /boot/grub2/grub.cfg
-rw-r--r--    1 root     root          1024 Jul  5 21:17 grubenv
drwxr-xr-x    2 root     root          9216 Dec  2  2021 i386-pc
-rw-r--r--    1 root     root           151 Oct 11  2022 info1
-rw-r--r--    1 root     root           151 Jul  5 21:18 info2
-rw-r--r--    1 root     root          6909 Jul  5 21:17 menu.lst



{noformat}



Last attempt on 05/07 around 21:10
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012012362&path=TS012012362%2F2023-07-05%2Fsupport.zip_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012012362&path=TS012012362%2F2023-07-05%2Fsupport.zip_unpack%2F]


I asked the  get_boot_data.fixpack
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012012362&path=TS012012362%2F2023-07-05%2Fdata.zip_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012012362&path=TS012012362%2F2023-07-05%2Fdata.zip_unpack%2F]

Not sure how to analyze the *data.zip* data
Hope I can get some assistance from L3",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012012362,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,SCHMIDT GROUPE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1dezr:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-07-10 21:52:18.526,,,,,"07/Jul/23 2:03 AM;614dd52af1c1740068534813;I know when we upgrade the ISVA firmware the first thing that happens is that the ""inactive partition"" is mounted, formatted, and then the new firmware image is written to that partition.  But, the customer is worried that there is a possibility that whatever the issue is which is preventing the backup operation from completing may also cause a problem with the firmware upgrade.","11/Jul/23 7:52 AM;5b17571b91981f4fdde632c1;* Has this problem been seen before
** {noformat}(project = 'ISAM Support' || project = 'ISAM Development') &&	( (summary ~ 'resource busy' || text ~ 'resource busy') ) && ( (summary ~ 'firmware' || text ~ 'firmware') && (summary ~ 'backup' || text ~ 'backup') ){noformat}","11/Jul/23 7:55 AM;5b17571b91981f4fdde632c1;* Why are there ECUREP files from over 5 months ago
** Has this SalesForce case been morphing?","13/Jul/23 12:42 AM;614dd52af1c1740068534813;* _Why are there ECUREP files from over 5 months ago_
I got the case from someone else with a month without updates. Also customer takes too long to give the proper info/files. I have been trying to get the get_boot_data.fixpack since May.
* Has this problem been seen before
I have found “firmware backup” issues before but none of the solutions worked for this case, ie: 
 - fully power down the appliance and power it back
 - Delete logs and tmp files
 - removing the ISVA from the cluster
 - /dev/sda5 mounted(not the case)
 - grub2 partition issue( Not sure if it’s the case)

Also have found some cases that customers didn't want to pursue on this ie
[https://cloudidentity.atlassian.net/browse/ISAMSUP-3736|https://cloudidentity.atlassian.net/browse/ISAMSUP-3736|smart-link] ","13/Jul/23 4:51 AM;614dd52af1c1740068534813;Wondering if I can ask the customer to try unmount_install_part.fixpack
[https://cloudidentity.atlassian.net/browse/ISAMSUP-4376|https://cloudidentity.atlassian.net/browse/ISAMSUP-4376|smart-link] 

It seems the fixpack works when /dev/sda5 is mounted, which is not the case for this customer but, it might not have clearly unmounted it?

","13/Jul/23 4:57 AM;5b17571b91981f4fdde632c1;* Thanks for answering the questions
** Really helps

{quote}It seems the fixpack works when /dev/sda5 is mounted, which is not the case for this customer but, it might not have clearly unmounted it?{quote}

* Nice work
** I observed the mounting over time
*** Next step is carefully verifying no unmount","13/Jul/23 5:03 AM;614dd52af1c1740068534813;It seems when we run a firmware backup, we see this from the var/log/message

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012012362&path=TS012012362%2F2023-07-05%2Fsupport.zip_unpack%2Fisva_10.0.2.0_20230705-212148_isva1.support_unpack%2Fvar%2Flog%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012012362&path=TS012012362%2F2023-07-05%2Fsupport.zip_unpack%2Fisva_10.0.2.0_20230705-212148_isva1.support_unpack%2Fvar%2Flog%2F]

{noformat}Jul  5 21:14:01 kernel: Command line: BOOT_IMAGE=/Part2/bzImage root=/dev/sda6 ro IssBootDevice=/dev/sda1 IssSaveDefault=2 IssBackupTo=/dev/sda5 quiet mesa_part2_args softlockup_panic=0 vga=0x303 logo.nologo LANG=en_US.utf8 console=tty0 console=ttyS0
Jul  5 21:14:01 kernel: Disabled fast string operations
Jul  5 21:14:01 kernel: x86/fpu: Supporting XSAVE feature 0x001: 'x87 floating point registers'
Jul  5 21:14:01 kernel: x86/fpu: Supporting XSAVE feature 0x002: 'SSE registers'
Jul  5 21:14:01 kernel: x86/fpu: Supporting XSAVE feature 0x004: 'AVX registers'
{noformat}


I can see the same message from my lab when running a firmware backup (successful one)


{noformat}Jul 12 18:46:59 kernel: Command line: BOOT_IMAGE=/Part2/bzImage root=/dev/sda6 ro IssBootDevice=/dev/sda1 IssSaveDefault=2 IssBackupTo=/dev/sda5 quiet mesa_part2_args softlockup_panic=0 vga=0x303 logo.nologo LANG=en_US.utf8 console=tty0 console=ttyS0
Jul 12 18:46:59 kernel: Disabled fast string operations
Jul 12 18:46:59 kernel: x86/fpu: Supporting XSAVE feature 0x001: 'x87 floating point registers'
Jul 12 18:46:59 kernel: x86/fpu: Supporting XSAVE feature 0x002: 'SSE registers'
Jul 12 18:46:59 kernel: x86/fpu: Supporting XSAVE feature 0x004: 'AVX registers'


{noformat}


Trying to follow the traces to find something wrong to me but no joy.","13/Jul/23 5:09 AM;5b17571b91981f4fdde632c1;* They match 100%
** Except for Date/Time
* For your scenario after done
** What disks remain mounted?
** Without reboot
*** Are you able to make another firmware_backup?","14/Jul/23 3:15 AM;614dd52af1c1740068534813;_They match 100%_

* _Except for Date/Time_

Sorry, I didn't explain well.
The date *Jul 5* , is from the customer's files

The date *Jul 12* , is from my lab

_For your scenario after done_

* _What disks remain mounted?_

From my lab, it looks the same as the customer.

{noformat}Filesystem                Size      Used Available Use% Mounted on
/dev/sda6                 8.7G      3.0G      5.3G  36% /
proc                         0         0         0   0% /proc
sysfs                        0         0         0   0% /sys
mdev                      1.9G      4.0K      1.9G   0% /dev
devpts                       0         0         0   0% /dev/pts
tmpfs                     1.9G    148.0K      1.9G   0% /dev/shm
tmpfs                     1.9G    148.0K      1.9G   0% /var/run
/dev/sda1               189.7M    150.7M     24.9M  86% /boot
{noformat}



* _Without reboot_
** _Are you able to make another firmware_backup?_
Yes, from my Iab can do firmware_backup anytime with no issues.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
"""Permission denied"" message under ""db_trace.log"" when creating snapshot from LMI",ISAMSUP-5207,310557,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,06/Jul/23 3:23 AM,11/Jul/23 10:57 AM,14/Jul/23 2:47 PM,,,,,0,,,,"The customer getting this message when creating snapshots from LMI



{noformat}1680551030  7961 CL: createSnapshotCommon(/tmp/tmp.LMf4NH, 0)
could not change directory to ""/opt/ibm/wlp/usr/servers/default"": Permission denied
could not change directory to ""/opt/ibm/wlp/usr/servers/default"": Permission denied
{noformat}



Creating it from the CLI does not cause the same message.



I tested in my lab and got the same results even in the latest ISVA 10.0.6



One thing I notice is, if the ISVA is part of a cluster, we don’t get that message when creating snapshots from LM",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013394662,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,SOCIEDAD ESTATAL DE CORREOS Y TELEGRAFOS S.A,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1dd3z:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-07-06 02:04:31.185,,,,,"06/Jul/23 3:27 AM;614dd52af1c1740068534813;It does not seem to be an issue, as I can restore the snapshot created from LMI even when I get this message.
The customer wants to know if any change can be made to not get this message.
Or make sure that this is not a problem, and we can do the snapshot from the LMI even if the message is out,  and does not create any problem when retrieving a snapshot and applying it to the ISVA.",06/Jul/23 12:04 PM;5b232b2fd85e5b59b066f57f;This should not cause any issue. Is the customer seeing a problem with the DB contents of their snapshot?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
"""JWT_Token_Generation_Issue_10040"" invalidated previous fixpack ""IJ44133_10040IF1""",ISAMSUP-5201,310060,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,03/Jul/23 10:33 PM,07/Jul/23 5:43 PM,14/Jul/23 2:47 PM,07/Jul/23 5:43 PM,,,,0,,,,"The customer made a change in production by adding the fixpack:
JWT_Token_Generation_Issue_10040
To fix the error “DPWWA3155E An error occurred while attempting to generate the JSON Web Token (JWT): invalid argument”

After this, started seeing this:


2023-06-28-13:08:54.859+02:00I----- 0x1005B3B5 webseald ERROR acl authzn HTTPXSLTTransformationRule.cpp 531 0x7f807171e700 -- HPDAC0949E   Validation of the rule text for rule object ""HTTPXSLTTransformationEinge::processResponseByResource"" failed. Error code 0x1005b3b4 was returned along with error message ""--empty--"".

2023-06-28-13:08:58.506+02:00I----- 0x38AD5425 webseald ERROR wiv socket WsSslListener.cpp 1979 0x7f80713d1700 -- DPWIV1061E   Could not write to socket (406)

 -- Fatal Error.Occurred at unknown file, line 1, column 39.  An exception occurred! Type:UTFDataFormatException, Message: invalid byte 2 (r) of a 2-byte sequence.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013454952&path=TS013454952%2F2023-06-28%2Fisva_10.0.4.0_20230628-131621_ISAM-DMZ1-PROD.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013454952&path=TS013454952%2F2023-06-28%2Fisva_10.0.4.0_20230628-131621_ISAM-DMZ1-PROD.support_unpack%2F]



Applied ""JWT_Token_Generation_Issue_10040"" and it seems invalidated previous applied fixpack  ""IJ44133_10040IF1"" which fix transformation script error when response header that contains nordic characters.



Once the customer Installed the “IJ44133_10040IF1” again, they stopped seeing errors in logs 


re-applied the fixpack in  the morning around 9:40 , 30th June

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013454952&path=TS013454952%2F2023-06-30%2Fisva_10.0.4.0_20230630-150151_ISAM-DMZ1-PROD.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013454952&path=TS013454952%2F2023-06-30%2Fisva_10.0.4.0_20230630-150151_ISAM-DMZ1-PROD.support_unpack%2F]",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013454952,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,TIETOEVRY NORWAY AS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1da6v:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-07-04 22:38:51.973,,,,,05/Jul/23 8:38 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5af4ad7d4dd24c579110120b] do you know who was the original engineer that created identified fix pack? ,"05/Jul/23 9:24 AM;5b15d9517dab4c51f61b5190;Motiur did the Token Generation fixpack

I did the IJ44133 change

Motiur  also created a  10.0.4.0 IF1  WT_Token_Generation_Issue_10040 - but as it was done around the same time as the IJ44133 fixpack I am doubtful

it includes the Token Generation change

I have since backported the Token Generation change into a 10.0.4.0 IF1 branch

That branch also includes JWT kid changes IJ43866 that asha did. There was a subsequent issue found by development which has also been backported

for the JWT kid V2 fix

I need to check but the JWT kid V2 fix may already contain everything needed","06/Jul/23 3:15 AM;614dd52af1c1740068534813;Thanks [~accountid:5b15d9517dab4c51f61b5190] . As far as I understood you will check if “JWT kid V2 fix “  contains both “WT_Token_Generation_Issue_10040” and “IJ44133_10040IF1” ?
Please let me know if the customer can use that “JWT kid V2 fix “ ","07/Jul/23 5:43 PM;614dd52af1c1740068534813;The customer closed the case saying that planning to upgrade to 10.0.6. hence closing the JIRA.

Thx",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
10.0.5 Appliance stopped processing with OOM dsc & OOM Java errors.,ISAMSUP-5196,309645,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,30/Jun/23 2:59 AM,12/Jul/23 9:30 AM,14/Jul/23 2:47 PM,,,,,0,Growth,,,"OOM java crashed the second time as opposed to Dsc the first time. When Dsc stopped the first time; the appliance recovered itself after about four minutes. snippets from logs are shown below: 

Node 1:

{{Jun 7 22:15:39 kernel: oom-kill:constraint=CONSTRAINT_NONE,nodemask=(null),cpuset=/,mems_allowed=0,global_oom,task_memcg=/,task=dscd,pid=1168,uid=0 Jun 7 22:15:39 kernel: Out of memory: Killed process 1168 (dscd) total-vm:8567084kB, anon-rss:6597548kB, file-rss:0kB, shmem-rss:0kB, UID:0 pgtables:15252kB oom_score_adj:0 Jun 7 22:15:40 kernel: TCP: request_sock_TCP: Possible SYN flooding on port 443. Sending cookies. Check SNMP counters. Jun 7 22:15:40 wga_notifications: WGAWA0647W:: WGA_events:: |<no-params>,msg=Local clock is not synchronized.| Jun 7 22:15:41 kernel: oom_reaper: reaped process 1168 (dscd), now anon-rss:0kB, file-rss:0kB, shmem-rss:0kB Jun 7 22:15:41 sshd[1815]: error: connect_to 127.0.0.1 port 2026: failed. Jun 7 22:15:46 sshd[1815]: Last message repeated 107 times Jun 7 22:16:08 wga_notifications: Error: An attempt to contact the update notification service has failed. (host=updates.verify.ibm.com, curlRc=6 (Couldn't resolve host name)) Jun 7 22:16:08 wga_notifications: WGAWA0678W:: WGA_events:: |<no-params>,msg=Due to consecutive failures, the appliance will not attempt to contact the update notification service for 24 hours.| Jun 7 22:16:08 mesa_eventsd[786]: Error: No '=' character found after position 46 of 0=<no-params>,msg=Due to consecutive failures, the appliance will not attempt to contact the update notification service for 24 hours. Jun 7 22:16:10 wga_notifications: WGAWA0652I:: WGA_events:: |<no-params>,msg=The appliance has been updated with NTP configuration information.| Jun 7 22:16:42 sshd[1815]: error: connect_to 127.0.0.1 port 2026: failed. Jun 7 22:16:43 sshd[1815]: Last message repeated 109 times Jun 7 22:17:10 wga_notifications: WGAWA0650I:: WGA_events:: |1=33%,msg=The CPU utilization has fallen below the configured threshold: 33%| Jun 7 22:17:15 sshd[1815]: error: connect_to 127.0.0.1 port 2026: failed. Jun 7 22:20:15 sshd[1815]: error: connect_to 127.0.0.1 port 2026: failed. Jun 7 22:25:42 sshd[1815]: error: connect_to 127.0.0.1 port 2026: failed. Jun 7 22:30:42 sshd[1815]: error: connect_to 127.0.0.1 port 2026: failed. }}

Node 2:

{{Jun 7 22:14:59 sshd[43334]: error: connect_to 127.0.0.1 port 2026: failed. Jun 7 16:15:07 : process '/sbin/getty -L 9600 ttyS0 vt100' (pid 113911) exited. Scheduling for restart. Jun 7 22:15:08 wga_notifications: Error: An attempt to contact the update notification service has failed. (host=updates.verify.ibm.com, curlRc=6 (Couldn't resolve host name)) Jun 7 22:15:08 wga_notifications: WGAWA0678W:: WGA_events:: |<no-params>,msg=Due to consecutive failures, the appliance will not attempt to contact the update notification service for 24 hours.| Jun 7 22:15:08 mesa_eventsd[2582]: Error: No '=' character found after position 46 of 0=<no-params>,msg=Due to consecutive failures, the appliance will not attempt to contact the update notification service for 24 hours. Jun 7 16:15:08 : starting pid 114004, tty '/dev/ttyS0': '/sbin/getty -L 9600 ttyS0 vt100' Jun 7 22:15:08 getty[114004]: tcgetattr: Input/output error}}

Then it was Java:

{{Jun 18 22:46:35 kernel: oom-kill:constraint=CONSTRAINT_NONE,nodemask=(null),cpuset=/,mems_allowed=0,global_oom,task_memcg=/,task=java,pid=2167,uid=5000 Jun 18 22:46:35 kernel: Out of memory: Killed process 2167 (java) total-vm:12199664kB, anon-rss:7550536kB, file-rss:0kB, shmem-rss:0kB, UID:5000 pgtables:19436kB oom_score_adj:0}}

They are now using 28gb for 54 reverse proxies, internal config db. The system logs showed that the memory was all consumed; plus it appears the swap. They have increased the ram from 20 to 28gb. Swap is left at 4gb at the moment. I have been advised to use the resource _monitor and shared the one minute independent version with customer. I have asked to look at such reports during high load? This could be related to [+https://www.ibm.com/support/pages/apar/IJ46144+|https://www.ibm.com/support/pages/apar/IJ46144].

OOO from 30th June till 12th July but hopefully someone else will pick up.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5130,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013262628,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,POST LUXEMBOURG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d7m7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-29 17:32:28.19,,,,,"30/Jun/23 3:32 AM;5b15d94b6256d01ad54eb020;This  work item  is similar  other ones we have seen that are resolved by a jvm update.

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|smart-link]  Addresses an issue where crypto operations can result in a JVM memory leak.

Off hand , 54 reverse proxies sounds like an awful lot for one machine.   Part of that depends on the load. ",11/Jul/23 10:57 AM;5ac57757d9a96536d1f0daa9;[~accountid:614dd566a995ad0073ec0622] just a quick reminder to please forward on the potential fix that [~accountid:5b15d94b6256d01ad54eb020] provided. ,11/Jul/23 6:38 PM;614dd566a995ad0073ec0622;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] I will provide fixpack to customer. I will ignore fixpack folder? ( On Holidays from 30th June to 11th July),12/Jul/23 9:30 AM;5b232b2fd85e5b59b066f57f;[~accountid:614dd566a995ad0073ec0622] - the customer just gets the *.fixpack file if that is what you are asking? ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Enabling enable-secret-token-validation = true breaks /pkmspublic,ISAMSUP-5194,309593,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Peter Horner,5b15d9517dab4c51f61b5190,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,29/Jun/23 11:57 PM,04/Jul/23 9:49 AM,14/Jul/23 2:47 PM,,10.0.7,Support,,0,,,,"Similar to [https://cloudidentity.atlassian.net/browse/ISAMSUP-5182|https://cloudidentity.atlassian.net/browse/ISAMSUP-5182|smart-link] 

Tested on 10.0.4.0 IF1, 10.0.5.0 IF1, and 10.0.6.0.

Enable,

[acnt-mgt]
enable-secret-token-validation = true 

The default login.html page with resource located under /pkmspublic is broken.",,khansen,Tushar Prasad,,,,,,,,,,,,,,5b15d901fa615349cb01778b,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5202,,,,,,,,,,,,,,,,,IJ47410,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,Internal,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nick Lloyd,5b15d9e6dda5f94d06b985b4,,,,Nick Lloyd,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-06-30T16:41:12.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d7an:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,ISVA 10.0.6.0,,,,,,,,,,,2023-06-29 23:00:44.309,,,,,29/Jun/23 11:57 PM;5b15d9e6dda5f94d06b985b4;[~accountid:5b15d9517dab4c51f61b5190] ,"30/Jun/23 9:00 AM;5b15d9517dab4c51f61b5190;Reproduced on 10.0.5.0

WebSEAL  logs DPWAD1059E   The validation of the secret token for the request failed.

when trying to access /pkmspublic

Please open an APAR “Enabling enable-secret-token-validation = true breaks /pkmspublic”","30/Jun/23 11:03 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 0e57e2c14cdaec40b4a29bd7216af4d186a8bde3
   * description: ISAMSUP-5194 enable-secret-token-validation = true breaks /pkmspublic

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1994149.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5194) which we publish.","30/Jun/23 12:49 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a1a5050d4e4a796ecfc0b7776c51bd2c309aaf55
   * description: ISAMSUP-5194 enable-secret-token-validation = true breaks /pkmspublic

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1994881.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5194) which we publish.","30/Jun/23 4:41 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 9434170724dff91c95230cdeac795fe7a9210218
   * description: Merge pull request #6011 from ISAM/ISAMSUP-5194

ISAMSUP-5194 enable-secret-token-validation = true breaks /pkmspublic

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1999139.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230630063820-943417072.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","30/Jun/23 6:05 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 9434170724dff91c95230cdeac795fe7a9210218
   * description: Merge pull request #6011 from ISAM/ISAMSUP-5194

ISAMSUP-5194 enable-secret-token-validation = true breaks /pkmspublic

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2001652.


This build has not been published as the commit is not currently within a branch (20230630063820-943417072) which we publish.",04/Jul/23 9:48 AM;5b15d9517dab4c51f61b5190;Fixpack for 10.0.5.0 IF1 is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-5202|https://cloudidentity.atlassian.net/browse/ISAMSUP-5202|smart-link],,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
FIDO registration is failing with error FID019E,ISAMSUP-5190,309288,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,28/Jun/23 2:53 PM,12/Jul/23 2:37 PM,12/Jul/23 2:47 PM,,,Support,,0,,,,"FIDO registration is failing with error FID019E The system couldn't process the request because the attestation statement of format tpm was not well formed.

Stack trace

{noformat}[6/23/23 16:23:05:555 IST] 000001ce id=00000000 com.tivoli.am.fim.fido.server.FIDO2AuditManagerImpl          > logAuditEvent ENTRY severity=ERROR,type=attestation,subType=result,eventTime=1687517585554,user=null,details=null,message=attestation result rejected [The attestation statement with the format tpm was not well formed].,handle=-1
[6/23/23 16:23:05:555 IST] 000001ce id=00000000 com.tivoli.am.fim.audit.event.AuditHelper                    > auditFIDO2AuthEvent ENTRY
[6/23/23 16:23:05:555 IST] 000001ce id=00000000 com.tivoli.am.fim.audit.event.AuditHelper                    3 auditFIDO2AuthEvent userId = null fido2Ceremony = attestation fido2Request = result details = [] relyingParty = null message = attestation result rejected [The attestation statement with the format tpm was not well formed]. handle = -1 eventTime = 1687517585554 severity = ERROR
[6/23/23 16:23:05:555 IST] 000001ce id=00000000 com.tivoli.am.fim.audit.event.AuditHelper                    < auditFIDO2AuthEvent RETURN
[6/23/23 16:23:05:555 IST] 000001ce id=00000000 com.tivoli.am.fim.fido.server.FIDO2AuditManagerImpl          < logAuditEvent RETURN
[6/23/23 16:23:05:556 IST] 000001ce id=00000000 com.tivoli.am.fim.fido.server.FIDOServer                     3 attestationResult com.ibm.iam.isfs.v2.exception.Fido2TPMException: The attestation statement with the format tpm was not well formed
	at com.ibm.iam.isfs.v2.impl.attestation.tpm.TpmPubUnique.init(TpmPubUnique.java:52)
	at com.ibm.iam.isfs.v2.impl.attestation.tpm.TpmPubArea.init(TpmPubArea.java:70)
	at com.ibm.iam.isfs.v2.impl.attestation.AttestationStatementTPM.verified(AttestationStatementTPM.java:144)
	at com.ibm.iam.isfs.v2.impl.attestation.AttestationObject.verified(AttestationObject.java:133)
	at com.ibm.iam.isfs.v2.impl.server.attestation.Fido2AttestationImpl.checkResult(Fido2AttestationImpl.java:283)
	at com.tivoli.am.fim.fido.server.FIDOServer.attestationResult(FIDOServer.java:225)
	at com.tivoli.am.fim.fido.protocol.delegates.FIDO2ServerDelegate.processRequest(FIDO2ServerDelegate.java:246)
	at com.tivoli.am.fim.fedmgr2.proper.FederationManager.doInitialRequestOnDelegate(FederationManager.java:476)
	at com.tivoli.am.fim.fedmgr2.proper.FederationManager.finishProcessingWithDelegateId(FederationManager.java:311)
	at com.tivoli.am.fim.fedmgr2.proper.FederationManager.processRequest(FederationManager.java:164)
	at com.tivoli.am.fim.fedmgr2.servlet.SSOPSServletBase.doRequest(SSOPSServletBase.java:129)
	at com.tivoli.am.fim.fedmgr2.servlet.SPSCommandDispatcher.invoke(SPSCommandDispatcher.java:442)
	at com.tivoli.am.fim.war.runtime.liberty.LibertyRuntimeServlet.doPost(LibertyRuntimeServlet.java:92)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:706)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:791)
	at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1230)
	at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:729)
	at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:426)
	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.invokeTarget(WebAppFilterChain.java:182)
	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:93)
	at com.ibm.isam.core.offering_filter.OfferingFilter.doFilter(OfferingFilter.java:267)
	.
	.
	.
[6/23/23 16:23:05:563 IST] 000001ce id=00000000 com.tivoli.am.fim.fido.server.FIDOServer                     I attestationResult com.tivoli.am.fim.fido.exception.FIDO2ServerException: FID019E The system couldn't process the request because the attestation statement of format tpm was not well formed.
	at com.tivoli.am.fim.fido.server.FIDOServer.attestationResult(FIDOServer.java:246)
	at com.tivoli.am.fim.fido.protocol.delegates.FIDO2ServerDelegate.processRequest(FIDO2ServerDelegate.java:246)
	at com.tivoli.am.fim.fedmgr2.proper.FederationManager.doInitialRequestOnDelegate(FederationManager.java:476)
	at com.tivoli.am.fim.fedmgr2.proper.FederationManager.finishProcessingWithDelegateId(FederationManager.java:311)
	at com.tivoli.am.fim.fedmgr2.proper.FederationManager.processRequest(FederationManager.java:164)
	at com.tivoli.am.fim.fedmgr2.servlet.SSOPSServletBase.doRequest(SSOPSServletBase.java:129)
	at com.tivoli.am.fim.fedmgr2.servlet.SPSCommandDispatcher.invoke(SPSCommandDispatcher.java:442)
	at com.tivoli.am.fim.war.runtime.liberty.LibertyRuntimeServlet.doPost(LibertyRuntimeServlet.java:92)
.
.
.
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1160)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.lang.Thread.run(Thread.java:820)
Caused by: com.ibm.iam.isfs.v2.exception.Fido2TPMException: The attestation statement with the format tpm was not well formed
	at com.ibm.iam.isfs.v2.impl.attestation.tpm.TpmPubUnique.init(TpmPubUnique.java:52)
	at com.ibm.iam.isfs.v2.impl.attestation.tpm.TpmPubArea.init(TpmPubArea.java:70)
	at com.ibm.iam.isfs.v2.impl.attestation.AttestationStatementTPM.verified(AttestationStatementTPM.java:144)
	at com.ibm.iam.isfs.v2.impl.attestation.AttestationObject.verified(AttestationObject.java:133)
	at com.ibm.iam.isfs.v2.impl.server.attestation.Fido2AttestationImpl.checkResult(Fido2AttestationImpl.java:283)
	at com.tivoli.am.fim.fido.server.FIDOServer.attestationResult(FIDOServer.java:225)
	... 43 more
Caused by:
com.ibm.iam.isfs.v2.exception.Fido2TPMException: The attestation statement with the format tpm was not well formed
	at com.ibm.iam.isfs.v2.impl.attestation.tpm.TpmPubUnique.init(TpmPubUnique.java:52)
	at com.ibm.iam.isfs.v2.impl.attestation.tpm.TpmPubArea.init(TpmPubArea.java:70)
	at com.ibm.iam.isfs.v2.impl.attestation.AttestationStatementTPM.verified(AttestationStatementTPM.java:144)
	at com.ibm.iam.isfs.v2.impl.attestation.AttestationObject.verified(AttestationObject.java:133)
	at com.ibm.iam.isfs.v2.impl.server.attestation.Fido2AttestationImpl.checkResult(Fido2AttestationImpl.java:283)
	at com.tivoli.am.fim.fido.server.FIDOServer.attestationResult(FIDOServer.java:225)
	at com.tivoli.am.fim.fido.protocol.delegates.FIDO2ServerDelegate.processRequest(FIDO2ServerDelegate.java:246){noformat}

Upon discussion within L2 group, we found similar issue reported in ISV SaaS ISVCASE-2476

Where I could see these comments by Shane Weeden

_“This comes about because at some point Microsoft updated Windows to support EC keys and not just RSA. ISV SaaS is using an old FIDO component which doesn’t support TPM attestation with EC keys.”_

And this is mentioned in CI-86186
*”**_There will be a new ISFS2 component within the ISVA 10.0.3 timeframe”_*
So my question is can we backport this to 10.0.2? Or any other suggestion ?

Traces are available at
/ecurep/sf/TS013/410/TS013410997/2023-06-23/isva_10.0.2.0_20230623-162502_awsm1aplssou01.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/",,Nick Lloyd,prashant_kamat,Tushar Prasad,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013410997,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,,,,MAX LIFE INSURANCE COMPANY LIMITED,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d5f3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-07-02 22:54:15.131,,,,,03/Jul/23 8:54 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] one for you to review with the support of the Gold Coast development team. ,"04/Jul/23 9:14 AM;5af4ad7d4dd24c579110120b;<Notes>

Changes are in ADK’s and src for ISFS changes in 1003 

[https://cloudidentity.atlassian.net/browse/ISAMDEV-6736|https://cloudidentity.atlassian.net/browse/ISAMDEV-6736|smart-link] 

[https://github.ibm.com/ISAM/isam-build-adks/pull/163/files|https://github.ibm.com/ISAM/isam-build-adks/pull/163/files]
1 isfs jar and 4 Jackson jars to be updated 
Rebuild container with this change
Make these code changes from the PR’s below - 

[https://github.ibm.com/ISAM/isam/pull/4148/files|https://github.ibm.com/ISAM/isam/pull/4148/files] 

[https://github.ibm.com/ISAM/isam/pull/4047/files|https://github.ibm.com/ISAM/isam/pull/4047/files]

Update all jar’s for i4m since Jackson library has also changed.

Todo review - if the changes to i4m is enough or the adk’s changes are necessary for these.
","12/Jul/23 12:26 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

It has changes to Jackson library changes common across fim components in addition to the isfs jar update.
The changes in this space has underlying jar changes that need rebuilding the image, in addition to the changes in the code base. 

Is it an option for the customer to upgrade to 10030 and test this fido registration? ","12/Jul/23 2:37 PM;5b1757156d76184b7d98a0c3;Let me ask customer if they can upgrade. Will let you know.
Btw I could not recreate issue on 10.0.2

I could register my Mac as fido device on 10.0.2",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
"LDAP Server connection connect, read, and idle timeout still not working",ISAMSUP-5183,308788,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,27/Jun/23 9:19 AM,13/Jul/23 3:36 PM,13/Jul/23 10:20 AM,,,Support,,0,escalated,,,"Customer was told upgrading to 10.0.5.0 would resolve an issue with read timeouts:

From customer:

----

With the packet capture we took from ISAM 9, we were able to see that ISAM was retrying the Server Connection to LDAP over and over for 120 seconds and then finally after that, it established a new connection. That always aligned with seeing the 121 seconds in the WebSEAL request log as we are still seeing now.

We have the Server Connection configured with 28 seconds for Connection Timeout and 28 seconds for Max Idle Time, but ISVA still seems to be using 120 seconds and not honoring the values we have configured.

----

I tested this on 10.0.5.0, 10.0.5.0 IF1, and 10.0.6.0 in my lab and I was able to confirm that even when the server connection has an IDLE timeout and CONNECT timeout set to values with a Connection Pool size > 0 that they don’t come into play.



The customer is using SCIM in this scenario.",,David Hayes,jcyarbor,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-3030,,,,,,12/Jul/23 12:11 PM;ashashiv;TestSetup.docx;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/210754,27/Jun/23 10:03 AM;ashashiv;image-20230627-000304.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208512,28/Jun/23 1:42 AM;jcyarbor;image-20230627-153142.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208763,28/Jun/23 1:42 AM;jcyarbor;trace(4).log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208761,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013339456,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,State of California,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d2bz:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,ISVA 10.0.6.0,,,,,,,,,,,,2023-06-26 23:38:35.369,,,,,"27/Jun/23 9:22 AM;5bac25aaabfcbf73d13e733b;Did [https://cloudidentity.atlassian.net/browse/ISAMSUP-3030|https://cloudidentity.atlassian.net/browse/ISAMSUP-3030|smart-link] make it into 10.0.5.0, 10.0.5.0 IF1 or 10.0.6.0?

Because I’m not seeing it behave at all as expected.","27/Jun/23 9:38 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bac25aaabfcbf73d13e733b] 

Yes changes were in 10050 

From your environment do you have the trace from com.ibm.security.access.* 

{noformat}Bind context with idleTimeout :
Bind context with conectTimeout : 
Bind context with readTimeout :{noformat}

We should see these in log from LdapServerImpl.","27/Jun/23 9:47 AM;5bac25aaabfcbf73d13e733b;{noformat}trace.specification = *=info:com.ibm.security.access.*=ALL:com.tivoli.am.fim.*=ALL{noformat}

No, it was not in the trace with the above specification at 10.0.5.0.","27/Jun/23 9:53 AM;5af4ad7d4dd24c579110120b;Is it adding any trace from LdapServerImpl like entry, exits.

Can you share your trace file plz.

Also do you have connection properties set for the LDAP connection not the advanced tuning for jvm option but the connection properties under server connections for the LDAP.

!image-20230627-000304.png|width=474,height=240!","28/Jun/23 1:42 AM;5bac25aaabfcbf73d13e733b;Updated with the following:

{noformat}com.tivoli.am.fim.*=ALL:com.ibm.security.access.*=ALL:com.ibm.isam.scim.*=ALL:com.tivoli.pd.*=ALL{noformat}

Still nothing

I’ve uploaded my trace.log

Here is a screenshot of my connection pool settings:

!image-20230627-153142.png|width=542,height=299!","30/Jun/23 6:32 AM;5af4ad7d4dd24c579110120b;<Notes>

This issue is different to [https://cloudidentity.atlassian.net/browse/ISAMSUP-3030|https://cloudidentity.atlassian.net/browse/ISAMSUP-3030|smart-link] since the path it takes for LDAP connection is different.

Looks like RgyRegistry doesnt have the timeouts.

To investigate futher - 
RgyConfig.java - 


{noformat}//      ldapOptions.put(LdapRgyHandleMgr.LDAP_TIMEOUT, new ValidateInteger(0, 60*60));
//      ldapOptions.put(LdapRgyHandleMgr.LDAP_AUTHN_TIMEOUT, new ValidateInteger(0, 60*60));
//      ldapOptions.put(LdapRgyHandleMgr.LDAP_SEARCH_TIMEOUT, new ValidateInteger(0, 60*60));{noformat}

LDAPRgyHandlerMgr.java


{noformat} protected void setHandle(LdapRgyServer.Handle handle) throws RgyException{noformat}

LDAPRgyServer.java

{noformat}protected LdapContext getLdapContext(String bindDn, char[] password,
        Control[] controls, long downCount, int[] expireTime, boolean keepExpired) {noformat}

{noformat}protected LdapContext getLdapContext(String bindDn, char[] password,
        Control[] controls, int[] expireTime, boolean keepExpired) throws RgyException
contextInit.put(""java.naming.ldap.factory.socket"", sslSocketFactoryName);
contextInit.put(Context.SECURITY_PRINCIPAL, bindDn);
            contextInit.put(Context.SECURITY_CREDENTIALS, passwordString);{noformat}

Making this change to add hard coded defaults for test:

{noformat}        //20 seconds timeout and 10 seconds read timeout 
        contextInit.put(""com.sun.jndi.ldap.connect.pool.timeout"", ""20000"");
        contextInit.put(""com.sun.jndi.ldap.connect.timeout"", ""20000"");
        contextInit.put(""com.sun.jndi.ldap.connect.pool.maxsize"", ""2"");
        contextInit.put(""com.sun.jndi.ldap.read.timeout"", ""10000"");{noformat}","12/Jul/23 2:18 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5af4ad7d4dd24c579110120b] ,

Any update on this fix?","12/Jul/23 2:36 AM;5bac25aaabfcbf73d13e733b;Update from customer:

----

We are in the midst of this upgrade and we need to resolve this as soon as possible because our entire project is blocked. We cannot get support for 9.0.7 and while upgrading we have this problem as outlined in this PMR. Please provide us with a quick resolution so we are no longer on the unsupported version.

----

So this is blocking their upgrade.",12/Jul/23 8:39 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] lets push this item to the top of the queue today please. Appreciate the support regards to this and let Dave or I know if you need any additional support. [~accountid:5b232b2fd85e5b59b066f57f] FYI.,"12/Jul/23 12:11 PM;5af4ad7d4dd24c579110120b;[^TestSetup.docx]

Hi [~accountid:5bac25aaabfcbf73d13e733b] 

I am trying to set up the environment to test and I cant login as a user from the remote ldap that is set in federated alias setting

HPDIA0219W   An unknown user, testuser3, was presented to Security Verify Access.
Attached is the configuration that I am using to set up the environment.

Can you check if there is any config missing to get to the state where I can recreate the issue.

Thanks

Apologies for the delayed response on this item - I was away on leave.



<my notes>

10.160.20.236 IDP
10.160.20.56 SP
10.160.20.46 ISDS 

test url -
[https://www.myidp.ibm.com/isam/sps/saml20idp/saml20/logininitial?RequestBinding=HTTPPost&PartnerId=https%3A%2F%2Fwww.mysp.ibm.com%2Fisam%2Fsps%2Fsaml20sp%2Fsaml20&NameIdFormat=Persistent&Target=https://www.mysp.ibm.com/isam/mobile-demo/diag/|https://www.myidp.ibm.com/isam/sps/saml20idp/saml20/logininitial?RequestBinding=HTTPPost&PartnerId=https%3A%2F%2Fwww.mysp.ibm.com%2Fisam%2Fsps%2Fsaml20sp%2Fsaml20&NameIdFormat=Persistent&Target=https://www.mysp.ibm.com/isam/mobile-demo/diag/]","13/Jul/23 2:25 AM;5bac25aaabfcbf73d13e733b;[~accountid:5af4ad7d4dd24c579110120b] ,

This isn’t an issue with the Federation.

The customer’s use case that’s not working is when using SCIM.



The reason I referenced the other APAR is because I thought the fix applied to all server connections not just the Federation Alias service.



You’ll need to configure SCIM to use the server connection in question.

I used the built-in User Self Care authentication mechanisms to test.","13/Jul/23 3:36 PM;5af4ad7d4dd24c579110120b;<Notes>

Env: 10.160.20.119

[https://10.160.21.119/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1|https://10.160.21.119/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1]
Timing out at 120 seconds which is probably http-timeout/https-timeout. 
Though - 

connection-timeout is set to 8 seconds.
 

{
    ""error_code""    : ""0x38cf04d3"",
    ""error_message"" : ""DPWWA1235E   Could not read the response status line sent by a third-party server.  Possible causes: non-spec HTTP headers, connection timeout, no data returned.  This is not a problem with the WebSEAL server.""
}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
"Enable DSC, UNAUTHENTICATED SESSION, and LTPA AUTH breaks /pkmspublic",ISAMSUP-5182,308761,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Peter Horner,5b15d9517dab4c51f61b5190,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,27/Jun/23 1:53 AM,12/Jul/23 3:12 PM,14/Jul/23 2:47 PM,,10.0.7,Support,,0,,,,"While doing some work for [https://cloudidentity.atlassian.net/browse/ISAMSUP-5050|https://cloudidentity.atlassian.net/browse/ISAMSUP-5050|smart-link] using 10.0.5.0 I noticed this issue.  Also happen on 10.0.6.0.

Note the docs for /pkmspublic,

[https://www.ibm.com/docs/en/sva/10.0.6?topic=stanza-pkmspublic-uri|https://www.ibm.com/docs/en/sva/10.0.6?topic=stanza-pkmspublic-uri|smart-link] 
[https://www.ibm.com/docs/en/sva/10.0.6?topic=locations-management-root|https://www.ibm.com/docs/en/sva/10.0.6?topic=locations-management-root|smart-link] 

“Unauthenticated users are allowed to access these files. It is not possible at control access using an authorization policy.”

With the following enabled,

[session]
dsess-enabled = yes
dsess-server-type = dsc
create-unauth-sessions = yes

[ltpa]
ltpa-auth = https


requests to /pkmspublic are block for unauthenticated users.  This triggers the login page which is returned as HTML which breaks browser side with,



!image-20230626-155205.png|width=1364,height=258!


",,khansen,tonyferg,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-3051,,ISAMSUP-5202,,27/Jun/23 1:53 AM;nlloyd;image-20230626-155205.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208440,,,,,,,,,,,,,,,IJ47340,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012712289,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nick Lloyd,5b15d9e6dda5f94d06b985b4,,,,Nick Lloyd,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=7, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":7,""lastUpdated"":""2023-07-10T09:58:17.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":7,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d26n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,ISVA 10.0.6.0,,,,,,,,,,,,2023-06-26 23:14:59.13,,,,,"27/Jun/23 9:14 AM;5b15d9517dab4c51f61b5190;I have reproduced the issue - but without DSC

[session]

create-unauth-sessions = yes

[ltpa]

ltpa-auth = both

Please open an APAR “unauthenticated session when ltpa auth enabled breaks pkmspublic”","27/Jun/23 5:05 PM;5b15d9517dab4c51f61b5190;FYI

Have found the cause

LTPA auth code wasn’t handling unauth sessions properly

authn_ltpa_create  should not create a cookie for unauth sessions but it is

{noformat}2023-06-27-16:10:01.635+10:00I----- thread(6) trace.pdweb.wns.authn:6 /build/isam/src/i4w/pdweb/webseald/authn/modules/ltpa/authn-ltpa.cpp:478: [192.168.115.248] Entering authn_ltpa_create()
2023-06-27-16:10:01.635+10:00I----- thread(6) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:1314: [192.168.115.248] WSCredsCacheEntry::hasAznUserName = 1
2023-06-27-16:10:01.635+10:00I----- thread(6) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/modules/ltpa/authn-ltpa.cpp:301: [192.168.115.248]   Creating the cookie.{noformat}

The test {{hasAznUserName}} is doesn’t work  when unauth sessions enabled (as unauth sessions all have  username unauthenticated)

We need to check  auth type used instead","27/Jun/23 7:08 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ed0e997b3bcbb6263c52420a5beb344ec6e77a08
   * description: ISAMSUP-5182 IJ47340 unauth sessions and ltpa-auth breaks pkmspublic

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1819319.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5182) which we publish.","29/Jun/23 12:42 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9e6dda5f94d06b985b4] 

Change has been approved

Do you need a fixpack for 10.0.1.0 (for ISAMSUP-5050) as if you do  I will include IJ29437 which I stated at the start is the likely cause

Do you need a fixpack for 10.0.5.0 IF1 or 10.0.6.0","29/Jun/23 1:27 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c457db0bc2abf56dabe90be2bbcfe3e0c13cc95f
   * description: Merge pull request #6006 from ISAM/ISAMSUP-5182

ISAMSUP-5182 IJ47340 unauth sessions and ltpa-auth breaks pkmspublic

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1940961.


This build has not been published as the commit is not currently within a branch (20230629020110-b8f74e194) which we publish.","29/Jun/23 11:51 PM;5b15d9e6dda5f94d06b985b4;[~accountid:5b15d9517dab4c51f61b5190] 
”Do you need a fixpack for 10.0.1.0 (for ISAMSUP-5050) as if you do I will include IJ29437 which I stated at the start is the likely cause”  *YES*
”Do you need a fixpack for 10.0.5.0 IF1 or 10.0.6.0” *While LTPA Auth is not very common probably best to have ready.*","03/Jul/23 2:39 PM;5b15d9517dab4c51f61b5190;The 10.0.1.0 fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-3051|https://cloudidentity.atlassian.net/browse/ISAMSUP-3051|smart-link].

It requires 10.0.1.0 IF1","04/Jul/23 9:49 AM;5b15d9517dab4c51f61b5190;Fixpack for 10.0.5.0 IF1 is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-5202|https://cloudidentity.atlassian.net/browse/ISAMSUP-5202|smart-link]

It includes fix for IJ47340","07/Jul/23 4:11 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9e6dda5f94d06b985b4] 

Testing has determined that this change caused a regression (The LTPA cookie not being updated)

I need to redo the fix and build new fixpacks","07/Jul/23 6:18 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: d686649f164360d66c7de0826380703542f8f961
   * description: ISAMSUP-5182 IJ47340 fix regression

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2300874.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5182) which we publish.","10/Jul/23 9:58 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: dcc1c354ed4be130bd7e568e76fdf0e65820f0be
   * description: Merge pull request #6021 from ISAM/ISAMSUP-5182

ISAMSUP-5182 IJ47340 fix regression

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2371530.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230709235444-dcc1c354e.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","12/Jul/23 3:12 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9e6dda5f94d06b985b4] 

V2 of the 10.0.5.0 IF1 fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-5202|https://cloudidentity.atlassian.net/browse/ISAMSUP-5202|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
CGI Generic SQL Injection Vulnerability in ISVA LMI,ISAMSUP-5176,308590,Support,To Do,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,jwade,5b15d8fd6e93913e31e279fb,Virag Patel,5b17571a82e05b22cc7d5d9e,Virag Patel,5b17571a82e05b22cc7d5d9e,26/Jun/23 3:48 PM,07/Jul/23 4:45 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"customer did security scanning against ISVA LMI console and reported below.

CGI Generic SQL Injection (blind, time based) on port 443.

{noformat}43160,""CGI Generic SQL Injection (blind, time based)"",CGI abuses,High,172.26.211.26,TCP,443,A CGI application hosted on the remote web server is potentially prone to SQL injection attack.,""By sending specially crafted parameters to one or more CGI scripts hosted on the remote web server, Nessus was able to get a slower response, which suggests that it may have been able to modify the behavior of the application and directly access the underlying database. 

An attacker may be able to exploit this issue to bypass authentication, read confidential data, modify the remote database, or even take control of the remote operating system. 

Note that this script is experimental and may be prone to false positives."",Modify the affected CGI scripts so that they properly escape arguments.,""http://www.securiteam.com/securityreviews/5DP0N1P76E.html
http://www.nessus.org/u?ed792cf5
http://projects.webappsec.org/w/page/13246963/SQL%20Injection"",,""Jun 13, 2023 18:31:57 IST"",""Jun 14, 2023 14:06:56 IST"",""Plugin Output: 
Using the GET HTTP method, Nessus found that :

+ The following resources may be vulnerable to blind SQL injection (time based) :

+ The 'Error' parameter of the /core/login CGI :

/core/login?Error=true'%20AND%20SLEEP(21)='

-------- output --------
<!DOCTYPE html PUBLIC """"""""-//W3C//DTD XHTML 1.0 Strict//EN"""""""" """"""""http://w [...]
<!-- IBM Confidential
Object Code Only Source Materials
5725-L52
(c) Copyright International Business Machines Corp. 2012, 2016
The source code for this program is not published or otherwise divested
of its trade secrets, irrespective of what has been deposited with the
U.S. Copyright Office. -->
<html xmlns=""""""""http://www.w3.org/1999/xhtml"""""""" xml:lang=""""""""en"""""""" lang='en' [...]
<head>
[...]
------------------------

Clicking directly on these URLs should exhibit the issue :
(you will probably need to read the HTML source)

https://172.26.211.26/core/login?Error=true'%20AND%20SLEEP(21)='""
45590,Common Platform Enumeration (CPE),General,Info,172.26.211.26,TCP,0,It was possible to enumerate CPE names that matched on the remote system.,""By using information obtained from a Nessus scan, this plugin reports CPE (Common Platform Enumeration) matches for various hardware and software products found on a host. 
{noformat}

the complete report is available at:
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013329875&path=TS013329875%2F2023-06-15%2F&filepath=TS013329875%2F2023-06-15%2FVulnerabilities_Policy_ServerExcel.csv|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013329875&path=TS013329875%2F2023-06-15%2F&filepath=TS013329875%2F2023-06-15%2FVulnerabilities_Policy_ServerExcel.csv]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013329875,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Virag Patel,5b17571a82e05b22cc7d5d9e,,,,BANK OF INDIA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d14v:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-27 06:14:17.987,,,,,27/Jun/23 4:14 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] can you please review and confirm the details in this Jira item? ,"30/Jun/23 12:41 PM;5b17571a82e05b22cc7d5d9e;Hi Jim,



any update on this. let me know if  you need any additional information.",03/Jul/23 3:58 PM;5b17571a82e05b22cc7d5d9e;[~accountid:5b15d8fd6e93913e31e279fb] could you pls review this and share your feedback? thanks,05/Jul/23 7:02 PM;5b17571a82e05b22cc7d5d9e;customer is using V10.0.5_IF1 and found this vulnerability.,07/Jul/23 4:45 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac577587028785d133fbc46] Can I get some help confirming this.  I think it might be a false positive but need assurance.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do
Runtime Trace Memory Growth / Leak,ISAMSUP-5175,308407,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,David Hayes,5b232b2fd85e5b59b066f57f,David Hayes,5b232b2fd85e5b59b066f57f,26/Jun/23 1:07 PM,14/Jul/23 10:50 AM,14/Jul/23 10:12 AM,,,Support,,0,,,,"There appears to be a memory leak in the JVM when AAC / FED runtime trace is turned on. 

RE: [https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|smart-link]  There is also a leak introduced in 10.0.5 that cause rapid memory growth do to the JVM.

There is a leak related to leaving logging running. This customer is experiences both leaks, so this make make troubleshooting even more difficult. I can recreate the leak due to the logging. *This Jira is to focus on what appears to be a classloader leak in for the FIMLoggerImpl class.*

I suspect the class leak has been around for a very long time since I can recreate the logginf leak I’ve only opened a Jira to focus on the logging leak. As they have escalated and raised my case to Sev 1

I’ve already advised the customer to perform periodic restart of the JVM to free the memory.

I have mentioned to the customer that in the past this has been related to leaving tracing enabled for a long time. While conceptually turning down or off the traces is a work around, the customer uses the traces and MUST keep them set for auditing. So for this customer it is NOT an option just to turn off tracing they already have it set to a lower trace level.

They are seeing this across multiple environments (prod and qa) for example (all had tracing enabled).

Since turning off the trace is not fully possible for FRIT.    Our code should not be loading the FIMLoggerImpl class tens of thousands of times. It seems like some traced class is loading the logger, but it is not being cleaned up when that class ends leaving a stale but referenced loaded class.  

For stability of the product we should attempt to resolve this as leaving tracing on should not result in a JVM loading thousands of classes.   The workaround of turning off trace or not leaving it running all the time is not always possible. 

For example:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-23%2Fisva_10.0.5.0_20230323-161856_pyq1tcac1.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-23%2Fisva_10.0.5.0_20230323-161856_pyq1tcac1.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F]

(These javacores are from an OOM event that caused system wide problems on the appliance (again this is both the logging and new 10.0.5 issue ISAMSUP-5062 combined.)

 grep 3CLTEXTCLASS javacore.20230304.202144.12223.0003.txt  | grep FIMLoggerImpl  | wc -l

29283 loaded

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-24%2Fisva_10.0.5.0_20230323-193929_pyq1tcac3.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-24%2Fisva_10.0.5.0_20230323-193929_pyq1tcac3.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F]

(These javacores were collected before proactive the runtime was restarted)
Thu Mar 23 19:40:17 EDT 2023

/usr/bin/top -b -n1 -mMem total:8146964 anon:6758744 map:97156 free:129576slab:152720 buf:41400 cache:842568 dirty:8564 write:0Swap total:2056316 free:1492PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND1904 8824m 8203m 6242m 34516 6194m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a

 grep 3CLTEXTCLASS javacore.20230323.192521.1904.0001.txt | grep FIMLoggerImpl | wc -l
50090 loaded 

I think anyone can agree that many loaded instances of a class is abnormal.  

In the entire i4m source tree there are less than 18000 total files.   I know a single file may have multiple classes, but this would be evidence against the thought that the number of loaded classes was high just cause we have a large number of total classes, and each class could potentially have one loaded.    When there are 50K loaded instances and less than half as many total classes in the source it does not appear to be a valid line of thinking.  Something else must be going on that results in the large number of classes loaded, not just the number of classes we have. 

Furthering that in the javacores with 50K loaded, the customer is using a reduced trace string:

trace.specification = _=info:com.ibm.sec.authz._=ALL:com.tivoli.am.fim.authsvc._=ALL:com.tivoli.am.fim.saml20._=ALL:com.tivoli.am.fim.trustserver.sts.modules._=ALL:com.tivoli.am.fim.trustserver.sts.utilities._=ALL

The customer would like for us to investigate this as a memory leak as well.

The FIMLoggerImpl leak shows up in the standard Javacore files.  I have a script that monitors PSS and collects javacore, heapdumps and system cores of the JVM.   The javacores run every 15 min and the heapdump and core dumps upto once every 12 hours, as these are much larger, 



In my test env that has been running for a while with trace enabled I have 73613 shared copies of 3CLTEXTCLASS                     com/tivoli/am/fim/logging/FIMLoggerImpl loaded.

And I believe I have a full JVM system core being collected as part of my monitor script. 

/opt/ibm/wlp/bin/server javadump runtime --include=heap,system,thread 
Dumping server runtime.
Server runtime dump complete in /opt/IBM/wlp/usr/servers/runtime/logs/javacore.20230510.125254.7309.0005.txt.
Server runtime dump complete in /opt/IBM/wlp/usr/servers/runtime/logs/heapdump.20230510.125254.7309.0006.phd.
Server runtime dump complete in /opt/ibm/wlp/usr/servers/runtime/The core file created by child process with pid = 13745 was not found. Expected to find core file with name ""/var/support/core_kernel-command-.13745"".

But the file /var/support/core_kernel-command-.13745 actually exists after a few seconds.",,Annelise Quap,,,,,,,,,,,,,,,5b15d950d9936c61022057fe,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5062,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012529407,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,FRB FRIT PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,Yes,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d00n:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.0.0,ISVA 10.0.0.1,ISVA 10.0.1.0,ISVA 10.0.2.0,ISVA 10.0.3.0,ISVA 10.0.3.1,ISVA 10.0.4.0,ISVA 10.0.5.0,ISVA 10.0.6.0,,,,,2023-06-26 14:32:13.61,,,,,27/Jun/23 12:32 AM;5b15d950d9936c61022057fe;I’ve refactored the two JIRAs for the individual roles.,27/Jun/23 12:34 AM;5b15d950d9936c61022057fe;If needed I’ll setup further recreates for the logging issue on 10.0.6.  Which is just to enable trace and let it a few thousand requests,28/Jun/23 11:38 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d950d9936c61022057fe] thank you for your support with all these issues.,28/Jun/23 1:31 PM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] I am hoping that you can take a look for this one for us. Please let Dave and I know if we can assist in anyway. ,"14/Jul/23 10:49 AM;5af4ad7d4dd24c579110120b;[~accountid:5b15d950d9936c61022057fe] 

Is this a valid scaled down test based on your description or should I be tweaking the recreate steps - 



Env: 10.0.6.0

Testing with infomap authentication
Trace level set to - 
{{com.tivoli.am.fim.*=ALL:com.ibm.security.access.*=ALL:com.ibm.isam.scim.*=ALL:com.tivoli.pd.*=ALL}}
Sent 2000 requests 
Time taken - 20 minutes
core taken every 5 minutes 

{noformat}grep 3CLTEXTCLASS javacore.20230714.002302.1667.0001.txt | grep FIMLoggerImpl  | wc -l
     265

grep 3CLTEXTCLASS javacore.20230714.002820.1667.0005.txt | grep FIMLoggerImpl  | wc -l
     265

grep 3CLTEXTCLASS javacore.20230714.003415.1667.0007.txt | grep FIMLoggerImpl  | wc -l
     265

Restart runtime

grep 3CLTEXTCLASS javacore.20230714.004551.16552.0001.txt | grep FIMLoggerImpl  | wc -l
      80
{noformat}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA LMI and AAC Runtime Fail to start with Dynatrace Extension/Agent loaded after update to 10.0.6.0 firmware,ISAMSUP-5166,308015,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,rholman,5bac25a83a6aa22dbebb46cf,rholman,5bac25a83a6aa22dbebb46cf,22/Jun/23 5:37 AM,12/Jul/23 10:39 AM,14/Jul/23 2:47 PM,,,,,0,,,,"After updating our existing Sandbox environment from 10.0.5.0_IF1 to the 10.0.6.0 firmware image using the pkg file, the LMI and AAC Runtimes both failed to start properly after reinstalling the Dynatrace Extension and rebooting the appliances... 

I confirmed the latest version of the agent installer script was available on our side and that the v1.0.7 version of the Dynatrace OneAgent Extension that we are using is the latest. 

I have attached a support file from one of the appliances that was having the issue. The LMI and the AAC runtime both dropped javacores and snapshot trace files when the startup issues occured. 

After removing the Dynatrace extension using an SSH session and rebooting the appliances, the LMI and AAC runtime were both functional again.

There is no Fix Version updated for 10.0.6 in the Jira and that will need to be added.",,David Hayes,khansen,Motiur Rahman,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,10/Jul/23 1:35 PM;djhayes;image-20230710-015115.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/210322,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013392640,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,rholman,5bac25a83a6aa22dbebb46cf,,,,Truist Financial Corporation,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013392640&path=TS013392640%2F2023-06-21%2F&filepath=TS013392640%2F2023-06-21%2Fisva_10.0.6.0_20230621-150038_dev-aismpdm01.bbtnet.com.support,,,,,,,,,,,,,,,,,,,,,,,0|i1cxpj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-22 06:00:26.509,,,,,"22/Jun/23 4:00 PM;5b232b2fd85e5b59b066f57f;Looking at the JVM messages logs, it seems to just hang when starting the runtime given that the trace just stops (/ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230621-150038_dev-aismpdm01.bbtnet.com.support_unpack/tmp/liberty_dump.zip_unpack/logs/messages_23.06.21_14.39.48.0.log)

A few questions: 

# Which extension are they using - i.e. is it Appmon or OneAgent? 
# What do they mean by “after reinstalling the Dynatrace Extension”? 
## Was the extension already installed before upgrading to 10.0.6?  
## Why did they reinstall after the upgrade? 
## Immediately after upgrading the firmware but before reinstalling the extension - did the runtimes start? 
# When did they upgrade the firmware to 10.0.5 and then to 10.0.6? Whilst it is evident that they upgraded to 10.0.5 and subsequently 10.0.6; there is no indication in their /var/log/messages of any firmware upgrades taking place at all since JUL 2022 which is odd. 

[~accountid:5bac25a83a6aa22dbebb46cf] - have you tried this in the lab? Interested to know if it is possible to recreate with a clean 10.0.6 install. ","23/Jun/23 7:25 AM;5bac25a83a6aa22dbebb46cf;Answers below...

# Which extension are they using - i.e. is it Appmon or OneAgent?
## OneAgent from here: [https://exchange.xforce.ibmcloud.com/hub/extension/46c449543f3570e9f4ffd15370c2c32b|https://exchange.xforce.ibmcloud.com/hub/extension/46c449543f3570e9f4ffd15370c2c32b|smart-link] 
# What do they mean by “after reinstalling the Dynatrace Extension”?
## Was the extension already installed before upgrading to 10.0.6?
### Yes, it was installed at the 10.0.5.0 level before initiating the firmware updated
## Why did they reinstall after the upgrade?
### We have to reinstall after each firmware update for all Dynatrace functionality to work as expected
## Immediately after upgrading the firmware but before reinstalling the extension - did the runtimes start?
### The runtimes did appear to start correctly before reinstalling the extension and restarting the appliances after the firmware update was completed.
# When did they upgrade the firmware to 10.0.5 and then to 10.0.6? Whilst it is evident that they upgraded to 10.0.5 and subsequently 10.0.6; there is no indication in their /var/log/messages of any firmware upgrades taking place at all since JUL 2022 which is odd.
## The Sandbox environment where this was attempted and the issue was noted was a fresh installation of 10.0.5.0 from the ISO, it was not previously upgraded from 10.0.4.0 or other previous versions. Our other environments when we get to those will have a firmware update history starting with 9.0.4.0 or possibly earlier I believe.

Since this is a sandbox environment with no active flows currently, if needed we can boot from the alternate partition back to 10.0.5.0 and run the firmware update process again over a WebEx or Teams meeting to watch the process and try to gather any additional data.



I have not tried this as I do not have Dynatrace. When you say is it possible to recreate with a clean install, what exactly do you mean. A clean install would start everything up, then you would have to install the extension. Are you wondering if after the install of 10.0.6.0, install of Dynatrace, and then restart the appliance if the runtimes don’t restart?","23/Jun/23 3:13 PM;5b232b2fd85e5b59b066f57f;I wouldn’t think that you would have to reinstall the extension after firmware upgrade unless there was an incompatibility with the new firmware version and a new version of the extension needed - at least with other extensions you don’t need to. I’ve downloaded the extension and it looks like there is a “10.0.4 and prior” version and a “10.0.5 and above” version. I assume they have used the correct one? 


In terms of the upgrade path of this appliance - I can see that 10.0.4.0_IF1 was applied so I assume they were at 10.0.4 at this point and then upgraded to 10.0.5 and subsequently 10.0.6? As mentioned, for whatever reason there isn’t anything logging that a firmware upgrade has taken place - so I’m just piecing it together based on what else I can see. 


{noformat}$ grep fixpack /ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230621-150038_dev-aismpdm01.bbtnet.com.support_unpack/var/log/messages
Sep 29 08:55:33 mesa_control[12047]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.4.0_IF1.fixpack
Sep 29 08:56:07 mesa_install_fixpack: 10.0.4.0_IF1 install successful
Sep 29 08:56:07 mesa_control[12047]: Fixpack /tmp/fixpacktmpdir/10.0.4.0_IF1.fixpack: install successful
Apr  6 10:13:43 mesa_control[17018]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
Apr  6 10:14:37 mesa_install_fixpack: 10.0.5.0_IF1 install successful
Apr  6 10:14:37 mesa_control[17018]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful
Apr  6 10:58:38 mesa_control[18125]: Uninstalling fixpack 10.0.5.0_IF1
Apr  6 10:58:39 mesa_install_fixpack: 10.0.5.0_IF1 uninstall successful
Apr  6 10:59:04 mesa_control[18295]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
Apr  6 10:59:10 mesa_install_fixpack: 10.0.5.0_IF1 install successful
Apr  6 10:59:10 mesa_control[18295]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful
Apr 13 15:48:29 mesa_control[16813]: Installing fixpack from file /tmp/fixpacktmpdir/replace_db2jcc_10050.fixpack
Apr 13 15:48:29 mesa_install_fixpack: replace_db2jcc_10050 install successful
Apr 13 15:48:29 mesa_control[16813]: Fixpack /tmp/fixpacktmpdir/replace_db2jcc_10050.fixpack: install successful
Apr 13 15:52:23 mesa_control[19526]: Uninstalling fixpack replace_db2jcc_10050
Apr 13 15:52:23 mesa_install_fixpack: replace_db2jcc_10050 uninstall successful{noformat}



We need to isolate whether this is upgrade related or purely down to an incompatibility between the extension and 10.0.6. Unfortunately, we don’t have a Dynatrace server to try ourselves in the lab (although I am still looking into getting access to one). 

Since uninstalling the extension at 10.0.6, has the customer tried re-installing the extension? Can we get them to try: 

# set debug.level=2
# install extension
# restart runtimes
# generate and provide support file.

Thanks. ","24/Jun/23 4:43 AM;5bac25a83a6aa22dbebb46cf;OK...the steps I followed are listed below...If we need the extension installed when the support file is generated let me know and I can modify these...Hopefully these steps generated needed log data to troubleshoot...



# Logged into LMI
# Enabled debug.level=2 ATP and Saved/Deployed Changes
# Installed/Configured Dynatrace Extension from LMI
## REST doesn't seem to work for this, or I can't figure out what needs to be done/provided based on documentation
# Issued ""isam aac restart"" from SSH command line while tailing logs in another SSH session
# Received the following error message...

[dev-aismpdm01.bbtnet.com|https://dev-aismpdm01.bbtnet.com]> isam aac restart

/workspace/src/appliance/app-core/modules/config_mga_rtprofile.cpp:2157 - WGAWA0308I The server has been stopped.

/workspace/src/appliance/app-core/modules/config_mga_rtprofile.cpp:1997 - Error: WGAWA0003I An error occurred while executing the command: /opt/IBM/wlp/bin/server start runtime (0x16)

/workspace/src/appliance/app-core/modules/config_mga_rtprofile.cpp:2010 - WGAWA0307E The server failed to start correctly.



# Issued ""lmi restart"" from SSH command line while tailing logs from another SSH session
# LMI appeared to restart properly with no error messages on the SSH side of things when the command returned
# However, attempting to return to the LMI home page results in a connection closed error in the browser so the LMI is not functioning as expected.



I did not reboot after installing the extension this time, just simply restarted the Liberty runtimes for AAC & LMI, but something in the Dynatrace injection appears to be causing an issue either at the JDK level or the Liberty level it seems...I did not try disabling the options for Runtime and LMI monitoring on the extensions configuration screen, but that may be a temporary workaround so that we can at least get OS level metrics out of the sandbox at the 10.0.6.0 firmware level until we have a solution.



# Issued ""extensions remove dynatraceOneAgent"" from SSH command line
# Issued ""lmi restart"" from SSH command line
## LMI restarted successfully
# Issued ""isam aac restart"" from SSH command line
## AAC Runtime restarted successfully
# Generated Support File
# Removed debug.level=2 ATP and Saved/deployed Changes



I have attached the new support file...Let me know if you need anything else...Oddly this new support file is only a little over half the size of the original one so I hope it contains all the needed information...","03/Jul/23 5:08 PM;5b232b2fd85e5b59b066f57f;There are a few left over logs from the 10.0.5 installation of the Dynatrace client and based on this I can see that the customer’s Dynatrace server is now providing a newer version of the OneAgent client to ISVA: 

{noformat}$ grep -e ""Distribution"" -e ""Installation started"" /ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/var/log/dynatrace/oneagent/installer/installation*
/ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/var/log/dynatrace/oneagent/installer/installation_14452.log:2023-06-21 18:12:06 UTC [INFO] Installation started, version 1.261.201.20230315-145944, build date: 15.03.2023, PID 14452.
/ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/var/log/dynatrace/oneagent/installer/installation_14452.log:2023-06-21 18:12:06 UTC [INFO] Distribution: isva 10.0.6.0
/ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/var/log/dynatrace/oneagent/installer/installation_29596.log:2023-01-19 13:58:11 UTC [INFO] Installation started, version 1.255.195.20230105-130024, build date: 05.01.2023, PID 29596.
/ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/var/log/dynatrace/oneagent/installer/installation_29596.log:2023-01-19 13:58:11 UTC [INFO] Distribution: isva 10.0.5.0
/ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/var/log/dynatrace/oneagent/installer/installation_29679.log:2023-06-23 18:03:59 UTC [INFO] Installation started, version 1.263.138.20230405-022541, build date: 05.04.2023, PID 29679.
/ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/var/log/dynatrace/oneagent/installer/installation_29679.log:2023-06-23 18:04:00 UTC [INFO] Distribution: isva 10.0.6.0{noformat}

i.e. when this was working, ISVA was at v10.0.5 and v{{1.255.195.20230105-130024}} of the OneAgent client was installed. 

In order to isolate the OneAgent version as a factor, is there anyway that the customer can modify their Dynatrace server so that it will again provide v{{1.255.195.20230105-130024}} of the client to their ISVA v10.0.6 instance? Also note that there is now an even newer version available (v1.267 as of 07JUN - [https://www.dynatrace.com/support/help/whats-new/release-notes/oneagent|https://www.dynatrace.com/support/help/whats-new/release-notes/oneagent|smart-link] )

I suspect the below is the issue - although I’m not entirely sure what it means at this stage (we may need support from Dynatrace): 

{noformat}$ cat /ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/var/log/dynatrace/oneagent/process/ruxitagentproc_2023-06-23_5000.log
2023-06-23 18:04:31 UTC [10831] info    [general   ] version 1.263.138.20230405-022541, 64 bit, exe: ""/opt/java/jre/bin/java""
2023-06-23 18:04:31 UTC [10831] info    [hooking   ] Injection of java agent skipped: Main class missing
2023-06-23 18:04:31 UTC [10831] info    [hooking   ] argv[0]: /opt/java/jre/bin/java
2023-06-23 18:04:31 UTC [10831] info    [hooking   ] argv[1]: -version
2023-06-23 18:04:31 UTC [10831] info    [hooking   ] argv[0]: /opt/java/jre/bin/java
2023-06-23 18:04:31 UTC [10831] info    [hooking   ] argv[1]: -version
2023-06-23 18:04:43 UTC [11147] info    [general   ] version 1.263.138.20230405-022541, 64 bit, exe: ""/opt/java/jre/bin/java""
2023-06-23 18:04:43 UTC [11147] info    [hooking   ] Injection of java agent skipped: Agent already present{noformat}",03/Jul/23 5:09 PM;5b232b2fd85e5b59b066f57f;Also - does the customer still have a 10.0.5 instance with Dynatrace OneAgent installed? ,"06/Jul/23 4:54 AM;5bac25a83a6aa22dbebb46cf;I would need to check with our internal Dynatrace team to see if we can get the older version of the client loaded...We just point the extension to an Artifactory location that pulls the latest version of the agent installer script that is provided by that internal team...We do still have appliances running at the v10.0.5.0 firmware level that are working properly with Dynatrace using whatever agent version was pulled at the time that the firmware was updated for those specific environments...I don't think the agent version will auto-update on these appliances when a newer version is made available from the Dynatrace servers in our environment since they are manually installed...

I can pull a list of those agent versions from the installer logs in each of those environments if needed.

As far as the newer version of the Dynatrace agent, if that version has been tested by our internal Dynatrace team, then it would be made available at the Artifactory link that we use when configuring the extension. I can reach out to them to verify whether making the newer or the older version of the agent available at the link we use is an option so that we can test...

It does look like that we already have a more recent version of the agent at the path as I just tried to reinstall the extension again a few mins ago...

1     2023-07-05 18:41:13 UTC [INFO] Logging to /var/log/dynatrace/oneagent/installer/installation_28243.log

2     2023-07-05 18:41:13 UTC [INFO] Installation started, version 1.263.138.20230405-022541, build date: 05.04.2023, PID 28243.

It looks like the issue still exists with this version of the agent as well...

[dev-aismpdm01.bbtnet.com|http://dev-aismpdm01.bbtnet.com]> isam aac restart

WGAWA0308I  The server has been stopped.

Error: WGAWA0003I  An error occurred while executing the command: /opt/IBM/wlp/bin/server start runtime (0x16)

WGAWA0307E  The server failed to start correctly.

Local Runtime Status

Runtime Status:Stopped

Last Started:Jun 23, 2023, 2:13:24 PM

Last Reloaded:Jun 23, 2023, 2:13:24 PM

Restart Required:False

Reload Required:False

The LMI restart does appear to be successful with this one however...

I can run the debug and upload a new support file if needed with this version, but I will also reach out to our internal Dynatrace team to see about making the older 1.255.x version of the agent available or if we can get the most recent 1.267 version pushed out to see if either of those will work as expected.","06/Jul/23 1:45 PM;5b232b2fd85e5b59b066f57f;[~accountid:5bac25a83a6aa22dbebb46cf] - thanks. If we can get 10.0.6 to point to the old dynatrace version we can isolate whether the dynatrace version is a factor. 

The customer mentions that they have a 10.0.5 instance currently running without issue - can we get a support file from here? That way I will have a full set of dynatrace log files from a working case to compare against. *For my reference* - want to check for existance of equivalent: “var/extensions//dynatraceOneAgent/dynatrace_oneagent_installer.sh: /etc/lsb-release: line 3: 10.0.6.0: not found”

The other datapoint that would be good to see is if we can get a copy of the dynatrace_oneagent_installer.sh script for the different dynatrace versions. ","07/Jul/23 5:29 AM;5bac25a83a6aa22dbebb46cf;Customer has provided support files and updated the following:
I have reached out to our internal Dynatrace team to see if we can get different versions of the OneAgent installer pushed out to the Artifactory link that we use as the input to the extension configuration screen so that the virtual appliances pull and install the agent...Once I hear back from them I will see if we can test with the 3 versions below that are working as well as the most recent 1.267 version if they can put that one out there.

I have included support files from our 4 non-prod envs that are all running 10.0.5.0 with the 10.0.5.0_IF1 fixpack currently...A summary of OneAgent versions for each is below...

Agent Versions as reported from within the Dynatrace console

dif-aismpdm01

* v10.0.5.0_IF1
* Dynatrace OneAgent Version 1.257.250.20230202-090730

sif-aismpdm01

* v10.0.5.0_IF1
* Dynatrace OneAgent Version 1.257.250.20230202-090730

uif-aismpdm01

* v10.0.5.0_IF1
* Dynatrace OneAgent Version 1.257.250.20230202-090730

lif-aismpdm01

* v10.0.5.0_IF1
* Dynatrace OneAgent Version 1.259.339.20230228-182655

pif-aismpdm01 (Production, no support file for this one)

* v10.0.4.0_IF1
* Dynatrace OneAgent Version 1.227.157.20211116-102348

It does look like from the extensions/dynatraceOneAgent_install.log on each that a similar issue for each of the respective appliance firmware versions exists when the agent installer script kicks off after downloading from the Artifactory repository.

4348   12:32:45 Installation started, version 1.257.250.20230202-090730, build date: 02.02.2023, PID 13388.

4349   12:32:45 Detected platform: LINUX arch: X86_64

4350   /var/extensions//dynatraceOneAgent/dynatrace_oneagent_installer.sh: /etc/lsb-release: line 3: 10.0.5.0: not found

4351   12:32:46 Checking free space in /var/extensions/dynatraceOneAgent/install

4366   11:51:46 Installation started, version 1.259.339.20230228-182655, build date: 28.02.2023, PID 13117.

4367   11:51:46 Detected platform: LINUX arch: X86_64

4368   /var/extensions//dynatraceOneAgent/dynatrace_oneagent_installer.sh: /etc/lsb-release: line 3: 10.0.5.0: not found

4369   11:51:46 Checking free space in /var/extensions/dynatraceOneAgent/install

3463   01:46:36 Installation started, version 1.227.157.20211116-102348, build date: 16.11.2021, PID 17685.

3464   01:46:36 Detected platform: LINUX arch: X86_64

3465   /var/extensions//dynatraceOneAgent/dynatrace_oneagent_installer.sh: /etc/lsb-release: line 3: 10.0.4.0: not found

3466   01:46:36 Checking free space in /var/extensions/dynatraceOneAgent/install","07/Jul/23 6:32 AM;5bac25a83a6aa22dbebb46cf;It doesn't look like any of the specific versions below are currently available in the Artifactory repo based on the screenshot, so I will need to wait for the Dynatrace team to respond...I did pull the latest script that was out there and have uploaded it...It appears to be the following version of the agent...

readonly AGENT_BUILD_DATE=29.06.2023

readonly AGENT_INSTALLER_VERSION=1.265.186.20230628-225725

readonly INTERNAL_TAR_FILE_NAME=Dynatrace-OneAgent.tar.xz","07/Jul/23 11:18 AM;5bac25a83a6aa22dbebb46cf;It looks like this later version 1.265.186 that is available on our side of things as of today causes both the LMI and AAC runtimes to fail to restart properly...

[dev-aismpdm01.bbtnet.com|https://dev-aismpdm01.bbtnet.com]> isam aac restart

WGAWA0308I The server has been stopped.

Error: WGAWA0003I An error occurred while executing the command: /opt/IBM/wlp/bin/server start runtime (0x16)

WGAWA0307E The server failed to start correctly.

I did try to restart the AAC runtime multiple times with this version of the agent loaded and while tailing the logs it looks like it just randomly hangs at different points in the startup process with the Dynatrace agent installed...","10/Jul/23 1:35 PM;5b232b2fd85e5b59b066f57f;Yes - there doesn’t seem to be any indication of what the issue is in the logs - the JVM just seems to hang on start. 

Not sure of the relevance of any of the below - but a few observations:

1. In 10.0.6, Semeru and J9 were updated ([https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|smart-link] / [https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|smart-link] ) to JDK/Semeru v11.0.19+7 with v0.38 of J9; this version of J9 is not listed in the Dynatrace support matrix (from [https://www.dynatrace.com/support/help/setup-and-configuration/technology-support/application-software/java/support-for-jvms|https://www.dynatrace.com/support/help/setup-and-configuration/technology-support/application-software/java/support-for-jvms|smart-link] ) - although we were at version higher than these in 10.0.5 where it worked (11.0.16.1+1 / 0.33.1): 

!image-20230710-015115.png|width=923,height=431!

2. Hang can be seen in /ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/trace_23.06.23_14.12.56.0.log

3. [https://cloudidentity.atlassian.net/browse/ISAMSUP-4731|https://cloudidentity.atlassian.net/browse/ISAMSUP-4731|smart-link] indicates that setting ATP “runtime_profile.enable.monitor=true” can cause the issue - but it seem this is not set in the customer’s 10.0.6 environment. [~accountid:5bac25a83a6aa22dbebb46cf] - *can we get the customer to confirm?*  Interestingly, “runtime_profile.enable.monitor” is explicitly set to “false” in their 10.0.5 environment. 

4. The trace spec between 10.0.5 and 10.0.6 environments differs. Given where the runtime appears to be hanging, [~accountid:5bac25a83a6aa22dbebb46cf] - *can we get the customer to turn off all trace for LMI and runtime and try re-enabling dynatrace?* 



In the mean time I’m trying to get access to a Dynatrace server so I can play around with this in the lab. ","11/Jul/23 2:01 AM;5bac25a83a6aa22dbebb46cf;Customer updates:
As a side note while I am waiting for a response from our Dynatrace team...We updated production to the v10.0.5.0 firmware tonight and when I reinstalled the extension/agent there, it pulled v1.263.202.20230628-225614 of the agent script and there do not appear to be any issues with that combination so it does appear to possibly be related to the agent/firmware combination at the v10.0.6.0 level...Might be the newer Semeru runtime and we might need the very latest agent for that to function properly...

I will provide another update likely on Monday at some point once I can get in touch with our internal Dynatrace team...

I was able to work with our internal Dynatrace team this morning and pulled the latest 1.267 agent with the 10.0.6.0 firmware. That combination is still causing issues with both the LMI and the AAC Runtime. If you need me to pull any debug data for that combination let me know and I can pull a support file after adding the ATP and reinstalling the agent at the 1.267 level...

4444     10:44:22 Installation started, version 1.267.155.20230629-142023, build date: 29.06.2023, PID 15482.

[dev-aismpdm01.bbtnet.com|http://dev-aismpdm01.bbtnet.com]> isam aac restart

WGAWA0308I  The server has been stopped.

Error: WGAWA0003I  An error occurred while executing the command: /opt/IBM/wlp/bin/server start runtime (0x16)

WGAWA0307E  The server failed to start correctly.

I will also ask our Dynatrace team to put the 1.255 version of the agent back so that I can pull that one at the 10.0.6.0 firmware level and test with it...","11/Jul/23 3:05 AM;5bac25a83a6aa22dbebb46cf;We do not have the ATP for runtime_profile.enable_monitor set in any of our environments currently...

We had to remove that as a part of an earlier support case when the Dynatrace extension/agent was causing other issues...I don't recall if that was at the 10.0.4.0 firmware update or at the 10.0.5.0 update.

I have removed the following trace settings from LMI and AAC runtimes...

[https://dev-aismpdm01.bbtnet.com/admin_cfg|https://dev-aismpdm01.bbtnet.com/admin_cfg]

LMI Tracing

*=config=enabled

[https://dev-aismpdm01.bbtnet.com/mga/runtime_tuning|https://dev-aismpdm01.bbtnet.com/mga/runtime_tuning]

Runtime Tracing

com.tivoli.am.fim._=ALL:com.tivoli.am.rba._=ALL

Reinstalled the Dynatrace extension

12:45:19 Installation started, version 1.267.155.20230629-142023, build date: 29.06.2023, PID 1207.

Restarted LMI from SSH (Still hanging and not restarting properly)

[dev-aismpdm01.bbtnet.com|http://dev-aismpdm01.bbtnet.com]> lmi restart

No errors at the SSH command line, but browser is failing to connect.

Restarted AAC Runtime from SSH (still failing)

[dev-aismpdm01.bbtnet.com|http://dev-aismpdm01.bbtnet.com]> isam aac restart

WGAWA0308I  The server has been stopped.

Error: WGAWA0003I  An error occurred while executing the command: /opt/IBM/wlp/bin/server start runtime (0x16)

WGAWA0307E  The server failed to start correctly.","11/Jul/23 5:03 AM;5bac25a83a6aa22dbebb46cf;OK...I worked with our internal Dynatrace team as well and was able to get the older version of the agent pushed out...

v10.0.6.0 Firmware

14:40:18 Installation started, version 1.255.195.20230105-130024, build date: 05.01.2023, PID 23152.

LMI Restart failed

AAC Restarted successfully

Rebooted to confirm behavior after reboots

LMI and AAC runtimes both appear to start properly...","11/Jul/23 12:23 PM;5b232b2fd85e5b59b066f57f;OK - a few questions / points: 

# as a temporary measure / workaround, can the customer run with the older Dynatrace version? 
# Does the customer have a support agreement with Dynatrace? If so, are they able to raise a support ticket to see what their take is on this? 
# FOR SUPPORT ONLY - Interestingly, I found this - [https://www.ibm.com/support/pages/apar/PM02821|https://www.ibm.com/support/pages/apar/PM02821]. Sure enough, I can see a thread in WsLogger.registerTraceComponent in /ecurep/sf/TS013/392/TS013392640/0-all_data/isva_10.0.6.0_20230623-141617_dev-aismpdm01.bbtnet.com.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/javacore.20230623.140516.11411.0002.txt (i.e. the core taken during startup hang). While this APAR was for an older version of WebSphere (v7), it could be a regression or similar issue in Liberty. Can we get a support ticket open with Liberty support to take a look? ","12/Jul/23 10:39 AM;5bac25a83a6aa22dbebb46cf;For additional data, I updated the agent to 1.267 in our DEV environment today (v10.0.5.0_IF1) and that combination of the agent and firmware is working as expected...It appears something in the liberty runtime with the 10.0.6.0 firmware is having issues with the Dynatrace agent.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Enabling enabling pdweb debug or snoop on10.0.5  reverse proxy causes a crash with signal 11,ISAMSUP-5154,307687,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,20/Jun/23 7:05 PM,27/Jun/23 5:05 PM,14/Jul/23 2:47 PM,27/Jun/23 5:05 PM,,,,0,,,,"When the customer enables pdeweb debug or snoop on their 10.0.5 machine; it crashes.  A core dump was generated in the PMR support file. We asked for memory graphs. The affected appliance shows consistent high memory. A Signal 11 crash was also observed on another appliance with no apparent memory issues whwne a debug snoop trace was attempted. On my own 10.0.5 applaince when i set debug or snoop to 9; when i return to diable it shows zero?



David.",,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013240505,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,AQUAFIN NV,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cvov:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-20 23:14:58.049,,,,,21/Jun/23 9:14 AM;5b15d9517dab4c51f61b5190;This is IJ45228 fixed in 10.0.5.0 IF1,27/Jun/23 5:05 PM;5ac57757d9a96536d1f0daa9;No additional action for us on this item. Closing out the Jira item. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Customer needs to implement two STIGs related to the ISVA Docker,ISAMSUP-5149,307534,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Gabe,5b15d99b4c20165700edecad,Gabe,5b15d99b4c20165700edecad,20/Jun/23 4:52 AM,11/Jul/23 10:11 PM,14/Jul/23 2:47 PM,11/Jul/23 10:11 PM,,,,0,,,,"DoHL need two remediate two STIG findings in the ISVA Docker environment. 

The first is related to escalated privileges
[https://www.stigviewer.com/stig/docker_enterprise_2.x_linuxunix/2021-03-26/finding/V-235816|https://www.stigviewer.com/stig/docker_enterprise_2.x_linuxunix/2021-03-26/finding/V-235816|smart-link] 

And the second is read access to the root FS
[https://www.stigviewer.com/stig/docker_enterprise_2.x_linuxunix/2021-03-26/finding/V-235808|https://www.stigviewer.com/stig/docker_enterprise_2.x_linuxunix/2021-03-26/finding/V-235808]



Implementing either of these remediation options causes the ISVA 10.0.4 Docker to no longer boot. Do we have a workaround that would still allow them to covers these security findings?

--security-opt=no-new-privileges:true
ReadonlyRootfs

Also I did see this Jira but there aren’t a lot of details and at first glance doesn’t seem to be related. 
[https://cloudidentity.atlassian.net/browse/ISAMDEV-10097|https://cloudidentity.atlassian.net/browse/ISAMDEV-10097|smart-link] ",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013352614,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Gabe,5b15d99b4c20165700edecad,,,,Dept of Homeland Security,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cur3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-06-21 03:57:12.271,,,,,21/Jun/23 1:57 PM;5b232b2fd85e5b59b066f57f;Discussing with Dev Team,"21/Jun/23 5:20 PM;5b232b2fd85e5b59b066f57f;The Development Team is aware of these limitations and there has been previous effort looking into restricting privileges; however, at this stage, this is not currently supported. ","23/Jun/23 8:52 AM;5b15d9936d76184b7d989c82;customer asked for confirmation that limitation mentioned applies to both settings:

--security-opt=no-new-privileges:true

--read-only   (for root filesystem)",23/Jun/23 3:17 PM;5b232b2fd85e5b59b066f57f;yes,11/Jul/23 11:05 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d99b4c20165700edecad] do you need anything else for this item?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unable to create support file on Production appliances,ISAMSUP-5147,307441,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,19/Jun/23 6:21 PM,14/Jul/23 10:26 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"The client is able to create support file with all options expect only ""SYSTEM"".



When selecting ""SYSTEM"" support file fails to generate.",,Dermot Daly,,,,,,,,,,,,,,,6092ac9ff6c0960069d47a67,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-3354,,,,ISAMSUP-5189,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012145511,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,OP OSUUSKUNTA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-04-27/&filepath=TS012145511/2023-04-27/data_SYSTEM_Only.zip

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-05-22/&filepath=TS012145511/2023-05-22/Support_File_Creation_issue_test_19052023.JPG

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-05-22/&filepath=TS012145511/2023-05-22/supportfile_creation_issue_after_restart_22052023.JPG

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-05-22/&filepath=TS012145511/2023-05-22/data_SYSTEM_Only_Before_Restart.zip

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-05-22/&filepath=TS012145511/2023-05-22/data_SYSTEM_ONLY_After_Restart_22052023.zip",,,,,,,,,,,,,,,,,,,,,,,0|i1cu4v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.0.1,,,,,,,,,,,,,2023-06-21 01:35:30.577,,,,,21/Jun/23 11:35 AM;5b232b2fd85e5b59b066f57f;Likely known issue which is fixed in 10.0.4 - re [https://cloudidentity.atlassian.net/browse/ISAMSUP-3354|https://cloudidentity.atlassian.net/browse/ISAMSUP-3354|smart-link],26/Jun/23 7:18 PM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f] client is not willing to upgrade to v 10.0.4 they are requesting for a workaround.,27/Jun/23 12:42 PM;5b232b2fd85e5b59b066f57f;[~accountid:61409dc154762c006932ffc7] - can you confirm what version the customer is currently running? Are they really on 10.0.0.1 as you have indicated in the “Version” field of this WI - or are they on 10.0.1.0? I can’t tell from their support files as they have renamed them and seem to have only uploaded partial contents. ,27/Jun/23 5:23 PM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f] yes they are at v10.0.1,28/Jun/23 2:17 PM;5b232b2fd85e5b59b066f57f;Fix-pack available at [https://cloudidentity.atlassian.net/browse/ISAMSUP-5189|https://cloudidentity.atlassian.net/browse/ISAMSUP-5189|smart-link],"12/Jul/23 11:28 PM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f] client tried to apply the fixpack provided by you in our dev/test environment to check the impact of fixpack.

But it got failed. Attaching the error screenshot and logs from application logs section for your reference

Error Logs: 

15422   [7/12/23 13:48:01:836 EEST] 0001661c com.ibm.mesa.extension.pending_changes.PendingChangesMga   E Error response code received from URL : [https://localhost:9443/mga/scim/configuration/private_pending_changes|https://localhost:9443/mga/scim/configuration/private_pending_changes] : 400

15423   [7/12/23 13:50:20:071 EEST] 0001661a com.ibm.mesa.extension.pending_changes.PendingChangesMga   E Error response code received from URL : [https://localhost:9443/mga/scim/configuration/private_pending_changes|https://localhost:9443/mga/scim/configuration/private_pending_changes] : 400

15424   [7/12/23 13:52:34:756 EEST] 0001661f com.ibm.mesa.extension.pending_changes.PendingChangesMga   E Error response code received from URL : [https://localhost:9443/mga/scim/configuration/private_pending_changes|https://localhost:9443/mga/scim/configuration/private_pending_changes] : 400

Note: We are not facing any issues in our dev/test environment for generating the support file.

The issue is in PROD environment.

Attaching support file from dev/test environment as well.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-07-12/&filepath=TS012145511/2023-07-12/Fixpack_error.png|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-07-12/&filepath=TS012145511/2023-07-12/Fixpack_error.png]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-07-12/&filepath=TS012145511/2023-07-12/isva_10.0.1.0_20230712-140800_devopset2mgr1.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-07-12/&filepath=TS012145511/2023-07-12/isva_10.0.1.0_20230712-140800_devopset2mgr1.support]","13/Jul/23 12:45 AM;5b232b2fd85e5b59b066f57f;[~accountid:61409dc154762c006932ffc7] Why do they have the dev fix-pack? They tried to apply this - that is why it failed. 

And those pending change errors have nothing to do with the fix-pack. ","13/Jul/23 8:20 PM;61409dc154762c006932ffc7;they applied md5 fixpack([2023-07-13/support_file_fix.fixpack_1_.md5|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-07-13/&filepath=TS012145511/2023-07-13/support_file_fix.fixpack_1_.md5]) still they get 

Note: We still get the same error in teh application log files(message log) - 15433   [7/13/23 13:13:10:715 EEST] 000168bd com.ibm.mesa.extension.pending_changes.PendingChangesMga   E Error response code received from URL : [https://localhost:9443/mga/scim/configuration/private_pending_changes|https://localhost:9443/mga/scim/configuration/private_pending_changes] : 400",13/Jul/23 9:26 PM;61409dc154762c006932ffc7;[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-07-13/&filepath=TS012145511/2023-07-13/isva_10.0.1.0_20230713-132900_devopset2mgr1.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012145511&path=TS012145511/2023-07-13/&filepath=TS012145511/2023-07-13/isva_10.0.1.0_20230713-132900_devopset2mgr1.support],13/Jul/23 10:39 PM;5b232b2fd85e5b59b066f57f;[~accountid:61409dc154762c006932ffc7] - why are they applying an md5 file??? That is not a fixpack. ,13/Jul/23 10:39 PM;5b232b2fd85e5b59b066f57f;Again - that error has absolutely nothing to do with the fix-pack. ,"14/Jul/23 12:56 AM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f] sorry for confusion but the client is unable to create the support files on all production appliances and they do not want to upgrade from v10.0.1 previously it was mentioned the fix was available [https://cloudidentity.atlassian.net/browse/ISAMSUP-5147?focusedCommentId=673480|https://cloudidentity.atlassian.net/browse/ISAMSUP-5147?focusedCommentId=673480|smart-link] 

client is unable to generate a support file even if they select LMI or system.","14/Jul/23 10:21 AM;5b232b2fd85e5b59b066f57f;[~accountid:61409dc154762c006932ffc7] - 

I provided a fixpack for this on 28JUN (see my comment in this WI). Since then the customer has tried to apply the dev version of the fixpack and for some reason the md5 file. These failed - as expected. They will not work nor are they meant to. The customer needs to apply *support_file_fix.fixpack* ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Users are facing issues with the page rendering on ISAM9,ISAMSUP-5145,307116,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,William Hannon Jr,5b17571b91981f4fdde632c1,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,16/Jun/23 6:05 PM,11/Jul/23 6:28 PM,14/Jul/23 2:47 PM,,,Support,,0,,,,"The authentication mechanism used External authentication interface. The issue is users are facing issues with the page rendering issue where some of the content is is not in the correct format. URL : [https://eai-f-retail.rfs.barclays.co.uk/hudlive4|https://eai-f-retail.rfs.barclays.co.uk/hudlive4] - existing URL where app is currently accessed [https://eai-e-retail.rfs.barclays.co.uk/hudlive4|https://eai-e-retail.rfs.barclays.co.uk/hudlive4] - new URL where the page rendering issue Please find uploaded webseal config file and support files for all 6 appliances of WebSEAL cluster [eai-e-retail.rfs.barclays.co.uk|https://eai-e-retail.rfs.barclays.co.uk].





As per client

This is working without any issue on ISAM7 environment

[https://eai-f-retail.rfs.barclays.co.uk/hudlive4|https://eai-f-retail.rfs.barclays.co.uk/hudlive4]



The same is not working on ISAM9 environment.

ISAM9: [https://eai-e-retail.rfs.barclays.co.uk/hudlive4|https://eai-e-retail.rfs.barclays.co.uk/hudlive4]",,Aaron.Richie.Dias,Alan Wong,Ayush Singh,BRIANORO,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,Syed Hasan Jafar,,,,,,6194c472fe9f300068e5252f,6092aca0f0db130069d19687,61409dc154762c006932ffc7,6154906364ff01007106e189,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,617a5f2cf485cd0068cb98af,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013314512,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,BARCLAYS BANK PLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013314512&path=TS013314512/2023-06-14/&filepath=TS013314512/2023-06-14/isam_9.0.7.2_20230613-073530_eai-e-retail_glopvmasau01.zip,,,,,,,,,,,,,,,,,,,,,,,0|i1cs6v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.2,,,,,,,,,,,,,2023-06-16 12:32:34.309,,,,,16/Jun/23 10:32 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] can you please complete the initial assessment of this issue for our customer. ,"16/Jun/23 11:16 PM;5b17571b91981f4fdde632c1;Will check, but hopefully we have pdweb.snoop for both scenarios","17/Jun/23 1:11 AM;5b17571b91981f4fdde632c1;* Where is ISAM7 files
* ISAM9

{noformat}2023-06-14/isam_9.0.7.2_20230613-073530_eai-e-retail_glopvmasau01.zip_unpack/isam_9.0.7.2_20230613-073530_eai-e-retail_glopvmasau01.support_unpack/support.txt
2023-06-14/isam_9.0.7.2_20230613-074046_eai-e-retail_glopvmasau02.zip_unpack/isam_9.0.7.2_20230613-074046_eai-e-retail_glopvmasau02.support_unpack/support.txt
2023-06-14/isam_9.0.7.2_20230613-074347_eai-e-retail_slopvmasau01.zip_unpack/isam_9.0.7.2_20230613-074347_eai-e-retail_slopvmasau01.support_unpack/support.txt
2023-06-14/isam_9.0.7.2_20230613-074433_eai-e-retail_slopvmasau02.zip_unpack/isam_9.0.7.2_20230613-074433_eai-e-retail_slopvmasau02.support_unpack/support.txt
2023-06-14/isam_9.0.7.2_20230613-074540_eai-e-retail_slopvmasau03.zip_unpack/isam_9.0.7.2_20230613-074540_eai-e-retail_slopvmasau03.support_unpack/support.txt
2023-06-14/isam_9.0.7.2_20230613-074923_eai-e-retail_glopvmasau03.zip_unpack/isam_9.0.7.2_20230613-074923_eai-e-retail_glopvmasau03.support_unpack/support.txt{noformat}","17/Jun/23 1:17 AM;5b17571b91981f4fdde632c1;* ISAM 9.0.7.2 systems
** glop*
** slop*","17/Jun/23 1:33 AM;5b17571b91981f4fdde632c1;* no ‘pdweb.snoop’
** Waiting for data
** Require on {color:#bf2600}*both ISAM 7 and ISAM 9.0.7 scenarios*{color}
*** *pdweb.snoop*
**** After pdweb.snoop started
**** Then close browser (if open)
**** Wait 10 seconds
**** Then open fresh browser
*** *Enable browser har file* before starting request
**** Make sure browser
***** only does required steps
***** only does the failing sequence 
***** Then stops
*** Provide browser IP address ","04/Jul/23 6:23 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1]  we have requested files from customer 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013314512&path=TS013314512/2023-07-04/&filepath=TS013314512/2023-07-04/ISAM7_Snoop_Debug_logs.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013314512&path=TS013314512/2023-07-04/&filepath=TS013314512/2023-07-04/ISAM7_Snoop_Debug_logs.zip]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013314512&path=TS013314512/2023-07-04/&filepath=TS013314512/2023-07-04/eai-e-retail.rfs.barclays.co.uk-1688397788387.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013314512&path=TS013314512/2023-07-04/&filepath=TS013314512/2023-07-04/eai-e-retail.rfs.barclays.co.uk-1688397788387.log]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013314512&path=TS013314512/2023-07-04/&filepath=TS013314512/2023-07-04/ISAM7_Snoop_Debug_logs.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013314512&path=TS013314512/2023-07-04/&filepath=TS013314512/2023-07-04/ISAM7_Snoop_Debug_logs.zip]",06/Jul/23 7:42 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1] do we have any updates on this?,"07/Jul/23 2:38 AM;5b17571b91981f4fdde632c1;* [https://cloudidentity.atlassian.net/browse/ISAMSUP-5145?focusedCommentId=668219|https://cloudidentity.atlassian.net/browse/ISAMSUP-5145?focusedCommentId=668219|smart-link] 
** William Hannon Jr. June 16, 2023, 10:33 AM
*** Require on {color:#bf2600}*both ISAM 7 and ISAM 9.0.7 scenarios*{color}
**** From the customer’s 2023-07-04 data
***** Please show me specific file names
****** for each of the scenarios
****** for each of the requested items
****** [~accountid:5b15d9e6dda5f94d06b985b4] 
** Additional requests
*** Ask customer
**** Provide the specific URLs failing to render
**** Are the WebSEAL backend junction webserver(s) providing the SAME identical content between ISAM 7 and ISAM 9.0.7.0
*** Make sure we have WebSEAL conf files from recreate instances
**** Both ISAM 7 and ISAM 9.0.7",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
dynurl processing fails with internal error when expect:100-continue,ISAMSUP-5143,306785,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,15/Jun/23 2:04 PM,29/Jun/23 12:40 PM,14/Jul/23 2:47 PM,29/Jun/23 12:40 PM,10.0.7,Support Management,,0,,,,"Problem:

Customer has a junction and using dynurl to evaluate.

The client(utility) sends request in this order.



there is expect:100-continue



which means, client will not send data until gets a response with continue





Flow is like this:



# client(postman or any other client) sends Post with expect header client -----> webseal
# webseal will check and needs to forward export:100-continue to backend
## Webseal will check dyn url to make sure there is appropriate access to /lta/vrl/action/ptlsapplicationscreening
## this is where the setting suppress-dynurl-parsing-of-posts , comes in play
## when suppress-dynurl-parsing-of-posts = no
### then webseal will care about the body and will wait to read
### this looks to be a concern here as with expect request, there will not be a body so with expect, its expected to do a dynurl check without body
## when suppress-dynurl-parsing-of-posts = yes
### webseal will not care about body for dynurl check and will send the export:100-continue to the backend
## Backend will respond with 100-continue
## webseal will send 100-continue back to the client
## client will now send the actual data and webseal will again do the check





logs are here:

when **customer doesn’t want it to set to no as they cite security issues

#  suppress-dynurl-parsing-of-posts = yes

It works a webseal able to send the export:100-continue to backend



/ecurep/sf/TS013/274/TS013274578/2023-06-14/20230614c.zip_unpack/20230614c



dyn url config → /lta/vrl/F1801152ET /lta/vrl/action/PTLSApplicationScreening*

/ecurep/sf/TS013/274/TS013274578/2023-06-09/isva_10.0.5.0_20230609-164613_VRLUWEB03A.support_unpack/

(6) 2023-06-14-16:41:04.627 Client (172.21.2.41:38112) to WebSEAL (172.20.5.175:443) sending 1180 bytes
POST /lta/vrl/action/PTLSApplicationScreening HTTP/1.1



Non working case

#  suppress-dynurl-parsing-of-posts = no



/ecurep/sf/TS013/274/TS013274578/2023-06-14/20230614d.zip_unpack/20230614d

{noformat}(6) 2023-06-14-16:53:37.992 Client (x2.41:46852) to WebSEAL (x5.175:443) sending 1182 bytes
POST /lta/vrl/action/PTLSApplicationScreening HTTP/1.1
Host: vrluat-ilink
Max-Forwards: 20
Via: 1.1 traffic-786fb4dc6-9tzl9 ()
Expect: 100-continue
User-Agent: OutSystemsPlatform
X-Amzn-Trace-Id: Root=1-64898011-66859acb2a0ff7dc66a33677

X-Forwarded-Path: /lta/lta/VRLS/ApplicationScreening
X-Forwarded-Port: 443
X-Forwarded-Proto: https
X-Real-IP: 172
Content-Length: 23
Connection: keep-alive
X-CorrelationID: Id-11808964e15443ec6fbbceef 1
Content-Type: application/json; charset=UTF-8


(6) 2023-06-14-16:54:38.034 WebSEAL (x.175:443) to Client (x2.41:46852) sending 4828 bytes
HTTP/1.1 500 Internal Server Error
connection: close
content-length: 4438
content-type: text/html
date: Wed, 14 Jun 2023{noformat}",,Nick Lloyd,Tushar Prasad,Varun.Tyagi1,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,62d0e51aec233f24684a5d3a,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, IJ47266,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013274578,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,LTA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=9, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":9,""lastUpdated"":""2023-06-29T12:04:13.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":9,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cq5j:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-15 04:12:36.517,,,,,"15/Jun/23 2:12 PM;5b15d9517dab4c51f61b5190;I am pretty sure this is a defect.

I will recreate for myself ( thanks for the concise instructions)","15/Jun/23 6:46 PM;5c53d3ac23f5bf672621c868;HI Peter



I did some recreate. 



seems expect header works fine



but seems there is an issue related to content length



I am thinking content length would be 23 for this string *{""vehicleNo"":""PA5128A""}*



but that doesn’t seem to work



curl -k -v  -X POST -H ""Content-Type:application/json;charset=UTF-8"" -H ""Accept:"" -H ""expect: 100-continue"" -H ""Forwarded-For:9.30.92.99"" -H ""user-agent: OutSystemsPlatform"" -H ""via: 1.1 traffic-6ddf9f576c-lx24w ()"" -H ""x-amzn-trace-id: Root=1-6482c3c1-7234794f14505f9e2515b7a8"" -H ""content-length:23"" --data ""*{""vehicleNo"":""PA5128A""}*"" ""[https://9.30.92.79:444/nodejs/logrequest|https://9.30.92.79:444/nodejs/logrequest]""","15/Jun/23 7:17 PM;5c53d3ac23f5bf672621c868;but when I don’t put a content lenght then its picked as 17 



so looks like content length calculation is not correct

curl -k -v  -X POST -H ""Content-Type:application/json;charset=UTF-8"" -H ""Accept:"" -H ""expect: 100-continue"" -H ""Forwarded-For:9.30.92.99"" -H ""user-agent: OutSystemsPlatform"" -H ""via: 1.1 traffic-6ddf9f576c-lx24w ()"" -H ""x-amzn-trace-id: Root=1-6482c3c1-7234794f14505f9e2515b7a8""  --data ""*{""vehicleNo"":""PA5128A""}*"" ""[https://9.30.92.79:444/nodejs/logrequest|https://9.30.92.79:444/nodejs/logrequest]""



client is sending content-length as 23 for → *{""vehicleNo"":""PA5128A""}*""



looks like: expectation is 17","16/Jun/23 2:35 AM;5c53d3ac23f5bf672621c868;HI Peter



I would like to start from stating that by manipulating content-length , I am able to manipulate and get a similar error 

1193      2023-06-16-00:14:13.462+08:00I----- thread(6) trace.pdweb.wns.templates:8 /build/isam/src/i4w/pdweb/webseald/templates/MacroList.cpp:331: [9.43.239.68] MacroList::set(4, DPWWA1972E   Cannot read HTTP request from client)
1194      



--only difference in my case is

at 10.0.4.0 my env reads the data(customer is at 10.0.5.0) -

1193      2023-06-16-00:14:13.462+08:00I----- thread(6) trace.pdweb.wns.templates:8 /build/isam/src/i4w/pdweb/webseald/templates/MacroList.cpp:331: [9.43.239.68] MacroList::set(4, DPWWA1972E   Cannot read HTTP request from client)
1194      

----



suppress-dynurl-parsing-of-posts = yes

when customer toggles above, they get the same case working, when I toggle it doesn’t make a difference.



I am not able to make it work but customer does able to make it work. so figuring how mine is different than custoemers? ","16/Jun/23 2:55 PM;5c53d3ac23f5bf672621c868;Customer just told them they don’t explicitly put content-length

so that looks to be correct. my recreate is not valid.



at this point I don’t have a valid recreate of the issue. 

still wondering why customer is seeing issue ","16/Jun/23 2:57 PM;5c53d3ac23f5bf672621c868;from customer trace: looks like the problem is always here

2023-06-14-16:54:38.028+08:00I----- thread(6) trace.pdweb.wan.server:8 /build/isam/src/i4w/pdweb/webseald/http/server/WsSslListener.cpp:2082: [172.21.2.41] CII EXIT: WsSslConnector::read

2023-06-14-16:54:38.028+08:00I----- thread(6) trace.pdweb.wns.authn:6 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:4090: [172.21.2.41] CEI EXIT process_junction with status=0x38cf07b4","16/Jun/23 5:20 PM;5b15d9517dab4c51f61b5190;Need to check the behaviour of curl

with the expects header - the client doesn’t send the post data until it gets a 100 continue back

I expect client puts in the Content-Length header without customer needing to.

So my guess is that webseal is seeing the content-length and trying to read the post data  - but client isnt sending post data  - is waiting for a 100 response before sending - but never gets it

Need to check whether curl waits for 100 response - or just sends post data in initial request","16/Jun/23 5:51 PM;5c53d3ac23f5bf672621c868;Thanks Peter



I confirmed customer is using Postman

I tried postman but couldnt get the issue to recreate.

You are right. Customer is not putting content-lenght. its the postman doing it. 

so that seems to be correct. (the value of content-length to be 23)



strange how customer is able to reproduce it every time. 

when they suppress-dynurl-parsing-of-posts = yes 



everything works okay.



For now I evaluated it looks like for them its okay to set suppress-dynurl-parsing-of-posts = yes without having any security concerns but still I would like to check what kind of acls they have applied","19/Jun/23 6:40 PM;5b15d9517dab4c51f61b5190;I think the problem with your recreate was that you need to escape the inner quotes

{noformat} --data ""{\""vehicleNo\"":\""PA5128A\""}""{noformat}

Failure happens because times out reading the body (after a minute)

{noformat}2023-06-14-16:53:38.004+08:00I----- thread(6) trace.pdweb.wan.server:8 /build/isam/src/i4w/pdweb/webseald/http/server/WsSslListener.cpp:2025: [172.21.2.41] CII Entry: WsSslConnector::read
2023-06-14-16:54:38.028+08:00I----- thread(6) trace.pdweb.wan.server:8 /build/isam/src/i4w/pdweb/webseald/http/server/WsSslListener.cpp:2082: [172.21.2.41] CII EXIT: WsSslConnector::read
2023-06-14-16:54:38.028+08:00I----- thread(6) trace.pdweb.wns.authn:6 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:4090: [172.21.2.41] CEI EXIT process_junction with status=0x38cf07b4
{noformat}

because client is waiting for 100 continue before sending

Still trying to reproduce","19/Jun/23 9:16 PM;5b15d9517dab4c51f61b5190;curl by default only waits 1 second for the 100 continue - then sends the body anyway

this is what is preventing the reproduction

You can tell it to wait longer using  --expect100-timeout 70

With this I have reproduced the issue

to speed it up - I set intra-connection-timeout = 5 

default is 60

From my trace

{noformat}2023-06-19-21:02:28.640+10:00I----- thread(6) trace.pdweb.wan.server:8 /build/isam/src/i4w/pdweb/webseald/http/server/WsSslListener.cpp:2025: [10.150.27.91] CII Entry: WsSslConnector::read
2023-06-19-21:02:33.646+10:00I----- thread(6) trace.pdweb.wan.server:8 /build/isam/src/i4w/pdweb/webseald/http/server/WsSslListener.cpp:2082: [10.150.27.91] CII EXIT: WsSslConnector::read
2023-06-19-21:02:33.646+10:00I----- thread(6) trace.pdweb.wns.authn:6 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:4090: [10.150.27.91] CEI EXIT process_junction with status=0x38cf07b4
...
2023-06-19-21:02:33.649+10:00I----- thread(6) trace.pdweb.wns.templates:8 /build/isam/src/i4w/pdweb/webseald/templates/MacroList.cpp:277: [10.150.27.91] MacroList::get(3)  
2023-06-19-21:02:33.649+10:00I----- thread(6) trace.pdweb.wns.templates:8 /build/isam/src/i4w/pdweb/webseald/templates/MacroList.cpp:287: [10.150.27.91] MacroList::get(3) -> 0x38cf07b4
2023-06-19-21:02:33.649+10:00I----- thread(6) trace.pdweb.wns.templates:8 /build/isam/src/i4w/pdweb/webseald/templates/MacroList.cpp:178: [10.150.27.91] MacroList::nameToId(ERROR_TEXT)
2023-06-19-21:02:33.649+10:00I----- thread(6) trace.pdweb.wns.templates:8 /build/isam/src/i4w/pdweb/webseald/templates/MacroList.cpp:188: [10.150.27.91] MacroList::nameToId(ERROR_TEXT) = 4
2023-06-19-21:02:33.649+10:00I----- thread(6) trace.pdweb.wns.templates:8 /build/isam/src/i4w/pdweb/webseald/templates/MacroList.cpp:277: [10.150.27.91] MacroList::get(4)
2023-06-19-21:02:33.649+10:00I----- thread(6) trace.pdweb.wns.templates:8 /build/isam/src/i4w/pdweb/webseald/templates/MacroList.cpp:287: [10.150.27.91] MacroList::get(4) -> DPWWA1972E   Cannot read HTTP request from client
...
       {noformat}","19/Jun/23 9:49 PM;5b15d9517dab4c51f61b5190;I think there is a contradiction of requirements if we have

both suppress-dynurl-parsing-of-posts = no and expects header

The client wont send the post data until it gets a 100 continue response

But for the reverse proxy to return a 100 continue response, - it would need to first send the request to the junction

and have the junction return a 100 continue

But we can only send a request to the junction after the request has been authorized

So I think. what this means is we need to suppress dyn url parsing of POST requests when the request contains the expect header

ie even when suppress-dynurl-parsing-of-posts = no

Please create an APAR “Reverse proxy issue with dynurl POST requests containing expect header”

IBM Internal only

{noformat}if ( !g_suppress_dynurl_parsing_of_posts &&
    (request->getMethod() == ""POST"") && 
(( request->getContentLength(&isValid) > 0 ) || request->isChunked() )) {

    const char *body = NULL;
    size_t bytesRead = 0;
bool entireBody;

    *status = request->getRealMessageBody().peekDechunkedBody(
			    &body, &bytesRead, &entireBody);{noformat}

We dont take the expect header into account when deciding that we  need the body

So when the expect header is present getRealMessageBody will fail because body wont be sent by the client.

We need to add check that request doesn't contain expect header before calling getRealMessageBody

I have verified that the following code fixes the issue in my reproduction environment

{noformat}    if ( !g_suppress_dynurl_parsing_of_posts &&
        (request->getMethod() == ""POST"") &&
        (request->getHeaders().get(HTTPHDR_EXPECT) == 0x00) &&
        (( request->getContentLength(&isValid) > 0 ) || request->isChunked() )) {

        const char *body = NULL;
        size_t bytesRead = 0;
        bool entireBody;

        *status = request->getRealMessageBody().peekDechunkedBody(
                                    &body, &bytesRead, &entireBody);
{noformat}","20/Jun/23 11:32 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9517dab4c51f61b5190] 

Thanks for the update.



Here is the APAR created: IJ47266



can we also have the fix made available for the customer at 10.0.5.0 ( customer is escalating to fix the issue with RCA)

There is no explicit fixpack applied



* /usr/sbin/mesa_control fixpack_get_history","20/Jun/23 12:49 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 3ccde059752b4c4127da86bb085a275a7ee0897c
   * description: ISAMSUP-5143 issue with dynurl POST requests containing expect header

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1521751.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5143) which we publish.","23/Jun/23 12:51 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 505c89fe3a9ad0bd66bbac54d84dc468e97de43d
   * description: ISAMSUP-5143 IJ47266 dynurl POST requests containing expect header

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1686430.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5143) which we publish.","23/Jun/23 2:00 PM;5b15d9517dab4c51f61b5190;Documenting work around Following slack discussion with [~accountid:5c53d3ac23f5bf672621c868] 

The setting

proxy-expect-header=no

fixes the issue

The code change is only needed where proxy-expect-header=yes

i.e when cant set proxy-expect-header=no due to other (application) constraints","26/Jun/23 4:26 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 4bc530265cc919544c9d78db1056733881197f3d
   * description: Revert ""ISAMSUP-5143 IJ47266 dynurl POST requests containing expect header""

This reverts commit 505c89fe3a9ad0bd66bbac54d84dc468e97de43d.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1759373.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5143) which we publish.","27/Jun/23 1:25 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9517dab4c51f61b5190] 

* Customer agreed to close the case and accept suppress-dyurl-parsing-of-posts=yes as solution



On other note: I would also like to conclude this issue:



At present, As you summarized earlier there is lot of contradiction requirement

1.expect header to be sent to the backend

2.Not to suppress post data (which is valid requirement)



I like the fix where post data parsing is suppressed when expect header is present.(instead of proxy-expect-header setting as customers may have multiple junctions and in all cases they wouldn’t want reverse proxy to respond to expect header)

* This can be possible
* when expect header comes , it can be sent to the backend (as of bypassing the dynurl evaluation)
*  next when client sends post data it can further be evaluated against dynurl processing. (seems this may not be possible as we may not keep track which expect 100-continue is already responded to) . Is there a way to sense that if there is body and expect available webseal can do dynurl processing(if applicable)
* the above can be enabled via a configuration option
* but if , only option is supress entire post data processing for dynurl when expect header is present
** can this be enabled on per resource basis , instead of suppressing post data evaluation for all expect cases 
** For customers, for some resources they may need post data evaluation during dynurl processing with expect header
* I know requirement is contradicting with expect and dynurl processing ","27/Jun/23 2:13 PM;5b15d9517dab4c51f61b5190;[~accountid:5c53d3ac23f5bf672621c868] 

I talked it over with development yesterday - we came to the same conclusion as your second option

So to clarify case when suppress-dyurl-parsing-of-posts=no

If also have proxy-expect-header = no - then post data will always be available for dyn url

But if you have proxy-expect-header = yes - then post data will be available for dyn url except in the case where

the request contains and expect header.

Why the first way you describe is not possible

Dyn URL processing must be completed before sending anything to the junction - as it is checking whether request is authorized to access the junction.

So if we were to send the request to the backend, pass the 100 continue back to the browser, receive the post body - it is too late to then say the request is not authorized to access the junction - as we already have started the request  and the junction server is waiting for the post body

What I think you are asking for with the configuration option 

{noformat}but if only option is supress entire post data processing for dynurl when expect header is present
can this be enabled on per resource basis , instead of suppressing post data evaluation for all expect cases 
For customers, for some resources they may need post data evaluation during dynurl processing with expect header{noformat}

is a per junction proxy-expect-header setting

This is getting into RFE territory ","27/Jun/23 11:10 PM;5c53d3ac23f5bf672621c868;Thanks [~accountid:5b15d9517dab4c51f61b5190] 

I will raise an Idea and I think you have explained good enough to let someone in future go through it and get an idea.(if there is a customer who comes around same requirement)



I am okay to close the case and the jira since customer is going to use suppress-dyurl-parsing-of-posts=yes",28/Jun/23 8:35 AM;5b15d9517dab4c51f61b5190;I will close this item when the change is reviewed again,"29/Jun/23 12:04 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: b8f74e19440bb939e623ce33620efda0e715f57e
   * description: Merge pull request #5990 from ISAM/ISAMSUP-5143

ISAMSUP-5143 IJ47266 issue with dynurl POST requests containing expect header

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1939454.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230629020110-b8f74e194.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
subject_types_supported,ISAMSUP-5141,306684,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Aaron.Richie.Dias,6194c472fe9f300068e5252f,Aaron.Richie.Dias,6194c472fe9f300068e5252f,15/Jun/23 1:53 AM,16/Jun/23 7:16 AM,14/Jul/23 2:47 PM,16/Jun/23 7:16 AM,,,,0,,,,"Is ""subject_types_supported"" supported by IBM Security Verify Access? Can't find any documentation 

Keycloak has this on its .well-known endpoint but not ISVA.
""subject_types_supported"":[""public"",""pairwise""]

The metadata template that comes with ISVA looks like this.

{""issuer"":""@ISSUER_IDENTIFIER@"",
""authorization_endpoint"":""@AUTHORIZE_URL@"",
""token_endpoint"":""@TOKEN_URL@"",
""userinfo_endpoint"":""@USERINFO_URL@"",
""jwks_uri"":""@JWKS_URL@"",
""response_types_supported"":@RESPONSE_TYPES@,
""response_modes_supported"":@RESPONSE_MODES@,
""grant_types_supported"":@GRANT_TYPES@,
""id_token_signing_alg_values_supported"":@SIGNING_ALG@,
""id_token_encryption_alg_values_supported"":@ENCRYPTION_ALG@,
""id_token_encryption_enc_values_supported"":@ENCRYPTION_ENC@,
""poc"":""@POC_PREFIX@"",
""name"":""@OAUTH_DEFINITION@"",
""introspect_endpoint"":""@INTROSPECT_URL@"",
""revocation_endpoint"":""@REVOKE_URL@""}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013294658,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Aaron.Richie.Dias,6194c472fe9f300068e5252f,,,,SKANDINAVISKA ENSKILDA BANKEN AB (PUBL),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cplj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-15 04:40:35.093,,,,,"15/Jun/23 2:40 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:6194c472fe9f300068e5252f] 

Check AAC-->Templates-->C/oauth20/metadata.json for reference -

{{""subject_types_supported"":@SUBJECT_TYPES_SUPPORTED@,}} 

We support “public”

{noformat}{""issuer"":""@ISSUER_IDENTIFIER@"",
""authorization_endpoint"":""@AUTHORIZE_URL@"",
""token_endpoint"":""@TOKEN_URL@"",
""userinfo_endpoint"":""@USERINFO_URL@"",
""jwks_uri"":""@JWKS_URL@"",
""response_types_supported"":@RESPONSE_TYPES@,
""response_modes_supported"":@RESPONSE_MODES@,
""subject_types_supported"":@SUBJECT_TYPES_SUPPORTED@,
""token_endpoint_auth_methods_supported"":@TOKEN_ENDPOINT_AUTH_METHODS_SUPPORTED@,
""grant_types_supported"":@GRANT_TYPES@,
""id_token_signing_alg_values_supported"":@SIGNING_ALG@,
""id_token_encryption_alg_values_supported"":@ENCRYPTION_ALG@,
""id_token_encryption_enc_values_supported"":@ENCRYPTION_ENC@,
""poc"":""@POC_PREFIX@"",
""name"":""@OAUTH_DEFINITION@"",
""introspection_endpoint"":""@INTROSPECT_URL@"",
""revocation_endpoint"":""@REVOKE_URL@"",
""registration_endpoint"":""@REGISTER_URL@"",
""device_authorize_endpoint"":""@DEVICE_AUTHORIZE_URL@"",
""user_authorize_endpoint"":""@USER_AUTHORIZE_URL@"",
""scopes_supported"":@SCOPES_SUPPORTED@,
""userinfo_signing_alg_values_supported"":@USERINFO_SIGNING_ALG_VALUES_SUPPORTED@,
""request_object_signing_alg_values_supported"":@REQUESTED_OBJECT_SIGNING_ALG_VALUES_SUPPORTED@,
""token_endpoint_auth_signing_alg_values_supported"":@TOKEN_ENDPOINT_AUTH_SIGNING_ALG_VALUES_SUPPORTED@,
""claims_parameter_supported"":<%var supported = true;templateContext.response.body.write(supported);%> ,
""request_parameter_supported"":<%var supported = true;templateContext.response.body.write(supported);%>
}{noformat}","16/Jun/23 1:10 AM;6194c472fe9f300068e5252f;Thank you for the update, Asha. You can close this jira. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
junctions api does not return all junctions -   detailed=true,ISAMSUP-5135,306171,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,13/Jun/23 2:06 AM,20/Jun/23 2:18 PM,14/Jul/23 2:47 PM,,,,,0,,,,"If the customer use the api [https://{|https://{]appliance_hostname}/wga/reverseproxy/{reverseproxy_id}/junctions?detailed=true ,  it returns only 30 junctions,
 but if  call [https://{|https://{]appliance_hostname}/wga/reverseproxy/{reverseproxy_id}/junctions?detailed=false ,  it returns 48 junctions (which are the correct value in the customer case)

Also, the customer running below curls:

curl -ks -u uid:pwd '[https://apl0241c-mgmt.sebank.se/wga/reverseproxy/pnr-01/junctions?detailed=true|https://apl0241c-mgmt.sebank.se/wga/reverseproxy/pnr-01/junctions?detailed=true]' -H ""Accept: application/json"" | jq | grep junction_point | wc -l

30 junctions



curl -ks -u uid:pwd '[https://apl0241c-mgmt.sebank.se/wga/reverseproxy/pnr-01/junctions?detailed=false|https://apl0241c-mgmt.sebank.se/wga/reverseproxy/pnr-01/junctions?detailed=false]' -H ""Accept: application/json"" | jq | grep -i id | wc -l

48 junctions



I have found below Jira with a similar issue, but the customer stopped responding

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4683|https://cloudidentity.atlassian.net/browse/ISAMSUP-4683|smart-link]



I asked for the Support file with LMI trace, below is the link
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012664061&path=TS012664061%2F2023-06-12%2Fisva_10.0.5.0_20230612-092332_apl0241c.sebank.se.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012664061&path=TS012664061%2F2023-06-12%2Fisva_10.0.5.0_20230612-092332_apl0241c.sebank.se.support_unpack%2F]



Hope L3 can help with this query

 ",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012664061,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,SKANDINAVISKA ENSKILDA BANKEN AB (PUBL),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cmev:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-12 16:53:14.058,,,,,"13/Jun/23 2:53 AM;5b15d94b6256d01ad54eb020;[~accountid:614dd52af1c1740068534813] Have them send in the results of each REST command  without the post processing.  In other words don’t pipe the results  though anything.

The only difference in the REST calls they are making is the use of  detailed=true/false.  After that it is their filtering  with grep which is different.  So for proper comparisons they need to skip that part.","13/Jun/23 1:07 PM;5b15d954b0d76456f36daf33;According to the LMI trace log, what the customer is saying is true. With {{detailed=true}} we call {{showJunctions}} (which in turn writes out individual junction data by calling {{parseJunctions}}) If you look a block like this, there are 60 entry/return calls to parseJunction which corresponds to the 30 junctions.

{noformat}[6/3/23, 18:09:30:318 CEST] 00002734 id=00000000 Junctions                                                    > showJunctions(pnr-01) ENTRY
[6/3/23, 18:09:30:318 CEST] 00002734 id=00000000 com.ibm.isam.common.utils.WgaCommand                         1 Using user : s70107a
[6/3/23, 18:09:30:384 CEST] 00002734 id=00000000 Junctions                                                    > parseJunction ENTRY
[6/3/23, 18:09:30:384 CEST] 00002734 id=00000000 Junctions                                                    < parseJunction RETURN
...
...
[6/3/23, 18:09:30:389 CEST] 00002734 id=00000000 Junctions                                                    > parseJunction ENTRY
[6/3/23, 18:09:30:389 CEST] 00002734 id=00000000 Junctions                                                    < parseJunction RETURN
[6/3/23, 18:09:30:389 CEST] 00002734 id=00000000 Junctions                                                    < showJunctions(pnr-01) RETURN 0{noformat}

Like Bill said, can you get them to omit at least the count part of the curl command (wc -l) in each case and see the output? It might tell us the names of the 18 junctions that are missing.

I tried using the junction xml files in the customer’s support file in my local env. Strangely, I get all 48 junctions listed with either curl command.","14/Jun/23 5:56 AM;614dd52af1c1740068534813;Gotcha, I will ask them. Thx","14/Jun/23 11:28 PM;614dd52af1c1740068534813;[~accountid:5b15d954b0d76456f36daf33] We got the results.
The customer just sent a list of junctions. I am assuming the “junction_point…” are the ones with “detailed=true”, as we have 30 of them.


""junction_point"": ""/iik"",
""junction_point"": ""/isam"",
""junction_point"": ""/cvp"",
""junction_point"": ""/legitimera"",
""junction_point"": ""/iil"",
""junction_point"": ""/ssc"",
""junction_point"": ""/dkr"",
""junction_point"": ""/s2s/acc"",
""junction_point"": ""/mga"",
""junction_point"": ""/auth/dp"",
""junction_point"": ""/SAML"",
""junction_point"": ""/tppc"",
""junction_point"": ""/erpspa"",
""junction_point"": ""/auth/bid"",
""junction_point"": ""/auth/simdig"",
""junction_point"": ""/s2s/dev"",
""junction_point"": ""/tpp"",
""junction_point"": ""/auth/cronto-mocked"",
""junction_point"": ""/"",
""junction_point"": ""/httpmock"",
""junction_point"": ""/cf"",
""junction_point"": ""/auth/oauth"",
""junction_point"": ""/auth/delegated"",
""junction_point"": ""/auth/digipass-auto-verify"",
""junction_point"": ""/auth/sms"",
""junction_point"": ""/csi"",
""junction_point"": ""/scim"",
""junction_point"": ""/auth/headers"",
""junction_point"": ""/auth/autologin-digipass"",
""junction_point"": ""/kkr"",







""id"": ""/tp"",
""id"": ""/iik"",
""id"": ""/isam"",
""id"": ""/cvp"",
""id"": ""/rp"",
""id"": ""/legitimera"",
""id"": ""/paw"",
""id"": ""/iil"",
""id"": ""/ssc"",
""id"": ""/dkr"",
""id"": ""/gss"",
""id"": ""/wow"",
""id"": ""/s2s/acc"",
""id"": ""/open"",
""id"": ""/mga"",
""id"": ""/auth/dp"",
""id"": ""/dbf"",
""id"": ""/SAML"",
""id"": ""/tppc"",
""id"": ""/erpspa"",
""id"": ""/cip"",
""id"": ""/pss"",
""id"": ""/auth/bid"",
""id"": ""/auth/simdig"",
""id"": ""/s2s/dev"",
""id"": ""/tpp"",
""id"": ""/tsn"",
""id"": ""/saas"",
""id"": ""/offer"",
""id"": ""/auth/cronto-mocked"",
""id"": ""/httpmock"",
""id"": ""/cf"",
""id"": ""/auth/oauth"",
""id"": ""/kunddialog-web"",
""id"": ""/pfweb"",
""id"": ""/dbp"",
""id"": ""/kgb"",
""id"": ""/auth/delegated"",
""id"": ""/auth/digipass-auto-verify"",
""id"": ""/tlo"",
""id"": ""/pat"",
""id"": ""/auth/sms"",
""id"": ""/csi"",
""id"": ""/scim"",
""id"": ""/lcp"",
""id"": ""/auth/headers"",
""id"": ""/auth/autologin-digipass"",
""id"": ""/kkr"",","14/Jun/23 11:28 PM;614dd52af1c1740068534813;So there are the missing ones

""id"": ""/tp"",
""id"": ""/paw"",
""id"": ""/gss"",
""id"": ""/wow"",
""id"": ""/open"",
""id"": ""/dbf"",
""id"": ""/cip"",
""id"": ""/pss"",
""id"": ""/tsn"",
""id"": ""/saas"",
""id"": ""/offer"",
""id"": ""/kunddialog-web"",
""id"": ""/pfweb"",
""id"": ""/dbp"",
""id"": ""/kgb"",
""id"": ""/tlo"",
""id"": ""/pat"",
""id"": ""/lcp"",","20/Jun/23 2:18 PM;5b15d954b0d76456f36daf33;[~accountid:614dd52af1c1740068534813] I can’t see any pattern to the ones missing vs the ones returned.

Can you get them to run these commands directly on the pdadmin command line:

{noformat}server task <webseal_server> showall{noformat}

and

{noformat}server task <webseal_server> listremote{noformat}

Those two correspond to {{detailed=true}} and {{detailed=false}} RAPI calls.

If we validate that both those return the expected 48 junctions, then we know we are dealing with a RAPI issue, otherwise we are dealing with a pdadmin issue. 

That might help get some direction.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Memory leak after ISVA 10.0.5.0 upgrade on AAC-Federation servers,ISAMSUP-5134,306124,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,12/Jun/23 7:18 PM,06/Jul/23 1:09 PM,14/Jul/23 2:47 PM,,,,,0,Growth,,,"Customer have memory leak issue on AAC/Federation servers after ISVA 10.0.5.0 upgrade. The problem affect all of our stages including the productive appliances. Today morning the productive AAC/Federation server memory usage reached 98%. On our productive appliance after a runtime cluster RELOAD the memory usage returned to the normal state, but it started to increasing again. On our QS appliance the runtime cluster RELOAD did not help, we had to RESTART the cluster runtime. On the productive appliance we could not create a support file before the runtime reload, only after the reload. I have uploaded this file: isva_10.0.5.0_20230220-085357_vaf209p001b.wob.sec.vw.vwg.support On the QS appliance we have created support file before and after the runtime restart: isva_10.0.5.0_20230220-085721_vaf209p002b.wob.sec.vw.vwg_BEFORE_RUNTIME_RESTART.support isva_10.0.5.0_20230220-093005_vaf209p002b.wob.sec.vw.vwg_AFTER_RUNTIME_RESTART.support

check logs not showing memory issues in it. 

Ask for support file again. showing.

Mem: 16218348K used, 182724K free, 172K shrd, 298336K buff, 8408132K cached
CPU:  4.7% usr  4.7% sys  0.0% nic 90.4% idle  0.0% io  0.0% irq  0.0% sirq
Load average: 2.40 1.23 0.93 2/389 16362
  PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND
10901     1 www-data S    12.1g 76.8   1  7.1 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx8192m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.auth
 3104     1 www-data S    6920m 42.9   2  0.0 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Djava.security.properties=/opt/IBM/wlp/usr/servers/default/java.security -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dor

[TS012202438 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012202438&path=TS012202438%2F2023-06-12%2Fisva_10.0.5.0_20230602-131236_vaf210p002b.wob.sec.vw.vwg.support_unpack%2Fiswga%2F&filepath=TS012202438%2F2023-06-12%2Fisva_10.0.5.0_20230602-131236_vaf210p002b.wob.sec.vw.vwg.support_unpack%2Fiswga%2Fcpu.txt]

It had generate a core file of GB core_kernel-command-.13425 also

L3 need to advise",,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Syed Hasan Jafar,Tushar Prasad,,,,,,,,,,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,617a5f2cf485cd0068cb98af,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5130,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012202438,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,Volkswagen AG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cm47:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-21 04:27:35.703,,,,,21/Jun/23 2:27 PM;5b232b2fd85e5b59b066f57f;[~accountid:617a5f2cf485cd0068cb98af] - what is your analysis of memory usage over time? Which process is growing and at what rate? Is there more than one process growing? ,"21/Jun/23 9:36 PM;617a5f2cf485cd0068cb98af;[~accountid:5b232b2fd85e5b59b066f57f] The below process is chewing the memory  to 76.8

10901 1 www-data S 12.1g 76.8 1 7.1 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx8192m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.auth",22/Jun/23 2:25 PM;5b232b2fd85e5b59b066f57f;[~accountid:617a5f2cf485cd0068cb98af] - how quickly does the memory utilisation grow? ,22/Jun/23 4:49 PM;617a5f2cf485cd0068cb98af;[~accountid:5b232b2fd85e5b59b066f57f] It is constantly growing and leaking the memory with this java process. ,"23/Jun/23 6:00 PM;617a5f2cf485cd0068cb98af;[~accountid:5b232b2fd85e5b59b066f57f] Yesterday crashed one of our runtime cluster member after peaking the memory usage at 97% (at Fri Jun 23 2023 01:54:00 GMT+02) and the local runtime entered 'stopped' state.

We collected a support file and some screenshots to help you with the analysis by providing more data, please find these attached. However, ISAM again did not generate / collect core dumps to \var\support\ again.

[TS012202438 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012202438&path=TS012202438%2F2023-06-23%2F&filepath=TS012202438%2F2023-06-23%2Fvaf210p002_local_runtime.png]",27/Jun/23 4:20 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] is this another candidate item for the Java memory leak fix to confirm if this assist our customer? ,28/Jun/23 1:11 PM;5b232b2fd85e5b59b066f57f;[~accountid:617a5f2cf485cd0068cb98af] - can you please have customer apply [https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|smart-link] and see if there is any improvement?,"29/Jun/23 11:19 PM;617a5f2cf485cd0068cb98af;[~accountid:5b232b2fd85e5b59b066f57f] Customer is asking below:

# can we apply this fix for RP and AAC/FED appliances also.

We do have dedicated appliances for RP roles and AAC/ FED roles.



# 

Based on this (IJ47335: ISVA JVM MEMORY LEAK FROM J9 / SEMERU ([ibm.com|https://ibm.com/])) this FIX is already in version 10.0.6.0.



So can we upgrade our system instead apply FIX?

In other way:

Use this path: current (10.0.5.0) >> apply FIX >> upgrade over to 10.0.6.0

*OR*

Use this path: current (10.0.5.0) >> upgrade over to 10.0.6.0",30/Jun/23 10:46 AM;5ac57757d9a96536d1f0daa9;[~accountid:617a5f2cf485cd0068cb98af] this fix was delivered as part of our 10.0.6 release. If the customer wants to validate that this is resolved at 10.0.6 then move to this version I suggest that this is the correct path forwards. The appliance fix pack that Dave has provided was to allow the customer to confirm that this specific fix has resolved/reduced the memory growth that they are seeing before upgrading to the latest version of the product. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA 10.0.4 integration with Microsoft Sharepoint 2019,ISAMSUP-5126,305326,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,07/Jun/23 4:24 PM,04/Jul/23 2:56 PM,14/Jul/23 2:47 PM,04/Jul/23 2:56 PM,,Support,,0,,,,"Hi Team, I have a customer who wants to integrate ISVA with Microsoft Sharepoint 2019. I have been searching for some documentation around it but couldn’t find any latest doc. on this.

I did find this - [https://www.ibm.com/support/pages/ibm-security-access-manager-microsoft-applications|https://www.ibm.com/support/pages/ibm-security-access-manager-microsoft-applications] but it is outdated and mentions about ISAM 9 and sharepoint 2016.

Can you please help me with any latest documentation or steps for this integration. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013212425,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,MINISTRY OF MUNICIPAL AND RURAL AFFAIRS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1ch9r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-06-08 03:04:49.627,,,,,08/Jun/23 1:04 PM;5b232b2fd85e5b59b066f57f;Checking with integration team / MS expert. ,08/Jun/23 1:08 PM;5b232b2fd85e5b59b066f57f;The documentation you have referenced should still be relevant. Is the customer having issues? ,08/Jun/23 5:12 PM;62d0e51aec233f24684a5d3a;The customer just wants to confirm if the old doc still stands true for this version. ,09/Jun/23 2:48 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] I think that we have an outstanding response regarding this one.,12/Jun/23 12:36 PM;5b232b2fd85e5b59b066f57f;[~accountid:62d0e51aec233f24684a5d3a] - yes - the documentation should still be relevant. ,12/Jun/23 2:14 PM;62d0e51aec233f24684a5d3a;Thanks for helping. I will cascade the same to the customer.,27/Jun/23 4:12 PM;5ac57757d9a96536d1f0daa9;[~accountid:62d0e51aec233f24684a5d3a] is there any remaining actions here for us or can this item be closed out? ,"27/Jun/23 4:14 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5ac57757d9a96536d1f0daa9] I have sent a followup to the customer , requesting to wait for a couple of days before we close it out. ",04/Jul/23 2:56 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
webseal instance *-08-public crash for ISV,ISAMSUP-5124,305243,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,William Hannon Jr,5b17571b91981f4fdde632c1,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,07/Jun/23 10:25 AM,11/Jul/23 11:37 AM,14/Jul/23 2:47 PM,,,Support Management,,0,,,,"reviewed the core dumps and seems to have hit a known APAR : [https://www.ibm.com/support/pages/apar/IJ40415|https://www.ibm.com/support/pages/apar/IJ40415]

 

and similar to the same issue reported by ISV(previously) CI team, over case TS008273754

 

and the related jira: [https://cloudidentity.atlassian.net/browse/ISAMSUP-3860|https://cloudidentity.atlassian.net/browse/ISAMSUP-3860|smart-link]

 

--snippet of crash point occurred now -- and see

 

Thread 1 (Thread 0x7fc0f4a6c700 (LWP 29449)):
#0 0x00007fc16d05a37f in raise () from /lib64/libc.so.6
No symbol table info available.
#1 0x00007fc16d044db5 in abort () from /lib64/libc.so.6
No symbol table info available.
#2 0x00007fc16d044c89 in __assert_fail_base.cold.0 () from /lib64/libc.so.6
No symbol table info available.
#3 0x00007fc16d052a76 in __assert_fail () from /lib64/libc.so.6
No symbol table info available.
#4 0x00007fc16dd21b61 in pthread_mutex_lock () from /lib64/libpthread.so.0
No symbol table info available.
#5 0x00007fc1701c7978 in AMWOAuthResponseCache::getRSTR(char const*, AMWRefPtr<AMWOAuthRSTR>&) () from /usr/lib64/libamwoauth.so
No symbol table info available.
#6 0x00007fc144fa4191 in AMWOAuthModule::authorize(long, char*, long, int*, long*) () from /opt/pdwebrte/lib/libamwoautheas.so
No symbol table info available.
#7 0x00007fc144fa1b82 in azn_svc_decision_access_allowed_ext () from /opt/pdwebrte/lib/libamwoautheas.so
No symbol table info available.
#8 0x00007fc16c9b1c28 in AznExternAuthznSvc::checkAuthznSvc(long, char*, char*, long, int*, long*) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#9 0x00007fc16c9ac083 in IVAuthznEngine::consultEASCombinator(long, char*, char*, long, long*, IVACLPermset const&, IVPop const*, IVExtAttr const*, ZUTF8String&, ZUTF8String&, unsigned long*) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#10 0x00007fc16c9af54a in IVAuthznEngine::checkAuthorization(long const&, long, daPObjName const&, IVACLPermset const&, char*, long*, int*, unsigned long&) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#11 0x00007fc16c9a7d92 in ReplicatedAuthznService::checkAuthorization(long, char const*, char*, long, unsigned long, int*, long*) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#12 0x00007fc16c9a43cb in internal_azn_decision_access_allowed_ext(long, char*, char*, long, unsigned long, int*, long*) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#13 0x00007fc16c9a4531 in azn_decision_access_allowed_ext () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#14 0x00007fc16fce22d6 in amw_azn_decision_access_allowed_ext () from /usr/lib64/libamwebrte.so
No symbol table info available.
#15 0x00007fc170520d00 in acl_check_path () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#16 0x00007fc17051f07c in requestAuthorize(h_s_t*, wand_client_ident_s_t*, Junction*, HTTPRequest*, HTTPResponse*, ResourceInfo*, ZUTF8String*, char const*, unsigned int*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#17 0x00007fc1705d3db5 in requestDispatch(h_s_t*, Junction*, HTTPRequest*, ClientOutputInfo&, HTTPResponse&, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#18 0x00007fc1705cae7f in zprocess_and_convert(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#19 0x00007fc1705cb0eb in process_junction(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#20 0x00007fc1704efe7c in authAndProcess(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#21 0x00007fc17057763f in handleCallInternal(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned long*, unsigned int*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#22 0x00007fc170578e01 in handle_call(h_s_t*, HTTPRequest*, HTTPResponse*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#23 0x00007fc1705763e9 in call_start () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#24 0x00007fc17057c350 in WsWorker::work() () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#25 0x00007fc17057cda2 in WsWorkerThread () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#26 0x00007fc16dd1f14a in start_thread () from /lib64/libpthread.so.0
No symbol table info available.
#27 0x00007fc16d11fdc3 in clone () from /lib64/libc.so.6
No symbol table info available.",,aditya.cetlur,carlos.arias,Dave Bachmann,khansen,Nick Lloyd,Silviu Marchis,Vivek Shankar,William Hannon Jr,,,,,,,,5af053215715ff498542256d,62ed8180432ef494c8cad107,5af0531368ebd52c36627c3b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c924588d2787a2d44ca7b42,5ad60ece34f1e62b1ac926c2,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,,,,14/Jun/23 11:56 PM;62ed8180432ef494c8cad107;image-20230614-135617.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/206103,,,,,,,,,,,,,,,IJ40415,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013200478,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,ISV SaaS Infrastructure (IBM Internal),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cgr3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-06-07 03:41:25.171,,,,,"07/Jun/23 1:39 PM;5c53d3ac23f5bf672621c868;I am putting the chronology in correct order

* {noformat}Webseal message logs located at named server.log ( /ecurep/sf/TS013/200/TS013200478/2023-06-02/isva_10.0.3.1_20230602-020214_ng42fra02awga08.support_unpack/var/pdweb/ng42fra02awga08-public/log/){noformat}
* Webseal recorded the message
* {noformat}webseald: ../nptl/pthread_mutex_lock.c:81: __pthread_mutex_lock: Assertion `mutex->__data.__owner == 0' failed.
2023-06-02-01:34:43.951+01:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 654 0x7fe05113e700
WGAWA0034E   The process, /opt/pdweb/bin/webseald, was terminated by the signal, 6.  The process will be automatically restarted.
IBM Security Verify Access WebSEAL Version 10.0.3.1 (Build 20220216_2345){noformat}
* support file transferred to l3support 
* upon loading the core showed this stack trace but will defer until we can conclude(still putting in here)(thread looks to match with what got recorded in stack trace)
* {noformat}ore was generated by `/opt/pdweb/bin/webseald -config etc/webseald-ng42fra02awga08-public.conf -foreg'.
Program terminated with signal SIGABRT, Aborted.
#0  0x00007fc16d05a37f in __wmemchr_sse2 () from /lib64/libc.so.6
[Current thread is 1 (Thread 0x7fc0f4a6c700 (LWP 29449))]
(gdb) bt
#0  0x00007fc16d05a37f in __wmemchr_sse2 () from /lib64/libc.so.6
#1  0x0000000000005007 in ?? ()
#2  0x00007fc04993ee80 in ?? ()
#3  0x00007fc1451a78d8 in amw_oauthmod () from /opt/pdwebrte/lib/libamwoautheas.so
#4  0x00007fc16d09c4a7 in __GI__IO_vfscanf () from /lib64/libc.so.6
#5  0x212066756274756f in ?? ()
#6  0x26204c4c554e203d in ?? ()
#7  0x756274756f2a2026 in ?? ()
#8  0x4c554e203d212066 in ?? ()
#9  0x000000000000004c in ?? ()
#10 0x00766e6f63675f5f in ?? ()
#11 0x6f6d2d766e6f6367 in ?? ()
#12 0x00000073656c7564 in ?? ()
#13 0x6973203c20746e63 in ?? ()
#14 0x616d2820666f657a in ?? ()
#15 0x7a6973202f202970 in ?? ()
#16 0x70616d2820666f65 in ?? ()
#17 0x00000000295d305b in ?? ()
#18 0x3e2d657461747328 in ?? ()
#19 0x20746e756f635f5f in ?? ()
#20 0x203d3c2029372026 in ?? ()
#21 0x2820666f657a6973 in ?? ()
#22 0x5f3e2d6574617473 in ?? ()
#23 0x002965756c61765f in ?? ()
#24 0x202d207274706e69 in ?? ()
#25 0x2066756265747962 in ?? ()
#26 0x657461747328203e in ?? ()
#27 0x6e756f635f5f3e2d in ?? ()
#28 0x0000293720262074 in ?? ()
#29 0x3d2120646e656e69 in ?? ()
#30 0x7562657479622620 in ?? ()
#31 0x454e5f58414d5b66 in ?? ()
#32 0x504e495f44454445 in ?? ()
#33 0x00000000005d5455 in ?? ()
#34 0x202d20646e656e69 in ?? ()
#35 0x203e207274706e69 in ?? ()
#36 0x3e2d657461747328 in ?? ()
#37 0x20746e756f635f5f in ?? ()
#38 0x00000029377e2026 in ?? ()
#39 0x202d20646e656e69 in ?? ()
#40 0x3d3c207274706e69 in ?? ()
#41 0x20666f657a697320 in ?? ()
#42 0x3e2d657461747328 in ?? ()
#43 0x2965756c61765f5f in ?? ()
#44 0x0000000000000000 in ?? (){noformat}
* {noformat}+ /usr/sbin/mesa_control fixpack_get_history
Tuesday, November 22, 2022 at 4:21:23 PM|REDIS_FIXES_10.0.3.1_002|Redis_Fixes_10.0.3.1_002|Yes|Installed|This fixpack: 1. Corrects a problem where reverse proxy instances appear to stop processing requests. 2. Addresses a Redis crash issue. 3. Allows multiple headers for each entry in [header-names] stanza. 4. Fixes an issue with the user name character case. 5. Resolves a Redis crash issue with a null object. 6. Implements additional debug trace points (ISAMSUP-4587).|1669134083
Saturday, November 26, 2022 at 1:23:51 AM|FIX_001|Enable_Root_Shell_MattBritt|Yes|Installed|Enable the root shell -- DO NOT DISTRIBUTE|1669425831
Wednesday, February 8, 2023 at 2:10:00 AM|REDIS_FIXES_10.0.3.1_003|Redis_Fixes_10.0.3.1_003|Yes|Installed|This fixpack: 1. Corrects a problem where reverse proxy instances appear to stop processing requests. 2. Addresses a Redis crash issue. 3. Allows multiple headers for each entry in [header-names] stanza. 4. Fixes an issue with the user name character case. 5. Resolves a Redis crash issue when multiple redis collections configured. 6. Implements additional debug trace points (ISAMSUP-4587).|1675822200{noformat}","07/Jun/23 1:41 PM;5b232b2fd85e5b59b066f57f;[~accountid:5c53d3ac23f5bf672621c868] - what makes you think this is related to [https://cloudidentity.atlassian.net/browse/ISAMSUP-3860|https://cloudidentity.atlassian.net/browse/ISAMSUP-3860|smart-link] / APAR IJ40415? 

Do you see stacks in the core failing at {{monitorExpiredResponses()}}?","07/Jun/23 2:04 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f]  no david , the monitorExpiredResponses is not in the failing stack.

but also on this

{noformat}For ISVA L3 Support only:

AMWOAuthResponseCache::getRSTR()

To avoid LOSING LOCK INTEGRITY from the second amwthread_mutex_unlock()

SHOULD return after 

amwthread_mutex_unlock(&m_cacheLock); 

rstr.release();{noformat}

my thinking was based on above ( but I think we need to wait for a final core analysis to link this item into the earlier one)

* 
* if the issue observed 
** could be a new issue
** could be generated around getRSTR response and mutex locks
** For now, I will defer the conclusion that this issue is same as [IJ40415|https://www.ibm.com/support/pages/apar/IJ40415]",07/Jun/23 3:43 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b17571b91981f4fdde632c1] - can you take a look please based on your work in APAR IJ40415? Thanks. ,"09/Jun/23 1:44 AM;5c53d3ac23f5bf672621c868;HI 



could you help to update?",13/Jun/23 1:07 AM;62ed8180432ef494c8cad107;Any update?,"14/Jun/23 7:01 AM;5b17571b91981f4fdde632c1;* APAR IJ40415 fixed in 10.0.5.0 
** Described as
*** AMWOAuthResponseCache losing lock integrity”
* There is no way to know if there is another problem with AMWOAuthResponseCache locking
** APAR IJ40415 would be required","14/Jun/23 7:03 AM;5b17571b91981f4fdde632c1;* What is customer’s name?
** ISV has different means","14/Jun/23 7:27 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** Downloading to l3pmrsupport","14/Jun/23 11:56 PM;62ed8180432ef494c8cad107;[~accountid:5b17571b91981f4fdde632c1] customer’s name is IBM Corp


!image-20230614-135617.png|width=452,height=146!","15/Jun/23 12:53 AM;5b17571b91981f4fdde632c1;{quote}ISV SaaS Infrastructure (IBM Internal){quote}

* That confirms what I needed","15/Jun/23 2:53 AM;5b17571b91981f4fdde632c1;{noformat}>> isva_10.0.3.1_20230602-020214_ng42fra02awga08.support.zip_unpack/support.txt
+ /usr/sbin/mesa_control fixpack_get_history
Tuesday, November 22, 2022 at 4:21:23 PM|
REDIS_FIXES_10.0.3.1_002|
Redis_Fixes_10.0.3.1_002|
Yes|
Installed|
This fixpack: 1. Corrects a problem where reverse proxy instances appear to stop processing requests. 2. Addresses a Redis crash issue. 3. Allows multiple headers for each entry in [header-names] stanza. 4. Fixes an issue with the user name character case. 5. Resolves a Redis crash issue with a null object. 6. Implements additional debug trace points (ISAMSUP-4587).|
1669134083

Wednesday, February 8, 2023 at 2:10:00 AM|
REDIS_FIXES_10.0.3.1_003|
Redis_Fixes_10.0.3.1_003|
Yes|
Installed|
This fixpack: 1. Corrects a problem where reverse proxy instances appear to stop processing requests. 2. Addresses a Redis crash issue. 3. Allows multiple headers for each entry in [header-names] stanza. 4. Fixes an issue with the user name character case. 5. Resolves a Redis crash issue when multiple redis collections configured. 6. Implements additional debug trace points (ISAMSUP-4587).|
1675822200{noformat}","15/Jun/23 2:57 AM;5b17571b91981f4fdde632c1;* REDIS_fixes_10.0.3.1_003
** 221129 files
*** Superset of all REDIS fixpacks

{noformat}opt/pdweb/lib/libamweb.so
opt/pdweb/lib/libwsadmin.so
opt/pdweb/lib/libwsadmin_local.so
opt/pdweb/lib/libwsdaemon.so
opt/pdwebrte/lib/libamwredismgr.so{noformat}","15/Jun/23 3:37 AM;5b17571b91981f4fdde632c1;* For ISVA L3 Support only
** [https://cloudidentity.atlassian.net/browse/ISAMSUP-3860|https://cloudidentity.atlassian.net/browse/ISAMSUP-3860|smart-link] Commit f26e50d62e525ff5f1f57703914aa3619e9d7500
*** src/i4w/pdwebrte/azn/oauth-api/AMWOAuthResponseCache.cpp
**** [libamwoauth.so|http://libamwoauth.so]
***** opt/pdwebrte/lib/libamwoauth.so","15/Jun/23 4:03 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** [~accountid:5af0531368ebd52c36627c3b] will be having a discussion with Pat Wardrop
*** Regarding ISV
**** levels for current security vulnerabilities
**** strategy/requirements for levels with required current vulnerability fixes
** Will wait for Dave’s answers on which ISV level or backporting",16/Jun/23 6:29 AM;62ed8180432ef494c8cad107;Thanks for your help [~accountid:5b17571b91981f4fdde632c1] ,22/Jun/23 5:13 AM;62ed8180432ef494c8cad107;Just wondering what’s Jira’s current status.,"24/Jun/23 1:31 AM;5b17571b91981f4fdde632c1;* For IBM Support only
** Pat Wardrop returns from vacation this week
*** [~accountid:5af0531368ebd52c36627c3b] is waiting for his return to discuss",27/Jun/23 4:57 PM;5ac57757d9a96536d1f0daa9;[~accountid:5af0531368ebd52c36627c3b] can you please confirm what needs to be discussed with Pat on this item? ,29/Jun/23 3:17 AM;62ed8180432ef494c8cad107;any update?,29/Jun/23 6:07 AM;5af0531368ebd52c36627c3b;I need to find out from Pat what his preference is for how up-to-date we should be on ISVA levels in ISV.,30/Jun/23 10:49 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af0531368ebd52c36627c3b] thanks for the confirmation. Please let us know once this has been confirmed. ,03/Jul/23 2:24 PM;5ac57757d9a96536d1f0daa9;[~accountid:5c53d3ac23f5bf672621c868] I am assigning this one back to you until Dave provides an update either via the case or this Jira item. ,11/Jul/23 4:13 AM;62ed8180432ef494c8cad107;Any update to share with the customer?,11/Jul/23 11:37 AM;5ac57757d9a96536d1f0daa9;[~accountid:62ed8180432ef494c8cad107] this item is currently on [~accountid:5af0531368ebd52c36627c3b] to discuss the issue with Pat Wardrop. Please note that this item is an internal IBM one between the ISVA and ISV SaaS offerings. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
BMO/BotW Performance issue,ISAMSUP-5121,304958,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,06/Jun/23 2:08 AM,27/Jun/23 4:30 AM,14/Jul/23 2:47 PM,27/Jun/23 4:30 AM,,,,0,,,,"Customer reported that they are getting slow response from WGA instance wsbhob during performance test runs.

Update from Alden Chan:

Urgent and High Business Impact, Bank of the West acquisition, and customer conversion 

This is related the BMO's BotW acquisition. The bank is converting all BoTW customers digital credential to ISAM, converting them to a single US identity aligning with the bank strategy. The bank is building additional cluster/infrastructure to expand their customer identity and access management running on ISAM to support BMO US. The bank is using on ISAM as their customer identity access solution. 



The bank is encountering performance issue during performance testing that cannot meet the business requirement / projected volume at the moment. They need SME to assist. Please engage IBM ISAM performance team to work together on this.

Email chain discussing issue

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013221174&path=&action=MailMessageView&messageId=/ecurep/sf/TS013/221/TS013221174/mail20230605-154628-Alden_Chan|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013221174&path=&action=MailMessageView&messageId=/ecurep/sf/TS013/221/TS013221174/mail20230605-154628-Alden_Chan]
",,Annelise Quap,Dave Bachmann,David Hayes,khansen,Nick Lloyd,tonyferg,William Hannon Jr,,,,,,,,,5b15d950d9936c61022057fe,5af0531368ebd52c36627c3b,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013221174,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,BANK OF MONTREAL,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013221174&path=TS013221174%2F2023-06-05%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1cf07:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-06-05 20:32:12.492,,,,,"06/Jun/23 4:55 AM;5b15d950d9936c61022057fe;Customer just uploaded a support files. 

Support file from 3 appliances have been uploaded

pdweb.debug was started during the issue.

also

pdweb.https, pdweb.threads, pdweb.usersessidcache, pdweb.sescache were turned on.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013221174&path=TS013221174%2F2023-06-05%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013221174&path=TS013221174%2F2023-06-05%2F]","06/Jun/23 6:32 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** Working with Dave Bachmann behind scenes","07/Jun/23 2:15 AM;5af0531368ebd52c36627c3b;Given that the customer reported webseal is taking extra time between the response from the backend and the response to the browser, which I am also seeing in the pdweb debug logs, we should try to get some pstacks collected under load, to see what the webseal worker threads are doing during that time.
[~accountid:5b15d950d9936c61022057fe] 
 do we have a pstack_logger fixpack that would work for the level that they are running?","07/Jun/23 2:36 AM;5b17571b91981f4fdde632c1;{noformat}isva_10.0.3.1_20230606-114304_isambcclpfwga04.srv.bmogc.net.support_unpack/var/pdweb/wsbhob/etc/webseald-wsbhob.conf:
	request-log-format = %h %l %u %t ""%r"" %s %b %F %M %{PD-S-SESSION-ID}e %{PD-S-SESSION-ID}E %j %c %J

isva_10.0.3.1_20230606-114321_isambcclpfwga05.srv.bmogc.net.support_unpack/var/pdweb/wsbhob/etc/webseald-wsbhob.conf:
	request-log-format = %h %l %u %t ""%r"" %s %b %F %M %{PD-S-SESSION-ID}e %{PD-S-SESSION-ID}E %j %c %J

isva_10.0.3.1_20230606-114337_isambcclpfwga06.srv.bmogc.net.support_unpack/var/pdweb/wsbhob/etc/webseald-wsbhob.conf:
	request-log-format = %h %l %u %t ""%r"" %s %b %F %M %{PD-S-SESSION-ID}e %{PD-S-SESSION-ID}E %j %c %J{noformat}","07/Jun/23 6:41 AM;5b17571b91981f4fdde632c1;* Customer updated request.log format and recaptured



* Backend junction status(es):
** {noformat}1706529 200
33319 204 204 No Content
 170 206 206 Partial Content
236391 302
   1 400 Bad Request
1588 403
47566 404
211087 412  Unprocessable Entity
23577 422  Unprocessable Entity
7918 500 Internal Server Error
 994 506 Variant Also Negotiates (RFC 2295) ??{noformat}
* WebSEAL status(es)
** {noformat}72388 200
   9 204
2196713 302
  11 404
  15 412
   2 422
   1 500
   1 506{noformat}
* WebSEAL Client IP (Unbalanced)
** {noformat}71751 10.195.126.164
286426 10.195.127.10
285327 10.195.127.11
144249 10.195.127.12
213989 10.195.127.13
183282 10.195.127.14
216677 10.195.127.15
144027 10.195.127.16
72752 10.195.127.17
361659 10.195.127.18
216386 10.195.127.19
72615 10.195.127.20{noformat}
* WebSEAL Userid
** {noformat}1867154 unauthenticated
---
629 UNIQUE userids{noformat}
* URLs
** {noformat}1003645 /pkmslogout
1003645 /pkmslogout
576476 /api/us-banking/auth/logout
576476 /api/us-banking/auth/logout
401367 /api/bdb/customer-access-entitlement/enrollment/disclosure
401367 /api/bdb/customer-access-entitlement/enrollment/disclosure
215240 /api/bdb/party-authentication/auth/logout
215240 /api/bdb/party-authentication/auth/logout
71751 /pics/bhob.gif
71751 /pics/bhob.gif
 183 /api/bdb/customer-products-and-services/customer
 183 /api/bdb/customer-products-and-services/customer
  95 /api/bdb/lead-opportunity-management/offers
  95 /api/bdb/lead-opportunity-management/offers
  62 /api/bdb/party-authentication/auth/authenticate
  62 /api/bdb/party-authentication/auth/authenticate
  47 /api/bdb/party-authentication/auth/elevate
  47 /api/bdb/party-authentication/auth/elevate
  41 /api/bdb/party-reference-data-directory/preference/banner
  41 /api/bdb/party-reference-data-directory/preference/banner
  29 /api/bdb/party-reference-data-directory/preference/preferences
  29 /api/bdb/party-reference-data-directory/preference/preferences
  21 /api/bdb/party-reference-data-directory/preference/inline-message-cards
  21 /api/bdb/party-reference-data-directory/preference/inline-message-cards
  17 /api/bdb/party-authentication/auth/error
  17 /api/bdb/party-authentication/auth/error
  16 /api/bdb/issued-device-administration/security-center/login-history
  16 /api/bdb/issued-device-administration/security-center/login-history
  15 /api/bdb/correspondence/secure-message/customer/conversations/aggregations/exists
  15 /api/bdb/correspondence/secure-message/customer/conversations/aggregations/exists
  11 /api/bdb/service-product/notification/contact-tracking
  11 /api/bdb/service-product/notification/contact-tracking
{noformat}
* WebSEAL front-end Microsends (Rounding down)
** {noformat}   1 16.
   1 15.
   1 14.
   3 12.
   5 11.
  15 10.
  27 9.
  35 8.
  48 7.
  65 6.
  55 5.
  54 4.
  37 3.
  34 2.
71265 1.
2197494 0.{noformat}
* WebSEAL back-end Microseconds
** {noformat}WebSEAL back-end Microseconds (Rounded down)
   1 15.	/api
   4 10.	/api
   1 9.	/api
   1 8.	/api
   4 7.	/api
  13 6.	/api
  23 5.	/api
  17 4.	/api
  14 3.	/api
  57 2.	/api
 120 1.	/api
 421 0.	/api{noformat}
* VERY INTERESTING
** Arrival rate counts by second
*** {noformat}   1 06/06/2023 11:29:43
   4 06/06/2023 11:29:45
   2 06/06/2023 11:29:46
   1 06/06/2023 11:29:47
   3 06/06/2023 11:29:48
   2 06/06/2023 11:29:49
   1 06/06/2023 11:29:50
   1 06/06/2023 11:29:51
   1 06/06/2023 11:29:52
   1 06/06/2023 11:29:53
   6 06/06/2023 11:29:54
145044 06/06/2023 11:29:55
72557 06/06/2023 11:31:12
   1 06/06/2023 11:31:14
72485 06/06/2023 11:31:18
   5 06/06/2023 11:31:21
72538 06/06/2023 11:31:22
   2 06/06/2023 11:32:25
   2 06/06/2023 11:32:26
   2 06/06/2023 11:32:27
   4 06/06/2023 11:32:28
   1 06/06/2023 11:32:29
   2 06/06/2023 11:32:30
   1 06/06/2023 11:32:32
   1 06/06/2023 11:32:33
  15 06/06/2023 11:32:34
72517 06/06/2023 11:32:35
   1 06/06/2023 11:32:36
   2 06/06/2023 11:32:37
   1 06/06/2023 11:32:39
   3 06/06/2023 11:32:40
  26 06/06/2023 11:32:41
72707 06/06/2023 11:32:42
72589 06/06/2023 11:32:48
   1 06/06/2023 11:34:03
72672 06/06/2023 11:34:07
72687 06/06/2023 11:34:19
   1 06/06/2023 11:34:22
   1 06/06/2023 11:34:28
72396 06/06/2023 11:34:30
   1 06/06/2023 11:35:34
71690 06/06/2023 11:35:49
   1 06/06/2023 11:35:56
   2 06/06/2023 11:35:59
71622 06/06/2023 11:36:00
   1 06/06/2023 11:36:03
   2 06/06/2023 11:36:06
71571 06/06/2023 11:36:07
   1 06/06/2023 11:37:02
   1 06/06/2023 11:37:03
   1 06/06/2023 11:37:04
   2 06/06/2023 11:37:05
   1 06/06/2023 11:37:06
71327 06/06/2023 11:37:07
   3 06/06/2023 11:37:14
71232 06/06/2023 11:37:15
   3 06/06/2023 11:37:16
   2 06/06/2023 11:37:17
   1 06/06/2023 11:37:22
   3 06/06/2023 11:37:26
71415 06/06/2023 11:37:27
   4 06/06/2023 11:37:28
   1 06/06/2023 11:38:23
   3 06/06/2023 11:38:28
71465 06/06/2023 11:38:29
   1 06/06/2023 11:38:34
   2 06/06/2023 11:38:35
71519 06/06/2023 11:38:36
   2 06/06/2023 11:38:47
71454 06/06/2023 11:38:48
   1 06/06/2023 11:39:45
   1 06/06/2023 11:39:46
   1 06/06/2023 11:39:48
   2 06/06/2023 11:39:49
71979 06/06/2023 11:39:50
   1 06/06/2023 11:39:51
   1 06/06/2023 11:39:52
   1 06/06/2023 11:39:53
71243 06/06/2023 11:39:54
72352 06/06/2023 11:40:08
   2 06/06/2023 11:41:06
   1 06/06/2023 11:41:07
   1 06/06/2023 11:41:08
   3 06/06/2023 11:41:09
   4 06/06/2023 11:41:12
71840 06/06/2023 11:41:13
   2 06/06/2023 11:41:14
71952 06/06/2023 11:41:15
71958 06/06/2023 11:41:32
   1 06/06/2023 11:41:59
   1 06/06/2023 11:42:04
   1 06/06/2023 11:42:12
   4 06/06/2023 11:42:13
  17 06/06/2023 11:42:14
72364 06/06/2023 11:42:15
72231 06/06/2023 11:42:16
   1 06/06/2023 11:42:21
   3 06/06/2023 11:42:22
   1 06/06/2023 11:42:23
   2 06/06/2023 11:42:27
72166 06/06/2023 11:42:31
   4 06/06/2023 11:43:22
   1 06/06/2023 11:43:26
   3 06/06/2023 11:43:27
139452 06/06/2023 11:43:28
   1 06/06/2023 11:43:50
   1 06/06/2023 11:43:52
39316 06/06/2023 11:43:53
   1 06/06/2023 11:44:48
   5 06/06/2023 11:44:49
   8 06/06/2023 11:44:50
  17 06/06/2023 11:44:51
  26 06/06/2023 11:44:52
  40 06/06/2023 11:44:53
  48 06/06/2023 11:44:54
  52 06/06/2023 11:44:55
  41 06/06/2023 11:44:56
  32 06/06/2023 11:44:57
  24 06/06/2023 11:44:58
  10 06/06/2023 11:44:59
   3 06/06/2023 11:45:00
 298 06/06/2023 11:45:02{noformat}","07/Jun/23 6:42 AM;5b17571b91981f4fdde632c1;* Net
** Backend servers throwing errors (for example 500 status code)
** From WebSEAL front-end only 281 of 2,269,141 responses  were OVER 1 second ( *0.012%* )
** Client arrival rate is *NOT consistent* comes in bunches
** Client arrival rate by IP address is *NOT consistent*
** The client today warned they may be losing request.log files
*** Due to rollover
*** Have asked L2 to work with customer to make sure we do not *lose anything during entire run*","07/Jun/23 7:40 AM;5af0531368ebd52c36627c3b;Given Bill's observation that the response times in the request log show very little time spend in webseal, it seems like the pdweb.debug may be contributing a lot of contention at high levels.
So we should have them turn the pdweb debug off before they run the pstack logger.","12/Jun/23 9:42 AM;5b15d99b4c20165700edecad;BMO has updated the 06/09 Loadrunner data

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013221174&path=TS013221174%2F2023-06-11%2FBDB_6x_180TPS_Load_Test.zip_unpack%2F&filepath=TS013221174%2F2023-06-11%2FBDB_6x_180TPS_Load_Test.zip_unpack%2FReport.html|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013221174&path=TS013221174%2F2023-06-11%2FBDB_6x_180TPS_Load_Test.zip_unpack%2F&filepath=TS013221174%2F2023-06-11%2FBDB_6x_180TPS_Load_Test.zip_unpack%2FReport.html]","12/Jun/23 9:53 AM;5b17571b91981f4fdde632c1;* For ISVA L3 Support only
** The customer has been finding many issues/problems with their test backend webserver
*** Critical for their business
**** Apparently all business passes through this
** The customer previously mentioned the number of errors
*** So I studied the Roadrunner report fort errors
**** 767,732 failures
***** {{HTTP_500	  636,777			(83.4% of total failures:	Missing 125,955  )}}
****** The other 16.6% does not come from other HTTP status code
**** One key note
***** Majority of failures from from these operations (not URLs) … we do not know operations → URLs
****** BDB_Login_04_Login
****** BDB_Login_10_Secure_Message
****** BDB_Login_17_Account_Details
***** Not across all the BDB_* operations
****** Therefore the current assumption is the WebSEAL backend web server for those specific operations
** Dave found the average performance better than prior LoadRunner reports",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Allow jdk tls disabledAlgorithms to be set on the runtime profile at 10.0.5.0 /10.0.5.0 IF1,ISAMSUP-5115,304293,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,01/Jun/23 12:30 PM,26/Jun/23 11:50 AM,14/Jul/23 2:47 PM,26/Jun/23 11:50 AM,,Support Management,,0,,,,"HI



could you help us with the fix similar to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4522|https://cloudidentity.atlassian.net/browse/ISAMSUP-4522|smart-link] ",,Tushar Prasad,,,,,,,,,,,,,,,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013158296,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,IAG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cayv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-01 07:50:03.484,,,,,01/Jun/23 5:50 PM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] the fix for this should already be in 10.0.5.0 so you shouldn’t need any fixpacks. Have you tried setting the ATP mentioned in the item?,"05/Jun/23 11:14 PM;5c53d3ac23f5bf672621c868;HI

thanks Bhavan seems. I seem to miss the information that it was present in 10.0.5.0 and also I didn’t expect it to create a separate java.security file in federation runtime profile. (instead of JRE directory)

for now, I have sent an instructions to the customer and waiting for a response. I have some clarification on what would be an out of box values , is that what was in Jira or what comes in java.security file?

I will keep the Jira updated","06/Jun/23 10:21 AM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] since the switch from IBM Java to OpenJDK, this new file (and really only that only entry disabledAlgorithms) is the only way to address this.",26/Jun/23 11:50 AM;5b15d954b0d76456f36daf33;Case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
OIDC Fed calls to kickoff fail on upgrade from 10031 to 10040 ,ISAMSUP-5112,304282,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,01/Jun/23 8:57 AM,13/Jul/23 8:57 AM,13/Jul/23 9:02 AM,12/Jul/23 11:20 PM,,,,0,,,,"Error:  
[https://consulent-login-ldv.ops.vdab.be/LRR_INTERN/Handler?TAM_OP=error&USERNAME=unauthenticated&ERROR_CODE=0x38b9a4b2&URL=%2Fisam%2Fsps%2Foidc%2Frp%2Foidc-rp-intern%2Fkickoff%2Fplanon%3Fauthmethod%3Ditsme%26redirect_url%3Dhttps%253A%252F%252Fiam-rel1ldv.ops.vdab.behttps%253A%252F%252Fiam-rel1ldv.ops.vdab.be%252F&REFERER=https%3A%2F%2Fconsulent-login-ldv.ops.vdab.be%2F&HOSTNAME=fed-intern-ldv.ops.vdab.bep3p: CP=""NON CUR OTPi OUR NOR UNI""|https://consulent-login-ldv.ops.vdab.be/LRR_INTERN/Handler?TAM_OP=error&USERNAME=unauthenticated&ERROR_CODE=0x38b9a4b2&URL=%2Fisam%2Fsps%2Foidc%2Frp%2Foidc-rp-intern%2Fkickoff%2Fplanon%3Fauthmethod%3Ditsme%26redirect_url%3Dhttps%253A%252F%252Fiam-rel1ldv.ops.vdab.behttps%253A%252F%252Fiam-rel1ldv.ops.vdab.be%252F&REFERER=https%3A%2F%2Fconsulent-login-ldv.ops.vdab.be%2F&HOSTNAME=fed-intern-ldv.ops.vdab.bep3p:%20CP=%22NON%20CUR%20OTPi%20OUR%20NOR%20UNI%22]



Other symptoms: 

Httptransformation rule - 

\""2600 2023-01-16-18:44:12.969+00:00I----- 0x38B9A4B7 webseald ERROR wns httperrs XMLHTTPResponse.cpp 215 0x7f02d52e6700 -- DPWNS1207E The XML element HTTPResponseChange was missing from the response change document generated by a HTTP transformation operation.\""



There are other DB related errors in the log. 

Investigate further to see if the issue is with 
1. LRR forward changes
2. Http response transformation - (fixpack has been provided)
3. DB errors in log - 
{{java.sql.SQLException: Connection to 127.0.0.1:2020 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections. DSRA0010E: SQL State = 08001, Error Code = 0 at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:285)}}

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4595|https://cloudidentity.atlassian.net/browse/ISAMSUP-4595|smart-link] for history.",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5113,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011859411,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,MVG VDAB BEROEPSOPLEIDING,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cawf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-06-01 12:35:49.696,,,,,"01/Jun/23 9:00 AM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}HTTP transformation rules:
dyn_cors
dyn_cors_preflight

RP config not working: intranet-intern-ldv.txt
RP config working: intranet-intern-prd.txt

Not working browser trace: consulent-login-ldv.ops.vdab.be.har
Working browser trace: consulent-login.vdab.be.har

Federation config: federation.png
mapping rules used in federation config:
OIDC_VDAB_INTERN_ACM_OIDC_Id.js
OIDC_VDAB_INTERN_ACM_OIDC_Adv_Auth.js

{noformat}","01/Jun/23 2:26 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:614dd566a995ad0073ec0622] 

Here is a debug fixpack for 10050 -

 [https://cloudidentity.atlassian.net/browse/ISAMSUP-5113|https://cloudidentity.atlassian.net/browse/ISAMSUP-5113|smart-link] 

Install 10050 pkg file 

Install this fixpack at ISAMSUP-5113

Enable pdweb.debug and pdweb.httptransformation logs 

Run the test with - 
[server]
redirect-using-relative = yes
allow-url-macro-to-be-relative = true

See how you go with this.",01/Jun/23 10:35 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] The customer is operating on 10.0.4 after upgrade; this fixpack is for 10.0.5?,"02/Jun/23 9:08 AM;5af4ad7d4dd24c579110120b;[~accountid:614dd566a995ad0073ec0622] 

They should be at 10031 since it is their working environment, we don't want to lose that.
Upgrade from 10031 to 10050 (skip 10040)

So they can always go back to 10031 partition if this doesn't work.
Make sure they have vm level snapshots and appliance level snapshots before upgrading.",07/Jun/23 10:57 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] Ok that seemed to have worked. They tried to to upgrade to 10.0.5.1 but error reoccurred but I believe the plan was only to 10.0.5 anyhow? They have attached a 10.0.5 support file but I suppose a 10.0.5.1 support file is needed if we want to investigate the failures at 10.0.5.1?,"08/Jun/23 3:36 PM;5af4ad7d4dd24c579110120b;[~accountid:614dd566a995ad0073ec0622] 

Ok - if they upgrade to 10050IF1 -

Use this fixpack:

[https://ibm.box.com/s/ebifm2v3gtke6stw98xddn33mhd7boqb|https://ibm.box.com/s/ebifm2v3gtke6stw98xddn33mhd7boqb|smart-link]  ",08/Jun/23 6:09 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] I will advise to upgrade to 10.0.5.1. apply 10.0.5.1 fixpack. Keep parameters changed as before. Take debug and transformation logs and observer results.,08/Jun/23 6:46 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] I will advise to upgrade to 10.0.5.1. apply 10.0.5.1 fixpack. Keep parameters changed as before. Take debug and transformation logs and observer results. Is that ok?,08/Jun/23 7:22 PM;5af4ad7d4dd24c579110120b;[~accountid:614dd566a995ad0073ec0622] yes,12/Jul/23 11:20 PM;5ac57757d9a96536d1f0daa9;[~accountid:614dd566a995ad0073ec0622] I can see that the case associated with this Jira ticket is closing out. As this is the case I am setting this Jira items status to Done to reflect this. Appreciate all your support during this engagement. ,12/Jul/23 11:22 PM;614dd566a995ad0073ec0622;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5af4ad7d4dd24c579110120b] It would seem that the PMR could be closing soon. Will touch base if the customer decides otherwise. Thanks.,13/Jul/23 8:57 AM;5ac57757d9a96536d1f0daa9;[~accountid:614dd566a995ad0073ec0622] thank you for check on this one for us.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
logs of the Authorization REST API,ISAMSUP-5109,304253,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,01/Jun/23 1:13 AM,02/Jun/23 1:00 PM,14/Jul/23 2:47 PM,02/Jun/23 1:00 PM,,,,0,,,,"information about the service called Authorization REST API ([https://www.ibm.com/docs/en/sva/10.0.4?topic=applications-authorization-rest-api|https://www.ibm.com/docs/en/sva/10.0.4?topic=applications-authorization-rest-api|smart-link] ) 

The service is working properly, but customer needs to monitor the requests and the responses: 

The Customer is not interested in the usual ""request logs"" generated by any webseal. 
Instead, need logs that have information about each request body and each response body. 

The request body, as indicated in the documentation, is something like this: 
{
  ""user_name"": ""joe"",
  ""user_attributes"": {       
      ""AUTHENTICATION_LEVEL"": ""2""     
  },
  ""permission_bits"": ""Tr"",
  ""object_name"": ""/WebSEAL/default-ibm.com/test""
}

The response is something like this:
{
	""authorized"": true,
	""attributes"": {}
}



I suggested enabling the auditing in the webseald config file, like

logcfg = audit.azn:file path=audit.azn.txt  , or something like that.

The customer did but he said This is not useful.  They need logs that tell them how the REST APIs has handled the requests as in the documentation, again this is the link: [https://www.ibm.com/docs/en/sva/10.0.4?topic=applications-authorization-rest-api|https://www.ibm.com/docs/en/sva/10.0.4?topic=applications-authorization-rest-api|smart-link] 



Hope L3 can help to check if we have specific logs to do this?



RFE? or just expert labs to create some customized script?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013099398,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,REALE ITES SRL,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1capz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-31 17:55:48.019,,,,,"01/Jun/23 2:22 AM;614dd52af1c1740068534813;I guess only pdweb.snoop or pdweb.azn trace might give  what they want. However, it can't be run all the time.",01/Jun/23 3:55 AM;5b15d94b6256d01ad54eb020;No I don’t think we have any logging like that.  So yes that would be a RFE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Time is off on JSON logs going out of containers,ISAMSUP-5104,303477,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,31/May/23 1:09 AM,26/Jun/23 2:09 PM,14/Jul/23 2:47 PM,,,,,0,,,,"The customer mentions that his container logs are getting with 4 hours off:



by converting the time in the logs ([https://www.epochconverter.com/|https://www.epochconverter.com/|smart-link] ):



""instant"":{""epochSecond"":1683657923},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/[bootstrap.sh|https://bootstrap.sh/]""}, ""content"":""WGAWA0972I Starting the DSC Server.""}

{""instant"":{""epochSecond"":1683672323},""threadId"":""0x7f9d1d9597c0"",""level"":""ERROR"",""loggerName"":""/opt/dsc/bin/dscd"",""component"":""wds.server"",""message_id"":""0x38A0A25A"",""source"":{""file"":""AMWSMSSocket.cpp"",""line"":622}, ""content"":""DPWDS0602E The server could not bind to the configured address: ::""}



We notice that he is correct, and they have 4 hours of difference: 



Q: Could you clarify on the logs going out? Since you mention that no Splunk or Rsyslog is involved where are you seeing the 4 hours difference in the WebSeal logs?



A: In the webseal message logs and DSC logs. The webseal request logs are OK.



Q: The DSC logs showed the 4 hours difference but are you seeing the issue in the same minute to jump to the 4 hours difference in the log?



A: All the logs are exactly off 4 hours (GMT/UTC offset).



in [[ISAMSUP-4967] Problems with container logs? - ISV Jira (atlassian.net)|https://cloudidentity.atlassian.net/browse/ISAMSUP-4967] Bhavan reproduce it.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ47152,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012903309 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,,,,PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1c5xz:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-08 06:03:03.708,,,,,"06/Jun/23 9:57 PM;62e437a72fe585febb3c92a5;Customer update: 

Good morning Nicolas/IBM, can you provide an update on this case? Thanks!",08/Jun/23 4:03 PM;5b15d954b0d76456f36daf33;I’m working on a fix. In the meantime go ahead and create an APAR,"09/Jun/23 2:20 AM;62e437a72fe585febb3c92a5;[~accountid:5b15d954b0d76456f36daf33]  

APAR created successfully with number: IJ47152",19/Jun/23 6:02 PM;5b15d954b0d76456f36daf33;[~accountid:62e437a72fe585febb3c92a5] can you check if Matt plans to stay on 10.0.5.0_IF1 or has any plans to move to 10.0.6.0? Just so I know which version to target any potential fix.,20/Jun/23 12:46 AM;62e437a72fe585febb3c92a5;Checking with customer ,21/Jun/23 11:41 PM;62e437a72fe585febb3c92a5;customer update: Let's plan on getting this in 10.0.6.0. Our plan was to get to 10.0.6.0 all along. This gives me more reason to push it on this side.,22/Jun/23 12:15 PM;5b15d954b0d76456f36daf33;Thanks. I’ve upgraded my local environment to the same version.,"26/Jun/23 2:09 PM;5b15d954b0d76456f36daf33;– internal --

On working containers (like the config) localtime is being set correctly to the specified timezone file under /usr/share/zoneinfo

But for the broken ones (like wrp, dsc) localtime is being set to its own file with the timezone. Need to investigate why the discrepancy",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
 FreeRADIUS upgrade issues RDS Verify IBM module ISVA,ISAMSUP-5098,302415,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,26/May/23 11:44 PM,11/Jul/23 8:56 AM,14/Jul/23 2:47 PM,11/Jul/23 8:56 AM,,,,0,,,,"Hello Team, I hope you can advise on my new case TS013129864 FreeRADIUS upgrade issues RDS Verify IBM module ISVA.
They are having issue with the IBM FreeRADIUS module (came from [https://github.com/IBM-Security/IBM-Verify-FreeRADIUS)|https://github.com/IBM-Security/IBM-Verify-FreeRADIUS)|smart-link]  which we use for RDS push notifications.
The RADIUS server is managed by their network team currently. They upgrade FreeRADIUS server to version V3.0.15 then there is an error from the module.

Failed loading module rlm_verify from file /usr/lib64/freeradius/rlm_verify.so"", ""/etc/raddb/mods-enabled/verify[1]: Application and rlm_verify magic number (prefix) mismatch.  application: 0 module: f4""

First I dig into the [https://github.com/IBM-Security/IBM-Verify-FreeRADIUS|https://github.com/IBM-Security/IBM-Verify-FreeRADIUS|smart-link]  it is dated 2018. Then Edvan helped me searched within slack for related post and found: [https://ibm-security.slack.com/archives/C30JAJTFG/p1666700522671869?thread_ts=1666695186.301579&cid=C30JAJTFG|https://ibm-security.slack.com/archives/C30JAJTFG/p1666700522671869?thread_ts=1666695186.301579&cid=C30JAJTFG|smart-link]   

It seems IBM-Verify-FreeRADIUS is outdated and replaced by ISV Gateway for Radius. So We found [https://www.ibm.com/docs/en/security-verify?topic=integrations-security-verify-gateway-radius.|https://www.ibm.com/docs/en/security-verify?topic=integrations-security-verify-gateway-radius.|smart-link] 

The customer refused to new solution (ISV Gateway for Radius) and said they need something similar which will solve their problems not new application. 

Could you confirm do we support IBM FreeRADIUS module came from [https://github.com/IBM-Security/IBM-Verify-FreeRADIUS)|https://github.com/IBM-Security/IBM-Verify-FreeRADIUS)|smart-link] ",,Dermot Daly,Gabe,Nick Lloyd,Sten Drescher,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,09/Jun/23 5:38 PM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230609-073743.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/205071,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013129864,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,COLRUYT GROUP SERVICES NV,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1byrr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-05-26 15:01:55.744,,,,,"27/May/23 1:01 AM;5b15d94b6256d01ad54eb020;That is not supported.    As you mentioned the alternative is to use:  ISV Gateway for Radius.

Shane Weeden discusses options here:

[https://community.ibm.com/community/user/security/discussion/isam-integration-with-ibm-verify-freeradius|https://community.ibm.com/community/user/security/discussion/isam-integration-with-ibm-verify-freeradius|smart-link] 

and

[https://community.ibm.com/community/user/security/discussion/radius-integration-with-isva|https://community.ibm.com/community/user/security/discussion/radius-integration-with-isva|smart-link] ","09/Jun/23 5:38 PM;6092aca0f0db130069d19687;[~accountid:5b15d94b6256d01ad54eb020] Hello Bill, The customer reopened the case and asked ask us to check:

“I have gone through the solutions mentioned in the previous update to the ticket and discussed with my IT architects here and have the following summary.

Issue: We use FreeRadius here and that is hosted on Linux servers which recently were upgraded after which we are getting the errors as mentioned in this PMR.

So we eventually can't move our infra to Windows(which is a pre-requisite for Security Verify Gateway for RADIUS).

Resolution options:-

Option#1: We need an ""rlm_verify.so"" file that is compatible with the latest Linux and FreeRadius servers.

Option#2: Can you suggest a work-around to fix the current issue without the need to move to Windows?

Option#3: Can ISVA replace FreeRadius?” 

Please suggest what could they do?

!image-20230609-073743.png|width=1645,height=952!","09/Jun/23 11:24 PM;5b15d94b6256d01ad54eb020;[~accountid:6092aca0f0db130069d19687]   I’ll need to check with development on this.

[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5ac577587028785d133fbc46]   Is there anything we can do on this?  To my knowledge what they want is not supported.

Thanks",14/Jun/23 9:54 PM;6092aca0f0db130069d19687;[~accountid:5b15d94b6256d01ad54eb020] The customer asking for any update.,"14/Jun/23 11:20 PM;5b15d94b6256d01ad54eb020;[~accountid:6092aca0f0db130069d19687] I don’t believe this is supported. In which case there is nothing we can do.  However,  I did discuss this with Tony last night and he is looking into it.",14/Jun/23 11:24 PM;6092aca0f0db130069d19687;[~accountid:5b15d94b6256d01ad54eb020] The customer came back and asked how to set up IBM Security Verify Gateway Configuration for Radius. Do we have any instruction/cookbook for them?,14/Jun/23 11:29 PM;5b15d94b6256d01ad54eb020;Have you looked through the documentation to see if it mentions it?,"14/Jun/23 11:36 PM;6092aca0f0db130069d19687;[~accountid:5b15d94b6256d01ad54eb020] I found the IBM CLOUD IDENTITY MFA Everywhere with Cloud Identity Verify cookbook but it is 2019. I also found the IBM tech note below:

[https://www.ibm.com/docs/en/sva/10.0.5?topic=configuring-security-verify-gateway|https://www.ibm.com/docs/en/sva/10.0.5?topic=configuring-security-verify-gateway|smart-link] 

Reverse Proxy IBM Security Verify Gateway Configuration

[https://www.ibm.com/docs/en/sva/10.0.5?topic=gateway-reverse-proxy-security-verify-configuration|https://www.ibm.com/docs/en/sva/10.0.5?topic=gateway-reverse-proxy-security-verify-configuration|smart-link] 

IBM Security Verify Gateway for RADIUS

[https://www.ibm.com/docs/en/security-verify?topic=integrations-security-verify-gateway-radius|https://www.ibm.com/docs/en/security-verify?topic=integrations-security-verify-gateway-radius|smart-link] ","14/Jun/23 11:50 PM;5b15d94b6256d01ad54eb020;This all I can find on it

[https://www.ibm.com/docs/en/security-verify?topic=radius-configuring-security-verify-gateway-server|https://www.ibm.com/docs/en/security-verify?topic=radius-configuring-security-verify-gateway-server|smart-link] ",19/Jun/23 5:34 PM;6092aca0f0db130069d19687;[~accountid:5b15d94b6256d01ad54eb020] [~accountid:5ac57757d9a96536d1f0daa9]Is there any update to this case? is the customer need to use ISVG? ,20/Jun/23 3:03 AM;6092aca0f0db130069d19687;[~accountid:5b15d94b6256d01ad54eb020] [~accountid:5ac57757d9a96536d1f0daa9] Is there any instruction to config IBM Security Verify Gateway for RADIUS server (Managing on-premises integrations: Not via ISV). The instruction [https://www.ibm.com/docs/en/security-verify?topic=radius-configuring-security-verify-gateway-server|https://www.ibm.com/docs/en/security-verify?topic=radius-configuring-security-verify-gateway-server|smart-link] is not working it is for ISV. Any Idea? Please advise,22/Jun/23 4:28 AM;5b15d94b6256d01ad54eb020;[~accountid:6092aca0f0db130069d19687]  I don’t know of any.   Tony is out on vacation.   [~accountid:5ac577587028785d133fbc46] I was wondering if you knew who could answer some of these questions?   I don’t think Free Radius is a supported product. ,27/Jun/23 7:18 PM;6092aca0f0db130069d19687;[~accountid:5ac57757d9a96536d1f0daa9] Could you advise where can we instruction to config IBM Security Verify Gateway for RADIUS server (Managing on-premises integrations: Not via ISV). The instruction [https://www.ibm.com/docs/en/security-verify?topic=radius-configuring-security-verify-gateway-server|https://www.ibm.com/docs/en/security-verify?topic=radius-configuring-security-verify-gateway-server|smart-link] is not working it is for ISV. Any Idea? Please advise,27/Jun/23 7:47 PM;5c53d3ac23f5bf672621c868;[~accountid:6092aca0f0db130069d19687] just make a note . Windows comes with its own radius customer needs to either disable that or change its default listening port,27/Jun/23 8:01 PM;6092aca0f0db130069d19687;[~accountid:5c53d3ac23f5bf672621c868] Thanks for your comment. The customer has configured IBM security Verify Gateway on their appliance and installed the IBM Security Verify Gateway for RADIUS server on the windows server. How can they configure them? Please advise.,"27/Jun/23 11:39 PM;5c53d3ac23f5bf672621c868;[~accountid:6092aca0f0db130069d19687] 



To install the radius gateway on windows (follow the same steps as documented) , customer just needs to make sure the radius that comes with windows doesn’t conflict with verify radius (which means all default ports example port 1812 is being used by verify gateway radius instance)



Next set of steps is documented here

[https://www.ibm.com/docs/en/sva/10.0.4?topic=gateway-aac-security-verify|https://www.ibm.com/docs/en/sva/10.0.4?topic=gateway-aac-security-verify|smart-link] 

There is a wizard customer can run to start with.



LMI → AAC → IBM Security Verify Gateway

Along with Verify wizard, and radius integration and taking help from 

[https://www.ibm.com/docs/en/sva/10.0.4?topic=configuring-security-verify-gateway|https://www.ibm.com/docs/en/sva/10.0.4?topic=configuring-security-verify-gateway|smart-link] 

and 

[https://www.ibm.com/docs/en/security-verify?topic=login-authenticating-security-verify-gateway-windows|https://www.ibm.com/docs/en/security-verify?topic=login-authenticating-security-verify-gateway-windows|smart-link] 



All the steps are multiple steps which need to be completed

Majorly divided into two parts:(which you also noted earlier)

1.Radius client installation on windows server

customer can make use of this to do it

[https://www.ibm.com/docs/en/security-verify?topic=integrations-security-verify-gateway-radius|https://www.ibm.com/docs/en/security-verify?topic=integrations-security-verify-gateway-radius|smart-link] 

2.For the on prem, verify access all configuration documented here and a wizard is also available

[https://www.ibm.com/docs/en/sva/10.0.4?topic=configuring-security-verify-gateway|https://www.ibm.com/docs/en/sva/10.0.4?topic=configuring-security-verify-gateway|smart-link] 



I noted you have used all the above link here and you can give to the customer and let customer follow and complete the configurations.



Customer should start with above and then report to us what error they are facing. ( there will not be a blanket case to solve or implement this solution) there can be multiple cases with each step or issues customer is facing and then we can solve each issue as it comes.



At present:

if customer can refer the document and tell what steps they completed and what they are not sure

for example, they don’t know what to put into {{IbmRadiusConfig.json}} and then they can start to go through each parameter and see if the corresponding ISVA activity they completed.","27/Jun/23 11:46 PM;6092aca0f0db130069d19687;👍 [~accountid:5c53d3ac23f5bf672621c868] Thank you very very very much for your help and advise!! Yes it is good way to solve it. 👍 

I will work with customer about it.",28/Jun/23 8:19 AM;5ac57757d9a96536d1f0daa9;Great work here [~accountid:5c53d3ac23f5bf672621c868] [~accountid:6092aca0f0db130069d19687] ,"29/Jun/23 8:17 AM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868] thanks for helping out on this one.  

[~accountid:6092aca0f0db130069d19687] I’m moving this back to L2 for now.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA 10 Federation Module - crashes from time to time,ISAMSUP-5096,302109,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,25/May/23 10:55 PM,22/Jun/23 11:03 AM,12/Jul/23 2:15 PM,,,,,0,,,,"Customer having issue with the Federation runtime crashes from time to time and solution is to restart federation runtime. In order to avoid problem with federation, we restart Federation runtime proactively.

They are using LDAP (IBM Directory server) and searching within Mapping Rules. As result of Federation runtime problem there is message in the /federation/runtime/message.log:

{noformat}[1/10/23, 12:12:30:595 CET] 00005991 com.ibm.security.access.ldap.impl.LdapServerImpl             I javax.naming.CommunicationException: ldap01hz.prod.gzaop.local:3389 [Root exception is java.net.SocketException: Too many open files]
at java.naming/com.sun.jndi.ldap.Connection.<init>(Unknown Source)
[Root exception is java.net.SocketException: Too many open files]{noformat}

At the same time there are messages in the ffdc.log , for example, one of them is:

{noformat}-----Start of DE processing------ = [1/10/23, 12:12:32:114 CET]
Exception = com.ibm.wsspi.adaptable.module.UnableToAdaptException
Source = com.ibm.ws.security.appbnd.internal.authorization.AppBndAuthorizationTableService
probeid = 224
Stack Dump = com.ibm.wsspi.adaptable.module.UnableToAdaptException: com.ibm.ws.javaee.ddmodel.DDParser$ParseException: CWWKC2272E: An error occurred while parsing the /META-INF/ibm-application-bnd.xml deployment descriptor on line -1. The error message was: com.ibm.wsspi.adaptable.module.UnableToAdaptException: java.i{noformat}

There are some findings in the javacore file, it tells us that something is stuck at 303 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE at java/net/SocketInputStream.socketRead0
303 threads waiting on socket read, then all socket reads are on ldap connection so ldap is a culprit



   

{noformat}1 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at com/ibm/jvm/Dump.triggerDumpsImpl
1 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at java/lang/Thread.sleep
1 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at openj9/internal/tools/attach/target/IPC.waitSemaphore
1 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at org/apache/felix/scr/impl/ComponentActorThread.run
1 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at org/eclipse/core/internal/jobs/InternalWorker.run
1 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at org/eclipse/osgi/container/SystemModule.waitForStop
1 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at sun/nio/fs/LinuxWatchService.poll
2 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at java/lang/ref/ReferenceQueue.remove
3 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at org/eclipse/osgi/framework/eventmgr/EventManager$EventThread.getNextEvent
5 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at sun/nio/ch/EPoll.wait
6 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at jdk/internal/misc/Unsafe.park
7 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at com/ibm/ws/threading/internal/BoundedBuffer.waitGet_
7 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at java/util/TimerThread.mainLoop
303 javacore.20230310.151927.5932.0001.txt-4XESTACKTRACE                at java/net/SocketInputStream.socketRead0
1 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at com/ibm/jvm/Dump.triggerDumpsImpl
1 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at java/lang/Thread.sleep
1 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at openj9/internal/tools/attach/target/IPC.waitSemaphore
1 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at org/apache/felix/scr/impl/ComponentActorThread.run
1 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at org/eclipse/core/internal/jobs/InternalWorker.run
1 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at org/eclipse/osgi/container/SystemModule.waitForStop
1 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at sun/nio/fs/LinuxWatchService.poll
2 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at java/lang/ref/ReferenceQueue.remove
3 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at org/eclipse/osgi/framework/eventmgr/EventManager$EventThread.getNextEvent
5 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at sun/nio/ch/EPoll.wait
6 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at jdk/internal/misc/Unsafe.park
7 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at com/ibm/ws/threading/internal/BoundedBuffer.waitGet_
7 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at java/util/TimerThread.mainLoop
303 javacore.20230310.151949.5932.0003.txt-4XESTACKTRACE                at java/net/SocketInputStream.socketRead0
1 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at com/ibm/jvm/Dump.triggerDumpsImpl
1 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at java/lang/Thread.sleep
1 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at openj9/internal/tools/attach/target/IPC.waitSemaphore
1 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at org/apache/felix/scr/impl/ComponentActorThread.run
1 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at org/eclipse/core/internal/jobs/InternalWorker.run
1 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at org/eclipse/osgi/container/SystemModule.waitForStop
1 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at sun/nio/fs/LinuxWatchService.poll
2 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at java/lang/ref/ReferenceQueue.remove
3 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at org/eclipse/osgi/framework/eventmgr/EventManager$EventThread.getNextEvent
5 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at sun/nio/ch/EPoll.wait
6 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at jdk/internal/misc/Unsafe.park
7 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at com/ibm/ws/threading/internal/BoundedBuffer.waitGet_
7 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at java/util/TimerThread.mainLoop
303 javacore.20230310.152010.5932.0005.txt-4XESTACKTRACE                at java/net/SocketInputStream.socketRead0

{noformat}

{noformat}3XMTHREADINFO      ""Thread-16175"" J9VMThread:0x0000000002611400, omrthread_t:0x00007F853C08F210, java/lang/Thread:0x000000009D45F3F8, state:R, prio=5
3XMJAVALTHREAD            (java/lang/Thread getId:0x54E2, isDaemon:true)
3XMTHREADINFO1            (native thread ID:0x2666, native priority:0x5, native policy:UNKNOWN, vmstate:R, vm thread flags:0x000000a1)
3XMTHREADINFO2            (native stack address range from:0x00007F84B1228000, to:0x00007F84B1268000, size:0x40000)
3XMCPUTIME               CPU usage total: 0.018208230 secs, current category=""Application""
3XMHEAPALLOC             Heap bytes allocated since last GC cycle=0 (0x0)
3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at java/net/SocketInputStream.socketRead0(Native Method)
4XESTACKTRACE                at java/net/SocketInputStream.socketRead(Bytecode PC:8(Compiled Code))
4XESTACKTRACE                at java/net/SocketInputStream.read(Bytecode PC:114(Compiled Code))
4XESTACKTRACE                at java/net/SocketInputStream.read(Bytecode PC:11(Compiled Code))
4XESTACKTRACE                at java/io/BufferedInputStream.fill(Bytecode PC:217(Compiled Code))
4XESTACKTRACE                at java/io/BufferedInputStream.read1(Bytecode PC:44(Compiled Code))
4XESTACKTRACE                at java/io/BufferedInputStream.read(Bytecode PC:49(Compiled Code))
5XESTACKTRACE                   (entered lock: java/io/BufferedInputStream@0x000000009D4D3F18, entry count: 1)
4XESTACKTRACE                at com/sun/jndi/ldap/Connection.run(Bytecode PC:30(Compiled Code))
4XESTACKTRACE                at java/lang/Thread.run(Bytecode PC:13(Compiled Code))
3XMTHREADINFO3           No native callstack available for this thread
NULL{noformat}



And we have suggested the customer to set the Jndi tuning as below:-

{noformat}-Dcom.sun.jndi.ldap.connect.pool.timeout=10000
-Dcom.sun.jndi.ldap.connect.pool=true 
-Dcom.sun.jndi.ldap.connect.pool.protocol=plain ssl  
-Dcom.sun.jndi.ldap.connect.pool.authentication=simple
-Dcom.sun.jndi.ldap.connect.pool.initsize=10 
-Dcom.sun.jndi.ldap.connect.pool.maxsize=200
-Dcom.sun.jndi.ldap.connect.pool.prefsize=0{noformat}

Also apply the memory growth fix For example

Key=runtime_profile.jvm_option
Value=-Dcom.sun.jndi.ldap.connect.pool.timeout=10000

JVM size is less
-Xms2048m
Set it up to --Xmx to 4096

2GB is less for a production environment

*After making the suggested Jodi running parameter, they got new crash of federation runtime this week.*",,Annelise Quap,Dermot Daly,khansen,Nick Lloyd,Nilesh Amrutkar,Tushar Prasad,,,,,,,,,,5b15d950d9936c61022057fe,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b1757156d76184b7d98a0c3,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5100,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011861075,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,APIS IT D.O.O.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bww7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-05-28 22:09:11.999,,,,,29/May/23 8:09 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please take a look at this customers case and provide assistance to move this forwards ,"29/May/23 12:33 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] 

I have added a change to include com.sun.jndi.ldap.read.timeout. to be the idle timeout * 100 that is set in the server connection properties.

Apply this fix pack - [https://cloudidentity.atlassian.net/browse/ISAMSUP-5100|https://cloudidentity.atlassian.net/browse/ISAMSUP-5100|smart-link] 

set the AAC trace to {{com.ibm.security.access.common.*=ALL:com.tivoli.am.fim.ldap.*=ALL}}

See if this resolves the issue since the read timeout will be active and not leaving any connections active and waiting indefinitely.



In addition  - What are the values for LDAP server connection tuning properties tab set to for this server connection? 

Thanks","01/Jun/23 6:11 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] I have provided the details to the customer as mentioned but they have some queries related to this:
The values for LDAP server connection tuning properties tab set to for this server connection are:
Connection timeout (seconds): unset
Max idle time (seconds): 300
Max pool size: 10

There is not SSL connection (ldaps) between ISVA and LDAP.

It is just ldap connection.

Do they suppose that fix 1040_AccessToken_fix.fixpack sets Connection timeout (seconds) on 100.

Customer’s query is:
Is it possible that set Connection timeout (seconds) on 100 manually without applying fix?","02/Jun/23 11:45 AM;5af4ad7d4dd24c579110120b;If they have not set the Connection timeout (seconds) then first step is to set that and test the environment,
Even after that read timeout will not be effective without fixpack. 

They will need the fixpack for read timeout to take effect.","06/Jun/23 10:37 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 

Customer is in ISVA v 10.0.3.1 and they are having issue at Prod environment

The fix pack we have shared to the customer is 1040_AccessToken_fix.fixpack to test installation, they see how it works in the installation environment before installation in the production environment.

They installed fix 1040_AccessToken_fix.fixpack in the installation environment and got message:

""*System Error*

*The system failed to install the fix pack*.""

They have some fixpack from my previous PMRs and decided to try with postgres_conf_permissions_fix.fixpack, just to test that their environment is correct.

The postgres_conf_permissions_fix.fixpack was not installed in the installation environment before.

They installed the fix postgres_conf_permissions_fix.fixpack without issues and later they rolled back it without any issue.

They think that something is wrong with 1040_AccessToken_fix.fixpack.

Now they are questioning:

Is 1040_AccessToken_fix.fixpack part of some later release, for examlpe ISVA v 10.0.5 or even v. 10.0.6?

What exactly 1040_AccessToken_fix.fixpack do on ISVA?

Can you check 1040_AccessToken_fix.fixpack?","07/Jun/23 10:11 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] 

If the customer is on 10031 - how or when did they install a fixpack for 10040.
Do they have two environments - one with 10031 and one with 10040? 
Is the production on 10040? 

If you install a fixpack built for 10040 on 10031 it will not install.

I found the link for 1040_AccessToken_fix.fixpack  [https://ibm.ent.box.com/folder/202298954754?s=782u3p30uue08iq0wh0i3nkefh2nix3p|https://ibm.ent.box.com/folder/202298954754?s=782u3p30uue08iq0wh0i3nkefh2nix3p] but not sure which issue was it sent for - do you have the case number and associated Jira for this fixpack ? 


1040_AccessToken_fix.fixpack and the ldap_readtmo_10031.fixpack change the same jar so if they will need the changes merged if they do.

/opt/ibm/wlp/usr/extension/lib/isam/common/com.ibm.security.access.common_8.0.0.jar ","12/Jun/23 5:53 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b]  Customer respond back:

There all environments are ISVA v. 10.0.3.1. So, they need fix for 10.0.3.1.

Customer’s reply:

----


If I need to install new fix, I need to install new updates from installation environment to production environment and test every environment. It needs a lot of time. We are using PDJRTE API for some applications. We are using pdjrte api from v iSVA 9 because it was not possible to configure new pdjtre v 10.0.3 (PD.jar) in the Linux operational system where we have our websphere application servers.

This ISVA v 10 is full of issuses. As I can read on IBM sites, it is recomended that the Policy Directory Java™ library (PD.jar) 10.0.2.0 level should still be used. I even do not have 10.0.2.0, because we have never installed ISVA v 10.0.2.0. We migrated from ISAM v 9 to ISVA 10.0.3.1. This problem is not part of this PMR, it is just illustration of the ISVA's issuess.

This ISVA v 10 is full of problems and because of it ,It is not easy to change environment from one version to another just like that.

And It is not possible to uninstall updates to the previous release.

By the way:

It is little unussual that IBM suggest to install lower version of production. It usually demands the latest version.

What exactly 1040_AccessToken_fix.fixpack do on ISVA?
I cannot find any information on IBM web sites.

Can you adapt 1040_AccessToken_fix.fixpack for ISVA v10.0.3.1?
On the beggining of this PMR, I asked is it possible that Apar IJ39126 can help.

Can Apar IJ39126 help?

----","13/Jun/23 12:50 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] 

I have a fixpack built for read timeout and the access token fix back ported and merged from 1040_AccessToken_fix.fixpack.

Fixpack: [https://ibm.box.com/s/mn94lveoi0a563s6rliuf7f6jb6i36lz|https://ibm.box.com/s/mn94lveoi0a563s6rliuf7f6jb6i36lz|smart-link] 
Checksum: [https://ibm.box.com/s/fl13g8ncg1xsf0avv3vk6j1a11j4y1g8|https://ibm.box.com/s/fl13g8ncg1xsf0avv3vk6j1a11j4y1g8|smart-link] 

This should install on 10031.



1040_AccessToken_fix.fixpack - maps to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4863|https://cloudidentity.atlassian.net/browse/ISAMSUP-4863|smart-link] looks like you reported that issue as well - IJ46256","17/Jun/23 12:51 AM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 

Customer update that the ldap_readtmo_10031-2.fixpack has been installed successfully in the installation environment. The issues which is subject of this PMR happens only in the production environment, but they have to follow some standards in our firm and cannot apply fix in the production environment without testing fix in the development, test and preproduction environments. So, they need, before installing fix in next environment, some answers:

# Do I need to restart appliance after installation this fixpack?
# Do I need to restart Federation Runtime after installing this fixpack?
# I was not asked for restart after installation.
# Can I see somewhere on ISVA new parameter after installing fix that I can adjust manually? Where can I find it?
# Is there some way to recognize that fix is installed or it is only on the Fix Packs list?
# Did some customer test this fixpack before or it is only for us?
# Will this fix be part of some new release in the future? For example ISVA v. 10.0.6.0?
# After applying for example ISVA v. 10.0.5.0 do I need to ask for ldap_readtmo_.fixpack for 10.0.5?","19/Jun/23 10:18 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] 

# Do I need to restart appliance after installation this fixpack?
## No
# Do I need to restart Federation Runtime after installing this fixpack?
## It restarts runtime automatically when you install the fixpack
# I was not asked for restart after installation.
## ok
# Can I see somewhere on ISVA new parameter after installing fix that I can adjust manually? Where can I find it?
## No specific parameter, you can enable com.tivoli.am.fim.*=ALL logs and see debug log print the timeout details. 
# Is there some way to recognize that fix is installed or it is only on the Fix Packs list?
## Fixpack list in LMI, CLI, create a support file it will show the fixpack logs
# Did some customer test this fixpack before or it is only for us?
## Read timeout - Yes some other customer has tested and it resolved the issue for them
# Will this fix be part of some new release in the future? For example ISVA v. 10.0.6.0?
## It is already a part of 10.0.5.0 - APAR - IJ40417
# After applying for example ISVA v. 10.0.5.0 do I need to ask for ldap_readtmo_.fixpack for 10.0.5?
## No 10.0.50 has the fix ","20/Jun/23 9:02 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 

Before applying ldap_readtmo_10031-2.fixpack on the ISVA:

If apply fixpack ldap_readtmo_10031-2.fixpack on the ISVA v. 10.0.3.1, do customer needs to uninstall ldap_readtmo_10031-2.fixpack before installing for example (applying) v.10.0.5.0 on the ISVA?","21/Jun/23 7:44 AM;5af4ad7d4dd24c579110120b;[~accountid:627a7fb30d1e73006f7c21cf] on 10031 yes

this change for ldap read timeout is included in 10050 so they don't need a fixpack on 10050, they just need to set connect timeout values.

If they upgrade to 10050 you cant install the same fixpack that was built for 10031.","21/Jun/23 7:00 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] I have shared this fixpack ldapreadtmo_fedalias_10031.fixpack to one of my customer. 
Customer was having this IJ40141_1031.fixpack installed which looks to be overwritten. He is getting this now
Caused by: org.mozilla.javascript.EvaluatorException: Access to Java class ""com.sun.xml.messaging.saaj.soap.impl.NodeListImpl"" is prohibited. (util_wstrust#21)

Can you please check compatibility of ldapreadtmo_fedalias_10031.fixpack with IJ40141_1031.fixpack?",22/Jun/23 3:42 AM;5b15d950d9936c61022057fe;It looks like this Jira was cross linked to a different case for a different customer NedBank TS012840862,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Login Issues ISVA 10.0.4,ISAMSUP-5091,301476,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,23/May/23 5:45 PM,30/May/23 1:41 PM,14/Jul/23 2:47 PM,30/May/23 1:41 PM,,,,0,,,,"

Customer environment details:

Total 5 appliance with 2 Master and 3 nodes hosting RP

DSC running on Primary & Secondary master

We used only Primary master & 1 RP appliance to do some testing.

As soon as we change connection idle timeout =6 and deployed the changes the RP started showing errors while creating session to DSC via /mga junction.

request.log shows HTTP 503 Service Unavailable during 1st attempt and HTTP 200 on next attempt

10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:14:36 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 503 1271 - 13241 1 -

10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:14:39 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 200 530 33a20f9a-f61d-11ed-80fe-0050569b3c40 127466 1 -

10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:15:09 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 503 1271 - 7724 1 -

10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:15:09 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 200 530 45910558-f61d-11ed-80fe-0050569b3c40 111103 1 -

10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:15:22 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 503 1271 - 16216 1 -

10.202.6.251 10.202.6.98 - unauthenticated 19/May/2023:11:15:23 +0300 ""POST /mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:aliasotp HTTP/1.1"" 200 520 4d5c1264-f61d-11ed-80fe-0050569b3c40 154374 1 -

the RP message log shows error around the same timestamp for all attempts as above:

2023-05-19-11:14:36.827+03:00I----- 0x38A0A135 webseald ERROR wds client AMWSMSSOAPCall.cpp 107 0x7f49d3965700 -- DPWDS0309E   An error was returned from the SOAP server in cluster dsess when calling the createSession interface: DPWDS0316E   The distributed session cache server did not return a response. (pd / wds) (code: 0x38a0a13c). 

2023-05-19-11:14:36.827+03:00I----- 0x38B9A425 webseald ERROR wns session WSRemoteCache.cpp 2744 0x7f49d3965700 -- DPWNS1061E   An attempt to create a session failed with error code 0x38a0a13c.

2023-05-19-11:15:09.277+03:00I----- 0x38A0A135 webseald ERROR wds client AMWSMSSOAPCall.cpp 107 0x7f49c2d35700 -- DPWDS0309E   An error was returned from the SOAP server in cluster dsess when calling the createSession interface: DPWDS0316E   The distributed session cache server did not return a response. (pd / wds) (code: 0x38a0a13c).

2023-05-19-11:15:09.277+03:00I----- 0x38B9A425 webseald ERROR wns session WSRemoteCache.cpp 2744 0x7f49c2d35700 -- DPWNS1061E   An attempt to create a session failed with error code 0x38a0a13c.

2023-05-19-11:15:22.182+03:00I----- 0x38A0A135 webseald ERROR wds client AMWSMSSOAPCall.cpp 107 0x7f49d1c32700 -- DPWDS0309E   An error was returned from the SOAP server in cluster dsess when calling the createSession interface: DPWDS0316E   The distributed session cache server did not return a response. (pd / wds) (code: 0x38a0a13c).

2023-05-19-11:15:22.182+03:00I----- 0x38B9A425 webseald ERROR wns session WSRemoteCache.cpp 2744 0x7f49d1c32700 -- DPWNS1061E   An attempt to create a session failed with error code 0x38a0a13c.

also captured the RP routing trace which shows the error:

2023-05-19-11:14:36.826+03:00I----- webseald DEBUG9 wns authn /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp 1024 0x7f49d3965700

[10.202.6.251] max-concurrent-web-sessions policy from cred = (null)

2023-05-19-11:14:36.826+03:00I----- webseald DEBUG9 wns authn /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp 872 0x7f49d3965700

[10.202.6.251] WSCredsCacheEntry::getSessOwner = unauthenticated

2023-05-19-11:14:36.826+03:00I----- webseald DEBUG9 wns authn /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp 966 0x7f49d3965700

[10.202.6.251] WSCredsCacheEntry::getAutoDisplaceSessions = 1

2023-05-19-11:14:36.826+03:00I----- webseald DEBUG8 wns session /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp 2821 0x7f49d3965700

[10.202.6.251] ENTER am_dsess_create_session: key=rR60UuTLSdm1iBg4h4rWlvyKw8ZwBWkDbbE6neoel3nJyc1wMWc=, sessPol=0,session=

Session 0x7f49c406db48, size=30:

   instances[0]

      data_class=com.tivoli.am.eb.credential

      instance=sms

      replication=1

      value_len=-1

      value=BAKs3DCCA68MADCCA6kwggOlAgIQBAIBADCCA5owggOWMC8MGEFaTl9DUkVEX0FVVEhfRVBPQ0hfVElNRTATMBECAQQMCjE2ODQ0ODQwNzYEADAtDBVBWk5fQ1JFRF9CUk9XU0VSX0lORk8wFDASAgEEDAtKYXZhLzE3LjAuNgQAMCYMEkFaTl9DUkVEX0lQX0ZBTUlMWTAQMA4CAQQMB0FGX0lORVQEADArDBBBWk5fQ1JFRF9NRUNIX0lEMBcwFQIBBAwOSVZfVU5BVVRIX1YzLjAEADAzDBxBWk5fQ1JFRF9ORVRXT1JLX0FERFJFU1NfQklOMBMwEQIBBAwKMHgwYWNhMDZmYgQAMDUMHEFaTl9DUkVEX05FVFdPUktfQUREUkVTU19TVFIwFTATAgEEDAwxMC4yMDIuNi4yNTEEADAxDBlBWk5fQ1JFRF9QUklOQ0lQQUxfRE9NQUlOMBQwEgIBBAwLUkJSTy1SQkctQ0MEADAzDBdBWk5fQ1JFRF9QUklOQ0lQQUxfTkFNRTAYMBYCAQQMD3VuYXV0aGVudGljYXRlZAQAMC0MEUFaTl9DUkVEX1FPUF9JTkZPMBgwFgIBBAwPU1NLOiBUTFNWMTI6IDMwBAAwLgwSQVpOX0NSRURfVVNFUl9JTkZPMBgwFgIBBAwPdW5hdXRoZW50aWNhdGVkBAAwJwwQQVpOX0NSRURfVkVSU0lPTjATMBECAQQMCjB4MDAwMDEwMDQEADA8DBFTTVNfU0VTU0lPTl9SRUFMTTAnMCUCAQQMHklTQU0tRGlzdHJpYnV0ZWQtU2Vzc2lvbi1DYWNoZQQAMDQMGHRhZ3ZhbHVlX2xvZ2luX3VzZXJfbmFtZTAYMBYCAQQMD3VuYXV0aGVudGljYXRlZAQAMEcMFnRhZ3ZhbHVlX3Nlc3Npb25faW5kZXgwLTArAgEEDCQzMWNiNjJlOC1mNjFkLTExZWQtODBmZS0wMDUwNTY5YjNjNDAEADCBxQwYdGFndmFsdWVfdXNlcl9zZXNzaW9uX2lkMIGoMIGlAgEEDIGdWTJsaGJTMXljREl0Y0hKbExuSmljbTh1Y21KbkxtTmpMV1JsWm1GMWJIUUFfWkdjdjdBQUFBQUlBQUFBMDdDOW5aSWlpQU54SmZ3QUFjbEkyTUZWMVZFeFRaRzB4YVVKbk5HZzBjbGRzZG5sTGR6aGFkMEpYYTBSaVlrVTJibVZ2Wld3emJrcDVZekYzVFZkalBRPT06ZGVmYXVsdAQA

   instances[1]

      data_class=com.tivoli.am.eb.auth-type

      instance=sms

      replication=1

      value_len=-1

      value=(null)

   instances[2]

      data_class=com.tivoli.am.webseal.orig-auth-type

      instance=webseal

      replication=1

      value_len=-1

      value=(null)

   instances[3]

      data_class=com.tivoli.am.webseal.mpa-type

      instance=webseal

      replication=1

      value_len=-1

      value=0x0

   instances[4]

      data_class=com.tivoli.am.webseal.lifetime-extended

      instance=webseal

      replication=1

      value_len=-1

      value=false

   instances[5]

      data_class=com.tivoli.am.webseal.refresh-failover

      instance=webseal

      replication=0

      value_len=-1

      value=false

   instances[6]

      data_class=com.tivoli.am.webseal.force-reauth

      instance=webseal

      replication=1

      value_len=-1

      value=false

   instances[7]

      data_class=com.tivoli.am.webseal.orig-session-key

      instance=webseal

      replication=0

      value_len=-1

      value=(null)

   instances[8]

      data_class=com.tivoli.am.webseal.inactivity-timeout

      instance=webseal

      replication=1

      value_len=-1

      value=0x708

   instances[9]

      data_class=com.tivoli.am.webseal.custom-inactivity-timeout

      instance=webseal

      replication=1

      value_len=-1

      value=false

   instances[10]

      data_class=com.tivoli.am.webseal.custom-lifetime-timeout

      instance=webseal

      replication=1

      value_len=-1

      value=false

   instances[11]

      data_class=com.tivoli.am.webseal.otp

      instance=webseal

      replication=0

      value_len=-1

      value=(null)

   instances[12]

      data_class=com.tivoli.am.webseal.auth-data

      instance=webseal

      replication=0

      value_len=-1

      value=(null)

   instances[13]

      data_class=com.tivoli.am.webseal.permitted-junctions

      instance=webseal

      replication=0

      value_len=-1

      value=

   instances[14]

      data_class=com.tivoli.am.webseal.cookie-jar.stored-cookies

      instance=webseal

      replication=0

      value_len=-1

      value=

   instances[15]

      data_class=com.tivoli.am.webseal.cookie-jar.managed-cookies

      instance=webseal

      replication=0

      value_len=-1

      value=reset#;;;

   instances[16]

      data_class=com.tivoli.am.eb.user-name

      instance=sms

      replication=1

      value_len=-1

      value=unauthenticated

   instances[17]

      data_class=com.tivoli.am.sms.user-uuid

      instance=sms

      replication=1

      value_len=-1

      value=(null)

   instances[18]

      data_class=com.tivoli.am.eb.expiry

      instance=sms

      replication=1

      value_len=-1

      value=0x64673dfc

   instances[19]

      data_class=com.tivoli.am.sms.concurrent-session-key-class

      instance=sms

      replication=1

      value_len=-1

      value=com.tivoli.am.eb.user-name

   instances[20]

      data_class=com.tivoli.am.sms.concurrent-session-key-instance

      instance=sms

      replication=1

      value_len=-1

      value=sms

   instances[21]

      data_class=com.tivoli.am.sms.session-index

      instance=sms

      replication=1

      value_len=-1

      value=31cb62e8-f61d-11ed-80fe-0050569b3c40

   instances[22]

      data_class=com.tivoli.am.eb.version

      instance=sms

      replication=1

      value_len=-1

      value=0x1

   instances[23]

      data_class=com.tivoli.am.sms.class

      instance=sms

      replication=1

      value_len=-1

      value=com.tivoli.am.eb

   instances[24]

      data_class=com.tivoli.am.sms.creation-time

      instance=sms

      replication=0

      value_len=-1

      value=0x64672fec

   instances[25]

      data_class=com.tivoli.am.eb.is-inactive

      instance=sms

      replication=1

      value_len=-1

      value=false

   instances[26]

      data_class=com.tivoli.am.eb.last-access

      instance=sms

      replication=0

      value_len=-1

      value=0x64672fec

   instances[27]

      data_class=com.tivoli.am.webseal.multi-domain-session

      instance=webseal

      replication=1

      value_len=-1

      value=false

   instances[28]

      data_class=com.tivoli.am.webseal.flush-sms-session

      instance=webseal

      replication=0

      value_len=-1

      value=false

   instances[29]

      data_class=com.tivoli.am.webseal.version

      instance=webseal

      replication=0

      value_len=-1

      value=0x1

2023-05-19-11:14:36.827+03:00I----- webseald DEBUG8 wns session /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp 2831 0x7f49d3965700

[10.202.6.251] RETURN am_dsess_create_session: sessVer=0, clearOnRead=0, status=0x38a0a13c

This is what think is happening but need your help to chk the DSC client code and confirm the behavior.

it seems DSC server is closing the connection after 6 seconds once connection becomes idle, however DSC Client (RP) instance use the stale connection to send the request and it fails. During next attempt, it makes a new connection and process successfully.

Again after 6 seconds, the issue reappears.

IBM Support files from Pre Live environment:

Primary master hosting DSC: 

/ecurep/sf/TS013/049/TS013049870/2023-05-19/isva_10.0.4.0_20230519-111832_ciam-ps1-pre.rbro.rbg.cc.support_unpack/

RP instance:

/ecurep/sf/TS013/049/TS013049870/2023-05-19/isva_10.0.4.0_20230519-111705_ciam-rp2-pre.rbro.rbg.cc.support_unpack/

instance name: default with routing trace

Could you pls confirm if this is defect?



PROD Files:

isva_10.0.4.0_20230519-115700_PROD_ciam-ps1.rbro.rbg.cc.support

isva_10.0.4.0_20230519-120843_PROD_ciam-rp1.rbro.rbg.cc.support

PRE LIVE Files:

isva_10.0.4.0_20230519-111705_ciam-rp2-pre.rbro.rbg.cc.support

isva_10.0.4.0_20230519-111832_ciam-ps1-pre.rbro.rbg.cc.support",,Alan Wong,Ayush Singh,BRIANORO,Dermot Daly,Prabhjeet.Multani,Surya Prakash,Syed Hasan Jafar,Virag Patel,,,,,,,,6092aca0f0db130069d19687,61409dc154762c006932ffc7,6154906364ff01007106e189,6092ac9ff6c0960069d47a67,627a7fb30d1e73006f7c21cf,60f541a6d0134900692d91b7,617a5f2cf485cd0068cb98af,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013049870,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,RAIFFEISEN BANK S.A.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS013049870&path=TS013049870/2023-05-19/&filepath=TS013049870/2023-05-19/isva_10.0.4.0_20230519-111832_ciam-ps1-pre.rbro.rbg.cc.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013049870&path=TS013049870/2023-05-19/&filepath=TS013049870/2023-05-19/isva_10.0.4.0_20230519-115700_PROD_ciam-ps1.rbro.rbg.cc.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013049870&path=TS013049870/2023-05-19/&filepath=TS013049870/2023-05-19/isva_10.0.4.0_20230519-120843_PROD_ciam-rp1.rbro.rbg.cc.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013049870&path=TS013049870/2023-05-19/&filepath=TS013049870/2023-05-19/isva_10.0.4.0_20230519-111705_ciam-rp2-pre.rbro.rbg.cc.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013049870&path=TS013049870/2023-05-17/&filepath=TS013049870/2023-05-17/isva_10.0.4.0_20230517-123717_ciam-ps1-pre.rbro.rbg.cc.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013049870&path=TS013049870/2023-05-17/&filepath=TS013049870/2023-05-17/isva_10.0.4.0_20230517-134021_ciam-ps1-pre.rbro.rbg.cc.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013049870&path=TS013049870/2023-05-17/&filepath=TS013049870/2023-05-17/isva_10.0.4.0_20230517-124852_ciam-ps1-pre.rbro.rbg.cc.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013049870&path=TS013049870/2023-05-17/&filepath=TS013049870/2023-05-17/isva_10.0.4.0_20230517-132252_ciam-ps1-pre.rbro.rbg.cc.support",,,,,,,,,,,,,,,,,,,,,,,0|i1bt0v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-23 14:36:23.487,,,,,"24/May/23 12:36 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] assigning this item to you as the primary point of contact for this customers engagements. 

[~accountid:61409dc154762c006932ffc7] we currently have a number of Jira items opened for this customer. Can you please confirm if this is a new environment that has been deployed or is it the same as the one that the customer currently has the hourly cluster restart configured. Also regarding the primary issue reported in the log file “DPWDS0316E   The distributed session cache server did not return a response.“ can you please review and confirm the connectivity details between the ISVA and the DSC as outlined in the following URL - [https://www.ibm.com/docs/en/sva/10.0.1?topic=messages-dpwds0316e|https://www.ibm.com/docs/en/sva/10.0.1?topic=messages-dpwds0316e|smart-link] 

Reassigning this item back to Response Due to L2. ","24/May/23 11:59 AM;5b17571a82e05b22cc7d5d9e;[~accountid:5ac57757d9a96536d1f0daa9] customer has primarily 2 issues

* DSC hangs and requires restart
* Intermittent failures causing HTTP 503 Service Unavailable 

Both issues are happening in production. The reported issue in this Jira L2 can reproduce. Also conducted webex call with David & Bhavan yesterday to explain the situation.



[~accountid:5b15d954b0d76456f36daf33] as per our discussion yesterday, this new Jira item is opened. All the data and analysis is shared here. Kindly let us know if you need anything else to investigate the DSC error.",24/May/23 1:06 PM;5b15d954b0d76456f36daf33;Thanks [~accountid:5b17571a82e05b22cc7d5d9e] I’ll go over the support files to see if it is a bug. Or if a corresponding config change is needed elsewhere.,"24/May/23 5:31 PM;5b15d954b0d76456f36daf33;[~accountid:5b17571a82e05b22cc7d5d9e] as suspected, this issue is caused by DSC server closing the connection before the client (WebSEAL) had a chance to do it. That is what is causing the stale connection to be reused and leading to the 503 service unavailable error.

That {{connection-idle-timeout}} works this way:

* If 0, each request creates a new connection which leads to the overhead of DSC having to close after each use.
* If >0, connections are reused which increases the efficiency of communication and potentially reduces the number of connections at DSC.
** This value however needs to be greater than or equal to any client timeout. In webseal configuration files, this is usually this stanza entry:

{quote}[dsess-cluster]

handle-idle-timeout = 30{quote}

* I’m not entirely sure what if any is the default for a different client like the federation runtime. It seems to correspond to {{sms.broadcastWaitTime}} in the {{dscclient.properties}} file with a default value of 60 seconds.
* Like we did in your local environment, have them start with 30 and see if they get around the 503 problem. Otherwise, try with 60.

Once they get past this, they should be able to perform the stress test to replicate the problem in production.","24/May/23 9:42 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

Thanks for the update

by setting connect-idle-timeout to more than reverse proxy handle-idle-timeout ,  503 errors were not available

could you also help to confirm what would be federation idle connection timeout ? as there are ambiguity and we would like to have a confirmed value provided to the customer( not sure whethre its 30 or 60)

depending on what is the value of federation client , the collective setting can be suggested to the customer



[~accountid:61409dc154762c006932ffc7] there is no need to tell customer about federation idle connection timeout, until we have a confirmation.



since update is already posted into the case. I will just wait for Bhavan’s confirmation around federation client idle timeout","25/May/23 9:22 AM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] like I said in my previous comment, the closest thing to idle timeout for the dscclient.properties file is {{sms.broadcastWaitTime}} which defaults to 60.

Currently there is no option to alter this value. So if the 503 issues mentioned originally are no longer occuring, it may not be necessary to bump up the DSC server connection-idle-timeout to be 60 or more.","25/May/23 4:03 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

Customer has an intention to promote connection-idle-timeout into prod (the value they are targeting is 31)

I don’t think they are doing any value check whether 61 works in pre prod testing. (as their 31 value worked fine in pre prod)

503 is observed from reverse proxy.



We are not sure what is the federation behavior .

if they need to set connection-idle-timeout to accomodate both webseal and federation runtime then now would be the time to tell them what the value would be .  otherwise, we ask them or not. they are going to alter connection-idle-timeout



** I just want to tell them a value which should take account all the clients, including federation and webseal ( at this point we only have accommodated reverse proxy idle timeout)","25/May/23 5:50 PM;5b15d954b0d76456f36daf33;_>> I just want to tell them a value which should take account all the clients, including federation and webseal ( at this point we only have accommodated reverse proxy idle timeout)_

Have you got any test case to prove that the federation runtime as a client is suffering from the same issue as webseal was? 

If you have one and see a 503:

* Turn on {{com.tivoli.am.sms.client.*=ALL}} trace. That will log all this information:

{noformat}		""--- start of configuration data ---""
		""replica name:""
		""broadcast wait time:""
		""obsolete key age:""
		""max proxy pool size:""
		""WSDL location:""
		""sms url:""
		""--- end of configuration data ---""{noformat}

* The default value for wait time is 60 seconds. So bump the DSC server value to be 60 or above. And rerun your test. If that doesn’t address the 503, we are out of options.","25/May/23 7:14 PM;5c53d3ac23f5bf672621c868;HI



Not my setup doesn’t how any 503 with federation.",25/May/23 7:14 PM;5c53d3ac23f5bf672621c868;for now  I will just let the customer continue to test with 31 seconds setting. ,30/May/23 12:52 PM;5b15d954b0d76456f36daf33;[~accountid:5b17571a82e05b22cc7d5d9e] are we done with this? Is there anything else you need from me?,30/May/23 12:59 PM;5b17571a82e05b22cc7d5d9e;[~accountid:5b15d954b0d76456f36daf33] thanks for your help with this issue..should be fine to close it for now. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
PostgreSQL v14 database questions,ISAMSUP-5089,301329,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Cesar Mendoza,62fd292b88b05653fa7d4647,Cesar Mendoza,62fd292b88b05653fa7d4647,23/May/23 1:18 AM,08/Jun/23 1:43 AM,14/Jul/23 2:47 PM,08/Jun/23 1:43 AM,,Support,,0,,,,"Customer using PostgreSQL v14 with ISAM 10.0.4 had a connection issue:

error in management_ui/trace.log: 

1055 [5/18/23, 9:47:22:866 EDT] 0000303a id=00000000 ClusterConfigurationServlet E validateDBConnection Exception received while establishing DB conection:org.postgresql.util.PSQLException: The authentication type 10 is not supported. Check that you have configured the pg_hba.conf file to include the client's IP address or subnet, and that it is using an authentication scheme supported by the driver.


This was fixed by changing: scram-sha-256 under Column Method to “trust” on the *_pg_hba.conf_* File in the *_Directory C:\Program Files\PostgreSQL\13\data\pg_hba.conf_*


Our clarity report show support for PostgreSQL 12 only.

[https://www.ibm.com/software/reports/compatibility/clarity-reports/report/html/prereqsForProduct?deliverableId=D63A9170733B11ECA7E0DAE5C409CFAA&osPlatforms=&duComponentIds=S003%7CS002%7CA001%7CC004&mandatoryCapIds=9%7C35%7C25%7C26&optionalCapIds=341%7C12%7C27|https://www.ibm.com/software/reports/compatibility/clarity-reports/report/html/prereqsForProduct?deliverableId=D63A9170733B11ECA7E0DAE5C409CFAA&osPlatforms=&duComponentIds=S003%7CS002%7CA001%7CC004&mandatoryCapIds=9%7C35%7C25%7C26&optionalCapIds=341%7C12%7C27|smart-link] 



Also I recommended the customer to open a request to get the newer versions supported, as version 12 goes out of support in a year and half, see below:

[https://www.postgresql.org/support/versioning/|https://www.postgresql.org/support/versioning/|smart-link] 


However now the customer has 3 questions:

# Does ISAM support scram-sha-256 as an authentication method (it was introduced in PostgreSQL 10)?2.
# Is PostgreSQL compatibility for post-v12 in the current roadmap and if so, when is the targeted release?

# Is it really considered an enhancement to have the product maintain its compatibility for supported external database systems?  If the product is dropping PostgreSQL support, I would expect that would be announced well before the PostgreSQL EOL.  I can certainly submit an enhancement request, but if it's already planned that seems unnecessary.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24/May/23 1:58 AM;whannon;image-20230523-155524.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202108,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013061709,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Cesar Mendoza,62fd292b88b05653fa7d4647,,,,BLUE CROSS AND BLUE SHIELD OF MASSACHUSETTS INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bs5b:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-23 14:27:40.125,,,,,"24/May/23 12:27 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] can you please review this one. My comments following -

1). Does ISAM support scram-sha-256 as an authentication method (it was introduced in PostgreSQL 10)?

*ANS* - [~accountid:5b17571b91981f4fdde632c1] can you please investigate this one an confirm for the customer. You may need to recreate this deployment to confirm the scram-sha-256 support. 

2). Is PostgreSQL compatibility for post-v12 in the current roadmap and if so, when is the targeted release?

*ANS* - We are currently assessing as part of the 4Q2023 delivery plan the support for Postgresql v15. 

3). Is it really considered an enhancement to have the product maintain its compatibility for supported external database systems?  If the product is dropping PostgreSQL support, I would expect that would be announced well before the PostgreSQL EOL.  I can certainly submit an enhancement request, but if it's already planned that seems unnecessary.

*ANS* - Yes, we traditionally ask that an RFE/Idea to support new DB as it requires a full development cycle to certify and validate the specified DB. In this case if the customer is OK with our current roadmap to support Postgresql in the future then they do not need to necessarily create another idea. ","24/May/23 1:27 AM;62fd292b88b05653fa7d4647;Sounds good [~accountid:5ac57757d9a96536d1f0daa9] , let me provide what you provided right now and wait for William to answer the first question. ","24/May/23 1:54 AM;5b17571b91981f4fdde632c1;* [https://www.ibm.com/software/reports/compatibility/clarity-reports/report/html/softwareReqsForProduct?deliverableId=D63A9170733B11ECA7E0DAE5C409CFAA&osPlatforms=&duComponentIds=S003%7CS002%7CA001%7CC004&mandatoryCapIds=9%7C35%7C25%7C26&optionalCapIds=341%7C12%7C27#!|https://www.ibm.com/software/reports/compatibility/clarity-reports/report/html/softwareReqsForProduct?deliverableId=D63A9170733B11ECA7E0DAE5C409CFAA&osPlatforms=&duComponentIds=S003%7CS002%7CA001%7CC004&mandatoryCapIds=9%7C35%7C25%7C26&optionalCapIds=341%7C12%7C27#!|smart-link] 
** Future Versions, Releases not support
*** !image-20230523-155524.png|width=2002,height=1344!

** Cannot comment on workaround
*** Suggest they contact Postgres Support to ask the implications of
**** ISVA 10.0.4.0 Postgres 12.9 client
**** Their version of the Postgres
***** For that server configuration option
****** Impacts
****** Alternatives",24/May/23 2:01 AM;62fd292b88b05653fa7d4647;[~accountid:5b17571b91981f4fdde632c1] Is that for the scram-sha-256 question the customer has?,24/May/23 2:01 AM;5b17571b91981f4fdde632c1;Yes,"24/May/23 2:02 AM;62fd292b88b05653fa7d4647;We already know there is no support noted on the guides for PostgreSQL 14, only for v12.","24/May/23 2:03 AM;5b17571b91981f4fdde632c1;* Reviewed my comments with Nick Lloyd and he agrees
** [~accountid:5b15d9e6dda5f94d06b985b4] ","24/May/23 2:04 AM;62fd292b88b05653fa7d4647;Awesome, let me share that with the customer, thanks to both for the help!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Memory leak after upgrade to 10.0.5_IF1,ISAMSUP-5088,301320,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,23/May/23 12:45 AM,27/Jun/23 11:25 AM,14/Jul/23 2:47 PM,,,,,0,Growth,,,"Customer observed a memory leak after upgrade from 9.0.7.2_IF3 to ISVA 10.0.5_IF1 on there two ISVA Policy clustered appliance (primary and secondary master).

No reverse proxy instances are present on these nodes.

On these appliance they are configured and they are using DSC and Federation services.

They also configured two external oracle databases for HVDB and Config.

The memory leak occurs on both ISVA nodes.

To reduce memory consumption they tried to restart runtime first and then policy manager but without significant result. So to restore normal memory values they had to reboot the entire appliances.

They provided support file from primary master.

This issue is occurring in staging environment and is blocking our urgent upgrade scheduled in production environment



After checking the cpu.txt the Java run time having highest memory consumption and requested the core file.

{noformat}PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND

1830     1 www-data S    7138m 89.5   3  0.0 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy

1155     1 www-data S    5030m 63.1   3  0.0 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=false -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.aut{noformat}



Customer shared the core file and support file in the below ecurep

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013070645&path=TS013070645%2F2023-05-22%2F&filepath=TS013070645%2F2023-05-22%2Fisva_10.0.5.0_20230522-152439_isam-intra-t-pol-01.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013070645&path=TS013070645%2F2023-05-22%2F&filepath=TS013070645%2F2023-05-22%2Fisva_10.0.5.0_20230522-152439_isam-intra-t-pol-01.support]",,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5130,,,,,,27/Jun/23 11:25 AM;tonyferg;image-20230627-012325.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208534,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013070645,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,BPER BANCA SPA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bs3b:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-22 22:14:13.978,,,,,23/May/23 8:14 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] adding this Jira item to your backlog as I suspect that this might be related to the current memory issues that some of our other customers are reporting. Can you please confirm if you agree with this and link in the other primary Jira item.,26/May/23 12:40 PM;5b232b2fd85e5b59b066f57f;[~accountid:627a7fb30d1e73006f7c21cf] - do you know if this customer has any EC crypto operations occurring in their runtime? REF: [https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|smart-link] ,"30/May/23 5:26 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

Customer mentioned:

“At the moment we are using just one STS chain where the jwt content is encrypted with a symmetric key and A256GCM algorithm!”","12/Jun/23 12:31 PM;5b232b2fd85e5b59b066f57f;[~accountid:627a7fb30d1e73006f7c21cf] - there is a known leak in the Java version that ships with 10.0.5. We have just fixed this and made a fix-pack available for 10.0.5 - [https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|smart-link] . It is unclear whether this customer is hitting this problem, however, if they can apply the fix-pack it will allow us to isolate whether this is the same issue or something new. Can they apply this in their environment and let us know whether there is an improvement? If they are still seeing an issue, we will need a support file from immediately after applying the fix-pack / restarting the appliance and also another support file after some time once growth has occurred. Thanks. ","27/Jun/23 1:37 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

After appling the fix pack seamer_j9_11_19_7_upgrade_fix.fixpack



They checked the memory trend in 10 days of using the fix. They continue to see growth in memory usage so, for now, they cannot plan upgrade in Production env where the workload in terms of user authentications is definitely higher

They attached two support files (one from Thursday 22 June and one from today 25 June) and the image of the memory trend recovered today.



[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013070645&path=TS013070645%2F2023-06-26%2F&filepath=TS013070645%2F2023-06-26%2Fisva_10.0.5.0_20230626-095427_isam-intra-t-pol-01.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013070645&path=TS013070645%2F2023-06-26%2F&filepath=TS013070645%2F2023-06-26%2Fisva_10.0.5.0_20230626-095427_isam-intra-t-pol-01.support]","27/Jun/23 11:25 AM;5ac57757d9a96536d1f0daa9;[~accountid:627a7fb30d1e73006f7c21cf] we have reviewed the customers image and can see that there seems to be improvements on the memory growth since the fix pack was provided - 

!image-20230627-012325.png|width=1566,height=713!

As we can see the customers current memory has not exceeded 30% since the fix pack was applied. Can you please assist the customer to continue to monitor this and advise if they see the growth continue in the coming weeks.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA Liberty is stopping instead of restarting.,ISAMSUP-5087,301316,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Gabe,5b15d99b4c20165700edecad,Gabe,5b15d99b4c20165700edecad,23/May/23 12:16 AM,26/Jun/23 10:23 AM,14/Jul/23 2:47 PM,26/Jun/23 10:23 AM,,,,0,,,,"BMO made configuration changes on their AAC/Fed Runtime then deployed the changed. They later realized the Runtime was stopped and didn’t restart after the changed were deployed. 

It appears the Runtimes attempted to restart after the update but due to the threads taking longer than the timeout to stop it shutdown completely instead of restarting. 

/ecurep/sf/TS013/012/TS013012511/2023-05-13/isva_10.0.3.1_20230512-234952_isamscclprmga07.srv.bmogc.net_1_.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/messages_23.05.12_22.28.14.0.log


[5/12/23, 21:42:29:099 EDT] 00263f60 com.ibm.ws.runtime.update.internal.RuntimeUpdateManagerImpl A CWWKE1100I: *Waiting for up to 30 seconds* for the server to quiesce.

[5/12/23, 21:42:59:103 EDT] 00263f60 com.ibm.ws.runtime.update.internal.RuntimeUpdateManagerImpl W CWWKE1102W: The quiesce operation did not complete. The server will now stop.

This wait is controlled by the stopTimeout Liberty parameter which is 30s by default.
[https://www.ibm.com/support/pages/liberty-server-19002-wont-stop|https://www.ibm.com/support/pages/liberty-server-19002-wont-stop]



Do you think this is something we can tweek via a ATP? The obvious fix would be to check the Runtime status and start it if it didn’t restart but they are saying this caused an outage. ",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013012511,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Gabe,5b15d99b4c20165700edecad,,,,BANK OF MONTREAL,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bs13:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-05-22 22:12:33.256,,,,,23/May/23 8:12 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please complete the initial assessment of this Jira item. ,"23/May/23 11:05 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d99b4c20165700edecad] 

We don't have any ATP to configure the stop start timeout configs for runtime.



The only liberty config from the applicationManager we have is -

{noformat}<!-- Automatically expand WAR files and EAR files -->
    <applicationManager autoExpand=""true""/>{noformat}

We don't have stopTimeout or startTimeout.",05/Jun/23 9:50 PM;5b15d99b4c20165700edecad;There is nothing we can do to ensure the services stop properly correct?,"07/Jun/23 6:15 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d99b4c20165700edecad] 

I could add this parameter to server.xml by adding this advanced tuning parameter - 

{noformat}Name: runtime_profile.liberty_option.applicationManager.stopTimeout
Value : 60{noformat}

But I haven't been able to test successfully since I cant get it to hang for stop. 
Tried setting it to a low value like 1/2sec but seems like 30 is default.

If you or customer can test this case, let me know.

Thanks





<Mynotes>

{noformat}Jun  7 18:18:09 su: + none root:www-data
Jun  7 18:18:09 mesa_config[12435]: Debug: /usr/bin/su -c /opt/IBM/wlp/bin/server status runtime -s /bin/sh www-data
Jun  7 18:18:09 su: + none root:www-data
Jun  7 18:18:11 mesa_config[12435]: Debug: /usr/bin/su -c /opt/IBM/wlp/bin/server stop runtime -s /bin/sh www-data
Jun  7 18:18:11 mesa_config[12435]: WGAWA0308I   The server has been stopped.{noformat}","08/Jun/23 3:24 AM;5b15d99b4c20165700edecad;[~accountid:5af4ad7d4dd24c579110120b] Would it be okay if I made a tech note about the ATP “{{runtime_profile.liberty_option}}""?  It seems like we could use this to set any Liberty properties. ",08/Jun/23 6:55 AM;5af4ad7d4dd24c579110120b;yes [~accountid:5b15d99b4c20165700edecad] ,"26/Jun/23 10:23 AM;5af4ad7d4dd24c579110120b;Closing this item as answered, please reopen if you have further questions.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
support for reCAPTCHA Enterprise edition,ISAMSUP-5085,300805,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Virag Patel,5b17571a82e05b22cc7d5d9e,Virag Patel,5b17571a82e05b22cc7d5d9e,19/May/23 4:35 PM,22/May/23 5:22 PM,14/Jul/23 2:47 PM,22/May/23 12:34 PM,,Support,,0,,,,"customer would like to confirm if ISVA supports reCAPTCHA Enterprise edition

the product guide says:

[https://www.ibm.com/docs/en/sva/10.0.3?topic=authentication-configuring-recaptcha-verification-mechanism|https://www.ibm.com/docs/en/sva/10.0.3?topic=authentication-configuring-recaptcha-verification-mechanism|smart-link] 

The appliance supports only Google reCAPTCHA V2.

However the default Google reCAPTCHA V2 is free and customer would like to use Enterprise edition for same purpose from google.

here you can see difference between two:

[https://cloud.google.com/recaptcha-enterprise/docs/compare-versions|https://cloud.google.com/recaptcha-enterprise/docs/compare-versions|smart-link] 

customer intends to use ISVA v10.0.2

if possible, pls discuss with dev team if needed as this banking customer wants to use enterprise licensing for more security checks.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013061268,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Virag Patel,5b17571a82e05b22cc7d5d9e,,,,INDUS IND BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1boy7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-05-22 00:17:59.876,,,,,22/May/23 10:17 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571a82e05b22cc7d5d9e] I think that this falls under the requirement and thus we should create a RFE/Ideas to have this assessed by the ISVA leadership team.,"22/May/23 11:38 AM;5b17571a82e05b22cc7d5d9e;Agree.. for now, i just need confirmation whether we suport it or not currently ",22/May/23 5:22 PM;5b17571a82e05b22cc7d5d9e;[~accountid:5b232b2fd85e5b59b066f57f] status is changed to done. does it mean currently we don’t support it? customer has specifically asked me to get this confirmation.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unable to remove client_id,ISAMSUP-5083,300719,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,19/May/23 1:07 AM,03/Jul/23 7:47 PM,14/Jul/23 2:47 PM,,,Support,,0,,,,"Hi Team,

The customer has an issue they get this error when we try to remove a client_id in production. They are trying to delete a client id that has a lot of active grants which is why it's failing with an error


[1/25/23, 8:38:22:564 CET] 00001b9f com.ibm.security.access.management.rest.PendingChanges I com.tivoli.am.rba.exception.RBADBException: ORA-01795: maximum number of expressions in a list is 1000

{{Caused by: Error : 1795, Position : 0, Sql = DELETE FROM OAUTH20_TOKEN_EXTRA_ATTRIBUTE WHERE STATE_ID IN ( 'uuida1dd1e85-*',.....more than 1000 entries, ,'uuida6a92e' ), Error Msg = ORA-01795: maximum number of expressions in a list is 1000}}

There is a similar Jira which is already open for different version 
[https://cloudidentity.atlassian.net/browse/ISAMSUP-4421|https://cloudidentity.atlassian.net/browse/ISAMSUP-4421|smart-link] 

!Screenshot 2023-05-18 at 16.04.40.png|width=818,height=481!",,BRIANORO,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,scottand,Surya Prakash,Tushar Prasad,,,,,,,6154906364ff01007106e189,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5b0321d4eb3ffa0c596661aa,60f541a6d0134900692d91b7,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,19/May/23 1:07 AM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-05-18 at 16.04.40.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/201383,,,,,,,,,,,,,,,IJ47225,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011938759,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,SKANDINAVISKA ENSKILDA BANKEN AB (PUBL),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,AIX,Linux 86_64,Windows Server 20xx,,,,,,,,,,,,0|i1bof3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-18 20:13:15.27,,,,,19/May/23 6:13 AM;5b15d94b6256d01ad54eb020;That is an issue that I’ve been looking into in that other Jira.,"20/May/23 12:57 AM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d94b6256d01ad54eb020] yes it's the same issue and [~accountid:5b15d950d9936c61022057fe]pointed to me you were working on that Jira, please let me know if you need any further information","22/May/23 6:44 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d94b6256d01ad54eb020] The client has escalated this issue, please let me know any update for this issue?","23/May/23 12:03 AM;5b15d94b6256d01ad54eb020;I’m working on a code fix for a similar  issue but it is not done yet.  I just checked on ecurep and don’t see a support file.  We should always have a support file with runtime  tracing for issues like this.  I need to confirm if this is the  same issue as the other one I’m working on. to know if my changes will help or not.

I also need to know the exact steps they used that caused this problem.","23/May/23 6:31 PM;60f541a6d0134900692d91b7;Yes [~accountid:5b15d94b6256d01ad54eb020] I requested the client to share the support file and traces but they are reluctant to share, they say have sensitive customer information and don't want to send it.
I will request them again 😞 ",23/May/23 11:47 PM;5b15d94b6256d01ad54eb020;[~accountid:60f541a6d0134900692d91b7] it’s okay with me if they scrub the file of anything  sensitive. Or they can put it on blue diamond (i dont’t know the external name for that.).  Another options is  for them to only send in the trace file. I’m looking for a stack trace showing the failure.,13/Jun/23 10:47 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020] just a quick heads up that I have had the customer advocate reach out to me and ask for additional focus on this item. Can you please work with [~accountid:60f541a6d0134900692d91b7] and the L2 team to work out how we can move this item forwards during your day ahead. Appreicate the support and the extra focus on this item. ,"13/Jun/23 11:59 PM;5b15d94b6256d01ad54eb020;[~accountid:5ac57757d9a96536d1f0daa9]  I’m waiting on a support file from L2 .  I’m also waiting on dev comments for the sub-task  [https://cloudidentity.atlassian.net/browse/ISAMSUP-5084|https://cloudidentity.atlassian.net/browse/ISAMSUP-5084|smart-link]  where I made the code changes.

[~accountid:60f541a6d0134900692d91b7] have you had any luck collecting a support file?","14/Jun/23 3:54 AM;5b15d94b6256d01ad54eb020;If the customer has a test environment where they have recreated this and are willing to test the code change, I can provide a fix pack. I don’t have a database to this on, nor enough data.","14/Jun/23 9:14 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d94b6256d01ad54eb020] I have just requested the support file again, just waiting for them to share.","14/Jun/23 11:25 PM;5b15d94b6256d01ad54eb020;[~accountid:627a7fb30d1e73006f7c21cf]  it’s okay if they remove any data items that appear sensitive.  Or they can upload it to blue diamond,","15/Jun/23 10:01 PM;5b0321d4eb3ffa0c596661aa;{color:#bf2600}*Internal only*{color}
{color:#bf2600}*================*{color}


G’Day [~accountid:5b15d94b6256d01ad54eb020] thanks for the updates in the ticket.
I met with SEB this evening.  

To frame the conversation I read out your Jira comments which were very helpful (thanks a bunch): 

{quote}it’s okay with me if they scrub the file of anything sensitive. Or they can put it on blue diamond (i dont’t know the external name for that.). Another options is for them to only send in the trace file. I’m looking for a stack trace showing the failure.{quote}

and

{quote}If the customer has a test environment where they have recreated this and are willing to test the code change, I can provide a fix pack. <snip>I didn’t read the rest of the Jira comment</snip>{quote}

I further explained 

{quote}“The engineer wants to ensure the error you (SEB) are seeing in the trace is resolved by the update made.  
Without the trace or stack from your (SEB) environment without your (SEB) middleware combination it’s exceptionally difficult to ensure any update resolves the issue you’re (SEB) experiencing and they want to ensure they are providing a fixpack that addresses your issue.”{quote}

I also advised an APAR had been opened. I *didn’t* expose the other similar case.



SEB understands the Salesforce ticket is their communication mechanism and as always they’ll continue to leverage that.  

I did let them know I’d be sharing the outcomes of the meeting with “the engineer” (you!) in the backend system (this Jira comment).



They were appreciative of IBMs (your) efforts with me just the man in the middle.



The agreed outcomes with SEB were 

# SEB would like to proceed with a Hot fix.  
Mikael is taking leave at the end of this week for 3 weeks if I understood correctly.  It sounded like a number of Nordic folks take leave around this time, however any progress we can add to their Salesforce ticket in the immediate short term would be well received.
# I provided the link for Blue Diamond and briefly described its use and where I’d experienced it previous with HIPAA, etc.  
Mikael will discuss internally to gain approval/agreement to use for future cases and he’d already clicked the link and tried signing in/registering on the call.
# Mikael agreed to re-produce the 1000+ grants in the SEB non-pod environment to capture the stack trace against their middleware combination.  
Even though we (IBM/ISVA) should be able to reproduce the error ourselves he agreed the middleware combo was important.  Mikael needs to get another Oracle instance to configure against, then generate the 1000+ client ids and generate the stack to add to the ticket.
# Mikael agreed to provide the before (step 3) and after once fix pack is applied.
Their expectation is the fix pack essentially is production ready, assuming it resolves the error observed.","27/Jun/23 7:47 AM;5b15d94b6256d01ad54eb020;I usually try to confirm the issue is the same unless it is obvious.  I’m not 100 percent convinced on this one but it does look the same issue based on what information I have.    Since this seems like a lot of trouble for them,  if they have a test environment where they have recreated the issue,  then as an alternative i I can give them a fix pack to test themselves.   Since this does look like same issue we’ve seen before, if the fix pack works then that  will help prove that it is the same problem.  I should have the  fix pack ready in a couple of days.

*Internal comment:*

I finally got some feedback form development that  I had been waiting on before I completed the coding.  So I’m trying to move forward with fix packs for this issue.  I don’t have an Oracle db so I can’t test it.  If the client wants to test it, I’m fine with that.  It would be nice if someone in L2 could test it first.  I don’t know who has an Oracle DB.",30/Jun/23 1:27 AM;5b15d94b6256d01ad54eb020;[~accountid:60f541a6d0134900692d91b7] I’m working on fix packs for this issue.  Are they still on 10.0.4.0?  Any plans to update?,"01/Jul/23 7:35 AM;5b15d94b6256d01ad54eb020;[~accountid:60f541a6d0134900692d91b7] you can find the fix pack below.  Please at least test it to be sure there are no installation issues.

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5200|https://cloudidentity.atlassian.net/browse/ISAMSUP-5200|smart-link] ","03/Jul/23 7:21 PM;60f541a6d0134900692d91b7;[~accountid:5b15d94b6256d01ad54eb020] Thanks for the fixpack, Yes I will test the installation issue in my VM but I do not have an Oracle DB to test it 😞 ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
 IBM Verify app stuck on transaction approval,ISAMSUP-5080,300402,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Carsten Hagemann,5af4ad7f39d04955d9e20da6,Aaron.Richie.Dias,6194c472fe9f300068e5252f,Aaron.Richie.Dias,6194c472fe9f300068e5252f,18/May/23 2:10 AM,14/Jul/23 12:45 PM,14/Jul/23 2:47 PM,,,,,0,verifyapp,,,"we have configured a 2FA with the IBM verify app.
The flow works with some phones but won't work with others.

When the user gets the push notification to approve the transaction the app gets stuck and does nothing.

It doesn't seems related to the user account.
My account, which works with my phone, won't work from some devices.
Another account stuck on some devices works on others.



Phones used:

PHONE A - Iphone X - IOS 16.4.1 - IBM Verify APP version 2.5.2 (4) SDK 2.1.5(2)

PHONE B - Samsung Galaxy A 32 5G - Android 13 Kernel 4.14.186-25943992 - IBM Verify App version 2.5.10 (107) SDK 2.1.7



And 2 users:



User A

User B



Both user's login won't work on PHONE B

Both user's login work on PHONE A



This is a new configuration, it has never worked before.



I've also inspected pdweb.debug and snoop and saw no difference when its working vs when its not.



It could be helpful to enable logs on the phone and see what happens on the app.

Customer has let us know If you want we can provide you a test user to perform tests in the customer environment.



Let me know if you need other infos.



logs: [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012815955&path=TS012815955%2F2023-04-21%2Fisva_10.0.4.0_20230421-164447_n0611008.gruppo.autostrade.it.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012815955&path=TS012815955%2F2023-04-21%2Fisva_10.0.4.0_20230421-164447_n0611008.gruppo.autostrade.it.support_unpack%2F]",,BRIANORO,,,,,,,,,,,,,,,6154906364ff01007106e189,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CI-123976,,,,23/Jun/23 11:48 AM;chageman;pts.json;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208089,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012815955,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Aaron.Richie.Dias,6194c472fe9f300068e5252f,,,,AUTOSTRADE PER L'ITALIA S DIREZIONE GENERALE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bmiv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-22 00:33:27.843,,,,,22/May/23 10:33 AM;5b232b2fd85e5b59b066f57f;[~accountid:5af4ad7f39d04955d9e20da6] - would you mind running your eyes over this one? Thanks. ,"22/May/23 3:38 PM;5af4ad7f39d04955d9e20da6;[~accountid:5b232b2fd85e5b59b066f57f] 

This usually happens when the access token can not be decrypted when loaded from the DB.

Token encryption at rest is only implemented for the Android version (iOS relies on the fact that the phone can not be jail-broken - at least not as easy as an Android phone). That's why this problem only occurs on Android devices.

Whilst frustrating for the user, the occurrence of these events is very random and therefore difficult to reproduce and to debug. We have implemented some safety nets to reduce the frequency of this problem, but haven't achieved a 100% reliable solution. I would be happy to work with a test user from the customer to identify additional gaps. Please make sure that that person is able to perfom some non-trivial tasks (e.g. extract log files from the phone) and is aware that this will be a timely and cumbersome process.",22/May/23 3:40 PM;5b232b2fd85e5b59b066f57f;[~accountid:6194c472fe9f300068e5252f] - can you co-ord with the customer to work with Carsten as suggested? ,"22/May/23 9:00 PM;6194c472fe9f300068e5252f;thanks for the update, David and Carsten. I will check with the customer and get back to you","23/May/23 11:29 PM;6194c472fe9f300068e5252f;[~accountid:5af4ad7f39d04955d9e20da6] customer said they have a test user for the tests, below is their response:

=========================

We have a test user which is available may 24th and 25th and then from june 15th.



Let me know if you want to perform some tests and how you want to arrange them.



Thank you.

Sacha

=======================","24/May/23 9:48 PM;6194c472fe9f300068e5252f;[~accountid:5af4ad7f39d04955d9e20da6] customer has provided additional details to perform the test for us:

=======================================



Hi, by the way you can easily do some testing on your own with this credentials:



user: testappuser

password: AUTS163-Autos



enrollment link:



[https://dmztst.autostrade.it/mga/sps/mmfa/user/mgmt/html/mmfa/usc/manage.html|https://dmztst.autostrade.it/mga/sps/mmfa/user/mgmt/html/mmfa/usc/manage.html|smart-link] 



MMFA protected junction:

[https://dmztst.autostrade.it/TEST|https://dmztst.autostrade.it/TEST|smart-link] 



This way you don't need to wait and synchronize with us to perform the tests.



Please let me know if you need any support.

=================================================",25/May/23 9:07 AM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] That is very helpful - thanks! Please be aware that I won’t be able to work on this before the end of next week.,"13/Jun/23 5:53 PM;6194c472fe9f300068e5252f;Hello, [~accountid:5af4ad7f39d04955d9e20da6] have you had a chance to review this? please let me know if you have any updates or queries you have for the customer. ","20/Jun/23 8:18 PM;6194c472fe9f300068e5252f;Hello [~accountid:5af4ad7f39d04955d9e20da6], customer checking in to see if we have an update on this. ","23/Jun/23 11:41 AM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] 

-I could reproduce the issue on the test account.- I’m stuck at an earlier point with the testing.

From what I can see is, that pending transactions do not marked as “EXPIRED” (or whatever that value is in ISVA) after same time, so there is a list of currently 10 pending transactions, the oldest one from {{2023-04-27T12:31:30.401834Z}} ({{""transactionId"":""a571f753-3317-4004-97ab-46e26941cdda""}}).

The app pulls that list and starts to process the first PT in the list. Part of that process is to check whether the {{authenticatorId}} of that transaction matches the current {{authenticatorId}} of the app, which is unique per installation. Because my {{authenticatorId}} is different to the one that was valid when the PT was created, the app stops processing the PTs.

 At this stage, I would like to ask the customer to:

* empty the list of PTs for that account and
* configure a timeout when PTs get marked as “EXPIRED” (so, they get removed from the list after e.g. 60 seconds)

There could be another underlying reason for the reported problem, but at this stage, that will help me to get over that step.","23/Jun/23 11:48 AM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] Here is the payload with the PTs listed.

[^pts.json]

",26/Jun/23 10:09 PM;6194c472fe9f300068e5252f;provided the update to the customer and will get back once the customer responds. ,"27/Jun/23 10:33 PM;6194c472fe9f300068e5252f;[~accountid:5af4ad7f39d04955d9e20da6] customer requesting for the steps to perform these steps:

* empty the list of PTs for that account and
* configure a timeout when PTs get marked as “EXPIRED” (so, they get removed from the list after e.g. 60 seconds)

could you please help me with how to empty the PT list and how to set a timeout?, so I can pass it on to the customer? ","27/Jun/23 10:41 PM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] Unfortunately, I can’t. That is an ISVA configuration task, where I have no clue about it. If you can’t find someone in your team, who can help you with that, please reach out to the #verify-access channel ([https://ibm-security.slack.com/archives/C307GJRN1|https://ibm-security.slack.com/archives/C307GJRN1|smart-link] ).","05/Jul/23 1:00 AM;6194c472fe9f300068e5252f;[~accountid:5af4ad7f39d04955d9e20da6] I discussed this with my team and was advised this might be the best setting to change and I requested the customer to change this to 60:



{noformat}mmfa.transactionPending.minAgeBeforeAbort
The minimum number of seconds a transaction is in the pending state before being aborted via a cleanup thread. Due to the cleanup thread interval, the total time a transaction can be in the pending state can be between minAgeBeforeAbort and (minAgeBeforeAbort + cleanupInterval) - 1

The default value is 300.

Data type: Integer

Example: 300{noformat}



[https://www.ibm.com/docs/en/sva/10.0.4?topic=configuration-advanced-properties|https://www.ibm.com/docs/en/sva/10.0.4?topic=configuration-advanced-properties|smart-link] 



What logs would you require once the customer makes these changes? ",06/Jul/23 9:51 AM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] Please let me know when the changes have been deployed and I will then continue with the investigation from my end. No logs from the customer required at this stage.,10/Jul/23 10:36 PM;6194c472fe9f300068e5252f;[~accountid:5af4ad7f39d04955d9e20da6] customer said they have let the Android user perform the test and are getting the same error.,14/Jul/23 12:45 PM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] I will have a look…,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Federation issues handling danish special chars (æøå) in certificates,ISAMSUP-5079,300030,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,17/May/23 6:30 PM,27/Jun/23 4:09 PM,14/Jul/23 2:47 PM,,,,,0,,,,"When ISVA delivers below certificate information in a SAML response (X509 subject issuer details: True): CN=Arbejdsmarkedets Tillægspension - ATP KUP IdP Prod,O=Arbejdsmarkedets Tillægspension // CVR:43405810 it is sent as: CN=Arbejdsmarkedets Till\c3\a6gspension - ATP KUP IdP Prod,O=Arbejdsmarkedets Till\c3\a6gspension // CVR:43405810 This makes it fails on recipient side because recipient checks for: CN=Arbejdsmarkedets Tillægspension - ATP KUP IdP Prod,O=Arbejdsmarkedets Tillægspension // CVR:43405810 How can we make ISVA send the danish special chars? 



[TS012841674 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012841674&path=TS012841674%2F2023-05-17%2Fisva_10.0.5.0_20230517-084845_ATP-00DSAM02.support_unpack%2F]
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012841674,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,ATP,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bk8v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-22 02:00:44.317,,,,,17/May/23 6:31 PM;617a5f2cf485cd0068cb98af;L3 need to advise,"22/May/23 12:00 PM;5b232b2fd85e5b59b066f57f;[~accountid:617a5f2cf485cd0068cb98af] - INTERNAL SUPPORT ONLY: as per [https://www.ibm.com/docs/en/sva/10.0.4?topic=overview-language-support|https://www.ibm.com/docs/en/sva/10.0.4?topic=overview-language-support|smart-link] , the Danish language is not supported; however, this looks like it may be a character encoding issue - investigating. ","22/May/23 3:36 PM;5b232b2fd85e5b59b066f57f;“\c3\a6” is the UTF-8 hexidecimal representation of æ. I can’t see anywhere in the trace provided by the customer where the encoding/decoding to “\c3\a6” occurs. [~accountid:617a5f2cf485cd0068cb98af] - have you found this in the trace? 

Is the Service Provider also an ISVA instance or is it a third party product? ",23/May/23 12:10 PM;5b232b2fd85e5b59b066f57f;For my reference KessServiceJksWorkerImpl.java:processKeyInfo(…) - x5data,27/Jun/23 4:09 PM;5ac57757d9a96536d1f0daa9;[~accountid:617a5f2cf485cd0068cb98af] can you please provide an updated to Daves question from back on the 22nd of May?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Customer reports ISAMSUP-4432/IJ42490 does not appear to be fixed in 10.0.5,ISAMSUP-5075,299670,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,16/May/23 1:46 AM,07/Jul/23 3:34 AM,13/Jul/23 8:41 AM,,,,,0,,,,"[~accountid:5af4ad7d4dd24c579110120b] 

When I look at the PAC being returned I see two AZN_CRED_GROUP_REGISTRY_IDS two AZN_CRED_GROUPS and one AZN_CRED_GROUP_UUIDS

2023-05-11/isva_10.0.5.0_20230511-135816_nsc-dev-pol-mgt-040.ba.ssa.gov.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/trace_23.05.11_13.55.08.0.log

[5/11/23, 13:53:51:119 EDT] 00002811 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac building pac, setting principal name of: Z48Y0Z0C
[5/11/23, 13:53:51:119 EDT] 00002811 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac building pac, adding groups: [Name [EMP]. UUID [3dabe010-67af-11ea-b47f-001a4a4a77fe]., Name [IRS]. UUID [ce9f5a22-faed-11da-bf85-0a2792faaa77]., Name [WAG]. UUID [154534c4-faee-11da-bf85-0a2792faaa77].]



{noformat}[5/11/23, 13:53:51:120 EDT] 00002811 id=00000000 im.authsvc.action.decorator.signintoken.SignInTokenDecorator 3 execute(AuthSvcContextView) SignInToken [<wss:BinarySecurityToken xmlns:wss=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"" EncodingType=""http://ibm.com/2004/01/itfim/base64encode"" ValueType=""http://ibm.com/2004/01/itfim/ivcred"" wsu:Id=""uuidbf2a410-0188-1eda-914c-d70761d1a609"">BAKs3DCCCcAMADCCCbowggm2AgIGADCBozApMB0CBAvypA8CAgGIAgIb3gICAKsCAU4EBtcHYdGmCQwIWjQ4WTBaMEMwdjAkMB0CBD2r4BACAmevAgIR6gICALQCAX8EBgAaSkp3/gwDRU1QMCYwHwIEzp9aIgIDAPrtAgIR2gICAL8CAgCFBAYKJ5L6qncMA0lSUzAmMB8CBBVFNMQCAwD67gICEdoCAgC/AgIAhQQGCieS+qp3DANXQUcCAQEwggkFMIIJATAoDBd0YWd2YWx1ZV9hY3UtbG9naW4tcGF0aDANMAsCAQQMBFJPTUUEADAvDBhBWk5fQ1JFRF9BVVRIX0VQT0NIX1RJTUUwEzARAgEEDAoxNjgzODI3NjE2BAAwMwwcQVpOX0NSRURfTkVUV09SS19BRERSRVNTX0JJTjATMBECAQQMCjB4MGEzYzE3YjUEADBMDBthdXRoZW50aWNhdGlvblRyYW5zYWN0aW9uSWQwLTArAgEEDCRkMmVmYjk2Yy1kOGQwLTRjYzEtODVkNy1hNzIyNDY2NDYwYmQEADAiDBRBVVRIRU5USUNBVElPTl9MRVZFTDAKMAgCAQQMATEEADCBmgwYdGFndmFsdWVfdXNlcl9zZXNzaW9uX2lkMH4wfAIBBAx1YzJWamRYSmxBQT09X1pGMHJvQUFBQUFJQUFBQXdvQ3RkWkVnZEZ4aVVmd0FBTFROQ05EQlBUblpNYVZWS2FGbGlhQ3QxZGtkaVpHRk9iR05PYlVvM1pHOUhaR1JNZUZFM00xWm1aamhqTm5sWTpkZWZhdWx0BAAwMwwUQVpOX0NSRURfQVVUSF9NRVRIT0QwGzAZAgEEDBJleHQtYXV0aC1pbnRlcmZhY2UEADApDBBBWk5fQ1JFRF9NRUNIX0lEMBUwEwIBBAwMSVZfTERBUF9WMy4wBAAwgcIMG0FaTl9DUkVEX0dST1VQX1JFR0lTVFJZX0lEUzCBojA0AgEEDC1jbj1FTVAsb3U9Z3JvdXBzLG91PXNzYSxvPXUucy5nb3Zlcm5tZW50LGM9dXMEADA0AgEEDC1jbj1JUlMsb3U9Z3JvdXBzLG91PXNzYSxvPXUucy5nb3Zlcm5tZW50LGM9dXMEADA0AgEEDC1jbj1XQUcsb3U9Z3JvdXBzLG91PXNzYSxvPXUucy5nb3Zlcm5tZW50LGM9dXMEADBHDBZ0YWd2YWx1ZV9zZXNzaW9uX2luZGV4MC0wKwIBBAwkYTc2OTBlM2MtZjAyNC0xMWVkLWEwODMtMDAxYTRhNGE3N2YwBAAwYQwcYXV0aGVudGljYXRpb25NZWNoYW5pc21UeXBlczBBMD8CAQQMOHVybjppYm06c2VjdXJpdHk6YXV0aGVudGljYXRpb246YXNmOm1lY2hhbmlzbTpyZWNhcHRjaGEzBAAwJgwSQVpOX0NSRURfSVBfRkFNSUxZMBAwDgIBBAwHQUZfSU5FVAQAMC0MEUFaTl9DUkVEX1FPUF9JTkZPMBgwFgIBBAwPU1NLOiBUTFNWMTI6IDlEBAAwSAwXQVpOX0NSRURfUFJJTkNJUEFMX1VVSUQwLTArAgEEDCQzMTcyNWI0My0wMTg1LTE0NjAtYjhmNi1kZTI4N2IwZGVjZGQEADAnDBJBWk5fQ1JFRF9BVVRIWk5fSUQwETAPAgEEDAhaNDhZMFowQwQAMC0MGUFaTl9DUkVEX1BSSU5DSVBBTF9ET01BSU4wEDAOAgEEDAdEZWZhdWx0BAAwXQwUQVpOX0NSRURfUkVHSVNUUllfSUQwRTBDAgEEDDxjbj1aNDhZMFowQyxvdT1idXNpbmVzc3BhcnRuZXJzLG91PXNzYSxvPXUucy5nb3Zlcm5tZW50LGM9dXMEADAsDBdBWk5fQ1JFRF9QUklOQ0lQQUxfTkFNRTARMA8CAQQMCFo0OFkwWjBDBAAwNgwkdGFndmFsdWVfbWF4X2NvbmN1cnJlbnRfd2ViX3Nlc3Npb25zMA4wDAIBBAwFdW5zZXQEADAtDBh0YWd2YWx1ZV9sb2dpbl91c2VyX25hbWUwETAPAgEEDAhaNDhZMFowQwQAMDUMHEFaTl9DUkVEX05FVFdPUktfQUREUkVTU19TVFIwFTATAgEEDAwxMC42MC4yMy4xODEEADA3DA9BWk5fQ1JFRF9HUk9VUFMwJDAKAgEEDANFTVAEADAKAgEEDANJUlMEADAKAgEEDANXQUcEADA5DBVBWk5fQ1VTVE9NX0FUVFJJQlVURVMwIDAeAgEEDBd0YWd2YWx1ZV9hY3UtbG9naW4tcGF0aAQAME4ME2F1dGhlbnRpY2F0aW9uVHlwZXMwNzA1AgEEDC51cm46aWJtOnNlY3VyaXR5OmF1dGhlbnRpY2F0aW9uOmFzZjpyZWNhcHRjaGEzBAAwJwwQQVpOX0NSRURfVkVSU0lPTjATMBECAQQMCjB4MDAwMDEwMDUEADCBkQwVQVpOX0NSRURfQlJPV1NFUl9JTkZPMHgwdgIBBAxvTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzExMi4wLjAuMCBTYWZhcmkvNTM3LjM2BAAwLAwXQVpOX0NSRURfUFJJTkNJUEFMX05BTUUwETAPAgEEDAhaNDhZMFowQwQAMEcMF0FaTl9DUkVEX1BSSU5DSVBBTF9VVUlEMCwwKgIBBAwjYmYyYTQwZi0wMTg4LTFiZGUtYWI0ZS1kNzA3NjFkMWE2MDkEADCBoAwUQVpOX0NSRURfR1JPVVBfVVVJRFMwgYcwKwIBBAwkM2RhYmUwMTAtNjdhZi0xMWVhLWI0N2YtMDAxYTRhNGE3N2ZlBAAwKwIBBAwkY2U5ZjVhMjItZmFlZC0xMWRhLWJmODUtMGEyNzkyZmFhYTc3BAAwKwIBBAwkMTU0NTM0YzQtZmFlZS0xMWRhLWJmODUtMGEyNzkyZmFhYTc3BAAwQwwbQVpOX0NSRURfR1JPVVBfUkVHSVNUUllfSURTMCQwCgIBBAwDRU1QBAAwCgIBBAwDSVJTBAAwCgIBBAwDV0FHBAAwNwwPQVpOX0NSRURfR1JPVVBTMCQwCgIBBAwDRU1QBAAwCgIBBAwDSVJTBAAwCgIBBAwDV0FHBAAwKQwXQVpOX0NSRURfQVVUSE5NRUNIX0lORk8wDjAMAgEEDAVsb2NhbAQAMCcMEEFaTl9DUkVEX1ZFUlNJT04wEzARAgEEDAoweDAwMDAwNjAwBAA=</wss:BinarySecurityToken>].{noformat}


Did all of the changes from acl_group_multiplecred_10020 get included in 10.0.5?

Why are there two two AZN_CRED_GROUP_REGISTRY_IDS and two AZN_CRED_GROUPS returned in the PAC?
Can we get a new fixpack for the customer with all of the fix in 10.0.5, if something was missed or with new debug if needed?

I tried following the old Jira and I wasn’t certain the format of the PAC that we were sending back.  It is possible that all of the code is still the same but now something is processing the groups differently, either WebSEAL or the backend TAI.   I just wanted to check to make sure everything was included.",,Annelise Quap,carlos.arias,khansen,Nick Lloyd,,,,,,,,,,,,5b15d950d9936c61022057fe,62ed8180432ef494c8cad107,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4432,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012539935,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,carlos.arias,62ed8180432ef494c8cad107,,,,US SOCIAL SECURITY ADMINISTRATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=2, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":2,""lastUpdated"":""2023-05-17T13:29:20.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":2,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012539935&path=TS012539935%2F2023-05-11%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1bi1b:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-15 22:24:46.753,,,,,"16/May/23 8:24 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] assigning this support case to you as you owned the original support item that was identified - 

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4432|https://cloudidentity.atlassian.net/browse/ISAMSUP-4432|smart-link] 

I can see that the code you submitted has been merged so we need to confirm if what might have happened to this commit. ",17/May/23 7:22 AM;5b15d950d9936c61022057fe;Customer reports that they did not change anything on the backend and only thing changed is the version upgrade from 10.0.2 to 10.0.5,"17/May/23 1:18 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a95bb8e163976365f77365e8758c1e49162c4f40
   * description: ISAMSUP-5075 Debug only 10050

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/499106.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5075) which we publish.","17/May/23 1:29 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a95bb8e163976365f77365e8758c1e49162c4f40
   * description: ISAMSUP-5075 Debug only 10050

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/499210.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230517032616-a95bb8e16-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","17/May/23 2:04 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d950d9936c61022057fe] 

All the changes from the fixpack have been merged to dev stream.

Here is a debug fixpack, can we get the trace with com.tivoli.am.fim.*=ALL 

name: acl_group_multiplecred_10050_debug
fixpack: [https://ibm.box.com/s/upr1n5iiaxlotg7nefzfvk82w8yyonf4|https://ibm.box.com/s/upr1n5iiaxlotg7nefzfvk82w8yyonf4|smart-link] 
checksum: [https://ibm.box.com/s/fzw3objuiievto16t1knbi10tueuv2pb|https://ibm.box.com/s/fzw3objuiievto16t1knbi10tueuv2pb|smart-link] 
version: 10050","17/May/23 2:47 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a95bb8e163976365f77365e8758c1e49162c4f40
   * description: ISAMSUP-5075 Debug only 10050

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/499920.


This build has not been published as the commit is not currently within a branch (20230517032616-a95bb8e16-support) which we publish.","06/Jun/23 12:33 AM;62ed8180432ef494c8cad107;[~accountid:5af4ad7d4dd24c579110120b] customer provided the requested logs.
/ecurep/sf/TS012/539/TS012539935/2023-06-05/","06/Jun/23 1:38 PM;5af4ad7d4dd24c579110120b;{noformat}[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac Debug00000 Iterator debug  CLNTWR01 with 1374b77c-f1ec-11e6-bac1-c0ffff0baa77
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac Debug00000 Iterator debug  CLNTSRC1 with b6894bfe-fd64-11e4-99b7-c0ffff0baa77
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac Debug00000 Iterator debug  ROMEENUM with 4abecc66-d98a-11e0-812d-c0ffff0baa77
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac building pac, adding groups: [Name [CLNTWR01]. UUID [1374b77c-f1ec-11e6-bac1-c0ffff0baa77]., Name [CLNTSRC1]. UUID [b6894bfe-fd64-11e4-99b7-c0ffff0baa77]., Name [ROMEENUM]. UUID [4abecc66-d98a-11e0-812d-c0ffff0baa77].]
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac Debug00000 building pac, adding groups: [Name [CLNTWR01]. UUID [1374b77c-f1ec-11e6-bac1-c0ffff0baa77]., Name [CLNTSRC1]. UUID [b6894bfe-fd64-11e4-99b7-c0ffff0baa77]., Name [ROMEENUM]. UUID [4abecc66-d98a-11e0-812d-c0ffff0baa77].]
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac Debug00000 Yes replacing uuids [Ljava.lang.String;@f097f263
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac Debug00000 Generic debug replacing groupNames [Ljava.lang.String;@72f46667
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac Debug00000 Generic debug replacing uuids [Ljava.lang.String;@f097f263
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      3 buildTamPac Debug00000 Generic debug replacing groups [Name [CLNTWR01]. UUID [1374b77c-f1ec-11e6-bac1-c0ffff0baa77]., Name [CLNTSRC1]. UUID [b6894bfe-fd64-11e4-99b7-c0ffff0baa77]., Name [ROMEENUM]. UUID [4abecc66-d98a-11e0-812d-c0ffff0baa77].]
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      < buildTamPac RETURN
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      < buildTamPrincipal RETURN
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      > addAdditionalAttributes ENTRY
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      < addAdditionalAttributes RETURN
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      1 buildTamCred the WSSBinaryPACToken was returned.
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.authservice.util.IvCredHelper      < buildTamCred RETURN
[6/2/23, 13:34:48:214 EDT] 0000ace8 id=00000000 com.tivoli.am.fim.fedmgr2.token.impl.BinaryToken             > createBSTToken ENTRY


[6/2/23, 13:35:11:698 EDT] 0000ac6f id=00000000 com.tivoli.am.fim.fedmgr2.token.impl.BinaryToken             < createBSTToken RETURN
[6/2/23, 13:35:11:698 EDT] 0000ac6f id=00000000 im.authsvc.action.decorator.signintoken.SignInTokenDecorator 3 execute(AuthSvcContextView) SignInToken [<wss:BinarySecurityToken xmlns:wss=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"" EncodingType=""http://ibm.com/2004/01/itfim/base64encode"" ValueType=""http://ibm.com/2004/01/itfim/ivcred"" wsu:Id=""uuid7d2d7752-0188-19fd-a73d-8273fcdd6b25"">BAKs3DCCCcIMADCCCbwwggm4AgIGADCBpDAqMB4CBH0td1ECAgGIAgIdNgICALsCAgClBAaCc/zdayUMCFo0OFkwWjBDMHYwJDAdAgQ9q+AQAgJnrwICEeoCAgC0AgF/BAYAGkpKd/4MA0VNUDAmMB8CBM6fWiICAwD67QICEdoCAgC/AgIAhQQGCieS+qp3DANJUlMwJjAfAgQVRTTEAgMA+u4CAhHaAgIAvwICAIUEBgonkvqqdwwDV0FHAgEBMIIJBjCCCQIwKAwXdGFndmFsdWVfYWN1LWxvZ2luLXBhdGgwDTALAgEEDARST01FBAAwLwwYQVpOX0NSRURfQVVUSF9FUE9DSF9USU1FMBMwEQIBBAwKMTY4NTcyNzI5OQQAMDMMHEFaTl9DUkVEX05FVFdPUktfQUREUkVTU19CSU4wEzARAgEEDAoweDBhM2MxN2I3BAAwTAwbYXV0aGVudGljYXRpb25UcmFuc2FjdGlvbklkMC0wKwIBBAwkYzc2NzFjODEtMzNkYi00MzdiLTkyN2UtMjlhNzg1OWRlYmQ0BAAwIgwUQVVUSEVOVElDQVRJT05fTEVWRUwwCjAIAgEEDAExBAAwgZoMGHRhZ3ZhbHVlX3VzZXJfc2Vzc2lvbl9pZDB+MHwCAQQMdWMyVmpkWEpsQUE9PV9aSG9vUXdBQUFBSUFBQUF3UXloNlpOZ3lKZWs2ZndBQVJXWTNUa1k1YTBFNGJGZFBiMlpDYmtGcWJpMVFOR2RXTkRGblN6SjBiVEZJZVhocFFsUkRjVkI0TUZZemRtaGs6ZGVmYXVsdAQAMDMMFEFaTl9DUkVEX0FVVEhfTUVUSE9EMBswGQIBBAwSZXh0LWF1dGgtaW50ZXJmYWNlBAAwKQwQQVpOX0NSRURfTUVDSF9JRDAVMBMCAQQMDElWX0xEQVBfVjMuMAQAMIHCDBtBWk5fQ1JFRF9HUk9VUF9SRUdJU1RSWV9JRFMwgaIwNAIBBAwtY249RU1QLG91PWdyb3VwcyxvdT1zc2Esbz11LnMuZ292ZXJubWVudCxjPXVzBAAwNAIBBAwtY249SVJTLG91PWdyb3VwcyxvdT1zc2Esbz11LnMuZ292ZXJubWVudCxjPXVzBAAwNAIBBAwtY249V0FHLG91PWdyb3VwcyxvdT1zc2Esbz11LnMuZ292ZXJubWVudCxjPXVzBAAwRwwWdGFndmFsdWVfc2Vzc2lvbl9pbmRleDAtMCsCAQQMJGI0ZWUwMjQ0LTAxNmItMTFlZS1iYWE2LTAwMWE0YTRhNzdmMAQAMGEMHGF1dGhlbnRpY2F0aW9uTWVjaGFuaXNtVHlwZXMwQTA/AgEEDDh1cm46aWJtOnNlY3VyaXR5OmF1dGhlbnRpY2F0aW9uOmFzZjptZWNoYW5pc206cmVjYXB0Y2hhMwQAMCYMEkFaTl9DUkVEX0lQX0ZBTUlMWTAQMA4CAQQMB0FGX0lORVQEADAtDBFBWk5fQ1JFRF9RT1BfSU5GTzAYMBYCAQQMD1NTSzogVExTVjEyOiA5RAQAMEgMF0FaTl9DUkVEX1BSSU5DSVBBTF9VVUlEMC0wKwIBBAwkMzE3MjViNDMtMDE4NS0xNDYwLWI4ZjYtZGUyODdiMGRlY2RkBAAwJwwSQVpOX0NSRURfQVVUSFpOX0lEMBEwDwIBBAwIWjQ4WTBaMEMEADAtDBlBWk5fQ1JFRF9QUklOQ0lQQUxfRE9NQUlOMBAwDgIBBAwHRGVmYXVsdAQAMF0MFEFaTl9DUkVEX1JFR0lTVFJZX0lEMEUwQwIBBAw8Y249WjQ4WTBaMEMsb3U9YnVzaW5lc3NwYXJ0bmVycyxvdT1zc2Esbz11LnMuZ292ZXJubWVudCxjPXVzBAAwLAwXQVpOX0NSRURfUFJJTkNJUEFMX05BTUUwETAPAgEEDAhaNDhZMFowQwQAMDYMJHRhZ3ZhbHVlX21heF9jb25jdXJyZW50X3dlYl9zZXNzaW9uczAOMAwCAQQMBXVuc2V0BAAwLQwYdGFndmFsdWVfbG9naW5fdXNlcl9uYW1lMBEwDwIBBAwIWjQ4WTBaMEMEADA1DBxBWk5fQ1JFRF9ORVRXT1JLX0FERFJFU1NfU1RSMBUwEwIBBAwMMTAuNjAuMjMuMTgzBAAwNwwPQVpOX0NSRURfR1JPVVBTMCQwCgIBBAwDRU1QBAAwCgIBBAwDSVJTBAAwCgIBBAwDV0FHBAAwOQwVQVpOX0NVU1RPTV9BVFRSSUJVVEVTMCAwHgIBBAwXdGFndmFsdWVfYWN1LWxvZ2luLXBhdGgEADBODBNhdXRoZW50aWNhdGlvblR5cGVzMDcwNQIBBAwudXJuOmlibTpzZWN1cml0eTphdXRoZW50aWNhdGlvbjphc2Y6cmVjYXB0Y2hhMwQAMCcMEEFaTl9DUkVEX1ZFUlNJT04wEzARAgEEDAoweDAwMDAxMDA1BAAwgZEMFUFaTl9DUkVEX0JST1dTRVJfSU5GTzB4MHYCAQQMb01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMTMuMC4wLjAgU2FmYXJpLzUzNy4zNgQAMCwMF0FaTl9DUkVEX1BSSU5DSVBBTF9OQU1FMBEwDwIBBAwIWjQ4WTBaMEMEADBIDBdBWk5fQ1JFRF9QUklOQ0lQQUxfVVVJRDAtMCsCAQQMJDdkMmQ3NzUxLTAxODgtMWQzNi1iYmE1LTgyNzNmY2RkNmIyNQQAMIGgDBRBWk5fQ1JFRF9HUk9VUF9VVUlEUzCBhzArAgEEDCQzZGFiZTAxMC02N2FmLTExZWEtYjQ3Zi0wMDFhNGE0YTc3ZmUEADArAgEEDCRjZTlmNWEyMi1mYWVkLTExZGEtYmY4NS0wYTI3OTJmYWFhNzcEADArAgEEDCQxNTQ1MzRjNC1mYWVlLTExZGEtYmY4NS0wYTI3OTJmYWFhNzcEADBDDBtBWk5fQ1JFRF9HUk9VUF9SRUdJU1RSWV9JRFMwJDAKAgEEDANFTVAEADAKAgEEDANJUlMEADAKAgEEDANXQUcEADA3DA9BWk5fQ1JFRF9HUk9VUFMwJDAKAgEEDANFTVAEADAKAgEEDANJUlMEADAKAgEEDANXQUcEADApDBdBWk5fQ1JFRF9BVVRITk1FQ0hfSU5GTzAOMAwCAQQMBWxvY2FsBAAwJwwQQVpOX0NSRURfVkVSU0lPTjATMBECAQQMCjB4MDAwMDA2MDAEAA==</wss:BinarySecurityToken>].
[6/2/23, 13:35:11:698 EDT] 0000ac6f id=00000000 im.authsvc.action.decorator.signintoken.SignInTokenDecorator < execute(AuthSvcContextView) RETURN
[6/2/23, 13:35:11:698 EDT] 0000ac6f id=00000000 com.tivoli.am.fim.authsvc.automaton.state.DecoratorState     < (actions).execute(AuthSvcContextV{noformat}

{noformat}2023-05-11-13:53:26.581-04:00I----- thread(204) trace.pdweb.wan.azn:9 /build/isam/src/i4w/pdwebrte/webcore/amw_azn.c:117: [10.60.23.181] Attr Name:AZN_CRED_GROUP_UUIDS , Value: 1374b77c-f1ec-11e6-bac1-c0ffff0baa77

2023-05-11-13:53:26.581-04:00I----- thread(204) trace.pdweb.wan.azn:9 /build/isam/src/i4w/pdwebrte/webcore/amw_azn.c:117: [10.60.23.181] Attr Name:AZN_CRED_GROUP_UUIDS , Value: b6894bfe-fd64-11e4-99b7-c0ffff0baa77

2023-05-11-13:53:26.581-04:00I----- thread(204) trace.pdweb.wan.azn:9 /build/isam/src/i4w/pdwebrte/webcore/amw_azn.c:117: [10.60.23.181] Attr Name:AZN_CRED_GROUP_UUIDS , Value: 4abecc66-d98a-11e0-812d-c0ffff0baa77

2023-05-11-13:53:26.581-04:00I----- thread(204) trace.pdweb.wan.azn:9 /build/isam/src/i4w/pdwebrte/webcore/amw_azn.c:117: [10.60.23.181] Attr Name:AZN_CRED_GROUP_REGISTRY_IDS , Value: cn=CLNTSRC1,ou=groups,ou=ssa,o=u.s.government,c=us

2023-05-11-13:53:26.581-04:00I----- thread(204) trace.pdweb.wan.azn:9 /build/isam/src/i4w/pdwebrte/webcore/amw_azn.c:117: [10.60.23.181] Attr Name:AZN_CRED_GROUP_REGISTRY_IDS , Value: cn=ROMEENUM,ou=groups,ou=ssa,o=u.s.government,c=us

2023-05-11-13:53:26.581-04:00I----- thread(204) trace.pdweb.wan.azn:9 /build/isam/src/i4w/pdwebrte/webcore/amw_azn.c:117: [10.60.23.181] Attr Name:AZN_CRED_GROUP_REGISTRY_IDS , Value: cn=CLNTWR01,ou=groups,ou=ssa,o=u.s.government,c=us{noformat}

Don't see duplicate groups/uuid issue",09/Jun/23 4:40 AM;62ed8180432ef494c8cad107;[~accountid:5af4ad7d4dd24c579110120b] does it confirm that issue is different from original one?,"14/Jun/23 12:02 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:62ed8180432ef494c8cad107] 

The pac does not have duplicate uuid. It's not the same issue.


{noformat}BAKs3DCCCcIMADCCCbwwggm4AgIGADCBpDAqMB4CBH0td1ECAgGIAgIdNgICALsCAgClBAaCc/zdayUMCFo0OFkwWjBDMHYwJDAdAgQ9q+AQAgJnrwICEeoCAgC0AgF/BAYAGkpKd/4MA0VNUDAmMB8CBM6fWiICAwD67QICEdoCAgC/AgIAhQQGCieS+qp3DANJUlMwJjAfAgQVRTTEAgMA+u4CAhHaAgIAvwICAIUEBgonkvqqdwwDV0FHAgEBMIIJBjCCCQIwKAwXdGFndmFsdWVfYWN1LWxvZ2luLXBhdGgwDTALAgEEDARST01FBAAwLwwYQVpOX0NSRURfQVVUSF9FUE9DSF9USU1FMBMwEQIBBAwKMTY4NTcyNzI5OQQAMDMMHEFaTl9DUkVEX05FVFdPUktfQUREUkVTU19CSU4wEzARAgEEDAoweDBhM2MxN2I3BAAwTAwbYXV0aGVudGljYXRpb25UcmFuc2FjdGlvbklkMC0wKwIBBAwkYzc2NzFjODEtMzNkYi00MzdiLTkyN2UtMjlhNzg1OWRlYmQ0BAAwIgwUQVVUSEVOVElDQVRJT05fTEVWRUwwCjAIAgEEDAExBAAwgZoMGHRhZ3ZhbHVlX3VzZXJfc2Vzc2lvbl9pZDB+MHwCAQQMdWMyVmpkWEpsQUE9PV9aSG9vUXdBQUFBSUFBQUF3UXloNlpOZ3lKZWs2ZndBQVJXWTNUa1k1YTBFNGJGZFBiMlpDYmtGcWJpMVFOR2RXTkRGblN6SjBiVEZJZVhocFFsUkRjVkI0TUZZemRtaGs6ZGVmYXVsdAQAMDMMFEFaTl9DUkVEX0FVVEhfTUVUSE9EMBswGQIBBAwSZXh0LWF1dGgtaW50ZXJmYWNlBAAwKQwQQVpOX0NSRURfTUVDSF9JRDAVMBMCAQQMDElWX0xEQVBfVjMuMAQAMIHCDBtBWk5fQ1JFRF9HUk9VUF9SRUdJU1RSWV9JRFMwgaIwNAIBBAwtY249RU1QLG91PWdyb3VwcyxvdT1zc2Esbz11LnMuZ292ZXJubWVudCxjPXVzBAAwNAIBBAwtY249SVJTLG91PWdyb3VwcyxvdT1zc2Esbz11LnMuZ292ZXJubWVudCxjPXVzBAAwNAIBBAwtY249V0FHLG91PWdyb3VwcyxvdT1zc2Esbz11LnMuZ292ZXJubWVudCxjPXVzBAAwRwwWdGFndmFsdWVfc2Vzc2lvbl9pbmRleDAtMCsCAQQMJGI0ZWUwMjQ0LTAxNmItMTFlZS1iYWE2LTAwMWE0YTRhNzdmMAQAMGEMHGF1dGhlbnRpY2F0aW9uTWVjaGFuaXNtVHlwZXMwQTA/AgEEDDh1cm46aWJtOnNlY3VyaXR5OmF1dGhlbnRpY2F0aW9uOmFzZjptZWNoYW5pc206cmVjYXB0Y2hhMwQAMCYMEkFaTl9DUkVEX0lQX0ZBTUlMWTAQMA4CAQQMB0FGX0lORVQEADAtDBFBWk5fQ1JFRF9RT1BfSU5GTzAYMBYCAQQMD1NTSzogVExTVjEyOiA5RAQAMEgMF0FaTl9DUkVEX1BSSU5DSVBBTF9VVUlEMC0wKwIBBAwkMzE3MjViNDMtMDE4NS0xNDYwLWI4ZjYtZGUyODdiMGRlY2RkBAAwJwwSQVpOX0NSRURfQVVUSFpOX0lEMBEwDwIBBAwIWjQ4WTBaMEMEADAtDBlBWk5fQ1JFRF9QUklOQ0lQQUxfRE9NQUlOMBAwDgIBBAwHRGVmYXVsdAQAMF0MFEFaTl9DUkVEX1JFR0lTVFJZX0lEMEUwQwIBBAw8Y249WjQ4WTBaMEMsb3U9YnVzaW5lc3NwYXJ0bmVycyxvdT1zc2Esbz11LnMuZ292ZXJubWVudCxjPXVzBAAwLAwXQVpOX0NSRURfUFJJTkNJUEFMX05BTUUwETAPAgEEDAhaNDhZMFowQwQAMDYMJHRhZ3ZhbHVlX21heF9jb25jdXJyZW50X3dlYl9zZXNzaW9uczAOMAwCAQQMBXVuc2V0BAAwLQwYdGFndmFsdWVfbG9naW5fdXNlcl9uYW1lMBEwDwIBBAwIWjQ4WTBaMEMEADA1DBxBWk5fQ1JFRF9ORVRXT1JLX0FERFJFU1NfU1RSMBUwEwIBBAwMMTAuNjAuMjMuMTgzBAAwNwwPQVpOX0NSRURfR1JPVVBTMCQwCgIBBAwDRU1QBAAwCgIBBAwDSVJTBAAwCgIBBAwDV0FHBAAwOQwVQVpOX0NVU1RPTV9BVFRSSUJVVEVTMCAwHgIBBAwXdGFndmFsdWVfYWN1LWxvZ2luLXBhdGgEADBODBNhdXRoZW50aWNhdGlvblR5cGVzMDcwNQIBBAwudXJuOmlibTpzZWN1cml0eTphdXRoZW50aWNhdGlvbjphc2Y6cmVjYXB0Y2hhMwQAMCcMEEFaTl9DUkVEX1ZFUlNJT04wEzARAgEEDAoweDAwMDAxMDA1BAAwgZEMFUFaTl9DUkVEX0JST1dTRVJfSU5GTzB4MHYCAQQMb01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMTMuMC4wLjAgU2FmYXJpLzUzNy4zNgQAMCwMF0FaTl9DUkVEX1BSSU5DSVBBTF9OQU1FMBEwDwIBBAwIWjQ4WTBaMEMEADBIDBdBWk5fQ1JFRF9QUklOQ0lQQUxfVVVJRDAtMCsCAQQMJDdkMmQ3NzUxLTAxODgtMWQzNi1iYmE1LTgyNzNmY2RkNmIyNQQAMIGgDBRBWk5fQ1JFRF9HUk9VUF9VVUlEUzCBhzArAgEEDCQzZGFiZTAxMC02N2FmLTExZWEtYjQ3Zi0wMDFhNGE0YTc3ZmUEADArAgEEDCRjZTlmNWEyMi1mYWVkLTExZGEtYmY4NS0wYTI3OTJmYWFhNzcEADArAgEEDCQxNTQ1MzRjNC1mYWVlLTExZGEtYmY4NS0wYTI3OTJmYWFhNzcEADBDDBtBWk5fQ1JFRF9HUk9VUF9SRUdJU1RSWV9JRFMwJDAKAgEEDANFTVAEADAKAgEEDANJUlMEADAKAgEEDANXQUcEADA3DA9BWk5fQ1JFRF9HUk9VUFMwJDAKAgEEDANFTVAEADAKAgEEDANJUlMEADAKAgEEDANXQUcEADApDBdBWk5fQ1JFRF9BVVRITk1FQ0hfSU5GTzAOMAwCAQQMBWxvY2FsBAAwJwwQQVpOX0NSRURfVkVSU0lPTjATMBECAQQMCjB4MDAwMDA2MDAEAA=={noformat}

{noformat}AZN_CRED_BROWSER_INFO	
[0]: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36
AZN_CRED_GROUPS	
[0]: EMP 
[1]: IRS 
[2]: WAG
AZN_CRED_GROUP_REGISTRY_IDS	
[0]: EMP 
[1]: IRS 
[2]: WAG
AZN_CRED_GROUP_UUIDS	
[0]: 154534c4-faee-11da-bf85-0a2792faaa77 
[1]: 3dabe010-67af-11ea-b47f-001a4a4a77fe 
[2]: ce9f5a22-faed-11da-bf85-0a2792faaa77{noformat}","16/Jun/23 2:03 PM;5af4ad7d4dd24c579110120b;<Notes>

Set up environment based on [https://cloudidentity.atlassian.net/browse/ISAMSUP-4432|https://cloudidentity.atlassian.net/browse/ISAMSUP-4432|smart-link] steps.
Works ok 
Issue not recreated

[https://10.160.20.78/wga/reverseproxy#|https://10.160.20.78/wga/reverseproxy#] 

Looks like they already have this option - allow-url-macro-to-be-relative set to yes from a similar error - 

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4733|https://cloudidentity.atlassian.net/browse/ISAMSUP-4733|smart-link] ","26/Jun/23 11:37 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:62ed8180432ef494c8cad107] 

I cant see anything obvious in the logs or config.
Can you see if you can get more trace enabled from AAC side from customer env and if you can get a recreate. ","28/Jun/23 1:36 AM;62ed8180432ef494c8cad107;Yes, I asked for AAC traces again.
He usually takes a couple of days to get the traces.","07/Jul/23 3:34 AM;62ed8180432ef494c8cad107;[~accountid:5af4ad7d4dd24c579110120b] customer provided more information:

S:\sf\TS012\539\TS012539935\2023-07-05\",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
CVE-2023-25927,ISAMSUP-5071,299470,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,12/May/23 9:51 PM,12/Jul/23 8:53 PM,14/Jul/23 2:47 PM,12/Jul/23 8:53 PM,,,,0,,,,"The very small description indicates the webseald process can crash using a http request. Which request is that? How? Can we have more disclosure? Can we make an assessment whether this is for authenticated vs unauthenticated flows? Specific methods? 
As per below document:



[Security Bulletin: Multiple Security Vulnerabilities have been fixed in IBM Security Verify Access|https://www.ibm.com/support/pages/node/6989653?myns=swgimgmt&mynp=OCSSRGTL&mync=E&cm_sp=swgimgmt-_-OCSSRGTL-_-E]



CVEID:  [CVE-2023-25927|http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-25927]

DESCRIPTION:  IBM Security Verify Access could allow an attacker to crash the webseald process using specially crafted HTTP requests resulting in loss of access to the system.

CVSS Base score: 6.5

CVSS Temporal Score: See: [https://exchange.xforce.ibmcloud.com/vulnerabilities/247635|https://exchange.xforce.ibmcloud.com/vulnerabilities/247635|smart-link]  for the current score.

CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H)



Security Vulnerability have been fixed in IBM Security Verify Access 10.0.5.0 IF1.

CVE-2023-25927 only indicates the ID is reserved. [https://exchange.xforce.ibmcloud.com/vulnerabilities/247635|https://exchange.xforce.ibmcloud.com/vulnerabilities/247635|smart-link]  does not even find an entry. So how can we make an assessment? We will have to be direct in my question: 

what's the specially crafted HTTP request? 
",,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013002577,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bgtb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-05-14 22:36:31.648,,,,,15/May/23 8:36 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] please start the PSIRT assessment process associated with this support item.,16/May/23 12:05 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac57757d9a96536d1f0daa9] this has already been through the PSIRT process. It has an assigned CVE ,07/Jun/23 8:50 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] can you please confirm when this PSIRT was delivered?,"08/Jun/23 1:06 AM;5b15d8fd6e93913e31e279fb;[~accountid:617a5f2cf485cd0068cb98af] We cannot disclose the specially crafted HTTP request because this would expose the vulnerability to an exploit.  The link you posted for [https://exchange.xforce.ibmcloud.com/vulnerabilities/247635|https://exchange.xforce.ibmcloud.com/vulnerabilities/247635|smart-link] is not active.  It can take a day or two after the Security Bulletin is published before the X-Force link becomes active. 

In order for the customer to be protected it is strongly recommended that the customer update to the latest Mod Level of the release as documented in our Support Policy.  [https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|smart-link] ",12/Jul/23 8:53 PM;5ac57757d9a96536d1f0daa9;Case has been closed. Setting the Jira items status to Done to reflect this. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA10.0.4 runtime hangs,ISAMSUP-5067,299154,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Aaron.Richie.Dias,6194c472fe9f300068e5252f,Aaron.Richie.Dias,6194c472fe9f300068e5252f,12/May/23 4:38 AM,15/Jun/23 12:08 PM,14/Jul/23 2:47 PM,15/Jun/23 12:08 PM,,,,0,,,,"After deploying an update on the cluster master, it happens that the runtime on one of the others nodes ends up in a hung state.


The issue not only happens after an update of a certificate store, but also happens after an update of a mapping rule or an update of a federation definition.

The issue never happened on a non-prod environment, but only on the customers prod env.


The customer has created a support file which is uploaded. 

In the messages.log(of support file uploaded on the 16th of march) we can see the following sequence of events.

These messages are from the messages.log

The updated certificate store detected by the appiance uksampnl0007
[2023-03-16T08:03:35.459+0100] 0002195d com.ibm.ws.ssl.internal.KeystoreConfigurationFactory         A CWPKI0811I: The keystore file /var/pdweb/shared/keytab/rt_profile_keys.p12 has been modified.  The keystore file will be reloaded so the updated keystore file can be used.

The last error message regarding the certificate
[2023-03-16T08:03:44.073+0100] 0002195e com.tivoli.am.fim.fedmgr2.servlet.BrowserAdaptor             E FBTSPS061E An unexpected error has occurred with a protocol module com.tivoli.am.fim.oidc10.protocol.delegate.rp.OidcRelyingPartyLandingDelegate@f516162.

[2023-03-16T08:03:50.230+0100] 0002195e com.tivoli.am.fim.fedmgr2.proper.FederationManager           I FBTSPS009I Creating the Single Sign-on Protocol Service.

The runtime hangs
[2023-03-16T09:17:39.649+0100] 00000024 com.ibm.ws.threading.internal.ThreadPoolController           W CWWKE1200W:  All threads in the Liberty default executor appear to be hung.  Liberty automatically increased the number of threads from 1,002 to 1,002.  However, all threads still appear to be hung.

The runtime manually restarted
[2023-03-16T10:12:44.539+0100] 00000019 com.ibm.ws.kernel.launch.internal.ServerCommandListener      A CWWKE0055I: Server shutdown requested on Thursday, March 16, 2023 at 10:12 AM. The server runtime is shutting down.



I requested the customer to reproduce the issue and create a javacore dump and generate a new support file to analyse and try to understand what the hung processes are trying to do. 

new support file: [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012457530&path=TS012457530%2F2023-04-21%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012457530&path=TS012457530%2F2023-04-21%2F]

javacore dump: [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012457530&path=TS012457530%2F2023-05-09%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012457530&path=TS012457530%2F2023-05-09%2F]",,BRIANORO,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,6154906364ff01007106e189,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-3525,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012457530,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Aaron.Richie.Dias,6194c472fe9f300068e5252f,,,,AEGON EDC LIMITED,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bevb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-11 23:45:44.117,,,,,12/May/23 9:45 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] appreciate if you can take the initial look at this item for us. If you need any support please let [~accountid:5b232b2fd85e5b59b066f57f] and I know how we can assist. ,"12/May/23 10:30 AM;5af4ad7d4dd24c579110120b;{{<notes}}

{{>Waiting on: com/ibm/security/access/httpclient/RWLock}}

{noformat}NULL
3XMTHREADINFO      ""Default Executor-thread-57466"" J9VMThread:0x0000000004337700, omrthread_t:0x00007F74E5616008, java/lang/Thread:0x00000007FCD06A68, state:CW, prio=5
3XMJAVALTHREAD            (java/lang/Thread getId:0x34D48, isDaemon:true)
3XMTHREADINFO1            (native thread ID:0x6690, native priority:0x5, native policy:UNKNOWN, vmstate:CW, vm thread flags:0x00000181)
3XMTHREADINFO2            (native stack address range from:0x00007F7496DB7000, to:0x00007F7496DF7000, size:0x40000)
3XMCPUTIME               CPU usage total: 0.047507400 secs, current category=""Application""
3XMTHREADBLOCK     Waiting on: com/ibm/security/access/httpclient/RWLock@0x000000070540E6F8 Owned by: <unowned>
3XMHEAPALLOC             Heap bytes allocated since last GC cycle=0 (0x0)
3XMTHREADINFO3           Java callstack:
4XESTACKTRACE                at java/lang/Object.wait(Native Method)
4XESTACKTRACE                at java/lang/Object.wait(Bytecode PC:3(Compiled Code))
4XESTACKTRACE                at com/ibm/security/access/httpclient/RWLock.getReaderLock(RWLock.java:98(Compiled Code))
4XESTACKTRACE                at com/ibm/security/access/httpclient/HttpClientV2.getHttpClient(HttpClientV2.java:2767(Compiled Code))
4XESTACKTRACE                at com/ibm/security/access/httpclient/HttpClientV2.doRequest(HttpClientV2.java:2681(Compiled Code))
4XESTACKTRACE                at com/ibm/security/access/httpclient/HttpClientV2.httpPost(HttpClientV2.java:1332(Compiled Code))
4XESTACKTRACE                at com/ibm/security/access/httpclient/HttpClientV2.httpPost(HttpClientV2.java:1229(Compiled Code))
4XESTACKTRACE                at jdk/internal/reflect/GeneratedMethodAccessor82.invoke(Bytecode PC:232(Compiled Code))
4XESTACKTRACE                at jdk/internal/reflect/DelegatingMethodAccessorImpl.invoke(Bytecode PC:6(Compiled Code))
4XESTACKTRACE                at java/lang/reflect/Method.invoke(Bytecode PC:61(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/MemberBox.invoke(MemberBox.java:126(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/NativeJavaMethod.call(NativeJavaMethod.java:225(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/optimizer/OptRuntime.callN(OptRuntime.java:52(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/gen/AegonCommonUtils_627._c_getPensionid_10(AegonCommonUtils:246(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/gen/AegonCommonUtils_627.call(AegonCommonUtils(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/optimizer/OptRuntime.callName(OptRuntime.java:63(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/gen/ciammapmobiel_626._c_script_0(ciammapmobiel:122)
4XESTACKTRACE                at org/mozilla/javascript/gen/ciammapmobiel_626.call(ciammapmobiel(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/ContextFactory.doTopCall(ContextFactory.java:405(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/ScriptRuntime.doTopCall(ScriptRuntime.java:3508(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/gen/ciammapmobiel_626.call(ciammapmobiel(Compiled Code))
4XESTACKTRACE                at org/mozilla/javascript/gen/ciammapmobiel_626.exec(ciammapmobiel){noformat}","12/May/23 1:50 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:6194c472fe9f300068e5252f] 

Here is a fixpack to resolve the runtime hang-

name:httclientv2_memleak_10040
version:10.0.4.0
fixpack: [https://ibm.box.com/s/gigegyz6q2f9d0w08ce505papt7jh8ju|https://ibm.box.com/s/gigegyz6q2f9d0w08ce505papt7jh8ju|smart-link] 
checksum: [https://ibm.box.com/s/wiczfs47wgwfvnzq1jn1msnw3ydn1klc|https://ibm.box.com/s/wiczfs47wgwfvnzq1jn1msnw3ydn1klc|smart-link] 
files changed: /opt/IBM/wlp/usr/extension/lib/isam/common/com.ibm.security.access.common_8.0.0.jar 

fixpack restarts aac runtime.

Let me know if this resolves the issue.","16/May/23 1:38 AM;6194c472fe9f300068e5252f;Thanks for the update, Asha. I will provide the customer with the fixpack and get back to you with their feedback. ","18/May/23 2:37 PM;5af4ad7d4dd24c579110120b;[~accountid:6194c472fe9f300068e5252f] 

Send this version of the fixpack to the customer since they have another fixpack which modifies the same jar.

[https://ibm.box.com/s/f02icv9k5d7q7618tc3k0l1119va6nt2|https://ibm.box.com/s/f02icv9k5d7q7618tc3k0l1119va6nt2|smart-link] ","18/May/23 5:19 PM;6194c472fe9f300068e5252f;thanks for the update [~accountid:5af4ad7d4dd24c579110120b] , the customer did update saying the older fixpack did not work and seems to be missing all the functions which were delivered in relation to this Jira [https://cloudidentity.atlassian.net/browse/ISAMSUP-4616|https://cloudidentity.atlassian.net/browse/ISAMSUP-4616|smart-link] and [https://www.ibm.com/support/pages/apar/IJ44895|https://www.ibm.com/support/pages/apar/IJ44895] 



But seems like you have corrected that in the new fixpack, I will provide that to the customer and get back to you with their feedback","19/May/23 5:47 PM;6194c472fe9f300068e5252f;Hello [~accountid:5af4ad7d4dd24c579110120b] customer says the new fixpack still giving the same errors as the old fixpack, below is the response from the customer:



======================================================================

This new version of the fixpack gives the same issue as the old version of the fixpack.



It gave me stacktraces because it's missing some relevant functions like:

Caused by: org.mozilla.javascript.EcmaError: TypeError: Cannot find function getUserByNativeIdWithDomain in object com.ibm.security.access.user.UserLookupHelper@99424017.



It seems it is still missing all the functions which were delivered in relation to case number: TS011270948 (and Jira [https://cloudidentity.atlassian.net/browse/ISAMSUP-4616|https://cloudidentity.atlassian.net/browse/ISAMSUP-4616|smart-link] )

The 'WithDomain' functions.

====================================================================","22/May/23 10:04 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6194c472fe9f300068e5252f] 

I have updated the fixpack to include the changes from UserLookUpHelper.

I have changed the fixpack name so that we are sure the new version is installed.

Uninstall older versions -

name:httclientv2_memleak_10040IF1
version:10.0.4.0IF1

[https://ibm.box.com/s/tqjhehr9sm73wfe8rsuw8k3qf5boy3d0|https://ibm.box.com/s/tqjhehr9sm73wfe8rsuw8k3qf5boy3d0|smart-link] 

[https://ibm.box.com/s/jw9dzc2fx4fghfazrmr9sr6fulk6f7aw|https://ibm.box.com/s/jw9dzc2fx4fghfazrmr9sr6fulk6f7aw|smart-link] 



Install this new version.

Get the support file if we see the issue again.

Thanks","22/May/23 8:58 PM;6194c472fe9f300068e5252f;thanks for the update, Asha. I will provide the new fix to the customer and get back to you.","25/May/23 10:58 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6194c472fe9f300068e5252f] 

Ive updated the fixpack to include the getUserByNativeIdWithDomain calls.

[https://ibm.box.com/s/tqjhehr9sm73wfe8rsuw8k3qf5boy3d0|https://ibm.box.com/s/tqjhehr9sm73wfe8rsuw8k3qf5boy3d0|smart-link] ","30/May/23 7:53 PM;6194c472fe9f300068e5252f;Thank you for the fixpack [~accountid:5af4ad7d4dd24c579110120b], I will provide this to the customer and get back to you with the feedback.



This is the support file after the previous fixpack was provided to the customer. 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012457530&path=TS012457530%2F2023-05-24%2F&filepath=TS012457530%2F2023-05-24%2Fisva_10.0.4.0_20230523-120535_uksamtnl0001.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012457530&path=TS012457530%2F2023-05-24%2F&filepath=TS012457530%2F2023-05-24%2Fisva_10.0.4.0_20230523-120535_uksamtnl0001.support]","08/Jun/23 2:24 AM;6194c472fe9f300068e5252f;Hello Asha, the customer mentioned they installed the new fixpack in their test env and it worked fine, they will keep us posted on how it goes when they install on their prod env and I will update the Jira with their feedback. ","15/Jun/23 12:08 PM;5af4ad7d4dd24c579110120b;It was related to this APAR- IJ40454
It is fixed in 10050.

Closing this Issue.
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
DSC session terminate all_sessions,ISAMSUP-5049,298032,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Gabe,5b15d99b4c20165700edecad,Gabe,5b15d99b4c20165700edecad,06/May/23 12:03 AM,09/May/23 10:47 PM,14/Jul/23 2:47 PM,09/May/23 10:47 PM,,,,0,,,,"We have a customer who needs a solution to terminate all of a users active sessions after changing their password. They allow concurrent sessions so a user might be logged in on several browsers or mobile devices. In this situation pkmslogout isn’t sufficient as it only logs out the browser in use. 

Since the customer is using DSC the thought was to call terminate all_sessions via RestAPI but I’m seeing some odd behaviour on my own lab system. 

To test I’m authenticating to the Reverse Proxy with the same userid on two different browsers. 
Next I run the RestAPI to terminate all sessions. This is successful and I can see the sessions cleared in the LMI.  But the sessions are still active on the Reverse Proxy and the Proxy then adds the sessions back to the DSC. 


I believe I understand what is happening, the Reverse Proxy still has a local session and the dscadmin command is really only removing the entry from the DSC. Since this command appears to be a replacement for the pdadmin terminate session I would have expected the session to also be terminated on the Reverse Proxy. 

We document here that pdadmin server task terminate all_sessions isn’t used with DSC. But the pdadmin command is terminating a session at the Reverse Proxy unlike the dscadmin command. 
[https://www.ibm.com/docs/en/sva/10.0.5?topic=sessions-termination-all-user|https://www.ibm.com/docs/en/sva/10.0.5?topic=sessions-termination-all-user|smart-link] 

Am I doing something wrong? I haven’t really make any changes to the RP or DSC other than enabling it. 
Should the dscadmin command be able to terminate a session at the RP level?",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012893682,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Gabe,5b15d99b4c20165700edecad,,,,HORIZON HEALTHCARE SERVICES INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1b813:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-05-05 23:43:02.71,,,,,"06/May/23 9:43 AM;5b15d9517dab4c51f61b5190;When you delete a session in the DSC - it should notify all the Reverse proxies using the session - which will then delete their local copy  of the  session

On the next reverse proxy request containing the session cookie - it should not find the session in its local cache, request it from DSC and get a not found error back from the DSC

This should then prompt for login - except if request contains info to allow login again - eg BA header or Failover Cookie

If the session is recreated it will be a different session and a different session cookie

Does the session cookie change?

There is a mechanism to do terminate all sessions for a user in EAI am-eai-server-task which may be of use

See [https://www.ibm.com/docs/en/sva/10.0.5?topic=interface-external-authentication-process-flow|https://www.ibm.com/docs/en/sva/10.0.5?topic=interface-external-authentication-process-flow|smart-link] ",09/May/23 10:47 PM;5b15d99b4c20165700edecad;Thanks Peter for confirming this. For some reason this didn’t work on both my 10.0.4 and 10.0.5 but it works now. I guess something wasn’t deployed but a reboot must have fixed it up. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
WebSEAL stops responding when pointed to HSM kdb,ISAMSUP-5048,298024,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,05/May/23 10:49 PM,12/May/23 7:38 AM,14/Jul/23 2:47 PM,12/May/23 7:37 AM,,,05/May/23 12:00 AM,0,,,,"AT&T has upgraded to 10.0.5 and are seeing the same issue they saw in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4004|https://cloudidentity.atlassian.net/browse/ISAMSUP-4004|smart-link] 

Symptom seems mostly the same. When trying to browse the junctions in the LMI they get

{noformat}message: Error: WGAWA0010E An internal error has occurred (/workspace/src/appliance/app-core/modules/config_wga_servertask.cpp:242).{noformat}

WebSEAL does seem to be crashing based on the var/log/messages

{noformat}May  4 14:27:54 mesa_crashd[649]: Error: CRASH: program=webseald-fnet pid=10446 reason=""invalid permissions for mapped object"" signal=11 code=2 addr=0x7fecbda0c000 stack='0x7fecc83fa2ce 0x7fecc5464ce0 0x7fecc482e0d1 0x7fec93099242 0x7fec9
3099659 0x7fec9308fe3c 0x7fec930c9abb 0x7fec93062634 0x7fec930778a5 0x7fec93077c4a ' regs='0x7fec840008d0 0x6 0x4000 0x0 0x7fec937fa260 0x7fec937fa268 0x7fec8c036080 0x7fec8c036040 0x7fecbda0c000 0x0 0x28 0x7fec8c036020 0x7fecbd9de510 0x0
 0x8c0092b0 0x7fec98ff72d8 0x7fecc482e0d1 0x10206 0x2b000000000033 0x7 0xe 0x5007 0x7fecbda0c000 '
May  4 14:27:58 webseald: Open HA Log file /haErrorLog.txt failed : errno = Permission denied

{noformat}

Previously at 10.0.3 they were given a cumulative fixpack: pkcs11_multiple_ssl_junction_and_URL_macro_is_not_server_relative_fix_10031.fixpack

As best I can tell those should be at 10.0.5

Data is on ecurep: [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012906697&path=TS012906697%2F0-all_data%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012906697&path=TS012906697%2F0-all_data%2F]

GSKIT trace: /ecurep/sf/TS012/906/TS012906697/2023-05-04/isva_10.0.5.0_20230504-144144_zlt13656.enaf.vci.att.com.support_unpack/var/pdweb/fnet/log",,Asha Shivalingaiah,cholt@us.ibm.com,David Hayes,Nick Lloyd,,,,,,,,,,,,5af4ad7d4dd24c579110120b,5b15d994dda5f94d06b985b2,5b232b2fd85e5b59b066f57f,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5057,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012906697,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,,,,AT&T,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012906697&path=TS012906697%2F0-all_data%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1b7zb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-05 22:51:10.696,,,,,"06/May/23 8:51 AM;5b15d94b6256d01ad54eb020;I just took a quick look at this.

From the webseal  msg log:

2023-05-04-14:27:24.800-04:00I----- 0x38AD54BA webseald WARNING wiv ssl SSLConnection.cpp 1121 0x7fec93fff700 -- DPWIV1210W   Function call, gsk_environment_init, failed error: 000001af GSK_ERROR_PKCS11_TOKEN_NOTPRESENT.
2023-05-04-14:27:56.745-04:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 657 0x7f42f8c92700 -- WGAWA0034E   The process, /opt/pdweb/bin/webseald, was terminated by the signal, 11.  The process will be automatically restarted. -- IBM Security Verify Access WebSEAL Version 10.0.5.0 (Build 20221129_1816) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.



The gskit times don’t match so it’s hard  to line up what might be going on when  webseal crashed and any errors in gskit.

Related to the token not present there are a few errors like this:

 GSKException(GSKPKCS11_ERR_TOKEN_LABEL_MISMATCH), in ./pkcs11/src/pkcs11krysignaturealgorithm.cpp[99]:  Token Label invalid.  Token may have been removed.

We’re going to need to get a stack from the core file.  I noticed three of them.","10/May/23 1:35 PM;5b232b2fd85e5b59b066f57f;The trace looks a little different to ISAMSUP-4004; and I’m unable to reproduce the behaviour from ISAMSUP-4004 or the behaviour in this WI at 10.0.5.0. Having said that, the multiple ssl junction fix is not in 10.0.5 so in order to isolate the issue further, I’ll re-build the multiple ssl junction fix fix-pack for 10.0.5. I’ll let you know once available.  ","11/May/23 3:47 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d994dda5f94d06b985b2] - fix-pack for 10.0.5.0_IF1 is available here:- [https://cloudidentity.atlassian.net/browse/ISAMSUP-5057|https://cloudidentity.atlassian.net/browse/ISAMSUP-5057|smart-link] 

Have the customer try this and report back. 

Thanks. ",12/May/23 7:38 AM;5b15d994dda5f94d06b985b2;Customer validated fix,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"Oracle DB ""J2CA0045E jdbc\/config"" connection issues in production cluster setup.",ISAMSUP-5041,297509,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,03/May/23 11:34 PM,14/Jul/23 12:32 AM,14/Jul/23 2:47 PM,,,Support,04/May/23 12:00 AM,0,,,,"Volkswagon, being the customer are seeing ""J2CA0045E  …. jdbc\/config"" Oracle DB connection issues in their production cluster setup. They have 2 Federation servers in Cluster (primary and secondary). Issue is intermittent and issue appears to always happens on the secondary appliance to Config DB. ISVA 10.0.4 + Fixpack IF1 in Production is in use.

Snippet data provided in [https://w3.ibm.com/tools/caseviewer/case/TS012731326|https://w3.ibm.com/tools/caseviewer/case/TS012731326] shows occurrences on 2023-04-13 i.e. 

{{{""type"":""liberty_message"",""host"":""vaf210p017.b2x.vwg"",""ibm_userDir"":""\/opt\/IBM\/wlp\/usr\/"",""ibm_serverName"":""runtime"",""message"":""J2CA0045E: Connection not available while invoking method createOrWaitForConnection for resource jdbc\/config. Timed out waiting for 30,009 millisecond(s) with 263 remaining waiting requests and 50 current total connections used."",""ibm_threadId"":""0001e43d"",""ibm_datetime"":""2023-04-}}

Customers findings and queries concerning these errors are as follows;
~Our Oracle DB Admins are seeing stale stats on several objects on DB side on 'DMAP_ENTRIES' for example:~
~execute dbms_stats.gather_table_stats(ownname => 'ISAMRT', tabname => 'DMAP_ENTRIES', estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE, method_opt => 'FOR ALL COLUMNS SIZE AUTO');~
~execute dbms_stats.gather_index_stats(ownname => 'ISAMRT', indname => 'DMAP_EXPIRY_INDEX', estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE);~
~execute dbms_stats.gather_index_stats(ownname => 'ISAMRT', indname => 'SYS_C0019336', estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE);~

~Furthermore the index is missing for table: USER_ATTRIBUTES_VALUES that's why also SQLTAdvisor recommended creation of this missing index:~
 ~create index indexname on ISAMRT.USER_ATTRIBUTES_VALUES(""VALUES_ID"");~

~We checked the Oracle DB schema files (in dbupdate9.ip) for ISVA but did not see any entry regarding creation or deletion of this missing index mentioned by our Oracle DB team.~
~Is it a normal that this index is missing from the DB?~
~Can the missing index and stale stats can cause similar issues?~

Seeking L3 input, clarification concerning customer findings / queries *_x 2_* i.e. stale stats and missing index.
Customer provided support data files today May 3rd - but L2 not seeing same errors in the runtime message logs available from May 3rd support data.

Customer has the following HVDB and ConfigDB ATP settings;

{{isam_cluster.hvdb.connectionManager.agedTimeout = 180}}
{{isam_cluster.hvdb.connectionManager.reapTime = 90}}
{{isam_cluster.hvdb.properties.blockingReadConnectionTimeout = 30}}
{{isam_cluster.hvdb.connectionManager.connectionTimeout = 20}}
{{isam_cluster.hvdb.connectionManager.maxIdleTime = 100}}
{{isam_cluster.hvdb.connectionManager.minPoolSize = 10}}
{{isam_cluster.hvdb.connectionManager.maxPoolSize = 200}}
{{isam_cluster.hvdb.connectionManager.enableSharingForDirectLookups = false}}

{{isam_cluster.config.connectionManager.enableSharingForDirectLookups = false}}

Seeing the one ConfigDB ATP setting above, should there be more concerning the “ J2CA0045E jdbc\/config “ connection error they have reported? ",,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,13/Jul/23 11:48 PM;ug:0d23f3f4-385c-47fa-b5f8-ecbd0333ad03;Screenshot 2023-07-13 144535.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/211110,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012731326,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,Volkswagen AG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,"isva_10.0.4.0_20230502-171307_vaf09p21.b2x.vwg.support_unpack = 194.114.122.153 = isam_cluster.masters.primary
https://ecurep.mainz.de.ibm.com/ae5/#id=TS012731326&path=TS012731326%2F2023-05-03%2Fisva_10.0.4.0_20230502-171307_vaf09p21.b2x.vwg.support_unpack%2F

isva_10.0.4.0_20230502-173334_vaf210p017.b2x.vwg.support_unpack = 194.114.122.172 (& 10.252.52.120) = isam_cluster.masters.secondary
https://ecurep.mainz.de.ibm.com/ae5/#id=TS012731326&path=TS012731326%2F2023-05-03%2Fisva_10.0.4.0_20230502-173334_vaf210p017.b2x.vwg.support_unpack%2F",,,,,,,,,,,,,,,,,,,,,,,0|i1b4xr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-04 23:22:14.514,,,,,05/May/23 9:22 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020] can you please take the initial look at this customer request. Please let me know if you need any assistance on this. ,"06/May/23 12:11 AM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189]I removed my  other comment because I realized  the comment I had looked at was internal.   

I have started to review this.","06/May/23 1:51 AM;5b15d94b6256d01ad54eb020;I think during an update  we run:

ALTER TABLE USER_ATTRIBUTES_VALUES add primary key (VALUES_ID, VALUE);

When a primary key is created an index on that value is generated. So I think that would take care of it unless that didn’t happen for some reason in their case.

It sounds  like 200 connections  is  enough for them  most of the time since the issue  is intermittent.  A delay with the database would explain why it happens occasionally. 

Does their schema show that primary key?","10/May/23 6:22 PM;6154906364ff01007106e189;Hi [~accountid:5b15d94b6256d01ad54eb020] customer has provided the following update + screen grab i.e.
” _Hi, you can see the existing primary key in attachment -_ [_TS012731326_pk.PNG_|https://ecurep.mainz.de.ibm.com/rest/download/TS012731326/2023-05-10/TS012731326_pk.PNG?fileSize=29630&clientId=ae5] “

Can you review + comment please when you get a chance, as I am seeing “DISABLED + _NOT VALIDATED_ “ status on the primary key.
Should they rerun ALTER TABLE USER_ATTRIBUTES_VALUES add primary key (VALUES_ID, VALUE).","18/May/23 12:57 AM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189]  I’m not a database expert but that doesn’t look right to me.   

when the table is created it adds the UAV_FK! constraint:

CONSTRAINT UAV_FK1 FOREIGN KEY (VALUES_ID) REFERENCES USER_ATTRIBUTES(VALUES_ID) ON DELETE CASCADE

I believe that requires a primary key.  I don’t know why theirs would show as disabled unless they never had one I think they should run:

ALTER TABLE USER_ATTRIBUTES_VALUES add primary key (VALUES_ID, VALUE);",09/Jun/23 2:27 PM;5ac57757d9a96536d1f0daa9;Closing this item as I do not believe that there is any additional information that the L3 team a provide. Setting the items status to “Done”.,"06/Jul/23 7:45 PM;6154906364ff01007106e189;From June 12th, Volkswagen AG mentioned in TS012731326 that they required more time to discuss and review internally.
They have now come back to ask the following, in their best broken English, which I am failing to understand completely i.e.
"" similar DB change: should we the Liberty server reloaded or restarted to recognize the new primary key? ""

Which I assume to mean -> should we have the Liberty server reloaded or restarted to recognize the new primary key? 

[~accountid:5b15d94b6256d01ad54eb020] can you advise on the above please?","12/Jul/23 8:04 PM;6154906364ff01007106e189;Hi [~accountid:5b15d94b6256d01ad54eb020] when you get a chance/minute, can you advise please on customers query concerning; 
“ _should we have the Liberty server reloaded or restarted to recognize the new primary key?_ “",12/Jul/23 11:38 PM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189] No I don’t think you should have to. ,"13/Jul/23 11:48 PM;6154906364ff01007106e189;Hi [~accountid:5b15d94b6256d01ad54eb020] Volkswagen AG update today “ _We tried to add the new primary key but it failed with the following error message: “_

{{ALTER TABLE USER_ATTRIBUTES_VALUES add primary key (VALUES_ID, VALUE)}}

{{Error report -}}

{{ORA-02260: table can have only one primary key}}

{{02260. 00000 - ""table can have only one primary key""}}

{{*Cause: Self-evident.}}

{{*Action: Remove the extra primary key.}}

_“ There are the following primary keys in the table: ”_

{{SYS_C006699 Check ""VALUES_ID"" IS NOT NULL ENABLED NOT DEFERRABLE VALIDATED GENERATED NAME 14-FEB-18}}

{{SYS_C006700 Check ""VALUE"" IS NOT NULL ENABLED NOT DEFERRABLE VALIDATED GENERATED NAME 14-FEB-18}}

{{SYS_C007006 Primary_Key DISABLED NOT DEFERRABLE NOT VALIDATED GENERATED NAME 13-NOV-19}}

{{UAV_FK1 Foreign_Key ISAMRT USER_ATTRIBUTES UA_UK1 CASCADE ENABLED NOT DEFERRABLE VALIDATED USER NAME 14-FEB-18}}

“ _Do you have an idea how to solve it?_ “

----

FWIW, to my untrained eye, the primary keys in the text they have provided above, today July 13th, appear not to correspond to the primary keys provided in a screen grab from May 10th last i.e. [TS012731326_pk.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012731326&path=TS012731326%2F2023-05-10%2F&filepath=TS012731326%2F2023-05-10%2FTS012731326_pk.PNG].

!Screenshot 2023-07-13 144535.png|width=540,height=103!

Appreciate your opinion, plus thoughts re above.","13/Jul/23 11:58 PM;5b15d94b6256d01ad54eb020;I’ll look into it.   Have they made any other changes?  Do we have the DDL  for that table and current indexes?    

This is what we have by default for Oracle.  So they must have changed it at some point. 

ALTER TABLE USER_ATTRIBUTES_VALUES add primary key (VALUES_ID, VALUE);","14/Jul/23 12:32 AM;6154906364ff01007106e189;Thank you, will ask your Q’s.
Again FWIW - on a separate BUT similar sidenote, I came across a similar case in
+_TS012598712 (PC) | ALLSTATE INSURANCE CO | Connections for Config DB maxed out, causing AAC to crash in TPT_+
for the following error appears in TS012731326 (this Jira WI) and in TS012598712.
+_J2CA0045E: Connection not available while invoking method createOrWaitForConnection for resource jdbc/config. Timed out waiting for XY,000 millisecond(s) with xyz remaining waiting requests and xy current total connections used._+
 

It was recommended by Annelise in TS012598712 to add in multiple extra ATP settings for the ConfigDB.
i.e.
isam_cluster.config.properties.blockingReadConnectionTimeout = 30s
isam_cluster.config.connectionManager.maxIdleTime=150s
isam_cluster.config.connectionManager.enableSharingForDirectLookups = false
isam_cluster.config.connectionManager.agedTimeout = 1800s
isam_cluster.config.connectionManager.reapTime = 90s

Curently afaik, Volkswagen AG have only the following ConfigDB ATP setting;
isam_cluster.config.connectionManager.enableSharingForDirectLookups = false",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA Verify Operator Issue - IBM CORP,ISAMSUP-5038,297231,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Cesar Mendoza,62fd292b88b05653fa7d4647,Cesar Mendoza,62fd292b88b05653fa7d4647,03/May/23 2:14 AM,29/Jun/23 2:10 PM,14/Jul/23 2:47 PM,,,Support,,0,,,,"The customer installed and configured the Verify Operator in a kubernetes environment. 

They have noticed a behavior where, when you make a change to a webseal instance junction (say RP1) and save those changes. Two things occur 

1. No popup to apply those changes (like you see in VA and when making a change to a conf file 

2. When you publish this change and the operator picks up the snapshot it restarts all WRP containers. It does not know which instance the change was made on. 



This is a very major problem when you have have 40+ instances and a change to one issues a restart to all. Here is a video to the issue: [https://ibm.box.com/s/gmif718e4kzedz587tif6cahlyoyfyp3|https://ibm.box.com/s/gmif718e4kzedz587tif6cahlyoyfyp3|smart-link]  

This was to be deployed by KeyBank in a production environment but this defect is now a blocker. Containers are 10.0.5.0 IF1 and Operator is latest version.. 23.3 [https://operatorhub.io/operator/ibm-security-verify-access-operator|https://operatorhub.io/operator/ibm-security-verify-access-operator|smart-link] 

Link to Operator [https://github.com/IBM-Security/verify-access-operator|https://github.com/IBM-Security/verify-access-operator|smart-link] ",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5051,,,,,,11/May/23 12:25 AM;62fd292b88b05653fa7d4647;fp-operator-restart.jpg;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200165,11/May/23 12:25 AM;62fd292b88b05653fa7d4647;fp-operator.jpg;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200166,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012865813,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Cesar Mendoza,62fd292b88b05653fa7d4647,,,,IBM CORP,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=2, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":2,""lastUpdated"":""2023-05-18T10:51:16.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":2,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1b39b:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-04 23:13:16.723,,,,,"05/May/23 9:13 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] I am adding this one to your backlog as I believe you have some prior knowledge of the ISVA operator. From the recording that was provided as part of this engagement I believe [~accountid:5ac577577331be74a80d5ab4] has some context as to what is happening here. Can you please work with him early next week once he has returned from his leave. 

[~accountid:5ac577587028785d133fbc46] FYI. ","06/May/23 4:40 PM;5ac577577331be74a80d5ab4;[~accountid:5af4ad7d4dd24c579110120b] For this change, in a docker environment (you definitely don’t want to this is an appliance environment), you want to change the mesa_config module which manages the junctions (I am not sure exactly which one this is) so that the hosting WebSEAL instance is added to the list of instances which needs to be restarted in the AMWADeployMgr class (see the addToRestartList function).  Let me know if you need further information.","09/May/23 10:17 AM;5af4ad7d4dd24c579110120b;<notes>

config_wga_servertask.cpp

#include <mesa/docker.h>
#include <AMWADeployMgr.hpp>

if (is_docker_container()) {
        AMWADeployMgr          deployMgr;
        deployMgr.addToRestartList(wrp_instance,argv[1]);

}","09/May/23 12:30 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:62fd292b88b05653fa7d4647] 

Here is a fixpack, let me know if this works to just start the changed instances -

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5051|https://cloudidentity.atlassian.net/browse/ISAMSUP-5051|smart-link] ","10/May/23 2:37 AM;62fd292b88b05653fa7d4647;[~accountid:5af4ad7d4dd24c579110120b] I have provided the fixpack to the customer, let see how it goes!","11/May/23 12:24 AM;62fd292b88b05653fa7d4647;[~accountid:5af4ad7d4dd24c579110120b]  Customer advised the following:

I tested the fixpack and it didnt seem to work? maybe it was not applied to the operator?

I made a change to instance rp2 junction (Created a new junction) applied and published, and both wrp1/wrp2, runtime and dsc spawned new containers. Basically everything the operator controls.

I also tested updating an existing junction on rp1 and same thing. attaching screenshots.","12/May/23 6:09 AM;62fd292b88b05653fa7d4647;One more thing, the customer uploaded the fixpack to ""shared volume"" --> ""fixpacks"" and upload there, then publish.

Is this the correct way of doing it?","18/May/23 10:34 AM;5af4ad7d4dd24c579110120b;<Notes>

after fixpack on Kubernetes-

{noformat}[isam@isvaconfig-7f44b447c9-5zdzc /]$ cd /var/pdweb/modules/
[isam@isvaconfig-7f44b447c9-5zdzc modules]$ cat restart.conf 

[to-restart]
rp2 = true
{noformat}","18/May/23 11:23 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a3229956ac8efdf194d5cfd9660ce7a7d9ee932c
   * description: ISAMSUP-5038 On docker add instance to restart list for server task
changes

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/526333.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5038) which we publish.","18/May/23 1:41 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a8589d6f8089f21f36bea0e166ed1d62c163eca0
   * description: ISAMSUP-5038 On docker add instance to restart list for server task
changes

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/527607.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5038) which we publish.","24/May/23 1:14 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:62fd292b88b05653fa7d4647] 

I don't have access to view this case - TS012865813 even to check more details/status.

Can you add me /invite to this salesforce case please.

Thanks","25/May/23 2:51 AM;62fd292b88b05653fa7d4647;[~accountid:5af4ad7d4dd24c579110120b] I have changed the product to the case, it had the wrong one, now you should be able to see the case.","25/May/23 10:11 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:62fd292b88b05653fa7d4647] 

I saw the update on case about Robert’s availability.

Can you set up a call next week may be Tuesday/Wednesday 

7PM EST or 8PM EST which ever works.

Thanks","25/May/23 11:03 PM;62fd292b88b05653fa7d4647;[~accountid:5af4ad7d4dd24c579110120b] 

ISVA Verify Operator Issue

Hosted by Cesar Mendoza



[https://ibm.webex.com/ibm/j.php?MTID=mfa9c0887c92de9fd5f665755f2c782d5|https://ibm.webex.com/ibm/j.php?MTID=mfa9c0887c92de9fd5f665755f2c782d5] 

Tuesday, May 30, 2023 7:00 PM | 1 hour | (UTC-04:00) Eastern Time (US & Canada)

Meeting number: 145 128 8246

Password: 6KPfhRPBM25 (65734772 from phones and video systems)","31/May/23 10:20 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5ac577577331be74a80d5ab4] 

I made this change, it creates the restart.conf with the changed instance name set to true.

[https://github.ibm.com/ISAM/isam/commit/a3229956ac8efdf194d5cfd9660ce7a7d9ee932c#diff-0|https://github.ibm.com/ISAM/isam/commit/a3229956ac8efdf194d5cfd9660ce7a7d9ee932c#diff-0]
But when a snapshot is published it still ends up restarting all the rp instances.

Any suggestions on what else do I need to look for to stop all rp’s from restarting.

Thanks","31/May/23 11:07 AM;5ac577577331be74a80d5ab4;[~accountid:5af4ad7d4dd24c579110120b] I would suggest that you try a couple of things:

# Ensure that you are supplying the correct name to the restart.conf file (it can be confusing sometimes between an instance name and a server name).  The best way to do this is to edit the WebSEAL configuration file and then check the name which is added into restart.conf.  This should match the name which is added when you modify a junction.
# Debug config_cfgsvc.cpp.  This is the module which takes the contents of restart.conf and constructs the URL which is used to publish the snapshot.  The instance name should be added as a query string argument to the URL.

You also need to improve the code change to config_wga_servertask.cpp.  At the moment it is going to add a restart for every server task (e.g. ‘junction list’).  You only want to add the restart for server task commands which modify the WebSEAL configuration.","08/Jun/23 5:22 AM;62fd292b88b05653fa7d4647;[~accountid:5af4ad7d4dd24c579110120b] Customer uploaded the requested traces. 

[+2023-05-31/isva_10.0.5.0_20230531-001133_isvaconfig-654cbdb7d4-7t9xx.support+|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012865813&path=TS012865813/2023-05-31/&filepath=TS012865813/2023-05-31/isva_10.0.5.0_20230531-001133_isvaconfig-654cbdb7d4-7t9xx.support]

----

[2023-05-31/isva_10.0.5.0_20230531-001057.414344_isvaconfig-654cbdb7d4-7t9xx.snapshot|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012865813&path=TS012865813/2023-05-31/&filepath=TS012865813/2023-05-31/isva_10.0.5.0_20230531-001057.414344_isvaconfig-654cbdb7d4-7t9xx.snapshot]",13/Jun/23 12:18 PM;5b232b2fd85e5b59b066f57f;@ashashiv - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"14/Jun/23 1:30 PM;5af4ad7d4dd24c579110120b;<My Notes>

All Jenkins. - 

Deploy OpenShift from Jenkins - 

[https://adlcloud.gc.au.ibm.com/isamjenkins/view/AutoTest_Results/job/AutoTest/job/AUTOTEST_OpenShift_Deploy/333/console|https://adlcloud.gc.au.ibm.com/isamjenkins/view/AutoTest_Results/job/AutoTest/job/AUTOTEST_OpenShift_Deploy/333/console]

./oc create -f verify-access-core-template.yaml

[template.template.openshift.io/verify-access-core|http://template.template.openshift.io/verify-access-core] created

./oc create -f sam-core-openshift-template.yaml

Instantiate IBM Verify Access Template in Openshift (changes - user to default from verify access) 
Instantiate the IBM Verify Access Operator by providing the name of the reverse proxy instance 

./oc get projects 
./oc project asha-testproject1 
./oc get pods 

./oc port-forward isamconfig-5cfc6f8fc8-nrgxk 9443


Publish the snapshot 
Upload the snapshot and let the operator know the snapshot exists so it can deploy and manage

sh uploadsnapshotkube.sh isamconfig-5cfc6f8fc8-nrgxk isva_10.0.5.0_published.snapshot 



{noformat}# Upload the snapshot
URL=""$( echo ""$OPERATOR_SECRET"" | jq -cr '.data.url' | base64 -d )""
USER=""$( echo ""$OPERATOR_SECRET"" | jq -cr '.data.user' | base64 -d )""
SECRET=""$( echo ""$OPERATOR_SECRET"" | jq -cr '.data.""rw.pwd""' | base64 -d )""

Difference in URL string is using the query parameter modified to say which instances should the snaopshot be publsihed to
kubectl exec -t $1 -- curl -kv -u $USER:$SECRET -X POST ""$URL/snapshots/$2"" -F file=@/var/shared/snapshots/$2

kubectl exec -t $1 -- curl -kv -u $USER:$SECRET -X POST ""$URL/snapshots/$2?modified=wrp:rp1"" -F file=@/var/shared/snapshots/$2{noformat}

To see the logs from operator - 

./oc logs -f verify-access-operator-controller-manager-d8d9f7584-cnrdq -c manager -n openshift-operators

with our query param - 

{noformat}2023-06-14T02:44:44.855Z	INFO	controllers.IBMSecurityVerifyAccess.SnapshotMgr	Processing a POST	{""Path"": ""/snapshots/isva_10.0.5.0_published.snapshot"", ""Modified"": ""all"", ""Client"": ""10.255.8.17:41668""}
I0614 02:44:46.615797       1 request.go:655] Throttling request took 1.03768849s, request: GET:https://172.31.0.1:443/apis/network.openshift.io/v1?timeout=32s
{noformat}

with query param - 

{noformat}2023-06-14T03:21:35.089Z	INFO	controllers.IBMSecurityVerifyAccess.SnapshotMgr	Processing a POST	{""Path"": ""/snapshots/isva_10.0.5.0_published.snapshot"", ""Modified"": ""wrp:rp1"", ""Client"": ""10.255.8.17:52100""}
I0614 03:21:36.822142       1 request.go:655] Throttling request took 1.015760161s, request: GET:https://172.31.0.1:443/apis/autoscaling.openshift.io/v1beta1?timeout=32s
2023-06-14T03:21:39.990Z	INFO	controllers.IBMSecurityVerifyAccess.SnapshotMgr	Performing a rolling restart of the deployment	{""Deployment.Namespace"": ""asha-testproject1"", ""Deployment.Name{noformat}","14/Jun/23 1:34 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:62fd292b88b05653fa7d4647] 

The difference is with the publish operator - 

By default the operator publish will take modified as all, no query parameters supplied at the end of post URL.

{noformat}kubectl exec -t $1 -- curl -kv -u $USER:$SECRET -X POST ""$URL/snapshots/$2"" -F file=@/var/shared/snapshots/$2{noformat}

In this case if a specific RP instance is targeted then the upload script needs to take care of the changed instance being passed to in the query parameter of the url.

{{POST ""$URL/snapshots/$2?modified=wrp:rp1}}

{noformat}kubectl exec -t $1 -- curl -kv -u $USER:$SECRET -X POST ""$URL/snapshots/$2?modified=wrp:rp1"" -F file=@/var/shared/snapshots/$2{noformat}

Let me know how you go with this.

Thanks","14/Jun/23 2:10 PM;5af4ad7d4dd24c579110120b;<notes>

Without the operator in question - validate - 

cfgsvcRegister - config_cfgsvc.cpp - 

mesa_control snapshotmgr_get_published
isva_10.0.5.0_published.snapshot 

{noformat}     queryArg += (firstLine ? ""&modified="" : "","");{noformat}


cfgsvcPush -->    queryArg += (firstLine ? “&modified=” : “,”);
cfgsvcRegisterWRP  and cfgsvcRegister should read from the restart.conf which I can make the change to add the changed instance…
does the list get appended from the cfgsvcurl 

{noformat} > docker exec -it docker-isam-config-1 bash
mesa_config -ev cfgsvc push /var/shared/snapshots/isva_10.0.5.0_published.snapshot 
 
mesa_config[87283]: Debug: Calculating snapshot command execution order
mesa_config[87283]: Debug: Executing command: 'cfgsvc' 'push' '/var/shared/snapshots/isva_10.0.5.0_published.snapshot' 
mesa_config[87283]: Debug: Pushing: /var/shared/snapshots/isva_10.0.5.0_published.snapshot
mesa_config[87283]: Debug:   full file name: /var/shared/support//var/shared/snapshots/isva_10.0.5.0_published.snapshot
mesa_config[87283]: Debug:   cfgsvc URL: https://isam-conf:9443/shared_volume/support/isva_10.0.5.0_published.snapshot?client=isam-conf
== Info:   Trying 172.19.0.6...
== Info: TCP_NODELAY set
== Info: Connected to isam-conf (172.19.0.6) port 9443 (#0)
== Info: ALPN, offering http/1.1
== Info: successfully set certificate verify locations:
== Info:   CAfile: /etc/pki/tls/certs/ca-bundle.crt
  CA
  
  {noformat}

{noformat}{noformat}","23/Jun/23 1:16 AM;62fd292b88b05653fa7d4647;[~accountid:5af4ad7d4dd24c579110120b] 

Do you want me to validate that information with the customer? or should i tell the customer about the differences on the publish operators?

 ","23/Jun/23 7:36 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:62fd292b88b05653fa7d4647] 

Yes let the customer know about the publish difference.

I am also working on other possibilities, will update the item with my findings.",23/Jun/23 7:41 AM;62fd292b88b05653fa7d4647;Informed the customer about it.,"29/Jun/23 2:10 PM;5af4ad7d4dd24c579110120b;working with Lachlan on this.
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Using basic User and LDAP Password Policy doesn't work as expected,ISAMSUP-5031,296576,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,27/Apr/23 5:22 PM,08/May/23 8:34 AM,14/Jul/23 2:47 PM,08/May/23 2:57 AM,,,,0,,,,"Setting a password police with SDS 8.0.1.17 and using basic user leads to the possibility to reset the password of any user without being logged in. You just need to know the userID. I could verify this behavior in three different environments. If pwdMustChange=True with the policy webSEAL, SCIM API and UserLookupHelper allow to change the password of any new User or any User having a admin PWD Reset with just giving the User ID. You can type in any password to the password field, it's not checked but the change PWD screen is coming up and allowing you to change the password. I've also created a case for SDS with this issue. The ID is TS012831936. Password Policy is uploaded.

[TS012832054 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012832054&path=TS012832054%2F2023-04-24%2F&filepath=TS012832054%2F2023-04-24%2FDok2.docx]

We will need to collect traces while the password reset takes place.

Set the following in the WRP config file to collect LDAP Client trace. This requires a restart:

[system-environment-variables]

LDAP_DEBUG_FILE = ../../../log/trace__webseald-default-ldapc.log.2021-11-04-00-00-00

LDAP_DEBUG = 65535

Once restarted collect the pd.ivc.ira trace component per [https://www.ibm.com/support/pages/enabling-debug-and-snoop-trace-web-gateway-appliance|https://www.ibm.com/support/pages/enabling-debug-and-snoop-trace-web-gateway-appliance].

If possible collect a Fiddler trace [https://www.telerik.com/fiddler|https://www.telerik.com/fiddler|smart-link] . If that is not possible then enable browser debug tools and export a trace from the Network Tab, i.e. .har file. Upload the Fiddler/.har files along with a Support file which contains the ISAM Runtime and the RP instance.

Please note the time of recreate, the exact URL used, client IP, and username used for testing.

If multiple RPs are in use behind a load balancer then collect on all WebSEAL. If possible, remove the load balancer and collect on one or at least have only one RP in rotation at the load balancer.

 

Collecting Support file:

[http://www-01.ibm.com/support/docview.wss?uid=swg21663426|http://www-01.ibm.com/support/docview.wss?uid=swg21663426]

After recreating the issue make sure to disable the trace LDAP Client trace by place a '#' at the start of the line.

Customer upload the support file in Ecurep.

[TS012832054 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012832054&path=TS012832054%2F2023-04-26%2Fisva_10.0.4.0_20230426-185823_isam-rz-man.bvk.int.support_unpack%2F]

Need further advise.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012832054,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,Bayerische Versorgungskammer RZ/BRZ,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1az8n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-27 23:39:53.537,,,,,28/Apr/23 9:39 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] if you can please take a look at this one it would be appreciated.,"28/Apr/23 11:01 AM;5b15d954b0d76456f36daf33;[~accountid:617a5f2cf485cd0068cb98af] have you attempted a local recreate for any of the 3 scenarios described? 

I understand the pwd change via scim or ulh. But can you elaborate on the webseal use case?","02/May/23 8:01 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d954b0d76456f36daf33] Can you please explain in detail the 3 scenarios. Local recreate is not possible that we do not have SDS 8.0.1.13 environment. Customer is asking for below.

webseal handles the pw police by itself with full users it works, but with basic user it doesn‘t. have a look to the referenced SDS case. SDS is working fine definitely! This is an issue of WebSEAL and need to be solved anyway because sds is supported and for basic user the PW police MUST be handled by the LDAP. It’s also documented with the VA documentation that way. On top it’s recommended using basic user. So before you give an answer like that just maybe investigate a bit more. I’ve spend a lot of time to that issue meanwhile so the SDS support did. The issue is documented and you can easily recreate it. Maybe you start at that point. SDS works as expected and documented, no doubt. If you aren’t able to check I also can share my python script with you. But you can also verify using the ibm ldap client as documented by the SDS team in referenced ticket. 

the reference case # TS012831936","03/May/23 1:22 PM;5b15d954b0d76456f36daf33;[~accountid:617a5f2cf485cd0068cb98af] I haven’t provided any answers yet. What answer are they referring to?  

I was asking if you have attempted to recreate the problem locally in your test environment.","03/May/23 5:06 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d954b0d76456f36daf33] I am unable to reproduce it. Also I do not have anywhere the SDS 8.0.1.13 environment. This is an issue of WebSEAL and need to be solved anyway because sds is supported and for basic user the PW police MUST be handled by the LDAP. It’s also documented with the VA documentation that way. On top it’s recommended using basic user.

The issue is with basic user. Setting a password police with SDS 8.0.1.17 and using basic user leads to the possibility to reset the password of any user without being logged in. You just need to know the userID. 

While policy is set to require password reset after admin changed password, VA allows access with ANY password to a valid session. Not even the initial password is checked. You can put in whatever you want and va presents the PW change screen. You than could change the password to any password compliant to the policy. After having done va creates a valid session. Also the pwdReset attribute is not deleted or set to false what even after the user was logged out e. G. by pkmslogout you can get a session with the same process again and again. THIS IS A VERY SERIOUS SECURITY ISSUE","04/May/23 7:38 PM;5b15d954b0d76456f36daf33;I made an attempt at recreating the customer’s problem, but so far without success. But we are continuing to work on it. 

Thank Jens for the detailed steps in the document sent with the case. It was helpful in understanding the issue. If Jens thinks it’ll be useful for us to get on a webex to speed up the investigation and resolution, I’m happy to do it on Friday (05/05)

----

** Internal **

[~accountid:617a5f2cf485cd0068cb98af] Jens is quite experienced, especially with our product. If you are in doubt, it is better to have a chat with some of the senior L2 engineers if your updates in the case will address his concerns.

Customer’s environment is ISVA 10.0.4.0 + SDS  8.0.1.17. You have set it as 10.0.3.0 in this item and mentioned SDS 8.0.1.13. It is important for us to document it accurately. Especially when we have to recreate a similar environment.

Secondly, SDS is an IBM product. It is available from the internal software downloads for us to use. Doing preliminary investigation as L2 on any problem is important so that L3 won’t have to do things from scratch. 

What is being described in the case sounds similar to an old SDS problem mentioned here : [https://www.ibm.com/mysupport/s/defect/aCI3p000000CsrA/dt204275?language=en_US|https://www.ibm.com/mysupport/s/defect/aCI3p000000CsrA/dt204275?language=en_US|smart-link] 

But if SDS support have ruled this out as the cause, then we can move past that. However, if you want to confirm with SDS support about this internally,  see if our wider L2 team has any contacts.","05/May/23 4:36 PM;5b15d954b0d76456f36daf33;[~accountid:617a5f2cf485cd0068cb98af] Nick made a suggestion in the case to overcome the problem. Can you check what the customer’s feedback is?

Also it looks like Jens said he is ok to have a call, but I haven’t seen anything in my calendar. Can you coordinate one either for later tonight or first thing Monday?","08/May/23 2:57 AM;5b15d9e6dda5f94d06b985b4;Resolved using change to SDS,

{{dn: cn=Front End, cn=Configuration changetype: modify add: ibm-slapdSetenv ibm-slapdSetenv: IDS_NEW_PASSWORD_POLICY=YES}}

and update to ldap.conf

[ldap]

bind-auth-and-pwdchg = yes



From customer:
Works also at live environment. Thanks again! The case can be closed.",08/May/23 8:34 AM;5b15d954b0d76456f36daf33;Thanks [~accountid:5b15d9e6dda5f94d06b985b4] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
JWT ENCRYPTION ALGORITHMS CANNOT BE DECRYPTED v10.0.5.0,ISAMSUP-5026,296190,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,25/Apr/23 9:17 PM,26/Apr/23 11:21 PM,14/Jul/23 2:47 PM,26/Apr/23 11:21 PM,,,25/Apr/23 12:00 AM,0,,,,"Customer is having issue after upgrading to ISVA v10.0.5_IF1 they encountered the same problem trying to decrypt the JWT token.

This is the follow-up of case TS006964268 and Jira [https://cloudidentity.atlassian.net/browse/ISAMSUP-3576|https://cloudidentity.atlassian.net/browse/ISAMSUP-3576|smart-link]  (JWT encrypted issued by ISAM 9.0.7.0 could not be decrypted) where the fixpack was provided (jwt_aes_payload_encrypt_9072IF3)

The APAR IJ35920 ([https://www.ibm.com/support/pages/apar/IJ35920|https://www.ibm.com/support/pages/apar/IJ35920]) should have been fixed in v10.0.4 as described here: [https://www.ibm.com/support/pages/node/6584974|https://www.ibm.com/support/pages/node/6584974] but the error is still there.

Do we have fix pack in ISVA v10.0.5.0 and Customer is asking whether they can apply the sam fix provided in ISAM 9.0.7.2_IF3",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,26/Apr/23 9:15 AM;ashashiv;image-20230425-231422.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197899,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012800771,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,BPER BANCA SPA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1awuv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-25 14:56:31.137,,,,,"26/Apr/23 12:56 AM;5b15d94b6256d01ad54eb020;No you cannot apply a 907 fix pack on 10.0.5.

Looking at the fix for that APAR, I think it needs to be configured.  Have you reviewed their configuration? ","26/Apr/23 9:15 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] 

That fix is included in 10040 so any version after that should have the changes.

This change included a configuration flag - Have they configured this? 

!image-20230425-231422.png|width=665,height=626!",26/Apr/23 5:43 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] let me check with the customer on JWT Signing options. Thank you,"26/Apr/23 11:20 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 

Changes in the configuration flag resolved the issued. Thank you",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA 10.0.5 Remote Syslog Forwarding is not sending audit logs,ISAMSUP-5025,296165,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,25/Apr/23 5:54 PM,22/May/23 10:04 AM,14/Jul/23 2:47 PM,22/May/23 10:04 AM,,Support,,0,,,,"We have a problem with ISVA 10.0.5. We have configured Remote Syslog Forwarding with TCP, tls to remote Syslog server. Unfortunately when we have Runtime Audit as a source ISVA is sending nothing. This is not related to network connectivity or certificates, because when the source is set to Runtime Trace, there is a lot of data sent to remote Syslog. Of course we are generating some events which are visible in log files under Federation->Auditing->audit.log. I have tried many options regarding the facility and severity but nothing helped.

Example entries which we would like to be sent to remote syslog:

1229      Apr 11 15:47:55 localhost  2023-04-11T15:47:55.538+0200 [PMSL-QYOIAMAE02.APP.HP.IBMIAMAAS.NET|http://PMSL-QYOIAMAE02.APP.HP.IBMIAMAAS.NET] ISVA 1378 - - {""CommonBaseEvent"":{""version"":""1.1"",""globalInstanceId"":""FIM7092b5110187191abb30eb1d950b4"",""sequenceNumber"":""777"",""creationTime"":""2023-04-11T13:47:55.537Z"",""extensionName"":""IBM_SECURITY_AUTHN"",""situation"":{""categoryName"":""ReportSituation"",""situationType"":{""xsi_ns-sep_type"":""ReportSituation"",""reportCategory"":""SECURITY"",""reasoningScope"":""INTERNAL""}},""contextDataElements"":{""name"":""Security Event Factory"",""type"":""eventTrailId"",""contextId"":""FIM_7092b4c401871bd9a39aeb1d950b418d+204226228""},""sourceComponentId"":{""executionEnvironment"":""Linux[amd64]#4.18.0-372.26.1.el8.ibm.1.x86_64"",""componentType"":""[http://www.ibm.com/namespaces/autonomic/Tivoli_componentTypes"",""subComponent"":""com.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils"",""threadId"":""Default|http://www.ibm.com/namespaces/autonomic/Tivoli_componentTypes"",""subComponent"":""com.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils"",""threadId"":""Default] Executor-thread-4656"",""componentIdType"":""ProductName"",""application"":""IBM Security Verify Access"",""locationType"":""FQHostname"",""component"":""Authentication and Federated Identity"",""location"":""[pmsl-qyoiamae02.app.hp.ibmiamaas.net|http://pmsl-qyoiamae02.app.hp.ibmiamaas.net]""},""extendedDataElements"":{""EventName"":""JavaScriptEvent"",""Username"":"""",""Outcome"":""SUCCESSFUL"",""Message"":""{\""name\"":\""ISVA_CUSTOM_EVENT\"",\""module\"":\""OIDC\"",\""status\"":\""success\"",\""eventType\"":\""id_token\"",\""clientID\"":\""WHIw49JApFFx2zfIrQ48\"",\""targetApplication\"":\""Snow\"",\""userName\"":\""80000169528\"",\""idToken\"":{\""rt_hash\"":\""oufDeIFUtjrrEQh-NRo0gw\"",\""security_level\"":\""Level3\"",\""amr\"":[\""MFA\""],\""iat\"":1681220875,\""iss\"":\""[https://snow-uat.helseplattformen.no|https://snow-uat.helseplattformen.no]\"",\""at_hash\"":\""5fIzE3qGtVROKfxjUgWY8w\"",\""sub\"":\""80000169528\"",\""exp\"":1681224475,\""pid\"":\""80000169528\"",\""acr\"":\""n/a\"",\""aud\"":\""WHIw49JApFFx2zfIrQ48\""}}"",""progName"":""Not Available"",""authnProvider"":""Not Available"",""partner"":""Not Available"",""trustRelationship"":""Not Available"",""userInfoList"":{},""authnType"":""authenticationService"",""action"":""validate"",""tokenType"":""Not Available"",""authnScope"":""Not Available"",""outcome"":{""result"":""SUCCESSFUL"",""majorStatus"":0}}}}

============================





This is the issue:

Apr 12 16:43:32 rsyslogd: imfile: on startup file '/opt/ibm/wlp/usr/servers/runtime/logs/audit.log' does not exist but is configured in static file monitor - this may indicate a misconfiguration. If the file appears at a later time, it will automatically be processed. Reason: No such file or directory [v8.2102.0-7.el8.1.ibm.1]

However, the file is written to:

/var/mga/audit/audit.log",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5032,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012699044,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,HELSEPLATTFORMEN AS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012699044&path=TS012699044/2023-04-11/&filepath=TS012699044/2023-04-11/isva_10.0.5.0_20230411-163411_PMSL-QYOIAMAE02.APP.HP.IBMIAMAAS.NET.support,,,,,,,,,,,,,,,,,,,,,,,0|i1awpb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-25 16:00:39.523,,,,,"26/Apr/23 2:00 AM;5b15d94b6256d01ad54eb020;Did you notice all of the errors  in /var/log/messages?   There are a lot.

This one in particular stands out regarding the clients configuration.  Since they are trying to forward runtime audit logs.

“Apr 11 16:16:15 rsyslogd: imfile: on startup file '/opt/ibm/wlp/usr/servers/runtime/logs/audit.log' does not exist but is configured in static file monitor - this may indicate a misconfiguration. If the file appears at a later time, it will automatically be processed. Reason: No such file or directory [v8.2102.0-7.el8.1.ibm.1]”



This looks like the same issue as  [https://cloudidentity.atlassian.net/browse/ISAMSUP-4912|https://cloudidentity.atlassian.net/browse/ISAMSUP-4912|smart-link]   Which is fixed in the next release.",26/Apr/23 8:38 AM;5b15d954b0d76456f36daf33;I think this is a duplicate of ISAMSUP-4912 ,26/Apr/23 8:38 PM;61409dc154762c006932ffc7;[~accountid:5b15d954b0d76456f36daf33] so is this fixed with [10.0.5.0-ISS-ISVA-IF0001 |https://www.ibm.com/support/fixcentral/swg/doSelectFixes?options.selectedFixes=10.0.5.0-ISS-ISVA-IF0001&continue=1],"27/Apr/23 9:36 AM;5b15d954b0d76456f36daf33;Like [https://cloudidentity.atlassian.net/browse/ISAMSUP-4912|https://cloudidentity.atlassian.net/browse/ISAMSUP-4912|smart-link] noted, the fix is in 10.0.6.0","27/Apr/23 7:20 PM;61409dc154762c006932ffc7;[~accountid:5b15d954b0d76456f36daf33] the client needs interim fix for them, to avoid waiting time for new release.","28/Apr/23 8:11 AM;5b15d954b0d76456f36daf33;If they need a personal fixpack, they should first be at least at 10.0.5.0_IF1. I’ll build one on top of that.","28/Apr/23 2:09 PM;5b15d954b0d76456f36daf33;[~accountid:61409dc154762c006932ffc7] linked item [https://cloudidentity.atlassian.net/browse/ISAMSUP-5032|https://cloudidentity.atlassian.net/browse/ISAMSUP-5032|smart-link] has the fixpack. 

Have them try it and let me know how it goes.",22/May/23 10:04 AM;5b15d954b0d76456f36daf33;Case closed.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Error: Could not apply snapshot file V10.0.1,ISAMSUP-5004,295889,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,22/Apr/23 12:25 AM,12/Jul/23 8:44 PM,14/Jul/23 2:47 PM,,,,,0,,,,"The customer cannot apply snapshot successfully on *one* appliance. Other appliance where we have tested instead are working.

They are testing to snapshot with clear_snapshot_keys.fixpack for disaster recover plan. They created a snapshot from the appliance and applied it back to the original appliance. 

Nick and Reagan are helping. At the begining they found out that there are too many temp files within the appliance so they suggested to clear it first. So the customer did this. However the issue remains.

Nick suggested the customer install another fix pack snapshot_apply_fix_10010.fixpack. It works for all appliances except one appliance . 

Here are the steps the customer performed:

Steps in detail:

# Create a new snapshot.
# Install snapshot_apply_fix_10010.fixpack
# Set debug.level 2
# Apply newly created snapshot via LMI ( this was now succussful due to snapshot_apply_fix_10010.fixpack )
# disable debug.level 2
# Create support file

Apr 20 09:52:46 mesa_config[13703]: Debug: SnapshotFileInstall: targetDir=/tmp/tmp.q5hnKN fileBaseDir=/ file=opt/ibm/lmt/work

Apr 20 09:52:46 mesa_config[13703]: *Error: Snapshot file copy was not successful. Return code 1*
Apr 20 09:52:46 mesa_config[13703]: Error: Could not backup system state prior to snapshot application.
Apr 20 09:52:46 mesa_config[13703]: Error: Could not backup existing system files.
Apr 20 09:52:46 mesa_config[13703]: Invoking Snapshot Post functions
Apr 20 09:52:46 mesa_config[13703]: Debug: Running snapshot post command for [wga.web|http://wga.web] component
Apr 20 09:52:46 mesa_config[13703]: WGAWA0667I:: WGA_events:: |1=tpp_registration,2=admin|
Apr 20 09:52:46 mesa_config[13703]: WGAWA0667I:: WGA_events:: |1=opsca,2=admin|
Apr 20 09:52:46 mesa_config[13703]: WGAWA0667I:: WGA_events:: |1=ftnidp_hty,2=admin|
Apr 20 09:52:46 mesa_config[13703]: WGAWA0667I:: WGA_events:: |1=saavutettava_hty,2=admin|
Apr 20 09:52:46 mesa_config[13703]: WGAWA0667I:: WGA_events:: |1=sdtest01,2=admin|
Apr 20 09:52:46 mesa_config[13703]: WGAWA0667I:: WGA_events:: |1=sdtest01_hty,2=admin|
Apr 20 09:52:46 mesa_config[13703]: WGAWA0667I:: WGA_events:: |1=secure_sdtest01,2=admin|
Apr 20 09:52:46 mesa_config[13703]: WGAWA0667I:: WGA_events:: |1=lvasftnidp,2=admin|
Apr 20 09:52:46 mesa_config[13703]: WGAWA0667I:: WGA_events:: |1=www00xkubhty,2=admin|
Apr 20 09:52:46 mesa_config[13703]: Debug: Instance is not running",,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012653566 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1av2f:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-04-23 22:39:28.123,,,,,24/Apr/23 8:39 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9517dab4c51f61b5190] Assigning this item to you for review. Its interesting that the customer seems to be indicating that they only have one system that is reporting this problem. [~accountid:6092aca0f0db130069d19687] just a quick check did we check if there was any hard-drive space issues on this system? ,"24/Apr/23 11:19 AM;5b15d9517dab4c51f61b5190;disk space is not an issue

{noformat}Filesystem                Size      Used Available Use% Mounted on
/dev/sda6               244.9G     13.1G    219.4G   6% /
{noformat}","24/Apr/23 1:24 PM;5b15d9517dab4c51f61b5190;{noformat}Apr 20 09:52:24 mesa_config[13703]: Debug: StageSnapshot(/var/support/isva_10.0.1.0_20230420-094404.823314_5OGBLTIAMAP01.snapshot)
Apr 20 09:52:24 mesa_config[13703]: Debug: Staging snapshot /var/support/isva_10.0.1.0_20230420-094404.823314_5OGBLTIAMAP01.snapshot to temporary directory /tmp/tmp.IXYSO9
Apr 20 09:52:29 mesa_config[14223]: Debug: Resolving observers
Apr 20 09:52:29 mesa_config[14223]: Debug: Resolving dependencies
Apr 20 09:52:29 mesa_config[14223]: Debug: Calculating commit order
Apr 20 09:52:29 mesa_config[14223]: Debug: Calculating snapshot command execution order
Apr 20 09:52:29 mesa_config[14223]: Debug: Executing command: 'wga.rte' 'status' 
Apr 20 09:52:29 mesa_config[14223]: Debug: Removing temporary file /tmp/tmp.8fbTMn
Apr 20 09:52:31 mesa_config[13703]: Debug: PopulateSnapshotList(/tmp/tmp.IXYSO9/var/www/lmi/datastore/state/configured)
...
Apr 20 09:52:31 mesa_config[13703]: Debug: PopulateSnapshotList(/opt/ibm/lmt/work)
Apr 20 09:52:31 mesa_config[13703]: Debug: Backup existing: SnapshotFileBackup(/tmp/tmp.q5hnKN)
Apr 20 09:52:31 mesa_config[13703]: Debug: Backing up system files to /tmp/tmp.q5hnKN
Apr 20 09:52:31 mesa_config[13703]: Debug: Copying files from / to /tmp/tmp.q5hnKN
Apr 20 09:52:31 mesa_config[13703]: Debug: Command is cd / && cpio -pud '/tmp/tmp.q5hnKN' >> /var/log/snapshot.log 2>&1
Apr 20 09:52:31 mesa_config[13703]: Debug: SnapshotFileInstall: targetDir=/tmp/tmp.q5hnKN fileBaseDir=/ file=var/www/lmi/datastore/state/configured

Apr 20 09:52:31 mesa_config[13703]: Debug: SnapshotFileInstall: targetDir=/tmp/tmp.q5hnKN fileBaseDir=/ file=var/www/lmi/datastore/state/sla_accepted
…
Apr 20 09:52:46 mesa_config[13703]: Debug: SnapshotFileInstall: targetDir=/tmp/tmp.q5hnKN fileBaseDir=/ file=opt/ibm/lmt/work{noformat}



The following line is reporting that the above command existed abnormally

Apr 20 09:52:46 mesa_config[13703]: Error: Snapshot file copy was not successful. Return code 1

/var/log/snapshot.log Contents

{noformat}cpio: unsupported cpio format, use newc or crc
cpio: write error: Broken pipe
{noformat}

It looks like it may have hit a timeout when backing up

as it is at the end of the list of files to backup that comes from the PopulateSnapshotList

total command time for the {{mesa_config[13703]}} is over 30 seconds (which is the default command timeout value)

The working case (without debug) in the Apr 21 support file is around 5 seconds

Can you try setting the advanced tuning parameter wga.cmd.timeout=300

And retrying applying the snapshot",24/Apr/23 5:06 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] Thanks for quick respond !! I will ask the customer to try to change the ATP. 👍 ,24/Apr/23 11:54 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] The customer changed the ATP. It is still now working.,"27/Apr/23 5:15 PM;5b15d9517dab4c51f61b5190;Is that a typeo 

Is it *now* working or is it *not* working

If it is not working can we get another support file","27/Apr/23 6:08 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] It is still not working. I will get the support file.

Thanks. ","04/May/23 6:45 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] The customer said “Currently I can't apply snapshot during business hours as it has been noticed causing issues in the system ( sometimes webseal instances may crash and some of the instances ""drop"" to inconsistent state where those can not be started or stopped ). Therefore I need to find maintenance window for my testing and at the moment I don't know when testing is possible.”",09/May/23 9:35 PM;5b232b2fd85e5b59b066f57f;@phorner - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,22/May/23 5:03 PM;6092aca0f0db130069d19687;[~accountid:5b232b2fd85e5b59b066f57f] I will chase the customer about it and let Peter know it.,22/May/23 5:47 PM;6092aca0f0db130069d19687;[~accountid:5b232b2fd85e5b59b066f57f] and [~accountid:5b15d9517dab4c51f61b5190] the customer said: “ Currently case TS009849020 is taking priority. I will have to get back to this case once we have test results to deliver for TS009849020.”,"07/Jun/23 12:28 AM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] The customer provided us with the latest support file (tested with wga.cmd.timeout=300).

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012653566&path=TS012653566%2F2023-06-06%2F&filepath=TS012653566%2F2023-06-06%2Fisva_10.0.1.0_20230606-165114_5OGBLTIAMAP01.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012653566&path=TS012653566%2F2023-06-06%2F&filepath=TS012653566%2F2023-06-06%2Fisva_10.0.1.0_20230606-165114_5OGBLTIAMAP01.support]","08/Jun/23 4:06 PM;5b15d954b0d76456f36daf33;Given this is occurring on only one appliance and based on the specific error in {{snapshot.log}}  file, it looks like we are encountering a file size issue. 

Do we have a copy of the snapshot they are trying to apply? 

I noticed in the last support file that they have a fair few reverse proxy instances and a number of rolled over request log files. Are they able to clean those up and then create a new snapshot and try applying it?

The outcome of that might determine the next best course of action for addressing this.","26/Jun/23 11:46 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] The customer uploaded the snapshot file (123MB) for checking.

/ecurep/sf/TS012/653/TS012653566/2023-06-26/isva_10.0.1.0_20230606-161737.727215_5OGBLTIAMAP01.snapshot",07/Jul/23 8:43 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] The customer said “I have not cleaned rolled-over request log files. Number of rolled over request log files is limited to 5 files on every instance. It is same for other similar appliance which runs webseal instances in this test environment. Applying snapshot on other webseal appliance is working.”,12/Jul/23 8:44 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] is there any update?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Federation/SAML Partner Quick Connectors instructions failing/missing,ISAMSUP-4995,295654,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,20/Apr/23 9:04 PM,12/May/23 10:33 AM,14/Jul/23 2:47 PM,12/May/23 10:33 AM,,,03/Apr/23 12:00 AM,0,,,,"This case issue has been raised by IBM Security Expert Labs Specialist [Richárd Lennert|https://w3.ibm.com/#/people/ZZ0165740] i.e.

----

_I'm trying to set up the SAML quick connectors on 10.0.5_IF1, I downloaded the latest ones from here:_
_IBM Security Verify Access Extension for SAML Connectors_
[https://exchange.xforce.ibmcloud.com/hub/extension/6068493b483fa21ba525cb380db8a376?_ga=2.253760776.185630351.1627271401-2082810928.1623031385|https://exchange.xforce.ibmcloud.com/hub/extension/6068493b483fa21ba525cb380db8a376?_ga=2.253760776.185630351.1627271401-2082810928.1623031385|smart-link] 

_The installation ends in an error on the UI, and looking at the LMI's trace.log I could see messages like these repeating until I rebooted the appliance:_

{{[4/18/23, 14:14:13:728 CEST] 0000020e id=00000000 com.ibm.ws.webcontainer.servlet.ServletWrapper               E init SRVE0319E: For the [ConnectorInstructions] servlet, com.ibm.isam.mga.federation.connectors.ConnectorInstructions servlet class was found, but a resource injection failure has occurred. java.lang.reflect.InvocationTargetException}}

_After the reboot the Partner Templates page shows the package as installed and I can use them when creating SAML partners too._
_But if I try to open the instructions for a connector when I select it from the list I get a_ [_404 in the popup_|https://ecurep.mainz.de.ibm.com/rest/download/TS012788202/2023-04-19/partner_from_template.png?fileSize=271481&clientId=ae5]_, and the same error as before in the LMI's trace.log._
_I'll attach a_ [_support file_|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012788202&path=TS012788202%2F2023-04-19%2Fisva_10.0.5.0_20230419-112218_m.idp.mmfa.ibm.com.support_unpack%2F] _from the affected appliance as well._
_Is this a known issue? Can it be fixed somehow?_

----

EMEA L2 unable to get a recreate completed on this issue, still trying. Afaik, no similar occurrences of the error reported are found in past cases. Seeking assistance here please.",,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012788202,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,IBM SWG Pre Sales,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,"Support File = https://ecurep.mainz.de.ibm.com/ae5/#id=TS012788202&path=TS012788202%2F2023-04-19%2Fisva_10.0.5.0_20230419-112218_m.idp.mmfa.ibm.com.support_unpack%2F

404 Pop Up Error = https://ecurep.mainz.de.ibm.com/rest/download/TS012788202/2023-04-19/partner_from_template.png?fileSize=271481&clientId=ae5",,,,,,,,,Linux 86_64,,,,,,,,,,,,,,0|i1atqn:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-02 04:03:19.913,,,,,"02/May/23 2:03 PM;5af4ad7d4dd24c579110120b;<notes>

{noformat}Stack Dump = java.lang.ClassNotFoundException: com.sun.tools.attach.VirtualMachine
	at java.base/java.lang.Class.forNameImpl(Native Method)
	at java.base/java.lang.Class.forName(Unknown Source)
	at com.ibm.ws.jmx.connector.local.LocalConnectorActivator$LocalConnectorHelper$1.run(LocalConnectorActivator.java:124)
	at com.ibm.ws.jmx.connector.local.LocalConnectorActivator$LocalConnectorHelper$1.run(LocalConnectorActivator.java:60)
	at java.base/java.security.AccessController.doPrivileged(Unknown Source)
	at com.ibm.ws.jmx.connector.local.LocalConnectorActivator$LocalConnectorHelper.initConnectorAddress(LocalConnectorActivator.java:60)
	at com.ibm.ws.jmx.connector.local.LocalConnectorActivator$LocalConnectorHelper.<clinit>(LocalConnectorActivator.java:50)
	at com.ibm.ws.jmx.connector.local.LocalConnectorActivator.createJmxAddressResource(LocalConnectorActivator.java:212)
	at com.ibm.ws.jmx.connector.local.LocalConnectorActivator.createJMXWorkAreaResource(LocalConnectorActivator.java:204)
	at com.ibm.ws.jmx.connector.local.LocalConnectorActivator.<init>(LocalConnectorActivator.java:161)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
	at java.base/java.lang.reflect.Constructor.newInstance(Unknown Source)
	at org.apache.felix.scr.impl.inject.internal.ComponentConstructorImpl.newInstance(ComponentConstructorImpl.java:316){noformat}



Not IF1 specific…

can see errors related to on 10050

{noformat}                I CWWKO0219I: TCP Channel defaultHttpEndpoint-ssl has been started and is now listening for requests on host localhost  (IPv4: 127.0.0.1) port 9443.
[5/2/23, 13:55:54:216 AEST] 00000028 id=00000000 com.ibm.ws.logging.internal.impl.IncidentImpl                I FFDC1015I: An FFDC Incident has been created: ""java.lang.ClassNotFoundException: com.sun.tools.attach.VirtualMachine com.ibm.ws.jmx.connector.local.LocalConnectorActivator$LocalConnectorHelper$1 139"" at ffdc_23.05.02_13.55.54.0.log
[5/2/23, 13:55:54:218 AEST] 00000028 id=00000000 com.ibm.ws.logging.internal.impl.IncidentImpl                I FFDC1015I: An FFDC Incident has been created: ""java.lang.ClassNotFoundException: com.sun.tools.attach.VirtualMachine com.ibm.ws.jmx.connector.local.LocalConnectorActivator$LocalConnectorHelper$1 localConnectorInit"" at ffdc_23.05.02_13.55.54.1.log
[5/2/23, 13:55:54:237 AEST] 00000028 id=00000000 com.ibm.ws.kernel.feature.internal.FeatureManager            A CWWKF0015I: The server has the following interim fixes active in the runtime: PH46816. For a full listing of installed fixes run: productInfo version --ifixes
[5/2/23, 13:55:54:239 AEST] 00000028 id=00000000 com.ibm.ws.kernel.feature.internal.FeatureManager{noformat}","02/May/23 2:07 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:6154906364ff01007106e189] 

Can you add this advanced tuning parameters -

key: lmi.jvm_option

value: {{-Dcom.ibm.tools.attach.enable=yes}}

and 

key:runtime.jvm_option

value: {{-Dcom.ibm.tools.attach.enable=yes}}

Restart LMI

And check If there is a difference.

A few other clarifications if it doesnt work-

# Was this observed on 10050 or 10050IF1?
# Was this working on a version before this - of yes which version?
# In LMI tracing can you enable _=config=enabled:com.ibm.isam._=ALL:com.ibm.mesa.*=ALL and get the trace file","05/May/23 7:40 PM;6154906364ff01007106e189;[~accountid:5af4ad7d4dd24c579110120b] as per IBM Security Expert Labs Specialist [Richárd Lennert|https://w3.ibm.com/#/people/ZZ0165740] i.e.
” _The last time I used these templates was with ISAM version 9.0.7 (IIRC), with an older version of the templates. I had no trouble back then. I started testing this version with IF1 already installed, I don't know if it would work with 10.0.5. On the inactive partition of the appliance I have version 10.0.4 available, I switched back to it and recreated the problem with the exact same results._ ""

May 5th Support Files for [10.0.4|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012788202&path=TS012788202%2F2023-05-05%2Fisva_10.0.4.0_20230505-101148_m.idp.mmfa.ibm.com.support_unpack%2F] and [10.0.5|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012788202&path=TS012788202%2F2023-05-05%2Fisva_10.0.5.0_20230505-101644_m.idp.mmfa.ibm.com.support_unpack%2F] provided by customer now available in EcuRep.","07/May/23 11:02 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6154906364ff01007106e189] 

Was there any change after setting the advanced tuning configuration parameter?

Can you send me the steps you tried to use the connector and which template did you use to create the fed/partner   after you installed the templates pkg.","11/May/23 6:59 PM;6154906364ff01007106e189;Hi [~accountid:5af4ad7d4dd24c579110120b] , the client (IBM Labs) has provided the following information in [https://w3.ibm.com/tools/caseviewer/case/TS012788202|https://w3.ibm.com/tools/caseviewer/case/TS012788202] i.e.

_There was no change after setting the ATP. These were the steps I used to recreate the problem:_

# _Create a SAML 2.0 Federation with the Quick Connect template (the rest of the settings are irrelevant, just set what you can)_
# _In this federation add a Partner_
# _In the first screen of the ""Create New Partner"" wizard select one of the templates from the table, it doesn't matter which one._
# _I tried with GitHub, Secret Server, ADFS and a couple of others, all of them show the same problem._
# _With a template selected click the ""Instructions"" button, you should see a popup, where the documentation of the template should be displayed, instead you'll see a 404 Not Found._

Screen grabs related to above steps are uploaded and available in EcuRep folder --> [2023-05-11|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012788202&path=TS012788202%2F2023-05-11%2F]

ISVA L2 cannot replicate the issue. From clients instructions above - the instructions pop-up is working as per this [screen-grab|https://ecurep.mainz.de.ibm.com/rest/download/TS012788202/support_files/ISVAL2_Test_Partner_TS012788202.png?fileSize=112659&clientId=ae5].
Any ideas, or best next steps to assist further greatly appreciated","11/May/23 8:16 PM;6154906364ff01007106e189;Post my update regarding not being able to replicate the issue, client has added;
"" there's one thing that might be different between your environment and mine, my appliances were originally installed at version 9 a few years ago now (IIRC v9.0.3 was the initial version, but I'm not sure anymore), and were continuously upgraded as new versions were released. I don't know if this has an impact, the error hints at some incompatibility with a Java class, and ISVA switched IBM JDK to OpenJDK with version 10.0.3, so this could be the source somehow, just a wild guess. ""","11/May/23 8:19 PM;5af4ad7d4dd24c579110120b;[~accountid:6154906364ff01007106e189] 

can you arrange for a web ex with the customer next week

","11/May/23 8:50 PM;6154906364ff01007106e189;[~accountid:5af4ad7d4dd24c579110120b] No problem please advise best day next week and time. 
I am Dublin = UTC +1
Client is Budapest = UTC +2
You afaik are AEST = UTC +10
The earliest best (Dublin) time for me is 08:00 onwards.","11/May/23 11:46 PM;6154906364ff01007106e189;Hi [~accountid:5af4ad7d4dd24c579110120b] client has just updated with the following; 

"" _I tried reproducing this issue in a fresh(er) environment that I have, it's docker-based originally installed at version 10.0.4, now upgraded to 10.0.5_IF1. Here everything is working as expected, the templates install without problem and after the LMI restarts I can see the instructions as well. It seems this problem only affects deployments upgraded from older versions. Originally I opened this case because I ran into this problem while preparing for a customer project. Their ISVA deployment is fresh (version 10.0.5), so based on our observations it's highly likely that they will not be affected by this. I can live with this issue in my sandbox environments as long as have at least one where I can read the docs - which it seems I have right now. From my side we can close the case at this point, if the customer ends up being affected by this I can open a new case referencing this one._""

BUT has also said ""_Of course if you'd like to investigate further I'd be happy to help._""
Do you want to troubleshoot further? Or do you wish close? I am the latter i.e. closure, let me know if you are same, thanks and best.","12/May/23 10:33 AM;5af4ad7d4dd24c579110120b;[~accountid:6154906364ff01007106e189] 

Thanks for the update.

I am ok for this to be closed for now.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
WEB EXCEPTION CAUGHT: Error not handled in ISAM9,ISAMSUP-4994,295634,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Motiur Rahman,5b15d9e581c3df12acf53c4a,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,20/Apr/23 6:16 PM,15/Jun/23 4:19 AM,14/Jul/23 2:47 PM,,,,,0,,,,"Customer is looking for the root cause:

We have migrated one of the WebSEAL authentication clusters from ISAM7 --> ISAM9. Post the cutover, one of the applications reported an issue which is a pop up presented to users whilst they are using the app as BAU. Screenshot of pop up is attached to case.

WebSEAL logs (in both ISAM7 & ISAM9) shows this entry which is suspected to be creating the stated issue:

ISAM7 - 19/Apr/2023:12:28:01 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT : Error  ['document_onclick' is undefined], Line [1152] , URL [[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet]] HTTP/1.1"" 200 122

ISAM9 - 18/Apr/2023:13:07:45 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT : Error  ['document_onclick' is undefined], Line [1152] , URL [[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet]] HTTP/1.1"" 200 122

App team also see this in their logs:

Query string: &@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB%20EXCEPTION%20CAUGHT%20:%20Error%20%20[Unable%20to%20get%20property%20'preventDefault'%20of%20undefined%20or%20null%20reference],%20Line%20[311]%20,%20URL%20[[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js]]

Request URI: /gpp/servlet/MainServlet

Parameters:

@XSRFPREVENTIONTOKENID@ f5d166e6dc8c39008be3183236b42c85a4e8eeb5

txtMsgInfo WEB EXCEPTION CAUGHT : Error  [Unable to get property 'preventDefault' of undefined or null reference], Line [311] , URL [[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js]]

@FORM_NAME@ frmMisc

@COMMAND_EVENT@ eventTrac

We need to understand the root cause of the pop up and why the issue isn't apparent when app is used against ISAM7 but it is when we switch to ISAM9.

Log and trace data is also attached to this case.",,Alan Wong,Ayush Singh,BRIANORO,Dermot Daly,Nick Lloyd,Prabhjeet.Multani,Surya Prakash,Syed Hasan Jafar,,,,,,,,6092aca0f0db130069d19687,61409dc154762c006932ffc7,6154906364ff01007106e189,6092ac9ff6c0960069d47a67,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,60f541a6d0134900692d91b7,617a5f2cf485cd0068cb98af,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012789923,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,BARCLAYS BANK PLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012789923&path=TS012789923%2F2023-04-19%2F&filepath=TS012789923%2F2023-04-19%2FGLOP06_pdweb.debug.log,,,,,,,,,,,,,,,,,,,,,,,0|i1atm7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.0,,,,,,,,,,,,,2023-04-24 15:13:54.126,,,,,25/Apr/23 1:13 AM;5b15d9e581c3df12acf53c4a;Investigating……,"26/Apr/23 2:20 AM;5b15d9e581c3df12acf53c4a;

It seems that it cannot find some properties and hence throwing WEB EXCEPTIONS: like…….

…………………

22.113.134.17 - G01292128 18/Apr/2023:16:48:02 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT : Error  [Unable to get property 'preventDefault' of undefined or null reference], Line [311] , URL [[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js]|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js%5D] HTTP/1.1"" 200 122
22.113.134.17 - G01292128 18/Apr/2023:16:51:08 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT : Error  [Unable to get property 'preventDefault' of undefined or null reference], Line [311] , URL [[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js]|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js%5D] HTTP/1.1"" 200 122
22.113.134.17 - G44683167 18/Apr/2023:16:51:18 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT : Error  [Unable to get property 'preventDefault' of undefined or null reference], Line [311] , URL [[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js]|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js%5D] HTTP/1.1"" 200 122
22.113.134.17 - G44683167 18/Apr/2023:16:51:21 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT : Error  [Unable to get property 'style' of undefined or null reference], Line [204] , URL [[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/context.htc]|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/context.htc%5D] HTTP/1.1"" 200 122

…………………

Some cases, properties that cannot find are:

TraceLevels
arrRepair
messageIframeRef
preventDefault
style
tagName

……………….

or

TraceLevels
document_onclick
innerHTML
length
onMouseOverAccounts
preventDefault
style
t support property or method
text

……………



Some cases, exception is:

35.49.93.19 - G01163549 19/Apr/2023:03:58:45 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT : Error  [Expected identifier, string or number], Line [436] , URL [] HTTP/1.1"" 200 122
35.49.93.19 - unauthenticated 19/Apr/2023:12:47:49 +0100 ""GET /eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I   Successful completion&METHOD=POST&URL=/gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB%20EXCEPTION%20CAUGHT%20:%20Error%20%20[Access%20is%20denied.],%20Line%20[57]%20,%20URL%20[[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/html/frmQueueTotals.html]&REFERER=https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet&HOSTNAME=eai-c-corporate.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/html/frmQueueTotals.html%5D&REFERER=https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet&HOSTNAME=eai-c-corporate.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=] HTTP/1.1"" 302 -
35.49.93.19 - unauthenticated 19/Apr/2023:12:47:49 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT *_: Error  [Access is denied.]_*, Line [57] , URL [[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/html/frmQueueTotals.html]|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/html/frmQueueTotals.html%5D] HTTP/1.1"" 302 2221
35.49.93.19 - unauthenticated 19/Apr/2023:12:47:50 +0100 ""GET /eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I   Successful completion&METHOD=POST&URL=/gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB%20EXCEPTION%20CAUGHT%20:%20Error%20%20[Access%20is%20denied.],%20Line%20[57]%20,%20URL%20[[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/html/frmQueueTotals.html]&REFERER=https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet&HOSTNAME=eai-c-corporate.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/html/frmQueueTotals.html%5D&REFERER=https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet&HOSTNAME=eai-c-corporate.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=] HTTP/1.1"" 302 -
35.49.93.19 - unauthenticated 19/Apr/2023:12:47:50 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT : *_Error  [Access is denied.], Line [57_*] , URL [[https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/html/frmQueueTotals.html]|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/html/frmQueueTotals.html%5D] HTTP/1.1"" 302 2221","26/Apr/23 3:06 AM;5b15d9e581c3df12acf53c4a;This 9.0.7.0 is so old that it is extremely difficult to debug or investigate it the issue.

Do they have any Test/Dev environment where they can upgrade to a more recent version and see if similar issue arises? If it does then it will be much much more easier for us to investigate ad debug?

Also, looking at the errors, it does not seem like a serious issues, it seems to me there are some errors in the java scripts files, or some error in basic script error or some mismatch in java scripts as the error is telling us that some events or fields or values cannot be found.

In any case, see whether you can find their plan of upgrading to the recent version even if it is in their test/dev environment……that will give us more up to date code level for investigation or debugging.","27/Apr/23 11:08 PM;61409dc154762c006932ffc7;[~accountid:5b15d9e581c3df12acf53c4a] the client is not ready to upgrade they need a RCA or fix for this.

client response:

We would not be able to produce the issue in any other env than in 9.0.7.0. Please advise what additional data you need to progress this further...

As per your statement, if you are noticing the errors are not a serious issue can you advise what needs to be updated at WebSEAL to handle the exception better? The same issue is not apparent in ISAM7 (I know even older version!) so ISAM7 is handling it better than ISAM9.

How come the 'Web Server Exception' pop up does not appear in ISAM7 but it does in ISAM9?",02/May/23 5:19 PM;61409dc154762c006932ffc7;[~accountid:5b15d9e581c3df12acf53c4a] any updates?,03/May/23 8:47 PM;61409dc154762c006932ffc7;any updates on this ?,"04/May/23 1:45 AM;5b15d9e581c3df12acf53c4a;I have not found any root cause yet , difficulty lies in the fact that we are looking at a very very old code base, 907 is really really old…………

But since customer is not even willing to try it out in a test platform against the latest ISVA, I am not sure how much I will find but I will keep looking. 

Errors seem to be very unusual, some scripting errors but cannot be sure of the real reason…………","04/May/23 4:48 AM;5b15d9e581c3df12acf53c4a;I am looking at certain stuff in the debug trace, e.g. look at the SLOP06_pdweb.debug.log. ( same applies in other debug trace files too):

…………

2023-04-18-16:51:08.376+01:00I----- thread(28) trace.pdweb.debug:2 *_/build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- Browser ===> PD -----------------_*
Thread 28; fd 272; local 10.115.42.160:51001; remote 22.113.134.17:63403^M
*_POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB%20EXCEPTION%20CAUGHT%20:%20Error%20%20[Unable%20to%20get%20property%20'preventDefault'%20of%20undefined%20or%20null%20reference],%20Line%20[311]%20,%20URL%20[_*[*_https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js]_*|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/js/contextMenu.js%5D] *_HTTP/1.1_*^M
accept: _/_^M
accept-encoding: gzip, deflate^M
accept-language: en-us^M
connection: Keep-Alive^M
content-length: 65^M
content-type: application/x-www-form-urlencoded^M
host: eai-c-corporate.rfs.barclays.co.uk^M
referer: [https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet^M|https://eai-c-corporate.rfs.barclays.co.uk/gpu-us-jn/gpp/servlet/MainServlet%5EM]
user-agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; .NET4.0C; .NET4.0E; Tablet PC 2.0; wbx 1.0.0; wbxapp 1.0.0)^M
cache-control: no-cache^M

……………………..





Please NOTE that client i.e. browser is sending an URL to ISVA i.e. PD which contains exception…..

Can you please explain or get an explanation?","10/May/23 6:41 PM;61409dc154762c006932ffc7;[~accountid:5b15d9e581c3df12acf53c4a] we have update from client

This same behavior is there when app is pointed to ISAM7 reverse proxy yet users get expected pop up telling them they have exceeded 10 mins idle time.

In ISAM9, users get the Web exception pop up. Why? That is for IBM to explain. 

No other conditions change in end to end journey except for swapping ISAM7 for ISAM9","11/May/23 1:15 AM;61409dc154762c006932ffc7;[~accountid:5b15d9e581c3df12acf53c4a] this is under managed escalation please look into this on priority

Also the customer is looking for a web-ex session. Please share your availability.



Please find below finding from expert labs in this case:

I have compared the file resource sizes for the /gppus_ee1-jn & /gpp junctions which seems to be in play and the sizes appear to be identical for v7 & v9.

 

3 additional observations:

The application is very chatty and request details are sent as query strings - this cannot be a good design decision, but it is what is is

I see multi line log messages for /gpu-ft4-ukw-jn ... I suspect this does not affect the behaviour per se, more an anomaly in request content

In v7 I see traffic for /gpt-jn & /gpu-us-jn, not sure why we are not seeing it for v9, perhaps because the user cannot click the button (logout)

 

I suggest you check junctions /gpt-jn & /gpu-us-jn are defined for v9 and also check if the junctions go to the same server and port combinations

as any other junction. At the moment I do not see a reason why this should behave any differently from v7 & v9.

As a next step, if you can save the page content (complete) for both v7 and v9 where you have the button for v7 that will end the session and

the exception for v9, I could try to compare what we see between the sates. For me if feels like something breaking client side.","12/May/23 4:25 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5ac57757d9a96536d1f0daa9] Hi David, will you be able to take a quick look at this issue or can we run it by Kerry to see what is the reason for this WEB EXCEPTION?

Amazingly, the url which seems to be causing this issue is coming from client to begin with but customer is claiming that similar url did not cause any errors against ISAM 7 but causing an issue against ISAM 9.0.7?","15/May/23 4:09 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:5b15d9e581c3df12acf53c4a] 

 

I had a look at this one on Friday and again briefly today.

 

I don’t think it has anything to do with ISAM/ISVA.

 

Looking at the provided trace, it seems the exception originates from the browser (due to bad JS in their application) as a query string into WebSEAL – i.e. it is not ISAM/ISVA generated. This looks to me like an issue in the JS on their back-end server where objects are not being properly defined.

 

e.g.

35.49.93.19 - R09072814 18/Apr/2023:11:18:30 +0100 ""POST /gpu-us-jn/gpp/servlet/MainServlet?&@FORM_NAME@=frmMisc&@COMMAND_EVENT@=eventTrace&txtMsgInfo=WEB EXCEPTION CAUGHT : Error  ['document_onclick' is undefined], Line [1152] , URL [[https://eai-c-corporate.rfs.barclay|https://eai-c-corporate.rfs.barclay][s.co.uk/gpu-us-jn/gpp/servlet/MainServlet|http://s.co.uk/gpu-us-jn/gpp/servlet/MainServlet]] HTTP/1.1"" 200 122

 

Also - the popup appears to be a part of their MainServlet – it is nothing to do with ISAM/ISVA (none of the keywords in this POST appear in our source code).

 

They need to fix their application / JS.

 

If they are saying this worked at ISAM7 but not 9.0.7, yet the same POST (with exception) was occurring – I would be inclined to think that 9.0.7 is working properly and ISAM 7 was not. Who knows why – could be due to change in JS engine etc. As you say - far too much has changed between ISAM 7 and 9 to be able to narrow this down. Bottom line is - if they don’t want the popup – they need to change their application as this is where it is originating from.

 

I don’t see that there is anything we can do here.","16/May/23 1:49 AM;5b15d9e581c3df12acf53c4a;David,
Thank you, I was also thinking along the same line, really appreciate your input.




Regards,

Motiur Rahman
IBM Security Access Manager L3
Certified Information Systems Security Professional (CISSP)
Ph: Mobile: 1-512-586-3045 | email: mrahman@us.ibm.com",16/May/23 1:55 AM;5b15d9e581c3df12acf53c4a;[~accountid:61409dc154762c006932ffc7] Please see the comment added by David Hayes.,"07/Jun/23 5:57 PM;61409dc154762c006932ffc7;[~accountid:5b15d9e581c3df12acf53c4a] the customer is not happy with previous response please find customers message below:

Previous update does not help in identifying the root cause. Whether it is a fix in IBM product or app, there's no explanation as to why ISAM7 works but ISAM9 doesn't. I have gone through your previous notes... there's no update in app code or how app is configured/packaged. The only differentiating factor is ISAM version!

Also we are going to reproduce the issue and get input from app vendor. We'll share their feedback once they have analysed.",08/Jun/23 7:06 PM;6092ac9ff6c0960069d47a67;I have reopened this Jira as this case is still under a managed escalation and although we are waiting for the feedback from the customer I hope it is okay to leave it in Response Due L2 until they provide that feedback as they are still looking for a cause to this issue,"09/Jun/23 9:45 PM;61409dc154762c006932ffc7;[~accountid:5b15d9e581c3df12acf53c4a] client have recreated the issue and we have collected traces 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012789923&path=TS012789923/2023-06-09/&filepath=TS012789923/2023-06-09/pdweb.debug.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012789923&path=TS012789923/2023-06-09/&filepath=TS012789923/2023-06-09/pdweb.debug.log]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012789923&path=TS012789923/2023-06-09/&filepath=TS012789923/2023-06-09/trace01.pcap|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012789923&path=TS012789923/2023-06-09/&filepath=TS012789923/2023-06-09/trace01.pcap]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012789923&path=TS012789923/2023-06-09/&filepath=TS012789923/2023-06-09/pdweb.snoop.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012789923&path=TS012789923/2023-06-09/&filepath=TS012789923/2023-06-09/pdweb.snoop.log]



Finastra have also taken traces and will provide an update including RCA and suggested fix.

I will further update the case once I receive an update from Finastra.

Once we receive their findings, we can analyze them and compare them with our own findings to gain a comprehensive understanding of the situation.

In the meantime, if there are any specific actions or tasks that need to be assigned or if you require any assistance.","12/Jun/23 5:41 PM;61409dc154762c006932ffc7;[~accountid:5b15d9e581c3df12acf53c4a] Update from Finastra as below, please validate if this matches IBM analysis of ISAM9 trace/log data provided today.



+*Issue*+ : Few users have reported web server exception on GPP GUI.



+*Root cause:*+ Few production users has been reported web server exception after ISAM9 migration activity where they are using EDGE with IE mode. Today, we have performed below scenarios and observed +issue is recreated in pure edge browser due to break in Js code+. Issue can be occurred on Pure Edge irrespective of ISAM version. Original issue reported by production users (where they are using EDGE with IE mode) could be something different probably related to application cache, Webseal cache, WAS cache, or some corrupted files in users browser cache and once we rollback to ISAM7 all cache went cleared and users are able to use GPP properly into their browsers.



We tried below scenarios where GPP URL’s configured with both ISAM9 and ISAM7 servers as



# Accessing GPP in Pure EDGE configured with ISAM9 - We are able to recreate an issue, as code execution halts due to JS exception, hence session timeout alert is not coming to user.
# Accessing GPP in EDGE with IE mode configured with ISAM9 - We are unable to recreate an issue, its working fine with proper alert are coming when system kick off the user once timeout reaches.
# Accessing GPP in Internet explorer configured with ISAM7 - We are unable to recreate an issue, its working fine with proper alert are coming when system kick off the user once timeout reaches.



+*Solution:*+ We will fix this issue on Pure Edge would be available in next Friday’s nightly build or earlier. We will provide check-in confirmation.","14/Jun/23 3:55 AM;5b15d9e581c3df12acf53c4a;Let us know what their findings were. As we updated earlier ( David Hayes ), issues coming from javascripts of client side and ISVA is not adding anything to it, in fact, ISVA 7 also should have thrown those exception in the first place.",14/Jun/23 5:38 PM;61409dc154762c006932ffc7;[~accountid:5b15d9e581c3df12acf53c4a] i have shared the findings in my previous message please 'please validate if this matches IBM analysis of ISAM9 trace/log,"15/Jun/23 4:19 AM;5b15d9e581c3df12acf53c4a;Your update on June 12 , i.e. what customer observed, seems to be correct.

Also, please note that since the crux of the issue is occurring in client side, we cannot say what exactly going on from server i.e. ISVA side.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Pending Transaction in IBM Verify app,ISAMSUP-4991,295453,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,19/Apr/23 7:31 PM,31/May/23 11:50 PM,14/Jul/23 2:47 PM,31/May/23 11:50 PM,,,,0,,,,"Customer experiencing issues with pending requests in the IBM Verify app for iOS. Or rather, the lack of pending requests. Steps to reproduce: Send an authentication to a user. Push notification is received on the mobile device, but if the user does not open the app through the push notification, no ""pending request"" is shown in the app until the app is refreshed (drag and drop, which does not always seem so evident to the user). Expected outcome: User gets a transaction, can open the app and immediately see ""pending request"" without having to refresh the app. Note: This is not a new issue/behaviour, but is a cause of inconvenience for the end users, as they are unfamiliar with the ""drag and drop"" functionality to refresh the requests in the app. Is it possible to tweak the settings to get an improved outcome? v2.5.2 (4), SDK v2.1.5 (2) - from the App Store.",,Carsten Hagemann,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Syed Hasan Jafar,Tushar Prasad,,,,,,,,,5af4ad7f39d04955d9e20da6,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,617a5f2cf485cd0068cb98af,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012778194,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1asiv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-20 00:46:40.461,,,,,20/Apr/23 10:46 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af0532354b5e72468e830b1] can you please confirm if this a defect within the IBM Verify app or is this working as designed? ,20/Apr/23 10:46 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b0321d6c91b2435a9f74970] FYI.,"20/Apr/23 11:03 AM;5af0532354b5e72468e830b1;[~accountid:617a5f2cf485cd0068cb98af]  Pull down to refresh functionality in iOS apps is very common and currently no plans to update the functionality.

Some time ago I experimented with checking for pending transactions on app launch or when the app entered the foreground.  The result was numerous network calls and inconsistent representation if a pending transaction was still pending.","21/Apr/23 9:47 AM;5b20891f1d2d6643d2c84c65;[~accountid:5af4ad7f39d04955d9e20da6] Had seen a proposed solution here on Slack - where if they only have a single MMFA account then it should auto poll on opening. (Ie 99% of end users). 
[https://ibm-security.slack.com/archives/C5SLE8KJ5/p1681198841997949|https://ibm-security.slack.com/archives/C5SLE8KJ5/p1681198841997949|smart-link] 

One of the best measures of a good MMFA experience is ‘getting in and out’ as fast as possible. I encourage any/all tweaks that would work towards that.
We’ve had this feedback several times from the field, I don’t believe we can continue to dismiss this, when we probably only see a tiny percentage of users who go to the effort to raise these frustrations with their administrators. Specifically given the aggressive nature of notification supression that android has brought into the platform.



",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
After applying 10.0.5.0 IF01 the fixpack is not appearing in the LMI fixpack list. ,ISAMSUP-4987,295299,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Gabe,5b15d99b4c20165700edecad,Gabe,5b15d99b4c20165700edecad,19/Apr/23 2:49 AM,11/May/23 3:14 PM,14/Jul/23 2:47 PM,11/May/23 3:14 PM,,,,0,,,,"The customer actually mistakenly applied 10.0.5.0 IF01 several time due to it not appearing in the LMI
From the support file I can see the fixpack under /var/support/fixpack and the log indicated it was installed successfully. 

[https://editor.apps.cloud.itc.ibm.com/sse/edit/edit.html#/sse/bigfile/gabrbell@us.ibm.com-OrionContent/TS012735401/2023-04-14/isva_10.0.5.0_20230414-113938_hqexowebu01.bankhq.exim.gov.support_unpack/iswga/ls.txt|https://editor.apps.cloud.itc.ibm.com/sse/edit/edit.html#/sse/bigfile/gabrbell@us.ibm.com-OrionContent/TS012735401/2023-04-14/isva_10.0.5.0_20230414-113938_hqexowebu01.bankhq.exim.gov.support_unpack/iswga/ls.txt]

drwxr-sr-x    2 root     www-data      4096 Apr 13 20:55 .
drwxrwsrwx    3 root     www-data      4096 Apr 14 11:43 ..
-rw-rw-r--    1 root     www-data     12854 Apr 13 21:37 10.0.5.0_IF1(1).log
-rw-rw-r--    1 root     www-data     13326 Apr 13 21:37 10.0.5.0_IF1.log



Also the /var/fixpacks and the [fixpack.info|http://fixpack.info] show it installed. 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012735401&path=TS012735401%2F2023-04-14%2Fisva_10.0.5.0_20230414-113938_hqexowebu01.bankhq.exim.gov.support_unpack%2Fvar%2Fiss-db%2F&filepath=TS012735401%2F2023-04-14%2Fisva_10.0.5.0_20230414-113938_hqexowebu01.bankhq.exim.gov.support_unpack%2Fvar%2Fiss-db%2Ffixpack.history|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012735401&path=TS012735401%2F2023-04-14%2Fisva_10.0.5.0_20230414-113938_hqexowebu01.bankhq.exim.gov.support_unpack%2Fvar%2Fiss-db%2F&filepath=TS012735401%2F2023-04-14%2Fisva_10.0.5.0_20230414-113938_hqexowebu01.bankhq.exim.gov.support_unpack%2Fvar%2Fiss-db%2Ffixpack.history]





Can you tell me where the LMI queries the fixpack list? Something might have happened after the fixpack was installed multiple times. I installed it twice myself but didn’t see the same issue. ",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012735401,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Gabe,5b15d99b4c20165700edecad,,,,EXPORT IMPORT BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1arlz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-18 17:46:14.629,,,,,19/Apr/23 3:46 AM;5b15d94b6256d01ad54eb020;It should be using  /var/iss-db/fixpack.history,19/Apr/23 8:38 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please review this item for us. ,"19/Apr/23 9:57 AM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}MesaSystemReturn res = MesaSystem.mesaControl(""fixpack_get_history"");

static const char FIXPACKHISTORY_FILE[] = ""/var/iss-db/fixpack.history"";{noformat}","19/Apr/23 10:52 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d99b4c20165700edecad] 

Does it list the fixpacks in CLI/REST? 

unconfigured.appliance.cli> fixpacks view_history
{{Rest with - https://{appliance_hostname}/fixpacks}}

Can you enable tracing on LMI with the following and get trace when you access fixapcks list on LMI? 

{noformat}*=config=enabled:com.ibm.mesa.*=ALL:com.ibm.isam.*=ALL{noformat}

In browser developer logs do they see any errors?

Have they tried a different browser?

Is this specific to an appliance in their environment or others too? ",11/May/23 3:14 PM;5af4ad7d4dd24c579110120b;case closed. hence closing jira,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
10.0.5.0 LMI fails to import file under management root of the reverse proxy,ISAMSUP-4977,294681,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,14/Apr/23 6:09 PM,26/Apr/23 8:45 AM,14/Jul/23 2:47 PM,26/Apr/23 8:45 AM,,,,0,,,,"steps

goto 10.0.5.0 LMI → reverse proxy → management  → c and then try to import a file



!image-20230414-074829.png|width=724,height=441!



{noformat}10.0.5.0 (failure)


curl 'https://9.30.165.99/wga/reverseproxy/igi/management_root/management/C?uiCalled=true' \
-X 'POST' \
-H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryo7g1ZUcoE0JNdjhx' \
-H 'Pragma: no-cache' \
-H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' \
-H 'Accept-Language: en-SG,en-GB;q=0.9,en;q=0.8' \
-H 'Accept-Encoding: gzip, deflate, br' \
-H 'Cache-Control: no-cache' \
-H 'Host: 9.30.165.99' \
-H 'Origin: https://9.30.165.99' \
-H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.2 Safari/605.1.15' \
-H 'Referer: https://9.30.165.99/wga/reverseproxy' \
-H 'Content-Length: 8796' \
-H 'Connection: keep-alive' \
-H 'Cookie: wdr__list_idSaveStateCookie=root%2Croot%2F%2Fmanagement%2Croot%2F%2Fmanagement%2F%2Fmanagement%2Fko%2Croot%2F%2Fmanagement%2F%2Fmanagement%2FC; LtpaToken2=6BITHjacuKDz3YXrBdHs2BWVHFNVGC/CdHMuJDeXRnECqpKaM+YTa2GBRkEqjqhmRvSSp/PrcjJLtuaLkP6Rvd3JLId5Zo6Zc0f8VNyTuo5wL9CWivsSYJdiBC+i4A5I2UagFcNb6UsJbOEcH2KPuYD/jQ6zRfiH6wE2GnZJRHsSjp31pAtccZfvQLPSuPThLSDPE82PStIZvnHBKNVVpBFgllNRHtLuOIw3uSFa4lL8bCTDXyyDrLwKY3EvusuN1F0tOxrZ+s1SieTco7oznxxwlvk+Ko07XqZua1Va20iem9TtHEVFJUzgVvibb2wB; JSESSIONID=00005AD4ttVohIfMxQW-hQHU0lW:4d95be65-ef89-4567-8baf-4c6e749b458a' \
--data-binary $'------WebKitFormBoundaryo7g1ZUcoE0JNdjhx\r\nContent-Disposition: form-data; name=""showfile""\r\n\r\nredirectnew.html\r\n------WebKitFormBoundaryo7g1ZUcoE0JNdjhx\r\nContent-Disposition: form-data; name=""file""; filename=""redirectnew.html""\r\nContent-Type: text/html\r\n\r\n\r\n------WebKitFormBoundaryo7g1ZUcoE0JNdjhx\r\nContent-Disposition: form-data; name=""file""; filename=""""\r\nContent-Type: application/octet-stream\r\n\r\n\r\n------WebKitFormBoundaryo7g1ZUcoE0JNdjhx\r\nContent-Disposition: form-data; name=""type""\r\n\r\nfile\r\n------WebKitFormBoundaryo7g1ZUcoE0JNdjhx\r\nContent-Disposition: form-data; name=""force""\r\n\r\nyes\r\n------WebKitFormBoundaryo7g1ZUcoE0JNdjhx\r\nContent-Disposition: form-data; name=""authenticity_token""\r\n\r\n/b4QU8sn/Yif4SJWbdW40TCyXd0CiMGrYVS3TkodQ7g\r\n------WebKitFormBoundaryo7g1ZUcoE0JNdjhx--\r\n'


10.0.4.0( success)

curl 'https://verifyaccessconfig-10-0-4-0-pr-tusharp.apps.l2nilesh.cp.fyre.ibm.com/wga/reverseproxy/rprelyingparty/management_root/management/C?uiCalled=true' \
-X 'POST' \
-H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryAKOaKcrkzUBJQZh7' \
-H 'Pragma: no-cache' \
-H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' \
-H 'Accept-Language: en-SG,en-GB;q=0.9,en;q=0.8' \
-H 'Accept-Encoding: gzip, deflate, br' \
-H 'Cache-Control: no-cache' \
-H 'Host: verifyaccessconfig-10-0-4-0-pr-tusharp.apps.l2nilesh.cp.fyre.ibm.com' \
-H 'Origin: https://verifyaccessconfig-10-0-4-0-pr-tusharp.apps.l2nilesh.cp.fyre.ibm.com' \
-H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.2 Safari/605.1.15' \
-H 'Referer: https://verifyaccessconfig-10-0-4-0-pr-tusharp.apps.l2nilesh.cp.fyre.ibm.com/wga/reverseproxy' \
-H 'Content-Length: 8796' \
-H 'Connection: keep-alive' \
-H 'Cookie: wdr__list_idSaveStateCookie=root%2Croot%2F%2Fmanagement%2Croot%2F%2Fmanagement%2F%2Fmanagement%2FC; LtpaToken2=ypaPesbLdnVNXAhh5nAjTbxFZ0CBGr/FWioCY1DxI++BH4za5Ul7SmYRlCmeHF7QdYa3h0IhD/IjPYD2NCO+GHJbHeiwj+XLQo1EMzZgpFmSXih9hNt4ok4aTQsc2EBm9B1cbew2vP2570zLAy3ZYRN6EQdi6T1Vn6z8Pi05NCJKplHf6xnglPyzH9zdvX2KiVMZsajFeustzd2OnaUahwSj3C+vBtk+X+jVRCx1kbM996HXiqdq3SBkI44YQoJ8Yb543x+E/HKqOey6Z0eWBuiX+khCrO4Q/NsoRr3tBUSDBKCmchfN03sysD2TNhku; JSESSIONID=0000ciRh3Y3UYo4OlqcYQbRdoZ9:b1b7f5f7-3c50-4829-bb3b-cfbb88f959e3; OPTOUTMULTI=0:0%7Cc1:1%7Cc2:0%7Cc3:0; userContext=12e70317-0a0d-45f8-b6c8-ef555f76c415|1|0|0|SG|n/a|0|2:|implied|zz|n/a|n/a|n/a; utag_main=v_id:018769674c27001a7e3790ac111701075005306d00b35$_sn:6$_se:4$_ss:0$_st:1681375154742$is_country_requiring_explicit_consent:false$vapi_domain:ibm.com$dc_visit:5$ses_id:1681373353290%3Bexp-session$_pn:1%3Bexp-session$dc_event:1%3Bexp-session$mm_ga_sync:1%3Bexp-session$dc_region:ap-east-1%3Bexp-session; _ga=GA1.2.185948753.1681355932; _gid=GA1.2.83077110.1681355932; cmapi_gtm_bl=; notice_behavior=implied|eu; pageviewContext=4ad02911-4ba9-42e0-aae3-84cb1c55f197; AMCV_D10F27705ED7F5130A495C99%40AdobeOrg=359503849%7CMCIDTS%7C19461%7CMCMID%7C01720888523496173144283593505011238709%7CMCAAMLH-1681975810%7C3%7CMCAAMB-1681975810%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1681378210s%7CNONE%7CMCSYNCSOP%7C411-19465%7CMCCIDH%7C-2109835027%7CvVersion%7C5.0.1; _abck=75DA13364AEF09D7FCCA809FC74A1E72~0~YAAQThdLF78VSleHAQAATkCFeQmNwe30DA6KtzVmz1I4nkeF3zhSfQbjAQrIBN6PFO7amgZGYXZeFcjG8VUq7Ee+Ci4WOZHX8aqQADW7xXI6UZkjukjdJzzz2hfIjd0N82ug9XLXEcbXiNzZi28yBvENo0Wqw+zrfP9QiQXkr8L5lnWhwTMKF8pwGQYTN+/FhnUQfcJDChOS9SAnv/s/JoRpRs711PLMvd7OVKcbghyfvOuAptFToR0g/2u7Iq8bq9hCsS9HSADYZW4am4/+zvT3MSdTV+EmvyseBrjSW2cXb2KDVxCGcGaTa7xeXd4ILjykfWTRn41SUXEJAGtvBeiUhiZXaMJvrPGtLg1PO6qkwP+GkZUOBdRmQ4Cn9EUCK5WjsdFXQrYuRfhdEKL3jIDAkk7/Qw==~-1~-1~-1; _mkto_trk=id:298-RSE-650&token:_mch-ibm.com-1681100591094-72643; _mkto_trk_http=id:298-RSE-650&token:_mch-ibm.com-1681100591094-72643; AMCVS_D10F27705ED7F5130A495C99%40AdobeOrg=1; at_check=true; mbox=PC#9ec0bc42deee402d874f51e0eeb6d086.38_0#1712722991|session#5e7a320e1bfa4835bff58ea3af27b0bd#1681102451; ajs_anonymous_id=f4a6c322-1340-4387-b81d-9fea0f6cdf2f; ajs_user_id=IBMid-666000XWOF; LSESSIONID=eyJpIjoiZWJEK3dZR0dacXYxeGMzY0ZwQWdRQT09IiwiZSI6IjJTM0RmTk1VNVF2XC9NVDdKVHAwY3NZSElaemU4SUVsQUdKc0kyNXcwRjdxTHpmd3Y1VzRMcStqOTVtMFkzVXN2VXhFZmNWTCt5WlZqbVJJM3JFczcyKzNlT0lySUJrWDFZYmNPK1BrN25CdkR1UDZnOWFYRTVUUkJJR3poSGVRcXJZb1NaSURoMDd5cGN3ZzA2NnJsN1VNR29cL0RRaVhHeUZsZ2FjXC9wcnE1Q2ZIY1l0c0xlV1wvb2VcLzJndnM4UjNOIn0%3D.c8ed51add5cddc92.MDcyZjAwMzQzNTBkYzQyM2FmNjk2ZDlhMjNhZjE0NWIyZjBkNDkyNGY0YTQzNDg3YjY5MWI2MDZjYjI4M2M2ZA%3D%3D; ___tk447900=0.8598925252991436; ___tk67142224=1681095123249; CISESSIONIDPR02A02=PBC5YS:2552773732; _uetvid=8c349870664011ed987e35b6dc44f818; cmapi_cookie_privacy=permit_1|2|3; _rdt_uuid=1678236827096.299c94d8-c438-48ef-8626-ab662611df7f; _hjSessionUser_42920=eyJpZCI6IjUwODNmOWM4LTBlYmQtNWIyNy1iY2EwLTQ0NWNlOTY1NzIyMyIsImNyZWF0ZWQiOjE2Njg2Njg0NjIyNTksImV4aXN0aW5nIjp0cnVlfQ==; notice_gdpr_prefs=0|1|2:; notice_preferences=2:; ___r120406=0.5484226749815; __gdic=lbdtvejeef6paqw8aw7; CoreID6=31798843138216689950556&ci=51040000|IBMTESTW3_51040000|estecu; BMAID=12e70317-0a0d-45f8-b6c8-ef555f76c415' \
--data-binary $'------WebKitFormBoundaryAKOaKcrkzUBJQZh7\r\nContent-Disposition: form-data; name=""showfile""\r\n\r\nredirectnew.html\r\n------WebKitFormBoundaryAKOaKcrkzUBJQZh7\r\nContent-Disposition: form-data; name=""file""; filename=""redirectnew.html""\r\nContent-Type: text/html\r\n\r\n\r\n------WebKitFormBoundaryAKOaKcrkzUBJQZh7\r\nContent-Disposition: form-data; name=""file""; filename=""""\r\nContent-Type: application/octet-stream\r\n\r\n\r\n------WebKitFormBoundaryAKOaKcrkzUBJQZh7\r\nContent-Disposition: form-data; name=""type""\r\n\r\nfile\r\n------WebKitFormBoundaryAKOaKcrkzUBJQZh7\r\nContent-Disposition: form-data; name=""force""\r\n\r\nyes\r\n------WebKitFormBoundaryAKOaKcrkzUBJQZh7\r\nContent-Disposition: form-data; name=""authenticity_token""\r\n\r\n0zY0ZqzB3S0mlyNfEPSs3TuirbNCpkG8XTFH3kWUGP8\r\n------WebKitFormBoundaryAKOaKcrkzUBJQZh7--\r\n'{noformat}",,Nick Lloyd,,,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,14/Apr/23 6:09 PM;tushar.prasad;image-20230414-074829.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/196022,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012730801,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,cathay life insurance,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1antb:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-14 15:41:43.664,,,,,15/Apr/23 1:41 AM;5b15d94b6256d01ad54eb020;That’s a known problem and is fixed in 10.0.6.  You can use zip file from the top level.,"21/Apr/23 1:09 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] thanks. Customer will use your suggestion to use zip.

and agreed to wait till 10.0.6.0 as they are just updating files once or twice a year



Jira can be closed ",26/Apr/23 8:45 AM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868] I’m going to close this since are willing to wait for 10.0.6.0.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
corefile created using diagnostics -> java_dump default thread created in /tmp directory can't be captured,ISAMSUP-4973,294480,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,13/Apr/23 9:51 PM,23/May/23 12:07 AM,14/Jul/23 2:47 PM,22/May/23 1:01 PM,,,,0,,,,"tested at 10.0.5. 0.  it seems to create in /tmp



need a way to include it in support file at 10.0.3.1



[recreate1.iamtestorg.com|http://recreate1.iamtestorg.com]:diagnostics> java_dump runtime thread

Dumping server runtime.
Server runtime dump complete in /opt/IBM/wlp/usr/servers/runtime/logs/javacore.20230413.194921.22042.0001.txt.
[recreate1.iamtestorg.com|http://recreate1.iamtestorg.com]:diagnostics> java_dump default thread

Dumping server default.
Server default dump complete in /tmp/javacore.20230413.194944.22705.0004.txt.",,Nick Lloyd,,,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012697261,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,Toll,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1amkv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-04-13 18:16:54.64,,,,,"14/Apr/23 4:16 AM;5b15d94b6256d01ad54eb020;You can try this one. It will create 6 java cores and copy them to a location where they can be included in a support file.

[https://ibm.ent.box.com/folder/80597044610|https://ibm.ent.box.com/folder/80597044610|smart-link] ","14/Apr/23 1:23 PM;5c53d3ac23f5bf672621c868;thanks [~accountid:5b15d94b6256d01ad54eb020] 

My intention is also to get it fixed in the product","15/Apr/23 12:25 AM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868]   ( [~accountid:5b15d99b4c20165700edecad] knows how  if you don’t )

We need to open a ticket with Liberty and ask them if there is way to change the location for the default profile.

The command we use for this is:

./server javadump default --include=thread

openjdk version ""11.0.16.1"" 2

 22.0.0.9 Liberty

I tried setting the env variables mentioned here:

IBM_JAVACOREDIR
IBM_COREDIR
IBM_HEAPDUMPDIR

[https://openliberty.io/docs/latest/reference/command/server-javadump.html|https://openliberty.io/docs/latest/reference/command/server-javadump.html|smart-link] 

That didn’t work.  I also tried setting:

SERVER_WORKING_DIR
WLP_OUTPUT_DIR
LOG_DIR

None of these  worked.",22/May/23 1:01 PM;5ac57757d9a96536d1f0daa9;Case has been closed. Setting the Jira items status to done.,23/May/23 12:07 AM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868] did you open a case with Liberty on this?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Discrepancy in Password Policy for ISAM admin user,ISAMSUP-4971,294180,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,13/Apr/23 5:13 PM,02/Jun/23 1:22 PM,14/Jul/23 2:47 PM,02/Jun/23 1:22 PM,,Support Management,,0,,,,"Hi team,

I got a case from customer reporting discrepancy in Password Policy for ISAM admin user. I also tested it in my lab and confirmed customers finding. Please find below -

1- Password policy: minlen=14 dcredit=1 ucredit=1 lcredit=1 maxrepeat=2 

password to test: Dubai@123456789 working                                                                                               password policy: password failed ""dubai@1234567888"" (max repeated chars are 3)                                     Fail Scenario: this password got accepted ""Dubai@1234567"" (13 characters)                                                     Fail Scenario: this password got accepted ""dubai@123456789"" (No Upper case chars)                                   Fail Scenario: this password got accepted ""DUBAI@123456789"" (No Lower case chars.)                                   Fail Scenario: this password got accepted ""dubai@abdcefghi"" (No Digits) 


2- Password policy: minlen=14 

working password: ""Dubai@123456789"" (Passwords less than 14 characters doesn`t work) 

3-Password policy: minlen=14 dcredit=1                                                                                                                   Fail scenario: this password got accepted ""Dubai@abcdefgh"" (it doesn`t have any digits)                        Success: this password is not accepted ""Dubaiabcdefghi"" (Policy Applied)

4-Password policy: minlen=14 ucredit=1                                                                                                                  Fail scenario: this password got accepted ""dubai@123456789"" (it doesn`t have any upper case characters) 

5-Password policy: minlen=14 lcredit=1                                                                                                                     Fail scenario: this password got accepted ""DUBAI@123456789"" (it doesn`t have any lower case characters) ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012685760,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,FIRST ABU DHABI BANK P.J.S.C,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1akq7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-14 22:13:23.828,,,,,"15/Apr/23 8:13 AM;5b15d9e581c3df12acf53c4a;As the doc i.e.  [https://www.ibm.com/docs/en/sva/10.0.0?topic=settings-configuring-password-quality|https://www.ibm.com/docs/en/sva/10.0.0?topic=settings-configuring-password-quality|smart-link] 

mentioned that password strength is validated by pam_pwquality module i.e. by PAM modules, it follows all the rules regarding minlen govern by  PAM, please lookup PAM password rules in pam_cracklib.","27/Apr/23 1:32 PM;62d0e51aec233f24684a5d3a;Hi Team, the password quality feature is not working as designed after configuring the password policy Tuning parameters . I have tested this in my envt. Requesting you to please look into this.","03/May/23 2:13 PM;62d0e51aec233f24684a5d3a;Hi Team, Any update on this. I could reproduce this in my lab, were you also able to reproduce this issue? 

Client is waiting for an update.

Thanks","04/May/23 5:31 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d9e581c3df12acf53c4a] can you please update on this.

Waiting to reply to customer.","05/May/23 1:44 AM;5b15d9e581c3df12acf53c4a;I think you missed the core intent of my update on April 14 above.

Password Policy that you are referencing is PAM module driven so all the rules, number of character, numeral, special character is governed by PAM Modules i.e. it follows password rules specified in pam_cracklib.

If you google PAM Password rules in pam_cracklib, you will find all the answers that you are looking for.","05/May/23 1:56 AM;62d0e51aec233f24684a5d3a;Hi ,

Thanks for the update.

 I read about the pam_cracklib module, as far as I understand we are leveraging this module in our product ISVA to provide the password quality checking and since this module is not working as desired, I guess we might need to fix that in our products PAM module. I don't think the customer can do anything to fix it at their end.

Please correct me if I am wrong in my understanding.

Thanks

Varun","05/May/23 5:41 AM;5b15d9e581c3df12acf53c4a;No, it is working exactly as it is supposed to.

Read the pam_cracklib functionality thoroughly, you will find how the number character get counted etc etc, you will see and find out that it working as it is described.

Please consult with other in your L2 Team   including L2 in USA.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Problems with container logs?,ISAMSUP-4967,293628,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,11/Apr/23 3:24 AM,14/Jul/23 3:38 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"Case says customer is running on 10.0.5.   

[~accountid:5c53d3ac23f5bf672621c868] [~accountid:5b1757156d76184b7d98a0c3] Can you look at TS012675169 and see if you have any thoughts on this?    Have you seen anything like this in your env?

From the customer…



{quote}On high volume production environments, we are seeing logs essentially step on each other and become corrupted coming off the container logs.  This is causing major issues with log analysis for security concerns.

For example:

{""instant"":{""epochSecond"":168087621{""transaction"":{""client_ip"":""107.77.236.122"",""time_stamp"":""Fri Apr  7 10:03:38 2023"",""server_id"":""75525e1d4e39d7f47ae62120305cc7f3956b5c01"",""client_port"":42176,""host_ip"":""0.0.0.0"",""host_port"":9443,""unique_id"":""168087621872.421395"",""request"":{""method"":""GET"",""http_version"":1.1,""uri"":""/fedach_web/fach_flw/javax.faces.resource/theme.css.xhtml?ln=primefaces-frb"",""headers"":{""sec-fetch-site"":""same-origin"",""user-agent"":""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"",""sec-ch-ua-mobile"":""?0"",""if-modified-since"":""Sun, 02 Apr 2023 18:33:24 GMT"",""referer"":""[https://www.federalreserve.org/fedach_web/fach_flw/page/file/processingSummary.xhtml?linkLoc=ProcessingSummary"",""sec-ch-ua-platform"":""\""Windows\"""",""host"":""www.federalreserve.org"",""connection"":""keep-alive"",""sec-fetch-mode"":""no-cors"",""accept-language"":""en-US,en;q=0.9"",""accept-encoding"":""gzip|https://www.federalreserve.org/fedach_web/fach_flw/page/file/processingSummary.xhtml?linkLoc=ProcessingSummary"",""sec-ch-ua-platform"":""\""Windows\"""",""host"":""www.federalreserve.org"",""connection"":""keep-alive"",""sec-fetch-mode"":""no-cors"",""accept-language"":""en-US,en;q=0.9"",""accept-encoding"":""gzip], deflate, br"",""accept"":""text/css,*/*;q=0.1"",""iv-junction"":""fedach_web"",""sec-fetch-dest"":""style"",""sec-ch-ua"":""\""Google Chrome\"";v=\""111\"", \""Not(A:Brand\"";v=\""8\"", \""Chromium\"";v=\""111\""""}},""response"":{""body"":"""",""http_code"":304,""headers"":{""date"":""Fri, 07 Apr 2023 14:03:38 GMT"",""x-frame-options"":""SAMEORIGIN"",""ienv"":""Hg3"",""cache-control"":""max-age=0"",""expires"":""0"",""strict-transport-security"":""max-age=31536000; includeSubDomains; preload""}},""producer"":{""modsecurity"":""ModSecurity v3.0.8 (Linux)"",""connector"":""IBM Security Verify Access v10.0.5.0 (Beta)"",""secrules_engine"":""DetectionOnly"",""components"":[""OWASP_CRS/4.0.0-rc1\""""]},""messages"":[{""message"":""XSS Filter - Category 3: Attribute Vector"",""details"":{""match"":""Matched \""Operator `Rx' with parameter `(?i).(?:\\b(?:x(?:link:href|html|mlns)|data:text/html|formaction|pattern\\b.*?=)|!ENTITY[\\s\\v]+(?:%[\\s\\v]+)?[^\\s\\v]+[\\s\\v]+(?:SYSTEM|PUBLIC)|@import|;base64)\\b' against variable `REQUEST_FILENAME' (Value: `/fedach_web/fach_flw/javax.faces.resource/theme.css.xhtml' )"",""reference"":""o51,6v4,57t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls"",""ruleId"":""941130"",""file"":""/var/pdweb/shared/waf/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf"",""lineNumber"":""136"",""data"":""Matched Data: .xhtml found within REQUEST_FILENAME: /fedach_web/fach_flw/javax.faces.resource/theme.css.xhtml"",""severity"":""2"",""ver"":""OWASP_CRS/4.0.0-rc1"",""rev"":"""",""tags"":[""application-multi"",""language-multi"",""platform-multi"",""attack-xss"",""paranoia-level/1"",""OWASP_CRS"",""capec/1000/152/242""],""maturity"":""0"",""accuracy"":""0""}},{""message"":""Inbound Anomaly Score Exceeded (Total Score: 5)"",""details"":{""match"":""Matched \""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' )"",""reference"":"""",""ruleId"":""949110"",""file"":""/var/pdweb/shared/waf/rules/REQUEST-949-BLOCKING-EVALUATION.conf"",""lineNumber"":""176"",""data"":"""",""severity"":""0"",""ver"":""OWASP_CRS/4.0.0-rc1"",""rev"":"""",""tags"":[""anomaly-evaluation""],""maturity"":""0"",""accuracy"":""0""}}]}}

I'll attach a text file of other events.  We are not seeing this a lot in lower environments, mostly production environments where there is a ton of throughput.  Right now I have primarily seen it with request logs and ModSecurity event logs stepping on each other.  I am not sure about message logs.

All of our logging is configured to go out the container console in JSON format.  The logging is working as expected, except it seems things are being stepped on per say.

We need to determine if this is something with the ISVA docker image(s) or if this is something with our container environment.  However, I cannot see how it would be the fault of the container environment, since these logs go to the stdout and/or stderr of webseal.  Hence, I would think more likely it is how the events are being written out to the console at the same time from multiple sources from the wrp image.{quote}



I have been discussing with [~accountid:5b15d9e6dda5f94d06b985b4] here and he suggested checking with you guys since you have a similar env there.



Any thoughts or input on this?


Thanks",,Daniel Comeau,khansen,Nick Lloyd,rholman,Tushar Prasad,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a83a6aa22dbebb46cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ46926,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012675169,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,rholman,5bac25a83a6aa22dbebb46cf,,,,PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1ahaf:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-13 08:18:02.352,,,,,11/Apr/23 4:55 AM;5b15d9a0dda5f94d06b985b3;Cust confirmed this issue is on 10.0.5 and that they are NOT running IF1 yet.,"13/Apr/23 6:18 PM;5c53d3ac23f5bf672621c868;HI



I have noticed these are WAF audit logs ( which seems to be on) in detection mode . 

seems customer is running WAF in detection mode (may need to confirm that)

not sure why it says Beta

from my env: content of waf_audit.log

{noformat}waf_audit.log:{""transaction"":{""client_ip"":""10.254.12.1"",""time_stamp"":""Thu Apr 13 13:28:22 2023"",""server_id"":""cded12975aa98c39926897695aa769c07a2e1da2"",""client_port"":44776,""host_ip"":""0.0.0.0"",""host_port"":9443,""unique_id"":""168137270248.897360"",""request"":{""method"":""POST"",""http_version"":1.1,""uri"":""/mga/sps/oauth/oauth20/token"",""headers"":{""connection"":""keep-alive"",""content-length"":""105"",""content-type"":""application/x-www-form-urlencoded"",""host"":""rp1050.apps.l2nilesh.cp.fyre.ibm.com""}},""response"":{""body"":"""",""http_code"":400,""headers"":{""content-language"":""en-US"",""cache-control"":""no-store, no-cache=set-cookie"",""pragma"":""no-cache"",""content-type"":""application/json;charset=UTF-8"",""date"":""Thu, 13 Apr 2023 07:58:33 GMT"",""x-frame-options"":""SAMEORIGIN"",""expires"":""Thu, 01 Dec 1994 16:00:00 GMT"",""strict-transport-security"":""max-age=31536000; includeSubDomains""}},""producer"":{""modsecurity"":""ModSecurity v3.0.8 (Linux)"",""connector"":""IBM Security Verify Access v10.0.5.0 (Beta)"",""secrules_engine"":""DetectionOnly"",""components"":[""OWASP_CRS/3.3.2\""""]},""messages"":[]}}{noformat}

 will run some test to see whether waf_audit.log contents gets spilled (may be during rollover or something)",13/Apr/23 6:40 PM;5b15d954b0d76456f36daf33;Is there anything for me to do at the moment?,"14/Apr/23 1:20 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

At present, I ran a fair bit of traffic , growing waf_audit.log to around 30 mb and seems it couldn’t spill the logs.



but seems there is under few circumstances , logs are written over stdout



can you think of any situation where it would happen( may be when log file size is big enough) or during the rollover time?","17/Apr/23 3:53 PM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] comparing your output to what the customer provided, the only difference I see is that the {{transaction}} entry in the log seems to be interspersed with the modsecurity one. Is that what they are talking about?

There isn’t any specific size limit for the waf_audit log that I can see.

Do we have a full support file other than just this log?","17/Apr/23 11:20 PM;5bac25a83a6aa22dbebb46cf;Update and data received from customer:
I am going to send a support file from our QA because I cannot do much on prod without elevated rights and a change ticket.

oc --context ciam-qa-dmz-0-cc3-blue logs isam-wrp-www-0

Not sure what you are after with that command, but I don't see any directories that look anything similar.  I'll compress the entire directory and send.

$ oc --context ciam-qa-dmz-0-cc3-blue rsh isam-wrp-www-0 ls -al /var/application.logs/wrp/rprelyingparty/log
ls: cannot access '/var/application.logs/wrp/rprelyingparty/log': No such file or directory
command terminated with exit code 2

$ oc --context ciam-qa-dmz-0-cc3-blue rsh isam-wrp-www-0 ls -al /var/application.logs/wrp/relyingparty/log
ls: cannot access '/var/application.logs/wrp/relyingparty/log': No such file or directory
command terminated with exit code 2

$ oc --context ciam-qa-dmz-0-cc3-blue rsh isam-wrp-www-0 ls -al /var/application.logs/wrp
total 0
drwxrwxr-x. 1 isam root 43 Apr 4 23:58 .
drwxrwxr-x. 1 isam root 17 Nov 29 20:05 ..
drwxr-xr-x. 6 isam isam 56 Apr 4 23:58 www.qa.federalreserve.org-cc3

$ oc --context ciam-qa-dmz-0-cc3-blue rsh isam-wrp-www-0 ls -al /var/application.logs/wrp/www.qa.federalreserve.org-cc3
total 0
drwxr-xr-x. 6 isam isam 56 Apr 4 23:58 .
drwxrwxr-x. 1 isam root 43 Apr 4 23:58 ..
drwxr-xr-x. 2 isam isam 58 Apr 4 23:58 crash
drwxr-xr-x. 2 isam isam 6 Apr 4 23:58 log
drwxr-xr-x. 2 isam isam 6 Apr 4 23:58 stats
drwxr-xr-x. 2 isam isam 6 Apr 4 23:58 trace

$ oc --context ciam-qa-dmz-0-cc3-blue rsh isam-wrp-www-0 ls -al /var/application.logs/wrp/www.qa.federalreserve.org-cc3/log
total 0
drwxr-xr-x. 2 isam isam 6 Apr 4 23:58 .
drwxr-xr-x. 6 isam isam 56 Apr 4 23:58 ..

$ oc --context ciam-qa-dmz-0-cc3-blue rsh isam-wrp-www-0 tar zcvf /tmp/logs.tgz /var/application.logs
tar: Removing leading `/' from member names
/var/application.logs/
/var/application.logs/wrp/
/var/application.logs/wrp/www.qa.federalreserve.org-cc3/
/var/application.logs/wrp/www.qa.federalreserve.org-cc3/trace/
/var/application.logs/wrp/www.qa.federalreserve.org-cc3/stats/
/var/application.logs/wrp/www.qa.federalreserve.org-cc3/crash/","17/Apr/23 11:46 PM;5bac25a83a6aa22dbebb46cf;Uploaded support file, logs from one of the containers for [www.qa.federalreserve.org|https://www.qa.federalreserve.org], and the tar gzip file from /var/application.logs from that container I sent the logs from.
We are seeing this on all our environments. It is becoming quite a headache as it is corrupting our logs and there is fear that we could be losing critical logging data that would be required in the event of a security incident.",26/Apr/23 5:35 AM;5bac25a83a6aa22dbebb46cf;Customer is asking for an update on this issue.,"27/Apr/23 9:40 AM;5b15d954b0d76456f36daf33;All logging is done within the one webseald process, so I can’t yet explain the reason why request logs and mod security entries are being interspersed.

Tushar’s local recreate indicated he wasn’t able to see either problem - of intertwining logs or log rollover.

So what is the actual trigger for the customer’s problem? Is it just load? Can you work with them to identify what we can do to see the same - no. of WAF rules or amount of load etc.","03/May/23 5:45 AM;5bac25a83a6aa22dbebb46cf;Customer update:

I would say that is why you are not seeing it is because the load we have on these proxies. What is strange is on our lower environments I see the request logs have a random line feed in the middle of them. I say random because it is on random events, at random places in the log output. The content is there, but there is a random return. Of course this throws off Splunk since it expects the JSON event all to be on a single line. So when I graph the entries Splunk cannot parse, I see it looks to be consistently doing it at all hours, even when there should be little to no requests coming through other than the standard health checks. I don't see ModSecurity events firing in those environments wrapped in with the request logs. This may not even be related to the total corruption/loss of data we see in qa/prod. But it does make me wonder.

Looking in our QA, when I see the logs separated up by a ModSecurity event(s), the request logs are there, but part of it above and part below the ModSecurity events. I am wondering if that line return in the middle of some events on the lower environment is related. Like maybe it clears a buffer ever so often or something, and in the middle of that the request logs are interrupted by ModSecurity.",09/May/23 9:34 PM;5b232b2fd85e5b59b066f57f;@bkumar - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,11/May/23 1:55 AM;5bac25a83a6aa22dbebb46cf;I am raising the severity of this issue as the customer is having production issues due to this behavior and needs a fix asap.,11/May/23 3:41 PM;5b15d954b0d76456f36daf33;I’ve reached out to development for additional input as I can’t see anything yet that is not working correctly. Will add an update when I have more information ,"17/May/23 2:32 PM;5bac25a83a6aa22dbebb46cf;Customer update as follows:

Ross, can you try and see if you can reproduce with this?



Enable ModSecurity. This should activate rule 200007 for detection/blocking. I am in blocking, but I have this rule set to pass now. I was seeing the same thing with blocking this rule. I don't think this matters, we just need it to log.

Now run this to generate a request that will hit ModSecurity and with 2000 parameters, which will cause that rule to fire:

oc rsh isam-wrp-low-0 bash

test=""$(for i in {1..2000}; do echo -n ""var${i}=key${i}&""; done)""

curl -k [https://localhost:9443/findthis?$|https://localhost:9443/findthis?$]{test}

exit

Now get the logs:

oc logs isam-wrp-low-0 --since=60s | grep findthis

You'll see the request log entry and the ModSecurity log entry is corrupted. I was doing some ModSecurity testing today and discovered this. I assume it may be related. But this is the only case where I have been able to reproduce the log corruption in a test lab every time.","17/May/23 6:25 PM;5b15d954b0d76456f36daf33;[~accountid:5bac25a83a6aa22dbebb46cf] Thank Matt for those steps. It has made it easier to try and narrow down the root cause.

Also open an APAR so we can keep track of the problem.","18/May/23 9:40 AM;5bac25a83a6aa22dbebb46cf;This is the only fixpack we have on containers:

f505b019cb4195b30d77c05aa6eef053e71334a20a3c1afe728ff1d5ae45eb88 1050_log_console_fix_V1.fixpack

Container image we are currently using: verify-access@sha256:e810b1b477e27645c773f66d5b416d10ec77d43cb4207005f2753aab4a8c3e82","19/May/23 4:38 AM;5bac25a83a6aa22dbebb46cf;Just to add to this, it is not always ModSec causing the issues. For example, I just discovered these request logs getting a line return in the middle of them for no reason at all. It just happens randomly. Attaching as request-logs-return.txt",19/May/23 9:35 AM;5b15d954b0d76456f36daf33;Thanks. Have you created an APAR yet?,22/May/23 3:06 AM;5bac25a83a6aa22dbebb46cf;I have not created an apar as of yet because i’m not exactly sure what the issue is that is occurring and what to put in the apar. Do you have a specific description or other information for me to put into an apar? I don’t believe I can edit an apar after its initial creation to correct anything.,22/May/23 9:59 AM;5b15d954b0d76456f36daf33;Something along the lines of “Log entry corruption from ISVA containers”. In description you can add what the customer said about entries being interspersed and unable to be parsed automatically at the receiving end. ,23/May/23 6:36 AM;5bac25a83a6aa22dbebb46cf;Apar opened IJ46926,"26/May/23 1:30 PM;5b15d954b0d76456f36daf33;Thanks. Just wanted to let you know that we are working on this as a priority. 

Also we had a look at the other case Matt mentioned on the call - TS012903309 - it was easy to recreate, so investigating it in parallel. If there isn’t one, you should create a jira for that case. Feel free to assign it to me.",06/Jun/23 10:41 PM;5bac25a83a6aa22dbebb46cf;Customer is looking for an update on this issue. I believe we told them in the meeting to look for a fix on 5/22.,"08/Jun/23 4:01 PM;5b15d954b0d76456f36daf33;Yes haven’t forgotten, but something more urgent came up. But now I’m back on this and should have an update.",19/Jun/23 6:02 PM;5b15d954b0d76456f36daf33;[~accountid:5bac25a83a6aa22dbebb46cf] can you check if Matt plans to stay on 10.0.5.0_IF1 or has any plans to move to 10.0.6.0? Just so I know which version to target any potential fix.,"22/Jun/23 12:56 AM;5bac25a83a6aa22dbebb46cf;Customer update:
Let's plan on getting this in 10.0.6.0. Our plan was to get to 10.0.6.0 all along. This gives me more reason to push it on this side.","22/Jun/23 12:14 PM;5b15d954b0d76456f36daf33;Thanks, that’ll probably be the best course.","26/Jun/23 2:10 PM;5b15d954b0d76456f36daf33;– internal --

Although we have a local recreate, there isn’t any root cause yet. Need to isolate if the problem is with the process itself or the watchdog.",14/Jul/23 3:38 AM;5bac25a83a6aa22dbebb46cf;Just wanting to check in to see if there is an update on this one. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Modsec rules don't load in a alphabetical order,ISAMSUP-4963,292756,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,07/Apr/23 7:39 PM,18/May/23 12:40 PM,14/Jul/23 2:47 PM,11/May/23 10:49 PM,10.0.6,Support,14/Apr/23 12:00 AM,0,,,,"Hi Team, The customer reports that the Modsec rules do not seem to load in correct order occasionally. They have combined all the rules to one file and then everything works ok. We suspect that rules are not loaded in correct order. Rules should be loaded in alphabetical order. Modsec uses readdir function from unix and we suspect that this doesn't function correctly in every time.",,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,Tushar Prasad,,,,,,,,,,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4981,,,,,,,,,,,,,,,,, IJ46400,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012663900,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,LIIKENNE- JA VIESTINTÄVIRASTO TRAFICOM,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2023-04-17T13:52:34.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":5,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,AIX,Linux 86_64,,,,,,,,,,,,,0|i1aby7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-07 14:04:33.315,,,,,08/Apr/23 12:04 AM;5b15d94b6256d01ad54eb020;Why does the order matter?  Did you find something in the documentation stating that we load them in alphabetical order?,"11/Apr/23 2:17 PM;5b15d9517dab4c51f61b5190;I haven’t found anything  in modsecurity that says rules should be opened in alphabetical order

All I can find is the comment in crs-setup.conf which says

{noformat}# The order of file inclusion in your webserver configuration should always be:
# 1. modsecurity.conf
# 2. crs-setup.conf (this file)
# 3. rules/*.conf (the CRS rule files)
#
# Please refer to the INSTALL file for detailed installation instructions.{noformat}

which matches what we do programatically

What I have found is that other webservers process their rules files with a wildcard  include directive like include rules/*.conf

and other webservers document that wildcards in include directives are processed alphabetically

So I suspect we will need to change our loading to be alphabetical (to behave like other webservers)

I have raised the question with development","13/Apr/23 8:43 AM;5b15d9517dab4c51f61b5190;[~accountid:60f541a6d0134900692d91b7] 

Development confirmed we need to load modsecurity rules in alphabetcal order.

Please open an APAR “Modsec don’t load in a alphabetical order”",13/Apr/23 6:52 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9517dab4c51f61b5190] ok thanks for the confirmation i will create an APAR and update you,13/Apr/23 9:01 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9517dab4c51f61b5190] APAR created successfully with number: IJ46400,"14/Apr/23 10:33 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e069bbcf12e1b34c6082b604e2002c840905141c
   * description: ISAMSUP-4963 IJ46400 Load Modsecurity rules in alphabetical order

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/96553.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4963) which we publish.","14/Apr/23 12:13 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e069bbcf12e1b34c6082b604e2002c840905141c
   * description: ISAMSUP-4963 IJ46400 Load Modsecurity rules in alphabetical order

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/96553.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4963) which we publish.","17/Apr/23 1:52 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 54044e6abc15caa5b28d4192106a6fae41856d7f
   * description: Merge pull request #5839 from ISAM/ISAMSUP-4963

ISAMSUP-4963 IJ46400 Load Modsecurity rules in alphabetical order

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/106389.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230417034930-54044e6a.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","17/Apr/23 3:09 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 54044e6abc15caa5b28d4192106a6fae41856d7f
   * description: Merge pull request #5839 from ISAM/ISAMSUP-4963

ISAMSUP-4963 IJ46400 Load Modsecurity rules in alphabetical order

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/106529.


This build has not been published as the commit is not currently within a branch (20230417034930-54044e6a) which we publish.","17/Apr/23 4:49 PM;5b15d9517dab4c51f61b5190;[~accountid:60f541a6d0134900692d91b7] 

The fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4981|https://cloudidentity.atlassian.net/browse/ISAMSUP-4981|smart-link] 

It requires 10.0.5.0 IF1 is already installed.","11/May/23 10:49 PM;5b15d9517dab4c51f61b5190;fixpack was provided to customer on 17th april

no response from them in the case since then

So closing",17/May/23 1:38 AM;60f541a6d0134900692d91b7;[~accountid:5b15d9517dab4c51f61b5190] Yes no response from the customer we can close this case,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
RBA Auditing throws stack trace when using TLS to syslog server,ISAMSUP-4958,292491,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,06/Apr/23 7:22 AM,26/Jun/23 2:08 PM,14/Jul/23 2:47 PM,,,Support,,0,,,,"Stack trace in question:

{noformat}[4/5/23, 16:20:41:904 CDT] 00000029 id=00000000 com.tivoli.am.rba.auditing.CBEXMLSyslogEventHandler          I init java.security.NoSuchAlgorithmException: SSL_TLSv2 SSLContext not available
        at java.base/sun.security.jca.GetInstance.getInstance(Unknown Source)
        at java.base/javax.net.ssl.SSLContext.getInstance(Unknown Source)
        at com.ibm.isam.logging.syslogclient.TLSManager.<init>(TLSManager.java:375)
        at com.ibm.isam.logging.syslogclient.TLSManager.<init>(TLSManager.java:204)
        at com.ibm.isam.logging.syslogclient.SyslogHandler.<init>(SyslogHandler.java:141)
        at com.tivoli.am.rba.auditing.CBEXMLSyslogEventHandler.init(CBEXMLSyslogEventHandler.java:121)
        at com.tivoli.am.rba.auditing.CBEXMLSyslogEventHandler.init(CBEXMLSyslogEventHandler.java:62)
        at com.tivoli.am.rba.auditing.RuntimeAuditHelper$AuditEventHandlerCache.postConstruct(RuntimeAuditHelper.java:164)
        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.base/java.lang.reflect.Method.invoke(Unknown Source)
        at com.tivoli.am.fim.om.ObjectManager$Configuration.getObject(ObjectManager.java:172)
        at com.tivoli.am.fim.om.ObjectManager.get(ObjectManager.java:104)
        at com.tivoli.am.rba.auditing.RuntimeAuditHelper$AuditEventHandlerCache.getInstance(RuntimeAuditHelper.java:141)
        at com.tivoli.am.rba.auditing.RuntimeAuditHelper.isAuditable(RuntimeAuditHelper.java:52)
        at com.tivoli.am.rba.pip.RiskCalculatorPIP.logAuditEvent(RiskCalculatorPIP.java:550)
        at com.tivoli.am.rba.pip.RiskCalculatorPIP.computeRiskScore(RiskCalculatorPIP.java:196)
        at com.tivoli.am.rba.pip.RiskCalculatorPIP.getSubjectAttributes(RiskCalculatorPIP.java:143){noformat}

This means that auditing for device registration is broken when using TLS to a syslog server.",,David Hayes,jcyarbor,khansen,Nick Lloyd,Rachel Tomas,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,70121:0ba4f8fa-8042-4ac9-914a-4a02dabc3187,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24/May/23 5:56 AM;jcyarbor;ISAMSUP-4958_messages.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202146,24/May/23 5:56 AM;jcyarbor;ISAMSUP-4958_trace.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202147,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,Internal,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,ISVA L2 Support Team,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1aacf:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-04-06 11:07:55.833,,,,,06/Apr/23 7:24 AM;5bac25aaabfcbf73d13e733b;I found this when working on something in my Allstate environment so they will hit this or are already hitting this issue. It seems to be related to the JVM differences between IBM Java and the OpenJDK based java as OpenJDK probably doesn’t have ‘SSL_TLSv2' as an option.,"06/Apr/23 9:07 PM;5b15d954b0d76456f36daf33;[~accountid:5bac25aaabfcbf73d13e733b] 

What does your LMI jvm options file look like? Especially for {{https.protocol}}. I thought by default we only had TLSv1.2. Was that changed via administrator options to include other protocols?

If not,  are you able to recreate the error but with {{javax.net.debug=ssl}} jvm option in place?

You can add it via an ATP:

{noformat}Name: lmi.jvm_option.1
Value: -Djavax.net.debug=ssl{noformat}

That might give additional info we need to troubleshoot. The remediation from a quick search looks like is adding a new jvm system property and/or specifying a ciphersuite.",22/May/23 10:08 AM;5b15d954b0d76456f36daf33;[~accountid:5bac25aaabfcbf73d13e733b] did you get a chance to revisit this?,"23/May/23 8:00 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d954b0d76456f36daf33] ,

the above stack trace is from the runtime JVM.

I checked both server.xml files and neither reference the ‘SSL_TLSv2’ in the configuration files:

{noformat}bash-4.4# grep ""SSL_TLSv2"" /opt/ibm/wlp/usr/servers/default/server.xml
bash-4.4# grep ""SSL_TLSv2"" /opt/ibm/wlp/usr/servers/runtime/server.xml
bash-4.4#{noformat}

I’ll work on recreating it with the tracing you’ve requested.","24/May/23 5:56 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d954b0d76456f36daf33] ,

So the error shows up in both the LMI and the AAC JVM.

To recreate in the LMI JVM you just have to enable AAC auditing to a remote server using ‘TLS’.

Then, after the JVM restarts you can access ‘Access Control Policies’ and it will throw the error.

Here is a trace that has the requested tracing enabled:

[^ISAMSUP-4958_messages.log]
[^ISAMSUP-4958_trace.log]

The ‘com.ibm.isam.logging.syslogclient.TLSManager’ needs to be investigated cause it seems there’s either hard coded code or it’s not picking up the values from the LMI/AAC configuration.",13/Jun/23 12:18 PM;5b232b2fd85e5b59b066f57f;@bkumar - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"13/Jun/23 12:30 PM;5b15d954b0d76456f36daf33;Haven’t finished analysing the new traces, but from the call stack, looks like the fallback option for default TLS seems to be incorrect.",22/Jun/23 12:14 PM;5b15d954b0d76456f36daf33;We are setting the default value for TLS correctly so I can’t yet explain where it is being changed to SSL_TLSv2. Continuing to investigate ,"26/Jun/23 2:08 PM;5b15d954b0d76456f36daf33;[~accountid:5bac25aaabfcbf73d13e733b] I see the same issue on a newer 10.0.6 also, so something is definitely not working. Go ahead and create an APAR.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Memory growth issue ISVA AAC/Federation 10.0.2.0,ISAMSUP-4956,292476,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,06/Apr/23 2:13 AM,08/Jul/23 2:07 AM,14/Jul/23 2:47 PM,,,Support,06/Apr/23 12:00 AM,0,,,,"Asking, seeking L3 assistance, recommendations with regard to troubleshooting this memory usage issue.
Customer is experiencing ongoing memory growth issue on their ISVA AAC/Federation appliance.
Memory is primarily used by LMI & Runtime JVMs, more so the runtime.

Customer's summary as follows;

# We have two environments, PRE and PRO
PRE has version 10.0.3- 2 machines for the federation module and 4 poc machines (webseal)-This environment has little use and the problem has not been detected
PRO has version 10.0.2- 2 machines for the federation module and 4 poc machines (webseal)-This environment is where we have the problem of increase of memory that occurs in the federation machines.
# Federation machines have 8 cores and 14Gb of RAM.
# It doesn't release memory, every day consumes a little more.
# The problems begin as soon as the memory is 50%, not delivering the token or taking up to 2 minutes, causing in the webseal, request with error 500 and not letting the users authenticate
# The only corrective measure we have taken is when the error arrives, restarting the system with this becomes the memory well until a time passes and causes the same errors again.
# There is still no error, but if you see the graph that we send you will see that at the time of the restart the memory has returned to normal levels and with the passage of the weeks it is growing.

Customer is asking the following questions;
1 - Why the memory is not released?
2 - Is there a way to avoid this?
3 - Is there any command that releases memory, without restarting the appliances?

Customer is running 10.0.2.0 with no IF1 as far as I am aware.
Past upgrade history is as follows;
  name: Firmware	  version: !str 10.0.2.0  event_type: Install   date: 2021-09-18 00:32:44
  name: Firmware	  version: !str 9.0.7.1	  event_type: Install	  date: 2020-04-13 17:35:26
  name: Firmware	  version: !str 9.0.5.0	  event_type: Install	  date: 2019-02-18 22:39:20
  name: Firmware	  version: !str 9.0.1.0	  event_type: Install	  date: 2016-08-11 06:06:21
Customer non-committal to possible future upgrade = strange considering upgrade path taken above, plus they have their pre-prod running ISVA 10.0.3. To quote customer "" _We have no intention of uploading the product version. Is it possible to fix the problem without having to update?_ ""
Customer also non-responsive when asked to apply 10.0.2.0 IF1 = very, very strange.

I have looked through and cross referenced BH's Jira Work Item 4072.  
[https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|https://cloudidentity.atlassian.net/browse/ISAMSUP-4072|smart-link] 
Nothing is immediately jumping out as yet.

One other observation concerns RSYSLOG errors in the system messages log i.e. "" rsyslogd: message too long "". 
{{Mar  1 15:01:48 rsyslogd: message too long (22321) with configured size 6144, begin of message is: [3/1/23 15:01:43:009 CET] 00062e86 id=00000000 com.tivoli.am.fim.oauth20.util.OA [v8.1911.0-6.el8.ibm.1 try https://www.rsyslog.com/e/2445 ]}}
Would this have an impact on memory usage?",,Dermot Daly,gvacek,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5c87cb8d88f9ec6ae0afb306,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,07/Apr/23 1:48 AM;ug:0d23f3f4-385c-47fa-b5f8-ecbd0333ad03;TS012330470 - High system memory consumption - Summary Top Processes.txt;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/194874,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012330470,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,CORREOS Y TELEGRAFOS S.A CAMPO DE LAS NACIONES,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"March 16th
/ecurep/sf/TS012/330/TS012330470/2023-03-16/isva_10.0.2.0_20230316-153514_paz163.correosext.local.support_unpack/

March 27th
/ecurep/sf/TS012/330/TS012330470/2023-03-27/isva_10.0.2.0_20230327-175811_paz163.correosext.local.support_unpack/

""antes reinicio"" = before restart April 3rd 
/ecurep/sf/TS012/330/TS012330470/2023-04-04/isva_10.0.2.0_20230403-215104_paz163.correosext.local_antes_reinicio.support_unpack/

""despues reinicio"" = after restart April 3rd 
/ecurep/sf/TS012/330/TS012330470/2023-04-04/isva_10.0.2.0_20230403-223601_paz163.correosext.local_Despues_Reinicio.support_unpack/",,,,,,,,,,,,,,,,,,,,,,,0|i1aa7r:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-04-07 14:21:00.875,,,,,"06/Apr/23 2:18 AM;6154906364ff01007106e189;Also asked customer to generate and provide java_dump heap files for both LMI & Runtime JVMs over various times i.e.
1) March 27th multiple times, as in 3 times over a half hour period 
2) BEFORE and AFTER next appliance restart which was on April 3rd just past.
Summary findings posted further below regarding this.

----

[LMI heapdumps x 3 on March 27th over a half hour period i.e. 17:33 & 17:43 & 17:55|https://ecurep.mainz.de.ibm.com/rest/download/TS012330470/2023-03-27/isva_10.0.2.0_20230327-175811_paz163.correosext.local.support_unpack/tmp/liberty_dump.zip_unpack/logs/heapdump.20230327.175528.1564.0006.phd-memoryanalyzer_AE_PD/heapdump.20230327.175528.1564.0006_memoryanalyzer.html]
17:33 LMI Leak Suspects
Problem Suspect 1	16,912 instances of java.lang.Class occupy 19,009,528 (20.96%) bytes.
Problem Suspect 2	96 instances of com.ibm.ws.artifact.overlay.internal.DirectoryBasedOverlayContainerImpl occupy 13,335,264 (14.70%) bytes.

17:43 LMI Leak Suspects
Problem Suspect 1	16,912 instances of java.lang.Class occupy 19,016,592 (21.00%) bytes.
Problem Suspect 2	96 instances of com.ibm.ws.artifact.overlay.internal.DirectoryBasedOverlayContainerImpl occupy 13,335,264 (14.72%) bytes.

17:55 LMI Leak Suspects
Problem Suspect 1	16,898 instances of java.lang.Class occupy 18,719,520 (20.77%) bytes.
Problem Suspect 2	96 instances of com.ibm.ws.artifact.overlay.internal.DirectoryBasedOverlayContainerImpl occupy 13,335,264 (14.79%) bytes.

[LMI heapdumps x 1 on April 3rd 21:49 i.e. BEFORE system restart|https://ecurep.mainz.de.ibm.com/rest/download/TS012330470/2023-04-04/isva_10.0.2.0_20230403-215104_paz163.correosext.local_antes_reinicio.support_unpack/tmp/liberty_dump.zip_unpack/logs/heapdump.20230403.214910.1564.0008.phd-memoryanalyzer_AE_PD/heapdump.20230403.214910.1564.0008_memoryanalyzer.html]
Problem Suspect 1	16,959 instances of java.lang.Class occupy 18,697,176 (20.60%) bytes.
Problem Suspect 2	96 instances of com.ibm.ws.artifact.overlay.internal.DirectoryBasedOverlayContainerImpl occupy 13,335,264 (14.69%) bytes.

[LMI heapdumps x 1 on April 3rd 22:33 i.e. AFTER system restart|https://ecurep.mainz.de.ibm.com/rest/download/TS012330470/2023-04-04/isva_10.0.2.0_20230403-223601_paz163.correosext.local_Despues_Reinicio.support_unpack/tmp/liberty_dump.zip_unpack/logs/heapdump.20230403.223333.1568.0002.phd-memoryanalyzer_AE_PD/heapdump.20230403.223333.1568.0002_memoryanalyzer.html]
Problem Suspect 1	13,522 instances of java.lang.Class occupy 13,439,968 (17.53%) bytes.
Problem Suspect 2	96 instances of com.ibm.ws.artifact.overlay.internal.DirectoryBasedOverlayContainerImpl occupy 13,332,992 (17.39%) bytes.
Problem Suspect 3	34 instances of com.ibm.ws.artifact.zip.internal.ZipFileContainer occupy 8,853,656 (11.55%) bytes.

----

[Runtime heapdumps x 3 on March 27th over a half hour period i.e. 17:33 & 17:43 & 17:55|https://ecurep.mainz.de.ibm.com/rest/download/TS012330470/2023-03-27/isva_10.0.2.0_20230327-175811_paz163.correosext.local.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/heapdump.20230327.175534.18575.0006.phd-memoryanalyzer_AE_PD/heapdump.20230327.175534.18575.0006_memoryanalyzer.html]
17:33 Runtime Leak Suspects
Problem Suspect 1	One instance of org.apache.cxf.transport.http.osgi.HTTPTransportActivator occupies 40,529,232 (20.51%) bytes. The memory is accumulated in one instance of java.lang.Object[] which occupies 40,528,776 (20.51%) bytes.
Problem Suspect 2	One instance of com.tivoli.am.sms.client.DSessProxyPool occupies 29,018,832 (14.68%) bytes. The memory is accumulated in one instance of java.lang.Object[] which occupies 29,018,048 (14.68%) bytes.
Problem Suspect 3	17,871 instances of java.lang.Class occupy 24,280,056 (12.28%) bytes.

17:43 Runtime Leak Suspects
Problem Suspect 1	One instance of org.apache.cxf.transport.http.osgi.HTTPTransportActivator occupies 40,543,000 (23.50%) bytes. The memory is accumulated in one instance of java.lang.Object[] which occupies 40,542,544 (23.50%) bytes.
Problem Suspect 2	One instance of com.tivoli.am.sms.client.DSessProxyPool occupies 20,840,264 (12.08%) bytes. The memory is accumulated in one instance of java.lang.Object[] which occupies 20,839,480 (12.08%) bytes.
Problem Suspect 3	17,864 instances of java.lang.Class occupy 34,118,184 (19.78%) bytes.

17:55 Runtime Leak Suspects
Problem Suspect 1	One instance of com.tivoli.am.sms.client.DSessProxyPool occupies 20,756,128 (12.22%) bytes. The memory is accumulated in one instance of java.lang.Object[] which occupies 20,755,344 (12.21%) bytes.
Problem Suspect 2	274,031 instances of org.apache.cxf.transport.http.osgi.HTTPTransportActivator$PidInfo occupy 39,460,464 (23.22%) bytes. These instances are referenced from one instance of java.lang.Object[] which occupies 1,096,280 (0.65%) bytes.
Problem Suspect 3	17,862 instances of java.lang.Class occupy 18,812,744 (11.07%) bytes.

[Runtime heapdumps x 1 on April 3rd 21:49 i.e. BEFORE system restart|https://ecurep.mainz.de.ibm.com/rest/download/TS012330470/2023-04-04/isva_10.0.2.0_20230403-215104_paz163.correosext.local_antes_reinicio.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/heapdump.20230403.214937.18575.0008.phd-memoryanalyzer_AE_PD/heapdump.20230403.214937.18575.0008_memoryanalyzer.html]
Problem Suspect 1	One instance of org.apache.cxf.transport.http.osgi.HTTPTransportActivator occupies 95,982,912 (39.07%) bytes. The memory is accumulated in one instance of java.lang.Object[] which occupies 95,982,456 (39.07%) bytes.
Problem Suspect 2	One instance of com.ibm.ejs.j2c.PoolManager occupies 24,797,200 (10.09%) bytes. The memory is accumulated in one instance of java.lang.Object[] which occupies 24,189,712 (9.85%) bytes.

[Runtime heapdumps x 1 on April 3rd 22:33 i.e. AFTER system restart|https://ecurep.mainz.de.ibm.com/rest/download/TS012330470/2023-04-04/isva_10.0.2.0_20230403-223601_paz163.correosext.local_Despues_Reinicio.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/heapdump.20230403.223353.1882.0002.phd-memoryanalyzer_AE_PD/heapdump.20230403.223353.1882.0002_memoryanalyzer.html]
Problem Suspect 1	The class com.tivoli.am.fim.om.ObjectManager occupies 16,124,840 (15.48%) bytes. The memory is accumulated in one instance of com.tivoli.am.fim.fedmgr2.page.PageSelectionCriteriaList which occupies 12,231,352 (11.74%) bytes.","07/Apr/23 1:48 AM;6154906364ff01007106e189;[^TS012330470 - High system memory consumption - Summary Top Processes.txt]


Summary on top processess attached + Summary Table below (Mem / Free / shrd / buff / cached) from Support files x 4 i.e.
{{Date		Uptime	        Mem	        Free		shrd	buff	  cached	Mem+Free+shrd+buff}}
{{March 16th 	 14 days	8,924,640	5,413,604	55,740	172,356	  3,797,144	14,566,340}}
{{March 27th 	 25 days	11,926,336	2,411,908	55,868	179,184	  5,662,532	14,573,296}}
{{April 3rd 	 32 days	13,867,800	470,444	        55,792	179,468	  6,715,400	14,573,504}}
{{April 3rd 	 30 minutes	6,353,200	7,985,044	52,136	41,312	  4,241,976	14,431,692}}
","08/Apr/23 12:21 AM;5b15d94b6256d01ad54eb020;I think most of their problem is caused by this:

Problem Suspect 2	274,031 instances of org.apache.cxf.transport.http.osgi.HTTPTransportActivator$PidInfo occupy 39,460,464 (23.22%) bytes. These instances are referenced from one instance of java.lang.Object[] which occupies 1,096,280 (0.65%) bytes.

For 10.0.2.0  install this fix  pack

[https://ibm.ent.box.com/folder/142304262332|https://ibm.ent.box.com/folder/142304262332|smart-link] 
",12/Apr/23 12:20 AM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189] I just reviewed the case and  it still says IBM working and it doesn’t look like you provided them with the fix pack.,12/Apr/23 7:58 PM;6154906364ff01007106e189;Thank you [~accountid:5b15d94b6256d01ad54eb020] - we had a public holiday on Monday April 10th over here. Customer has been duly informed with install_liberty_fix_1020.fixpack provided in TS012330470.,"12/Apr/23 11:36 PM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189] Thanks Brian, I didn’t know about that.  ","25/Apr/23 4:07 AM;6154906364ff01007106e189;Customer has eventually come back, but there is a BUT. Latest update from customer is they are very reluctant to install the liberty fixpack for 10.0.2 i.e.
"" We have not applied the patch because we have found something that has worked for us to release the memory, but we have had doubts about why we have this problem ....... when we apparently restart the cluster runtime and at that moment it releases the memory without having to turn off the machine completely. ""

I have spoken to their IBM TAM ([Maria|https://w3.ibm.com/#/people/010386838]), who has made me aware that customer is reluctant to spend time + resources on ISVA production environment. Looking at the [HVDB logs|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012330470&path=TS012330470%2F2023-04-04%2Fisva_10.0.2.0_20230403-223601_paz163.correosext.local_Despues_Reinicio.support_unpack%2Fvar%2Fpostgresql%2Flogs%2Fhvdb%2Fserver%2F&filepath=TS012330470%2F2023-04-04%2Fisva_10.0.2.0_20230403-223601_paz163.correosext.local_Despues_Reinicio.support_unpack%2Fvar%2Fpostgresql%2Flogs%2Fhvdb%2Fserver%2Fpostgresql-Mon.log], there is a cluster issue. Plus to note they are using internal DBs for both ConfigDB & HVDB, which obviously is not recommended in a Production environment. IBM TAM Maria has (or is going to) recommended to customer to open a new case concerning cluster issue as well as the importance of installing the liberty fixpack for 10.0.2.","25/Apr/23 4:11 AM;5b15d94b6256d01ad54eb020;That’s up to them but they don’t need to restart the machine to apply  the fixpack.  True that restarting the runtime will free up the memory so if they are okay with that then that’s fine.  If they do install the fix pack the run time will need to be restarted which I think the installation does for them.   

They should always tests fix packs in a test environment  before applying them in production anyway.","09/May/23 1:09 AM;6154906364ff01007106e189;Update from customer ;
"" On Wednesday (May 3rd) last we applied the fix in production. We'll wait a few days to see if we see if the memory stabilizes or continues to increase. ""
Will await their next update.",09/May/23 1:11 AM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189]   Thanks for the update.  That fix pack should take care of  their problem.,01/Jun/23 12:14 AM;5b15d901fa615349cb01778b;case closed,13/Jun/23 12:00 AM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189] when you re-open a Jira case you need to provide a comment to explain why.,"13/Jun/23 12:10 AM;6154906364ff01007106e189;Hi [~accountid:5b15d94b6256d01ad54eb020] customer has reopened TS012330470 due to reoccurrence of memory growth i.e. see 30 day memory graph snapshot for month of May as at [here|https://ecurep.mainz.de.ibm.com/rest/download/TS012330470/2023-06-09/Memory.png?fileSize=84856&clientId=ae5].

The install_liberty_fix_1020.fixpack got installed back on May 3rd.
Can you advise on ‘specific’ support data which I should request? 
Previously I requested java dumps back at the end of March from the CLI for both default and runtime.
Should I request the same again prior to any corrective measures taken by the customer?
As far as I know, the corrective measure taken is to restart the system.","13/Jun/23 12:14 AM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189] Have they made any other changes besides installing the fix pack?  Have they installed any  other new fix packs?   We will need a new support file, javacore   and a heapdump  that is generated when the problem occurs or just before.  That fix pack does correct the problem we originally saw so they may now be seeing a different problem.

I’ll add that they should collect a few javacores separated by a day or two depending on how long it takes for them to notice the increase.  Collect the heapdump with the last javacore. ",13/Jun/23 12:47 AM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189] go ahead and have them send in a support file now so I can take a look at the current state.  I want to check and try to verify if the fix pack was installed correctly.   Also collect the javacores and heapdump as I mentioned in my last comment.,"13/Jun/23 1:52 AM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189] I was just looking over the case.   You got it partially correct.  I’ll summarize:

I want a current support file  now showing the current state,

Then collect a series of javacores over a few days so we can see the growth.  Don’t collect a support file each time.

After they have seen a substantial amount of memory growth but before they have to restart either the runtime or appliance, then collect a final  javacore and a heapdump.  Then send a new support file at this time with the javacores and heapdump.","20/Jun/23 8:38 PM;6154906364ff01007106e189;Just to update, still waiting on customer, who is reluctant and slow in providing fresh support data as requested.","08/Jul/23 2:07 AM;6154906364ff01007106e189;Hi [~accountid:5b15d94b6256d01ad54eb020] the customer has uploaded new support data, yesterday i.e. July 6th [here|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012330470&path=TS012330470%2F2023-07-06%2F]. But, I think not as desired. Probably my bad here by not explaining explicitly. Here is customers translation response from Spanish into English;

^_I upload the requested javadumps, this is before restarting, generates two files for each run;_^
^_Dumping server default._^
^_Server default dump complete in /tmp/javacore.20230706.135219.1504.0001.txt._^
^_Server default dump complete in /opt/IBM/wlp/usr/servers/default/logs/heapdump.20230706.135220.1504.0002.phd._^
^_paz163.correosext.local:diagnostics> java_dump runtime heap_^

^_Dumping server runtime._^
^_Server runtime dump complete in /opt/IBM/wlp/usr/servers/runtime/logs/javacore.20230706.135252.1706.0001.txt._^
^_Server runtime dump complete in /opt/IBM/wlp/usr/servers/runtime/logs/heapdump.20230706.135253.1706.0002.phd._^

^_We restarted the runtime today (July 6th) and with them attached: -Snapshot and Support file Before restart._^
^_With slowness issues to get the token with memory at 43% -Snapshot and Support file After the restart, with everything working._^
^_Commenting that the memory has gone up the last few days of the order of 2% blow every day without recovery of the same, it seems that the fix is not enough to recover the memory and that reached to 43% we start to have problems._^

Strange since creation of this case there was only 1 appliance data being uploaded i.e. that which contains ""paz163"" in the appliance hostname, now in July 6th data they have also provided data from ""paz164"". Why they have also given snapshot data is beyond me. Concentrating on July 6th ""paz163"" support file data, can see the following memory usage pre and post runtime restart;

{{Appliance	Time	Mem Used	Free	        shrd	 buff	  cached	Mem+Free+shrd+buff}}
{{July 6th	13:58	14,161,856	176,388	        55,500	 167,284  7,614,528	14,561,028}}
{{July 6th	14:34	10,609,960	3,728,284	55,496	 135,456  7,325,848	14,529,196}}

I have run the memory analyzer on the heapdumps x 2 provided with the following leaky suspects

Report: heapdump.20230706.135220.1504.0002_Leak_Suspects
Problem Suspect 1 	17,086 instances of java.lang.Class occupy 19,612,944 (20.94%) bytes.
Problem Suspect 2 	96 instances of com.ibm.ws.artifact.overlay.internal.DirectoryBasedOverlayContainerImpl occupy 13,334,896 (14.24%) bytes.

Report: heapdump.20230706.135253.1706.0002_Leak_Suspects
Problem Suspect 1	One instance of com.ibm.ejs.j2c.PoolManager occupies 89,358,744 (27.91%) bytes. The memory is accumulated in one instance of java.lang.Object[] which occupies 88,781,400 (27.73%) bytes.
Problem Suspect 2	575 instances of org.postgresql.jdbc.PgConnection occupy 32,400,560 (10.12%) bytes.


Appreciate, when you get a chance to review the data as provided, to see what other observations you may find.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Unable to set multiple cookies from template files.,ISAMSUP-4954,292443,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,05/Apr/23 11:23 PM,15/Apr/23 10:54 AM,14/Jul/23 2:47 PM,15/Apr/23 10:54 AM,,Support,,0,,,,"The customer is trying to set two cookies in template files. always set last one only. maybe its override. do we have any alternative to set multiple cookies from template file?



{noformat} templateContext.response.setHeader(""Set-Cookie"", 
        templateContext.macros[""@INFO_COOKIENAME@""] + ""="" + templateContext.macros[""@INFO_COOKIEVALUE@""] + 
        ""; domain=.att.com; secure"");

        templateContext.response.setHeader(""Set-Cookie"", 
        templateContext.macros[""@COOKIENAME@""] + ""="" + templateContext.macros[""@COOKIEVALUE@""] + 
        ""; domain=.att.com; secure""); {noformat}



the customer set the values in infomap mapping rule, as per our understanding setHeader has two params as key and value. key is 'Set-Cookie' value is cookie part.  while present the value is ok. If they set a second cookie, its override value (like key is unique - hashmap behavior). The customer requirement is that he would like to add multiple cookies in single template file.



{noformat}var handler = new HtmlPageChallengeDecisionHandler();

		handler.setPageId(""/access_policy/setcookie.html"");

		handler.setMacro(""@COOKIENAME@"", ""fhSessID"");

		handler.setMacro(""@COOKIEVALUE@"", ""hSessID values"");

		handler.setMacro(""@URI@"", uri);



		var jsoncookiemap = JSON.parse(cookiemap);

		handler.setMacro(""@INFO_COOKIENAME@"", ""mytest"");

		handler.setMacro(""@INFO_COOKIEVALUE@"", ""my ifo test"");



		decision = Decision.challenge(handler);

		context.setDecision(decision);{noformat}



By doing lab test, seems to be an oversight.  Last one wins.

For the Set-Cookie header it should build an array.",,David Hayes,jcyarbor,khansen,Nick Lloyd,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012603025 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,,,,AT&T SERVICES INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1aa1r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-07 20:47:22.346,,,,,"08/Apr/23 6:47 AM;5b15d94b6256d01ad54eb020;The way  templateContext.response.setHeader()  is currently implemented  you can’t  set  duplicate header names.

*Internal Comment:*

It uses a hashmap s othe keys need to be unique.",11/Apr/23 1:48 AM;5bac25aaabfcbf73d13e733b;Provided update to customer. Gave alternatives of setting cookies with JavaScript at the client interpretation of the template page or by setting headers and using an HTTP Transformation to change those to cookies.,11/Apr/23 2:27 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25aaabfcbf73d13e733b]   Thanks Jack.  I’ll set response due L2 for now.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
cdsso issues,ISAMSUP-4950,292071,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,05/Apr/23 1:23 AM,13/Apr/23 2:28 AM,14/Jul/23 2:47 PM,13/Apr/23 2:28 AM,,Support,,0,,,,"Cust is running 10.0.3.1 with no fixpacks.

They reported an issue with CDSSO when they enable 

enforce-max-sessions-policy = yes
prompt-for-displacement = yes


However, in looking at the traces which can be found in 
/ecurep/sf/TS012/589/TS012589466/2023-04-04/Support_Files-04032023.zip_unpack/Support_Files-04032023/samextwbs2prda.ct.gov/isva_10.0.3.1_20230403-184413_samextwbs2prda.ct.gov.support_unpack/var/pdweb/cp_prod/trace


and the har file found at 
S:\sf\TS012\589\TS012589466\2023-04-04\har-file04032023.zip_unpack\har-file04032023\CT_ahct_Fail_4_3_23.zip_unpack\CT_ahct_Fail_4_3_23.har

I noticed the following

First the user sends request to pkmscdsso to generate the redirect to the cdsso consumer

The request to the CDSSO consumer is done, but already has a PD-S-SESSIONID to webseal seems to try to use that.


From the pdweb.wns.authn.log I see this



{noformat}2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:6 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:3751: [10.64.52.205] CEI ENTER authAndProcess

2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:3788: [10.64.52.205] Auth enabled
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:3793: [10.64.52.205] Calling handleAuth
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:3328: [10.64.52.205] CII ENTER handleAuth

2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:2651: [10.64.52.205] CII ENTER getSessionAndCreds2

2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:2177: [10.64.52.205] CII ENTER getSessionAndCreds

2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:4 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-getsess.cpp:197: [10.64.52.205] getCookieSess: ENTER
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-getsess.cpp:214: [10.64.52.205] getCookieSess cookie_ptr[1_hvEJBbnRPCweUGcECG7RYC6u28zTXatc3h2saIVwJGM675Tt+2o=] cookie_type[PD-S-SESSION-ID]
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-getsess.cpp:301: [10.64.52.205] getCookieSess Attempt to use real session
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:4 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-getsess.cpp:354: [10.64.52.205] getCookieSess: EXIT  TRUE
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:1921: [10.64.52.205] CII ENTER getSession

2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:2800: [10.64.52.205] WSCredsCacheEntry::getLifetimeTimeout = 1680577742
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:1377: [10.64.52.205] WSCredsCacheEntry::hasCreds = 1
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:1405: [10.64.52.205] WSCredsCacheEntry::getCreds= 0x02de88b0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:1377: [10.64.52.205] WSCredsCacheEntry::hasCreds = 1
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:2024: [10.64.52.205] from-cache = TRUE
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:1532: [10.64.52.205] CII ENTER setupHUserName

2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:1389: [10.64.52.205] WSCredsCacheEntry::getCredsNoCopy = 0x02de88b0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:1241: [10.64.52.205] WSCredsCacheEntry::hasLoginUserName = 1
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:1254: [10.64.52.205] WSCredsCacheEntry::getLoginUserName qhpuser040323
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:1549: [10.64.52.205] setupHUserName name=qhpuser040323
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:1577: [10.64.52.205] CII EXIT setupHUserName

2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:2349: [10.64.52.205] WSCredsCacheEntry::getLifetimeExtended = 0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:2397: [10.64.52.205] WSCredsCacheEntry::getRefreshFailover = 0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:2123: [10.64.52.205] CII EXIT getSession with status=0x00000000

2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:2424: [10.64.52.205] WSCredsCacheEntry::getReauthRequired = 0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:2735: [10.64.52.205] WSCredsCacheEntry::getIsInactive_ = 0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:2451: [10.64.52.205] WSCredsCacheEntry::getForceReauth = 0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:1982: [10.64.52.205] WSCredsCacheEntry::getStepUp = 0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:2478: [10.64.52.205] WSCredsCacheEntry::getLastStatus = 0x38b9a41f
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:2672: [10.64.52.205] WSCredsCacheEntry::getTooManySessions = 1
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:1131: [10.64.52.205] WSCredsCacheEntry::canUseCred = 0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:2453: [10.64.52.205] Will use unauth cred
{noformat}



*Why is it switching to an unauth  session?*




From the pdweb.wns.session.log trace I see 


{noformat}2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp:663: [10.64.52.205] ENTER WSRemoteCache::getNewKey(default)
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:8 /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp:636: [10.64.52.205] CALL WSRemoteCache::getRsHandle(default)
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:8 /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp:645: [10.64.52.205] RETURN WSRemoteCache::getRsHandle = 0x29fe7c0
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp:685: [10.64.52.205] RETURN WSRemoteCache::getNewKey, status=0x00000000
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp:1504: [10.64.52.205] ENTER WSRemoteCache::findEntry
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:623: [10.64.52.205] ENTER WSPartitionedCache::findEntry
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:9 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:646: [10.64.52.205] searching for (1): hvEJBbnRPCweUGcECG7RYC6u28zTXatc3h2saIVwJGM675Tt+2o=:default
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:9 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:681: [10.64.52.205] auth[0x7fa5100ab320]: found
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:684: [10.64.52.205] RETURN WSPartitionedCache::findEntry: rc=0x00000000
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:495: [10.64.52.205] ENTER WSPartitionedCache::getEntryLifetimeTimeout
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:9 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:500: [10.64.52.205] auth[0x7fa5100ab320]: lifetime timeout: 1680577742
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:502: [10.64.52.205] RETURN WSPartitionedCache::getEntryLifetimeTimeout: rc=0x642b94ce
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp:1550: [10.64.52.205] RETURN WSRemoteCache::findEntry rc=0x00000000
2023-04-03-18:14:40.127-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp:1669: [10.64.52.205] RETURN WSRemoteCache::findEntry rc=0x00000000
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp:1324: [10.64.52.205] ENTER WSRemoteCache::unlockEntry
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:495: [10.64.52.205] ENTER WSPartitionedCache::getEntryLifetimeTimeout
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:9 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:500: [10.64.52.205] auth[0x7fa5100ab320]: lifetime timeout: 1680577742
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:502: [10.64.52.205] RETURN WSPartitionedCache::getEntryLifetimeTimeout: rc=0x642b94ce
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:402: [10.64.52.205] ENTER WSPartitionedCache::unlockEntry
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:9 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:417: [10.64.52.205] auth[0x7fa5100ab320]: unlocking
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSPartitionedCache.cpp:419: [10.64.52.205] RETURN WSPartitionedCache::unlockEntry
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/session/WSRemoteCache.cpp:1416: [10.64.52.205] RETURN WSRemoteCache::unlockEntry rc=0x00000000
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/webseald/credscache/WSCookieJar.cpp:615: [10.64.52.205] ENTER WSCookieJar::processClientRequest
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/webseald/credscache/WSCookieJar.cpp:646: [10.64.52.205] RETURN WSCookieJar::processClientRequest
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/webseald/credscache/WSCookieJar.cpp:281: [10.64.52.205] ENTER WSCookieJar::prepareRequest
2023-04-03-18:14:40.128-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/webseald/credscache/WSCookieJar.cpp:410: [10.64.52.205] RETURN WSCookieJar::prepareRequest
2023-04-03-18:14:40.136-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/webseald/credscache/WSCookieJar.cpp:420: [10.64.52.205] ENTER WSCookieJar::processResponse
2023-04-03-18:14:40.136-04:00I----- thread(11) trace.pdweb.wns.session:6 /build/isam/src/i4w/pdweb/webseald/credscache/WSCookieJar.cpp:433: [10.64.52.205] RETURN WSCookieJar::processResponse no cookies in response
{noformat}


Is this saying that the session was expired or timed out or was it good?    Why is it being dropped to unauthenticated?",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012589466,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,,,,State of Conneticut,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a7rb:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-04-04 21:45:16.273,,,,,05/Apr/23 7:45 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] can you please review this item for Daniel and provide responses to his questions? ,"07/Apr/23 3:10 AM;5b15d9a0dda5f94d06b985b3;[~accountid:5b15d9e581c3df12acf53c4a] Just checking in to see if you had a chance to look at this yet, since I’m out tomorrow.   Thx","07/Apr/23 3:39 AM;5b15d9e581c3df12acf53c4a;Sorry, I have not gotten a chance to look into it yet, will do very soon.","11/Apr/23 4:27 AM;5b15d9e581c3df12acf53c4a;Fact here is that even though there is a credential already exists, it cannot be used because

{noformat}   /* The user's password has expired or they need to displace their
     * other sessions.
     */{noformat}

Here in this case,  there are too many sessions as indicated by the below error message also.

So, as per design, it is now starting with a unauth session.



=============================================

(_0x38b9a41f_); DPWNS1056W You are already logged in from another client. Do you want to terminate your existing login or cancel this new login request?

h4. Explanation

This message indicates that the maximum number of concurrent sessions for the user has been reached and no new sessions will be permitted until one of the existing sessions has ended.



L3 ONLY

=============

authn-main.cpp::getSessionAndCreds(…………..)

…………….

}
else if ( (h->is_reauth_request || from_cache) &&
          *_(!(*cache_entry)->canUseCred())) {
    /* The user's password has expired or they need to displace their
     * other sessions.
     */_*
    if ( h->is_mgmt_request ) {
        // This is a pkms mgmt request, which means that the
        // request will not proceed into process_junction.  It's
        // actually only used for logging.
        *creds = (*cache_entry)->getCreds();
        amwtrace_1(gAuthnTrc, AMWTRC_DUMP,
            ""Need cred for management operation"");
    }
    else {

        /*
         *   In this instance we want to make a copy of the real session
         *   ID.  We do this so that the real session ID can be added to
         *   the HTTP stream via tag-value.
         */

        if (user_session_ids_with_expired_pwd &&
                        user_session_ids && (*cache_entry)->hasCreds()) {
            azn_creds_get_attr_value_string(
                    (*cache_entry)->getCredsNoCopy(),
                    0,
                    (char*)USER_SESS_ATTR_NAME,
                    &h->user_session_id);
        }

        *_/* we'll get an unauthenticated cred later */
        amwtrace_1(gAuthnTrc, AMWTRC_DUMP, ""Will use unauth cred"");_*
    }
}

…..

……………………………………………………..

/**

* *_Checks whether this credential is OK to use for general purposes_*
* *_such as authorization checks, switch-user, failover, cookies, etc..._*
* *_A credential is OK if the user does not have an expired password and_*
* *_does not have too many sessions._*
* 
* @return TRUE if the cred is OK, FALSE otherwise.
*/
boolean32
WSCredsCacheEntry::canUseCred(void)
{
 if (ivauthn_password_expired == getLastStatus()) {
     amwtrace_2(
         gAuthnTrc,
         AMWTRC_DUMP,
         ""WSCredsCacheEntry::canUseCred = %d"",
         FALSE);
     return FALSE;
 }
 if (getTooManySessions()) {
     amwtrace_2(
         gAuthnTrc,
         AMWTRC_DUMP,
         ""WSCredsCacheEntry::canUseCred = %d"",
         FALSE);
     return FALSE;
 }
* ………………………….
* ………………………
* ","11/Apr/23 5:10 AM;5b15d9a0dda5f94d06b985b3;Hi [~accountid:5b15d9e581c3df12acf53c4a] thanks for the analysis.

So I’m still confused by something.    What we are seeing in the traces is that the user was not prompted if they wanted to displace the old session and create this new one via cdsso.     Instead, the request was forwarded to the backend as an unauthenticated request.

From the following trace…
/ecurep/sf/TS012/589/TS012589466/2023-04-04/Support_Files-04032023.zip_unpack/Support_Files-04032023/samextwbs2prda.ct.gov/isva_10.0.3.1_20230403-184413_samextwbs2prda.ct.gov.support_unpack/var/pdweb/cp_prod/trace/pdweb.debug.log



{noformat}2023-04-03-18:14:40.126-04:00I----- thread(11) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- Browser ===> PD -----------------
Thread 11; fd 336; local 10.64.52.162:443; remote 10.64.52.205:26362
GET /AHCT/anon/connect/redirect?languageCode=EN&PD-REFERER=www.prodwsl2.com&PD-ID=uXCJ1TDkfB1b5M3rUvJNYAy0tVtnZpcJNWLurJWvrWD95N3fyReVAjSTYMDSBTscRj2B0hwhmPnclgda6tOvsK4ff2YJKmC001x7KesasiPPXdDO2W4HCabzjGQ8pfy1sHIyXxyhQBIOB3mDO2V34dDuYpbWhRFj3RgSASl1yR4= HTTP/1.1
accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
accept-encoding: gzip
accept-language: en-US,en;q=0.9,ta;q=0.8
host: www.accesshealthct.com
referer: https://connect.ct.gov/


2023-04-03-18:14:40.129-04:00I----- thread(11) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- PD ===> BackEnd -----------------
Thread 11; fd 342; local 10.64.52.162:37723; remote 159.247.74.62:80
GET /AHCT/anon/connect/redirect?languageCode=EN HTTP/1.1
accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
accept-language: en-US,en;q=0.9,ta;q=0.8
connection: close
host: 159.247.74.62
iv-groups: Unauthenticated
iv-user: Unauthenticated
{noformat}","12/Apr/23 12:40 AM;5b15d9e581c3df12acf53c4a;There are thousands and one option in WebSEAL and as such, some times, it is very difficult to follow traces and figure out what exactly going on or what is supposed to happens, specially because of all these options, code takes different path based on those options.

To make it simple for me:

describe what the issue is?

what client is seeing ? error or no error?

what the expectation of the behavior is?

knowing all these, it will be bit easier to follow the trace and code to figure out what exactly supposed to happen or not.

I understand these two options you mentioned at the top, those options seems to be very simple, but it is not doing what it is supposed to, there might be a path I am missing…","12/Apr/23 2:48 AM;5b15d9a0dda5f94d06b985b3;So the customer has enabled 
enforce-max-sessions-policy = yes
prompt-for-displacement = yes

After this when they do CDSSO this should create a new session on the consumer side.   SInce they have max sessions set to 1, it should detect that there is already one session in place (which it seems to if I understood the traces and your update correctly).    

After that though, the expectation would be for webseal to show the prompt for displacement page asking if you want to replace the old session (which was created on the original cdsso server) with the new one from the cdsso consumer.    However, in the traces we don’t see this happen.    What seems to happen is that the user remains unauthenticated and the request flows to the backend as an unauthenticated user instead of an authenticated one.    

We don’t see any actual webseal errors or anything like that.

Let me know if you need further clarification.","12/Apr/23 5:20 AM;5b15d9e581c3df12acf53c4a;I see, it should show some error or login or something……let me take a deep dive….","12/Apr/23 5:31 AM;5b15d9a0dda5f94d06b985b3;Thanks Motiur.   Correct, I would have expected it to display the too_many_sessions.html page.","12/Apr/23 6:40 AM;5b15d9e581c3df12acf53c4a;Something must be there that I cannot see……

Can you recreate with turning on all traces please? that way it will make it really easy to follow trace with the codes/lines and see where thing going side ways…..

All you have to do is  turn on “pdweb”. which will turn on all components and set the file size to one big say 20MB size file, I want everything in one trace file.

Too keep the  trace file size small, only recreate the issue and get the traces along with conf files

and do mention the timestamp and action performed so that I can easily trace it.","13/Apr/23 12:56 AM;5b15d9a0dda5f94d06b985b3;Good news Motiur, we’re off the hook..

”We made the displacement silent by setting ""prompt-for-displacement = no"" - This has fixed the SSO issue.

I will therefore close this PMR. Thanks a lot for your help!”

I will leave this for you to decide if you still want to investigate on your own if it got your interest, or just close it off since the customer is happy and closed their case.

Thanks!
","13/Apr/23 1:21 AM;5b15d9e581c3df12acf53c4a;While you are collecting full traces in a single file, in the meantime, can you please give me a working scenario, specially a settings with all options where it does provide a prompt to displace a session…..

I just want to see how an working scenario takes shape.

It will be great if you can  create this working scenario where it does ask for displacement and generate a full trace…..that way I can compare why this non-working scenario is not doing what it is supposed to do…….","13/Apr/23 1:45 AM;5b15d9a0dda5f94d06b985b3;Hi Motiur,

Not sure if you saw my previous update, but the customer closed the case, so I can’t collect any more traces.    They just changed to ""prompt-for-displacement = no"" and this seems ok for them.","13/Apr/23 2:28 AM;5b15d9e581c3df12acf53c4a;Oh OK then, will not be able make any progress without additional traces, reopen latter if needed.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
10.0.5.0_IF1 fixpack installation fails when either of the process ( dsc) couldn't be restarted,ISAMSUP-4948,292013,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,04/Apr/23 7:43 PM,11/Apr/23 4:18 PM,14/Jul/23 2:47 PM,11/Apr/23 4:18 PM,,,,0,,,,"* grep dscd
* fullps -ef
root      5710  4170  0 10:02 ?        00:00:00 grep dscd
* killall -s ABRT dscd
killall: dscd: no process killed
* STATUS=1
* '[' 1 -ne 0 ]
* ERRMSG='Unable to execute post_install script, restoring files and aborting installation'
* Restore
* '[' -f /var/fixpacks/fixpack.qKS0NB/backup.tgz ]
* tar -zx -f /var/fixpacks/fixpack.qKS0NB/backup.tgz -C / --exclude dev/null
* rm -rf /var/fixpacks/fixpack.qKS0NB
* echo Unable to execute post_install script, restoring files and aborting installation
Unable to execute post_install script, restoring files and aborting installation
* exit 1







fixpack should be generic and shouldn’t fail if a component couldn’t be restarted",,David Hayes,khansen,Nick Lloyd,prashant_kamat,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012634861,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a7ef:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-04 23:48:50.16,,,,,"04/Apr/23 7:53 PM;5c53d3ac23f5bf672621c868;even a rever proxy failure caused it to fail

 4 17:52:48 mesa_config[7226]: WGAWA0665I:: WGA_events:: |1=default,2=admin|
Apr  4 05:52:49 : process '/sbin/getty -L 9600 ttyS0 vt100' (pid 6964) exited. Scheduling for restart.
Apr  4 05:52:50 : starting pid 7268, tty '/dev/ttyS0': '/sbin/getty -L 9600 ttyS0 vt100'
Apr  4 17:52:50 getty[7268]: tcgetattr: Input/output error

Apr  4 05:53:00 : process '/sbin/getty -L 9600 ttyS0 vt100' (pid 7268) exited. Scheduling for restart.
Apr  4 17:53:00 wga_notifications: WGAWA0047W:: WGA_events:: |1=default,msg=Reverse Proxy is not running: default|
Apr  4 05:53:01 : starting pid 7312, tty '/dev/ttyS0': '/sbin/getty -L 9600 ttyS0 vt100'
Apr  4 17:53:01 getty[7312]: tcgetattr: Input/output error

Apr  4 05:53:11 : process '/sbin/getty -L 9600 ttyS0 vt100' (pid 7312) exited. Scheduling for restart.
Apr  4 05:53:12 : starting pid 7331, tty '/dev/ttyS0': '/sbin/getty -L 9600 ttyS0 vt100'
Apr  4 17:53:12 getty[7331]: tcgetattr: Input/output error

Apr  4 17:53:18 mesa_config[7226]: Error: WGAWA0280E   Examine the log of the Web Reverse Proxy instance for further information on the failure.
Apr  4 17:53:19 mesa_install_fixpack: 10.0.5.0_IF1 install failed
Apr  4 17:53:19 mesa_control[6969]: Error: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install failed
Apr  4 05:53:22 : process '/sbin/getty -L 9600 ttyS0 vt100' (pid 7331) exited. Scheduling for restart.
Apr  4 05:53:23 : starting pid 7354, tty '/dev/ttyS0': '/sbin/getty -L 9600 ttyS0 vt100'
Apr  4 17:53:23 getty[7354]: tcgetattr: Input/output error",04/Apr/23 7:56 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] may need an urgent action if incase you need to pull from fix central,04/Apr/23 8:03 PM;5c53d3ac23f5bf672621c868;[https://www.ibm.com/support/fixcentral/swg/downloadFixes?parent=IBM Security&product=ibm/Tivoli/IBM+Security+Verify+Access&release=10.0.5.0&platform=Linux&function=fixId&fixids=10.0.5-ISS-ISVA-FP0001&includeRequisites=1&includeSupersedes=0&downloadMethod=http|https://www.ibm.com/support/fixcentral/swg/downloadFixes?parent=IBM%20Security&product=ibm/Tivoli/IBM+Security+Verify+Access&release=10.0.5.0&platform=Linux&function=fixId&fixids=10.0.5-ISS-ISVA-FP0001&includeRequisites=1&includeSupersedes=0&downloadMethod=http],"05/Apr/23 9:48 AM;5af4ad7d4dd24c579110120b;Respun 10050IF1 
Published on fix central
As opposed to previous services (LMI/runtime/dsc) restart it now does an appliance reboot at the end of installation.
If they downloaded a previous version and it worked - that should be ok as well since the change is only the last part of services restart vs reboot to overcome the issue of if services weren’t running on nodes in certain instances.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
CWE-532 - Tracing from MesaConfigArray can log password in trace,ISAMSUP-4946,291909,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,04/Apr/23 8:55 AM,13/Jun/23 12:22 PM,14/Jul/23 2:47 PM,26/May/23 1:36 AM,,,,0,,,,"When MesaConfigArray  is called to access an item like an LDAP server connection and it gets the password the password will be logged in the return trace entry



com.tivoli.am.fim.appliance.mesa.MesaConfigArray             < call RETURN pass



We should avoid logging passwords.

[~accountid:5b15d8fd6e93913e31e279fb] ",,Annelise Quap,,,,,,,,,,,,,,,5b15d950d9936c61022057fe,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMPSIRT-271,ISAMSUP-4952,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,Internal,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a6rb:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-04 14:40:03.27,,,,,05/Apr/23 12:40 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b15d950d9936c61022057fe] Is the password returned decrypted or is it encrypted?  This will make a difference in the PSIRT scoring of the issue. Also can you provide a copy of the trace?,"05/Apr/23 1:59 AM;5b15d950d9936c61022057fe;In my lab testing it was in the clear.   I can recreate it at will by restarting the runtime and calling a mapping rule that calls:
var attrUtil = new AttributeUtil();
//under the covers, init creates the connection to the LDAP server
attrUtil.init(""ldapserverconnectionname"",""secAuthority=Default"");
// perform LDAP operations
var res = attrUtil.getAttributeValue('cn=SecurityMaster,secAuthority=Default',['description']);
// destroy the connections - NEW METHOD
attrUtil.close();


[4/3/23, 17:44:54:722 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager                           > get(Class<C>) ENTRY
[4/3/23, 17:44:54:722 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             > getObject(Class<C>) ENTRY
[4/3/23, 17:44:54:722 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             3 getObject(Class<C>) Class com.ibm.security.access.ldap.parameters.LdapConnectionCache from version 1680561826350.
[4/3/23, 17:44:54:722 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             < getObject(Class<C>) RETURN
[4/3/23, 17:44:54:722 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager                           < get(Class<C>) RETURN
[4/3/23, 17:44:54:722 CDT] 0000003f id=00000000 com.tivoli.am.fim.logging.FIMLoggerFactory                   > getFIMLogger ENTRY
[4/3/23, 17:44:54:722 CDT] 0000003f id=00000000 com.tivoli.am.fim.logging.FIMLoggerFactory                   < getFIMLogger RETURN
[4/3/23, 17:44:54:723 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager                           > get(Class<C>) ENTRY
[4/3/23, 17:44:54:723 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             > getObject(Class<C>) ENTRY
[4/3/23, 17:44:54:723 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             3 getObject(Class<C>) Class com.ibm.security.access.server_connections.ServerConnectionFactory from version 1680561826350.
[4/3/23, 17:44:54:724 CDT] 0000003f id=00000000 com.tivoli.am.fim.logging.FIMLoggerFactory                   > getFIMLogger ENTRY
[4/3/23, 17:44:54:724 CDT] 0000003f id=00000000 com.tivoli.am.fim.logging.FIMLoggerFactory                   < getFIMLogger RETURN
[4/3/23, 17:44:54:725 CDT] 0000003f id=00000000 com.tivoli.am.fim.pluginframework.PasswordObfuscatorUtility  > getUnObfuscatedPassword ENTRY
[4/3/23, 17:44:54:725 CDT] 0000003f id=00000000 com.tivoli.am.fim.pluginframework.PasswordObfuscatorUtility  < getUnObfuscatedPassword RETURN
[4/3/23, 17:44:54:725 CDT] 0000003f id=00000000 com.tivoli.am.fim.appliance.mesa.MesaConfigArray             > call ENTRY
[4/3/23, 17:44:54:725 CDT] 0000003f id=00000000 com.tivoli.am.fim.appliance.mesa.MesaCommand                 1 Using default user : admin
*[4/3/23, 17:44:54:791 CDT] 0000003f id=00000000 com.tivoli.am.fim.appliance.mesa.MesaConfigArray             < call RETURN myPassw0rd*
[4/3/23, 17:44:54:791 CDT] 0000003f id=00000000 com.tivoli.am.fim.pluginframework.PasswordObfuscatorUtility  > getUnObfuscatedPassword ENTRY
[4/3/23, 17:44:54:791 CDT] 0000003f id=00000000 com.tivoli.am.fim.pluginframework.PasswordObfuscatorUtility  < getUnObfuscatedPassword RETURN
[4/3/23, 17:44:54:791 CDT] 0000003f id=00000000 com.tivoli.am.fim.appliance.mesa.MesaConfigArray             > call ENTRY
[4/3/23, 17:44:54:791 CDT] 0000003f id=00000000 com.tivoli.am.fim.appliance.mesa.MesaCommand                 1 Using default user : admin
[4/3/23, 17:44:54:846 CDT] 0000003f id=00000000 com.tivoli.am.fim.appliance.mesa.MesaConfigArray             < call RETURN pass
[4/3/23, 17:44:54:847 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             < getObject(Class<C>) RETURN
[4/3/23, 17:44:54:847 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager                           < get(Class<C>) RETURN
[4/3/23, 17:44:54:847 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager                           > get(Class<C>) ENTRY
[4/3/23, 17:44:54:847 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             > getObject(Class<C>) ENTRY
[4/3/23, 17:44:54:847 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             3 getObject(Class<C>) Class com.ibm.security.access.server_connections.ServerConnectionFactory from version 1680561826350.
[4/3/23, 17:44:54:847 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             < getObject(Class<C>) RETURN
[4/3/23, 17:44:54:847 CDT] 0000003f id=00000000 com.tivoli.am.fim.om.ObjectManager                           < get(Class<C>) RETURN",05/Apr/23 2:26 AM;5b15d8fd6e93913e31e279fb;PSIRT Advisory ADV0082645 created and Product Records created,09/May/23 9:35 PM;5b232b2fd85e5b59b066f57f;@jwade - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,24/May/23 8:56 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b15d950d9936c61022057fe] Can we close this and track them through the PSIRT records,26/May/23 12:59 AM;5b15d950d9936c61022057fe;yes,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
CVE-2023-28531,ISAMSUP-4944,291798,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,04/Apr/23 12:12 AM,19/Apr/23 10:41 AM,14/Jul/23 2:47 PM,19/Apr/23 10:41 AM,,,,0,,,,Is ISAM 9.0.x / ISVA 10.0.x  affected by [SBV-156364] OpenBSD OpenSSH<9.3 Remote Unspecified Vulnerability CVE-2023-28531 ?,,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012628476,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,BPIFRANCE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a653:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-03 21:32:14.012,,,,,04/Apr/23 7:32 AM;5b15d8fd6e93913e31e279fb;No we are not vulnerable to CVE-2023-28531.,19/Apr/23 10:41 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Mexico no longer does DST ISVA changed the time anyway,ISAMSUP-4943,291794,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,03/Apr/23 11:06 PM,19/Apr/23 10:42 AM,14/Jul/23 2:47 PM,19/Apr/23 10:42 AM,10.0.6,,02/Apr/23 12:00 AM,0,,,,"ISVA 10.0.1.1

Banco Regional SA Inst. De Banca had an issue this weekend. Mexico voted not to do DST any longer last year but ISVA still advanced the time by one hour causing all of their tokens to be invalid.

Specifically Banco has their TZ set to Monterrey UTC-6. Local time there should be 1 hour less than it is when you set that TZ in the appliance (I verified this).

I did some research and found this thread in the askubuntu form. From reading that, it sounds like a system lib may need to be updated to know of the change.

[https://askubuntu.com/questions/1459637/mexico-ntp-no-more-time-changes-since-2023-and-my-ntp-server|https://askubuntu.com/questions/1459637/mexico-ntp-no-more-time-changes-since-2023-and-my-ntp-server|smart-link] 

As a work-around for this customer they set their TZ to one that is 1 hour less so things synchronized. 

I’ll await confirmation from L3 on opening an APAR.",,Asha Shivalingaiah,cholt@us.ibm.com,jcyarbor,Motiur Rahman,Nick Lloyd,,,,,,,,,,,5af4ad7d4dd24c579110120b,5b15d994dda5f94d06b985b2,5bac25aaabfcbf73d13e733b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4953,,,,,,,,,,,,,,,,,,,,,IJ46451,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012621900,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,,,,Banco Regional SA Inst. De Banca,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a647:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-04-03 22:35:17.868,,,,,04/Apr/23 8:35 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] can you please review this item and confirm if this is something that we need to fix in a future release? ,04/Apr/23 8:35 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d994dda5f94d06b985b2] are you able to confirm if this is still an issue with the latest 10.0.5 release of ISVA? ,"04/Apr/23 10:15 AM;5b15d994dda5f94d06b985b2;I just installed 10.0.5 IF1, restarted my appliance for good measure, and the time is still an hour ahead when I set my TZ to Monterrey. ",05/Apr/23 1:53 AM;5b15d9e581c3df12acf53c4a;I am investigating …..will update soon.,"05/Apr/23 2:06 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5b15d9517dab4c51f61b5190] I am assuming Australia does not observer DST either, so if Mexico, which used to observer DST and now they will not,  should be at the same boat as Australia.

So, if Mexico is seeing their appliance still showing DST affect, I am assuming there might me a small config setting which should take care of it?  Any idea or suggestion?","05/Apr/23 2:32 AM;5b15d994dda5f94d06b985b2;It looks like the tzdata package on RH handles this. That along with files in: /usr/share/zoneinfo/. What version of tzdata do we ship with 10.0.5?

[https://www.redhat.com/en/blog/time-zone-database-package-tzdata-news-and-updates-2022|https://www.redhat.com/en/blog/time-zone-database-package-tzdata-news-and-updates-2022|smart-link] ","05/Apr/23 7:19 AM;5b15d94b6256d01ad54eb020;Internal comment:

There are two parts to this. One is the tzdata  for the system but the other is  the Java jre which will use it’s own.

[https://www.oracle.com/java/technologies/tzdata-versions.html|https://www.oracle.com/java/technologies/tzdata-versions.html|smart-link] ","06/Apr/23 12:40 AM;5b15d9e581c3df12acf53c4a;OK, I am looking into it……","06/Apr/23 12:57 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b15d994dda5f94d06b985b2] I read the article that you mentioned, it did not mention anything about Mexico’s DST related change.  do you happen to know which version of tzdata contains Mexico’s change also? A 2022  specific version?

I noticed that Development has, in latest ADKS stream,  [+tzdata-2022g-1.el8.ibm.1.noarch.rpm+|https://github.ibm.com/ISAM/isam-build-adks/blob/master/adks/mesa/pkg/x86_64/mcp/tzdata-2022g-1.el8.ibm.1.noarch.rpm]

, technically, this version should be with upcoming  10.0.6.0
I am trying to find the version in 10.0.5.0","06/Apr/23 1:00 AM;5b15d9e581c3df12acf53c4a;OK, it seems that 10.0.5.0 has

tzdata-2020a-1.el8.ibm.1.noarch
tzdata-java-2020a-1.el8.ibm.1.noarch



Definitely, it does not have 2022 or later version so it will not know anything about 2022’s Mexico’s change.","06/Apr/23 1:08 AM;5b15d9e581c3df12acf53c4a;Googling, I found the following:

[https://data.iana.org/time-zones/tzdb/NEWS|https://data.iana.org/time-zones/tzdb/NEWS]

*_Release 2022f_* - 2022-10-28 18:04:57 -0700

  Briefly:
    Mexico will no longer observe DST except near the US border.
    Chihuahua moves to year-round -06 on 2022-10-30.
    Fiji no longer observes DST.
    Move links to 'backward'.
    In vanguard form, GMT is now a Zone and Etc/GMT a link.
    zic now supports links to links, and vanguard form uses this.
    Simplify four Ontario zones.
    Fix a Y2438 bug when reading TZif data.
    Enable 64-bit time_t on 32-bit glibc platforms.
    Omit large-file support when no longer needed.
    In C code, use some C23 features if available.
    Remove no-longer-needed workaround for Qt bug 53071.

  Changes to future timestamps

    Mexico will no longer observe DST after 2022, except for areas
    near the US border that continue to observe US DST rules.
    On 2022-10-30 at 02:00 the Mexican state of Chihuahua moves
    from -07 (-06 with DST) to year-round -06, thus not changing
    its clocks that day.  The new law states that Chihuahua
    near the US border no longer observes US DST.
    (Thanks to gera for the heads-up about Chihuahua.)

    Fiji will not observe DST in 2022/3.  (Thanks to Shalvin Narayan.)
    For now, assume DST is suspended indefinitely.

  Changes to data

    Move links to 'backward' to ease and simplify link maintenance.
    This affects generated data only if you use 'make BACKWARD='.

    GMT is now a Zone and Etc/GMT a link instead of vice versa,
    as GMT is needed for leap second support whereas Etc/GMT is not.
    However, this change exposes a bug in TZUpdater 2.3.2 so it is
    present only in vanguard form for now.

    Vanguard form now uses links to links, as zic now supports this.

  Changes to past timestamps
","06/Apr/23 1:10 AM;5b15d9e581c3df12acf53c4a;[http://linuxsoft.cern.ch/cern/centos/7/updates/x86_64/repoview/tzdata.html|http://linuxsoft.cern.ch/cern/centos/7/updates/x86_64/repoview/tzdata.html|smart-link] 



|[tzdata-2022f-1.el7.noarch|http://linuxsoft.cern.ch/cern/centos/7/updates/x86_64/Packages/tzdata-2022f-1.el7.noarch.rpm] [491 KiB]|*Changelog* by Patsy Griffin (2022-10-31):
{noformat}- Rebase to tzdata-2022f
  - Mexico will stop observing DST except near the US border.
  - Chihuahua moved to -06 year round starting on 2022-10-30.
  - Fiji no longer observes DST.{noformat}|","06/Apr/23 1:56 AM;5b15d9e581c3df12acf53c4a;Actually, the Java related link that Bill Tyler provided, it clearly mentioned:

|[tzdata2022f|https://mm.icann.org/pipermail/tz-announce/2022-October/000075.html]
2022-10-29|20
19.0.2
17.0.6
11.0.18
8u361
8u351|Mexico will no longer observe DST except near the US border.
Chihuahua moves to year-round -06 on 2022-10-30.
Fiji no longer observes DST.
Move links to 'backward'.
In vanguard form, GMT is now a Zone and Etc/GMT a link.
zic now supports links to links, and vanguard form uses this.
Simplify four Ontario zones.
Fix a Y2438 bug when reading TZif data.
Enable 64-bit time_t on 32-bit glibc platforms.
Omit large-file support when no longer needed.
In C code, use some C23 features if available.
Remove no-longer-needed workaround for Qt bug 53071.|","06/Apr/23 3:10 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b15d94b6256d01ad54eb020] Hi Bill,

How do we find out what version of tzdata is included in OpenJDK 

e.g. latest dev adks has:

[+ibm-semeru-open-jre_x64_linux_11.0.16.1_1_openj9-0.33.1.tar.gz+|https://github.ibm.com/ISAM/isam-build-adks/blob/master/adks/appliance/pkg/third-party/ibm-semeru-open-jre_x64_linux_11.0.16.1_1_openj9-0.33.1.tar.gz]

How do we find out what version of tzdata it contains?

“release” file of that version say:

IMPLEMENTOR=""IBM Corporation""
IMPLEMENTOR_VERSION=""11.0.16.1""
JAVA_VERSION=""11.0.16.1""
*_JAVA_VERSION_DATE=""2022-08-12""_*
LIBC=""gnu""



So it definitely does not include latest tzdata…..

===============

Can we update just tzdd,dat file  or the relevant file?","06/Apr/23 4:28 AM;5b15d94b6256d01ad54eb020;Internal comments:



In 10.0.5.0  we use:

/opt/java/jre/bin/java -version
openjdk version ""11.0.14.1"" 2022-02-08
IBM Semeru Runtime Open Edition 11.0.14.1 (build 11.0.14.1+1)
Eclipse OpenJ9 VM 11.0.14.1 (build openj9-0.30.1, JRE 11 Linux amd64-64-Bit Compressed References 20220210_379 (JIT enabled, AOT enabled)
OpenJ9   - 9dccbe076
OMR      - 56c3376ba
JCL      - 5c423dacd0 based on jdk-11.0.14.1+1)



I think we would either haved to use a newer version of the  jre  ( 11.0.18 )  or  if the  TZUpdater tool is available  for semeru we could use that.  



I took a look  in  /opt/java/jre/lib  and found  tzdb.dat.  That might be all we need to update but I don’t know for sure.","06/Apr/23 6:04 AM;5b15d94b6256d01ad54eb020;Regarding the version here is the first line of tzdb.dat

0000000    01000454 5a444200 01000532 30323165    ...TZDB....2021e

From the table in that link:

|[tzdata2021e|https://mm.icann.org/pipermail/tz-announce/2021-October/000069.html] 
2021/10/22|18 
17.0.2 
11.0.14 
8u321 
7u331|","06/Apr/23 11:59 PM;5b15d9e581c3df12acf53c4a;[~accountid:5b15d94b6256d01ad54eb020] Aha, thanks Bill.","12/Apr/23 4:57 AM;5b15d9e581c3df12acf53c4a;I am still looking into the issue to find out the best way to resolve it. As of now, it seems like we can just update the tzdata…..","13/Apr/23 5:43 AM;5b15d9e581c3df12acf53c4a;[~accountid:5ac577587028785d133fbc46] [~accountid:5ac57757d9a96536d1f0daa9] 

Hi Keiran

Mexico recently updated DST related time observed in that country and that update is contained in the tzdata version:  [+tzdata-2022f-1.el7.noarch+|http://linuxsoft.cern.ch/cern/centos/7/updates/x86_64/Packages/tzdata-2022f-1.el7.noarch.rpm]

I checked the ISVA adks in github and noticed that latest adks contains tzdata version: [+tzdata-2022g-1.el8.ibm.1.noarch.rpm+|https://github.ibm.com/ISAM/isam-build-adks/blob/master/adks/mesa/pkg/x86_64/mcp/tzdata-2022g-1.el8.ibm.1.noarch.rpm]

If this is true then  will ISVA 10.0.6.0 contain tzdada:  [+tzdata-2022g-1.el8.ibm.1.noarch.rpm+|https://github.ibm.com/ISAM/isam-build-adks/blob/master/adks/mesa/pkg/x86_64/mcp/tzdata-2022g-1.el8.ibm.1.noarch.rpm]

Would you please confirm?

If not then we need to include this latest tzdada version in 10.0.6.0 please.","18/Apr/23 1:47 AM;5b15d9e581c3df12acf53c4a;I confirmed, by looking at the latest ISVA 10.0.6.0 .pkg file that ISVA 10.0.6.0 indeed contains 

[+tzdata-2022g-1.el8.ibm.1.noarch.rpm+|https://github.ibm.com/ISAM/isam-build-adks/blob/master/adks/mesa/pkg/x86_64/mcp/tzdata-2022g-1.el8.ibm.1.noarch.rpm]

which means ISVA 10.0.6.0 will have that fix.

Please do Open APAR so that we can track/document it.",19/Apr/23 10:42 AM;5b232b2fd85e5b59b066f57f;Case closed. APAR appears closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISV  suddently lost configuration container data and couldn't apply a backup snapshot,ISAMSUP-4940,291729,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,03/Apr/23 1:23 AM,19/Apr/23 10:44 AM,14/Jul/23 2:47 PM,19/Apr/23 10:44 AM,,,,0,,,,"HI

ISV uses ISVA container image at version 10.0.1.0 . They are using it for China datacenter.



There was an outage where reverse proxies pods were in evicted state and when SRE engineer when into config container url they couldn’t find any configuration present.



ISVA uses 10.0.1.0 where persistent volume is using AWS Elastic block storage.



When I joined the call, they were trying to upload an old snapshot and apply that (but failed to apply)



At this point, I am waiting for a detailed log (/var/log/messages) from ISV team ( as china dc transfer rate is very very slow)

couldn’t generate support file as 4 hours outage caused panic with the SRE to not to generate anything until there is an assurance that it will be safe.



I helped them to restore the environment( they had automation in place and had some intermediate failures but those were only objectspace related or certificate . )



The major issue is that why snapshot application failed.

Few of the points:

* China data center was very slow and it look around 30 mins to upload backup snapshot
* existing configuration didn’t show 
* current snapshot is at [https://ibm.box.com/s/95g53ex3pin0oazva8y6qpad19x4rt3d|https://ibm.box.com/s/95g53ex3pin0oazva8y6qpad19x4rt3d|smart-link] 
* L2 tried to recreate by applying snapshot in the local lab but seemed to not have worked.

At present , ISV team is looking for an RCA",,aditya.cetlur,Keiran Robinson,Nick Lloyd,prashant_kamat,tonyferg,Vivek Shankar,,,,,,,,,,5af053215715ff498542256d,5ac577587028785d133fbc46,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5ac57757d9a96536d1f0daa9,5ad60ece34f1e62b1ac926c2,,,,,,,,,,,,,,,,,,,,,,,,,,,,03/Apr/23 3:12 PM;tushar.prasad;image.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193818,03/Apr/23 3:06 PM;tushar.prasad;messages;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193817,03/Apr/23 1:25 AM;tushar.prasad;snapshotfailedtoappy.rtf;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193791,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012628661,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,ISV china tenant,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a5pr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-04-03 01:54:06.179,,,,,"03/Apr/23 1:25 AM;5c53d3ac23f5bf672621c868;snippet of error observed (AT ISV end) 



{noformat}Apr  2 11:59:59 mesa_config[29577]: Signature verification passed for file: /usr/sbin/mesa_config
Apr  2 11:59:59 mesa_config[29577]: Creating snapshot: /tmp/tmp.3WHdjE
Apr  2 11:59:59 mesa_config[29577]: Invoking Snapshot Pre functions
Apr  2 12:00:02 mesa_config[29577]: Invoking Snapshot Post functions
Apr  2 12:00:02 mesa_config[29577]: Found version within /etc/settings.sys: 10.0.1.0
Apr  2 12:00:02 mesa_config[29577]: Found model within /etc/settings.sys: docker
Apr  2 12:00:02 mesa_config[29577]: Last message repeated 1 times
Apr  2 12:00:02 mesa_config[29642]: Signature verification passed for file: /usr/sbin/mesa_config
Apr  2 12:00:03 mesa_config[29699]: Last message repeated 2 times
Apr  2 12:00:03 www-data: GLGSS1001I:: GLG_events:: |file=isva_10.0.1.0_published.snapshot,interface=LMI,user=admin|
Apr  2 12:00:03 mesa_eventsd[1002]: Error: Failed to execute response 8f7c0376-d767-4af7-b1f2-0f0d84cfe3d9 on thread 1010
Apr  2 12:00:03 mesa_eventsd[1002]: GLGER1001W:: GLG_events:: |response=logdb,event=GLGSS1001I,thread=1010|
Apr  2 12:00:03 mesa_eventsd[1002]: Error: Failed to execute response 8f7c0376-d767-4af7-b1f2-0f0d84cfe3d9 on thread 1010`{noformat}","03/Apr/23 1:26 AM;5c53d3ac23f5bf672621c868;L2 tried to recreate by applying snapshot 

{noformat}isva_10.0.1.0_published-bkp.snapshot{noformat}",03/Apr/23 1:27 AM;5c53d3ac23f5bf672621c868;ISV team was notified that 10.0.1.0 is an old version and there have been lot of improvements at latest version on snapshot management and its application.,03/Apr/23 1:29 AM;5c53d3ac23f5bf672621c868;Haven’t digged further and will start during my time. In the meantime [~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5ac577587028785d133fbc46] could you help someone to look when GC starts tomorrow. I have given box link editor access ,"03/Apr/23 1:43 AM;5c53d3ac23f5bf672621c868;– I enabled some debug--



{noformat}pr  2 21:11:30 mesa_config[1617]: Debug: wga.deploy
Apr  2 21:11:30 mesa_config[1617]: Debug: Calculating snapshot command execution order
Apr  2 21:11:30 mesa_config[1617]: Debug: Executing command: 'apply_snapshot' '/var/shared/snapshots/isva_10.0.1.0_published-bkp.snapshot' 
Apr  2 21:11:30 mesa_config[1617]: Applying snapshot
Apr  2 21:11:30 mesa_config[1617]: Snapshot file: /var/shared/snapshots/isva_10.0.1.0_published-bkp.snapshot
Apr  2 21:11:30 mesa_config[1617]: Debug: Created temporary directory /tmp/tmp.xepMjD
Apr  2 21:11:30 mesa_config[1617]: Found version within /tmp/tmp.xepMjD/Settings: 10.0.1.0
Apr  2 21:11:30 mesa_config[1617]: Found model within /tmp/tmp.xepMjD/Settings: docker
Apr  2 21:11:30 mesa_config[1617]: Debug: File: /tmp/tmp.xepMjD/Settings Version: 10.0.1.0 Model: docker
Apr  2 21:11:30 mesa_config[1617]: Debug: Created temporary file /tmp/tmp.ID3iO2
Apr  2 21:11:30 mesa_config[1617]: Error: MesaSecureFileMgr::signatureIsValid(): acme error:failed:idup_se_singlebuffer_unprotect:GSS_S_FAILURE:GSS_S_MINOR_SIGNER_CERT_BAD_DATE
Apr  2 21:11:30 mesa_config[1617]: Error: The snapshot file cannot be applied because it has been modified!
Apr  2 21:11:30 mesa_config[1617]: Debug: Removing temporary file /tmp/tmp.ID3iO2
Apr  2 21:11:30 mesa_config[1617]: GLGSY0010E:: GLG_events:: ||
Apr  2 21:11:30 mesa_config[1617]: Debug: Removing temporary directory /tmp/tmp.xepMjD
Apr  2 21:11:30 mesa_config[1617]: Debug: Removing temporary file /tmp/tmp.oimUQd
Apr  2 21:11:30 mesa_control[1614]: Debug: Command exited with status: 1
Apr  2 21:11:30 isam_cli[1601]: Error: Could not apply snapshot file: isva_10.0.1.0_published-bkp.snapshot
Apr  2 21:11:30{noformat}","03/Apr/23 1:52 AM;5c53d3ac23f5bf672621c868;looks ISV team are affected by this on mostly all data centers they are running ( China, japan, australia) that I know of



this looks to be the fix : (and needs to be applied into all their env) I am checking if they have any prep env where they can test before putting into production.



let me know your thoughts



[https://cloudidentity.atlassian.net/browse/ISAMSUP-4586|https://cloudidentity.atlassian.net/browse/ISAMSUP-4586|smart-link] ","03/Apr/23 1:53 AM;5c53d3ac23f5bf672621c868;don’t have support file due to two reasons

1.file transfer was too slow to get it

[2.at|http://2.at] this point, no body wanted to touch the setup by generating anything

I am going to have a call with them tomorrow to assess","03/Apr/23 2:23 AM;5c53d3ac23f5bf672621c868;--Conclusion---

*Problem:*

The snapshot failed to apply at 10.0.1.0

*Root Cause:*

The 10.0.1.0 snapshot failed to apply is related to snapshot signing issue and due to this it failed to apply .

This issue doesn’t occur at 10.0.3.1 ( may be lower but since I just tested it at 10.0.3.1) 

At 10.0.3.1 the existing snapshot of ISV applied successfully.

ISV team’s current (atleast I am aware of ) China tenant, JP tenant, Australia tenant are affected by above issue( atleast it happened on two tenants and may occur again)



*Action plan:*

ISV team to upgrade their ISVA container image( they can choose version upward of 10.0.3.1 atleast where I tested) 



*Short term action plan:*

[~accountid:5b15d954b0d76456f36daf33] since you have handled in case of Master card. Will the fix at [https://ibm.ent.box.com/file/1057907688506?s=oh358cy48eudghvk32jedjwqflxdzfp4|https://ibm.ent.box.com/file/1057907688506?s=oh358cy48eudghvk32jedjwqflxdzfp4] 

be modifed to work for container env. I applied it but its expected to not work( which it didn’t work) May be because the fix looks for the snapshots in /var/support

but in container env . it would be under : /var/shared/snapshots

Will in short term a fix can be given to ISV team at 10.0.1.0 so that they have time to upgrade ( and then don’t get into this kind of issues) 

As this issue had already caused , Many hours of downtime for China tenant and for JP tenant.","03/Apr/23 11:54 AM;5b232b2fd85e5b59b066f57f;[~accountid:5c53d3ac23f5bf672621c868] - I have reviewed the fix-pack and consulted with Bhavan. The consensus is that this fix-pack cannot be re-written to support docker deployments given that the sequence of application of snapshot vs. fix-pack required by the fix-pack cannot be supported by docker at container build time; even if it were possible, it is not something that we would want to provide due to the contents of the fix-pack and the fact that the fix-pack was originally built for a specific customer.  

The customer should deploy a newer version. ","03/Apr/23 3:25 PM;5c53d3ac23f5bf672621c868;Thanks [~accountid:5b232b2fd85e5b59b066f57f] 

As discussed in the chat:

ISV team’s focus is on “ why the existing configuration lost”   as they were able to use Rest API to configure again and that snapshot got used by reverse proxy.

# Initial rp failure - unknown root cause
# Loss of original configuration --> unknown
# RP restart failure - because it couldn't find instance name in the snapshot pulled from config container
# Snapshot application failure - known root cause



At this point, we have limited logs. I am attaching messages log which was present since last restart config container. 

Also exploring if ISV team has logs from another env( at this time there is limited logs from China env due to access issues)

This is best which could be made available ( as the focus was on getting the env up and running) 

[^messages]



something similar happened in Japan( although reverse proxy was still working as reload was not done neither reverse proxy was restarted)

Japan datacenter continued to work even when configuration was not visiable after restart of the config container.



The behavior gives a similarity on why config container (either had some issues) such that upon restart it couldn’t retain the configuration.

Here are the images:

!image.png|thumbnail!

and discussion point

[https://ibm-security.slack.com/archives/C015FE556CV/p1680424279408519|https://ibm-security.slack.com/archives/C015FE556CV/p1680424279408519|smart-link] 



ISV team would like to prioritize RCA on : 

Why config container configuration went bad and lost (either before or post restart of config container)?","03/Apr/23 9:12 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] 

I am able to recreate the issue exactly what was observed in JP and Australia tenant



Steps to recreate

1.setup config and wrp container at 101

2.get both of them working and running

3.make sure a published snapshot is available

4.forward the system date by more than 1 year

6.try to restart reverse proxy 

   it starts to fail with exact error observed in JP tenant and CN ( rp went down not due to this , this doesn’t affect running reverse proxy)

→ Verifying checksums... Done

Fatal error: WGAWA0022E   The supplied instance name, test1, is not a configured instance.

7. restart config container, and it comes back with no configuration

and logs showing 

2025-04-03T19:07:29+08:00: ---- No configuration snapshot detected. Preparing the container","03/Apr/23 10:18 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] At this point 

ISV team already rebuilt

1.china

2.japan

so they have new signer with another 11 months 

but Australia there is still few months left

/var/.ca:
total 32
drwx------. 1 root root    50 Aug 22  2022 .
drwxrwxr-x. 1 root root  4096 Aug 22  2022 ..
-rw-------. 1 root root 11819 Aug 22  2022 device_key.kdb
-rw-------. 1 root root   193 Aug 22  2022 device_key.sth
-rw-------. 1 root root  5991 Nov 25  2020 mesa_ca.kdb
-rw-------. 1 root root   193 Nov 25  2020 mesa_ca.sth



if they upgrade before that its fine otherwise they need do what you suggested. remove the key and regenerate snapshot","04/Apr/23 1:49 AM;5c53d3ac23f5bf672621c868;here looks to be a simple way to extend the signing life:



1.Everytime config container restarts it generates a private key in device_key.kdb 

2.and when user does a publish that new snapshot will be signed using new device_key.kdb

so What ISV team just needs to do is this:

check whether device_key.kdb (private key hasn’t expired)

1.restart config container

2.publish (this should generate with new key pair giving a new lease of extension)

** they can choose to do it one time (if hasn’t been done in last few months)","04/Apr/23 12:13 PM;5b232b2fd85e5b59b066f57f;Hi Tushar. When you say restart of the container - do you mean an OpenShift restart where the container is actually rebuilt? Just doing a pure restart of the container wont regenerate the key; doing a rebuild will (which I believe is what an OpenShift restart actually does). If this is the case - then yes, this could be a way forward - i.e. before generating a snapshot, restart the container; this will give that snapshot 12months validity from that date. They should also be restarting before the 12month expiry regardless so that subsequent published changes can be successfully applied across the containers. The only question here is whether they would also need to restart the other containers so that snapshots successfully validate when publishing changes to those containers - I think that they would. Have you tested this? ","04/Apr/23 1:14 PM;5c53d3ac23f5bf672621c868;Restart → stop openshift pod and then start it again  (which ISV team also does)

The other container for example: RP will continue to work and once runtime is able to consume the snapshot .

Yes, I tested it , it works","04/Apr/23 1:23 PM;5af053215715ff498542256d;Test plan:

* Validate the current snapshot is valid by restarting 1 reverse proxy
* If this works
** Restart the isam-config pod
** Publish the config
** Restart RPs one at a time
** Export the support file and check the validity of {{/var/.ca/device_key.kdb}}

We will test this out in

* ITE3 (if we’re running 10.0.1)
* Canada","04/Apr/23 1:52 PM;5af053215715ff498542256d;The test was run in Canada (since Verify was already on 10.0.3.1)

Original EOL of the snapshot:

{noformat}/var/.ca:
total 32
drwx------. 1 root root    50 Jul 12  2022 .
drwxrwxr-x. 1 root root  4096 Jul 12  2022 ..
-rw-------. 1 root root 11811 Jul 12  2022 device_key.kdb
-rw-------. 1 root root   193 Jul 12  2022 device_key.sth{noformat}

Post running the steps:

{noformat}/var/.ca:
total 32
drwx------. 1 root root    50 Apr  4 03:39 .
drwxrwxr-x. 1 root root  4096 Apr  4 03:43 ..
-rw-------. 1 root root 11819 Apr  4 03:39 device_key.kdb
-rw-------. 1 root root   193 Apr  4 03:39 device_key.sth{noformat}","04/Apr/23 2:09 PM;5c53d3ac23f5bf672621c868;thanks [~accountid:5af053215715ff498542256d] 

so the steps work which will give a lease of 11 months and you should upgrade the env before that.

What I understand:

[1.JP|http://1.JP]. → is already done ( as part of last rebuild)

[2.CN|http://2.CN] - > is already done ( as part of last rebuild)

3. Canada → done just now

4.Australia → pending

I will leave it to you to perform this on applicable env . At this point. there is nothing more needed from Verify Access team ","04/Apr/23 8:16 PM;5b232b2fd85e5b59b066f57f;👍  Pleasure working with you on this one Tushar. 

Just confirming - we can close this out? ",19/Apr/23 10:44 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Increased memory usage after upgrade from 10.0.2.0IF01 to 10.0.5.0,ISAMSUP-4936,291529,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Gabe,5b15d99b4c20165700edecad,Gabe,5b15d99b4c20165700edecad,31/Mar/23 5:05 AM,11/Jul/23 10:51 AM,14/Jul/23 2:47 PM,,,,,0,Growth,,,"Royal Bank recently upgraded from 10.0.2.0IF01 to 10.0.5.0 and starting from the day of the upgrade the system memory has steadily increased till it almost consumed the entire system. 

Given that the customer upgraded from 10.0.2.0_IF1_Cumulative_20210203 to 10.0.5.0 this issue should not be related to the GLIBC update. From my understanding the memory change would have affected 10.0.2.0IF1 also. 

Screenshot of the System Memory in the LMI (increase from March 9th - March 21st) and also a Dynatrace process memory. 
[https://ecurep.mainz.de.ibm.com/rest/download/TS012527959/2023-03-23/Bbxsywmp03.pdf?fileSize=60860&clientId=ae5|https://ecurep.mainz.de.ibm.com/rest/download/TS012527959/2023-03-23/Bbxsywmp03.pdf?fileSize=60860&clientId=ae5]

For instance from the latest support file we see this in the CPU.txt. T
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012527959&path=TS012527959%2F2023-03-30%2Fisva_10.0.5.0_20230329-221827_bbxsywmp03.support.zip_unpack%2Fiswga%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012527959&path=TS012527959%2F2023-03-30%2Fisva_10.0.5.0_20230329-221827_bbxsywmp03.support.zip_unpack%2Fiswga%2F]

Mem: *65500880K used*, 393896K free, 4440K shrd, 682600K buff, 24672028K cached
CPU: 17.2% usr  1.2% sys  0.0% nic 81.4% idle  0.0% io  0.0% irq  0.0% sirq
Load average: 2.86 2.11 1.54 3/5803 15356
  PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND
13155     1 www-data S    *40.3g* 62.5   5  4.6 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms4096m -Xmx8192m …



I understand the VSZ size is not an accurate measurement of memory usage but an indication of the maximum amount of memory a process can use but it does appear to rise with the system memory. If the customer restarts the Runtime the memory drops then starts the rise again. They haven’t let it go to see what happens if they run out of system memory given that this is a production environment. 

To start the investigation we gathered Java heap dumps. I’ve got two different heap dumps from two consecutive days. I ran the ECURep memory tool and there were possible leak suspects identified. The odd thing is the used JVM heap was relatively small compared to the system memory in use. 

The Java core shows (-Xmx8192m)
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012527959&path=TS012527959%2F2023-03-30%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012527959&path=TS012527959%2F2023-03-30%2F]


JRE: 9,570,827,744 bytes / 72302 allocations
with
Memory Manager (GC): 8,763,644,152 bytes / 1685 allocations

In my option this seems normal, the max heap is ~8.5Gb and the Libs, JNI, JIT, etc increase it to 9.5GB.


The customers and my own question is what is the Runtime doing to allocate all that memory? 

This first memory report list three possible leak suspects. 
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012527959&path=TS012527959%2F2023-03-28%2Fheapdump.20230328.174226.13155.0002.phd-memoryanalyzer_AE_PD%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012527959&path=TS012527959%2F2023-03-28%2Fheapdump.20230328.174226.13155.0002.phd-memoryanalyzer_AE_PD%2F]


Problem Suspect 1. (This one is the XML process for SAML messages so seems normal)
302 instances of com.ibm.xml.xlxp2.api.wssec.WSSXMLInputFactory$WSSStreamReaderProxy occupy 68,222,472 (27.56%) bytes.

Problem Suspect 2
31 instances of java.lang.Thread occupy 40,376,384 (16.31%) bytes.

Problem Suspect 3
18,891 instances of java.lang.Class occupy 35,989,664 (14.54%) bytes.

The 2nd memory report showed two suspects. Since the XML one was omitted I think we can ignore it. 
My biggest concern with these suspects is the size. These don’t seem to be very large. Could they still be a culprit? Both grew between Java Cores. 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012527959&path=TS012527959%2F2023-03-30%2Fheapdump.20230329.220831.13155.0007.phd-memoryanalyzer_AE_PD%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012527959&path=TS012527959%2F2023-03-30%2Fheapdump.20230329.220831.13155.0007.phd-memoryanalyzer_AE_PD%2F]

Problem Suspect 1
32 instances of java.lang.Thread occupy 38,775,400 (19.41%) bytes.

Problem Suspect 2
19,587 instances of java.lang.Class occupy 34,471,360 (17.25%) bytes.



What might be the next step to determine what is going on here? Something related to the JVM is increasing the system memory but it doesn’t seem to be related to the heap itself. Maybe this is something with native memory?",,Bill Tyler,BRIANORO,David Hayes,khansen,Nick Lloyd,tonyferg,,,,,,,,,,5b15d94b6256d01ad54eb020,6154906364ff01007106e189,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4957,,ISAMSUP-5130,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012527959,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Gabe,5b15d99b4c20165700edecad,,,,Royal Bank,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a4hj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-10 19:11:04.383,,,,,"11/Apr/23 5:11 AM;5b15d901fa615349cb01778b;[~accountid:5ac57757d9a96536d1f0daa9] can we get an update please,  FRIT and others are seeing this.  

[Memory Leak issue in ISVA 10.0.4.0 IF1 | IBM Security Verify|https://community.ibm.com/community/user/security/discussion/memory-leak-issue-in-isva-10040-if1#bm41cb38d2-b0b4-4607-be63-c6b81e97c52c]","11/Apr/23 9:01 AM;5b15d94b6256d01ad54eb020;I think this will take a while to sort out  but I took a look today and have  one observation so far.    

Taking the first javacore for example, it reports  a heap usage of  around 4gb.

1STHEAPTOTAL   Total memory:                  4404150272 (0x0000000106820000)
1STHEAPINUSE   Total memory in use:           2778235760 (0x00000000A5988370)
1STHEAPFREE    Total memory free:             1625914512 (0x0000000060E97C90)

This matches what the java core analyzer shows:

Total Java heap size: 4.1 GB  
Used Java heap size: 2.59 GB  
Free Java heap size: 1.51 GB

Yet iswga/cpu.txt file  shows  40GB.

The last javacore is similar (actually went down a bit):

1STHEAPTOTAL   Total memory:                  4294967296 (0x0000000100000000)
1STHEAPINUSE   Total memory in use:            818642896 (0x0000000030CB7FD0)
1STHEAPFREE    Total memory free:             3476324400 (0x00000000CF348030)



Also from the  java core analyzer :

* Java Heap Information
-Xmx (Maximum Java heap size) : 8192m
* -Xms (Initial Java heap size) : 4096m


There should not be any way that we are hitting 40g on that java process.","12/Apr/23 9:00 AM;5b15d950d9936c61022057fe;I’m still unable to recreate this behavior in my labs and I’ve been running every permutation of stress test I can think of for the last few weeks.    I also wanted to note [https://cloudidentity.atlassian.net/browse/ISAMSUP-4949|https://cloudidentity.atlassian.net/browse/ISAMSUP-4949|smart-link]  appears to also be reporting the same thing.   

Do we want separate Jiras for these?  I have yet to open mine for FRIT as I wanted to recreate it first. 



From what I’ve observed looking at the other cases as well is this appears to be a native memory leak in the Java process, that is triggered by a particular call.   In the other cases as well the Java heap is not reported as the source. 

For example FRIT let one of the processes grow till it crashed, the javacore reported it as a native memory leak not a heap issue.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-23%2Fisva_10.0.5.0_20230323-161856_pyq1tcac1.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012529407&path=TS012529407%2F2023-03-23%2Fisva_10.0.5.0_20230323-161856_pyq1tcac1.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F]

javacore.20230304.202144.12223.0003.txt 

In the FRIT case I think they are also seeing a class leak due to logging but that does not appear to be the main leak. ",12/Apr/23 9:11 AM;5b15d950d9936c61022057fe;[~accountid:5b15d9e6dda5f94d06b985b4] suggested that this could be related to something using the native crypto libs?,"12/Apr/23 10:31 PM;5b17571b91981f4fdde632c1;Is there a Liberty skills case open.

If not then one should be opened, to see what they might know.",12/Apr/23 10:32 PM;5b17571b91981f4fdde632c1;Customer name missing,"12/Apr/23 10:38 PM;5b17571b91981f4fdde632c1;Would suggest two cases keep the data separate just in case of multiple problems,  but everyone should watch this one for status updates, until proven the same.","14/Apr/23 3:26 AM;5b15d99b4c20165700edecad;Bill, 

  I slacked with the Liberty SDK team about this issue and they requested their must gather data to investigate. Apparently the linperf_RESULTS from their data will show the actual memory use.   Since the javacores don't always reflect the native memory use it’s more helpful to them. 

MustGather: Performance, hang, or high CPU issues with Liberty on Linux
[https://www.ibm.com/support/pages/node/1073532|https://www.ibm.com/support/pages/node/1073532]


Basically they have a script [linperf.sh|https://www.ibm.com/support/pages/system/files/inline-files/linperf.sh] that collects javacores, top, vmstats, netstat, etc and bundles it up in a specific way for their analysis. Most of this can be gathered by a combination of our fix packs, not all of it though.  BUT I think we need a fixpack that runs their script to collect exactly what they want in the same format. 

My thought is whenever we run into a Liberty performance issue we will have the customer apply the fixpack to collect the WebSphere Must Gather so we can quickly send a skill case over and let them do the initial investigation. This should take off some weight off L2/L3 since this is their area of expertise. 



I tested this script on our appliance and some of it did work but I did notice some issues with some of the commands/flags. Seems like we might need to tweek it slightly. 

# We don’t have vmstat. (Maybe as an alternative we could use the /proc/vmstat data)
# Our top command doesn’t have the “-c” option available.   (This shouldn’t be a deal breaker)
# Our ps doesn’t have the “L” option (Again shouldn’t be a deal breaker)

I was able to set verbose GC using “runtime_profile.jvm_option.1 = -verbose:gc”",22/Apr/23 1:23 AM;5b15d901fa615349cb01778b;Any update?,"25/Apr/23 8:49 AM;5b15d94b6256d01ad54eb020;I talked with Bill earlier, I don’t think he had a chance to update.    One thing he was looking  for was another javacore and heapdump.   



In my opinion, since this is an appliance  I don’t think we can get all that for a must gather.  We already know the issue is a memory usage. We should get a skils case opened with the liberty  and provide them with the heapdump for analysis.

I linked to the one I am working but I’m suspecting they have different causes based on the heapdumps.  You can refer to that skils case when talking with liberty  just in case they think it is the same.","25/Apr/23 9:51 AM;5b17571b91981f4fdde632c1;{quote}Problem

If you are experiencing performance degradation, hang, no response, hung threads, CPU starvation, high CPU utilization, or deadlocks with Liberty on Linux this MustGather assists you in collecting the critical data that is needed to troubleshoot your issue.{quote}

High memory utilization is not listed, please explain.","03/May/23 10:43 PM;5b15d99b4c20165700edecad;To diagnose this issue the WAS SDK team needs a javacore file and a system dump of the Java process.

This is the command for the system dump. 
server javadump runtime --include=system

They mentioned it doesn’t appear our Linux OS is setup so that a core.*.dmp file will be created. The JRE is having a problem with the Linux core_pattern and the ulimit soft core file size is set to zero.

Is this something we can change so a system dump can be generated? The java_dump *system command on both my 10.0.4 and 10.0.5 appliances hit an issue. Looks like we need to fix java_dump so its working properly. Also maybe the output can be zipped?
[https://openliberty.io/docs/22.0.0.9/reference/command/server-dump.html|https://openliberty.io/docs/22.0.0.9/reference/command/server-dump.html|smart-link] 

diagnostics> java_dump runtime system

Dumping server runtime.
Server runtime dump complete in /opt/IBM/wlp/usr/servers/runtime/logs/javacore.20230503.083902.110033.0001.txt.


Server runtime dump complete in /opt/ibm/wlp/usr/servers/runtime/The core file created by child process with pid = 9389 was not found. Expected to find core file with name ""/var/support/core_kernel-command-.9389"".","04/May/23 12:20 AM;5b17571b91981f4fdde632c1;* java_dump usage
** java_dump {default|runtime} {heap|*system*|thread}



* For ISVA Support only:
** The customer can be informed *without* any code snippets
*** {noformat}#define CLI_ROOT_NAME        ""diagnostics""
**#define CLI_CORE_DUMP_NAME   ""core_dumps""
**#define CLI_JAVADUMP_NAME      ""java_dump""
**#define CLI_JAVADUMP_USAGE        ""java_dump {default|runtime} {heap|system|thread}""

static const char* serverCmd     = ""/opt/ibm/wlp/bin/server"";
static const char* javaDumpCmd     = ""javadump"";
static const char* includeCmd     = ""--include="";
...
static int javaDump(int argc, const char* argv[])
{
...
	/*
	 * command to execute is of the type:
	 * /opt/ibm/wlp/bin/server javadump runtime --include=heap
	 */
	std::string includeArg(includeCmd);
	includeArg += argv[2];

	int rc = MesaSpawn(0, serverCmd, javaDumpCmd, argv[1], includeArg.c_str(), (const char*)NULL);{noformat}","04/May/23 12:42 AM;5b15d99b4c20165700edecad;This appears to be the reason java_dump * system isn’t generating a core. 

1CIUSERLIMITS  User Limits (in bytes except for NOFILE and NPROC)
NULL           ------------------------------------------------------------------------
NULL           type                            soft limit           hard limit
2CIUSERLIMIT   RLIMIT_AS                        unlimited            unlimited
*2CIUSERLIMIT   RLIMIT_CORE                              0            unlimited*

It looks like this was investigated before but its still not working in 10.0.4+
[https://github.com/OpenLiberty/open-liberty/issues/8485|https://github.com/OpenLiberty/open-liberty/issues/8485|smart-link] ","17/May/23 9:15 AM;5b17571b91981f4fdde632c1;* 2023-03-28/javacore.20230328.174241.13155.0003.txt
	2CIUSERLIMIT   RLIMIT_AS                        unlimited            unlimited
	2CIUSERLIMIT   *RLIMIT_CORE                              0            unlimited*
	2CIUSERLIMIT   RLIMIT_CPU                       unlimited            unlimited
	2CIUSERLIMIT   RLIMIT_DATA                      unlimited            unlimited
	2CIUSERLIMIT   RLIMIT_FSIZE                     unlimited            unlimited
	2CIUSERLIMIT   RLIMIT_LOCKS                     unlimited            unlimited
	2CIUSERLIMIT   RLIMIT_MEMLOCK                       65536                65536
	2CIUSERLIMIT   RLIMIT_NOFILE                        16000                16000
	2CIUSERLIMIT   RLIMIT_NPROC                         10240                10240
	2CIUSERLIMIT   RLIMIT_RSS                       unlimited            unlimited
	2CIUSERLIMIT   RLIMIT_STACK                       8388608            unlimited
	2CIUSERLIMIT   RLIMIT_MSGQUEUE                     819200               819200
	2CIUSERLIMIT   RLIMIT_NICE                              0                    0
	2CIUSERLIMIT   RLIMIT_RTPRIO                            0                    0
	2CIUSERLIMIT   RLIMIT_SIGPENDING                   257119               257119",25/May/23 4:45 AM;5b15d99b4c20165700edecad;Related to the EC JWT signing/encryption findings in [https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|smart-link] this customer is not using EC certs. They are issuing but not validating JWT in this environment and are signed with RS256 algorithm.,"09/Jun/23 9:54 PM;5b15d99b4c20165700edecad;[~accountid:5b232b2fd85e5b59b066f57f] Do you think this Java update is safe for other customers to test out? 
[https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|smart-link] 
",13/Jun/23 12:54 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d99b4c20165700edecad] - it is safe - but we don’t want to make it widely available if we can help it - we want to encourage customers to move to 10.0.6 to pick up the updated J9 / Semeru version. I’ve given the fix-pack to a couple of customers to verify in their environment. ,"14/Jun/23 7:05 AM;5b17571b91981f4fdde632c1;* For IBM ISVA support only
** Based on the information below
*** What is the next step?",27/Jun/23 4:40 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d99b4c20165700edecad] can we please get a quick confirmation if the Java test fix assisted with this customers issue? ,27/Jun/23 10:56 PM;5b15d99b4c20165700edecad;I’m checking with Royal if they have been able to test the fixpack. We might get some pushback here since we haven’t identified exactly what is using up the memory. ,28/Jun/23 8:16 AM;5ac57757d9a96536d1f0daa9;Thanks Gabe appreciate this. ,03/Jul/23 9:02 AM;5ac57757d9a96536d1f0daa9;Reassigning this item to [~accountid:5b232b2fd85e5b59b066f57f] to allow him to monitor with the other similar ones. ,"07/Jul/23 1:55 AM;5b15d99b4c20165700edecad;The customer is still testing the fixpack in a lower environment but if successful plans to deploy 10.0.6.0 in Prod instead of using the stand alone fixpack. 

This Jira is on hold until they finish the testing. We will get new Java dumps if the problem continues. ",11/Jul/23 10:51 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d99b4c20165700edecad] thank you for the update. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Vulnerability issue.,ISAMSUP-4929,291084,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,29/Mar/23 1:15 AM,17/Apr/23 5:10 PM,14/Jul/23 2:47 PM,17/Apr/23 5:10 PM,,,,0,Escalation,,,"Customer auditor have the following findings.

!image-20230328-151323.png|width=1832,height=750!

L3 can please advise it will not affect 10.0.1",,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,29/Mar/23 1:15 AM;ug:0ee7b799-b6e9-4655-838c-29a4ccb2e066;image-20230328-151323.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193032,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012307491,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,KONINKLIJKE AHOLD DELHAIZE N.V,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a1u7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-03-28 22:42:25.704,,,,,29/Mar/23 8:42 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] can you please review this and confirm if we need to take these through the formal PSIRT process? ,29/Mar/23 8:44 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac57757d9a96536d1f0daa9] If they are reported on 10.0.1.0 they need to be recreated on 10.0.5.0 to go through PSIRT process.,31/Mar/23 6:07 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d8fd6e93913e31e279fb] Customer is asking for an update please.,06/Apr/23 9:33 AM;5b15d901fa615349cb01778b;[~accountid:5ac57757d9a96536d1f0daa9] Any update? customer escalating. ,"07/Apr/23 12:48 AM;5b15d8fd6e93913e31e279fb;[~accountid:617a5f2cf485cd0068cb98af] The Security Fix Policy for ISAM and ISVA is that all security vulnerabilities will be fixed on the latest Mod Level of the product as documented here - [https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|smart-link] 

Many of these issues have been fixed in later versions of ISVA 10.0.X due to internal Pen Testing and the customer scan should be done on the ISVA 10.0.5.0 IF1.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Query regarding change in EncryptedAssertion in recent version,ISAMSUP-4928,290900,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,28/Mar/23 4:59 PM,30/Jun/23 1:02 PM,14/Jul/23 2:47 PM,30/Jun/23 1:02 PM,,Support,,0,,,,"In recent versions the tag changed with an extra 'xenc:'

 from 

<EncryptedData 

to 

<xenc:EncryptedData 


The 9.0.7 release did not use the prefix of ""_xenc:_"" but instead used an alternative way to indicate the namespace of 'XML encrypted', namely through  putting _xmlns=""_[http://www.w3.org/2001/04/xmlenc#|http://www.w3.org/2001/04/xmlenc#|smart-link] _""_ in the element itself.

So both approaches looks to be according to the specs and that it's likely that recent versions of the ISVA use another crypto library/ Java SDK.

Can we have backward compatibility using the old libraries to continue as earlier version? Or customer has to make required changes in their application end?",,Asha Shivalingaiah,prashant_kamat,,,,,,,,,,,,,,5af4ad7d4dd24c579110120b,5b15d9ef27631840ea300110,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012547418,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,,,,"CATHAY LIFE INSURANCE CO., LTD",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a0pb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-03-30 22:24:16.703,,,,,"31/Mar/23 8:24 AM;5b15d99182e05b22cc7d5947;Hello Nilesh,

Do not believe this new behavior can be backported. Will investiage. However customer should continue looking into necessary changes needed to accomendate new behavior.

Thanks!",06/Apr/23 4:20 PM;5b1757156d76184b7d98a0c3;[~accountid:5b15d99182e05b22cc7d5947] any chance to backport it? Or only client side changes is the option?,11/Apr/23 2:33 PM;5b1757156d76184b7d98a0c3;[~accountid:5b15d99182e05b22cc7d5947] Customer is looking for the changes done in recent versions like reported in this. Do we have such a list? Customer would like to do all the changes in their application before they face any issue.,"17/Apr/23 10:18 PM;5b1757156d76184b7d98a0c3;[~accountid:5b15d99182e05b22cc7d5947] any update on this? Customer is escalating to get the answers.

Do we have any list which mentions all the recent changes like xnec?
And confirmation if we can back port the change or not?","18/Apr/23 3:48 PM;5b15d9ef27631840ea300110;[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5b15d99182e05b22cc7d5947] Customer is complaining. Can we have an update to answer to customer. 
Can we list all the changes done in the newer version so that they can continue to update their applications
",18/Apr/23 11:14 PM;5b232b2fd85e5b59b066f57f;@gbe - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,21/Apr/23 1:43 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b1757156d76184b7d98a0c3] - there has been many changes to the encryption / decryption of xml since 9.0.7; the majority the result of the switch to OpenJDK. We will not be able to forward port the old implementation / libraries. ,"03/May/23 9:12 PM;5b1757156d76184b7d98a0c3;[~accountid:5b232b2fd85e5b59b066f57f] as discussed on slack in last week, can you please give more details about this?","08/May/23 4:27 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b1757156d76184b7d98a0c3] - I’m currently discussing with the Development Team member who worked on some of this to see if they can provide any further info - however, as discussed via Slack, given these changes seem to be related to our move to OpenJDK, I suspect we do not have a definitive list of these types of impacts - especially when both implementations pre and post upgrade satisfy the spec. ",17/May/23 7:21 PM;5b1757156d76184b7d98a0c3;[~accountid:5b232b2fd85e5b59b066f57f] any update from Development team?,"12/Jun/23 12:35 PM;5b232b2fd85e5b59b066f57f;According to Dev, this is likely due to differences in implementation in OpenJDK. It will not be possible to detail all similar changes as these may not within our code-base. ",30/Jun/23 1:02 PM;5b1757156d76184b7d98a0c3;Customer closed case. Closing Jira.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
RSyslog forwarder did not started up after appliance reboot,ISAMSUP-4919,290033,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,William Hannon Jr,5b17571b91981f4fdde632c1,Kenji Seta,5b209ff1a56d9112a2a6f638,Kenji Seta,5b209ff1a56d9112a2a6f638,24/Mar/23 6:02 PM,11/Jul/23 11:42 AM,14/Jul/23 2:47 PM,,,,,0,requiresUpdate,,,"The customer’s appliance had abnormally down caused by power trouble. After appliance launched up, they found Remote Syslog Transfer did not send any logs to Syslog server.

They restarted appliance 2 or 3 times but the situation was not changed.

L2 investigated support file and found rsyslogd for rsyslog forwarder did not exist. And, there were no rsyslogd startup logs at restarting trials.

So, L2 requested customer to restart rsyslogd by setting debug option. Then, rsyslogd became launched and started to send logs to Syslog server.



By the L2’s investigation, this issue seems to be caused by rsyslog.pid file issue. L2 successfully recreated same situation with following steps.

# Killed (kill -9) rsyslogd process of rsyslog forwarder
# Put existing daemon’s PID into rsyslog.pid file
# Toggle debug option off for Rsyslog Forwarder to try to start syslogd.
# rsyslogd was started but immediately stopped without message (in /var/log/messages and /var/application.logs/rsyslog_forwarder/server-port.log)
# (If with debug option, startup and stop logs were recorded in server-port.log)



Are there any way to delete pid file at appliance startup?



Additionally, customer’s Rsyslog forwarder has other 2 issues.

These will be resolved by re-configuring rsyslog forwerder server definition. Is there another smart solution?

1 queue file was broken and never recovered

{noformat}Jan 29 13:53:06 rsyslogd: action-0-builtin:omfwd queue[DA]: queue files exist on disk, re-starting with 170 messages. This will keep the disk queue file open, details: https://rainer.gerhards.net/2013/07/rsyslog-why-disk-assisted-queues-keep-a-file-open.html [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/0 ]
Jan 29 13:53:06 rsyslogd: [origin software=""rsyslogd"" swVersion=""8.1911.0-7.el8.ibm.1"" x-pid=""1601"" x-info=""https://www.rsyslog.com""] start

Jan 29 13:53:06 rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
Jan 29 13:53:06 rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0 [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
Jan 29 13:53:06 rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
Jan 29 13:53:06 rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]

... skip ...

Mar 15 20:37:30 rsyslogd: action-0-builtin:omfwd queue[DA]: queue files exist on disk, re-starting with 170 messages. This will keep the disk queue file open, details: https://rainer.gerhards.net/2013/07/rsyslog-why-disk-assisted-queues-keep-a-file-open.html [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/0 ]
Mar 15 20:37:30 rsyslogd: [origin software=""rsyslogd"" swVersion=""8.1911.0-7.el8.ibm.1"" x-pid=""9325"" x-info=""https://www.rsyslog.com""] start
Mar 15 20:37:30 rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
Mar 15 20:37:30 rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0 [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
Mar 15 20:37:30 rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
Mar 15 20:37:30 rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]


Mar 15 20:42:48 rsyslogd: [origin software=""rsyslogd"" swVersion=""8.1911.0-7.el8.ibm.1"" x-pid=""9325"" x-info=""https://www.rsyslog.com""] exiting on signal 15.
Mar 15 20:42:50 rsyslogd: action-0-builtin:omfwd queue[DA]: queue files exist on disk, re-starting with 170 messages. This will keep the disk queue file open, details: https://rainer.gerhards.net/2013/07/rsyslog-why-disk-assisted-queues-keep-a-file-open.html [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/0 ]
Mar 15 20:42:50 rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
Mar 15 20:42:50 rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0 [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
Mar 15 20:42:50 rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
Mar 15 20:42:50 rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
{noformat}

2 huge number of imfile-state files.

{noformat}# grep -c imfile-state iswga/ls.txt
14131
# grep imfile-state iswga/ls.txt | head -10
-rw-------    1 root     root           119 Feb 15 07:17 imfile-state:3409543:00c70e22d233f256
-rw-------    1 root     root           119 Feb 13 07:57 imfile-state:3409543:0e5d1a411a010b2c
-rw-------    1 root     root           119 Feb 10 07:47 imfile-state:3409543:18068d4b0c07dce2
-rw-------    1 root     root           119 Feb 12 08:47 imfile-state:3409543:1b89c46b616f1dca
-rw-------    1 root     root           119 Jan 31 07:46 imfile-state:3409543:2c290f913fc91886
-rw-------    1 root     root           119 Jan 29 20:01 imfile-state:3409543:331af82d5ce8ec65
-rw-------    1 root     root           119 Feb 21 06:28 imfile-state:3409543:37caca1fe0990e08
-rw-------    1 root     root           119 Feb  4 06:33 imfile-state:3409543:5a72ae6febf15dd3
-rw-------    1 root     root           119 Feb 18 09:21 imfile-state:3409543:6b78bab27fdcdaea
-rw-------    1 root     root           119 Feb  1 06:32 imfile-state:3409543:73987203a7794add{noformat}



Support file before enabling debug option of rsyslog forwarder (no logs sent)

* /ecurep/sf/TS012/415/TS012415216/2023-03-13/20230313_ISAM.zip_unpack/20230313_ISAM/isva_10.0.3.1_20230313-141842_JUCXID00A.support_unpack/

Support file after enabling debug option (started to send logs)

* /ecurep/sf/TS012/415/TS012415216/2023-03-15/20230315_ISAM3.zip_unpack/20230315_ISAM3/isva_10.0.3.1_20230315-204625_JUCXID00A.support_unpack/",,khansen,Nick Lloyd,prashant_kamat,Tushar Prasad,Yutaka Kanemoto,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,5b15d9ec6d76184b7d989c83,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5208,11/Jul/23 11:35 AM;seta;Remove_ALL_rsyslog_forwarder_fwdRule_logs.tar.gz;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/210509,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012415216,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Kenji Seta,5b209ff1a56d9112a2a6f638,,,,SOMUSHO YUSEI SHOKUIN KUMIAI,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ibm.ent.box.com/folder/215883341702,,,,,,,,,,,,,,,,,,,,,,,0|i19vdb:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-03-30 04:08:41.53,,,,,30/Mar/23 2:08 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] thanks for calling this out but I think there was a misunderstanding on your side. I said that I would take a look at these to confirm if there is anything that we could do as we ran out of time at our meeting. This does not mean that you should not look at these as they are still assigned to you. Please ensure that these are reviewed during your day tomorrow and an update that can assist the customer to move forwards with their issue.,"03/Apr/23 10:38 AM;5b209ff1a56d9112a2a6f638;Hi L3, are there any updates?","04/Apr/23 12:15 AM;5b17571b91981f4fdde632c1;* For ISVA Suppport
** They broke ECUREP Archive Explorer again
*** For the third or fourth time
*** {noformat}starting  sftp
Mon Apr  3 14:12:10 UTC 2023
Host: l3pmrsupport.tivlab.austin.ibm.com
Host port: 22
mode=bin
FATAL [TransportProtocolCommon] 3 Apr 2023 14:12:13.652 : The remote computer does not appear to support the SSH protocol: ''
ERROR [ConnectTask] 3 Apr 2023 14:12:13.655 : 1:Connect[l3pmrsupport.tivlab.austin.ibm.com:22] failed : The remote computer does not appear to support the SSH protocol
com.enterprisedt.net.j2ssh.transport.TransportProtocolException: The remote computer does not appear to support the SSH protocol
at com.enterprisedt.net.j2ssh.transport.TransportProtocolCommon.a(TransportProtocolCommon.java:1307)
at com.enterprisedt.net.j2ssh.transport.TransportProtocolCommon.run(TransportProtocolCommon.java:429)
at java.lang.Thread.run(Thread.java:825){noformat}","04/Apr/23 3:43 AM;5b17571b91981f4fdde632c1;* On hold
** Password(s) are not documented
** {noformat}Archive:  2023-03-13/20230313_ISAM.zip
[2023-03-13/20230313_ISAM.zip] 20230313_ISAM/remote_syslog.png password: {noformat}","05/Apr/23 10:18 AM;5b209ff1a56d9112a2a6f638;The password for provided zip files is “De8!kLb”.

I already had extracted zip files with password and pasted links to unpack directories.","05/Apr/23 12:51 PM;5b17571b91981f4fdde632c1;{quote}I already had extracted zip files with password and pasted links to unpack directories.{quote}

* We use our own ECUREP system","11/Apr/23 4:06 PM;5b209ff1a56d9112a2a6f638;Hi Bill, are there any progress?
Do you think this is pid file issue?",18/Apr/23 11:13 PM;5b232b2fd85e5b59b066f57f;@whannon - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"20/Apr/23 11:55 AM;5b209ff1a56d9112a2a6f638;Hi L3, could you please let customer know current progress?","26/Apr/23 11:24 AM;5b209ff1a56d9112a2a6f638;[~accountid:5b17571b91981f4fdde632c1] [~accountid:5b232b2fd85e5b59b066f57f] 

Hi L3, please provide status update to the customer. They have not got response from L3.","27/Apr/23 4:30 AM;5b17571b91981f4fdde632c1;* For IBM Support only:
** rsysylog versions
*** 10.0.3.1: {{rsyslog-8.1911.0-*.x86_64.rpm}}

{noformat}../isva1000/git/200612/src/appliance/app-core/main/pdweb_rootfs.mk g 86 $(MCP_PKGDIR)/rsyslog-7.4.7-7.*.x86_64.rpm \
../isva1000/git/201111_IF1/src/appliance/app-core/main/pdweb_rootfs.mk g 86 $(MCP_PKGDIR)/rsyslog-7.4.7-7.*.x86_64.rpm \
../isva1010/git/201125/src/appliance/app-core/main/pdweb_rootfs.mk g 86 $(MCP_PKGDIR)/rsyslog-7.4.7-7.*.x86_64.rpm \
../isva1010/git/210311_IF1/src/appliance/app-core/main/pdweb_rootfs.mk g 86 $(MCP_PKGDIR)/rsyslog-7.4.7-7.*.x86_64.rpm \
-
../isva1020/git/210610/src/appliance/app-core/main/pdweb_rootfs.mk g 92 $(MCP_PKGDIR)/rsyslog-8.1911.0-*.x86_64.rpm \
../isva1030/git/211214/src/appliance/app-core/main/pdweb_rootfs.mk g 92 $(MCP_PKGDIR)/rsyslog-8.1911.0-*.x86_64.rpm \
-
../isva1040/git/220624/src/appliance/app-core/main/pdweb_rootfs.mk g 92 $(MCP_PKGDIR)/rsyslog-8.2102.0-*.x86_64.rpm \
../isva1050/git/221209/src/appliance/app-core/main/pdweb_rootfs.mk g 92 $(MCP_PKGDIR)/rsyslog-8.2102.0-*.x86_64.rpm \{noformat}","27/Apr/23 4:34 AM;5b17571b91981f4fdde632c1;* Same problem that that happened on 1/29/2023
** What did they do to clear up on 1/29/2023?
*** Or did the problem disappear?
*** Interesting note
**** {{fwdRule.00033381}}
***** Both times same name
** When this did happen what was the latest remote syslog server update?

{noformat}      2 JUCXID00A	01/29/2023 13:53:06	1675000386	rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      2 JUCXID00A	01/29/2023 13:53:06	1675000386	rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0 [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      2 JUCXID00A	01/29/2023 13:53:06	1675000386	rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      2 JUCXID00A	01/29/2023 13:53:06	1675000386	rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
-
      2 JUCXID00A	01/29/2023 14:15:58	1675001758	rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      2 JUCXID00A	01/29/2023 14:15:58	1675001758	rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0 [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      2 JUCXID00A	01/29/2023 14:15:58	1675001758	rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      2 JUCXID00A	01/29/2023 14:15:58	1675001758	rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
-
      2 JUCXID00A	01/29/2023 17:44:12	1675014252	rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      2 JUCXID00A	01/29/2023 17:44:12	1675014252	rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0 [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      2 JUCXID00A	01/29/2023 17:44:12	1675014252	rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      2 JUCXID00A	01/29/2023 17:44:12	1675014252	rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
...
      1 JUCXID00A	03/15/2023 20:37:30	1678912650	rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      1 JUCXID00A	03/15/2023 20:37:30	1678912650	rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0 [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      1 JUCXID00A	03/15/2023 20:37:30	1678912650	rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      1 JUCXID00A	03/15/2023 20:37:30	1678912650	rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
-
      1 JUCXID00A	03/15/2023 20:42:50	1678912970	rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      1 JUCXID00A	03/15/2023 20:42:50	1678912970	rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0 [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      1 JUCXID00A	03/15/2023 20:42:50	1678912970	rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      1 JUCXID00A	03/15/2023 20:42:50	1678912970	rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]{noformat}

 ","27/Apr/23 5:00 AM;5b17571b91981f4fdde632c1;* For IBM Support only
** [https://bugzilla.redhat.com/show_bug.cgi?id=1483664|https://bugzilla.redhat.com/show_bug.cgi?id=1483664|smart-link] 
*** Status: CLOSED NOTABUG
** [https://bugs.launchpad.net/juju-core/+bug/1683075|https://bugs.launchpad.net/juju-core/+bug/1683075|smart-link] 
*** {{Fix went in to v8.18 release of rsyslog}}
**** 10.0.3.0 is V8.19
** [https://github.com/rsyslog/rsyslog/issues/4018|https://github.com/rsyslog/rsyslog/issues/4018|smart-link] 
*** This looks like you did a kill -9 - rsyslog can not guard against this.
*** I did a shutdown of the VM via power off. I hardened the queues. Seems fine now.
** [https://github.com/rsyslog/rsyslog/blob/master/ChangeLog|https://github.com/rsyslog/rsyslog/blob/master/ChangeLog|smart-link] 
*** {{Scheduled Release 8.2302.0 (aka 2023.02) 2023-02-21}}
**** core substring function: enhancement and hardening Now, length can have a negative value -n to denote that the substring should be build between startpos and the character -n chars from the end. This is a shortcut for stripping charactes on ""both ends"" of the string. See doc for details on the enhanced semantics. Also, some hardening against invalid startpos and length has been added.
** [https://www.suse.com/support/kb/doc/?id=000019352|https://www.suse.com/support/kb/doc/?id=000019352|smart-link] ","27/Apr/23 6:51 AM;5b17571b91981f4fdde632c1;* For ISVA L3 support only:
**  [https://rsyslog.readthedocs.io/|https://rsyslog.readthedocs.io/|smart-link] 
*** [https://rsyslog.readthedocs.io/en/latest/concepts/queues.html|https://rsyslog.readthedocs.io/en/latest/concepts/queues.html|smart-link] 
** {{queue.filename}}
*** type default mandatory obsolete legacy directive
**** word none no $ActionQueueFileName
*** File name to be used for the queue files. If specified, this parameter enables disk-assisted queue functionality. If not specified, the queue will operate without saving the queue to disk, either during its operation or when shut down. See the separate queue.saveonshutdown parameter to configure that option. Please note that this is actually just the file name. A directory can NOT be specified in this parameter. If the files shall be created in a specific directory, specify queue.spoolDirectory for this. The filename is used to build to complete path for queue files.
*** {noformat}isva1050/git/src/appliance/app-core/modules/config_isam_rsyslog_forwarder.cpp
Server::writeConfig 695
fprintf(fp, ""queue.filename=\""fwdRule\""\n"");{noformat}
** queue.highwatermark
*** type default mandatory obsolete legacy directive
**** integer
***** 90% of queue.size
****** no
****** $ActionQueueHighWaterMark
*** This applies to disk-assisted queues, only. When the queue fills up to this number of messages, the queue begins to spool messages to disk. Please note that this should not happen as part of usual processing, because disk queue mode is very considerably slower than in-memory queue mode. Going to disk should be reserved for cases where an output action destination is offline for some period.
** queue.size
*** type default mandatory obsolete legacy directive
**** integer
***** 1000/50000
****** no
****** $ActionQueueSize
**** This is the maximum size of the queue in number of messages. Note that setting the queue size to very small values (roughly below 100 messages) is not supported and can lead to unpredictable results. For more information on the current status of this restriction see the rsyslog FAQ: “lower bound for queue sizes”.
**** The default depends on queue type and rsyslog version, if you need a specific value, please specify it. Otherwise rsyslog selects what it considers appropriate for the version in question. In rsyslog rsyslog 8.30.0, for example, ruleset queues have a default size of 50000 and action queues which are configured to be non-direct have a size of 1000.","29/Apr/23 8:45 AM;5b17571b91981f4fdde632c1;For ISVA L3 Support only:

* {{rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]}}
** Simply returns","01/May/23 12:50 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] 

The missing file of{{fwdRule.00033381}} message is not main issue. The rsyslogd daemon is working with this error (seems to disable queue mechanism)

So, the main issue - rsyslogd was not started up - may not be related.



| {{When this did happen what was the latest remote syslog server update?}}

What do you want to know? these messages were sent from ISVA.

Should I open new Jira for each issue?","02/May/23 1:50 AM;5b17571b91981f4fdde632c1;{quote}mmhhh.. that is bad. If you look at the debug log, a queue file is missing:
{{open error 2, file '/var/lib/rsyslog/linux.00000405': No such file or directory}}
At that stage, we have indeed lost because we cannot continue processing the queue.{quote}



{quote}I can reproduce the failure if I deliberately corrupt the queue size inside the .qi file, see the test that I added (commit ref above). So the root cause is a corrupt .qi file.{quote}



{quote}I can reproduce the failure if I deliberately corrupt the queue size inside the .qi file, see the test that I added (commit ref above). So the root cause is a corrupt .qi file.{quote}","02/May/23 2:29 AM;5b17571b91981f4fdde632c1;{quote}Let’s start with explaining what can be seen: if a disk-assisted queue is configured, rsyslog will normally use the in-memory queue. It will open a disk queue only if there is good reason to do so (because it severely hurts performance). The prime reason to go to disk is when the in memory queue’s configured size has been exhausted. 

Once this happens, rsyslog begins to create spool files, numbered consequtively. This should normally happen in cases where e.g. a remote target is temporarily not reachable or a database engine is responding extremely slow.  Once the situation has been cleared, rsyslog clears out the spool files.

However, one spool file always is kept until you shut rsyslog down. Note well that when the disk queue is idle, all messages are processed even though the the physical spool file still contains some already-processed data (impstats will show you the exact details).{quote}



{quote}When the in-memory queue runs out of space, it starts that Disk queue, which than allocates its queue file.{quote}","02/May/23 2:50 AM;5b17571b91981f4fdde632c1;{noformat}      1 JUCXID00A	03/15/2023 20:42:50	1678912970	rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      1 JUCXID00A	03/15/2023 20:42:50	1678912970	rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0 [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      1 JUCXID00A	03/15/2023 20:42:50	1678912970	rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]
      1 JUCXID00A	03/15/2023 20:42:50	1678912970	rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory [v8.1911.0-7.el8.ibm.1 try https://www.rsyslog.com/e/2040 ]{noformat}

* From my prior post if you separate flows by timeframes at same second in same order multiple times
** {{rsyslogd: action-0-builtin:omfwd queue[DA]: error dequeueing element - ignoring, but strange things may happen}}
*** Unable to dequeue
** {{rsyslogd: action-0-builtin:omfwd queue[DA]: qDeqDisk error happened at around offset 0}}
*** Offset 0 is the beginning of the file
**** Nothing is there
** {{rsyslogd: fatal error on disk queue 'action-0-builtin:omfwd queue[DA]', emergency switch to direct mode}}
*** fatal error
** {{rsyslogd: file '/var/rsyslog.forwarder/server_1/fwdRule.00033381': open error: No such file or directory }}
*** ","02/May/23 2:59 AM;5b17571b91981f4fdde632c1;* For ISVA IBM Support only:
** [https://github.com/rsyslog/rsyslog/issues/4892|https://github.com/rsyslog/rsyslog/issues/4892|smart-link] 
*** rsyslog version: 8.19.01
**** *2019-01-22*
*** Notice our message
**** {{v8.1911}}
***** 8.19.11
****** *2019-11-12*
** 
{noformat}rgerhards commented on Jun 14, 2022
The version you are using is very old and no longer supported by the community.
It is also very probable that the problem stems back to long-solved issues.
As such, please update to the currently supported version and retry.
Report back if the problem persists.

The rsyslog project provides packages for current versions: https://www.rsyslog.com/downloads/download-other/

If you insist on using an outdated version, you can also contact your distro or consider rsyslog professional services.{noformat}
** 
** {noformat}This error is saying that there is a problem with the files on disk.
It could be a permission error (including SELinux/AppArmor permissions),
or it could be a corrupt file.{noformat}

[~accountid:5ac57757d9a96536d1f0daa9] ","02/May/23 3:54 AM;5b17571b91981f4fdde632c1;For ISVA L3 Support only:

{noformat}However,
 * we do not really stop or destruct the in-memory disk queue object.
 * Practice has shown that this may cause races during destruction which
 * themselfs can lead to segfault. So we prefer to was some ressources by
 * keeping the queue active.
 * Instead, the queue is switched to direct mode, so that at least
 * some processing can happen.{noformat}","02/May/23 10:29 AM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] thank you for your detail explanation. I understand that missing queue file can be a cause of stopping rsyslogd.

If missing queue file is caused by implementation of rsyslogd, is it possible to build a fixpack to repair(delete) queue file (and delete a lot of imfile-state files)?

Best regards,

Kenji","02/May/23 10:31 AM;5b17571b91981f4fdde632c1;How was it cleared before (multiple times) per my prior post with date time

Check for any down syslog servers

On restart I believe the comment was that it tries to do direct first and not use the queue.  Otherwise the true root cause may happen again.","02/May/23 10:55 AM;5b209ff1a56d9112a2a6f638;Since missing queue file in each start logs are same filename, the customer have not cleared it.

At least, rsyslogd would be working with this condition until queue file was required.",15/May/23 10:12 AM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] are there any updates?,"19/May/23 7:46 AM;5b17571b91981f4fdde632c1;* TS012415216/2023-03-15/20230315_ISAM3.zip_unpack/20230315_ISAM3/isva_10.0.3.1_20230315-204625_JUCXID00A.support_unpack/iswga/ls.txt
** /var/rsyslog.forwarder/server_1/fwdRule.qi	-	-rw-------	root	root	500	Jul  6  2019
** /var/rsyslog.forwarder/server_1/imfile-state:[0-9]+:[0-9a-f]
*** 14,133	files
**** rsyslog must keep track of which parts of the monitored file are already processed through imfile-state ""state files""
** /var/rsyslog.forwarder/server_1/rsyslog.conf	-	-rw-rw-r--	root	root	2091	Mar 15 20:42
** /var/rsyslog.forwarder/server_1/rsyslog.pid	-	-rw-rw-r--	root	root	5	Mar 15 20:42
** /var/rsyslog.forwarder/server_1/rsyslog.state.*
*** /var/rsyslog.forwarder/server_1/rsyslog.state.1	-	-rw-------	root	root	247	Jan 29 13:52
/var/rsyslog.forwarder/server_1/rsyslog.state.2	-	-rw-------	root	root	248	Jan 29 13:52
/var/rsyslog.forwarder/server_1/rsyslog.state.3	-	-rw-------	root	root	234	Jan 29 13:52
/var/rsyslog.forwarder/server_1/rsyslog.state.4	-	-rw-------	root	root	234	Jan 29 13:52
/var/rsyslog.forwarder/server_1/rsyslog.state.5	-	-rw-------	root	root	231	Jan 29 13:52
/var/rsyslog.forwarder/server_1/rsyslog.state.6	-	-rw-------	root	root	248	Jan 29 13:52
/var/rsyslog.forwarder/server_1/rsyslog.state.7	-	-rw-------	root	root	244	Jan 29 13:52",29/May/23 2:49 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] are there any updates?,"05/Jun/23 9:38 AM;5b17571b91981f4fdde632c1;* For ISVA L3 Support only

{noformat}()
../isva1050/src/appliance/app-core/modules/config_isam_rsyslog_forwarder.cpp rsyslogDataDir 64 #define rsyslogDataDir ""/var/rsyslog.forwarder""

()
../isva1050/git/221209/src/appliance/app-core/modules/config_isam_rsyslog_forwarder.cpp Server::setIdentifier 752 path_ = rsyslogDataDir;
../isva1050/git/221209/src/appliance/app-core/modules/config_isam_rsyslog_forwarder.cpp Server::setIdentifier 753 path_ += ""/server_"";
../isva1050/git/221209/src/appliance/app-core/modules/config_isam_rsyslog_forwarder.cpp Server::setIdentifier 754 path_ += id;
../isva1050/git/221209/src/appliance/app-core/modules/config_isam_rsyslog_forwarder.cpp Server::setIdentifier 756 cfgFile_ = path_;

()
../isva1050/git/221209/src/appliance/app-core/modules/config_isam_rsyslog_forwarder.cpp Server::writeConfig 613 if (name_.empty()) { amwa_sys_command(0, ""/bin/rm"", ""-rf"", ""--"", path_.c_str(), NULL);{noformat}","05/Jun/23 9:41 AM;5b17571b91981f4fdde632c1;* If you modify the syslog forwarder config file then during commit it will execute
** ""/bin/rm -rf -- /var/rsyslog.forwarder/server_<id>""
*** Which would only effect ONLY “server_<id>”
**** As shown on Support file ls.txt","06/Jun/23 11:07 AM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] 

This “rm -rf” command deletes directory for specific server definition. It clears all including pid file, state files, cache files and config file. 

I feel this equals deletion of server definition and makes impacts to current log forwarding.

When this logic will be called?

When I changed server definitions, the directory was not cleared.



Back to the original problem and questions.

1 Cause of the issue - “RSyslog forwarder did not started up after appliance reboot”

  If this issue is not caused by pid issue, please let customer to know the reason.

2 How to prevent next recreation

3 How to repair cache file

4 How to reduce state files



Best regards,

Kenji","06/Jun/23 11:48 AM;5b15d954b0d76456f36daf33;– Internal only --

[~accountid:5b17571b91981f4fdde632c1] 

I think we should first delete any existing pid file before starting the watchdog for rsyslogd.

config_isam_rsyslog_forwarder.cpp:

{noformat}            std::string pidFile;
            pidFile  = path_;
            pidFile += ""/rsyslog.pid"";{noformat}

{noformat}            unlink(pidFile.c_str());{noformat}

{noformat}            ...
            amwa_sys_command(0, 
                    ""/usr/sbin/wga_watchdogd"", 
                    serverName.c_str(),
                    ""-log_entry"", logString.c_str(),
                    ""/usr/sbin/rsyslogd"", debugFlag, ""-n"", 
                    ""-f"", cfgFile_.c_str(),
                    ""-i"", pidFile.c_str(),
                    NULL) != 0{noformat}

That should prevent this problem from occuring again?","12/Jun/23 6:14 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1], are there any updates which we can report to the customer?",13/Jun/23 12:18 PM;5b232b2fd85e5b59b066f57f;@whannon - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"20/Jun/23 7:57 AM;5b17571b91981f4fdde632c1;* I had a discussion with Nick Lloyd on this
** He said L2 has helped customer to remove and re-add through RestAPI *without any loss of configuration*
*** Which would *only* effect one server
**** Would it be worth discussing with [~accountid:5b15d9e6dda5f94d06b985b4] 
* If a fixpack is created it will deleted /var/rsyslog.forwarder/*/fwdRule.qi
** *All fwdRule.qi files under /var/rsyslog.fowarder* directory
*** Which could have negative effect for customers with more than ONE  subdirectory under /var/rsyslog.fowarder
**** L2 would have to carefully explain to the customer the effect of the fixpack (now or in the future)
* Which is the lower risk to the customer (now or in the future)","20/Jun/23 10:25 AM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] [~accountid:5b15d9e6dda5f94d06b985b4] 

{quote}He said L2 has helped customer to remove and re-add through RestAPI *without any loss of configuration*{quote}

How to invoke this clean-up behavior?

When I changed configuration of rsyslog server definition or added/deleted sources,  files under /var/rsyslog.forwarder/server_<id> were not removed. Only pid file was updated caused by process restarting.

What is the condition for executing of “/bin/rm -rf -- /var/rsyslog.forwarder/server_<id>"" logic?



I will ask customer about fixpack for deleting fwdRule.qi files under all of server definitions.","21/Jun/23 6:01 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] The customer request us to build a fixpack for cleaning cache file. They understand consideration of fixpack. Fortunately, customer has only one sever definition.",27/Jun/23 4:56 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] can you please provide an update regarding this Jira item? What are out next steps forward to assist our customer? ,"01/Jul/23 7:17 AM;5b17571b91981f4fdde632c1;* Fixpack built
** Need to test on appliance next",05/Jul/23 10:06 AM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] can I test fixpack on my local environment?,"06/Jul/23 5:16 AM;5b17571b91981f4fdde632c1;* Fixpack link above
** If below ISVA 10.0.5.0 requires isva_signing fixpack to allow
*** [https://ak-delivery04-mul.dhe.ibm.com/sar/CMA/TIA/0b1nj/0/isva_signing.fixpack|https://ak-delivery04-mul.dhe.ibm.com/sar/CMA/TIA/0b1nj/0/isva_signing.fixpack]
** pkill -HUP  -f rsyslog_forwarder
*** Stops rsyslog_forwarder via pkill (HUP,  TERM,  KILL)
** find /var/rsyslog.forwarder -type f -print 2>/dev/null | grep '^/var/rsyslog\.forwarder/\[^/\]*/fwdRule.qi$' | xargs -n1 rm -f
*** Removes all /var/syslog.forwarder/*/fwdRule.qi
** mesa_control reboot
*** Forces restart of appliance","06/Jul/23 5:17 AM;5b17571b91981f4fdde632c1;{quote}can I test fixpack on my local environment?{quote}

Sure","06/Jul/23 1:18 PM;5b209ff1a56d9112a2a6f638;Hi Bill, thank you for helping on slack. I also update here with the test result.

Verified on standalone 10.0.5.

The fixpack installation was failed with “System Error”. However, the fwRule.qi files were deleted as expected and an appliance was automatically rebooted.

After booted up, there is no entries in Fixpack list (because it was failed).

I provided fixpack log and a part of /var/log/messages related to fixpack installation.



Memo: Recreation steps to make missing cache file situation.

# Configure standalone appliance with one reverse proxy instance.
# Configure rsyslog forwarder - tcp - LMI and request.log
# Stop rsyslogd server
# Generate 10000 requests against reverse proxy
## Check if /var/rsyslog.forwarder/server_1/fwdRule.00000001 file is generated
# Restart appliance
## fwdRule.qi, fwdRule.00000001 and fwdRule.00000002 are generated
# Start rsyslogd server
# Wait for a moment. fwdRule.00000001 will be deleted.
# Make error situation on /var/rsyslog.forwarder/server_1 directory
## kill -9 <pid>
## rm -f rsyslog.pid fwdRule.0*
# Restart appliance","07/Jul/23 4:05 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** {color:#bf2600}*The original problem was for fwdRule.qi with no Disk Queue files (fwdRule.XXXXXXX  7-digit number)*{color}
*** *I believe we will be forced to delete the fwdRule.XXXXXXX files now*
**** Since fwdRule.qi points to  *fwdRule.XXXXXXX*
** Disk Queues¶
…
When a disk queue is written, it is done in chunks.
Each chunk receives its individual file. Files are named with a prefix (set via the “$<object>QueueFilename“ config directive) and followed by a 7-digit number (starting at one and incremented for each file).
Chunks are 10mb by default, a different size can be set via the”$<object>QueueMaxFileSize“ config directive
** at queue startup if there is an on-disk queue present (presence of QI file indicates presence of queue data
** ","07/Jul/23 8:36 AM;5b17571b91981f4fdde632c1;* Per Remove_ALL_rsyslog_forwarder_fwdRule.log
** Everything worked as expected for post_install.sh
*** rsyslog_forward process(es) killed
*** fwdRule.qi removed
*** appliance reboot
*** exit status 0
*** Caller of post_install.sh
**** exit status 0 tested by caller
**** tested /var/fixpacks/fixpack-9 → /var/fixpacks/fixpack-0 for availability
**** mv /var/fixpacks/fixpack.CJNVAj /var/fixpacks/fixpack-0
***** To preserve fixpack
**** temporary files removed
*** Most likely the reboot (from mesa_control reboot)
**** Took effect before final steps
*** {color:#bf2600}*nohup bash -c ' sleep 10 && mesa_control reboot ' &*{color}
**** Will delay for 10 seconds
**** Then reboot (from mesa_control reboot)","07/Jul/23 8:51 AM;5b17571b91981f4fdde632c1;* For ISVA L2 Support:
** Please confirm this other change (stated below)
*** {color:#bf2600}*The original problem was for fwdRule.qi with no Disk Queue files (fwdRule.XXXXXXX 7-digit number)*{color}
**** *I believe we will be forced to delete the fwdRule.XXXXXXX files now*
***** Since fwdRule.qi points to *fwdRule.XXXXXXX*","07/Jul/23 11:37 AM;5b209ff1a56d9112a2a6f638;Hi Bill, yes. Since fwdRule.qi will be deleted, other queue files - fwdRule.xxxx - are not pointed/linked. These queue files are unusable and can be deleted.

I also tested fixpack on normal rsyslog forwarder but rsyslog server was down situation.

Before fixpack applied, server_2 directory has fwdRule.qi and fwdRule.000xxx files. Then, after fixpack applied, only fwdRule.qi file was deleted.

Remaining fwdRule.000xxx files were deleted next appliance reboot.","08/Jul/23 5:25 AM;5b17571b91981f4fdde632c1;* Fixpack updated
** [https://ibm.ent.box.com/folder/215883341702|https://ibm.ent.box.com/folder/215883341702|smart-link] 
*** Remove all fwdRule files
**** find /var/rsyslog.forwarder -type f -print 2>/dev/null | egrep '^/var/rsyslog\.forwarder/\[^/\]_/fwdRule\.(qi|[0-9][0-9]_)$' | xargs -n1 rm -f
*** Background process to sleep for 10 seconds before rebooting system
**** nohup bash -c ' date && sleep 10 && date && mesa_control reboot ' &",10/Jul/23 4:10 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] I cannot find fixpack file in the box folder [https://ibm.ent.box.com/folder/215883341702|https://ibm.ent.box.com/folder/215883341702|smart-link]. These seems to be internal files in a fixpack. Could you please let me know a link for fixpack file?,"11/Jul/23 7:26 AM;5b17571b91981f4fdde632c1;* Box
** [https://ibm.ent.box.com/folder/215883341702|https://ibm.ent.box.com/folder/215883341702|smart-link] 
*** Works for me
**** Verified you are authorized
** Version Independent / Remove_ALL_rsyslog_forwarder_fwdRule / Remove_ALL_rsyslog_forwarder_fwdRule.fixpack
*** Verified you are authorized
** Moved the internal fixes from fixpack to subdirectory
*** Some people find this helpful
** Should make the fixpack more visible
* If you have any problems slack me ","11/Jul/23 11:42 AM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b17571b91981f4fdde632c1] thank you for building fixpack.

Unfortunately, the result was negative. The System Error message was shown again after fixpack installation.

I attached log files. (Remove_ALL_rsyslog_forwarder_fwdRule_logs.tar.gz)

There are two set of log files. Under the 1st directory, I installed this fixpack only, The 2nd directory, I installed 10.0.5.IF1 first then installed this fixpack. Both results are same.

Following is the last part of Remove_ALL_rsyslog_forwarder_fwdRule.log 

{noformat}+ pkill -HUP -f rsyslog_forwarder
+ sleep 3
+ pkill -TERM -f rsyslog_forwarder
+ sleep 3
+ pkill -KILL -f rsyslog_forwarder
+ find /var/rsyslog.forwarder -type f -print
+ xargs -n1 rm -f
+ egrep '^/var/rsyslog\.forwarder/[^/]*/fwdRule\.(qi|[0-9][0-9]*)$'
+ exit 0
+ nohup bash -c+ STATUS=0
+ '[' 0 -ne 0 ]
+ rm -rf /var/fixpacks/fixpack-9
 ' date && sleep 10 && date && mesa_control reboot '
+ '[' -d /var/fixpacks/fixpack-8 ]
+ '[' -d /var/fixpacks/fixpack-7 ]
+ '[' -d /var/fixpacks/fixpack-6 ]
+ '[' -d /var/fixpacks/fixpack-5 ]
+ '[' -d /var/fixpacks/fixpack-4 ]
+ '[' -d /var/fixpacks/fixpack-3 ]
+ '[' -d /var/fixpacks/fixpack-2 ]{noformat}

Best regards,
Kenji",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
PIP not created post successful installation  of v3.1.2 extension,ISAMSUP-4918,289974,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,24/Mar/23 3:03 PM,12/Jul/23 2:03 PM,14/Jul/23 11:50 AM,,,Support,,0,,,,"PIP hasn't been created post successful installation 

I had webex with customer, we followed below steps as suggested in ISAMSUP-4239

Deleted existing information points of 3.0.1 version from <https://<LMI>/mga/pip>
Deleted extensions  <https://<LMI>/extensions>
Restarted LMI, Restarted Runtime
Cleared browser cache before accessing LMI and uploading extension
Installed extension 3.1.2 at  <https://<LMI>/extensions>
Could not see information point in <https://<LMI>/mga/pip>
Expected 3.1.2 extension information

/var/log/messages

Mar 21 17:14:41 mesa_config[3131]: Extension trusteerPIPv3.1.2: install successful

extension_install.log

Trusteer PIP Extension: START INSTALL
Trusteer PIP Extension: LMI User admin@local
Trusteer PIP Extension: Directory /var/extensions/
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:recommendation already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:reason_id already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:risk_score already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:is_bot already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:bot_id already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:bot_label already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:recommendation already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:reason_id already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:risk_score already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:is_bot already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:bot_id already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:bot_label already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:payee:recommendation:recommendation already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:transaction:recommendation:recommendation already exists.
Trusteer PIP Extension: Attribute with ID urn:ibm:security:trusteer:pinpoint:cd:newaccount:recommendation:recommendation already exists.
Trusteer PIP Extension: Trusteer PIP v3.1.2 created.
Trusteer PIP Extension: JavaScript import successful
Trusteer PIP Extension: Creating File Downloads directory.
Trusteer PIP Extension: INSTALL END

/var/extensions/trusteerPIPv3.1.2:
drwxr-xr-x    2 www-data www-data      4096 Mar 21 17:14 .
drwxr-xr-x    3 www-data www-data      4096 Mar 21 17:14 ..
-rw-r--r--    1 root     root           480 Apr 12  2022 [http://extension.info|http://extension.info|smart-link] 
-rw-r--r--    1 root     root           726 Apr 12  2022 GUIJSON
-rwxr--r--    1 root     root         11455 Apr 12  2022 [install.sh|http://install.sh]
-rw-r--r--    1 root     root         71163 Apr 12  2022 TrusteerPinpointPIP.js
-rw-r--r--    1 root     root          6442 Apr 12  2022 TrusteerPinpointPIP-Samples.zip
-rw-rw----    1 www-data www-data     25051 Mar 21 17:14 trusteerPIP-3.1.2_v10040_and_older.ext
-rw-rw----    1 www-data www-data        67 Mar 21 17:14 trusteerPIPv3.1.2.config
-rw-r--r--    1 root     root          7555 Apr 12  2022 [uninstall.sh|http://uninstall.sh]

I could not find any error or problem in support file still there was no PIP created under <[https://<LMI>/mga/pip>|https://<LMI>/mga/pip>]


I have followed same steps in my local environment. uninstalled 3.0.1 and installed 3.1.2 extension without any problem.

Support file path

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-03-22%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-03-22%2F]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,28/Apr/23 12:57 PM;nilesh_amrutkar;image (10).png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198438,11/Apr/23 9:22 PM;ashashiv;image-20230411-112204.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/195481,11/Apr/23 11:12 PM;ashashiv;image-20230411-131234.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/195497,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012286004,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,,,,PT.TELEKOMUNIKASI SELULAR SWG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19uzz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-03-27 02:13:42.828,,,,,"27/Mar/23 12:13 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

Since the config DB is external do they see any entries in rba_pip tables? 


{noformat} public | rba_pip_instance_asm           
 public | rba_pip_instance_properties    
 public | rba_pip_instances              
 public | rba_pip_types {noformat}

Was the pip attributes used in any policy? If yes are they populated and effective when triggered? 

If you use REST API to list the PIP’s does it list this new PIP?

Have you tried installing any other PIP and does it show up?

Is there any error in Browser Dev tools ? ","11/Apr/23 7:11 PM;5b1757156d76184b7d98a0c3;Customer’s reply on checking tables

* In ISAM's *config DB* in our deployment we have following rba_pip tables - RBA_PIP_INSTANCE_ASM, RBA_PIP_INSTANCE_PROPERTIES, RBA_PIP_INSTANCES, RBA_PIP_TYPES, in which only *RBA_PIP_TYPES* table has entry with it. See screenshots *""rba_pip_table entries"", and ""rba_pip tables""*.
* Apart from 4 tables in the config DB that we already checked , we also checked the *USER_ATTRIBUTES* table in the *runtime DB*. We did not find any attribute related to Trusteer Pinpoint in it.
* Some of the PIP attributes are used in some policies under *AAC -> Access control* - see *""Trusteer pip policies and attributes - ss""* & *""file Trusteer pip policies and attributes used.xlsx""*.
* We have called the PIP Api - *https:// <hostname>/iam/access/v8/pips* but it is returning us an empty list. See screen shot *""PIP Api response"".*

kindly please find attached file with the name *evidence trusteer (configdb, policy, PIP API)* to see the screenshot mentioned.


[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-04-03%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-04-03%2F]

I have shared js file from my lab machine and asked to import it customer’s environment. Customer could successfully import it however he doesn't know how to validate.
can you check tables data and see if it has required data?","11/Apr/23 9:22 PM;5af4ad7d4dd24c579110120b;[~accountid:5b1757156d76184b7d98a0c3] 

I don't see these tables listed in the screenshots pdf - 

{noformat}select * from RBA_PIP_INSTANCES;
 pip_id |  pip_type  |    instance_name    |       instance_description        | is_predefined 
--------+------------+---------------------+-----------------------------------+---------------
    101 | JavaScript | Trusteer PIP v3.1.2 | Trusteer PIP v3.1.2 20220309-1032 | N{noformat}



{noformat}select * from RBA_PIP_TYPES;
 pip_type_id |            pip_type            |            pip_name            |                       pip_description                        |                pip_impl_id                | pip_impl_type | pip_impl_version | is_enabled | is_predefined | allow_multiple_instances | supports_selector 
-------------+--------------------------------+--------------------------------+--------------------------------------------------------------+-------------------------------------------+---------------+------------------+------------+---------------+--------------------------+-------------------
           0 | RESTful Web Service            | RESTful Web Service            | RBALabels.RESTfulWebServicePolicyInformationPointDescription | com.tivoli.am.rba.pip.RestPIP             | custom        |                  | Y          | Y             | Y                        | Y
           1 | JavaScript                     | JavaScript                     | RBALabels.JavaScriptPolicyInformationPointDescription        | com.tivoli.am.rba.pip.JavaScriptPIP       | custom        |                  | Y          | Y             | Y                        | N
           2 | Database                       | Database                       | RBALabels.DatabasePolicyInformationPointDescription          | com.tivoli.am.rba.pip.JdbcPIP             | custom        |                  | Y          | Y             | Y                        | Y
           3 | LDAP                           | LDAP                           | RBALabels.LDAPPolicyInformationPointDescription              | com.tivoli.am.rba.pip.LdapPIP             | custom        |                  | Y          | Y             | Y                        | Y
           4 | FiberLink MaaS360              | FiberLink MaaS360              | RBALabels.FiberLinkMaaS360PolicyInformationPointDescription  | com.tivoli.am.rba.pip.FiberLinkMaaS360PIP | custom        |                  | Y          | Y             | Y                        | Y
           5 | QRadar User Behavior Analytics | QRadar User Behavior Analytics | RBALabels.QRadarUserBehaviorAnalyticsPIPDescription          | com.tivoli.am.rba.pip.QRadarUBAPIP        | custom        |                  | Y          | Y             | N                        | Y{noformat}



Im not sure if just importing javascript is enough - unless you are seeing these properties as well-

!image-20230411-112204.png|width=1287,height=790!

Also - when you download there are two versions of the extension -

The extension with the suffix ""v10050_and_newer.ext"" is for Verify Access v10.0.5.0 and newer. The extension with the suffix ""v10040_and_older.ext"" is for Verify Access v10.0.4.0 and older (as well as IBM Security Access Manager)

I hope the older version is the one that is installed and not the newer extension.

!image-20230411-131234.png|width=415,height=73!",18/Apr/23 4:23 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] Imported js file don't show properties.,"18/Apr/23 4:30 PM;5af4ad7d4dd24c579110120b;[~accountid:5b1757156d76184b7d98a0c3] 

How about the table entries as we discussed before ","18/Apr/23 9:10 PM;5b1757156d76184b7d98a0c3;All 4 tables are there, but only {{rba_pip_types}} table has entry. All other tables are empty.

{{rba_pip_instance_asm }}

{{rba_pip_instance_properties }}

{{rba_pip_instances}}","20/Apr/23 9:12 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

# Can we get LMI trace enabled for com.ibm.mesa and com.ibm.isam and get trace on of they have any access/file update issue
# Have we checked if REST API returns anything and if its just browser specific?
# Do we see any errors in browser console?
# Have they tried updating 3.1.1 ext same as the one they had before again and see if that shows up
# Is this specific to their one appliance or do they have mutliple appliances with same error

 You can get this information from customer or we can go on web ex with customer if they are ok.","28/Apr/23 12:57 PM;5b1757156d76184b7d98a0c3;!image (10).png|width=2882,height=1038!

It looks they are not able to run REST APIs. Checking more on rest api. We have support file available at this location. Attached browser screenshot for reference.

/ecurep/sf/TS012/286/TS012286004/2023-04-27/Support_file_result_curl.zip_unpack/isva_10.0.1.0_20230427-164033_ISAMPSRSBSDDAPP1.support_unpack/tmp/liberty_dump.zip_unpack/logs/","28/Apr/23 3:09 PM;5af4ad7d4dd24c579110120b;From web ex on 27th April - 
Waiting for status on REST POST
Waiting for results from different browser

And if possible a different env.","28/Apr/23 3:42 PM;5af4ad7d4dd24c579110120b;<notes>
Reviewing logs -


{noformat}TS012286004/2023-04-27/Support_file_result_curl.zip_unpack/isva_10.0.1.0_20230427-164033_ISAMPSRSBSDDAPP1.support_unpack/tmp/liberty_dump.zip_unpack/logs/ffdc/exception_summary_21.08.25_18.24.00.0.log
    13      1    10/4/21 18:01:20:321 WIB    10/4/21 18:01:20:321 WIB com.ibm.db2.jcc.am.DisconnectNonTransientConnectionException com.ibm.ws.rsadapter.jdbc.v41.WSJdbc41Connection.commit 587
                                                                            - /opt/IBM/wlp/usr/servers/default/logs/ffdc/ffdc_21.10.04_18.01.20.0.log
    14     47    10/4/21 18:01:57:543 WIB    1/19/22 12:01:22:177 WIB com.ibm.db2.jcc.am.DisconnectNonTransientConnectionException com.ibm.ws.rsadapter.impl.DB2JCCHelper 1298
                                                                            - /opt/IBM/wlp/usr/servers/default/logs/ffdc/ffdc_21.10.04_18.01.57.0.log
    15     47    10/4/21 18:01:57:545 WIB    1/19/22 12:01:22:177 WIB com.ibm.ws.rsadapter.exceptions.DataStoreAdapterException com.ibm.ejs.j2c.poolmanager.FreePool.createManagedConnectionWithMCWrapper 199
                                                                            - /opt/IBM/wlp/usr/servers/default/logs/ffdc/ffdc_21.10.04_18.01.57.1.log
    16     47    10/4/21 18:01:57:578 WIB    1/19/22 12:01:22:178 WIB javax.resource.spi.ResourceAllocationException com.ibm.ws.rsadapter.jdbc.WSJdbcDataSource.getConnection 299
                                                                            - /opt/IBM/wlp/usr/servers/default/logs/ffdc/ffdc_21.10.04_18.01.57.2.log
    17      5   11/23/21 20:02:30:306 WIB    12/2/21 13:49:05:592 WIB java.sql.SQLRecoverableException com.ibm.ws.rsadapter.jdbc.v41.WSJdbc41Connection.rollback 1860
                                                                            - /opt/IBM/wlp/usr/servers/default/logs/ffdc/ffdc_21.11.23_20.02.30.0.log
    18      1   11/29/21 15:54:50:690 WIB   11/29/21 15:54:50:690 WIB java.net.SocketTimeoutException org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor 281
                                                                            - /opt/IBM/wlp/usr/servers/default/logs/ffdc/ffdc_21.11.29_15.54.50.0.log
    19      1   11/29/21 15:54:50:838 WIB   11/29/21 15:54:50:838 WIB javax.xml.stream.XMLStreamException org.apache.cxf.jaxrs.interceptor.JAXRSDefaultFaultOutInterceptor 128
                                                                            - /opt/IBM/wlp/usr/servers/default/logs/ffdc/ffdc_21.11.29_15.54.50.1.log

TS012286004/2023-04-27/Support_file_result_curl.zip_unpack/isva_10.0.1.0_20230427-164033_ISAMPSRSBSDDAPP1.support_unpack/tmp/liberty_dump.zip_unpack/logs/ffdc/ffdc_21.09.29_14.15.41.0.log
                                                                            
                                                                            
                                                                            Exception = com.ibm.ws.LocalTransaction.RolledbackException
Source = com.ibm.ws.transaction.services.WebAppTransactionCollaboratorImpl
probeid = 332
Stack Dump = com.ibm.ws.LocalTransaction.RolledbackException: Resources rolled back due to unresolved action of rollback.{noformat}

TODO - 

Reboot appliance if they haven't already done

Here is a fixpack to try -

[https://ibm.ent.box.com/folder/142304167239|https://ibm.ent.box.com/folder/142304167239|smart-link]  ","02/May/23 9:38 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

Here is a fixpack related to liberty - can you check if that makes any difference -

[https://ibm.ent.box.com/folder/142304167239|https://ibm.ent.box.com/folder/142304167239|smart-link]

Have they rebooted ? if not can they reboot and try installing the extension

How did they go with -

REST POST?
Different browser?","08/May/23 3:35 PM;5b1757156d76184b7d98a0c3;Fixpack didn't help

installation steps captured in [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-05-05%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-05-05%2F]
Another browser also didn't help

API doc

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-05-02%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-05-02%2F]","09/May/23 12:52 PM;5af4ad7d4dd24c579110120b;<Notes>
To try- 

# Delete the extension from extension screen
# Delete these attributes from AAC-->Attributes if they exist 

{noformat} attribute Pinpoint Detect Web Login Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:recommendation.
 attribute Pinpoint Detect Web Login Reason ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:reason_id.
 attribute Pinpoint Detect Web Login Risk Score of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:risk_score.
 attribute Pinpoint Detect Web Login Bot Detected of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:is_bot.
 attribute Pinpoint Detect Web Login Bot ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:bot_id.
 attribute Pinpoint Detect Web Login Bot Label of type String with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:bot_label.
 attribute Pinpoint Detect Web In-Session Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:recommendation.
 attribute Pinpoint Detect Web In-Session Reason ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:reason_id.
 attribute Pinpoint Detect Web In-Session Risk Score of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:risk_score.
 attribute Pinpoint Detect Web In-Session Bot Detected of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:is_bot.
 attribute Pinpoint Detect Web In-Session Bot ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:bot_id.
 attribute Pinpoint Detect Web In-Session Bot Label of type String with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:bot_label.
 attribute Pinpoint Detect Web Add Payee Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:payee:recommendation:recommendation.
 attribute Pinpoint Detect Web Transaction Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:transaction:recommendation:recommendation.
 attribute Pinpoint Detect Web New Account Recommentation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:newaccount:recommendation:recommendation.{noformat}

3. Enable debug.level to 2 

after install check of this is in messages.log

Debug: Executing command: 'lmi' 'sso' 'generate'

4. Check if there are any DB access issues at that point.. 

Check option to rebuild extension with additional trace lines","10/May/23 10:09 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

Could you check that the DB access works from the appliance in their environment , i.e. if they create a pip manually does it show up in the database rba pip entry?

Manually delete all the existing attributes listed below


{noformat}attribute Pinpoint Detect Web Login Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:recommendation.
 attribute Pinpoint Detect Web Login Reason ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:reason_id.
 attribute Pinpoint Detect Web Login Risk Score of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:risk_score.
 attribute Pinpoint Detect Web Login Bot Detected of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:is_bot.
 attribute Pinpoint Detect Web Login Bot ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:bot_id.
 attribute Pinpoint Detect Web Login Bot Label of type String with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:bot_label.
 attribute Pinpoint Detect Web In-Session Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:recommendation.
 attribute Pinpoint Detect Web In-Session Reason ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:reason_id.
 attribute Pinpoint Detect Web In-Session Risk Score of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:risk_score.
 attribute Pinpoint Detect Web In-Session Bot Detected of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:is_bot.
 attribute Pinpoint Detect Web In-Session Bot ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:bot_id.
 attribute Pinpoint Detect Web In-Session Bot Label of type String with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:bot_label.
 attribute Pinpoint Detect Web Add Payee Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:payee:recommendation:recommendation.
 attribute Pinpoint Detect Web Transaction Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:transaction:recommendation:recommendation.
 attribute Pinpoint Detect Web New Account Recommentation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:newaccount:recommendation:recommendation.{noformat}

Run the extension install with debug.level=2

Install the debug version of the extension from this link -

[https://ibm.box.com/s/ekn56cz27unq4nre5xoqlq4wxo226dzp|https://ibm.box.com/s/ekn56cz27unq4nre5xoqlq4wxo226dzp|smart-link] 

Get the extension install log.","22/May/23 3:06 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] customer has installed debug version and shared support file
/ecurep/sf/TS012/286/TS012286004/2023-05-19/isva_10.0.1.0_20230519-134623_ISAMPSRSBSDDAPP2.support_unpack/var/log/extension_install.log

Also shared pdf file of steps they followed including manual creation of pip

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-05-22%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-05-22%2F]","23/May/23 10:29 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

I have reviewed the logs and the extension installs fine.

We have 2 options here - 

# Delete any attribute/policy that uses this existing PIP and reinstall to see if that makes a difference
I could see reference to 2 policies but not sure if they use the PIP installed or not so we should validate their attributes and policies.

Deleting/removing these two policies and then delete and reinstall the extension - 

Trusteer-Pinpoint-Login-Policy 

Trusteer-Pinpoint-Launchpad-Login-Policy

since installation looks fine.. its only with the javascript - 

Caused by: com.tivoli.am.rba.exception.RBAValidationException: FBTRBA0132E The action failed because the attribute is used in one or more policies. The policies are [Trusteer-Pinpoint-Login-Policy, Trusteer-Pinpoint-Launchpad-Login-Policy].

2. Create a new javascript PIP with the same name, properties and their values and change any references to using the old pip/new pip in the attributes. 

3. Also on another note - haven't still heard if they create a javascript pip manually can they see that instance in the DB? 



This is from my tests - 

If a PIP is used in an attribute and that attribute was used in a policy - though an extension was deleted it doesn't delete the PIP instance. So in their environment are they using that PIP in any attributes / policies? ","27/Jun/23 3:07 PM;5b1757156d76184b7d98a0c3;Hi [~accountid:5af4ad7d4dd24c579110120b] customer has deleted policies and tried installation again. But no luck. Installation logs shows successfully as earlier. I could not see policy related exception this time still PIP not created.

Manual creation of PIP can be seen here
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-05-22%2F&filepath=TS012286004%2F2023-05-22%2Fcheck_trusteer_19_May.pdf|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-05-22%2F&filepath=TS012286004%2F2023-05-22%2Fcheck_trusteer_19_May.pdf]","27/Jun/23 4:17 PM;5af4ad7d4dd24c579110120b;[~accountid:5b1757156d76184b7d98a0c3] 

Last time we asked if they could try installing a different browser in that environment 
And
If they could run this via curl RAPI 

Do we know if they tried these two options? 
If they have the required pieces in the env like the other browser, curl etc installed we can go on web ex.","27/Jun/23 5:07 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] Yes, they already tried I remember. Let me ask for webex. Any time suggestion for tomorrow?","28/Jun/23 8:35 PM;5b1757156d76184b7d98a0c3;We got the support file and browser screenshot at [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-06-28%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-06-28%2F]

Support is file is wrong. Updating case to upload latest support file.",28/Jun/23 10:41 PM;5b1757156d76184b7d98a0c3;uploaded new one.,"03/Jul/23 7:13 AM;5af4ad7d4dd24c579110120b;<Notes>

File:TS012286004/2023-06-28/isva_10.0.1.0_20230628-134415_ISAMPSRSBSDDAPP2.support_unpack/var/application.logs/management_ui/trace.log 


{noformat}javax.servlet.ServletException: java.io.IOException: Broken pipe
	at com.ibm.ws.webcontainer.servlet.FileServletWrapper.service(FileServletWrapper.java:720)
	at com.ibm.ws.webcontainer.servlet.FileServletWrapper.handleRequest(FileServletWrapper.java:515)
	at com.ibm.ws.webcontainer.servlet.FileServletWrapper.handleRequest(FileServletWrapper.java:265)
	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.invokeTarget(WebAppFilterChain.java:182)
	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:93)
	at com.ibm.isam.core.security_filter.SecurityFilter.doFilter(SecurityFilter.java:235)
	at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:201)
	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:90)
	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:1001)
	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1139)
	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1010)
	at com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.dispatch(WebAppRequestDispatcher.java:1410)
	at com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.forward(WebAppRequestDispatcher.java:171)
	at com.ibm.isam.wga.fwd.WgaRedirect.service(WgaRedirect.java:157)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:791)
	at com
Caused by: java.io.IOException: Broken pipe
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:59)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:105)
	at sun.nio.ch.IOUtil.write(IOUtil.java:63)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:485){noformat}

TODO:



Get trace from [com.ibm.ws|http://com.ibm.ws].*=ALL from LMI trace-


Set these advanced tuning parameters - and check - 
net.ipv4.tcp_keepalive_time = 6
net.ipv4.tcp_keepalive_intvl = 1
net.ipv4.tcp_keepalive_probes = 10
net.ipv4.tcp_retries1 = 4
net.ipv4.tcp_retries2 = 4","05/Jul/23 10:01 AM;5af4ad7d4dd24c579110120b;Hi Nilesh

As discussed on slack can we please get this trace - 

from [com.ibm.ws|http://com.ibm.ws].*=ALL from LMI trace-



Set these advanced tuning parameters - and check - 
net.ipv4.tcp_keepalive_time = 6
net.ipv4.tcp_keepalive_intvl = 1
net.ipv4.tcp_keepalive_probes = 10
net.ipv4.tcp_retries1 = 4
net.ipv4.tcp_retries2 = 4","05/Jul/23 9:32 PM;5b1757156d76184b7d98a0c3;No luck even after adding ATPs. Could not see broken pipe error though. 

New support file

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-07-05%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012286004&path=TS012286004%2F2023-07-05%2F]","12/Jul/23 2:03 PM;5af4ad7d4dd24c579110120b;[~accountid:5b1757156d76184b7d98a0c3] 

I see this error in - 
TS012286004/2023-07-05/isva_10.0.1.0_20230705-152744_ISAMPSRSBSDDAPP1.support_unpack/tmp/liberty_dump.zip_unpack/logs/messages.log

{noformat}[7/4/23 16:54:25:959 WIB] 0000002f com.ibm.ws.webcontainer.servlet                              I SRVE0242I: [isam] [/isam] [AdvancedConfiguration]: Initialization successful.
[7/4/23 16:54:25:960 WIB] 0000002f SystemOut                                                    O CSRF token for admin@local is invalid or missing.
[7/4/23 16:55:07:909 WIB] 000001cb com.ibm.ws.webcontainer.srt                                  E SRVE8055E: An unexpected exception occurred flushng out the rest of the response data.
[7/4/23 16:55:07:959 WIB] 000001cb com.ibm.ws.logging.internal.impl.IncidentImpl                I FFDC1015I: An FFDC Incident has been created: ""com.ibm.wsspi.genericbnf.exception.MessageSentException: Message already sent com.ibm.wsspi.http.ee7.HttpOutputStreamEE7 flushBuffers"" at ffdc_23.07.04_16.55.07.0.log
[7/4/23 16:55:07:961 WIB] 000001cb com.ibm.ws.webcontainer.srt {noformat}

So can we try - 
Set  under LMI-->Administrator Settings--> Exclude CSRF check to reg ex: {{.*}}

Add these advanced tuning config -

sysctl.net.ipv4.tcp_fin_timeout = 30
sysctl.net.ipv4.tcp_tw_reuse = 1
sysctl.net.ipv4.tcp_tw_recycle = 0
sysctl.net.ipv4.ip_local_port_range = 16384 61000
fs.file-max =3261180

Deploy 
Restart LMI if necessary and try installing he PIP, to see if it helps? ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA 10 - IP reputation Database Connection,ISAMSUP-4914,289767,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,23/Mar/23 7:14 PM,09/May/23 9:51 PM,14/Jul/23 2:47 PM,09/May/23 9:51 PM,,,,0,,,,"Customer activated IP reputation DB auto updates but the appliance it's not able to obtain updates (no proxy used in our configuration). According to the documentation [https://www.ibm.com/docs/en/sva/10.0.4?topic=reputation-managing-ip-database|https://www.ibm.com/docs/en/sva/10.0.4?topic=reputation-managing-ip-database|smart-link]  we added in the hosts file resolution for [license.cobion.com|https://license.cobion.com/] with ip address 194.153.113.16. (nslookup of [license.cobion.com|https://license.cobion.com/] gives many DNS resolutions but not the one indicated in the documentation, it's correct to use this resolution?) In the eventLog of the appliances we found the error: ""An attempt to download the primary update catalog has failed. Common causes of this failure are not having a license installed and DNS errors."" Which trace can show us more details? We cannot find any others details to solve.

In ISVA 10.0.5 a new update service which point to [updates.verify.ibm.com|http://updates.verify.ibm.com/], but this is one is for 10.0.5 (by the doc). What about for [license.cobion.com|http://license.cobion.com/], still valid ?

The '[license.cobion.com|http://license.cobion.com/]' is not valid. They are sunsetting that whole infrastructure. You should upgrade to 10.0.5.0 for the renewed functionality.

Is it possible to create this functionality in 10.0.4.0 L3 please let us know.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012332928,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,BPIFRANCE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19tq7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-03 01:29:01.557,,,,,03/Apr/23 11:29 AM;5b232b2fd85e5b59b066f57f;[~accountid:617a5f2cf485cd0068cb98af] IP reputation DB auto updates are no longer supported as the update servers are no longer being maintained. ,09/May/23 9:51 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
LMI Management Authorization with client certificates,ISAMSUP-4883,287828,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,16/Mar/23 3:19 AM,17/Mar/23 1:01 PM,14/Jul/23 2:47 PM,17/Mar/23 1:01 PM,,Support,,0,,,,"The customer running 10.0.4 is trying to get management authorization to work with client certificates, but they keep getting Access Denied as soon as they enable the management authorization.


The customer is using uid as the user identifier.

I found the following Jira by [~accountid:5b15d9517dab4c51f61b5190] and it sounded like an exact match, but I’m not sure that’s all there is to it anymore.

This apar is supposed to be fixed in 10.0.5 so I started setting this up in my 10.0.5 test env, and I’m also seeing the same error.   At this point I can’t say for sure it’s the same issue as the customer or not.    

In my env I setup the client certificates, and they are working.   I’m just using a basic mapping rule that has



{noformat}function mapUser(props) {
  var user = ""cn=daniel,dc=example,dc=org""
  return user;
}{noformat}


This certificate and user work fine without the management authorization.    Now when I enable the management authorization, I get the Access Denied error.   

So seeing this I decided to change gears, and setup tried on 10.0.4 IF1 and get the same error.    Then I installed the fixpack from Peter’s jira, and tried again and I still get the same error.

In the LMI trace I’m seeing 



{noformat}[3/15/23, 13:00:29:116 EDT] 00000035 id=00000000 AuthorizationStage                                           1 doStage URL        : https://127.0.0.1:9443/core/login
[3/15/23, 13:00:29:130 EDT] 00000035 id=00000000                                                              1  GET https://127.0.0.1:9443/core/login (014 msecs 322 usecs)
[3/15/23, 13:00:55:353 EDT] 00000062 id=00000000 com.ibm.mesa.security.authentication.modules.TrialTAI        > isTargetInterceptor(req) ENTRY
[3/15/23, 13:00:55:353 EDT] 00000062 id=00000000 com.ibm.mesa.security.authentication.modules.TrialTAI        1 Appliance is not currently disabled!
[3/15/23, 13:00:55:353 EDT] 00000062 id=00000000 com.ibm.mesa.security.authentication.modules.TrialTAI        < isTargetInterceptor(req) RETURN
[3/15/23, 13:00:55:360 EDT] 00000062 id=00000000 com.ibm.mesa.security.authentication.modules.WebServicesTAI  1 Certificate username : 1.2.840.113549.1.9.1=#160f676172794075732e69626d2e636f6d,CN=gary,ST=TX,C=US
[3/15/23, 13:00:55:366 EDT] 00000062 id=00000000 com.ibm.mesa.common.MesaCommand                              1 Using user : 1.2.840.113549.1.9.1=#160f676172794075732e69626d2e636f6d,CN=gary,ST=TX,C=US
[3/15/23, 13:00:55:480 EDT] 00000062 id=00000000 com.ibm.mesa.common.MesaCommand                              1 Using user : 1.2.840.113549.1.9.1=#160f676172794075732e69626d2e636f6d,CN=gary,ST=TX,C=US
[3/15/23, 13:00:55:574 EDT] 00000062 id=00000000 AuthorizationStage                                           1 doStage Authorization failed
[3/15/23, 13:00:55:574 EDT] 00000062 id=00000000 AuthorizationStage                                           1 doStage User does not exist
[3/15/23, 13:00:55:575 EDT] 00000062 id=00000000 AuthorizationStage                                           1 doStage URL        : https://fyre:22010/core/dashboard
[3/15/23, 13:00:55:575 EDT] 00000062 id=00000000 AuthorizationStage                                           1 doStage User       : 1.2.840.113549.1.9.1=#160f676172794075732e69626d2e636f6d,CN=gary,ST=TX,C=US
[3/15/23, 13:00:55:577 EDT] 00000062 id=00000000                                                              1  pipeline stage failed, abort request
[3/15/23, 13:00:55:578 EDT] 00000062 id=00000000                                                              1  pipeline failed, abort request

{noformat}


So to me it looks like the mapping fails when the management authorization is enabled.



Am I missing something or is this just broken?



Thanks!",,gvacek,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,5c87cb8d88f9ec6ae0afb306,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012431720,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,,,,US Dept of Homeland Security,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19h7j:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-15 23:21:38.555,,,,,"16/Mar/23 3:48 AM;5b15d9a0dda5f94d06b985b3;If we think the fixpack mentioned will help the customer, they are definitely willing to give it a try if we can build it for 10.0.4  (they don’t have IF1 yet).

Thanks","16/Mar/23 9:21 AM;5b15d9517dab4c51f61b5190;You didn’t mention the Jira item you found - only that you found one by me

There were 2 Jira items resulting in 2 fixpacks for 10.0.4.0

These are the fixpack items (they have links to the original problems)

They will need 10.0.4.0 IF1 rather than the IJ41289 fixpack as the second fix requires it

This was the original fixpack [https://cloudidentity.atlassian.net/browse/ISAMSUP-4347|https://cloudidentity.atlassian.net/browse/ISAMSUP-4347|smart-link]

This went into 10.0.4.0 IF1

the second one is the authorization issue. It is specific to when user identifier attribute is not cn, eg uid

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4512|https://cloudidentity.atlassian.net/browse/ISAMSUP-4512|smart-link] has the management authorization fix

This fixpack requires IF1

There was an additional issue found that got included in the IJ43499 fix See [https://cloudidentity.atlassian.net/browse/ISAMSUP-4507|https://cloudidentity.atlassian.net/browse/ISAMSUP-4507|smart-link]  

So Customer needs to apply  10.0.4.0 IF1 and IJ43499 fixpack

I will setup on 10.0.5.0 to check","16/Mar/23 11:13 AM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9a0dda5f94d06b985b3] 

My 10.0.4.0 environment works

I setup an identical environment on 10.0.5.0 and see the same error as you

It was caused by a configuration error. 

I needed to set the Administrator Setting Validate Client Certificate Identity to true

See [https://www.ibm.com/support/pages/ibm-security-access-manager-appliance-local-management-interface-certification-authentication-and-authorization|https://www.ibm.com/support/pages/ibm-security-access-manager-appliance-local-management-interface-certification-authentication-and-authorization|smart-link] for explanation","16/Mar/23 10:42 PM;5b15d9a0dda5f94d06b985b3;Thanks @Peter!   Sorry about forgetting to paste the link i was referencing, it was the 2nd one you mentioned.

So the setting you suggested was the key, I didn’t really have that set or really understand what it did.  I’m still a bit confused by that even after reading that technote you referenced a few times.  

What exactly does this mean?
”With ""Validate Client Certificate Identity: False"" and LMI Management Authz enabled it is a blind trust but Roles apply.”

I noticed that when with this setting disabled, in the LMI console when logged in I see the DN of the certificate while if I enable the setting I see the ldap DN.
So is this setting basically just an on/off switch for that mapping rule?   In other words, if I had the ldap entry that matches the DN of the cert exactly then it would apply the management authorization rules based on that DN/user ?



In other words I’m confused by what “it is a blind trust but Roles apply” actually means.    



For my customer, they are asking if we can get the fixpack built for them on 10.0.4 (they don’t have IF1 yet).   Is this feasible or it it too involved to backport?



Thanks!","17/Mar/23 3:29 AM;5b15d9a0dda5f94d06b985b3;[~accountid:5b15d9517dab4c51f61b5190] Ok don’t worry about the fixpack, the customer has decided they can wait till they finish their upgrade to 10.0.5, so that’s good news.

If you can just respond to my question below about that “Validate Client Certificate Identity” we’ll be all good, just so that I’m clear on what to expect with this setting and how it works.    Thx again for the quick response.","17/Mar/23 8:37 AM;5b15d9517dab4c51f61b5190;What exactly does this mean?
”With ""Validate Client Certificate Identity: False"" and LMI Management Authz enabled it is a blind trust but Roles apply.”

It means it trusts the certificate (for authentication purposes) but for Authorization it works out what roles you have by looking up the roles using the DN from the certificate (which is where it was failing for you)

So these statements are correct 

{noformat}I noticed that when with this setting disabled, in the LMI console when logged in I see the DN of the certificate while if I enable the setting I see the ldap DN.
So is this setting basically just an on/off switch for that mapping rule?   In other words, if I had the ldap entry that matches the DN of the cert exactly then it would apply the management authorization rules based on that DN/user {noformat}

FYI

Yesterday I set up 10.0.5.0 like you and hit the same Access Denied issue. I had forgotten the validate client certificates setting and asked you to create an APAR. But when I looked at the code I saw the setting and had to change my response to “its a configuration issue”","17/Mar/23 1:01 PM;5b15d9a0dda5f94d06b985b3;Thanks Peter.   So based on our clack discussion, basically the “Validate Client Certificate Identity” setting just tells ISVA whether or not to use the certificate mapping rule or not when trying to find the DN of the user in ldap.    Thanks!   Closing this off.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
OrgazationURL not included in IDP Metadata export,ISAMSUP-4882,287814,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,16/Mar/23 1:25 AM,10/May/23 9:47 PM,14/Jul/23 2:47 PM,10/May/23 9:47 PM,,Support,,0,,,,"Cust is on 10.0.3 but I don’t think this has been changed even on 10.0.5.

This Jira is basically a revisit of [https://cloudidentity.atlassian.net/browse/ISAMSUP-312|https://cloudidentity.atlassian.net/browse/ISAMSUP-312]

The issue is that in the SAML 1.0 IDP medatada file we produce, we are providing an Organization element which contains an <OrganizationURL> which is empty..

<md:Organization>
<md:OrganizationName xml:lang=""en"">CIBC</md:OrganizationName>
<md:OrganizationDisplayName xml:lang=""en"">CIBC</md:OrganizationDisplayName>
<md:OrganizationURL xml:lang=""en""/>
</md:Organization>
</md:EntityDescriptor>

The specifications for this 
[https://www.oasis-open.org/committees/download.php/56786/sstc-saml-metadata-errata-2.0-wd-05-diff.pdf|https://www.oasis-open.org/committees/download.php/56786/sstc-saml-metadata-errata-2.0-wd-05-diff.pdf]

section 2.3.2.1 says that while <Organization> is optional, if it’s included then <OrganizationURL> must contain one or more entries, which means we are not following the spec, which is causing problems with some partners.

Even ISV seems to have had to implement a fix for this on their end
[https://cloudidentity.atlassian.net/browse/ISVCASE-1907|https://cloudidentity.atlassian.net/browse/ISVCASE-1907]

The previous Jira was closed as an RFE, but I don’t think this has been implemented yet that I can see.   And really this should not be an RFE, we need to conform to the specifications and to me the specifications seem clear

<OrganizationURL> [One or More]
One or more language-qualified URIs that specify a location to which to direct a user for
additional information. Note that the language qualifier refers to the content of the material at the
specified location

Let me know if you want me to open an apar.

Thanks
",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,30/Mar/23 2:58 AM;dcomeau;image-20230329-165603.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193259,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012446527,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,,,,CGI Inc,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19h4n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-03-23 13:16:16.081,,,,,"23/Mar/23 10:26 PM;5b15d9a0dda5f94d06b985b3;Hi Asha,

Can I open an apar for this or is it still being investigated?    Thx","23/Mar/23 11:16 PM;5af4ad7d4dd24c579110120b;<Notes>

ContactInfo.java

ConfigurationParameters.java

SamlMetadataImpl_2_0.java 


{noformat}private void orgInfoToDescriptor(EntityDescriptor eDesc, ConfigurationParameters cfg) {

        uri.setValue(contactInfo.getCompanyURL());
        uri.setValue(""ASHA3333"");

    <md:Organization>
        <md:OrganizationName xml:lang=""en"">www.myidp.ibm.com</md:OrganizationName>
        <md:OrganizationDisplayName xml:lang=""en"">www.myidp.ibm.com</md:OrganizationDisplayName>
        <md:OrganizationURL xml:lang=""en"">ASHA3333</md:OrganizationURL>
    </md:Organization>
    
    [3/24/23, 14:54:11:965 AEST] 0000002d id=00000000 om.tivoli.am.fim.config.visitors.emf.FedsConfigurationReader 1 createOrganizationData The Organization Info. object is null.
    f.FedsConfigurationReader 1 createOrganizationData Created Organization Data: com.tivoli.am.fim.config.feds.OrganizationData@54a2a9d9{noformat}

com.tivoli.am.fim.infoservice_8.0.0.jar

com.tivoli.am.fim.metadata_8.0.0.jar

[https://cloudidentity.atlassian.net/browse/CI-109211|https://cloudidentity.atlassian.net/browse/CI-109211|smart-link]  ","23/Mar/23 11:16 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9a0dda5f94d06b985b3] 

Still being investigated ill update the item. ","29/Mar/23 7:30 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9a0dda5f94d06b985b3] 

Currently there is no option to update/configure these. 
- in order to help the customer get going would it be helpful if I just added a dummy url/display name in organisation url?

And this still might need work on adding configuration options/entries to REST and LMI and design which can be dealt as RFE? ","30/Mar/23 2:58 AM;5b15d9a0dda5f94d06b985b3;HI [~accountid:5af4ad7d4dd24c579110120b] Thanks for the response.   I don’t really think that your suggestion will really buy much, as a band said solution now they can edit the file manually.     The problem is that as it is now, we have a defect in the code in the LMI.    We require the Company Name to be set, which means that we are forcing the Organization element to be included (it is optional).     Technically in this case the Organization URL should also be mandatory, but that would likely cause problems with existing configurations.    So the best option is probably to expose it, but leave it optional like it used to be in the TFIM days

!image-20230329-165603.png|width=1263,height=859!

Discussing this with Annelise, she stated

“As far as I can tell the CompanyURL field is not exposed in LMI GUI but the internal configuration store and meta data importing supports `OrganizationURL` field.

In other words it appears the metadata will set if it exists in the data.”

So if her observations are correct it sounds like the code is already able to handle it, it’s just the LMI that would need to be updated to allow that to be set.

Hopefully this is all that’s required.


Let me know.   Thanks!","30/Mar/23 7:09 AM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9a0dda5f94d06b985b3] 

Currently we use CompanyName as the organisation name but the organisation URL is obtained from contact info.

{noformat}ConfigurationParameters.ContactInfo contactInfo = cfg.getContactInformation();
                contactInfo.setCompanyURL(url.getValue());{noformat}

And there is no contact Information configuration available in feds management, this needs to be changed to allow REST to take new config and update.
This will need REST and LMI changes since the organizationURL is not an exposed config.

Anyways leave it with me I'll discuss with the dev team.",10/Apr/23 9:58 PM;5b15d9a0dda5f94d06b985b3;Just checking in to see what was decided.   Thx,18/Apr/23 11:13 PM;5b232b2fd85e5b59b066f57f;@ashashiv - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"20/Apr/23 9:15 AM;5af4ad7d4dd24c579110120b;<Status>

Had a chat to David about the extent of the change in LMI, REST and the fed config.
Discussed with Dev  earlier - Since the fed screen already busy this contact info in the screen or adding url might not be a way to go.

In ISV if the contactURL/orgURL is empty they set it to tenant ID as a fall back.
",02/May/23 1:20 AM;5b15d9a0dda5f94d06b985b3;Just checking in to see what’s happening.   Thx,"02/May/23 1:29 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9a0dda5f94d06b985b3] 

This will need to be addressed as an RFE as the details about the contact info and organisation schema need to be reevaluated, fed screen UI schema and REST need to be updated.

So development has confirmed this to be an RFE, please get this lodged.

Thanks",02/May/23 9:48 PM;5b15d9a0dda5f94d06b985b3;Ok thanks for the response.   Will let the customer know.   ,"10/May/23 9:47 PM;5b15d9a0dda5f94d06b985b3;I gave the customer that info, and they have not responded back since.    Closing this off.   Thx!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
customer wants fixpack for v10.0.4 IF1 for APAR IJ40309,ISAMSUP-4872,287262,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,14/Mar/23 5:05 AM,23/Mar/23 12:18 PM,14/Jul/23 2:47 PM,23/Mar/23 12:18 PM,,Support,,0,,,,"Some SAML applications are reporting they are not getting <ds:keystore> in assertions. This is APAR IJ40309. They recently upgraded to v10.0.4.0 IF1 and need a new fixpack for IJ40309. Customer states they can not upgrade to v10.0.5 at this time. 

Customer states they have the following fixpacks installed:

10.0.4.0_IF1
Pop_Attachment_Check_Tuning_Param_10040",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4873,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012420296,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,State of Michigan,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19drj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-13 21:20:43.151,,,,,14/Mar/23 7:20 AM;5b15d94b6256d01ad54eb020;Assigned to Asha since she worked on the original APAR.,14/Mar/23 1:33 PM;5af4ad7d4dd24c579110120b;Fixpack for 10040IF1: [https://cloudidentity.atlassian.net/browse/ISAMSUP-4873|https://cloudidentity.atlassian.net/browse/ISAMSUP-4873|smart-link] ,16/Mar/23 1:06 AM;5b15d9e44c4ed14b83af8723;Thanks. I sent the files to the customer. I will wait for the customer’s response.,"23/Mar/23 12:17 PM;5af4ad7d4dd24c579110120b;case closed, hence closing jira.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Upgrade issue from 10.0.4.0_IF1 to 10.0.5.0,ISAMSUP-4871,287256,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,14/Mar/23 3:24 AM,20/Mar/23 8:06 PM,14/Jul/23 2:47 PM,20/Mar/23 8:06 PM,,Support,14/Mar/23 12:00 AM,0,,,,"Customer, Nordea Bank, has outlined the following on March 11th;

----

_Issues during upgrade of Firmware. Looks like there is an issue with the partitions. Can not make backup/active partitions. Tried to make backup in LMI also and got this :_ 
{{mount: mounting /dev/sda5 on /tmp/mount.9TmOM7 failed:}}
_I would like you to check the support file and see if there is any issue we can fix/do?_
_Thanks, this is production but we are running on 5 out of 6 webseals now._
_All other webseal had no problem during upgrage to 10.0.5._

----

L2 checked the support file and see in ""ls.txt"" that there is only 1 grub entry i.e.  
{{/boot:}}
{{total 20}}
{{drwxr-xr-x    6 root     root          1024 Mar 11 05:42 .}}
{{drwxr-xr-x   22 root     root          4096 Mar 11 05:41 ..}}
{{drwxr-xr-x    2 root     root          1024 Aug 20  2022 Part1}}
{{drwxr-xr-x    2 root     root          1024 Dec  1 01:38 Part2}}
{{drwx------    2 root     root          1024 Mar 11 05:42 grub2}}
{{drwx------    2 root     root         12288 Oct  9  2014 lost+found}}
L2 have provided the get_boot_info.fixpack to get further information. 
L2 have yet to receive the data.zip file re this fixpack from the customer.

Strange also that from var/log/messages, most recent / related errors seen are 
{{Fatal error: Firmware listing not found}}
But the ATP setting "" sys.direct.update.allowed = true "" is present in \etc\setttings.txt
Raising this Jira as a precautionary measure because as I will be OOO over next few days. Plus as its a production system seeking extra clarification from L3 on correct next steps i.e. obvious question being - do L2 provide the “fix_boot_links.fixpack” in this scenario?",,Bhavan Kasivajjula,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,5b15d954b0d76456f36daf33,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012409223,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,Nordea Bank,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,"AIX /ecurep/sf/TS012/409/TS012409223/2023-03-11/isva_10.0.4.0_20230311-121836_ap-ninaa-prod-webseal2p.support_unpack/

Citrix S:\sf\TS012\409\TS012409223\2023-03-11\isva_10.0.4.0_20230311-121836_ap-ninaa-prod-webseal2p.support_unpack\",,,,,,,,,Linux 86_64,,,,,,,,,,,,,,0|i19dq7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-13 21:08:37.506,,,,,"14/Mar/23 3:28 AM;6154906364ff01007106e189;FYI - additional late in the day March 13th update from customer i.e.

----

“ _we are restoring appliance from backup, we hope that it will fix an issue, if not we will continue with troubleshooting._ “","14/Mar/23 7:08 AM;5b15d954b0d76456f36daf33;If after restoring from backup, their {{/boot}} directory continues to show only {{grub2}}, yes they should apply the {{fix_boot_links}} fixpack before attempting upgrade.

As long as they are able to see the uploaded pkg file in the {{Available Updates}} screen in the LMI, we can ignore the {{Firmware listing not found}} message.","14/Mar/23 9:53 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d954b0d76456f36daf33] 

On Brian’s question Customer just replied:

----

# How did you go about the upgrade process on this appliance? Is it (a) manual or (b) automated. Please describe in detail if possible.
*Important points are*
a) we was trying to do firmware backup but it failed. It looks like appliance is taking backup (appliance is offlined), but when it comes back we can see that old firmware/partition is not overrisen ( nothing changed).
b) We are adding advanced tuning parameters
""update.disable.remote.discovery"" with value ""1"".
""sys.direct.update.allowed"" with value: true

c) we are uploading package (ISVA 10.0.5) to system available updates
d) we are clicking on install - appliance is showing message ""System Error - unknown error occured"" in red box after ~1 min
e) after action from d) no ""firmware""/""partition"" is visible in system firmware settings. When appliance is rebooted it is going into grub rescure mode. We was tyring to find grub.cfg using it but it was not possible.

2. Restoration process - is this from VMware level or from ISVA snapshot level?
It is restore using VMware level backup/snapshot.

3. Re ""We hope that it will fix an issue"" - can you describe what is the issue here?
It is described in 2.e)

----------------------

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012409223&path=TS012409223%2F2023-03-14%2F&filepath=TS012409223%2F2023-03-14%2Fdata.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012409223&path=TS012409223%2F2023-03-14%2F&filepath=TS012409223%2F2023-03-14%2Fdata.zip]","15/Mar/23 10:17 AM;5b15d954b0d76456f36daf33;[~accountid:627a7fb30d1e73006f7c21cf] have they tried applying the {{fix_boot_links}} fixpack (here : [https://cloudidentity.atlassian.net/browse/ISAMSUP-1183|https://cloudidentity.atlassian.net/browse/ISAMSUP-1183|smart-link] ) after restoring?

IBoth backup and upgrade write to the same inactive partition. So backup before upgrade is unnecessary.","15/Mar/23 6:27 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d954b0d76456f36daf33] I have shared the fixpack to the customer, waiting for their response.","16/Mar/23 2:04 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d954b0d76456f36daf33] 

Customer is asking  {{fix_boot_links}} fixpack we shared works with any version of ISVA?

They were able to restore appliance using different approach and reinstalled ISVA version 10.0.4 applied snapshot and updated appliance to 10.0.5.","16/Mar/23 11:24 AM;5b15d954b0d76456f36daf33;Yes that fixpack can be applied at any version prior to 10.0.5.0.

Do they still need it? From what you said it looks like they have upgraded to 10.0.5?","20/Mar/23 8:06 PM;6154906364ff01007106e189;Customer has closed TS012409223 i.e. 

----

_We was able to restore appliance using different approach. We reinstalled ISVA version 10.0.4 applied snapshot and updated appliance to 10.0.5._",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
WGA Cache is not functioning and directing every ISV API call to APISecurity's WSTrust endpoint,ISAMSUP-4864,287099,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Bill Tyler,5b15d94b6256d01ad54eb020,Bill Tyler,5b15d94b6256d01ad54eb020,11/Mar/23 5:51 AM,15/Mar/23 1:08 AM,14/Jul/23 2:47 PM,15/Mar/23 1:08 AM,,Support,,0,,,,"Problem : WGA Cache is not functioning and directing every ISV API call to APISecurity's WSTrust endpoint 

Steps to reproduce : Call APISecurity's runtime entitlements API using the same Bearer token multiple times you will see the cache is not getting used...And WGA is calling APISecurity's WSTrust endpoint on every API call.

Endpoint that is called multiple times - 

GET on [https://meena.ite1.idng.ibmcloudsecurity.com/apisecurity/v1.0/runtime/entitlements|https://meena.ite1.idng.ibmcloudsecurity.com/apisecurity/v1.0/runtime/entitlements]
Using the Bearer token
Authorization : 

APISecurity's which is getting called every time WSTrust endpoint - /TrustServerWS/SecurityTokenServiceWST13

Added the logs as needed.

* Expiration header is set in the WSTrust endpoint response in this format 

Example -> expires: 2023-03-06T22:50:11Z

Cache value set in the configuration which is 1000 currently 

This EAS implements a Least Recently Used cache, meaning the decision

associated with the least recently used bearer token will be forgotten when a

new bearer token decision is cached. A cache-size of 0 will disable caching of authorization decisions

cache-size = 1000

Expected outcome : Cache expiration time is currently a minute and APISecurity's WSTrust endpoint should not be called if the JWT is cached and is within the valid expiration time.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4866,,,,,,,,12/Mar/23 1:10 AM;btyler;pdweb.oauth (2).log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189581,12/Mar/23 1:10 AM;btyler;pdweb.oauth.log.2023-03-11-00-52-27.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189583,12/Mar/23 1:10 AM;btyler;pdweb.oauth.log.2023-03-11-00-55-14.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189582,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012403774,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nick Lloyd,5b15d9e6dda5f94d06b985b4,,,,IBM,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19csb:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,11/Mar/23 5:53 AM;5b15d94b6256d01ad54eb020;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f]  FYI  created this Jira for tracking purposes,"11/Mar/23 6:17 AM;5b15d94b6256d01ad54eb020;The decision to cache is based on a valid expiration and  if it’s authorized

Two attributes from the logs:

<stsuuser:Attribute name=""expires"" type=""urn:ibm:names:ITFIM:oauth:response:attribute"">[stsuuser:Value|stsuuser:Value]2023-03-10T16:01:49Z</stsuuser:Value></stsuuser:Attribute>

<stsuuser:Attribute name=""authorized"" type=""urn:ibm:names:ITFIM:oauth:response:decision"">[stsuuser:Value|stsuuser:Value]TRUE</stsuuser:Value></stsuuser:Attribute>



When we’re checking the expires  attribute we are checking for:    ""urn:ibm:names:ITFIM:oauth:response:decision""","11/Mar/23 6:49 AM;5b15d94b6256d01ad54eb020;Based on this I think our code is correct.

[https://www.ibm.com/docs/en/sva/10.0.5?topic=support-oauth-sts-interface-authorization-enforcement-points|https://www.ibm.com/docs/en/sva/10.0.5?topic=support-oauth-sts-interface-authorization-enforcement-points|smart-link] 

There  was a change made in 10.0.3.0 to check the type.  Before that we only set the expiration.",11/Mar/23 6:57 AM;5b15d94b6256d01ad54eb020;Current status is that client will make the change and test it.  ,"11/Mar/23 10:26 AM;5b15d94b6256d01ad54eb020;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] 

They report that they think there is still an issue with the cache.  However, they are still testing so  it’s not definite.  I haven’t seen any new logs yet to check if they have the attribute type set correctly.

Here’s the change they made:

[@Bill|https://ibm-security.slack.com/team/W4R5BE10F] Do you mean we need to send this now

{noformat}expiresToken.setAttribute(""type"", ""urn:ibm:names:ITFIM:oauth:response:decision"");{noformat}

 Instead of

{noformat}expiresToken.setAttribute(""type"", ""urn:ibm:names:ITFIM:oauth:response:attribute"");{noformat}



For internal L3 purpose:


in their pdweb.oauth.log  you can  see  ""will not cache""  along with the attributes mentioned before.  If the attribute is set correctly we should see: “will cache” . These messages come from  AMWOAuthModule.cpp","12/Mar/23 1:13 AM;5b15d94b6256d01ad54eb020;I attached the logs provided to me in slack.

We can now see  log entries such as  “from cache”   and “will cache”   No entries that say “will not cache” which we saw in the original logs.  The attribute has the correct type now.

<stsuuser:Attribute name=""expires"" type=""urn:ibm:names:ITFIM:oauth:response:decision"">[stsuuser:Value|stsuuser:Value]2023-03-11T00:53:46Z</stsuuser:Value></stsuuser:Attribute>","15/Mar/23 1:07 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9e6dda5f94d06b985b4] [~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] 

Jose just confirmed that after their latest tests  things are working.  I think that tick mark Nick noticed was the last issue.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Compatibility of IBM Security Verify Access 10.0.4 with FAPI standards,ISAMSUP-4861,286910,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,10/Mar/23 5:43 AM,07/Apr/23 9:04 PM,14/Jul/23 2:47 PM,07/Apr/23 9:04 PM,,,,0,,,,"The pre_token mapping rule we ship for FAPI conformance does not require nonce which the spec requires.

[https://www.ibm.com/docs/en/sva/10.0.1?topic=conformance-setting-up-oidc-definition-api|https://www.ibm.com/docs/en/sva/10.0.1?topic=conformance-setting-up-oidc-definition-api|smart-link] 

[https://www.ibm.com/docs/en/sva/10.0.4?topic=conformance-mapping-rules|https://www.ibm.com/docs/en/sva/10.0.4?topic=conformance-mapping-rules|smart-link] 

_To enable this, see to the OIDC Conformance-Example 1.4 in the oidc_op_conformance.zip file in the pre_token mapping rule. The mapping rule snippet retrieves the nonce during the code flow and during the token flow retrieves the nonce associated with the state_id and adds nonce as an id_token claim._

mapping rules available from appliance file downloads → federation → examples → oidc_op_conformance.zip

Snippet from the pretoken.js

{noformat}/**
 * OIDC Conformance-Example 1.4
 * During authroization_code flow a nonce is not required, this snippet of checks if it is requested for and
 * associated with the state_id . If it is an id_token claim is added.
**/
var nonce = null;
nonce = stsuu.getContextAttributes().getAttributeValueByName(""nonce"");
if (nonce != null){
        var attr = new com.tivoli.am.fim.trustserver.sts.uuser.Attribute(""nonce"", ""urn:ibm:jwt:claim"", nonce);
        stsuu.addAttribute(attr);
}
{noformat}

I’ve suggest the customer that reported this update the rule to send a OAuthMappingExtUtils.throwSTSCustomUserPageException() if nonce is not present but we should still be requiring nonce per the spec.",,Asha Shivalingaiah,cholt@us.ibm.com,Motiur Rahman,,,,,,,,,,,,,5af4ad7d4dd24c579110120b,5b15d994dda5f94d06b985b2,5b15d9e581c3df12acf53c4a,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012244805,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,,,,State of Michigan,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19bmz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-10 04:23:45.815,,,,,"10/Mar/23 10:57 AM;5b15d994dda5f94d06b985b2;This is an article I found that explains the differences in the nonce requirement for OIDC vs FAPI

[https://darutk.medium.com/financial-grade-api-fapi-explained-by-an-implementer-d09fcf2ff932|https://darutk.medium.com/financial-grade-api-fapi-explained-by-an-implementer-d09fcf2ff932|smart-link] ","10/Mar/23 2:23 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d994dda5f94d06b985b2] 

Do you have a recreate of this non compliance? ",10/Mar/23 10:00 PM;5b15d994dda5f94d06b985b2;No but the code snippet in the description shows that it’s not required where the FAPI standard says it should be. ,"12/Mar/23 6:03 PM;5af4ad7d4dd24c579110120b;Yes I spoke to Dev looks like we are FAPI compliant so will need an environment to see the behaviour.

So - will need to validate which behaviour are we focusing on - as in what is the issue.
       for generic OIDC nonce is optional, but not for FAPI. 
         nonce not necessary or nonce necessary since product is FAPI compliant - ?
Please let me know when you have an environment set up we can have a web ex and go over the calls and responses with this mapping rule in place.","13/Mar/23 2:25 AM;5b15d994dda5f94d06b985b2;I’m going to be out this week but I can work on this the week after. Here’s a little more information on the customer’s requirements/observations regading FAPI compliance:

_Below is the snippet from FAPI specs for OpenID and OAuth which states that if openid is in the scope, nonce should be mandatory else state should be mandatory. However, with FAPI checks, we don't it conforms to these standards. I understand that nonce is not mandatory for OIDC spec, however, when we are checking FAPI compliance, it should make nonce mandatory, isn't it?_



_1-Access_ [https://openid.net/specs/openid-financial-api-part-1-1_0.html|https://openid.net/specs/openid-financial-api-part-1-1_0.html|smart-link] _, go to the section_

_5.2.2. Authorization server_

_5.2.2.2. Client requesting openid scope_

_If the client requests the openid scope, the authorization server_

_shall require the nonce parameter defined in Section 3.1.2.1 of OIDC in the authentication request._

_5.2.2.3. Clients not requesting openid scope_

_If the client does not requests the openid scope, the authorization server_

_shall require the state parameter defined in Section 4.1.1 of RFC6749._

----

We provide a bundle of mapping rules for our FAPI compliance but rather than failing if a request comes in without a nonce we only add the nonce if the client provides one. ","15/Mar/23 2:58 PM;5af4ad7d4dd24c579110120b;<Notes>

Internally we do validation that the nonce is present.

{noformat}  throw new OidcAccessDeniedException(logger, method, OIDCMessages.invalid_jwt_claim, new Object[] {""nonce"", ""<null>""}, null);	{noformat}

Will need requests and traces ","16/Mar/23 3:05 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d994dda5f94d06b985b2] 

It is FAPI complaint, the reason the mapping rule doesn't have it by default is because there is no clarity whether it is is OIDC  or FAPI at that point in time. Further down, Internally if It is FAPI complaint it will respond with the Access Denied exception.

If the customer needs the mapping rule to their an error for missing nonce with custom message they can use {{OAuthMappingExtUtils.throwSTSCustomUserPageException}} with corresponding error message.

 ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
High CPU utilization,ISAMSUP-4858,286843,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,09/Mar/23 6:52 PM,06/Jul/23 11:06 AM,14/Jul/23 2:47 PM,06/Jul/23 11:06 AM,,Support,,0,escalated,,,"during a major issue on our Productive Federation Environment, see IBM case TS011982832, 

then we faced high CPU utilization approximately 80-90% opn the Appliance.

Then the Liberty runtime restart solved the problem.  

Because of this issue, our appliance got 2 additional CPU core, from 6 to 8 CPU core. 

The CPU usage was fine on the next day, but it seems the CPU usage is higher and higher on the Applinace day by day, even though we have more CPU (assigned CPU from VM side).

From VM side there is no resource problem, our Appliance does not get more requests as before.

Based on the ""ps"" command the following process uses the most CPU:

Mem: 12763312K used, 53187676K free, 176K shrd, 264928K buff, 5263780K cached

CPU: 66.6% usr  5.5% sys  0.0% nic 23.3% idle  0.0% io  2.2% irq  2.2% sirq

Load average: 5.49 6.21 6.36 9/628 24249

  PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND

 2225     1 www-data S    13.1g 20.3   2 71.1 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx8192m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.auth

Is it possible to get more information why the CPU usage higher on the Applinace?",,Aaron.Richie.Dias,Alan Wong,Ayush Singh,BRIANORO,David Hayes,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Surya Prakash,tonyferg,Tushar Prasad,,,,6194c472fe9f300068e5252f,6092aca0f0db130069d19687,61409dc154762c006932ffc7,6154906364ff01007106e189,5b232b2fd85e5b59b066f57f,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,60f541a6d0134900692d91b7,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,30/Mar/23 11:15 PM;whannon;01_CPU_Average_3600_Weekday.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193438,30/Mar/23 11:15 PM;whannon;02_CPU_Average_3600_Weekend.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193435,30/Mar/23 11:15 PM;whannon;03_CPU_Average_3600_Weekday_08-18.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193436,30/Mar/23 11:15 PM;whannon;04_CPU_Average_3600_Weekday_NOT_08-18.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193441,30/Mar/23 11:15 PM;whannon;05_CPU_Average_1200_Weekday.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193433,30/Mar/23 11:15 PM;whannon;06_CPU_Average_1200_Weekend.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193442,30/Mar/23 11:15 PM;whannon;07_CPU_Average_300_Weekday.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193440,30/Mar/23 11:15 PM;whannon;08_CPU_Average_300_Weekend.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193439,30/Mar/23 11:15 PM;whannon;09_CPU_Average_60_Weekday.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193434,30/Mar/23 11:15 PM;whannon;10_CPU_Average_60_Weekend.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193437,14/Mar/23 8:05 AM;whannon;cpu.rrd.AVERAGE_1200.txt;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189903,13/Mar/23 9:08 PM;tonyferg;image-20230313-110614.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189716,14/Mar/23 2:54 AM;nlloyd;image-20230313-165132.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189831,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012039167,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,Volkswagen AG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-02-07/&filepath=TS012039167/2023-02-07/isva_10.0.4.0_20230207-065326_vaf209p001b.wob.sec.vw.vwg.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-02-07/&filepath=TS012039167/2023-02-07/isva_10.0.4.0_20230130-081716_vaf209p001b.wob.sec.vw.vwg.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-02-24/&filepath=TS012039167/2023-02-24/javacore.20230224.120232.4977.0001.txt

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-02-24/&filepath=TS012039167/2023-02-24/isva_10.0.5.0_20230224-120336_vaf209p001b.wob.sec.vw.vwg.support",,,,,,,,,,,,,,,,,,,,,,,0|i19b8b:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-03-10 01:13:06.783,,,,,"10/Mar/23 11:13 AM;5b17571b91981f4fdde632c1;* For IBM ISVA Support only:
** [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167]
*** Was there
**** Then disappeared
*** Now reporting
**** “Ticket not found ….”
***** Can I close this now then 😉",10/Mar/23 8:22 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1] ticket is still open don't know why does it showed as ticket not found could you please check again.,"13/Mar/23 9:08 PM;5ac57757d9a96536d1f0daa9;[~accountid:61409dc154762c006932ffc7] [~accountid:5b17571b91981f4fdde632c1] this item has been escalated to me today and thus I have marked this item for additional focus. From my initial review of the logs I would like to ensure that the customer has the correct configuration for their cleanups. [~accountid:61409dc154762c006932ffc7] I can see that you have implied in the case update that this might be something that needs to be considered. Can you please confirm the details of your investigation as to why you think that this might be so. 

From the customer provided files I can see that the have the following parameters configured - 

!image-20230313-110614.png|width=100%!

[~accountid:5b17571b91981f4fdde632c1] does anything stand out in regards to these? Is there anyway from the log files that we can confirm that we have an excessive number of DB connections? 


[~accountid:5b232b2fd85e5b59b066f57f] appreciate any additional focus that we can offer regarding this, ",13/Mar/23 9:39 PM;61409dc154762c006932ffc7;[~accountid:5ac57757d9a96536d1f0daa9] That is for session.dbCleanupInterval. wanted to check if it is Set to 120. Which is the default,"13/Mar/23 10:45 PM;5b232b2fd85e5b59b066f57f;I’ve had a quick look. A few observations / questions: 

# Attached to the case are support files for 10.0.4 and 10.0.5 which looks like the same Appliance. L2 - can you confirm? We need to understand the context surrounding these files:- e.g. did they upgrade in the hope of fixing the issue? Did they only see the issue once upgraded to 10.0.5? etc. 
# L3 needs more context around the issue - e.g. when did it start, what changes had been made in the environment immediately prior, etc.
# There are a bunch of expired certs that the runtime is trying to use. This should be fixed as it would unnecessarily use up CPU cycles. 
# All of the below threads with very high CPUTIME are in the DB cleanup job - specifically com/tivoli/am/fim/oauth20/strategy/commands/StartTokenCleanupThreadCmd$TokenCleanupThread.run

{noformat}$ grep ""3XMCPUTIME"" /ecurep/sf/TS012/039/TS012039167/0-all_data/javacore* | sort -n -k 5
...
/ecurep/sf/TS012/039/TS012039167/0-all_data/javacore.20230213.171021.25318.0001.txt:3XMCPUTIME               CPU usage total: 20318.914263362 secs, current category=""Application""
/ecurep/sf/TS012/039/TS012039167/0-all_data/javacore.20230213.171112.25318.0003.txt:3XMCPUTIME               CPU usage total: 20326.310159639 secs, current category=""Application""
/ecurep/sf/TS012/039/TS012039167/0-all_data/javacore.20230213.171214.25318.0005.txt:3XMCPUTIME               CPU usage total: 20337.018903536 secs, current category=""Application""
/ecurep/sf/TS012/039/TS012039167/0-all_data/javacore.20230213.171316.25318.0007.txt:3XMCPUTIME               CPU usage total: 20347.375905730 secs, current category=""Application""
/ecurep/sf/TS012/039/TS012039167/0-all_data/javacore.20230213.171415.25318.0009.txt:3XMCPUTIME               CPU usage total: 20357.156952870 secs, current category=""Application""
/ecurep/sf/TS012/039/TS012039167/0-all_data/javacore.20230213.171506.25318.0011.txt:3XMCPUTIME               CPU usage total: 20365.105814302 secs, current category=""Application""{noformat}

It looks like all of these threads are waiting for (or doing) a read on the socket. This could be indicative of bad comms between ISVA and the DB instance and / or a non-responsive DB. Has the customer investigated the health of the network and the Oracle DB? 

I note that the Appliance is using external Config and HV Oracle DBs. 

5. Are there any other Appliances configured to use the same Oracle DBs as this ISVA instance? 

6. How many records are being created in a 24hr period in the oauth20 tables? What volume does the customer’s environment clean up in a 24hr period? i.e. does the cleanup job handle the incoming load?  ","14/Mar/23 1:25 AM;5b17571b91981f4fdde632c1;* TS012039167/2023-02-23/pidstat.txt
** Not likely cleanup threads
*** Continual/Consistent during extended times
** Sorted reverse CPU, USR CPU, SYS CPU, PID, COMMAND, TIME
*** User CPU high
*** Sys   CPU relatively high
{noformat}77.14	68.67	8.46	5569	java	04:18:29 PM
77.12	68.66	8.46	5569	java	04:17:06 PM
77.10	68.64	8.46	5569	java	04:15:46 PM
77.07	68.62	8.46	5569	java	04:13:41 PM
77.05	68.59	8.46	5569	java	04:11:38 PM
76.99	68.53	8.46	5569	java	04:07:22 PM
76.92	68.47	8.45	5569	java	04:02:12 PM
76.86	68.41	8.45	5569	java	03:59:12 PM
76.74	68.30	8.44	5569	java	03:51:05 PM
74.92	66.57	8.34	5569	java	02:07:58 PM
74.82	66.48	8.34	5569	java	02:02:53 PM
74.68	66.35	8.33	5569	java	01:56:12 PM
74.59	66.27	8.32	5569	java	01:51:46 PM
74.43	66.12	8.32	5569	java	01:44:16 PM
74.35	66.04	8.31	5569	java	01:39:46 PM
74.23	65.93	8.30	5569	java	01:34:20 PM
74.15	65.85	8.30	5569	java	01:30:20 PM
74.10	65.81	8.30	5569	java	01:27:33 PM
74.04	65.74	8.29	5569	java	01:24:06 PM
73.96	65.67	8.29	5569	java	01:19:33 PM{noformat}","14/Mar/23 1:30 AM;5b17571b91981f4fdde632c1;* When the problem start?
** Please be thorough","14/Mar/23 1:50 AM;5b17571b91981f4fdde632c1;* Please carefully confirm the problem
** *is with Java runtime*
*** The CPU data does not specify which java … just java
*** The did take a javacore of Java runtime
** *not default*","14/Mar/23 2:54 AM;5b15d9e6dda5f94d06b985b4;The high CPU threads are at com/tivoli/am/fim/oauth20/strategy/commands/StartTokenCleanupThreadCmd$TokenCleanupThread.run.  The cleanup threads are only run from the Runtime.  This reason for noting the cleanup thread is based on JVM analysis tools in ECuRep:



!image-20230313-165132.png|width=1063,height=653!

where Thread-32 is the OAUTH Token cleanup thread.



From customer:
We can't determine it exactly when it started, as we first noticed this behavior when we had to increase the CPU cores of the appliance from 6 to 8 due to an incident, but the CPU utilization remained the same as with 6 cores. The VM team then separated the appliance to a separate VM host where no other VMs were running, but CPU utilization remained the same as before.


Alright, we'll do a cleanup on expired certificates. However, we do not think that this is the cause of the problem, since we have an appalince in other environments where there are many more expired certificates in the system than on this appliance. We did not notice similar behavior there.

Oracle DB side was checked by the DBAs but they didn't find any problem. The network will be checked by the networking team, but another appliance uses the same database as an external runtime database (from the same network zone) and there is no problem with that.

I note that the Appliance is using external Config and HV Oracle DBs.


Are there any other Appliances configured to use the same Oracle DBs as this ISVA instance?

*-> Yes, without any problem (see above).*


How many records are being created in a 24hr period in the oauth20 tables? What volume does the customer’s environment clean up in a 24hr period? i.e. does the cleanup job handle the incoming load?

*-> Could you please support us to query these settings? Which tables should be checked exactly in the DB?*","14/Mar/23 2:57 AM;5b17571b91981f4fdde632c1;* Where is the external config data configuration on ECUREP?
** Want to see the configuration settings","14/Mar/23 3:29 AM;5b15d9e6dda5f94d06b985b4;[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167%2F2023-02-24%2Fisva_10.0.5.0_20230224-120336_vaf209p001b.wob.sec.vw.vwg.support_unpack%2Fetc%2Fpolicies%2Fcml%2Fisam%2Fcluster%2F&filepath=TS012039167%2F2023-02-24%2Fisva_10.0.5.0_20230224-120336_vaf209p001b.wob.sec.vw.vwg.support_unpack%2Fetc%2Fpolicies%2Fcml%2Fisam%2Fcluster%2Fcluster7_0_0.xml|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167%2F2023-02-24%2Fisva_10.0.5.0_20230224-120336_vaf209p001b.wob.sec.vw.vwg.support_unpack%2Fetc%2Fpolicies%2Fcml%2Fisam%2Fcluster%2F&filepath=TS012039167%2F2023-02-24%2Fisva_10.0.5.0_20230224-120336_vaf209p001b.wob.sec.vw.vwg.support_unpack%2Fetc%2Fpolicies%2Fcml%2Fisam%2Fcluster%2Fcluster7_0_0.xml]


[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167%2F2023-02-24%2Fisva_10.0.5.0_20230224-120336_vaf209p001b.wob.sec.vw.vwg.support_unpack%2Fetc%2Fpolicies%2Fcml%2Fmesa%2Fdevice_params%2F&filepath=TS012039167%2F2023-02-24%2Fisva_10.0.5.0_20230224-120336_vaf209p001b.wob.sec.vw.vwg.support_unpack%2Fetc%2Fpolicies%2Fcml%2Fmesa%2Fdevice_params%2Fdevice_params2_0_0.xml|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167%2F2023-02-24%2Fisva_10.0.5.0_20230224-120336_vaf209p001b.wob.sec.vw.vwg.support_unpack%2Fetc%2Fpolicies%2Fcml%2Fmesa%2Fdevice_params%2F&filepath=TS012039167%2F2023-02-24%2Fisva_10.0.5.0_20230224-120336_vaf209p001b.wob.sec.vw.vwg.support_unpack%2Fetc%2Fpolicies%2Fcml%2Fmesa%2Fdevice_params%2Fdevice_params2_0_0.xml]","14/Mar/23 4:15 AM;5b17571b91981f4fdde632c1;* Please show the full ISVA instances
** How many?
** Need system names for each instance
** We only have vaf209p001b
*** Nothing else
*** Are the other instances having the same exact problem?
** WebSEAL
*** Where are these support files?
*** How many
*** Require the WebSEAL instances and WebSEAL junctions that trigger runtime
** Federation
*** How many","14/Mar/23 5:23 AM;5b17571b91981f4fdde632c1;* Support files
** cpu.rrd file ranges from the 3 support files provided
*** {noformat}vaf209p001b	MAX	0060		01/29/2023 01:19:00		01/30/2023 01:18:00
vaf209p001b	MAX	0060		02/05/2023 23:55:00		02/06/2023 23:54:00
vaf209p001b	MAX	0060		02/23/2023 05:06:00		02/24/2023 05:05:00

vaf209p001b	MAX	0300		01/27/2023 01:20:00		01/30/2023 01:15:00
vaf209p001b	MAX	0300		02/03/2023 23:55:00		02/06/2023 23:50:00
vaf209p001b	MAX	0300		02/21/2023 05:10:00		02/24/2023 05:05:00

vaf209p001b	MAX	1200		01/23/2023 01:20:00		01/30/2023 01:00:00
vaf209p001b	MAX	1200		01/31/2023 00:00:00		02/06/2023 23:40:00
vaf209p001b	MAX	1200		02/17/2023 05:20:00		02/24/2023 05:00:00

vaf209p001b	MAX	3600		01/08/2023 00:00:00		02/06/2023 23:00:00
vaf209p001b	MAX	3600		01/25/2023 06:00:00		02/24/2023 05:00:00
vaf209p001b	MAX	3600		12/31/2022 02:00:00		01/30/2023 01:00:00{noformat}
*** 60 seconds range
**** 1 day
*** 300 seconds range
**** 3 days
*** 1200 seconds range
**** 7 days
*** 3600 seconds range
**** 30 days
*** The higher the granularity the harder to detect consistency
** {color:#bf2600}*Not enough* {color}
** {color:#bf2600}*inconsistent* {color}
** *Which might cause inconclusive CPU analysis*
*** Which is what the CPU graphs show
*** RRD converts to local time zone CST/CDT
**** Therefore the times{color:#bf2600} *must be manually converted*{color}  from CDT/CST to CET/CEST time
** Have attached cpu.rrd.AVERAGE_1200.txt files
*** Please review Inconsistent statement and determine time from restart
*** Afterwards we can send to customer after we understand","14/Mar/23 6:59 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9e6dda5f94d06b985b4] 

Are there any other Appliances configured to use the same Oracle DBs as this ISVA instance?

*-> Yes, without any problem (see above).*

…and, are they attempting cleanup from here also???? If so, this could cause issues. Cleanup should only be occurring from one ISVA instance. ","14/Mar/23 8:06 AM;5b17571b91981f4fdde632c1;* L2 please help the customer
** com.ibm.ws.jdbc.internal.JDBCDriverService		DSRA8020E: Warning: The property 'blockingReadConnectionTimeout' does not exist on the DataSource class oracle.jdbc.pool.OracleConnectionPoolDataSource.","14/Mar/23 11:56 AM;5b232b2fd85e5b59b066f57f;“blockingReadConnectionTimeout” is for DB2 only. At any rate - looking at the customer’s support file, it seems this property is no longer set. L2 - I assume the customer tried this at some point then removed it? Rather than “blockingReadConnectionTimeout”, they should be using “oracle.jdbc.ReadTimeout”. Given that it seems that there are threads stuck waiting to read from the socket, it would be worthwhile setting this. REF to following for info on how to set: [https://cloudidentity.atlassian.net/browse/ISAMSUP-3650|https://cloudidentity.atlassian.net/browse/ISAMSUP-3650|smart-link]  [https://cloudidentity.atlassian.net/browse/ISAMSUP-3483|https://cloudidentity.atlassian.net/browse/ISAMSUP-3483|smart-link] [https://cloudidentity.atlassian.net/browse/ISAMSUP-1729|https://cloudidentity.atlassian.net/browse/ISAMSUP-1729|smart-link] [https://cloudidentity.atlassian.net/browse/ISAMSUP-1172|https://cloudidentity.atlassian.net/browse/ISAMSUP-1172|smart-link] . Note, L2 may need to test in lab to confirm how to properly set in 10.0.5 (I would have done this today but our lab environment is down). 

I also notice that the customer has specified connection string as an Adv. Tuning param using the thin driver - why have they done this - what are they trying to achieve? 

Stepping back somewhat - what is the actual issue / concern that the customer has? Is it simply that CPU utilisation is higher than they would like? What functional impact, if anything, are they seeing? In the provided support files I do not see CPU utilisation going over the warning threshold. 

Did we get an answer to this?:- 

_“6. How many records are being created in a 24hr period in the oauth20 tables? What volume does the customer’s environment clean up in a 24hr period? i.e. does the cleanup job handle the incoming load?”_

Also - we need to understand the configuration on the other ISVA instances which are configured to use the same DBs as this Appliance - specifically how are they configured to handle cleanup? Cleanup should only be triggered from one ISVA instance; multiple instances of the ISVA cleanup job working on a single DB could cause contention and performance issues. ","15/Mar/23 3:08 AM;5b17571b91981f4fdde632c1;* Numbers below are for idlecpu percentage
** CPU = (user + sys + idle) == 100%
*** The lower the idlecpu the higher CPU (user + sys)
**** Low  idle numbers == high (user+sys) cpu
**** High idle numbers == low   (user+sys) cpu

{noformat}>	2023-02-07/isva_10.0.4.0_20230130-081716_vaf209p001b.wob.sec.vw.vwg.support_unpack/var/iss-db/cpu.rrd
vaf209p001b	AVERAGE	0060
        5.033333	01/30/2023 01:06:00	CST
		6.533333	01/30/2023 01:07:00	CST
		9.433333	01/30/2023 00:59:00	CST
		9.566667	01/30/2023 01:00:00	CST
		9.866667	01/30/2023 01:05:00	CST
vaf209p001b	AVERAGE	0300
    	9.886667	01/30/2023 01:00:00	CST
		10.086667	01/30/2023 01:05:00	CST
		10.800000	01/30/2023 00:55:00	CST
		11.000000	01/30/2023 00:40:00	CST
		11.000000	01/30/2023 00:50:00	CST
vaf209p001b	AVERAGE	1200
    	10.721667	01/30/2023 01:00:00	CST
		25.581667	01/26/2023 07:20:00	CST
		26.823333	01/25/2023 03:20:00	CST
		28.026667	01/25/2023 03:00:00	CST
		28.145000	01/28/2023 02:00:00	CST
vaf209p001b	AVERAGE	3600
    	30.902222	01/25/2023 03:00:00	CST
		31.469444	01/24/2023 07:00:00	CST
		31.566111	01/25/2023 04:00:00	CST
		32.314444	01/26/2023 08:00:00	CST
		32.626667	01/18/2023 02:00:00	CST

>	2023-02-07/isva_10.0.4.0_20230207-065326_vaf209p001b.support_unpack/var/iss-db/cpu.rrd
vaf209p001b	AVERAGE	0060
    	28.666667	02/06/2023 03:21:00	CST
		29.133333	02/06/2023 06:57:00	CST
		29.266667	02/06/2023 06:17:00	CST
		29.400000	02/06/2023 06:32:00	CST
		29.533333	02/06/2023 07:36:00	CST
vaf209p001b	AVERAGE	0300
    	31.173333	02/06/2023 06:20:00	CST
		31.320000	02/06/2023 02:25:00	CST
		31.346667	02/06/2023 07:00:00	CST
		31.480000	02/06/2023 06:35:00	CST
		32.080000	02/06/2023 01:40:00	CST
vaf209p001b	AVERAGE	1200
    	28.933333	02/02/2023 01:40:00	CST
		29.626667	02/02/2023 03:40:00	CST
		29.713333	02/02/2023 02:20:00	CST
		31.353333	02/02/2023 02:00:00	CST
		31.606667	02/02/2023 01:20:00	CST
vaf209p001b	AVERAGE	3600
    	27.348333	01/30/2023 02:00:00	CST
		30.631111	02/02/2023 02:00:00	CST
		30.902222	01/25/2023 03:00:00	CST
		31.469444	01/24/2023 07:00:00	CST
		31.566111	01/25/2023 04:00:00	CST

>	2023-02-24/isva_10.0.5.0_20230224-120336_vaf209p001b.support_unpack/var/iss-db/cpu.rrd
vaf209p001b	AVERAGE	0060
    	40.266667	02/24/2023 04:35:00	CST
		40.666667	02/24/2023 05:05:00	CST
		41.400000	02/24/2023 04:09:00	CST
		41.800000	02/24/2023 01:12:00	CST
		42.000000	02/24/2023 01:16:00	CST
vaf209p001b	AVERAGE	0300
    	45.106667	02/24/2023 02:15:00	CST
		45.106667	02/24/2023 04:10:00	CST
		45.333333	02/24/2023 01:15:00	CST
		45.733333	02/24/2023 04:35:00	CST
		45.773333	02/24/2023 04:15:00	CST
vaf209p001b	AVERAGE	1200
    	38.356667	02/20/2023 01:40:00	CST
		41.913333	02/20/2023 01:20:00	CST
		44.113333	02/17/2023 07:00:00	CST
		45.053333	02/17/2023 07:20:00	CST
		46.846667	02/24/2023 04:40:00	CST
vaf209p001b	AVERAGE	3600
    	27.348333	01/30/2023 02:00:00	CST
		30.631111	02/02/2023 02:00:00	CST
		32.314444	01/26/2023 08:00:00	CST
		32.385556	02/02/2023 04:00:00	CST
		32.667778	02/02/2023 03:00:00	CST{noformat}","15/Mar/23 3:51 AM;5b17571b91981f4fdde632c1;* For IBM Support only
** Is Glowroot/Dynatrace an option?
*** It may be the best option for this scenario
**** With the variance
** Based on current analysis we required
*** {color:#bf2600}*all the data requests/changes below*{color}
**** Customer was saying this is the only appliance
***** What are the other appliances showing
****** We require the support files from other appliances … same timeframes
***** Is this the appliance doing cleanup?
***** What is different about this appliance
*** All historical changes date/time and change in these timeframes
**** Including restart details
***** What determines
***** When
*** Require daily support files from this appliance
**** Every 24 hours to maximize the CPU RRD  60 second data
***** Lost after 24 hours
** Base on CPU RRD data
*** 2023/01/30 lowest peak idlecpu 5.03%
*** 2023/02/24 lowest peak idlecpu 40.3%
**** {color:#bf2600}*Almost 8 times improvement over 2023/01/30 idlecpu*{color}
**** During this same timeframe upgraded from 10.0.4.0 → 10.0.5.0
*** Will not be able to proceed any further ithout 
**** better CPU RRD data every 24 hours
**** Peer runtime support files
**** All WebSEAL support files for this java runtime
***** All WebSEAL junctions driving Federation
***** *Require both ASAP*
**** Historical 
***** differences
***** changes
***** procedure changes (i.e: restart when/why etc)
** Anything outside of the 3 support files
*** {noformat}2023-02-07/isva_10.0.4.0_20230130-081716_vaf209p001b.*.support
2023-02-07/isva_10.0.4.0_20230207-065326_vaf209p001b.*.support
2023-02-24/isva_10.0.5.0_20230224-120336_vaf209p001b.*.support{noformat}
*** Cannot be investigated/discussed
**** Other than to understand customer’s perception
** No clear criteria for success
*** This could be *never* ending or very prolonged","15/Mar/23 1:28 PM;5b17571b91981f4fdde632c1;* For L2
** *What is the name of the customer’s IBM Security Expert Essentials account manager*
** Discussed prior workitem posts with Nick Lloyd
*** He understands everything that is documented here
**** The technical data and analysis in the prior work item posts may be required to answer customer questions
***** Strongly suggest reviewing
*** He said he would work with the L2
** If there are any L2 questions
*** If urgent please slack me
**** Still requires documentation as work item update
*** Otherwise ask any questions in work item



* For Customer [~accountid:61409dc154762c006932ffc7] [~accountid:6092ac9ff6c0960069d47a67] [~accountid:5ac57757d9a96536d1f0daa9] 
** Is installing Glowroot (free) or Dynatrace an option for the java process?
** *Urgent*
*** *What is the frequency/occurrences of the reported high CPU*
**** Please provide as much detail as possible
** How does the customer monitor/identify the hight CPU
*** From KVM host?
*** From ISVA?
** When did the problem start or was recognized?
*** Please provide all history/changes after that date
**** Please document for each date, time and changes
** We require ISVA topography for this specific instance with high cpu
*** Document all ISVA peer runtime appliance(s)
**** Require support files from all 
*** Document all ISVA WebSEAL appliances, instances and junctions using ISVA runtime
**** Require support files from all
** Is the ISVA runtime with high CPU being proactively restarted?
*** If so how often?","15/Mar/23 9:03 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1] the client is asking to collect all the questions and information you need in one post. 

If they need to check some advanced tuning parameter or a table in the DB or something else, client is looking for detailed description of what and where we need to look.","15/Mar/23 9:10 PM;5b17571b91981f4fdde632c1;{quote}  * What is the name of the customer’s IBM Security Expert Essentials account manager{quote}

Unanswered returning to L2

","15/Mar/23 9:34 PM;5b17571b91981f4fdde632c1;The questions that I asked are the CRITICAL path from the customer’s data.

Is there anything that is not clear on my questions from yesterday?

When can we expect the answers.

Anything else are observations at this point.

[~accountid:5b15d9e6dda5f94d06b985b4]

[~accountid:5ac57757d9a96536d1f0daa9] 

[~accountid:6092ac9ff6c0960069d47a67] 

","15/Mar/23 9:47 PM;5b17571b91981f4fdde632c1;For ISVA Support only

{quote}If they need to check some advanced tuning parameter or a table in the DB or something else, client is looking for detailed description of what and where we need to look.{quote}

[~accountid:5b15d9e6dda5f94d06b985b4] 

L2 should be able to help with this level of detail.

Any thoughts?

","16/Mar/23 6:19 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** From SalesForce case
** {noformat}15 Mar 2023 - 5:55 am

Hello Ayush, 
I understand that you need more information, but it is not helpful if our questions are ignored.
Kindly ask you to collect all the questions and information you need in one post.
If we need to check some advanced tuning parameter or a table in the DB or something else,
please give us a detailed description of what and where we need to look.{noformat}
** {color:#bf2600}*I understand that you need more information, but it is not helpful if our questions are ignored.*{color}
*** Not mentioned in work item
**** *L2 must be handling*","16/Mar/23 1:05 PM;5b232b2fd85e5b59b066f57f;[~accountid:61409dc154762c006932ffc7] 

The key information that we need from the customer at this point in time in order to move forward is as follows: 

# *How is the customer monitoring CPU utilisation?* 
## Are they using the graphs shown through ISVA LMI or some other tool / mechanism? 
## Can the customer send us a screenshot of their monitoring tool / mechanism showing CPU utilisation and describing their concern? 
## Based on the customer’s CPU utilisation monitoring tool  mechanism, can they comment on CPU utilisation trends - i.e. is CPU utilisation continually growing, is it stable, is it dropping?
# *Can the customer clarify their concerns relating to CPU utilisation?* 
## Is the concern that CPU utilisation is higher than they would like/expect, or is the concern that CPU utilisation is continually growing, or is the concern that CPU utilisation is not dropping, or something else? 
## What functional impact, if anything, is the customer seeing? 
# *It was mentioned by the customer that multiple ISVA instances are configured to use the same external DB as this Appliance. Can we have a screenshot from each of these Appliances showing the DB cleanup configuration through the LMI as per previous screenshot advanced_config.PNG (which is attached to the case)?* 

At this stage, this is our starting point; based on responses to these questions, we will likely have follow-on questions / requests. 



[~accountid:61409dc154762c006932ffc7] / [~accountid:5b15d9e6dda5f94d06b985b4] - if available, please ping me on Slack when you are online if you need further explanation of what we are currently thinking, what we need and why.  Also [~accountid:61409dc154762c006932ffc7] -  did you have any luck with determining how to set oracle.jdbc.ReadTimeout? Thanks. ","17/Mar/23 1:04 AM;5b17571b91981f4fdde632c1;* For ISVA L3 Support only:
** To keep track of outstanding requests that are still outstanding
*** Strike through represents completed
*** Underline         represents partially

----

{color:#bf2600}*From March 14, 2023, 10:28 PM* {color}

* For Customer
** Is installing Glowroot (free) or Dynatrace an option for the java process?
** *Urgent*
*** *What is the frequency/occurrences of the reported high CPU*
**** Please provide as much detail as possible
** How does the customer monitor/identify the hight CPU
*** From KVM host?
*** +From ISVA?+
** When did the problem start or was recognized?
*** Please provide all history/changes after that date
**** Please document for each date, time and changes
** We require ISVA topography for this specific instance with high cpu
*** Document all ISVA peer runtime appliance(s)
**** Require support files from all
*** Document all ISVA WebSEAL appliances, instances and junctions using ISVA runtime
**** Require support files from all
** Is the ISVA runtime with high CPU being proactively restarted?
*** If so how often?","21/Mar/23 6:01 AM;5b17571b91981f4fdde632c1;* For IBM Support
** It has been three business days since the prior request
*** Do we have an estimate time for the response
** While they investigating/working the first set
*** When can we ask the other questions?","21/Mar/23 9:32 PM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f]  customer answered the questions asked below 



1)Are you using the graphs from ISVA LMI or any other tool/mechanism?

-> LMI graphs + pidstat output

2)Could you please provide us the screenshot of your monitoring tool/ mechanism showing CPU utilization and describing their concern?

And what impact are you seeing functionally if you could describe us more specifically?

-> So here is the story line:

During the weekend of 28th of January the CPU usage started suddenly increasing on our productive AAC Federation appliance (master vaf209p001). Based on the requests there were no higher load the systems than before, especially not because it was on the weekend so out of office hours. By monday (30th of January) the CPU usage reached ~90%, the federation runtime was slow to respond and serve the requests, so we decided to increase the CPU cores of both AAC Federation appliances from 6 to 8. After restarting both appliances the CPU usage became normal and it did not go up to 90% but approx to 60-65%. Afterwards we recongnised that even though there is no peaks in the CPU usage, the average CPU usage with 8 cores is the same as with 6 cores. Especially if you check the usage out of office hours. Additionally it seems that the there are higher lows on the graph of the 30 days CPU statistics.

So our main concerns:

# There is no improvement in CPU utilization with 2 additional cores (8 cores in summary pro appliances). We expected to see much lower CPU usage and drops below 20% (as it was 20% with 6 core as well), especially out of office hours.
# Based on the provided pidstat outputs it seems that the javaagent consumes more and more CPU but it does not drop along with the drop of the load by reaching the end of the office hours. It is also indicated by the CPU statistics graph, where you can see higher lows on the line chart.
# Currently we are not experiencing any issue regarding CPU, but we might in the future again (see above).

 

# And you mentioned multiple ISVA instances are configured to use same external DB. So could you please provide the screenshot from each of these Appliances showing the DB cleanup configuration through the LMI as per previous screenshot advanced_config.PNG (which is attached to the case)? 

 

Please find attached the screenshots and as well as a support file of our B2B AAC appliance (used for a second instance of TOTP so that we can use different template files for B2B applications).

Runtime clusters look like this:

vaf209p013 (master) - vaf210p013

vaf209p001 (master) - vaf210p001

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf209p001_db_config.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf209p001_db_config.PNG]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf210p001_advanced_config.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf210p001_advanced_config.PNG]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf210p001_db_config.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf210p001_db_config.PNG]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf209p013_advanced_config.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf209p013_advanced_config.PNG]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf210p013_db_config.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf210p013_db_config.PNG]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf210p013_advanced_config.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf210p013_advanced_config.PNG]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/cpu_vaf209p001.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/cpu_vaf209p001.PNG]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf209p013_db_config.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf209p013_db_config.PNG]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf209p001_advanced_config.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/vaf209p001_advanced_config.PNG]



support:[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/isva_10.0.5.0_20230321-115639_vaf209p013b.wob.sec.vw.vwg.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-21/&filepath=TS012039167/2023-03-21/isva_10.0.5.0_20230321-115639_vaf209p013b.wob.sec.vw.vwg.support]

Also customer is looking for web-ex so could you share your availability ?","23/Mar/23 11:31 AM;5b232b2fd85e5b59b066f57f;*L2 - some follow up questions / requests for the customer:* 

# How long had the environment been running when the issues occurred on 28JAN - i.e. when was the latest restart prior to this date? 
# What changes had been made in the environment between the latest restart prior to 28JAN and the restart prior to this?  
# Prior to adding the additional cores, what firmware version was the Appliance running?
# After adding the additional cores, what firmware version was the Appliance running? 
# Of the 4 Appliances mentioned (cluster 1 - vaf209p013 (master) - vaf210p013; cluster 2 - vaf209p001 (master) - vaf210p001) which Appliances are showing this behaviour? 
# I can see a screenshot of CPU graph (cpu_vaf209p001.PNG) has been uploaded. This shows average utilisation since last reboot of < 30% (user + system) with peaks and troughs as expected. I’m still unsure what the customer’s concern is as this is entirely what I would expect to see in a healthy Appliance? 
# Can the customer explain this statement further?: 

_”Afterwards we recongnised that even though there is no peaks in the CPU usage, the average CPU usage with 8 cores is the same as with 6 cores.”_

How did the customer determine the average? Over what period of time was the average calculated? 

*In response to the customer’s concerns:* 

# We need some more context around this (see above questions). From all of the support files we have after adding 2 cores, user CPU utilisation seems to max out around 60% - 65%. Moving from 6 - 8 cores is a 33% increase in number of cores. Using approximate numbers, 90% → 60% CPU utilisation represents roughly a 30% drop from peak; i.e. exactly what I would expect to see after moving from 6 to 8 cores. 
# The pidstat data that we have been provided only covers a 3hr period on a single day (23FEB). This is much too small a window to make any meaningful conclusions. We need to see, at minimum, pidstat data every hour for a 48hr period. 

Happy to have a call sometime next week. Ideally would have answers / data as requested in this post prior to the call - but any day next week is ok for me preferably after 1930hrs my time (AEST). 

Thanks. ","27/Mar/23 7:56 PM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f] we have answers to your questions below:

How long had the environment been running when the issues occurred on 28JAN - i.e. when was the latest restart prior to this date?

-> It has been a while since 28th of January, we cannot answer that. You might see in the provided support files from 30th of January

What changes had been made in the environment between the latest restart prior to 28JAN and the restart prior to this?

->

Here the latest appliance level modifications:



2023-03-22 06:22:41 New SAML IDP federation certificate idpext202702 imported #idpext202304

2023-02-24 13:49:38 Activate daily runtime restart script

2023-02-23 16:52:17 Management SSL Certificate changed to: vwisamlmi-prod

2023-02-12 13:11:26 Install ISVA 10.0.5 on AACs

2023-01-30 18:11:31 Appliance restart wegen CPU Erweiterung

2022-12-20 16:03:25 AAC/Federation: Löschen OIDC-API-Definition ""zentral_oidc""

2022-11-18 19:50:57 ISVA 10.0.4.0 IF1 rollback, fixpack IJ41819-jsrsasign install

2022-11-10 19:53:39 CR20467872 - [PROD WOBTAM] POLICY/AAC/WebSEAL ISVA: Patch 10.0.4-ISS-ISVA-FP0001 update

Prior to adding the additional cores, what firmware version was the Appliance running?

-> ISVA 10.0.4 + fixpack IJ41819-jsrsasign

After adding the additional cores, what firmware version was the Appliance running?

-> Until 12th of February ISVA 10.0.4 + fixpack IJ41819-jsrsasign, after ISVA 10.0.5 (Additional cores have been added on 30th of February)

Of the 4 Appliances mentioned (cluster 1 - vaf209p013 (master) - vaf210p013; cluster 2 - vaf209p001 (master) - vaf210p001) which Appliances are showing this behavior?

-> vaf209p001, because the 95% of the load is served by the primary master. Most propably the secondary master vaf210p001 would show the same behavior in fallback situation.

I can see a screenshot of CPU graph (cpu_vaf209p001.PNG) has been uploaded. This shows average utilization since last reboot of < 30% (user + system) with peaks and troughs as expected. I’m still unsure what the customer’s concern is as this is entirely what I would expect to see in a healthy Appliance?

Can you explain this statement further?

”Afterwards we recognized that even though there is no peaks in the CPU usage, the average CPU usage with 8 cores is the same as with 6 cores.”



How did the customer determine the average? Over what period of time was the average calculated?

-> Please have look on the attached screenshot (cpu_usage_old_vaf209p001) of the appliance vaf209p001 and compare with the actual graphs, you can see how the CPU usage evolves.



In response to the customer’s concerns:

We need some more context around this (see above questions). From all of the support files we have after adding 2 cores, user CPU utilisation seems to max out around 60% - 65%. Moving from 6 - 8 cores is a 33% increase in number of cores. Using approximate numbers, 90% → 60% CPU utilisation represents roughly a 30% drop from peak; i.e. exactly what I would expect to see after moving from 6 to 8 cores.

-> Please compare both attached screenshots of the graphs (cpu_usage_old_vaf209p001 vs cpu_usage_actual_vaf209p001)

The pidstat data that we have been provided only covers a 3hr period on a single day (23FEB). This is much too small a window to make any meaningful conclusions. We need to see, at minimum, pidstat data every hour for a 48hr period.

-> We will collect them and provide you before the meeting.



client is looking for webex on 30th of March from 10:30 AM to 03:00 PM CEST could you confirm what time suits you best?



[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-27/&filepath=TS012039167/2023-03-27/cpu_usage_old_vaf209p001.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-27/&filepath=TS012039167/2023-03-27/cpu_usage_old_vaf209p001.PNG]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-27/&filepath=TS012039167/2023-03-27/cpu_usage_actual_vaf209p001.PNG|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-03-27/&filepath=TS012039167/2023-03-27/cpu_usage_actual_vaf209p001.PNG]","29/Mar/23 10:56 AM;5b17571b91981f4fdde632c1;{quote}client is looking for webex on 30th of March from 10:30 AM to 03:00 PM CEST could you confirm what time suits you best?{quote}

* If the meeting can be scheduled for 07:00 CDT (Central Daylight time)
** Then we can have both L3 USA and L3 Gold Coast on the call
*** Would that be possible?
** We need to make sure we have L2 on the call taking notes",29/Mar/23 9:00 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1] 07:00 CDT is ok for client will be sharing the webex link in sometime.,"29/Mar/23 10:26 PM;5b17571b91981f4fdde632c1;{quote}07:00 CDT is ok for client will be sharing the webex link in sometime.{quote}

Please send calendar invite to

* Dave Hayes
* Me
* BCC Tony Ferguson ","30/Mar/23 11:20 PM;5b17571b91981f4fdde632c1;* Volkswagen thanked me for my vary thorough analysis
** Volkswagen now has a lot of work to do 😉
* Attached 10 *.png CPU charts
** Used in today’s meeting
*** 01_*  -  10_*",31/Mar/23 6:14 AM;5b17571b91981f4fdde632c1;Please make sure IBM getS all WebSEALS with Java webserver junctions list (ie: mga) support files so we can check the proper configuration option to avoid Java invalidating the SSL//TLS session.,"01/Apr/23 1:32 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** Where is L2 written summary of the meeting
*** Do not see in SalesForce case
*** Do not see here in JIRA?","05/Apr/23 12:02 AM;61409dc154762c006932ffc7;Hi [~accountid:5b17571b91981f4fdde632c1] we haverequested pidstat output [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-04-04/&filepath=TS012039167/2023-04-04/vaf209p001_pidstat.csv|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-04-04/&filepath=TS012039167/2023-04-04/vaf209p001_pidstat.csv]



Also do we have any guide to collect the glowroot?",12/Apr/23 10:55 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1] we have shared the steps to install glow root with client could you please let us know what logs exactly is required in glow root from them?,"12/Apr/23 11:21 PM;5b17571b91981f4fdde632c1;[~accountid:5b15d9e6dda5f94d06b985b4] 

I believe Nick Lloyd did a education video for this.

Nick,

Where is the proper place to search for this?",12/Apr/23 11:51 PM;5b15d9e6dda5f94d06b985b4;[https://ibm.ent.box.com/file/1184110347526|https://ibm.ent.box.com/file/1184110347526|smart-link] ,25/Apr/23 2:11 AM;5b17571b91981f4fdde632c1;* What is the current status?,"25/Apr/23 11:15 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1] we have new support files and client in process to install glowroot ans share files asap.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-04-25/&filepath=TS012039167/2023-04-25/support_files.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-04-25/&filepath=TS012039167/2023-04-25/support_files.zip]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-04-25/&filepath=TS012039167/2023-04-25/summary.txt|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012039167&path=TS012039167/2023-04-25/&filepath=TS012039167/2023-04-25/summary.txt]



""support_files.zip"" contains all of support files of our Webseal appliances where we have /isam, /mga junctions and connection to our AAC/FED appliances to STS module.



vaf209p001 and vaf210p001 are the AAC/FED appliances, all of others are Webseal appliances.

""summary.txt"" contains the list of Webseals where we have /isam, /mga junctions and STS configuration.","28/Apr/23 12:07 AM;5b17571b91981f4fdde632c1;{quote}""summary.txt"" contains the list of Webseals where we have /isam, /mga junctions and STS configuration.{quote}

* L2 please go through the summary.txt.
** Suggest breaking down to two columns
*** Column 1 system name
*** Column 2 WebSEAL instance name
** Using column 1 find all unique system values 
*** Do you have support files for the exact systems found?
** Using column 2 find all unique WebSEAL instance values
*** Do you have all support files for matching system and instance?
* For the failing WebSEAL instances
** Please review request-log-format against  all known junction options
*** Would any of the other junction options be useful that are not currently in request-log-format already?
** Please review the request.logs for durations front-end and back-end
*** Any observations?","18/May/23 4:35 AM;5b17571b91981f4fdde632c1;* Repeating
** Required



* For the failing WebSEAL instances
** Please review request-log-format against all known junction options
*** Would any of the other junction options be useful that are not currently in request-log-format already?
** Please review the request.logs for durations front-end and back-end
*** Any observations?","22/Jun/23 6:09 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1]  the client came back and according to them 

At the moment Glowroot is not acceptable way  in their environment.  They try to find a solution to have it implemented.

From their side an architect team was mentioned Dynatrace as possible alternative solution. 

Is this an option here?","22/Jun/23 6:12 PM;5b17571b91981f4fdde632c1;* Repeating 3rd request
** Required
** With the right request-log-format contents it may show something valuable



* For the failing WebSEAL instances
** Please review request-log-format against all known junction options
*** Would any of the other junction options be useful that are not currently in request-log-format already?
** Please review the request.logs for durations front-end and back-end
*** Any observations?","22/Jun/23 6:16 PM;5b17571b91981f4fdde632c1;{quote}From their side an architect team was mentioned Dynatrace as possible alternative solution. {quote}

What does ISVA documentation say about Dynatrace?",22/Jun/23 7:02 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1] i tried to review the logs but cant find anything from current files the customer has shared.,"22/Jun/23 9:09 PM;61409dc154762c006932ffc7;yes has IBM ISVA extension

[https://exchange.xforce.ibmcloud.com/hub/extension/46c449543f3570e9f4ffd15370c2c32b|https://exchange.xforce.ibmcloud.com/hub/extension/46c449543f3570e9f4ffd15370c2c32b|smart-link] ","22/Jun/23 10:34 PM;5b17571b91981f4fdde632c1;ALL request-log-format options are in the IBM ISVA documentation also.

Check your current WebSEAL configuration file for currently used request-log-format … you can ignore those … CAREFULLY read all the other options.  Suggest writing the configuration option short description for each each not used.

Then document here which one would help give IBM more statistical/historical information … then we can have a discussion on any additional one and why.

What you learn here will help you and your future customer problems/scenarios/performance









","22/Jun/23 10:42 PM;5b17571b91981f4fdde632c1;Another TODO

Go through customer ECUREP data  searching for VSZ.

What is the VSZ sizes of the runtime (lowest/highest) found.

----

There is also diagnostic pidstat command which has CPU and VSZ that the customer can capture and save 

* during low CPU times 
* every couple of minutes during during HIGH CPU times

​then compare the low CPU pidstat and high CPU  pidstat … what is different

----

With the proper WebSEAL request-log options and pidstat collection … it may help you isolate the problem.



",27/Jun/23 4:55 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] who is the next action on for this Jira item? Are you continuing to investigate this or does L2 need to complete an assessment for this? ,27/Jun/23 11:34 PM;5b17571b91981f4fdde632c1;[~accountid:5b15d9e6dda5f94d06b985b4] can you please review recent requests and any suggested next steps.,"29/Jun/23 1:04 AM;5b17571b91981f4fdde632c1;* No response from 2023/06/22 updates
** Who is your L2 mentor
*** So we can include them in this 
**** [~accountid:6092ac9ff6c0960069d47a67]  [~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b15d9e6dda5f94d06b985b4]",04/Jul/23 10:44 PM;61409dc154762c006932ffc7;[~accountid:5b17571b91981f4fdde632c1] client has requested to close the case for now a things seems  stable.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
CVE-2020-12062 / 2021-28041,ISAMSUP-4852,286606,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,08/Mar/23 11:46 PM,10/Mar/23 8:04 PM,14/Jul/23 2:47 PM,10/Mar/23 8:04 PM,,,,0,,,,"Can you please inform us if ISVA is affected by the below vulnerabilities?

        Service Port	Vulnerability ID		

#    22	           openbsd-openssh-cve-2020-12062
#    22	           openbsd-openssh-cve-2021-28041



ISVA ver 10.0.3



Thanks in advance",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012373156,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,Highrise Technologies,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i199ub:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-03-08 23:06:43.74,,,,,"09/Mar/23 9:06 AM;5b15d8fd6e93913e31e279fb;# openbsd-openssh-cve-2020-12062 - ** DISPUTED * - he vendor points out that ""this attack can achieve no more than a hostile peer is already able to achieve within the scp protocol"" and ""utimes does not fail under normal circumstances."" - [https://nvd.nist.gov/vuln/detail/CVE-2020-12062|https://nvd.nist.gov/vuln/detail/CVE-2020-12062|smart-link] 
# openbsd-openssh-cve-2021-28041 - Not Vulnerable - we do not run ssh-agent on our systems.","10/Mar/23 8:04 PM;614dd52af1c1740068534813;Thanks for the quick response [~accountid:5b15d8fd6e93913e31e279fb] . The customer closed the case, hence closing this JIRA.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unable to edit partners with SHA1 as signature option,ISAMSUP-4850,286505,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,rholman,5bac25a83a6aa22dbebb46cf,rholman,5bac25a83a6aa22dbebb46cf,08/Mar/23 4:19 AM,06/Jul/23 5:16 AM,14/Jul/23 2:47 PM,,,,,0,,,,"When the customer goes to edit a federation partner, if the signature option page shows SHA1 selected, the customer is unable to proceed past that point as the next and finish buttons are greyed out. The customer can change the signature algorithm and the button will become active again. Even if they switch back to SHA1 it stays active after the switch. This does not appear to be an issue in Firefox, but it does exist when using Edge and Chrome. 

While changing the algorithm and changing it back is a workaround, as is using Firefox, the customer wants to have this fixed. This was addressed in another Jira which I will attach to this one. Previously the issue was not resolved as the customer stopped responding. This issue has been reproduced at 10.0.3 and the newest 10.0.5.

Spoke with Annelise about the issue and this is her observation:

The problem appears to be in SAML2_0.js checkPageValid and It is looking for radio buttons SAML2_0SAML2_0*rsa_*sha1_id  and SAML2_0SAML2_0sha1_id to have the value ""checked""  but the page is not setting it to checked it is only setting ariaChecked.
This appears to be something related with how we autogenerate SAML2_0.js from saml20_partner_plugin.xml and a quirk about how dojo is parsing that to be valid.
I think it could be related to the default value set that causes the page to not set the checked attribute properly instead the parser builds a page with the radio button having an attribute {{checked=""checked""}} instead of just {{checked}}  This seems to behave differently in chrome vs FF due to how the two browsers use aria",,David Hayes,khansen,Motiur Rahman,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4183,,,,,,22/Jun/23 1:04 AM;btyler;Screenshot from 2023-06-21 10-01-46.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/207648,,,,,,,,,,,,,,,IJ46183,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012333664,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,rholman,5bac25a83a6aa22dbebb46cf,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-06-08T04:01:02.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1997v:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,ISVA 10.0.3.1,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,2023-03-09 16:36:10.496,,,,,10/Mar/23 2:36 AM;5b15d94b6256d01ad54eb020;That’s a good analysis  by Annelise.   I came to a similar conclusion in my notes from last summer when I was looking into it.  ,"22/Mar/23 11:59 PM;5b15d94b6256d01ad54eb020;Internal comments:

The button is being disabled in the   checkPageValid function in PartnerTabs.js  

 require([templateJsUrl], function(prot){retVal = prot.checkPageValid(newId, doEdit, true);});

Not sure why this works in firefox and not  Chrome.  I discussed with a developer who thinks this is a DoJo  nuance.  So today I’m testing a change  he suggested, which is in a totally different area of the code.   ",23/Mar/23 3:59 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a83a6aa22dbebb46cf] I ran a test on 10.0.3.1 and seems to have worked.  Do you need a fix pack for this? If so for which release?   ,23/Mar/23 10:47 AM;5bac25a83a6aa22dbebb46cf;The customer would like this resolved so a fixpack will be needed. The customer appears to be at 10.0.2.0. I will verify that they are still at that level.,"23/Mar/23 11:32 PM;5bac25a83a6aa22dbebb46cf;Customer update:

Thanks for your feedback. We are at ISAM v10.0.2.0_IF1. We would like to have the fixpack at this level as currently we do not have plan to upgrade. Also, please let us know ISAM version this fix would be available.",23/Mar/23 11:49 PM;5b15d94b6256d01ad54eb020;Do they have any other fix packs?,"24/Mar/23 4:58 AM;5bac25a83a6aa22dbebb46cf;No, the only fixpack is IF1","28/Mar/23 7:09 AM;5b15d94b6256d01ad54eb020;

[~accountid:5bac25a83a6aa22dbebb46cf]  Ross,  please create an APAR and I’ll get changed added to development.

See  [https://cloudidentity.atlassian.net/browse/ISAMSUP-4916|https://cloudidentity.atlassian.net/browse/ISAMSUP-4916|smart-link]  for the fix pack.",29/Mar/23 3:35 AM;5bac25a83a6aa22dbebb46cf;IJ46183 opened for ISVA 10,29/Mar/23 3:39 AM;5b15d94b6256d01ad54eb020;Thanks  [~accountid:5bac25a83a6aa22dbebb46cf] ,30/Mar/23 1:22 AM;5bac25a83a6aa22dbebb46cf;Customer states that installing the fix does not resolve the issue. Are thee other steps that need to be taken such as restarts?,"30/Mar/23 2:58 AM;5b15d94b6256d01ad54eb020;I think the fix pack should have restarted the LMI.  It worked for me so I’ll check to see if I had to anything   else.  Since this is simple to recreate, have you tried it?",31/Mar/23 12:47 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a83a6aa22dbebb46cf]  I just tested the 10.0.2  fix pack and found an error I made which is why it didn’t work.  I’ll fix that and get you a new one.,"31/Mar/23 1:28 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a83a6aa22dbebb46cf]   Ross,  I uploaded a revised version of the fix pack.

[https://ibm.ent.box.com/folder/200775953159|https://ibm.ent.box.com/folder/200775953159|smart-link] ","04/Apr/23 12:24 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 70c870531e823b1cb1ae4a92cd649eb711d904d0
   * description: Merge pull request #5783 from ISAM/ISAMSUP-4850

Update WidgetBase.java

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/74306.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230403142056-70c870531.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","04/Apr/23 1:39 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 70c870531e823b1cb1ae4a92cd649eb711d904d0
   * description: Merge pull request #5783 from ISAM/ISAMSUP-4850

Update WidgetBase.java

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/74390.


This build has not been published as the commit is not currently within a branch (20230403142056-70c870531) which we publish.",03/May/23 2:08 AM;5b15d901fa615349cb01778b;moving to L3 to complete the APAR process,"03/May/23 2:12 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d901fa615349cb01778b]  Kathy, there is nothing left for me to do regrading the APAR.  It was with L2 waiting for feedback from the customer.  I personally tested it and the code change worked for me.    Is it okay to close?",04/May/23 3:41 AM;5bac25a83a6aa22dbebb46cf;Customer has been unable to install the fixpack on their system. I am trying to determine why it may not be installing.,"07/Jun/23 2:04 AM;5bac25a83a6aa22dbebb46cf;I have just set up a new 10.0.2.0 install and installed IF1. After activating the federation module, I have been able to install the fix. I did a screenshare with the customer and he gets the error that the fixpack install failed or a system error occurred. I look at the fixpack logs and it shows his fix was installed, but he is still seeing the buttons greyed out at the signature algorithm page. I am not sure what is different in my environment vs theirs. Customer did have 1 other fix and wasn’t sure if it was affecting the fix.

FIX_EXCESSIVE_INACTIVE_THREADS_V1

Customer has uploaded a support file from after his install attempt that I watched. It appears to show successfully installed in his log but the issue persists. I am not sure what may be going on.",07/Jun/23 2:17 AM;5b15d94b6256d01ad54eb020;Thanks for the update Ross.   I’ll take a look at the support file.  It could be that the two fix packs conflict with each other.  If so I’ll have to build one that incorporates both fixes.,"07/Jun/23 2:27 AM;5b15d94b6256d01ad54eb020;He has one called:   partner_edit_fix_1020-DUP1 (1)

This one failed  with “Failed to verify signature”   probably because of the name.  For some reason he has two fixpacks. 

Then he installed another one:

Jun  6 07:15:13 mesa_install_fixpack: partner_edit_fix_1020 install successful
Jun  6 07:15:13 mesa_control[14673]: Fixpack /tmp/fixpacktmpdir/partner_edit_fix_1020.fixpack: install successful



The other fix pack is rgy_inactive_thread_1020_IF1_v2.  Both  update mga.ear  so that may be what is causing the problem.

I wrote both fix packs so I can put together another one that combines them and that should solve the issue.","07/Jun/23 3:54 AM;5bac25a83a6aa22dbebb46cf;When we were on the screenshare I saw the fixpack install failed so I had him remove the -DUP1(1) part of the name. We then tried the install again and it gave a generic system failure error, but the fix seemed to install after changing the name, but the functionality wasn’t there","07/Jun/23 6:55 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a83a6aa22dbebb46cf]  I’ll build a combined fix pack so we can be sure.  It needs to be done anyway, or else one of the problems would return unless both fixes are in there.",08/Jun/23 5:42 AM;5b15d94b6256d01ad54eb020;I updated sub task [https://cloudidentity.atlassian.net/browse/ISAMSUP-4916|https://cloudidentity.atlassian.net/browse/ISAMSUP-4916|smart-link] with a link to the new fix pack.,"09/Jun/23 2:44 AM;5bac25a83a6aa22dbebb46cf;Customer update:
I tried to install the latest fixpack, however, I am getting the similar behavior as earlier fixpack:

# Got the error ""System Error An unknown error occurred."" when installing the fixpack.
# After sometime when I went to Fixpacks page, I see that the console says that the fixpack is installed.
# The issue with Partner Edit still persist.","09/Jun/23 2:55 AM;5b15d94b6256d01ad54eb020;That is strange.  Only thing I can think is that an old ear files are being used in stead of  the  new one.   Liberty caches them.

Did they send in a new support file?  ",09/Jun/23 3:19 AM;5bac25a83a6aa22dbebb46cf;I have requested a new support file along with confirmation that the other issue was fixed by the fixpack and just this federation issue still exists,09/Jun/23 3:21 AM;5b15d94b6256d01ad54eb020;I think we need to clear the liberty cache.   I don’t know why they get installation errors though.,09/Jun/23 5:28 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a83a6aa22dbebb46cf]  I noticed the new support file came in.  Looking at the ls.txt  file and the install.log I didn’t see any issues.  It looks like the  two ear files were correctly updated.  I’ll recheck the fix pack to make sure  I didn’t make a mistake when I built it. This is strange that they are having a problem like this.,09/Jun/23 6:00 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a83a6aa22dbebb46cf] I installed the fix pack and checked that the files were replaced. Rebooted for good measure and tested the ‘Next’ button.  It works for me.,09/Jun/23 8:04 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a83a6aa22dbebb46cf] The only other thing I can think of is maybe he needs to clear his browser cache.  This really should be working now. can you check with them and see if that helps?,"10/Jun/23 3:11 AM;5bac25a83a6aa22dbebb46cf;Yeah, I don’t know why the error is occurring either. I will recommend that they clear their cache and retry.","10/Jun/23 5:16 AM;5bac25a83a6aa22dbebb46cf;Looks like clearing the cache didn’t make a difference:
I tried to install the fixpack after clearing the browser cookies, however, I still get the same behavior.

Did we find anything is the support file provided yesterday?

Is there a way to enable additional logging on ISAM server to get more information on the issue, rather then trying to install the same fixpack multiple times ?","10/Jun/23 5:41 AM;5b15d94b6256d01ad54eb020;The fix is in javascript which runs in the browser so the server logging won’t help.

I checked the ls.txt file yesterday  the two from the patch were installed correctly.

{noformat}lrwxrwxrwx    1 root     root            58 Nov 10  2021 wga.ear -> /opt/IBM/wlp/usr/servers/default/dropins.disabled//wga.ear
-rw-r--r--    1 www-data www-data  10851980 Jun  8 08:27 wga.ear
lrwxrwxrwx    1 root     root            58 Nov 10  2021 mga.ear -> /opt/IBM/wlp/usr/servers/default/dropins.disabled//mga.ear
-rw-r--r--    1 www-data www-data  21062523 Jun  8 08:27 mga.ear
{noformat}



I’ll ask one of the developers who works in this area about it to see if they have any ideas.",13/Jun/23 6:01 AM;5b15d94b6256d01ad54eb020;Was the latest  support file taken just after the fix pack was installed or was taken after they tried test the button?   I’m asking because I don’t see  mga or wga  expanded.   You should see   /opt/ibm/wlp/servers/runtime/apps/expanded/mga.ear/  and    /opt/ibm/wlp/servers/runtime/apps/expanded/wga.ear/  ,"14/Jun/23 1:37 AM;5b15d94b6256d01ad54eb020;I asked one of our developers if he had any ideas on what could be going on.  His suggestion was to have them send in the js files they are using.   Also clear history in additon to cache.   Check the browser version.     His version was    Chrome Version 114.0.5735.106.   My browser is:    Chrome  Version 113.0.5672.126   but I also tried firefox  102.10.0esr.   Both of my browsers worked.

To get the  js files you have to use the developer tools. I’m reluctant to ask them to do that because they may not be familiar with that process.   The file we want to see is   SAML2_0.js  ( there are two  of those, one for federation and one for partner)   get both.

[~accountid:5bac25a83a6aa22dbebb46cf]  We could try having them   clear history and cache again first. If that doesn’t work try the deve tools.  What do you think?   Is that something they could handle?","14/Jun/23 2:28 AM;5bac25a83a6aa22dbebb46cf;Thanks for the update. This should be something that they can handle. I will ask when exactly the support file we have was taken. As far as getting the js files through developer tools, you mean just doing the tracing in the browser via the network tracing tool correct? I believe that will show the js pages being sent.","14/Jun/23 3:21 AM;5b15d94b6256d01ad54eb020;You just bring up the developer tools and then navigate to the partner page as usual.   In chrome’s dev tools,  you go to Sources, thren in left panel,  go to mga/views/tfim/extension/partners  and look for the file name.  Try first on yours and I’ll help you if you have trouble.","20/Jun/23 2:06 AM;5bac25a83a6aa22dbebb46cf;Customer update:
One interesting change in behavior after trying to install the fixpack today:

After uninstalling the fixpack, I was not able to access the federation component on ISAM console. Attached is the error I was getting. I installed the fixpack again (with similar error and behavior) and I was able to access the federation component. Does uninstalling the fixpack, causes issue while accessing the federation component ?

I was able to get a har file from the customer, but opening it up, I don’t really see any data. I think i’ll have to walk him through gathering the javascript file. Let me know if you get a minute to show me exactly what you want to make sure i’m getting the right thing. Thanks","20/Jun/23 3:35 AM;5bac25a83a6aa22dbebb46cf;Customer Update:

I was able to access federation module before installing the fix. After installing the fix, I was able to access the federation module too. However, I was not able to access the federation module after uninstalling the fixpack. After re-installing the fixpack, I was able to access the federation module again. So, it seems to be, that uninstalling the fixpack caused some issue with the federation module.

Note that federation module is already active on the ISAM appliance.",20/Jun/23 5:13 AM;5b15d94b6256d01ad54eb020;It should restart the runtime after the installation. If you roll it back you probably need to manually restart the LMI and runtime.,"22/Jun/23 1:05 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a83a6aa22dbebb46cf]   Ross,  I attached a screen shot of where to find the javscript file using firefox.  Chrome is similar.   Ignore the line numbers those don’t matter.   I just want to confirm it was updated.",29/Jun/23 12:37 AM;5bac25a83a6aa22dbebb46cf;Customer has uploaded the JS file to ecurep ,06/Jul/23 3:58 AM;5b15d94b6256d01ad54eb020;The changes are in the  JS file so it ought to work.   What browser  are they using?  Which version?,"06/Jul/23 4:43 AM;5bac25a83a6aa22dbebb46cf;Please see below:

Google Chrome

Version 114.0.5735.199 (Official Build) (64-bit)",06/Jul/23 5:16 AM;5b15d94b6256d01ad54eb020;That’s newer than mine.  I would have expected an older version to still have trouble.  I’ll see if I can get that and retest.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
HPDCF0178E because of ssl-compliance is not set,ISAMSUP-4845,286171,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Virag Patel,5b17571a82e05b22cc7d5d9e,Virag Patel,5b17571a82e05b22cc7d5d9e,07/Mar/23 1:31 AM,28/Apr/23 11:33 AM,14/Jul/23 2:47 PM,28/Apr/23 11:33 AM,,Support,,0,,,,"customer is reporting below error

[https://www.ibm.com/docs/en/sva/8.0.0.2?topic=messages-hpdcf0178e|https://www.ibm.com/docs/en/sva/8.0.0.2?topic=messages-hpdcf0178e|smart-link] 

HPDCF0178E

 The compliance entry, ssl-compliance in the ssl stanza, is not set in the Security Access Manager Runtime configuration file pd.conf.

h4. Explanation

 Under typical configuration conditions, this value is always set in pd.conf. If the value is unset, then ssl-compliance has a default value of 'none'.

h4. Administrator response

 Make sure that the ssl-compliance entry is set in pd.conf or reconfigure the Security Access Manager Runtime.



the policy directory log file shows above error very frequently which customer would like to fix it.



the pd.conf has

ssl-compliance =



as per the default configurationl it should be

ssl-compliance = none



customer does not know how it went to unset state and tried to edit he parameter but gave below error

Error: DPWAP0028E The 'ssl-compliance' configuration entry, in the [ssl] stanza, is a read only configuration entry and should not be modified.



So can only be fixed by unconfiguring and the reconfiguring Policy Director. This will blow away the Policy Director environment. Issue is ssl-compliance = none is the default. Which is what we want. So the entry should not be required. So this is a bogus or at least unnecessary Error. Looking at removal of this error. It is clogging our log files.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012140893,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Virag Patel,5b17571a82e05b22cc7d5d9e,,,,DEPT OF HEALTH,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,S:\sf\TS012\140\TS012140893\2023-03-05\,,,,,,,,,,,,,,,,,,,,,,,0|i1975n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-07 00:54:32.347,,,,,"07/Mar/23 1:32 AM;5b17571a82e05b22cc7d5d9e;/ecurep/sf/TS012/140/TS012140893/2023-03-05/isva_10.0.4.0_20230306-090859_p03939.eb.dhs.vic.gov.au.support_unpack/var/PolicyDirector/log/msg__pdmgrd.log

shows the high frequency of the same error which customer would like to fix it","07/Mar/23 10:54 AM;5b15d9517dab4c51f61b5190;There is a fixpack in [https://cloudidentity.atlassian.net/browse/ISAMSUP-2906|https://cloudidentity.atlassian.net/browse/ISAMSUP-2906|smart-link] that sets it to none

Should work on 10.0.4.0 - but haven’t tried it",07/Mar/23 1:28 PM;5b17571a82e05b22cc7d5d9e;so customer just need to apply on main primary master and it should replicate the changes to rest of members. is tht correct?,07/Mar/23 2:09 PM;5b17571a82e05b22cc7d5d9e;i will request customer to verify it in lower env first..thanks,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Infomap Mapping rules disappear after upgrading from 10.0.0.0 to 10.0.2 or 10.0.4,ISAMSUP-4826,285720,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Gabe,5b15d99b4c20165700edecad,Gabe,5b15d99b4c20165700edecad,03/Mar/23 6:44 AM,13/Apr/23 10:30 AM,14/Jul/23 2:47 PM,13/Apr/23 10:30 AM,,,,0,,,,"This customer is currently using ISVA 10.0.0.0 but is in the process of upgrading their lower environments. Initially they upgraded to 10.0.4.0 but noticed an issue with their Infomap authenticators. In the LMI all of the Infomaps no longer have mapping rules. To fix this they switched back to the 10.0.0.0 partition and the Infomaps appeared as normal in the LMI. 

Next try tried 10.0.1.0 no issues there with the Infomaps. Then going to 10.0.2.0 they found that the Infomap rules disappeared again just like 10.0.4.0 so this is where something changed. 

Not only do the mapping rules not appear in the Infomap authenticators but the also do not appear in under the mapping rules. This seems to be the source. 

The LMI logs show the following error. 
[3/1/23 6:33:59:187 EST] 00000028 ty.access.managed.resources.mapping.rules.MappingRuleManager I Input file[InfoMap_ISIMTest.js] doesn't exist


I’ve tried to create this scenario by creating an Infomap authenticator with their js rule then upgrading to 10.0.2 and 10.0.0.4 but I don’t have the same issue. The only way I was able to get the LMI error above was to rename the mapping rule under /var/isam.staging/admin/itfim/amapp-runtime/mapping-rules/. Once the rule wasn’t there the LMI returned the “doesn’t exist” message. 

[3/1/23 14:52:37:227 EST] 00000046 id=00000000 ty.access.managed.resources.mapping.rules.MappingRuleManager > getFilePath ENTRY (id[102] name[ISIMTest] fileName[InfoMap_ISIMTest.js] category[InfoMap] predefined[false] domain[amapp-runtime]

[3/1/23 14:52:37:228 EST] 00000046 id=00000000 ty.access.managed.resources.mapping.rules.MappingRuleManager > getFileContent ENTRY /var/isam.staging/admin/itfim/amapp-runtime/mapping-rules/InfoMap_ISIMTest.js

[3/1/23 14:52:37:228 EST] 00000046 id=00000000 ty.access.managed.resources.mapping.rules.MappingRuleManager I getFileContent Input file[InfoMap_ISIMTest.js] doesn't exist

This seems to be related because they don’t have a  /var/isam.staging/admin/itfim/* directory on the appliance. According to the ls.txt the mapping rules only exist under /var/itfim/amapp-runtime/mapping-rules. 

This customer is using an external Config database so the issue seems to be related to the appliance itself. Any idea why the _isam.staging_ directory wouldn’t exist? I haven’t seen any cases or Jira with this issue. ",,David Hayes,khansen,Motiur Rahman,Nick Lloyd,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ45894,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012292158,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Gabe,5b15d99b4c20165700edecad,,,,FBI,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"10.0.4 Support File

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012292158&path=TS012292158%2F2023-03-03%2Fisva_10.0.4.0_20230228-080944_BROKEN.support_unpack%2F",,,,,,,,,,,,,,,,,,,,,,,0|i194eb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,ISVA 10.0.4.0,,,,,,,,,,,,2023-03-09 07:47:33.862,,,,,"06/Mar/23 6:27 AM;5b15d99b4c20165700edecad;Something else the customer noticed was the permissions on the Info map rules were different than other rules. 

/sqlfuse/cache/var/itfim/amapp-runtime/mapping-rules:
total 408
drwxrwx---    2 www-data www-data      4096 Feb 23 11:44 .
drwxrwxr-x    5 root     root          4096 Mar 29  2021 ..
..
-rw-rw----    1 www-data www-data      3742 Mar 29  2021 FAPI_ValidateJWT_RequestJWT.js
-rw-r-----    1 ivmgr    ivmgr         4424 Feb 27 11:35 *InfoMap_ISIMTest.js*

I rooted a 10.0.4 appliance and set the same permissions but it didn’t seem to create an issue. ","08/Mar/23 2:39 AM;5b15d99b4c20165700edecad;Something that I think might be the key to this is they are using the Cluster Config DB option 
“Use external database for internal file sharing”.  I’m thinking a change to how that code manages theses files is the cause. 

The mapping rules are on the filesystem yet the LMI can’t locate them. 

This ls would have been captured a few minutes after the LMI error. 
/sqlfuse/cache/var/itfim/amapp-runtime/mapping-rules:
-rw-r-----    1 ivmgr    ivmgr         4424 Feb 27 11:35 InfoMap_ISIMTest.js
-rw-r-----    1 ivmgr    ivmgr         1906 Jan 11 08:11 InfoMap_echeck_redirect.js

[2/28/23, 8:06:24:718 EST] 00000043 id=00000000 ty.access.managed.resources.mapping.rules.MappingRuleManager I getFileContent Input file[InfoMap_echeck_redirect.js] doesn't exist
[2/28/23, 8:06:24:719 EST] 00000043 id=00000000 ty.access.managed.resources.mapping.rules.MappingRuleManager I getFileContent Input file[InfoMap_ISIMTest.js] doesn't exist",09/Mar/23 5:47 PM;5b15d954b0d76456f36daf33;[~accountid:5b15d99b4c20165700edecad] I did notice that sqlfuse was in use. Have you made any attempt to recreate the problem locally?,"10/Mar/23 3:43 AM;5b15d99b4c20165700edecad;I have not been able to recreate this issue locally but I am seeing differences between my environment and the customers. 


What I did was install a fresh 10.0.0.0. 
Connected it to an external DB2 database with “Use external database for internal file sharing” enabled. This included creating the tables necessary for an config DB. 
I then created a Infomap JavaScript rule based on his example ISIMTest.js

So far this all worked fine. I could see the mapping rule in the LMI. 

I then upgraded to 10.0.2.0 and afterward still no issues with the mapping rule in the LMI. 

Using this trace in the LMI com.ibm.security.access.managed.resources.mapping.*=ALL I can see where the LMI is looking for the mapping rule. 



[3/9/23 12:26:27:587 EST] 0000003e id=00000000 ty.access.managed.resources.mapping.rules.MappingRuleManager > getFilePath ENTRY (id[1] name[ISIMTest] fileName[InfoMap_ISIMTest.js] category[InfoMap] predefined[false] domain[amapp-runtime]

[3/9/23 12:26:27:587 EST] 0000003e id=00000000 ty.access.managed.resources.mapping.rules.MappingRuleManager > getFilePath(String,String) ENTRY InfoMap_ISIMTest.js amapp-runtime

[3/9/23 12:26:27:670 EST] 0000003e id=00000000 ty.access.managed.resources.mapping.rules.MappingRuleManager < getFilePath(String,String) RETURN /*var/isam.staging/admin/itfim/amapp-runtime/mapping-rules/InfoMap_ISIMTest.js*

[3/9/23 12:26:27:670 EST] 0000003e id=00000000 ty.access.managed.resources.mapping.rules.MappingRuleManager < getFilePath RETURN /var/isam.staging/admin/itfim/amapp-runtime/mapping-rules/InfoMap_ISIMTest.js

From my ls.txt the mapping rule is located in both the “isam.staging” and “sqlfuse” directories where the customer does not have a “isam.staging” directory. 
/var/isam.staging/admin/itfim/amapp-runtime/mapping-rules:
-rw-r-----    1 ivmgr    ivmgr         4344 Mar  1 13:28 InfoMap_ISIMTest.js

/sqlfuse/fs/var/itfim/amapp-runtime/mapping-rules:
-rw-r-----    1 www-data www-data      4344 Mar  1 13:28 InfoMap_ISIMTest.js

What's interesting is if I delete the rule from “isam.staging” then restart the LMI it gets recreated again in that directory. So the issue seems to be the lack of the “isam.staging” directory. ","10/Mar/23 4:55 AM;5b15d99b4c20165700edecad;There definitely seem to be some differences with sqlfuse in 10.0.2.0. For instance my /var/isam.staging"" directory has some links to sqlfuse dir that were not in 10.0.0.0 or 10.0.1.0.",15/Mar/23 3:34 AM;5b15d99b4c20165700edecad;I have a feeling recreating the “/var/isam.staging” not be easy If that is indeed the cause. ,15/Mar/23 10:53 AM;5b15d954b0d76456f36daf33;The {{isam.staging}} directory is automatically created in anticipation to house any user specific pending changes. I’m not sure how that fits in with the problem reported.,15/Mar/23 10:09 PM;5b15d99b4c20165700edecad;Are you able to tell where the LMI is attempting to load the SQL files from? I was only able recreate the mapping rule doesn’t exist by deleting the files from “isam.staging”. ,17/Mar/23 6:31 AM;5b15d99b4c20165700edecad;FYI this one is getting a little hot.,"17/Mar/23 9:33 AM;5b15d954b0d76456f36daf33;Since both their dbs are external, I’m assuming after upgrading to 10.0.4.0 they ran the db schema upgrade tool?

I’m going to check if we need to do any special migration for data on sqlfuse vs regular on an upgrade.

Are they actually in need of the sqlfuse system? Or is turning that off an option for them? ","17/Mar/23 12:54 PM;5b15d954b0d76456f36daf33;I was able to recreate the problem.

The LMI edit  / create of the mapping rules does not work with sqlfuse currently.

The way look up works is we get the name of the mapping rule from the config db and then look for it in a predefined path: {{/var/itfim/amapp-runtime/mapping-rules/}}

But when that option to {{Use external database for internal file sharing}} is selected, the files to go to an alternate location: {{/sqlfuse/cache/var/itfim/amapp-runtime/mapping-rules}}

I don’t know if there is any easy way to fix it. But you should create an APAR anyway.

In the short term:

* Before upgrade if they were to get rid of that option in the cluster config page, the upgrade should preserve their edits to existing mapping rules and any custom rules.
* After upgrade, if they uncheck that option, they will be able to re-edit / recreate the rules.","18/Mar/23 2:40 AM;5c87cb8d88f9ec6ae0afb306;APAR IJ45894 has been created. 

I informed the customer of your workaround. 

Can you please clarify the following: 


In the short term:

* Before upgrade if they were to get rid of that option in the cluster config page, the upgrade should preserve their edits to existing mapping rules and any custom rules.
* *After upgrade, if they uncheck that option,* they will be able to re-edit / recreate the rules.

Since the steps indicate to “get rid of that option” before the upgrade, should the “check that option” after upgrade?  

",18/Mar/23 3:46 AM;5c87cb8d88f9ec6ae0afb306;The client was able to upgrade using the work-around.  All of their data was intact. ,21/Mar/23 12:08 AM;5c87cb8d88f9ec6ae0afb306;The SF case has been closed.  The customer is fine with the workaround.  ,"11/Apr/23 8:38 AM;5b15d954b0d76456f36daf33;[~accountid:5c87cb8d88f9ec6ae0afb306] [~accountid:5b15d99b4c20165700edecad] 

I’ve looked at what is potentially needed to address this issue. There seems to be a large effort involved (not so much for implementation, but for testing). This is in the clustering part of the appliance, not to mention mapping rules etc for the AAC/Federation. Which means any regressions will be detrimental over the benefits of fixing this.

Given the customer’s issue is resolved, (and there is an easy workaround) I’m inclined to close the APAR as no plans to fix. Do either of you have any objection to that?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Reverse Proxy Hostname Resolution Cache Fix compatibility with 10.0.1.0 IF1,ISAMSUP-4819,284914,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,28/Feb/23 12:42 PM,27/Mar/23 10:17 AM,14/Jul/23 2:47 PM,27/Mar/23 10:17 AM,,,,0,,,,"This is for the same customer using Reverse Proxy Hostname Resolution Cache Fix

mentioned here:

[https://cloudidentity.atlassian.net/browse/ISAMSUP-2265|https://cloudidentity.atlassian.net/browse/ISAMSUP-2265|smart-link]

 

The customer is at 10.0.1.0 and there is critical fix in 10.0.1.0 IF1 which is 



[https://www.ibm.com/support/pages/apar-information-ibm-security-verify-access-10010-if1|https://www.ibm.com/support/pages/apar-information-ibm-security-verify-access-10010-if1|smart-link] 



IJ29361

TFIM STREAMING ERROR WHEN RESPONSE SIZE NEAR 16KB AND NOT CHUNKED





Customer just would like to apply the IF1 on reverse proxy appliance( as they have long time plan to go to 1031 but at minimum they would like current issue resolved)



Customer has below list of custom fixex



{noformat}wt_request_scope_precede_10010 fixed in 1031

Reverse_Proxy_Hostname_Resolution_Cache_Fix.  -> fixed in 10.0.3.0

DynClients_AllowHybrid_10010 -> fixed in 10.0.2.0

JWT_PS256_Support_10010. -> fixed in 10.0.2.0

aac_responsetype_as_stringarr_10010. -> 10.0.2.0

jwt_client_assertion_customexception_v6_10010. —> fixed in 1031{noformat}



out of which they would only like to apply 10.0.1.0 IF1 on reverse proxy(without touching federation appliances) . they confirmed they don’t have any federation flows being used from reverse proxy appliances.



from their fix list I only see {{Reverse_Proxy_Hostname_Resolution_Cache_Fix}} has reverse proxy fix.

which is why , how customer can proceed to apply IF1 and get to keep {{Reverse_Proxy_Hostname_Resolution_Cache_Fix}}



The plan for them is 



1.since they don’t use federation on reverse proxy appliances

only apply 10.0.1.0 IF1 on reverse proxy appliances",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012156383,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,AMP,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18zk3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-02-28 06:13:46.093,,,,,"28/Feb/23 4:13 PM;5b15d9517dab4c51f61b5190;IJ29361 updates /opt/IBM/Tivoli/SecUtilities/lib/libtivsec_axis_xmlparser.so

IJ31242 updates /opt/ibm/Tivoli/SecUtilities/lib/libtivsec_http_channel.so

So they should be compatible

Need to check if 10.0.1.0 IF1 updates /opt/ibm/Tivoli/SecUtilities/lib/libtivsec_http_channel.so","28/Feb/23 4:44 PM;5b15d9517dab4c51f61b5190;[~accountid:5c53d3ac23f5bf672621c868] 

I checked 10.0.1.0 IF1 

It does update /opt/ibm/Tivoli/SecUtilities/lib/libtivsec_http_channel.so because of IJ38050

IJ38050 was superceded by IJ31716

But both of them were superceded by IJ29361

So because IJ29361 solves the issues that both IJ38050 and IJ31716 tried to solve I think we are OK.

The only issue is that because 10.0.1.0 IF1 updates /opt/ibm/Tivoli/SecUtilities/lib/libtivsec_http_channel.so

the {{Reverse_Proxy_Hostname_Resolution_Cache_Fix}} will need to be reapplied after 10.0.1.0 IF1","28/Feb/23 5:54 PM;5c53d3ac23f5bf672621c868;thanks [~accountid:5b15d9517dab4c51f61b5190] 



I am negotiating with customer to upgrade.

please hold on to this.

at this point I don’t need any fix. if customer insists then I will come back to this jira","17/Mar/23 11:48 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9517dab4c51f61b5190] 

some confirmation is needed

as per [https://www.ibm.com/support/pages/node/6516988|https://www.ibm.com/support/pages/node/6516988|smart-link] 

[+IJ31242+|https://www.ibm.com/support/pages/apar/IJ31242] is fixed which means {{Reverse_Proxy_Hostname_Resolution_Cache_Fix}} is fixed in 10.0.3.0 onwards

I am not sure and can’t locate, somewhere I read {{Reverse_Proxy_Hostname_Resolution_Cache_Fix}} is fixed in 10.0.6.0 ( although I am not able to locate that resource again)","17/Mar/23 2:28 PM;5b15d9517dab4c51f61b5190;[~accountid:5c53d3ac23f5bf672621c868] 

I can confirm IJ31242 was fixed in 10.0.3.0 and so is fixed in all later versions (and has been backported to 9.0.7.2)

The only current name resolution issue I know of is the kerberos issue in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4848|https://cloudidentity.atlassian.net/browse/ISAMSUP-4848|smart-link] 

The reverse proxy only uses name resolution in a few places

To resolve junction host names (caching is controlled by the dynamic-addresses-ttl setting) - no known issues

To resolve host names for soap requests (TFIM,DSC, etc ) which IJ31242 was the last issue fixed and no current issues

for other servers (ldap,policy server) - no known issues","17/Mar/23 3:40 PM;5c53d3ac23f5bf672621c868;Thanks [~accountid:5b15d9517dab4c51f61b5190] 



this addresses the question.

I am waiting for customers response as they would like to go to 10.0.4.0",27/Mar/23 10:17 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"Issuing security tokens using STS stopped to work after update from ISVA 10,0,4 to 10.0.5",ISAMSUP-4817,284678,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,27/Feb/23 10:17 AM,15/Mar/23 1:41 AM,14/Jul/23 2:47 PM,15/Mar/23 1:41 AM,10.0.6,,,0,,,,"After ISVA upgrade ISVA 10,0,4 to 10.0.5 issuing Ws-Trust security tokens using STS stopped to work for one (and only) client/application that is using this functionality. 

When STS is called using SOAP-UA tokens are still issued. Two active appliances was present on environment when testing had been performed: 1 WebSEAL instance 1 AAC/FED server. It had been observed during troubleshooting that requests send by client (OSB) are not delivered (or not processed at all as there are no logs) by appliances running STS/AAC/FED.



We got an e-mail from Scott Exton asking to forwarding this issue onto the L3 team. 

 [~accountid:5b15d9517dab4c51f61b5190]  cc’ed , which was responsible for the improvement in the validation of the HTTP message (the change in behaviour was introduced by the following pull request: [https://github.ibm.com/ISAM/isam/commit/9299dd1e16b6e91cd9eac8c1f04544eea561f47c#diff-560c5ccf76a21f739ae09c3f510024dfc09c2b51c0dfdf2febd0d176b4ed4767|https://github.ibm.com/ISAM/isam/commit/9299dd1e16b6e91cd9eac8c1f04544eea561f47c#diff-560c5ccf76a21f739ae09c3f510024dfc09c2b51c0dfdf2febd0d176b4ed4767]).

 

Scott Exton informed: 
The fix is pretty simple.  In the past we allowed the terminating chunk to have preceding zeros (e.g. ‘0000’).  With the most recent changes this is now returned as an error.  The fix would be to allow and handle a chunk size of ‘0’ within PeekInChunkedStream.cpp (line 483).",,BRIANORO,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,Virag Patel,,,,,,,,,6154906364ff01007106e189,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4827,,,,,,,,,,,,,,,,,IJ45614,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012156345,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,NORDEA BANK AB,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2023-03-02T14:23:45.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":5,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18y4b:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-28 01:53:27.441,,,,,"28/Feb/23 11:53 AM;5b15d9517dab4c51f61b5190;This issue effects both chunked requests and responses

Can you please open an APAR “Reverse proxy allow terminating chunk to have preceding zeros”","28/Feb/23 1:14 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ec2ddccf3697525f63244728ab82b5a279e91c91
   * description: ISAMSUP-4817 allow terminating chunk to have preceding zeros

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85639992.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4817) which we publish.",28/Feb/23 6:11 PM;614dd52af1c1740068534813;[~accountid:5b15d9517dab4c51f61b5190] Apar created: IJ45614. Thanks,"02/Mar/23 12:47 PM;5b15d9517dab4c51f61b5190;[~accountid:614dd52af1c1740068534813] 

IJ45614 didn’t solve the issue in reproduction environment.

We have found a solution in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4806|https://cloudidentity.atlassian.net/browse/ISAMSUP-4806|smart-link] and are working on the fix","02/Mar/23 3:41 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 9c70a5f680b028f4a01d7dc98c4635cf7b46495b
   * description: Merge pull request #5718 from ISAM/ISAMSUP-4817

ISAMSUP-4817 IJ45614 allow terminating chunk to have preceding zeros

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85843186.


This build has not been published as the commit is not currently within a branch (20230302042050-9c70a5f6) which we publish.","03/Mar/23 10:10 AM;5b15d9517dab4c51f61b5190;[~accountid:614dd52af1c1740068534813] 

Fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4827|https://cloudidentity.atlassian.net/browse/ISAMSUP-4827|smart-link] 

It includes fix for IJ45614","15/Mar/23 1:41 AM;614dd52af1c1740068534813;Customer response:

There had not been need to install fixpack at the end as we was able to convince application/client that they should fix issue with incorrect last chunk from their side.

Thank you very much for delivering fixpack! We kept it as last resort during ISVA upgrade (that caused ISVA to correctly validate last chunk).",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
SSL replication during cluster upgrade from ISAM 9.0.7.2 to ISVA 10.0.5.0,ISAMSUP-4816,284635,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,25/Feb/23 2:22 AM,04/Mar/23 9:05 AM,14/Jul/23 2:47 PM,04/Mar/23 9:05 AM,10.0.6,Support,27/Feb/23 12:00 AM,0,,,,"Customer encountered this issue upgrading from ISAM 9.0.7.2 to ISVA 10.0.5.0 in their Dev and Test environments. Customer is asking is there a similar fix in 10.0.5.0 for APAR IJ37117, which addresses this issue. Looking at the “APAR Fixes.xlsx” file on [BOX|https://ibm.box.com/s/kovb3zikgjxf2d1003zadrdqdqs6erq6], see APAR IJ37117 is listed in both 10.0.4.0 and 10.0.3.1.
Looking at the release notes for same ISVA releases, APAR IJ37117 is only mentioned in 10.0.3.1.
Correct to assume APAR IJ37117 is rolled up into 10.0.5.0?
If so, why did customer experience this issue upgrading ISAM 9.0.7.2 to ISVA 10.0.5.0? 
Also please advise best response to customers query i.e.
” We will test the ""workaround"" of disabling the cert replication with an upgrade again on our Dev environment. I assume that if this is another manifestation of IJ37117 and that there is an intention to provide a fix? “",,Dermot Daly,gvacek,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5c87cb8d88f9ec6ae0afb306,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ45645,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012231776,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,Clydesdale Bank,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-03-02T11:09:56.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012231776&path=TS012231776%2F2023-02-23%2F,,,,,,,,,Linux 86_64,,,,,,,,,,,,,,0|i18xvf:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-26 23:53:29.832,,,,,"27/Feb/23 9:53 AM;5b15d954b0d76456f36daf33;_>> Correct to assume APAR IJ37117 is rolled up into 10.0.5.0?_

Yes the fix would be in all releases starting 10.0.3.1

_>> We will test the ""workaround"" of disabling the cert replication with an upgrade again on our Dev environment. I assume that if this is another manifestation of IJ37117 and that there is an intention to provide a fix?_

Have we actually validated that this is the same problem as in IJ37117?

Prior to that fix, the kdb files would be removed from non-upgraded nodes and only p12 files replicated. This as expected would cause problems on those nodes at a version that don’t understand the p12 format. (which is basically IJ37117)

In a clustered environment with SSL replication enabled, the fix will ensure we won’t delete the .kdb file.  The .kdb file will however be deleted when the keyfile is next updated.  This means that a customer’s environment will continue to function - until they decide to update a key file.  However, by this time they should have upgraded all of the nodes in the cluster.

Looking at their support files for {{vapamwt201-b}} and {{vapwslt205-b}} I see that they have both p12 and kdb files. That is as expected. 

What is the actual error they are experiencing? And is it on an upgraded 10.0.5.0 node or one of the 9.0.7.2 nodes? That is, have they upgraded all the nodes in the cluster or running in a mixed environment?","27/Feb/23 11:56 PM;5c87cb8d88f9ec6ae0afb306;Hi Bhavan, 


Sorry about the confusion on IJ37117.  That is my fault.  I didn’t realize it fixed a missing .kdb issue.  That obviously is not the issue here, as both the .kdb and .p12 files exit.

The issue is that the client is seeing is that the WRPs won’t start after the upgrade.  

The error that they are seeing is: 
2023-02-23-15:39:29.968+00:00I----- 0x38AD54BA webseald WARNING wiv ssl SSLConnection.cpp 1086 0x7f748ce0a840 -- DPWIV1210W Function call, gsk_environment_init, failed error: 0000000a GSK_ERROR_ASN.

Because of this, I went to look at the .kdb files.  What I am finding is that I cannot view the certs in the .kdb files, but I can view the certs in the .p12 files. 

On ecurep: 
[125:gvacek@ecurep]:/ecurep/sf/TS012/231/TS012231776/2023-02-23/isam_9.0.7.2_20230223-154000_vapwslt205-b.support_unpack/var/pdweb/shared/keytab $ *gsk8capicmd_64 -cert -list -db pdsrv.kdb -stashed*
CTGSK3026W The key file ""pdsrv.kdb"" does not exist or cannot be read.
CTGSK2001W Unknown error occurred

[125:gvacek@ecurep]:/ecurep/sf/TS012/231/TS012231776/2023-02-23/isam_9.0.7.2_20230223-154000_vapwslt205-b.support_unpack/var/pdweb/shared/keytab $ *gsk8capicmd_64 -cert -list -db pdsrv.p12 -stashed*
Certificates found

* default, - personal, ! trusted, # secret key
!       ""[http://Entrust.net|http://Entrust.net|smart-link]  Certification Authority (2048) 29""
!       ""Entrust Root Certification Authority - EC1""
!       ""Entrust Root Certification Authority - EV""
!       ""Entrust Root Certification Authority - G2""
!       ""VeriSign Class 1 Public Primary Certification Authority""
!       ""VeriSign Class 2 Public Primary Certification Authority""
!       ""VeriSign Class 3 Public Primary Certification Authority""
!       ""VeriSign Class 1 Public Primary Certification Authority - G2""
!       ""VeriSign Class 2 Public Primary Certification Authority - G2""
!       ""VeriSign Class 3 Public Primary Certification Authority - G2""
!       ""VeriSign Class 4 Public Primary Certification Authority - G2""
!       ""VeriSign Class 1 Public Primary Certification Authority - G3""
!       ""VeriSign Class 2 Public Primary Certification Authority - G3""
!       ""VeriSign Class 3 Public Primary Certification Authority - G3""
!       ""VeriSign Class 4 Public Primary Certification Authority - G3""
!       ""Thawte Primary Root CA""
!       ""Thawte Primary Root CA - G2 ECC""
!       SymantecClass3ECC256bitSSLCA
!       ""CN=VeriSign Class 3 Public Primary Certification Authority - G5,OU=(c) 2006 VeriSign\, Inc. - For authorized use only,OU=VeriSign Trust Network,O=VeriSign\, Inc.,C=US""
!       ""CN=DigiCert Global Root CA,[OU=www.digicert.com|http://OU=www.digicert.com],O=DigiCert Inc,C=US""

* {noformat}  WebSEAL-Test-Only{noformat}



I believe that this is the issue to solve. 
","28/Feb/23 12:38 AM;5c87cb8d88f9ec6ae0afb306;FWIW, the client sent a support file for the 9.0.7.2 node (that is in the pre-upgrade-of-master state.)  I can view the contents of the .kdb files without issue.

One thing that is interesting to me is that there are .p12 files already in the “pre-upgrade” 9.0.7.2 support file.  I don’t know that that is a problem, but it seems odd that they exists, unless this node was already part of of mixed-node cluster. 

One other thing is that there is a slight file-size difference in the .kdb files.

Working (rolled-back): 
[129:gvacek@ecurep]:/ecurep/sf/TS012/231/TS012231776/2023-02-27/isam_9.0.7.2_20230227-135239_vapwslt205-b.support_unpack/var/pdweb/shared/keytab $ ls -la pdsrv.*
-rwxrwxr-x    1 ecuunpck swsupt       105088 Feb 27 13:53 pdsrv.kdb
-rwxrwxr-x    1 ecuunpck swsupt        29630 Feb 27 13:53 pdsrv.p12
-rwxrwxr-x    1 ecuunpck swsupt          193 Feb 27 13:53 pdsrv.sth

Broken (post-master-upgrade): 
[45:gvacek@ecurep]:/ecurep/sf/TS012/231/TS012231776/2023-02-23/isam_9.0.7.2_20230223-154000_vapwslt205-b.support_unpack/var/pdweb/shared/keytab $ ls -la pdsrv.*
-rwxrwxr-x    1 ecuunpck swsupt       105144 Feb 23 15:40 pdsrv.kdb
-rwxrwxr-x    1 ecuunpck swsupt        29630 Feb 23 15:40 pdsrv.p12
-rwxrwxr-x    1 ecuunpck swsupt          193 Feb 23 15:40 pdsrv.sth

I’m not really sure why the client is testing this mixed-node step, as their intent is to upgrade to 10.0.0.5.  I am asking that question.  ","28/Feb/23 2:52 AM;6154906364ff01007106e189;As per Jonathan Morrow from Clydesdale Bank

“ _The mixed-node level is only required for the duration of the upgrade. Unfortunately given the number of nodes and their usage we are not in a position to be able to just upgrade all the appliances in the cluster in a compacted timeframe. Hence, we did not encounter this issue in our development environments as they only have a couple of nodes, but in the first test environment we have ten regular nodes in the cluster and each of those acts almost as an autonomous environment in its own right with the consequence that the overall rollout schedule would have covered about two weeks (including time to test different applications running through each appliance). This issue equates to us not being able to restart WRPs in that time on the ""yet-to-be-upgraded"" nodes and that is just too restrictive/disruptive to the test/development teams. Additionally we don't want to have to upgrade all cluster appliances and then find there is an issue that demands a rollback of everything._ “","01/Mar/23 11:39 AM;5b15d954b0d76456f36daf33;I’ve a local recreate and an understanding of what is causing the problem. Please open an APAR.

What is the customer’s current status? We have a couple of options in terms of remediation:

# If the primary is back at 9.0.7.2, turn off SSL replication and upgrade to 10.0.5 again. Turn replication back on after all nodes are upgraded.
# If the primary is still at 10.0.5.0, I’ll write a fixpack to regenerate the kdb files on primary. This will be replicated to all the nodes and they shouldn’t face the issue of reverse proxies not restarting.

Ask them if they have a preference.","01/Mar/23 3:42 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5e5f4915c9d5717a08844bf5e7c5daeab8420d62
   * description: ISAMSUP-4816 Ensure converted kdb is accessible to older gskit versions

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85743272.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4816) which we publish.","01/Mar/23 8:27 PM;6154906364ff01007106e189;Hi [~accountid:5b15d954b0d76456f36daf33] , from your update and customers most recent update on March 1st, it appears customer has road tested option #1 successfully in their Dev environment. After updating customer with your feedback, waiting to hear back from them how they wish to proceed in their Test and Production environments between option #1 or #2. ","01/Mar/23 9:26 PM;6154906364ff01007106e189;Hi [~accountid:5b15d954b0d76456f36daf33] to summarize their environments x 5;
(a) Dev - this was already at 10.0.5 when we discovered the issue in the test environment so we rolled that one back to 9072 to test the outcome of a roll back before applying that rollback in test. Yesterday we used the ""disable SSL Certificate replication"" technique to test that approach and so now this environment is back at 10.0.5.

(b) DevLink - this is another dev environment that was also upgraded to 10.5.0 successfully (it only has two regular nodes).

(c) Test - this was where we encountered the problem (this has ten regular nodes), it is currently rolled back to 9072. And this is the environment we next need to attempt to upgrade again.

(d) We have another separate performance testing environment it will be upgraded from 9072 once (c) is completed.

(e) Production also at 9072, will be upgraded once all above are completed.

Customer response as to how they wish to proceed given as follows;
” _In the only environment where we encountered this issue it was rolled back to 9072, and the other two proceeding environments are already upgraded completely to 10.0.5. So in short, option '(a)' would be how we will proceed at the moment, unless there is likely to be an APAR fix for this released prior to our next attempt to upgrade the same test environment._ “

Which to my understanding is they want both options i.e. they will do option #1 until option #2 becomes available.
APAR created successfully with number: IJ45645 for this Jira work item.","02/Mar/23 9:41 AM;5b15d954b0d76456f36daf33;The best course of action for environments that are still at 9.0.7.2 is option 1 - disable ssl replication until all firmware upgrades are complete.

_>> unless there is likely to be an APAR fix for this released prior to our next attempt to upgrade the same test environment._

The APAR fix will go into the release after 10.0.5.0. The remediation will occur during firmware upgrade. 

The fixpack I offered to write is a stopgap arrangement. It will attempt to do something similar _after_ the upgrade. In terms of risk, they are better off simply unchecking the ssl replication box rather than upgrading to 10.0.5.0 and then having to install a fixpack.","02/Mar/23 11:09 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 3a0ac113a29e2067f462eb547325c6d17594817b
   * description: Merge pull request #5715 from ISAM/ISAMSUP-4816

ISAMSUP-4816 Ensure converted kdb is accessible to older gskit versions

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85833738.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230302010652-3a0ac113.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","03/Mar/23 8:29 PM;6154906364ff01007106e189;Hi [~accountid:5b15d954b0d76456f36daf33]  just to update SF TS012231776 case is now closed by the customer i.e. see below as I provided APAR reference IJ45645. Thank you for your help re this work item.

"" _Thanks for the feedback Brian, we will progress on the basis of the SSL Certificate disablement. Maybe you could provide the APAR reference number and then I think we can close out this case. If we need any further assistance we can either reopen this or open a new case and refer back to this one._""",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Cluster problems,ISAMSUP-4804,282843,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,21/Feb/23 12:57 AM,14/Mar/23 10:56 PM,14/Jul/23 2:47 PM,14/Mar/23 10:56 PM,,Support,,0,,,,"This customer has been switching datacenters and having many problems with their clustering.



We have been focusing on the following 3 systems…

[qayssoisam02-mgmt1.huntington.com|http://qayssoisam02-mgmt1.huntington.com]:   primary master
10.160.20.68
10.160.20.69
10.160.32.72
10.160.32.73
10.160.32.74
10.160.32.75

[qayssoisam03-mgmt1.huntington.com|http://qayssoisam03-mgmt1.huntington.com]   tertiary master
10.128.20.86
10.128.20.87
10.128.36.72
10.128.36.73
10.128.36.74
10.128.36.75

[qayssoisam04-mgmt1.huntington.com|http://qayssoisam04-mgmt1.huntington.com]     quarternary master
10.160.20.76
10.160.20.77
10.160.32.76
10.160.32.77
10.160.32.78
10.160.32.79

Originally we had an issue with the config DBs on the tertiary and quarternary servers not starting properly due to corruption.   Since the resync_db didn’t work we decided to remove the quarternary from the cluster, and just re-add it.   However, when we try to re-add it we just get a system error and it fails.  The quarternary shows it’s still standalone, but the primary does show the quarternary’s address as one of it’s nodes.

Digging deeper, I noticed that the /var/isam/cluster/replicate/keyfile on both systems was still pointing to the previous primary master’s ip (from before the datacenter move).    So on the primary we disabled the keystore replication, and then re-enabled it, and it fixed it on the primary.    But the quarternary still shows this file pointing to the wrong system.    I don’t know if this matters or not since the primary still shows as standalone.

So now we can’t seem to re-join the cluster and can’t seem to figure out why.



On the quarternary appliance (the one we are trying to re-add to the cluster) I see this in

/ecurep/sf/TS012/147/TS012147497/2023-02-17/isva_10.0.3.1_20230217-152822_qayssoisam04-mgmt1.huntington.com.support_unpack/var/log/messages



{noformat}Feb 17 15:17:42 mesa_config[12314]: WGAWA0581I   Converting the mode of the 'Configuration' database from 'None' to 'Replica'.
Feb 17 15:17:44 mesa_config[12314]: WGAWA0598I   Deleting the 'Configuration' database in preparation for a new mode.
Feb 17 15:17:56 sshd[12422]: Accepted publickey for cluster from 10.160.20.68 port 23244 ssh2: RSA SHA256:RnXwL9OEDIzSdAc0CUIREBK8tpUuenc3QGmGR0Wp18g
Feb 17 15:17:56 sshd[12422]: pam_unix(sshd:session): session opened for user cluster by (uid=0)
Feb 17 15:17:56 sshd[12432]: Received disconnect from 10.160.20.68 port 23244:11: disconnected by user
Feb 17 15:17:56 sshd[12432]: Disconnected from user cluster 10.160.20.68 port 23244
Feb 17 15:17:56 sshd[12422]: pam_unix(sshd:session): session closed for user cluster
Feb 17 15:19:42 mesa_config[12267]: Error: DPWAP0003I   An error occurred while executing the command: /usr/sbin/mesa_control commit /tmp/clusterp (0xffffffff)
Feb 17 15:27:44 mesa_config[12314]: Error: DPWAP0003I   An error occurred while executing the command: /usr/bin/setuidgid pgresql:pgresql /usr/bin/pg_basebackup -h 127.0.0.1 -p 2026 -v -U www-data --no-password -D /var/postgresql/config/data -X stream (0xffffffff)
{noformat}



We have pcaps and support files from all 3 appliances in 
/ecurep/sf/TS012/147/TS012147497/2023-02-17

ignore the ones that start with “dvy” those were sent by mistake.   

The main ones for now would be the primary
isva_10.0.3.1_20230217-152755_qayssoisam02-mgmt1.huntington.com.support_unpack
and quarternary
isva_10.0.3.1_20230217-152822_qayssoisam04-mgmt1.huntington.com.support_unpack

We even collected a cluster replication debug from the primary using “cluster_replication_test.fixpack”
at 
/ecurep/sf/TS012/147/TS012147497/2023-02-17/cluster_replication_test.log



I don’t know what else to look for, hoping that error I pointed out means something to you.



Thanks!",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012147497,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,The Huntington National Bank,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18mvn:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-02-21 15:06:28.644,,,,,"22/Feb/23 1:06 AM;5b17571b91981f4fdde632c1;* No information for the dates when it started … should I ignore?
** 2023-02-14
** 2023-02-15 ","22/Feb/23 1:24 AM;5b15d9a0dda5f94d06b985b3;Hi Bill,
The previous dates can be looked at if you want to see more of the historical progression, but I only mentioned the last ones since that seems to be where we are at now.

For example…

2023-02-14/isva_10.0.3.1_20230214-091903_qayssoisam04-mgmt1.huntington.com.support  
2023-02-14/isva_10.0.3.1_20230214-133406_qayssoisam03-mgmt1.huntington.com.zip
These show the original database problem which led to removing the quarternary from the cluster

2023-02-14/isva_10.0.3.1_20230214-154652_qayssoisam04-mgmt1.huntington.com.support   quarternary was removed, unable to re-join (first attempt)

2023-02-14/isva_10.0.3.1_20230214-162505_qayssoisam02-mgmt1.huntington.com.support  - first support file from primary showing the replication of the keystores pointing to the wrong (old) server

2023-02-15/isva_10.0.3.1_20230215-134406_qayssoisam02-mgmt1.huntington.com.support - primary master after we disabled and re-enabled the keystore replication to fix that part


2023-02-15/isva_10.0.3.1_20230215-175055_qayssoisam04-mgmt1.huntington.com.support
2023-02-15/isva_10.0.3.1_20230215-173914_qayssoisam02-mgmt1.huntington.com.support
another attempt re-joining the cluster

2023-02-17/isva_10.0.3.1_20230217-010836_dvyssoisam02-mgmt1.huntington.com.support
2023-02-17/isva_10.0.3.1_20230217-010530_dvyssoisam03-mgmt1.huntington.com.support
ignore these they are different systems uploaded to the wrong case


which then leads to the new docs that were uploaded that I referred to, which also include the pcap files inside the support files.


I hope this helps.","22/Feb/23 3:29 AM;5b17571b91981f4fdde632c1;{noformat}    <!-- code iswap_m_system_error -->
    <MsgText msgIndex=""3"" varFormat=""C"">
        An error occurred while executing the command: <Variable formatSpec=""%1$s"">%s</Variable> (0x<Variable formatSpec=""%2$x"">%x</Variable>) (0x3898f003)

    </MsgText>
    <!-- Notes to translators: 1: the name of the command; 2: the error value-->
    <Explanation>
      <p>An attempt to execute a system command failed.</p>
    </Explanation>
    <AdminResponse>
      <p>Check the system log for further information.</p>
    </AdminResponse>
    <!-- sub-component iswap_common_s -->
  </Message>{noformat}","22/Feb/23 6:45 AM;5b17571b91981f4fdde632c1;# Advanced Tuning Parameter
## debug.level = 2
# LMI tracing
## com.ibm.mesa.*=ALL
# Collect Support file with /var/log/messages*","23/Feb/23 12:04 AM;5b15d9a0dda5f94d06b985b3;Hi Bill,
The requested docs were uploaded to 
/ecurep/sf/TS012/147/TS012147497/2023-02-22

Just a reminder, qayssoisam04 is the one that is trying to re-join the cluster and qayssoisam02 is the primary master.","28/Feb/23 1:58 AM;5b15d9a0dda5f94d06b985b3;Hi [~accountid:5b17571b91981f4fdde632c1] the customer is asking for an update, their upper management is talking about escalating since this is holding up their data center migration project.    Have you had a chance to look yet?    Thx",01/Mar/23 5:12 AM;5b17571b91981f4fdde632c1;* 2023-02-03 available and expanded on l3pmrsupport,"01/Mar/23 11:58 AM;5b17571b91981f4fdde632c1;* For IBM Support only:
** Goal is to start reviewing tomorrow","14/Mar/23 10:56 PM;5b15d9a0dda5f94d06b985b3;Closing, problem was part to a defect we found a fixpack for, as well as firewall issues.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 ISAM authsvc High alert Vulnerability,ISAMSUP-4800,281773,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,16/Feb/23 8:06 PM,19/Apr/23 10:45 AM,14/Jul/23 2:47 PM,19/Apr/23 10:45 AM,,,,0,,,,"[https://loginstg.dha.gov.ae:8090/mga/sps/authsvc|https://loginstg.dha.gov.ae:8090/mga/sps/authsvc]

Cross-site scripting (XSS) vulnerabilities arise when an attacker sends malicious code to the victim's browser, mostly using JavaScript. A vulnerable web application might embed untrusted data in the output, without filtering or encoding it. In this way, an attacker can inject a malicious script to the application, and the script will be returned in the response. This will then run on the victim's browser.

In particular, sanitization of hazardous characters was not performed correctly on user input or untrusted data. In reflected attacks, an attacker tricks an end user into sending request containing malicious code to a vulnerable Web server, which then reflects the attack back to the end user's browser.


The server receives the malicious data directly from the HTTP request and reflects it back in the HTTP response. The most common method of sending malicious content is adding it as a parameter in a URL that is posted publicly or e-mailed directly to the victim. URLs that contain the malicious script constitute the core of many phishing schemes, whereby the convinced victim visits a URL that refers to a vulnerable site. The site then reflects the malicious content back to the victim, and then the content is executed by the victim's browser.

The following changes were applied to the original request:

Set HTTP header to '__ORIG_VAL__""'Afp</script ><script>alert(231)</script>fp'""A'",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012161984,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,, DUBAI HEALTH AUTHORITY DUBAI HEALTH AUTHORITY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18gl7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-02-17 17:24:27.695,,,,,16/Feb/23 8:42 PM;627a7fb30d1e73006f7c21cf;*Since it is high alert needs to be addressed ASAP.*,18/Feb/23 3:24 AM;5b15d8fd6e93913e31e279fb;[~accountid:627a7fb30d1e73006f7c21cf] I have opened PSIRT Advisory ADV0078167 for this with PSIRT Product Records PVR0423663 and PVR042664 for this issue.,"21/Feb/23 10:55 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] are we allowed to share this information with customer about:
”opened PSIRT Advisory ADV0078167 for this with PSIRT Product Records PVR0423663 and PVR042664 for this issue.”",22/Feb/23 2:06 AM;5b15d8fd6e93913e31e279fb;[~accountid:627a7fb30d1e73006f7c21cf] You can share that an advisory and PSIRT records are created but not disclose the numbers as this is IBM Confidential information.  When the fix is included in a release a Security Bulletin will be issued with the CVE information for this issue.,"22/Feb/23 2:16 AM;5b15d8fd6e93913e31e279fb;[~accountid:627a7fb30d1e73006f7c21cf] Can we get a more detailed information from the scan that discovered this.  

This is the response from our Ethical Hacking Team.

Do you have a more detailed report that shows which HTTP header they're tweaking?

I can take a look at a running environment to see if I can see what they're saying but oftentimes what we wind up seeing is that these header-based XSS
attacks could only be carried out against yourself and thus generally have no impact. I'd need to see what the header is that they modified though to make a judgement.","22/Feb/23 2:41 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] 

I have updated the required details in the case.","23/Feb/23 6:44 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] 

Some information shared by customer with PDF report password protected. 8VhV3fu*pS33 is the password

GET /mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:dhaLostId HTTP/1.1

Accept-Language: en-US

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

Referer: [+https://loginstg.dha.gov.ae:8090/mga/sps/authsvc?StateId=t3bVcupF5j7bhWtwcMSYGu0UR8NbQD0JVnSyRJRo1wE5GaEzXufu8Z4vpwStsXKuUobjgofnb3xQM5JD2jzI7jdhKCj8zGY1PExEo7zuDokO8MjoMNaIbdEdcHiIIcMX""'Afp</script+|https://loginstg.dha.gov.ae:8090/mga/sps/authsvc?StateId=t3bVcupF5j7bhWtwcMSYGu0UR8NbQD0JVnSyRJRo1wE5GaEzXufu8Z4vpwStsXKuUobjgofnb3xQM5JD2jzI7jdhKCj8zGY1PExEo7zuDokO8MjoMNaIbdEdcHiIIcMX%22%27Afp%3C/script] ><script>alert(231)</script>fp'""A

Host: [loginstg.dha.gov.ae|https://loginstg.dha.gov.ae/]:8090

User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36

Cookie: PD-S-SESSION-ID=1_2_1_NZqoUfo9yQMsa2nTpY6td2+Zjvqp99m9VlRjPFBmM15hG+46; AMWEBJCT\!%2Fmga\!JSESSIONID=0000iq6_Il28gc9YG13JOBlPbn4:4511ea67-e22b-4f52-a766-d0289c902d7d; PD_STATEFUL_22fc4ab6-244a-11ed-8604-005056812c5a=%2Fmga; SalLB01c92b03=013abf52beb8e5a6ecd61d5755e322ad373d32192768da9961408ab78ae9825ff7f113c6fe252265d004a9e80637d1f50178cba16bad7143df17a9c9a80dff5812bdc3bda47332225cb7c609f74fdda34e1e6d9654ae9c0ae9e09da940a934629b03bbb83a6021a63dba221b71e315b90bb4dd79345f093ef7617adbe01f266770621c4cf3; SalLBd1789dd9027=08837ac42eab20005a1af42efc4c58d3bd68d3c9a597f658f55ebe5551ec7ea6b695085cbbc858b508da113890113000ea8a32136e00e4a9eebfa84b8b0e4f6800f070bc99ec2a1918fef463eaf912026b74a68add216d3140255c112c8dc723

Authorization: Bearer HZz7iEUO3Vxy2ZypOZoI



Set HTTP header to '__ORIG_VAL__""'Afp</script ><script>alert(231)</script>fp'""A'



“Document attached, 8VhV3fu*pS33 to open the file and if still need any live testing i can involve security team to join webex call. please confirm”
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012161984&path=TS012161984%2F2023-02-23%2F&filepath=TS012161984%2F2023-02-23%2FBloodtransfer_27122022_Security_Report_002_.pdf|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012161984&path=TS012161984%2F2023-02-23%2F&filepath=TS012161984%2F2023-02-23%2FBloodtransfer_27122022_Security_Report_002_.pdf]",01/Mar/23 1:42 AM;5b15d8fd6e93913e31e279fb;Thanks.  I have forwarded the report to our Ethical Hacking Team for further analysis.,01/Mar/23 9:00 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] can you please update this item with the work that has been completed. ,02/Mar/23 3:22 AM;5b15d8fd6e93913e31e279fb;The ethical hacking team has reviewed the PDF sent by the customer and says it does not provide enough information to verify the vulnerability.  They have attempted to recreate this on the ISVA 10.0.5.0 environment  and could not.  We need the customer to retest on ISVA 10.0.5.0 or we need a recreate scenario to evaluate further.,"03/Mar/23 9:23 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] I have asked customer to retest and recreate scenarios on ISVA 10.0.5.0 to verify the vulnerability.
Now the customer is requesting the Webex with their security team where they can share or reproduce the same on call. Please let us know if we can have a Webex with customer and their security team according to your availability on upcoming Monday.",07/Mar/23 2:34 AM;5b15d8fd6e93913e31e279fb;[~accountid:627a7fb30d1e73006f7c21cf] Sorry I was out on Friday and did not get this until now.  I have a major outage in my build lab that I have to work on today.  Can we schedule for Wednesday or Thursday morning?  I would also request that we can record the Webex so if there are configuration issue I can go back and review the recording or if I need to get the Ethical Hacking team involved we will have that and not have to schedule a new Webex for that team.,07/Mar/23 7:36 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] Please provide a Webex meeting time and timezone based on your availability.,07/Mar/23 8:45 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] Just asked for Webex to Customer on Wednesday or Thursday at 3 P.M. GMT time zone. Waiting for their response.,"08/Mar/23 3:10 AM;5b15d8fd6e93913e31e279fb;I have a meeting at 9:30 CST on Thursday, so hopefully they can do it Thursday",19/Apr/23 10:45 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"GLGSY0032E The attempt to update the route, has failed",ISAMSUP-4791,281326,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,rholman,5bac25a83a6aa22dbebb46cf,rholman,5bac25a83a6aa22dbebb46cf,15/Feb/23 5:07 AM,27/Mar/23 10:18 AM,14/Jul/23 2:47 PM,27/Mar/23 10:18 AM,,,,0,,,,"Customer installed a fixpack to fix remote syslog. Once the fix was installed, they started to receive the following errors in their logs.

host: isvaws2p.azdot.aws
address: 0.0.0.0
args: route_detail=inet 10.15.20.0/24 via 10.15.19.1 dev 1.1 metric 0 table main
desc: GLGSY0032E The attempt to update the route, inet 10.15.20.0/24 via 10.15.19.1 dev 1.1 metric 0 table main, has failed.
eventid: GLGSY0032E
name: system
priority: high

The customer is not performing any type of change to generate these errors. There appears something under the covers generating the errors. The customer has checked the network connectivity of the routes and they all seem to be properly communicating. We have discussed this as a team and we have not been able to determine what is causing the errors. They don’t seem to be having an impact aside from filling up the logs. ",,David Hayes,khansen,Motiur Rahman,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011673809,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,rholman,5bac25a83a6aa22dbebb46cf,,,,Kyndryl,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS011673809&path=TS011673809%2F2022-12-29%2F&filepath=TS011673809%2F2022-12-29%2Fisva_10.0.4.0_20221229-164059_isvaws2t.azdot.aws.support,,,,,,,,,,,,,,,,,,,,,,,0|i18dtv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-15 01:23:09.333,,,,,"15/Feb/23 11:23 AM;5b15d9517dab4c51f61b5190;The errors are happening every time the 1.1 interface DHCP lease is renewed (every 30 minutes)

1.1 also has a static ip address defined (I suspect the same ip as DHCP is giving it)

Does the 1.1 interface need to have DHCP enabled?",16/Feb/23 12:18 AM;5bac25a83a6aa22dbebb46cf;This has been seen in 1 other case. The common thread between the two has been that both are hosted in AWS. I am not sure if that makes a difference or not.,10/Mar/23 3:47 AM;5bac25a83a6aa22dbebb46cf;Customer has stopped responding. Closing case.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Vulnerabilities in 10.0.4.0 docker image ,ISAMSUP-4789,281212,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,jwade,5b15d8fd6e93913e31e279fb,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,14/Feb/23 5:29 PM,11/Jul/23 6:12 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"Customer has done blackbox security assessment against the IBM Security Verify Access (ISVA) infrastructure. A total of [REDACTED] vulnerabilities have been found.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012127268&path=TS012127268%2F2023-02-13%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012127268&path=TS012127268%2F2023-02-13%2F]

[~accountid:5b15d8fd6e93913e31e279fb] can you please have a look ?",,Asha Shivalingaiah,,,,,,,,,,,,,,,5af4ad7d4dd24c579110120b,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012127268,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,,,,ASIAN DEVELOPMENT BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18d4z:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-14 18:51:08.6,,,,,15/Feb/23 4:51 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b1757156d76184b7d98a0c3] This is a very detailed report and it will take a while to go through.  I will also contact our Ethical Hacking team to see when the next Pen Test is scheduled so that they can weigh in on the findings.,"22/Feb/23 1:38 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b1757156d76184b7d98a0c3] I have had the development team complete the initial assessment of the provided report and I am hoping that we can provide the outcome of this in someway to our customer. Can you please let the customer know that we are continuing with our assessment and that we are hoping to provide a more detailed update next week, 

[~accountid:5b15d8fd6e93913e31e279fb] lets please make sure that we discuss this at this weeks PSIRT sync up to start kick start the process.",22/Feb/23 9:14 PM;5b1757156d76184b7d98a0c3;Customer has been updated with the status. Thanks.,03/Mar/23 4:40 PM;5b1757156d76184b7d98a0c3;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b15d8fd6e93913e31e279fb] any update from Dev team on this?,"13/Mar/23 8:51 PM;5b1757156d76184b7d98a0c3;Link for the pdf

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012127268&path=TS012127268%2F2023-03-13%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012127268&path=TS012127268%2F2023-03-13%2F]

[~accountid:5b15d8fd6e93913e31e279fb] [~accountid:5ac57757d9a96536d1f0daa9] 

Latest response from customer

----

This report contains specific vulnerabilities found in ibmsecurity (34 vulnerabilities regrouped inside 4 specific vulnerabilities: V-93 to V-96), used to manage IBM Security Verify products.

Can you please check, confirm and provide CVEs and security patches for these vulnerabilities?

Please forward the adb-isva-3-3-ibmsecurity.pdf report (ibmsecurity Python library) to the IBM security team.

This security assessment was done by hand (without a scanner) and the official IBM github repository still contains vulnerable code at [https://github.com/IBM-Security/ibmsecurity|https://github.com/IBM-Security/ibmsecurity|smart-link]  (with the latest version).

Thank you.

If you have any questions regarding these vulnerabilities, feel free to update the ticket with the questions (I did these security assessments so I can reply to technical questions).

Pierre Barre",15/Mar/23 8:54 AM;5b232b2fd85e5b59b066f57f;[~accountid:5ac57757d9a96536d1f0daa9] - have we communicated with Phil / the customer yet based on Dev analysis?,15/Mar/23 10:01 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b1757156d76184b7d98a0c3] can you please confirm a time with the customer that we can meet to discuss out assessment of the initial report. Once confirmed can you please invite [~accountid:5ac577577331be74a80d5ab4] and [~accountid:5b20891f1d2d6643d2c84c65] to this. ,"16/Mar/23 2:33 PM;5b1757156d76184b7d98a0c3;[~accountid:5ac57757d9a96536d1f0daa9] customer’s response for call

----

Hello Nilesh,

In order to prepare for this meeting and have a constructive discussion, please provide us before with feedback for each vulnerability we have reported. From what I understand, we are going to go through all the vulnerabilities so it will take some time. Preparing for the meeting will speed up discussions.

Friday in the afternoon (UTC+8) is fine if you can send the document tomorrow (including V-40 to V-74 with your comments). Next week in the afternoon is also fine.

Thank you.

Regards,",20/Mar/23 5:04 PM;5b1757156d76184b7d98a0c3;[~accountid:5ac57757d9a96536d1f0daa9] any update on this for customer?,"29/Mar/23 8:52 AM;5ac57757d9a96536d1f0daa9;[~accountid:5ac577577331be74a80d5ab4] [~accountid:5b20891f1d2d6643d2c84c65] can you please confirm your time availability to have a call with this customer. 

[~accountid:5b1757156d76184b7d98a0c3] can you please confirm that the customer is asking for the assessment to be provided prior to the meeting. I will need to understand if this is something that can be provided. ",29/Mar/23 8:57 AM;5ac577577331be74a80d5ab4;[~accountid:5ac57757d9a96536d1f0daa9] I am available at the usual times (i.e. Mon - Fri / 7:00 am → 6:00 pm (GMT+10) ).,"29/Mar/23 2:28 PM;5b1757156d76184b7d98a0c3;[~accountid:5ac57757d9a96536d1f0daa9] yes, customer is looking for assessment before meeting. Let me know if we need to discuss prior assessment then I can request customer to schedule call accordingly. ","29/Mar/23 11:22 PM;5b20891f1d2d6643d2c84c65;Availability - similar to scott, subject to calendar freedom.","04/Apr/23 11:20 PM;5b1757156d76184b7d98a0c3;[~accountid:5ac57757d9a96536d1f0daa9] customer is looking for an update.

Dear IBM support,

have you reviewed the 2 reports (IBM Security Verify + ibmsecurity Python library)?

Can you confirm the vulnerabilities? We provided the first report over 50 days ago so we would like to know when do you plan to provide security patches.

I'm always available for any discussion if you have technical questions.","05/Apr/23 7:54 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b1757156d76184b7d98a0c3] thanks for the update here. I had just finalized the deliver of the development teams assessment of the report and had approval to deliver this to our customer. You can access the report following - 

[https://ibm.box.com/s/8hmse4zkw0flktns263et4vxshsem7dc|https://ibm.box.com/s/8hmse4zkw0flktns263et4vxshsem7dc|smart-link] 

Please note that this should be only shared with this customer. Beyond this the document should be classified as IBM confidential. 

Once you have provided this can you please proceed to organize the call with our customer inviting [~accountid:5ac577577331be74a80d5ab4] [~accountid:5ac577587028785d133fbc46]to this meeting. Please add me as optional to ensure that I know when this meeting is taking place. ",05/Apr/23 8:31 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b1757156d76184b7d98a0c3] Please add me as optional also.,18/Apr/23 9:06 PM;5b1757156d76184b7d98a0c3;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5ac577577331be74a80d5ab4] [~accountid:5b20891f1d2d6643d2c84c65] Is it possible to have a call on Thursday?,"19/Apr/23 7:15 AM;5ac577577331be74a80d5ab4;[~accountid:5b1757156d76184b7d98a0c3] Thursday would be fine for me, remembering that we reside in the GMT+10 timezone.  Can you also please ensure that Keiran Robinson is invited to the meeting.",19/Apr/23 6:04 PM;5b1757156d76184b7d98a0c3;[~accountid:5ac577577331be74a80d5ab4] [~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b20891f1d2d6643d2c84c65] [~accountid:5ac577587028785d133fbc46] Customer is requesting to have call at 2PM MNL which is 4PM Australia time. Sending invite accordingly. Any problem?,"21/Apr/23 6:37 AM;5ac577587028785d133fbc46;[~accountid:5ac577577331be74a80d5ab4] [~accountid:5b20891f1d2d6643d2c84c65]  FYI: Pierre’s document from yesterday has been uploaded to Box: [https://ibm.ent.box.com/folder/201984790525|https://ibm.ent.box.com/folder/201984790525|smart-link] 

[~accountid:5b1757156d76184b7d98a0c3] Can we schedule another call for the same time/day next week with Pierre to talk about the ibmsecurity library? I have email confirmation from him that the time will suit.",22/Apr/23 2:50 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5ac577577331be74a80d5ab4] Can I start opening PSIRT issues for the issues marked as Accept in the spreadsheet?,"22/Apr/23 6:30 AM;5ac577577331be74a80d5ab4;I will let Tony make the final decision but my thoughts are to start creating the psirt records.

Sent from my iPad

On 22 Apr 2023, at 2:50 am, jwade (JIRA) <jira@cloudidentity.atlassian.net> wrote:

﻿
jwade mentioned you on an issue ISAM Support/ISAMSUP-4789 Vulnerabilities in 10. 0. 4. 0 docker image ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌
ZjQcmQRYFpfptBannerStart
This Message Is From an External Sender
This message came from outside your organization.

ZjQcmQRYFpfptBannerEnd
jwade mentioned you on an issue
ISAM Support/ISAMSUP-4789 Vulnerabilities in 10.0.4.0 docker image  ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌ ‌
jwade mentioned you on an issue
ISAM Support<https://cloudidentity.atlassian.net/browse/ISAMSUP?atlOrigin=eyJpIjoiMTkwYjMyNDE2MzNhNDhkY2FiODg2NTllOGQwNTc1ZmIiLCJwIjoiaiJ9>
  /
ISAMSUP-4789<https://cloudidentity.atlassian.net/browse/ISAMSUP-4789?atlOrigin=eyJpIjoiMTkwYjMyNDE2MzNhNDhkY2FiODg2NTllOGQwNTc1ZmIiLCJwIjoiaiJ9>
Vulnerabilities in 10.0.4.0 docker image <https://cloudidentity.atlassian.net/browse/ISAMSUP-4789?atlOrigin=eyJpIjoiMTkwYjMyNDE2MzNhNDhkY2FiODg2NTllOGQwNTc1ZmIiLCJwIjoiaiJ9>
[https://secure.gravatar.com/avatar/f9e199916d998aabb3c86bf83407c263?d=https%3A%2F%2Favatar-management--avatars.us-west-2.prod.public.atl-paas.net%2Finitials%2FJ-3.png]        jwade 2:50 AM AEST

@tonyferg @Scott Exton Can I start opening PSIRT issues for the issues marked as Accept in the spreadsheet?


View issue<https://cloudidentity.atlassian.net/browse/ISAMSUP-4789?atlOrigin=eyJpIjoiMTkwYjMyNDE2MzNhNDhkY2FiODg2NTllOGQwNTc1ZmIiLCJwIjoiaiJ9>
Get Jira notifications on your phone! Download the Jira Cloud app for Android<https://play.google.com/store/apps/details?id=com.atlassian.android.jira.core&referrer=utm_source%3DNotificationLink%26utm_medium%3DEmail> or iOS<https://itunes.apple.com/app/apple-store/id1006972087?pt=696495&ct=EmailNotificationLink&mt=8>.

Manage notifications<https://cloudidentity.atlassian.net/secure/ViewPersonalSettings.jspa#emailpreferences>  •  Give feedback<https://surveys.atlassian.com/jfe/form/SV_9X3zi1X4q1gKsqF>  •  Privacy policy<https://www.atlassian.com/legal/privacy-policy>

<atl-generated-390d9b7d-4c13-4a8d-82f1-f08f9a527db4>

<atl-generated-390d9b7d-4c13-4a8d-82f1-f08f9a527db4>",24/Apr/23 9:29 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] yes please kick start the PSIRT process associated with the items that have been accepted. Can you please ensure that the spreadsheet is updated to include each of the advisories that has been associated with each issue. After speaking with [~accountid:5ac577587028785d133fbc46] last week we have a couple of the items that are still under discussion and will hope to have these remaining items confirmed. I am hoping that we can show the customer at this weeks meeting that we have made progressing at creating some of these PSIRT issues at our next meeting. ,26/Apr/23 6:31 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac57757d9a96536d1f0daa9] I have opened the Advisories and Product Records in PSIRT for all “Accepted” issues in the spreadsheet and have updated the spreadsheet in the Box folder [https://ibm.ent.box.com/folder/201984790525|https://ibm.ent.box.com/folder/201984790525|smart-link]  with the Advisory numbers.  I can take up to 2 weeks to get the X-Force scoring.,11/May/23 4:25 PM;5b1757156d76184b7d98a0c3;[~accountid:5b15d8fd6e93913e31e279fb] Any further update regarding CVEs?,"16/May/23 3:57 PM;5b1757156d76184b7d98a0c3;[~accountid:5b15d8fd6e93913e31e279fb] Any CVEs created so far? Customer is asking, does this CVE-2023-25927 match V-72 in the report?
A new CVE was published last friday: [https://twitter.com/CVEnew/status/1657098385847902213#m|https://twitter.com/CVEnew/status/1657098385847902213#m|smart-link] 
[https://www.ibm.com/support/pages/node/6989653|https://www.ibm.com/support/pages/node/6989653]",17/May/23 4:00 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b1757156d76184b7d98a0c3] The issue for CVE-2023-25927 was an issue reported by a different customer in their environment.  I am not sure if it is the same as V-72.  I will have to confirm with development on this.,24/May/23 8:53 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac57757d9a96536d1f0daa9] Have we completed the discussion with the customer on the disputed issues,07/Jun/23 8:49 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] we are currently planning our 10.0.7 release which is due for publication at the end of 2023. We will have a level of focus on this list of item as part of this delivery.,"03/Jul/23 10:10 PM;5b1757156d76184b7d98a0c3;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b15d8fd6e93913e31e279fb] Any update for customer? Case can't be ideal till release of 10.0.7

Should I ask customer to wait till 10.0.7 and open a new case if they found similar vulnerabilities ?",07/Jul/23 4:49 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b1757156d76184b7d98a0c3] Development is working on these for the 10.0.7 release as the final list of issues were not agreed upon until they were too late to get into the 10.0.6 release.  I am completing the PSIRT work on the final list of issues that were agreed to by development and the customer.,"10/Jul/23 9:53 PM;5b1757156d76184b7d98a0c3;Thank you [~accountid:5b15d8fd6e93913e31e279fb] for the updates. Can you help me to answer customer queries?
When will version 10.0.7 be available?->End of 2023 from Tony’s response. Please confirm to convey tentative timeframe.

Do you plan to issue security advisories and assign CVEs to these vulnerabilities?

Also, does CVE-2023-25927 match the V-72 vulnerability in our report?","11/Jul/23 6:12 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b1757156d76184b7d98a0c3] The releases typically come out twice a year in June and December.  There can be slips in case of major issues so we cannot pre-announce the release date.

Yes there will be CVEs and Advisories related to the vulnerabilities that were opened.  The Jira Wi related to these can be found in the ISAMPSIRT project with this query → [https://cloudidentity.atlassian.net/jira/software/c/projects/ISAMPSIRT/issues/?jql=project %3D ""ISAMPSIRT"" AND text ~ ""ADB V*"" ORDER BY created DESC|https://cloudidentity.atlassian.net/jira/software/c/projects/ISAMPSIRT/issues/?jql=project%20%3D%20%22ISAMPSIRT%22%20AND%20text%20~%20%22ADB%20V%2A%22%20ORDER%20BY%20created%20DESC]

For CVE-2023-25927 (reported by a different customer in their specialized configuration), I am not sure if this matches ADB V-72 in the report as the cause may be different.  I am waiting on Development to determine that.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
%URL% in local response redirect sent as absolute and not server relative,ISAMSUP-4787,281048,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,14/Feb/23 1:36 AM,25/Apr/23 4:45 AM,14/Jul/23 9:36 AM,28/Feb/23 9:37 AM,,Support,,0,,,,"Customer reported that they just upgraded to 10.0.2 (no fixpacks) and noticed that the %URL% in their local response redirect is now absolute instead of server relative

working:

[https://tsudev52.nhmmis.services.conduent.com/portals/wps/PA_EnterpriseLogin/TAMResponseHandlerServlet?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&URL=%2F&REFERER=|https://tsudev52.nhmmis.services.conduent.com/portals/wps/PA_EnterpriseLogin/TAMResponseHandlerServlet?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&URL=%2F&REFERER=]

not working:

[https://tsudev52.nhmmis.services.conduent.com/portals/wps/PA_EnterpriseLogin/TAMResponseHandlerServlet?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&URL=https%3A%2F%2Ftsudev52.nhmmis.services.conduent.com%2F&REFERER=|https://tsudev52.nhmmis.services.conduent.com/portals/wps/PA_EnterpriseLogin/TAMResponseHandlerServlet?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&URL=https%3A%2F%2Ftsudev52.nhmmis.services.conduent.com%2F&REFERER=]


I thought this would be covered by the fixpack written by [~accountid:5b15d9e581c3df12acf53c4a] previously

[https://cloudidentity.atlassian.net/browse/ISAMSUP-3271|https://cloudidentity.atlassian.net/browse/ISAMSUP-3271]

but even with 

[server]
redirect-using-relative = yes

they are still getting absolute.    Did the fixpack not deal with the local-response-redirect scenario?


I also found 

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4733|https://cloudidentity.atlassian.net/browse/ISAMSUP-4733]

which seems to be the same issue on 10.0.5 which was fixed with 

[server]
allow-url-macro-to-be-relative = true

but I don’t think that is available in 10.0.2 is it?

Thanks!",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012127611,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,,,,Conduent Business Services Inc,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18c4b:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-02-13 16:10:38.305,,,,,"14/Feb/23 2:10 AM;5b15d9e581c3df12acf53c4a;Yea, you are right, from 10.0.5.0 and up, ( as it was discovered that redirect-using-relative = yes comes in conflict with other issues ), it was decided that this issue should get it’s own option  so this new option was introduced.

 [server]
allow-url-macro-to-be-relative = true

======================================

This new option is ONLY available from 10.0.5.0 and up

Prior release should use  



[server]
redirect-using-relative = yes

unless stated other wise.

An older fix can be found in [https://cloudidentity.atlassian.net/browse/ISAMSUP-3611|https://cloudidentity.atlassian.net/browse/ISAMSUP-3611|smart-link]","14/Feb/23 2:24 AM;5b15d9a0dda5f94d06b985b3;Hi Motiur,

But does this work with %URL% in local response redirect too?    The fix you reference is the one I sent him, and he installed it and set

[server]

redirect-using-relative = yes

but he is still getting absolute.


From the config_data__Default-webseald-ND76MWSL01.ITOCSERVICES.COM.log

*Mon Feb 13 08:39:05 2023*

[server]
redirect-using-relative = yes


but from the pdweb.debug we see



{noformat}2023-02-13-08:46:08.648-06:00I----- thread(9) trace.pdweb.debug:2 /build/isva10020/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- Browser <=== PD -----------------
Thread 9; fd 256; local 10.183.66.135:443; remote 10.183.17.114:62447
HTTP/1.1 302 Moved Temporarily
content-length: 1623
content-type: text/html
date: Mon, 13 Feb 2023 14:46:08 GMT
location: /portals/wps/PA_EnterpriseLogin/TAMResponseHandlerServlet?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&URL=https%3A%2F%2F
10.183.66.135%2F&REFERER=



{noformat}



Daniel","14/Feb/23 2:57 AM;5b15d9e581c3df12acf53c4a;I see, unfortunately,  there were two source file changes for two different customers, I do not have that old build environment so I will not be able to surely say whether or not this fix pack contain both………….

In the worst case, I can build a new one containing both fixes with new options……………",14/Feb/23 2:58 AM;5b15d9e581c3df12acf53c4a;Just let me know what will be their final ISVA version i.e. will they remain on GA or will they install a FP etc.,"14/Feb/23 3:01 AM;5b15d9a0dda5f94d06b985b3;Increasing to sev2 per customer since they went live with this yesterday….

”Most of the users try to access the website with the hostname but not the complete URL.  So it is giving session expired messages. Users are raising the tickets. help desk team guiding them with a workaround. So its not complete down but users are getting panicked when seeing session expired message instead of default home page. I will put it to sev2”



But I guess the question I have….did these changes also apply to the %URL% when used via the local response redirect?     I had opened the original case where you wrote the first fix, and in that one %URL% was used as part of an html response page, not part of LRR query string.    I’m wondering if there is a different code path for the LRR query strong or something?



For what it’s worth, I’m not sure why, but I setup a 10.0.2 system and tried it, and in my case I get relative URL even without having to set 
redirect-using-relative = yes

so I’m not sure what the difference is between me and the customer.



Daniel","14/Feb/23 3:03 AM;5b15d9e581c3df12acf53c4a;I hope they did not make any spelling mistake.

As far as code path goes, I remember you and the customer tested the fix  and only two files contain code where we modify %URL%.

Since it is working in your env, hope some config is different in customer’s env.

Also keep in mind that, this customer was also happy before upgrading, so I believe, code path that we changed is OK.","14/Feb/23 4:10 AM;5b15d9a0dda5f94d06b985b3;Hi Motiur,
What I pasted in the case was copy and paste from their support file 

/ecurep/sf/TS012/127/TS012127611/2023-02-13/isva_10.0.2.0_20230213-084751_ND76MWSL01.ITOCSERVICES.COM.support_unpack/var/pdweb/Default/log

since I was also trying to make sure there was no typo.   



I don’t know why mine works and theirs doesn’t.    Could it be related to another setting?      They upgraded while mine is a native 10.0.2.



Daniel","14/Feb/23 6:21 AM;5b15d9e581c3df12acf53c4a;Two code file change that I mentioned was reported by two different customer and each of them were facing issues which were addressed by each changes i.e. one file changed addressed one customer and other file change addressed other customer ( depending on their scenario )……

So it could be that  the fixpack you  have contained both changes but the one you provided to customer does not………………

So, best will be to create a new one…….

Will you confirm that they will remain on 10.0.2.0 GA or will they install any fixpack or  IF?","14/Feb/23 6:24 AM;5b15d9a0dda5f94d06b985b3;Ok let me check.   I can ask them.   And to clarify, on my system I do not have any fixpack at all related to this, but it seems to work.    The cust doesn’t have any fixpacks but I will check if they plan to install any IFs.   Thx","14/Feb/23 6:24 AM;5b15d9e581c3df12acf53c4a;OK,  what was their original Jira Item of their problem?  So that I can back track?

Oh..it seems like brand new customer? Right?","14/Feb/23 6:29 AM;5b15d9e581c3df12acf53c4a;Have them try the one in

[https://cloudidentity.atlassian.net/browse/ISAMSUP-3271|https://cloudidentity.atlassian.net/browse/ISAMSUP-3271|smart-link]

with old option i.e.

redirect-using-relative = yes","14/Feb/23 6:39 AM;5b15d9a0dda5f94d06b985b3;That is what I gave them and had them set that setting, but it’s not working for them for some reason.     This is why I was wondering if LRR query string was handled differently or something (just grasping at straws).","14/Feb/23 6:45 AM;5b15d9a0dda5f94d06b985b3;Ok, they confirmed they have no plans on 10.0.2 IF1, they want to stick with 10.0.2 for now.    ","14/Feb/23 6:51 AM;5b15d9a0dda5f94d06b985b3;for the record….

/ecurep/sf/TS012/127/TS012127611/2023-02-13/isva_10.0.2.0_20230213-084751_ND76MWSL01.ITOCSERVICES.COM.support_unpack

+ /usr/sbin/mesa_control fixpack_get_history

Monday, February 13, 2023 at 8:31:09 AM|URL_macro_is_not_server_relative_10020|URL_macro_is_not_server_relative_10020|Yes|Installed|%URL% macro is not server relative any more|1676298669


$ grep -i fixpack messages

Feb 13 08:31:03 mesa_control[12371]: Installing fixpack from file /tmp/fixpacktmpdir/URL_macro_is_not_server_relative_10020.fixpack
Feb 13 08:31:09 mesa_install_fixpack: URL_macro_is_not_server_relative_10020 install successful
Feb 13 08:31:09 mesa_control[12371]: Fixpack /tmp/fixpacktmpdir/URL_macro_is_not_server_relative_10020.fixpack: install successful


$ amconf -a redirect-using-relative webseald-Default.conf

[server]
redirect-using-relative = yes


(amconf is just my own script to look through the config file for settings)","14/Feb/23 7:14 AM;5b15d9e581c3df12acf53c4a;OK, in that case, it must be the other file..before I dived into the fp creation…..","14/Feb/23 7:19 AM;5b15d9e581c3df12acf53c4a;OK, can you give them this one?

This one modified other file

[https://ibm.ent.box.com/folder/155384605526?s=uvg6es68a65v0fi08lvsouhby75152z4|https://ibm.ent.box.com/folder/155384605526?s=uvg6es68a65v0fi08lvsouhby75152z4]

Earlier one i.e. one in Jira 3271 modified different source file compared to the above one in the box.

Same old option i.e.

redirect-using-relative = yes","14/Feb/23 10:40 PM;5b15d9a0dda5f94d06b985b3;Forgot to update, I sent them this updated fixpack yesterday evening, will let you know when I hear back from them.","17/Feb/23 2:03 AM;5b15d9a0dda5f94d06b985b3;Good new [~accountid:5b15d9e581c3df12acf53c4a] this second fixpack did the trick.   So one last thing….can you confirm which ISVA version included the code changes for this latest fixpack?   In other words which version of ISVA no longer will require them to use the fixpack?

Thanks!","17/Feb/23 2:41 AM;5b15d9e581c3df12acf53c4a;BTW:

This particular issue was fixed under. [https://cloudidentity.atlassian.net/browse/ISAMSUP-3640|https://cloudidentity.atlassian.net/browse/ISAMSUP-3640|smart-link]



The  2nd fixpack that just worked for this customer is in ISVA 10.04.0

i.e. if they moved to ISVA 10.0.4.0, they will NOT have to change anything.

*_BUT………………_*

The fix was re-done in 10.0.5.0 with a different option i.e.

[server]
allow-url-macro-to-be-relative = true

So, when they move to 10.0.5.0 or up, they will have to use this new option, that’s all, 

Presence or absence of Old option i.e. “redirect-using-relative = yes” will have no affect for this fix in 10.0.5.0 or up.

Hope it is not much confusing.

(Bottom line: I should have used this new option to  fix the code originally……………)",17/Feb/23 2:48 AM;5b15d9a0dda5f94d06b985b3;Ok thanks for the clarification!,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Dynatrace installation failing with non default port,ISAMSUP-4786,280940,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,13/Feb/23 8:50 PM,16/Feb/23 4:20 PM,14/Jul/23 2:47 PM,16/Feb/23 4:20 PM,,Support,,0,,,,"Observed encoding issue when customer uses non default port for dynatrace agent installation

Installation fails with error

1     Downloading the Dynatrace OneAgent installer....
2     --2023-02-13 11:18:14-- [https://ldp2apdyeg01|https://ldp2apdyeg01/]*%5C*:9999/e/djd08171/api/v1/deployment/installer/agent/unix/default/latest?Api-Token=dt0c01.ZNNCKZPHBNDMLYDT2PWEMG6F.6FYESISH6HGFXGUFVG3YNY6F2XP5HA262FKFJTJSOM4MZXESYTSH2VDH6TNP5C5R&arch=x86&flavor=default
3     Resolving ldp2apdyeg01*\\* (ldp2apdyeg01\\)... failed: Name or service not known.
4     wget: unable to resolve host address ‘ldp2apdyeg01\\’
5     Installing the Dynatrace OneAgent....



%5c is encoding of \

Due to that it adds \\ in hostname and it fails to resolve.

With default port, installation worked in another environment having same ISVA 10.0.2 version.

Let me know if you need any logs from customer. Configuration screenshot available on ecurep at

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012059305&path=TS012059305%2F2023-02-09%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012059305&path=TS012059305%2F2023-02-09%2F]",,Tushar Prasad,,,,,,,,,,,,,,,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012059305,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,,,,ABU DHABI ISLAMIC BANK NEAR CENTRAL BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18bgj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-02-14 00:30:22.962,,,,,"14/Feb/23 10:30 AM;5b15d954b0d76456f36daf33;[~accountid:5b1757156d76184b7d98a0c3] this is a known defect  [https://cloudidentity.atlassian.net/browse/ISAMDEV-7760|https://cloudidentity.atlassian.net/browse/ISAMDEV-7760|smart-link] 


{noformat}clusterEndpointAPI=1.2.3.4\:5050{noformat}

vs 

{noformat}clusterEndpointAPI=1.2.3.4:5050{noformat}



If they were to upgrade to 10.0.4.0 or 10.0.5.0, they shouldn’t see this problem.",14/Feb/23 5:16 PM;5b1757156d76184b7d98a0c3;[~accountid:5b15d954b0d76456f36daf33] Is it fixed in version of ISVA 10.0.4/10.0.5  or in Dynatrace agent extension latest version?,14/Feb/23 6:15 PM;5b15d954b0d76456f36daf33;ISVA 10.0.4.0+,16/Feb/23 4:20 PM;5b1757156d76184b7d98a0c3;[~accountid:5b15d954b0d76456f36daf33] Thank you for the confirmation. Case has been closed. Closing Jira.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Proxy Protocol does not work when HTTP2 is enabled.,ISAMSUP-4782,280499,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,10/Feb/23 5:09 AM,09/Mar/23 8:23 AM,14/Jul/23 2:47 PM,09/Mar/23 8:23 AM,10.0.6,Support,,0,,,,"Customer is running 10.0.5.0 Containers but I have recreate using VM.

The setup is Client → F5 Pass-thru (Adding Proxy Protocol header V1) → WRP.  The reason for using Proxy Protocol is client-cert authentication is needed at WRP.

The customer has also implemented several client-ip-rules.

I have setup something similar using HAProxy.  When HTTP2 is not enabled everything works fine.  Trace shows Proxy Protocol header,

{noformat}2023-02-09-12:49:47.170-06:00I----- thread(6) trace.pdweb.wan.server:9 /build/isam/src/i4w/pdweb/webseald/http/server/WsListener.cpp:1469: [] Received a version 1 proxy protocol header.
2023-02-09-12:49:47.170-06:00I----- thread(6) trace.pdweb.wan.server:9 /build/isam/src/i4w/pdweb/webseald/http/server/WsListener.cpp:1490: [] Proxy protocol header: 'PROXY TCP4 9.160.162.219 192.168.16.2 55355 443'.
2023-02-09-12:49:47.170-06:00I----- thread(6) trace.pdweb.wan.server:9 /build/isam/src/i4w/pdweb/webseald/http/server/WsListener.cpp:1511: [] Parsed the proxy protocol family: TCP4.
2023-02-09-12:49:47.170-06:00I----- thread(6) trace.pdweb.wan.server:9 /build/isam/src/i4w/pdweb/webseald/http/server/WsListener.cpp:1531: [] Proxy protocol source information: 9.160.162.219:55355.
2023-02-09-12:49:47.170-06:00I----- thread(6) trace.pdweb.wan.server:9 /build/isam/src/i4w/pdweb/webseald/http/server/WsListener.cpp:1540: [] Received an IPv4 address.
{noformat}

The client-ip-rule settings work as expected.

When HTTP2 is enabled,


[server]
enable-http2 = yes

The following message is thrown,

2023-02-09-12:49:47.468-06:00I----- 0x38983439 webseald ERROR wad general WsListener.cpp 1585 0x7f055c377700 -- DPWAD1081E   An invalid proxy protocol header was received from '9.160.162.219'.

The trace show the same as above but then later on shows,



{noformat}2023-02-09-12:49:47.467-06:00I----- thread(8) trace.pdweb.wan.server:9 /build/isam/src/i4w/pdweb/webseald/http/server/WsListener.cpp:1585: [] An invalid proxy protocol header was received.{noformat}



The proxy protocol header is the same so why is it invalid?

Does HTTP2 not support Proxy Protocol V1?",,khansen,tonyferg,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4808,,10/Feb/23 7:24 AM;nlloyd;isva_10.0.5.0_20230209-131045_isva1050.kvm.org.support;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182898,,,,,,,,,,,,,,,IJ45492,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012099225,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nick Lloyd,5b15d9e6dda5f94d06b985b4,,,,PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2023-02-23T01:32:10.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":5,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,Yes,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i188rf:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-10 02:51:08.083,,,,,10/Feb/23 5:16 AM;5b15d9e6dda5f94d06b985b4;Attached Support file from my lab.,10/Feb/23 12:51 PM;5b15d954b0d76456f36daf33;I can’t find any conclusive information about such support one way or the other. Until then we’ll treat it as a defect and work on a potential solution.,"13/Feb/23 10:32 AM;5b15d954b0d76456f36daf33;[~accountid:5b15d9e6dda5f94d06b985b4] can you please add the recreation steps to this item? I don’t have access to F5, but HAProxy should be doable.

Just so I know how to test any potential fix","14/Feb/23 2:18 AM;5b15d9e6dda5f94d06b985b4;Configure WRP with:


{noformat}[server]
https = yes
https-port = 443
https-proxy-protocol = true
enable-http2 = yes
client-ip-rule = +*  <============== Allow anything for purposes of testing.{noformat}



For HAProxy I used a simple docker lab.

{noformat}cat haproxy.cfg <=== Create a file named haproxy.cfg
global
        daemon
        maxconn 256

    defaults
        timeout connect 5000ms
        timeout client 60000ms
        timeout server 60000ms

        frontend https-in
                bind 0.0.0.0:443
                mode tcp
                default_backend servers-https

        backend servers-https
                server server1 9.30.219.58:4430 send-proxy{noformat}

{noformat}cat 502.html <=== Create a file named 502.html
HTTP/1.0 502 Bad Gateway
Cache-Control: no-cache
Connection: close
Content-Type: text/html

<html><body><h1>502 Bad Gateway</h1>
The server returned an invalid or incomplete response.
</body></html>{noformat}

{noformat}cat Dockerfile-haproxy <=== Create a file named Dockerfile-haproxy
FROM haproxy:latest
LABEL maintainer=""nlloyd@us.ibm.com"" vendor=""ISVAL2""
COPY haproxy.cfg /usr/local/etc/haproxy/haproxy.cfg
COPY 502.html /usr/local/etc/haproxy/errors/502.html{noformat}

{noformat}cat docker-compose.yml <=== Create a file named docker-compose.yml
version: '3.7'

services:
  haproxy-proxy-protocol:
    container_name: haproxy-proxy-protocol
    image: haproxy-proxy-protocol
    expose:
      - ""443""
    ports:
      - 0.0.0.0:443:443
    domainname: ""level2.org""
    hostname: ""haproxy-proxy-protocol""{noformat}


docker build -t haproxy-proxy-protocol --file Dockerfile-haproxy .

docker-compose up",18/Feb/23 2:42 AM;5b15d9e6dda5f94d06b985b4;Customer is asking for status.,"20/Feb/23 10:17 AM;5b15d954b0d76456f36daf33;[~accountid:5b15d9e6dda5f94d06b985b4] sorry I haven’t had a chance to revisit this because of a couple of other items in my queue.

I spoke to [~accountid:5b15d9517dab4c51f61b5190] and he has kindly agreed to work on this in the meantime, so giving it to him.","20/Feb/23 5:35 PM;5b15d9517dab4c51f61b5190;I have  setup using onboard haproxy (felb)

When I enable proxy protocol with {{send-proxy}}

I am getting the same DPWAD1081E error when I issue a request

I get continuous GSKIT errors logged by webseal every 10 seconds (regardless of whether or not I have specified htps-proxy-protocol in webseal)

I need to check the http2 code","20/Feb/23 10:18 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9e6dda5f94d06b985b4] 

I have found the issue in the http2 code

Please open an APAR “{{issue when both https-proxy-protocol}} = true and enable-http2 = yes”

IBM Internal only

We are calling the readProxyProtocolHeader() too early from the http2 code

I did a test where I changed it to call a dummy method which does nothing.

It still got called later on as needed and now works  with both proxy protocol v1 and v2

FYI

In my setup 10.150.27.113 is the felb virtual ip - backend server is 172.21.0.113

When testing my experimental change I found you can test it with curl - direct to webseal host and port (without requiring  felb)

Direct

curl -k --haproxy-protocol -vvv --http2 [https://172.21.0.113/|https://172.21.0.113/]

curl -k --haproxy-protocol -vvv --http1.1 [https://172.21.0.113/|https://172.21.0.113/]

curl -k --haproxy-protocol -vvv --http1.0 [https://172.21.0.113/|https://172.21.0.113/]

via haproxy

curl -k  -vvv --http2 [https://10.150.27.113/|https://10.150.27.113/]","21/Feb/23 11:27 AM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9e6dda5f94d06b985b4] 

FYI

I intend to bundle other fixed 10.0.5.0 APARS in the fixpack because they are all in the same library - libwsdaemon.so

IJ45258 is a separate issue with http2

Also IJ44874 (Rate Limiting), IJ45228 (crash), IJ44960 (Websockets Crash)","21/Feb/23 12:29 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 005a8b6afd3dd324546682514cec535e233fb4ed
   * description: ISAMSUP-4782 IJ45492 https-proxy-protocol = true and http2

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85159193.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4782) which we publish.","21/Feb/23 5:57 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f2ac5695a8b5e609f9fdfe8af0fd5c179c8f7daa
   * description: ISAMSUP-4782 IJ45492 https-proxy-protocol = true and http2 (#5703)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85170776.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230221075457-f2ac5695.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","21/Feb/23 6:32 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f2ac5695a8b5e609f9fdfe8af0fd5c179c8f7daa
   * description: ISAMSUP-4782 IJ45492 https-proxy-protocol = true and http2 (#5703)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85172456.


This build has not been published as the commit is not currently within a branch (20230221070945-d1cf2cba) which we publish.","21/Feb/23 7:17 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f2ac5695a8b5e609f9fdfe8af0fd5c179c8f7daa
   * description: ISAMSUP-4782 IJ45492 https-proxy-protocol = true and http2 (#5703)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85174751.


This build has not been published as the commit is not currently within a branch (20230221075457-f2ac5695) which we publish.",22/Feb/23 7:48 PM;5b15d9517dab4c51f61b5190;The fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4808|https://cloudidentity.atlassian.net/browse/ISAMSUP-4808|smart-link] ,"23/Feb/23 1:32 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f2ac5695a8b5e609f9fdfe8af0fd5c179c8f7daa
   * description: ISAMSUP-4782 IJ45492 https-proxy-protocol = true and http2 (#5703)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85293652.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230222152905-f2ac5695.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","23/Feb/23 3:05 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f2ac5695a8b5e609f9fdfe8af0fd5c179c8f7daa
   * description: ISAMSUP-4782 IJ45492 https-proxy-protocol = true and http2 (#5703)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85302301.


This build has not been published as the commit is not currently within a branch (20230222152905-f2ac5695) which we publish.","07/Mar/23 9:31 AM;5b15d9e6dda5f94d06b985b4;The fixpack worked fine with my 10.0.5.0 VM.

Customer is using containers.  The fixpack does not load:

{""instant"":{""epochSecond"":1678120329},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/[bootstrap.sh|https://bootstrap.sh/]""}, ""content"":""WGAWA0968E Failed to apply the fixpack: IJ45492_10050.fixpack.""}

I did notice all the fixpacks in play fail:

{""instant"":{""epochSecond"":1678120329},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/bootstrap.sh""}, ""content"":""WGAWA0967I   Applying the fixpack: 1050_log_console_fix_V3.fixpack.""}
{""instant"":{""epochSecond"":1678120329},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/bootstrap.sh""}, ""content"":""WGAWA0968E   Failed to apply the fixpack: 1050_log_console_fix_V3.fixpack.""}


{""instant"":{""epochSecond"":1678120329},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/bootstrap.sh""}, ""content"":""WGAWA0967I   Applying the fixpack: 1050_PD_audit_json_fix_V1.fixpack.""}
{""instant"":{""epochSecond"":1678120329},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/bootstrap.sh""}, ""content"":""WGAWA0968E   Failed to apply the fixpack: 1050_PD_audit_json_fix_V1.fixpack.""}


{""instant"":{""epochSecond"":1678120329},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/bootstrap.sh""}, ""content"":""WGAWA0967I   Applying the fixpack: fix_audit_cfg.fixpack.""}
{""instant"":{""epochSecond"":1678120329},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/bootstrap.sh""}, ""content"":""WGAWA0968E   Failed to apply the fixpack: fix_audit_cfg.fixpack.""}


{""instant"":{""epochSecond"":1678120329},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/bootstrap.sh""}, ""content"":""WGAWA0967I   Applying the fixpack: IJ45492_10050.fixpack.""}
{""instant"":{""epochSecond"":1678120329},""threadId"":""1"",""level"":""INFO"",""loggerName"":""system"",""component"":""bootstrap"",""source"":{""file"":""/sbin/bootstrap.sh""}, ""content"":""WGAWA0968E   Failed to apply the fixpack: IJ45492_10050.fixpack.""}



The snapshot manager is being used (which at the moment does not support fixpack OOTB.  Idea has been opened).
The fixpacks were manually put into the snapshot manager container and the logs show the GETs were successful:


$ oc logs isam-snapshotmgr-0 | grep fixpacks
10.125.128.81 - - [06/Mar/2023 16:32:09] ""GET /fixpacks/1050_log_console_fix_V3.fixpack?type=File&client=isam-wrp-low-0 HTTP/1.1"" 200 -
10.125.128.81 - - [06/Mar/2023 16:32:09] ""GET /fixpacks/1050_PD_audit_json_fix_V1.fixpack?type=File&client=isam-wrp-low-0 HTTP/1.1"" 200 -
10.125.128.81 - - [06/Mar/2023 16:32:09] ""GET /fixpacks/fix_audit_cfg.fixpack?type=File&client=isam-wrp-low-0 HTTP/1.1"" 200 -
10.125.128.81 - - [06/Mar/2023 16:32:09] ""GET /fixpacks/IJ45492_10050.fixpack?type=File&client=isam-wrp-low-0 HTTP/1.1"" 200 -



Any idea?","07/Mar/23 4:55 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9e6dda5f94d06b985b4] 

The first issue is I uploaded the legacy version of the fixpack to box by mistake

It still works on VM’s but not on docker as it uses mount/unmount

I will upload the correct fixpack and update the links in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4808|https://cloudidentity.atlassian.net/browse/ISAMSUP-4808|smart-link]

We have successfully installed it on the config container

We also verified the other fixpacks are in the new format - not the legacy format

There seems to be an issue installing fixpacks on the wrp image

We have reproduced the fixpack fails to install issue on a wrp image

We are still trying to track down the cause","07/Mar/23 5:12 PM;5b15d9517dab4c51f61b5190;The fixpack links have been update in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4808|https://cloudidentity.atlassian.net/browse/ISAMSUP-4808|smart-link] 

Please re download the fixpack",08/Mar/23 1:40 AM;5b15d9e6dda5f94d06b985b4;Sent to customer.,"08/Mar/23 5:45 AM;5b15d9e6dda5f94d06b985b4;Still not working:



Further from the shell of isam-wrp-low using commands from the bootstrap common file:

sh-4.4$ /usr/sbin/isva_install_fixpack -i /tmp/fixpacks/IJ45492_10050v2.fixpack

IJ45492_10050v2: Failed to verify signature



Granted, IDK if I need to have elevated rights for that to actually work.

Ok, well I think this whole image is busted.



/sbin/[bootstrap.sh|https://bootstrap.sh/] includes /sbin/.bootstrap_common.sh

/sbin/.bootstrap_common.sh calls /usr/sbin/isva_install_fixpack

/usr/sbin/isva_install_fixpack calls /usr/bin/isva-sign to verify the fixpack signature.

/usr/bin/isva-sign does not exist. The v10.0.5.0 WRP image is broken, no fixpack will work. Not sure about the DSC and runtime containers.

So we have a bigger issue here.","08/Mar/23 3:07 PM;5b15d9517dab4c51f61b5190;You are correct - the issue is the missing /usr/bin/isva-sign

Since this is a separate issue to the original problem

Can you create a follow on Jira item and assign it to me 

Can you also create an APAR “fixpacks fail to install on 10.0.5.0 docker lightweight images” and add it to the new item

I am pretty sure this will require new image(s) to fix

I know what is required - I manually built  a wrp docker image today that allows fixpacks to be installed",09/Mar/23 6:08 AM;5b15d9e6dda5f94d06b985b4;[https://cloudidentity.atlassian.net/browse/ISAMSUP-4853|https://cloudidentity.atlassian.net/browse/ISAMSUP-4853|smart-link] ,09/Mar/23 8:23 AM;5b15d9517dab4c51f61b5190;Closing this item,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
webseal crash observed after upgrading to v10.0.5,ISAMSUP-4775,279464,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Virag Patel,5b17571a82e05b22cc7d5d9e,Virag Patel,5b17571a82e05b22cc7d5d9e,04/Feb/23 6:15 PM,21/Feb/23 9:15 PM,14/Jul/23 2:47 PM,21/Feb/23 9:15 PM,10.0.6,Support,,0,,,,"After updating to v10.0.5.0 from v10.0.4.0, our TFIMSSO junction is broken under v10.0.5.0. 

the error message we got from the WebSEAL as below, 2



{noformat}023-01-23-15:43:35.786+11:00I----- 0x38CF0B24 webseald ERROR wwa soap AMWTFIMSOAPCall.cpp 118 0x7f7c86616700 -- DPWWA2852E An error occurred when attempting to communicate with the SOAP server URL https://e1-intfedaac.auth.bcz.gov.au:443/TrustServerWS/SecurityTokenServiceWST13: The given SOAPAction null does not match an operation. (error code: 71/0x47). 

2023-01-23-15:43:35.786+11:00I----- 0x38A0A1C5 webseald ERROR wds stsclient AMWTFIMClient.cpp 340 0x7f7c86616700 -- DPWDS0453E The STS response did not contain the element 'RequestSecurityTokenResponse'{noformat}

[https://nsh.e1-portals.immi.gov.au|https://nsh.e1-portals.immi.gov.au] is the junction. O

n 10.0.4.0 it gets it's JWT, but on 10.0.5.0 it does not get the JWT, 

WebSEAL complains and makes a server error and does not send the user over. 

the configuration of TFIMSSO is below, 

{noformat}[tfimsso:nsh] 

token-type = urn:ietf:params:oauth:token-type:jwt 

applies-to = https://e4-nshpc-internal.dinnp.bcz.gov.au 

renewal-window = 15 

preserve-xml-token = false 

always-send-tokens = true 

tfim-cluster-name = oauth-cluster 

one-time-token = false 

token-collection-size = 1 

token-transmit-type = header

 token-transmit-name = authorization{noformat}",,adarsh.nair,,,,,,,,,,,,,,,605c0c04b18de50071046740,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4447,,,,ISAMSUP-4776,,,,,,,,,,,,,,,,,IJ45228,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011921981,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Virag Patel,5b17571a82e05b22cc7d5d9e,,,,"DEPARTMENT OF HOME AFFAIRS, AU",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-02-06T15:10:57.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,/ecurep/sf/TS011/921/TS011921981/2023-02-02/,,,,,,,,,,,,,,,,,,,,,,,0|i182fn:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-06 02:11:42.193,,,,,"04/Feb/23 6:18 PM;5b17571a82e05b22cc7d5d9e;IBM Support file:

/ecurep/sf/TS011/921/TS011921981/2023-02-02/isva_10.0.5.0_20230203-042609_pdcoe1vas01-m.immi.gov.au.support_unpack/



/var/log/messages shows:

{noformat}Feb  3 04:03:15 mesa_crashd[1091]: Error: CRASH: program=webseald-intranet pid=26183 reason=""address not mapped to object"" signal=11 code=1 addr=(nil) stack='0x7f5a2a3eecfe 0x7f5a27459ce0 0x7f5a2a352724 0x7f5a2a352b52 0x7f5a2744f1cf 0x7f5a2678cdd3 ' regs='0x7f598c276b28 0x7f598c158e90 0x7f598c276b20 0x0 0x7f5a2a70da60 0x0 0x7f5a2a70d2f8 0x0 0x7f59e6e758b0 0x1 0x0 0x7f5a0805c500 0x1 0x0 0x1 0x7f59e6e75850 0x7f5a2a352724 0x10202 0x2b000000000033 0x4 0xe 0x5007 0x0 '
Feb  3 04:21:45 mesa_crashd[1091]: Error: CRASH: program=webseald-intranet pid=8440 reason=""address not mapped to object"" signal=11 code=1 addr=(nil) stack='0x7f55e4213cfe 0x7f55e127ece0 0x7f55e4177724 0x7f55e4177b52 0x7f55e12741cf 0x7f55e05b1dd3 ' regs='0x7f55cc001698 0x7f55cc001aa0 0x7f55cc001690 0x0 0x7f55e4532a60 0x0 0x7f55e45322f8 0x0 0x7f55accaa8b0 0x1 0x0 0x7f558c0adb30 0x1 0x0 0x1 0x7f55accaa850 0x7f55e4177724 0x10202 0x2b000000000033 0x4 0xe 0x5007 0x0 '{noformat}



webseal message log file shows:



{noformat}2023-02-03-04:03:17.437+11:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 657 0x7fbfcee30700 -- WGAWA0034E   The process, /opt/pdweb/bin/webseald, was terminated by the signal, 11.  The process will be automatically restarted. -- IBM Security Verify Access WebSEAL Version 10.0.5.0 (Build 20221129_1816) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.


2023-02-03-04:21:46.828+11:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 657 0x7fc2ed451700 -- WGAWA0034E   The process, /opt/pdweb/bin/webseald, was terminated by the signal, 11.  The process will be automatically restarted. -- IBM Security Verify Access WebSEAL Version 10.0.5.0 (Build 20221129_1816) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.{noformat}



the webseal core file is generated at:

/ecurep/sf/TS011/921/TS011921981/2023-02-02/isva_10.0.5.0_20230203-042609_pdcoe1vas01-m.immi.gov.au.support_unpack/core_file_stack_trace $ ls
core_webseald.26183.stack  

core_webseald.8440.stack","06/Feb/23 12:11 PM;5b15d9517dab4c51f61b5190;[~accountid:5b17571a82e05b22cc7d5d9e] 

I have looked at the code and can see an error that will cause  a crash that would match the stack trace

Please open an APAR “Webseal crash in waitOnConnections”

Please include the following stack trace

{noformat}#0  0x00007f55e4177724 in WsWorker::waitOnConnections() () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#1  0x00007f55e4177b52 in WsPersistentPoolThread () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#2  0x00007f55e12741cf in start_thread () from /lib64/libpthread.so.0
No symbol table info available.
#3  0x00007f55e05b1dd3 in clone () from /lib64/libc.so.6
No symbol table info available.
{noformat}

This crash is 10.0.5.0 specific - as the error I can see was introduced in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4447|https://cloudidentity.atlassian.net/browse/ISAMSUP-4447|smart-link] ","06/Feb/23 12:48 PM;5b17571a82e05b22cc7d5d9e;[~accountid:5b15d9517dab4c51f61b5190] 
I have created APAR : IJ45228

pls verify the component ID and other information are correct","06/Feb/23 1:44 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: d8cf05dfcc6baba93cbc17ebb63da846979f10a5
   * description: ISAMSUP-4775 APAR TBA Crash in waitOnConnections

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84127381.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4775) which we publish.",06/Feb/23 1:44 PM;5b15d9517dab4c51f61b5190;I’m not sure the crash is related to the TFIM issue,"06/Feb/23 3:10 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 7f2ed7914eace6f454657bc797557812c41f664d
   * description: ISAMSUP-4775 IJ45228 Crash in waitOnConnections (#5673)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84129581.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230206050749-7f2ed7914.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",06/Feb/23 3:20 PM;5b17571a82e05b22cc7d5d9e;I understand. i will request customer to verify after the fix is applied..,"06/Feb/23 4:30 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 7f2ed7914eace6f454657bc797557812c41f664d
   * description: ISAMSUP-4775 IJ45228 Crash in waitOnConnections (#5673)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84131555.


This build has not been published as the commit is not currently within a branch (20230206050749-7f2ed7914) which we publish.","06/Feb/23 4:41 PM;5b15d9517dab4c51f61b5190;[~accountid:5b17571a82e05b22cc7d5d9e] 

The fixpack for the crash fix is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4776|https://cloudidentity.atlassian.net/browse/ISAMSUP-4776|smart-link] ",07/Feb/23 12:22 PM;5b17571a82e05b22cc7d5d9e;Fix sent to customer for verification,"21/Feb/23 3:23 PM;605c0c04b18de50071046740;[~accountid:5b15d9517dab4c51f61b5190] ,
for the original Federation STS issue, customer has uploaded new set of support files from Federation component of both 10.0.4.0(working) and 10.0.5.0(non-working)

from 10.0.4.0 message logs I could see below extension related messages '*Adding the extensions from bundle*' during Fed runtime startup.

S:\sf\TS011\921\TS011921981\2023-02-14\isva_10.0.4.0_20230214-193311_pdcoe1vas02-m_Federation.support_unpack\tmp\liberty_runtime_dump.zip_unpack\logs\messages.log

{noformat}Line  43: [2/14/23, 19:12:56:755 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.transports.http.3.2 (159) [org.apache.cxf.transport.http.HTTPTransportFactory, org.apache.cxf.transport.http.HTTPWSDLExtensionLoader, org.apache.cxf.transport.http.policy.HTTPClientAssertionBuilder, org.apache.cxf.transport.http.policy.HTTPServerAssertionBuilder, org.apache.cxf.transport.http.policy.NoOpPolicyInterceptorProvider]
	Line  44: [2/14/23, 19:12:56:766 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.core.3.2 (163) [org.apache.cxf.phase.PhaseManager, org.apache.cxf.workqueue.WorkQueueManager, org.apache.cxf.buslifecycle.BusLifeCycleManager, org.apache.cxf.endpoint.ServerRegistry, org.apache.cxf.endpoint.EndpointResolverRegistry, org.apache.cxf.headers.HeaderManager, org.apache.cxf.service.factory.FactoryBeanListenerManager, org.apache.cxf.endpoint.ServerLifeCycleManager, org.apache.cxf.endpoint.ClientLifeCycleManager, org.apache.cxf.resource.ResourceManager, org.apache.cxf.catalog.OASISCatalogManager, org.apache.cxf.transport.http.HTTPTransportFactory, org.apache.cxf.common.util.ASMHelper, org.apache.cxf.common.spi.ClassLoaderService, org.apache.cxf.transport.http.HTTPConduitFactory, org.apache.cxf.transport.ConduitInitiator]
	Line  45: [2/14/23, 19:12:56:790 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.ws.addr.2.6.2 (246) [org.apache.cxf.ws.addressing.policy.AddressingAssertionBuilder, org.apache.cxf.ws.addressing.policy.UsingAddressingAssertionBuilder, org.apache.cxf.ws.addressing.policy.AddressingPolicyInterceptorProvider, org.apache.cxf.ws.addressing.impl.AddressingWSDLExtensionLoader, org.apache.cxf.ws.addressing.WSAddressingFeature$WSAddressingFeatureApplier, org.apache.cxf.ws.addressing.MAPAggregator$MAPAggregatorLoader]
	Line  46: [2/14/23, 19:12:56:793 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.bindings.soap.2.6.2 (248) [org.apache.cxf.binding.soap.SoapBindingFactory, org.apache.cxf.binding.soap.SoapTransportFactory]
	Line  47: [2/14/23, 19:12:56:796 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.bindings.xml.2.6.2 (254) [org.apache.cxf.binding.xml.XMLBindingFactory, org.apache.cxf.binding.xml.wsdl11.XMLWSDLExtensionLoader]
	Line  48: [2/14/23, 19:12:56:798 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.frontend.jaxws.2.6.2 (256) [org.apache.cxf.jaxws.context.WebServiceContextResourceResolver]
	Line  49: [2/14/23, 19:12:56:800 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.management.2.6.2 (258) [org.apache.cxf.management.InstrumentationManager]
	Line  50: [2/14/23, 19:12:56:803 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator                         I Adding the extensions from bundle com.ibm.ws.org.apache.cxf.cxf.rt.transports.http.2.6.2 (264) [org.apache.cxf.transport.http.HTTPTransportFactory, org.apache.cxf.transport.http.HTTPWSDLExtensionLoader, org.apache.cxf.transport.http.policy.HTTPClientAssertionBuilder, org.apache.cxf.transport.http.policy.HTTPServerAssertionBuilder, org.apache.cxf.transport.http.policy.NoOpPolicyInterceptorProvider]
	Line  51: [2/14/23, 19:12:56:810 AEDT] 0000001b org.apache.cxf.bus.osgi.CXFActivator    {noformat}

           

In 10.0.5.0 it's missing.
S:\sf\TS011\921\TS011921981\2023-02-14\isva_10.0.5.0_20230214-201226_pdcoe1vas02-m.Federation.support_unpack\tmp\liberty_runtime_dump.zip_unpack\logs\messages.log



from 10.0.5.0 trace log not much information available.

S:\sf\TS011\921\TS011921981\2023-02-14\isva_10.0.5.0_20230214-201226_pdcoe1vas02-m.Federation.support_unpack\tmp\liberty_runtime_dump.zip_unpack\logs\trace.log

{noformat}[2/14/23, 20:07:57:737 AEDT] 00000027 id=00000000 com.tivoli.am.fim.sts.jaxws.handlers.RemoveSoapActionHandler > handleMessage ENTRY
[2/14/23, 20:07:57:738 AEDT] 00000027 id=00000000 com.tivoli.am.fim.sts.jaxws.handlers.RemoveSoapActionHandler 3 handleMessage Removed SOAPAction HTTP header with value [""null""]
[2/14/23, 20:07:57:738 AEDT] 00000027 id=00000000 com.tivoli.am.fim.sts.jaxws.handlers.RemoveSoapActionHandler 3 handleMessage RemoveSoapActionHandler::handleMessage():	ArrayList	http_header_content_type_string={content-type}	content_type_value_object.getClass().getName()={java.util.ArrayList}	content_type_value_object.toString()={[text/xml; charset=UTF-8]}

[2/14/23, 20:07:57:738 AEDT] 00000027 id=00000000 com.tivoli.am.fim.sts.jaxws.handlers.RemoveSoapActionHandler < handleMessage RETURN
[2/14/23, 20:07:57:752 AEDT] 00000027 id=00000000 javax.xml.soap                                               W Using deprecated META-INF/services mechanism with non-standard property: javax.xml.soap.MetaFactory. Property javax.xml.soap.SAAJMetaFactory should be used instead.{noformat}


10.0.5.0 tfimsso log gives following error
{{ Failed to generate the Kerberos token: The given SOAPAction null does not match an operation. [code 71]}}


S:\sf\TS011\921\TS011921981\2023-02-14\pdweb.sso.tfim-DUP0001.log

{noformat}2023-02-14-20:07:57.516+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCall.cpp:107: Executing SOAP Call: RequestSecurityToken

2023-02-14-20:07:57.516+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCluster.cpp:537: AMWSOAPCluster::getMember(): Called

2023-02-14-20:07:57.516+11:00I----- thread(5) trace.pdweb.sso.tfim:4 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCluster.cpp:679: AMWSOAPCluster::getMember(): Returning https://e1-intfedaac.auth.bcz.gov.au:443/TrustServerWS/SecurityTokenServiceWST13 (Only one at Pri 9)

2023-02-14-20:07:57.516+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPHandleMgr.cpp:312: Located a SOAP handle for thread: 0x7f9e6c495700

2023-02-14-20:07:57.775+11:00I----- thread(5) trace.pdweb.sso.tfim:5 /build/isam/src/i4w/pdwebrte/sso/tfim/AMWTFIMSOAPCall.cpp:121: Failed to generate the Kerberos token: The given SOAPAction null does not match an operation. [code 71]
2023-02-14-20:07:57.775+11:00I----- thread(5) trace.pdweb.sso.tfim:8 /build/isam/src/i4w/pdwebrte/sso/tfim/AMWTFIMClient.cpp:358: EXIT AMWTFIMClient::requestSecurityToken err=38a0a1c6
2023-02-14-20:07:57.775+11:00I----- thread(5) trace.pdweb.sso.tfim:6 /build/isam/src/i4w/pdwebrte/sso/tfim/amw_tfimsso.cpp:185: EXIT{noformat}

 

10.0.4.0 STS call returns a JWT

{noformat}2023-02-14-19:25:41.886+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCall.cpp:107: Executing SOAP Call: RequestSecurityToken

2023-02-14-19:25:41.886+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCluster.cpp:537: AMWSOAPCluster::getMember(): Called

2023-02-14-19:25:41.886+11:00I----- thread(5) trace.pdweb.sso.tfim:4 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPCluster.cpp:679: AMWSOAPCluster::getMember(): Returning https://e1-intfedaac.auth.bcz.gov.au:443/TrustServerWS/SecurityTokenServiceWST13 (Only one at Pri 9)

2023-02-14-19:25:41.886+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/soap/AMWSOAPHandleMgr.cpp:312: Located a SOAP handle for thread: 0x7f65c8cb5700

2023-02-14-19:25:46.244+11:00I----- thread(5) trace.pdweb.sso.tfim:8 /build/isam/src/i4w/pdwebrte/sso/tfim/AMWTFIMClient.cpp:358: EXIT AMWTFIMClient::requestSecurityToken err=00000000
2023-02-14-19:25:46.244+11:00I----- thread(5) trace.pdweb.sso.tfim:9 /build/isam/src/i4w/pdwebrte/sso/tfim/AMWTFIMClient.cpp:376: token[  0]: expires=""Tue 14 Feb 2023 08:25:46 PM AEDT"" token=Bearer eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL2UxLWVpc3RzLmF1dGguYmN6Lmdvdi5hdSIsImV4cCI6MTY3NjM2Njc0NiwianRpIjoieGVkWmI4ZkVYRTNpa1F6QjM4dGpkTERDcHhURjJyeEIiLCJpYXQiOjE2NzYzNjMxNDZ9.e2k05loVs0Q-4gqPauMjFK2gYr3OXhYZ9wKjX2E5pws

2023-02-14-19:25:46.244+11:00I----- thread(5) trace.pdweb.sso.tfim:6 /build/isam/src/i4w/pdwebrte/sso/tfim/amw_tfimsso.cpp:185: EXIT amw_tfimsso_request_security_token 0x{noformat}","21/Feb/23 3:54 PM;5b15d9517dab4c51f61b5190;[~accountid:605c0c04b18de50071046740] 

Can you please create a new follow on Jira item for the TFIMSSO problem and assign it to me

This item just fixed the unrelated crash in the title.

We keep to 1 problem per Jira item","21/Feb/23 4:06 PM;605c0c04b18de50071046740;[~accountid:5b15d9517dab4c51f61b5190] ,
assigned you 
[https://cloudidentity.atlassian.net/browse/ISAMSUP-4806|https://cloudidentity.atlassian.net/browse/ISAMSUP-4806|smart-link] ","21/Feb/23 9:15 PM;5b15d9517dab4c51f61b5190;Since we have a follow on Jira item for the tfim issue - I am closing this (crash) issue

Please reopen if any issues found with crash fix",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Signature Algorithm cert in V9.0.7.2,ISAMSUP-4774,279453,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,04/Feb/23 7:09 AM,07/Feb/23 11:26 PM,14/Jul/23 2:47 PM,07/Feb/23 11:26 PM,,,,0,,,,"Daniel and Gabriel is helping case TS011995726.

The customer renewed their webseal cert. It contain Signature Algorithm in the cert. 

In the GSkits trace is shows {{Alert Level:Description (hex)  2:2a : AlertDescription::bad_certificate}}

gskit validation also fails on that intermediate signer

{noformat}$ certs rest_service.kdb |grep -p ""Den Danske Stat OCES udstedende-CA 1 TEST""
!       ""Den Danske Stat OCES udstedende-CA 1 TEST""   Validate: CTGSK2146W An invalid certificate chain was found.
Serial : 734d70a62e521cd17c644c99a0900e1d59e061ae
Issuer : ""C=DK,O=Den Danske Stat,OU=Test - cti,CN=Den Danske Stat OCES rod-CA""
Subject : ""C=DK,O=Den Danske Stat,OU=Test - cti,CN=Den Danske Stat OCES udstedende-CA 1""
Not Before : March 12, 2021 7:42:59 AM GMT+00:00
Not After : March 10, 2031 7:42:58 AM GMT+00:00
Signature Algorithm : RSASSAPSSSignature (1.2.840.113549.1.1.10), Parameters: {hashAlgorithm: SHA512DigestAlgorithm (2.16.840.1.101.3.4.2.3), maskGenAlgorithm: MGF1 (1.2.840.113549.1.1.8), Parameters: SHA512DigestAlgorithm (2.16.840.1.101.3.4.2.3), saltLength: 0x40, trailerField: 0x1}{noformat}

but the CA checks out

{noformat}$ certs -s ""C=DK,O=Den Danske Stat,OU=Test - cti,CN=Den Danske Stat OCES rod-CA"" rest_service.kdb

>> Re-using existing rest_service.kdb.txt file.   Use -n option to re-create it if desired

Results (filtered if -s and/or -i were used):

!       ""Den Danske Stat OCES rod-CA TEST""   Validate: OK
Serial : 573f57e67530f1a0777dfbc69f090438d3360256
Issuer : ""C=DK,O=Den Danske Stat,OU=Test - cti,CN=Den Danske Stat OCES rod-CA""
Subject : ""C=DK,O=Den Danske Stat,OU=Test - cti,CN=Den Danske Stat OCES rod-CA""
Not Before : January 28, 2021 9:49:25 AM GMT+00:00
Not After : January 22, 2046 9:49:24 AM GMT+00:00
Signature Algorithm : RSASSAPSSSignature (1.2.840.113549.1.1.10), Parameters: {hashAlgorithm: SHA512DigestAlgorithm (2.16.840.1.101.3.4.2.3), maskGenAlgorithm: MGF1 (1.2.840.113549.1.1.8), Parameters: SHA512DigestAlgorithm (2.16.840.1.101.3.4.2.3), saltLength: 0x40, trailerField: 0x1}{noformat}



Could you confirm does our tools support webseal cert with Signature Algorithm?",,Daniel Comeau,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011995726,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i182dv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.2,,,,,,,,,,,,,2023-02-06 00:48:56.917,,,,,"06/Feb/23 10:48 AM;5af4ad7d4dd24c579110120b;<Notes>
[https://w3.ibm.com/w3publisher/gskit/hot-topics|https://w3.ibm.com/w3publisher/gskit/hot-topics]
GSK_ALLOW_RSASSAPSS_CERTIFICATES

GSK_ALLOW_RSASSAPSS_CERTIFICATES=4010, /**< Allow verification of RSASSAPSS signed certificates - Not recommended */
","06/Feb/23 10:53 AM;5af4ad7d4dd24c579110120b;[~accountid:6092aca0f0db130069d19687] 

Under [ssl] in reverse proxy config file set this GSK attribute and see if that helps - 

{{gsk-attr-name = enum:4010:1}} ",06/Feb/23 8:33 PM;6092aca0f0db130069d19687;[~accountid:5af4ad7d4dd24c579110120b] Thanks for quick reply. I will let the customer know it and see how it goes.,07/Feb/23 11:26 PM;6092aca0f0db130069d19687;[~accountid:5af4ad7d4dd24c579110120b] It seems works. The customer closed the case.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Verify App sending truncated device name upon registration,ISAMSUP-4768,279245,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,rholman,5bac25a83a6aa22dbebb46cf,rholman,5bac25a83a6aa22dbebb46cf,03/Feb/23 7:35 AM,24/Feb/23 9:44 AM,14/Jul/23 2:47 PM,24/Feb/23 9:44 AM,,,,0,,,,"Customer is attempting to register their iPhone device named Stan’s iPhone for MMFA. When the customer scans the QR code to register the device, the registration is successful, but instead of the device_name being sent being Stan’s iPhone, it is just sending the device_name truncated as iPhone.

[1/19/23, 18:15:36:171 EST] 0000197d id=00000000 com.tivoli.am.fim.audit.event.AuditHelper                   3 auditMMFAAuthenticatorAction MMFA Authenticators authenticators = [{""device_name"":""iPhone"",""oauth_grant"":""uuidc59f45bf-0185-1703-9f66-e65a4907a856"",""auth_methods"":[{""public_key"":""MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuiiCFz6p+qDxYlQLCcB+RxgmBnhVAP1RL5S1p3iM\/80BSskKD4GK9YPkpXTnG+cAp4JN6Jklg\/HWgnqOTb4r9odq8M3MWu6o6Uju7TMacLK8nGYrVKmPrxlfbW5mQ5A3sz1Oyv8AveVihkosmUFaVTao56WvPExuzVhxAqP54mmYqFZXNW6k5AhgA0TQymjgCGEAwA4HWuZhQ+u214e32CCTp0q+oEurHRjfx8z27WFR2B5Oj+D3ZTicb\/r9eZ3l0xGHcmnjnSOEwgvvA0G4ociJGR8ZvY\/R7aPXU2FvS\/meMczCRJThxwDcWQDB0QF2kU1OTFAPy3UUPnJgCCv\/dQIDAQAB"",""key_handle"":""3803EA32-E713-40F1-A7C8-86C0BFE15FB4.userPresence"",""id"":""uuidfc500be0-6a7e-4fc8-91bd-226246e599b2"",""type"":""user_presence"",""enabled"":true,""algorithm"":""SHA512withRSA""},{""public_key"":""MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqayAob3duA0IIsN3eHhqeDFrG1xcyYhLA1o6kjvKjGbFMhSSBXkjYfOtf8AZOZwC\/jl5gj3lMsT+QSkQNY64hNU9gVIcrS2wyXldizqZAfC81vFGV1XfHWF+aLL7ducdEpGzViYwYUsiwU9UfMcDEZ3lfApbL4zVd6EluoO4+dKrDN4Cwf\/ysd4MR9o8HSeUAAqzom4trL3x4gZROr9nQ+bIm\/Zk+6FVqCir4Ebxgb0UB05jptTZUgBzVuBM+GCzZVT68rIDVN\/y3Pk9pFqW8mrhneUWADB3L\/M4c8UIasGe+VKb+ztc+LQyb\/WHFeDLDO\/rVpR3XCt9OjS3tQCxdQIDAQAB"",""key_handle"":""3803EA32-E713-40F1-A7C8-86C0BFE15FB4.fingerprint"",""id"":""uuid21e3406f-7568-421d-8243-c563d2dc2a72"",""type"":""fingerprint"",""enabled"":true,""algorithm"":""SHA512withRSA""}],""os_version"":""16.1.2"",""device_type"":""iPhone"",""id"":""uuid50139953-5717-4771-bbdd-1e5e2afb3a18"",""enabled"":true}] username = slogan01 action = getAuthenticators tenantId = amapp-runtime eventTrailId = FIM_cc50f654018513328742e65a4907a856+1266214936

Parameter[name=face_support,value=[1] Parameter[name=device_name,value=[iPhone] Parameter[name=code,value=[YJ3Fmtu6jbCklzmXd0BKnamUpbQqdc] Parameter[name=device_jailbroken,value=[0] Parameter[name=front_camera_support,value=[1] Parameter[name=device_id,value=[DBB71DAB-B904-454C-9E13-9FE4898B3489] Parameter[name=platform_type,value=[IOS] Parameter[name=client_id,value=[MMFAAuthenticatorClient] Parameter[name=tenant_id,value=[86B991C5-6D99-4509-A7DB-66F047BA3C55] Parameter[name=application_id,value=[com.ibm.security.verifyapp] Parameter[name=device_type,value=[iPhone] Parameter[name=push_token,value=[08ce683f85e30b986d06e774bd858083e12223d81d8a5f069a6e77f424b09f08] Parameter[name=os_version,value=[16.1.2] Parameter[name=scope,value=[mmfaAuthn] Parameter[name=grant_type,value=[authorization_code] Parameter[name=fingerprint_support,value=[0]

Verify App Version:
Version - v2.5.2 (4)
IBM Security Verify SDK Version - v2.1.5 (2)

iOS v16.1.2",,David Hayes,khansen,Motiur Rahman,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011868092,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,rholman,5bac25a83a6aa22dbebb46cf,,,,Blue Cross and Blue Shield of Massachusetts,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1814j:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-06 05:04:39.956,,,,,"06/Feb/23 3:04 PM;5af4ad7d4dd24c579110120b;<Notes>

MMFAAuditEventImpl.java


{noformat}authenticatorElement.addChild(DEVICE_NAME, (String) authenticator.get(DEVICE_NAME_KEY)); {noformat}

Hence - authenticator (VerifyApp) is passing truncated {{DEVICE_NAME_KEY}} value.","07/Feb/23 10:36 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5af0532354b5e72468e830b1] 

Do you have any suggestions on this issue where the device name gets truncated -  


{noformat}Stan’s iPhone 
to
""device_name"":""iPhone""{noformat}

Thanks","07/Feb/23 10:48 AM;5af0532354b5e72468e830b1;In iOS 16, Apple introduced a new privacy feature on accessing a user-assigned device name such as ""Asha's iPhone"" whereby if the app i.e IBM Verify doesn't have the entitlement, the device name of ""iPhone"" is returned.

More information about the requirement is published here:
https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_developer_device-information_user-assigned-device-name

The criteria to obtain the entitlement is unlikely to apply to IBM Verify.

_This comment was left via Slack._",07/Feb/23 11:12 AM;5af4ad7d4dd24c579110120b;Thanks [~accountid:5af0532354b5e72468e830b1] ,"22/Feb/23 2:27 AM;5bac25a83a6aa22dbebb46cf;Customer provided the following update. Will we be looking to get the proper entitlements for the proper names?

I have reviewed the information you have provided and if IBM isn't interested in pursuing the necessary entitlement I guess that's the final answer.

I would think that since the app is functioning in a service provider capacity to an IDP (IBM's IDP product, specifically) rather than as a consumer application there is a case for an additional criteria consideration. Unfortunately our application which is consuming this data exactly meets their criteria (I realize we are just one consumer of the Verify app's service, though).

If this is IBM's final stance, we can go ahead and close this case.","22/Feb/23 9:54 AM;5af4ad7d4dd24c579110120b;[~accountid:5af0532354b5e72468e830b1] 

Customer has a query to check if there is a road map for IBM Verify doesn't have the entitlement, and if yes is there any timeline associated with it.

Thank you for your inputs.","22/Feb/23 10:55 AM;5af0532354b5e72468e830b1;Hi[~accountid:5af4ad7d4dd24c579110120b] the guidance from Apple to obtain the entitlement is quite detailed.  Refer to what Apple will assess the entitlement here:

[com.apple.developer.device-information.user-assigned-device-name|https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_developer_device-information_user-assigned-device-name]

IBM Verify would have to display the {{deviceName}} in the app and we’d have to declare the name is not used for tracking or provided to any 3rd party services.

At the moment I haven’t investigated this further so no timeline on getting this implemented at this stage.","24/Feb/23 9:44 AM;5af4ad7d4dd24c579110120b;Closing this as answered, please reopen if you have any further questions.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
LTPA token,ISAMSUP-4766,279239,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,03/Feb/23 5:50 AM,07/Feb/23 10:39 AM,14/Jul/23 2:47 PM,07/Feb/23 10:39 AM,,,,0,,,,"I Hope L3 team can help with this customer question below



{noformat}Could you tell me if ""SecurityName"" is still part of the cookie in Webseal ISVA  10.0.x as it was in Webseal 9.0.x?

We have LTPA on some of our junctions so that Webseal creates the LTPA token to send to the backend.

How can we be sure that the cookie created by Webseal 10 contains the attribute: SecurityName?{noformat}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011968402,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,LA BANQUE POSTALE DISF,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1812z:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-02-06 09:17:02.682,,,,,"06/Feb/23 7:17 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:614dd52af1c1740068534813] 

I don't see any noticeable change in the code in this space.

Do you have the comparison trace - pdweb.debug, pdweb.snoop and snoop and pdweb.wan.ltpa for 9.x and 10.x to show the ltpa2cookie and the response objects?",07/Feb/23 10:39 AM;5af4ad7d4dd24c579110120b;Case closed hence closing Jira.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
CVE-2014-7169 Bash: Specially-crafted environment variables can be used to inject shell commands on AAC servers,ISAMSUP-4763,278867,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,01/Feb/23 11:18 AM,02/Feb/23 1:23 AM,14/Jul/23 2:47 PM,02/Feb/23 1:22 AM,,Support,,0,,,,"CVE-2014-7169 Bash: Specially-crafted environment variables can be used to inject shell commands on AAC servers. it's complaining these 4 servers flagged because BASH vulnerability, and somehow it say the server has mod_cgi",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012003929,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,THE CANADA LIFE ASSURANCE COMPANY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17yrf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-02-01 02:21:44.369,,,,,"01/Feb/23 11:18 AM;5b15d9e6dda5f94d06b985b4;Sent the following:

This really seems like a false positive especially since 10.0.2.0 ships with Bash 4.4.19 and the CVE notes ""GNU Bash through 4.3 bash43-025"".
I need to engage the PSIRT team for an official answer.","01/Feb/23 11:19 AM;5b15d9e6dda5f94d06b985b4;FYI from a 1020:

~ # bash -version
GNU bash, version 4.4.19(1)-release (x86_64-koji-linux-gnu)
Copyright (C) 2016 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <[http://gnu.org/licenses/gpl.html|http://gnu.org/licenses/gpl.html|smart-link] >",01/Feb/23 12:21 PM;5b15d8fd6e93913e31e279fb;[~accountid:5b15d9e6dda5f94d06b985b4] You are correct we are not vulnerable to this CVE.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"""localhost"" found instead of hostname on logs sent to remote syslog ISVA 10.0.2",ISAMSUP-4760,278759,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Carlos Rosales,5bb2c13f59e46d7be31a9e54,Carlos Rosales,5bb2c13f59e46d7be31a9e54,01/Feb/23 3:36 AM,22/Mar/23 10:48 PM,14/Jul/23 2:47 PM,22/Mar/23 10:48 PM,,,,0,,,,"Logs to remote syslog show localhost instead of the hostname, 

Network trace captured the following packet

2023-01-30T04:02:00.465143-05:00 *localhost* request.log - - - - 10.178.70.204 - unauthenticated [30/Jan/2023:04:01:31 -0500] ""GET [HTTPS://kpmglink.ema.kworld.kpmg.com/|https://kpmglink.ema.kworld.kpmg.com/] HTTP/1.1"" 401 10350 - 4183 /

Remote Syslog forwarder configuration on the server

rsyslog_forwarder.1.server = 10.178.5.25
rsyslog_forwarder.1.port = 514
rsyslog_forwarder.1.protocol = tcp
rsyslog_forwarder.1.format = rfc-5424
rsyslog_forwarder.1.debug = false
rsyslog_forwarder.1.source.1.name = WebSEAL:advint:request.log
rsyslog_forwarder.1.source.1.tag = request.log
rsyslog_forwarder.1.source.1.facility = user
rsyslog_forwarder.1.source.1.severity = info
rsyslog_forwarder.1.source.2.name = WebSEAL:audint:request.log
rsyslog_forwarder.1.source.2.tag = request.log
rsyslog_forwarder.1.source.2.facility = user
rsyslog_forwarder.1.source.2.severity = info
rsyslog_forwarder.1.source.3.name = WebSEAL:rskint:request.log
rsyslog_forwarder.1.source.3.tag = request.log
rsyslog_forwarder.1.source.3.facility = user
rsyslog_forwarder.1.source.3.severity = info
rsyslog_forwarder.1.source.4.name = WebSEAL:taxint:request.log
rsyslog_forwarder.1.source.4.tag = request.log
rsyslog_forwarder.1.source.4.facility = user
rsyslog_forwarder.1.source.4.severity = info
rsyslog_forwarder.1.source.5.name = WebSEAL:taxint01:request.log
rsyslog_forwarder.1.source.5.tag = request.log
rsyslog_forwarder.1.source.5.facility = user
rsyslog_forwarder.1.source.5.severity = info
rsyslog_forwarder.1.source.6.name = WebSEAL:taxint02:request.log
rsyslog_forwarder.1.source.6.tag = request.log
rsyslog_forwarder.1.source.6.facility = user
rsyslog_forwarder.1.source.6.severity = info",,Carlos Rosales,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,5bb2c13f59e46d7be31a9e54,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4762,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011844141,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Carlos Rosales,5bb2c13f59e46d7be31a9e54,,,,KPMG LLP,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS011844141&path=TS011844141%2F2023-01-24%2Fisva_10.0.2.0_20230124-065705_goazrprx009.support_unpack%2F,,,,,,,,,,,,,,,,,,,,,,,0|i17y5v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-02-01 10:09:36.067,,,,,01/Feb/23 3:37 AM;5bb2c13f59e46d7be31a9e54;Jira with similar behavior [https://cloudidentity.atlassian.net/browse/ISAMSUP-4267|https://cloudidentity.atlassian.net/browse/ISAMSUP-4267|smart-link] wasn’t confirmed if the fix  for 10.0.3.1on that Jira help solve the problem,"01/Feb/23 8:09 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bb2c13f59e46d7be31a9e54] 

Here is a fixpack that was built for the other issue see how you go with this -

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4762|https://cloudidentity.atlassian.net/browse/ISAMSUP-4762|smart-link]  ",02/Feb/23 2:53 AM;5bb2c13f59e46d7be31a9e54;thanks [~accountid:5af4ad7d4dd24c579110120b] I have provided the fixpack to the customer.,"22/Mar/23 10:48 PM;5bb2c13f59e46d7be31a9e54;Hi Asha, thanks for your help, the fixpack didn’t resolve customer issue but was because customer had multiple servers with different configurations, after the configuration was fix the problem was gone, I’m closing this jira.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
CVE-2019-16905 customer scan reports vulnerability,ISAMSUP-4759,278742,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,01/Feb/23 2:24 AM,09/Feb/23 4:28 AM,14/Jul/23 2:47 PM,09/Feb/23 4:28 AM,,,,0,,,,"Customer’s security scan flagged the ISVA appliance as vulnerable:

[https://nvd.nist.gov/vuln/detail/cve-2019-16905|https://nvd.nist.gov/vuln/detail/cve-2019-16905|smart-link] 

Can L3 confirm the vulnerability and steps to remediate?

Customer’s system is running v10.0.3.1",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011931087,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Reagan Knowles,5b15d9e44c4ed14b83af8723,,,,Bank of Montreal,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17y2j:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-01-31 19:45:30.596,,,,,"01/Feb/23 5:45 AM;5b15d8fd6e93913e31e279fb;The CVE was flagged by the scan due to the version of OpenSSH that is shipped with ISVA.  The product is not vulnerable because The versions of OpenSSH package shipped with OS used by ISVA, do not enable support for XMSS and therefore are not affected by this flaw.","01/Feb/23 5:58 AM;5b15d9e44c4ed14b83af8723;Thanks, I have forwarded this information to the customer.",02/Feb/23 4:10 AM;5b15d9e44c4ed14b83af8723;Customer is asking for a technote or proof that they can share with their Security team. Do we have anything outside this Jira stating the ISVA appliance is not vulnerable? I don’t think we document all the false positives.,09/Feb/23 3:17 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b15d9e44c4ed14b83af8723] You are correct we only publish Security Bulletins for issues that we are vulnerable to or affected by.,"09/Feb/23 4:28 AM;5b15d9e44c4ed14b83af8723;Thanks for the confirmation, closing this",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
vulnerability : CVE-2022-23529,ISAMSUP-4754,278541,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,30/Jan/23 11:49 PM,21/Feb/23 9:29 PM,14/Jul/23 2:47 PM,21/Feb/23 9:29 PM,,,,0,,,,"Customer has raised a query, is ISAM version 10.0.4 is vulnerable to CVE-2022-23529 ?",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011984450,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,Account FIRST ABU DHABI BANK P.J.S.C,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17wvb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-08 17:22:14.557,,,,,07/Feb/23 7:34 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] Customer is asking for an update..,"09/Feb/23 3:22 AM;5b15d8fd6e93913e31e279fb;[~accountid:627a7fb30d1e73006f7c21cf] According to the National Vulnerability Database this is not a vulnerability.  [https://nvd.nist.gov/vuln/detail/CVE-2022-23529|https://nvd.nist.gov/vuln/detail/CVE-2022-23529|smart-link] 

h2. CVE-2022-23529 Detail

*Rejected*

----

CVE has been marked ""REJECT"" in the CVE List. These CVEs are stored in the NVD, but do not show up in search results.

h3. Current Description

** REJECT ** DO NOT USE THIS CANDIDATE NUMBER. ConsultIDs: none. Reason: The issue is not a vulnerability. Notes: none.",21/Feb/23 9:29 PM;627a7fb30d1e73006f7c21cf;Case is closed.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 WebSEAL - CRL issue,ISAMSUP-4753,278540,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Peter Horner,5b15d9517dab4c51f61b5190,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,30/Jan/23 11:38 PM,13/Jul/23 1:47 PM,14/Jul/23 2:47 PM,,,Support,,0,Escalation,,,"After enabling client certificate checking against the CRL, we encountered the problem that some certificates are rejected by the WebSEAL server even though they have not been revoked. I uploaded the trace01.pcap file where you can see, among other things, the client's communication with the certificate ""CN=MDM-0A6E543B965AC68A-0e02e070-8f80-47d0-9691-f44c05a42c7c"". I also uploaded CRL files (but you can see them in packet capture file too) mdm2.skoda-auto.cz.crl and pki.skoda.vwgroup.com.crl. WebSEAL logged these errors: 2023-01-24-15:36:24.404+01:00I----- 0x38B9A0A5 webseald ERROR wns general WsSslListener.cpp 1793 0x7fe86d99e700 -- DPWNS0165E The certificate revocation check result was undetermined. The subject issuer is '[Class=]GSKVALMethod::X509[Issuer=]CN=CA Partner Skoda Auto - MDM2[#=]00adac[Subject=]CN=MDM-0A6E543B965AC68A-0e02e070-8f80-47d0-9691-f44c05a42c7c,O=SKODA AUTO a.s.'. 2023-01-24-15:36:26.260+01:00I----- 0x38B9A0A5 webseald ERROR wns general WsSslListener.cpp 1793 0x7fe86e60f700 -- DPWNS0165E The certificate revocation check result was undetermined. The subject issuer is '[Class=]GSKVALMethod::X509[Issuer=]CN=CA Partner Skoda Auto - MDM2[#=]00adac[Subject=]CN=MDM-0A6E543B965AC68A-0e02e070-8f80-47d0-9691-f44c05a42c7c,O=SKODA AUTO a.s.'. In addition, the login does not seem to fail every time - the number of DPWNS0165E errors for that certificate in the log is lower than the number of Certificate entries in the packet trace file. Do you have any idea where could be the problem?

According to the packet trace (trace01.pcap), the WebSEAL server correctly connects to both CA servers ([http://pki.skoda.vwgroup.com/CA%20Partner%20Skoda%20Auto%20ROOT.crl|http://pki.skoda.vwgroup.com/CA%20Partner%20Skoda%20Auto%20ROOT.crl] and [http://mdm2.skoda-auto.cz/mifs/ca/13/ca.crl|http://mdm2.skoda-auto.cz/mifs/ca/13/ca.crl]) and downloads the CRL files.

[mdm2.skoda-auto.cz|https://mdm2.skoda-auto.cz/] - 10.217.190.90

[pki.skoda.vwgroup.com|https://pki.skoda.vwgroup.com/] - 10.217.116.52



We would need to find out what the WebSEAL server has a problem with and why it declares an error:

_The certificate revocation check result was undetermined._

Ask for the GSKit trace. Customer upload it. 

/ecurep/sf/TS011/931/TS011931384/2023-01-26/isva_10.0.5.0_20230126-142519_smbmpr121.fw.skoda.vwg.support_unpack/var/pdweb/mobile/server-root/lib/junction-root/gskit.txt

L3 will ask gskit team to analyse and advise further",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,08/May/23 11:12 AM;phorner;crl_trace.fixpack;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/199610,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011931384,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17wv3:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-02 06:58:32.75,,,,,02/Feb/23 4:58 PM;5b15d9517dab4c51f61b5190;Have requested a ticket with GSKIT to look at trace,02/Feb/23 5:26 PM;5b15d9517dab4c51f61b5190;GSKit L3 ticket G3426 has been created for this issue.,"07/Feb/23 11:57 AM;5b15d9517dab4c51f61b5190;Update from GSKIT

It looks like the CRL in question could not be decoded, but unfortunately the CRL is not dumped in trace (as they can be very large).

 I looked at [http://mdm2.skoda-auto.cz/mifs/ca/13/ca.crl|http://mdm2.skoda-auto.cz/mifs/ca/13/ca.crl] .  It looks like DER but does not decode in GSKit.  I need to do some PD on why we cannot decode.

 Here is the trace in question:



{noformat}
>   CDP trying URL: http://mdm2.skoda-auto.cz:8080/mifs/ca/13/ca.crl

>                                                                   

>   25519|230126|23:21:31.504|     854|00007FAB88044700|                   >GSKHttpDataSource::getClassName(void) gskhttpdatasource.cpp [495]

>   25520|230126|23:21:31.504|     854|00007FAB88044700|                   <GSKHttpDataSource::getClassName(void)

>   25521|230126|23:21:31.504|     854|00007FAB88044700|                   >GSKHttpDataSource::isKindOf(classname) gskhttpdatasource.cpp [480]

>   25522|230126|23:21:31.504|     854|00007FAB88044700|                    >GSKHttpDataSource::getClassName(void) gskhttpdatasource.cpp [495]

>   25523|230126|23:21:31.504|     854|00007FAB88044700|                    <GSKHttpDataSource::getClassName(void)

>   25524|230126|23:21:31.504|     854|00007FAB88044700|                   <GSKHttpDataSource::isKindOf(classname)

>   25525|230126|23:21:31.504|     854|00007FAB88044700|                   >GSKHttpDataSource::getViaURI() gskhttpdatasource.cpp [313]

>   25526|230126|23:21:31.504|     854|00007FAB88044700|                    >GSKHttpCRLClient::getHttpResponse() gskhttpcrlclient.cpp [117]

>   25527|230126|23:21:31.504|     854|00007FAB88044700|                     >GSKHttpClient::reconnectIfNeeded() gskhttpclient.cpp [427]

>   25528|230126|23:21:31.504|     854|00007FAB88044700|                      >GSKHTTPChannel::getURL() gskhttpchannel.cpp [165]

>   25529|230126|23:21:31.504|     854|00007FAB88044700|                      <GSKHTTPChannel::getURL()

>   25530|230126|23:21:31.504|     854|00007FAB88044700|                      >GSKHTTPChannel::getURL() gskhttpchannel.cpp [165]

>   25531|230126|23:21:31.504|     854|00007FAB88044700|                      <GSKHTTPChannel::getURL()

>   25532|230126|23:21:31.504|     854|00007FAB88044700|                      >GSKHTTPChannel::setURL() gskhttpchannel.cpp [187]

>   25533|230126|23:21:31.504|     854|00007FAB88044700|                      <GSKHTTPChannel::setURL()

>   25534|230126|23:21:31.504|     854|00007FAB88044700|                      >GSKHttpClient::openChannel() gskhttpclient.cpp [380]

>   25535|230126|23:21:31.504|     854|00007FAB88044700|                       >GSKHTTPPollChannel::open() gskhttppollchannel.cpp [128]

>   25536|230126|23:21:31.504|     854|00007FAB88044700|                        >GSKHTTPChannel::CloseChannel() gskhttpchannel.cpp [898]

>   25537|230126|23:21:31.504|     854|00007FAB88044700|                        <GSKHTTPChannel::CloseChannel()

>   25538|230126|23:21:31.504|     854|00007FAB88044700|                        >GSKHTTPPollChannel::OpenChannel() gskhttppollchannel.cpp [150]

>   25539|230126|23:21:31.504|     854|00007FAB88044700|                         >GSKHTTPChannel::getURLObject() gskhttpchannel.cpp [208]

>   25540|230126|23:21:31.504|     854|00007FAB88044700|                         <GSKHTTPChannel::getURLObject()

>   25541|230126|23:21:31.504|     854|00007FAB88044700|                         >GSKHTTPChannel::getURLObject() gskhttpchannel.cpp [208]

>   25542|230126|23:21:31.504|     854|00007FAB88044700|                         <GSKHTTPChannel::getURLObject()

>   25543|230126|23:21:31.504|     854|00007FAB88044700|                         >GSKHTTPPollChannel::OpenChannel_real() gskhttppollchannel.cpp [390]

>   25544|230126|23:21:31.504|     854|00007FAB88044700|                          >GSKHTTPChannel::getConnectTimeout() gskhttpchannel.cpp [446]

>   25545|230126|23:21:31.504|     854|00007FAB88044700|                          <GSKHTTPChannel::getConnectTimeout()

>   25546|230126|23:21:31.504|     854|00007FAB88044700|                          gskhttppollchannel.cpp [441]

>                                                                           Socket connect

>   25547|230126|23:21:31.510|     854|00007FAB88044700|                          >GSKHTTPChannel::setSocket() gskhttpchannel.cpp [401]

>   25548|230126|23:21:31.510|     854|00007FAB88044700|                          <GSKHTTPChannel::setSocket()

>   25549|230126|23:21:31.510|     854|00007FAB88044700|                         <GSKHTTPPollChannel::OpenChannel_real()

>   25550|230126|23:21:31.510|     854|00007FAB88044700|                         >GSKHTTPChannel::getSocket() gskhttpchannel.cpp [380]

>   25551|230126|23:21:31.510|     854|00007FAB88044700|                         <GSKHTTPChannel::getSocket()

>   25552|230126|23:21:31.510|     854|00007FAB88044700|                        <GSKHTTPPollChannel::OpenChannel()

>   25553|230126|23:21:31.510|     854|00007FAB88044700|                       <GSKHTTPPollChannel::open()

>   25554|230126|23:21:31.510|     854|00007FAB88044700|                      <GSKHttpClient::openChannel()

>   25555|230126|23:21:31.510|     854|00007FAB88044700|                     <GSKHttpClient::reconnectIfNeeded()

>   25556|230126|23:21:31.510|     854|00007FAB88044700|                     >GSKHTTPChannel::getURLObject() gskhttpchannel.cpp [208]

>   25557|230126|23:21:31.510|     854|00007FAB88044700|                     <GSKHTTPChannel::getURLObject()

>   25558|230126|23:21:31.510|     854|00007FAB88044700|                     >GSKHttpCRLClient::getViaGet() gskhttpcrlclient.cpp [168]

>   25559|230126|23:21:31.510|     854|00007FAB88044700|                      >GSKHTTPChannel::getURLObject() gskhttpchannel.cpp [208]

>   25560|230126|23:21:31.510|     854|00007FAB88044700|                      <GSKHTTPChannel::getURLObject()

>   25561|230126|23:21:31.510|     854|00007FAB88044700|                      >GSKHTTPChannel::getURLObject() gskhttpchannel.cpp [208]

>   25562|230126|23:21:31.511|     854|00007FAB88044700|                      <GSKHTTPChannel::getURLObject()

>   25563|230126|23:21:31.511|     854|00007FAB88044700|                      >GSKHttpClient::getResponse() gskhttpclient.cpp [465]

>   25564|230126|23:21:31.511|     854|00007FAB88044700|                       >GSKHttpClient::sendBytes() gskhttpclient.cpp [770]

>   25565|230126|23:21:31.511|     854|00007FAB88044700|                        >GSKHTTPPollChannel::writeData() gskhttppollchannel.cpp [801]

>   25566|230126|23:21:31.511|     854|00007FAB88044700|                         >GSKHTTPChannel::getSocket() gskhttpchannel.cpp [380]

>   25567|230126|23:21:31.511|     854|00007FAB88044700|                         <GSKHTTPChannel::getSocket()

>   25568|230126|23:21:31.511|     854|00007FAB88044700|                         >GSKHTTPChannel::getTimeout() gskhttpchannel.cpp [426]

>   25569|230126|23:21:31.511|     854|00007FAB88044700|                         <GSKHTTPChannel::getTimeout()

>   25570|230126|23:21:31.511|     854|00007FAB88044700|                        <GSKHTTPPollChannel::writeData()

>   25571|230126|23:21:31.511|     854|00007FAB88044700|                       <GSKHttpClient::sendBytes()

>   25572|230126|23:21:31.511|     854|00007FAB88044700|                       >GSKHttpClient::readBytes() gskhttpclient.cpp [732]

>   25573|230126|23:21:31.511|     854|00007FAB88044700|                        >GSKHTTPPollChannel::readData() gskhttppollchannel.cpp [637]

>   25574|230126|23:21:31.511|     854|00007FAB88044700|                         >GSKHTTPChannel::getSocket() gskhttpchannel.cpp [380]

>   25575|230126|23:21:31.511|     854|00007FAB88044700|                         <GSKHTTPChannel::getSocket()

>   25576|230126|23:21:31.511|     854|00007FAB88044700|                         >GSKHTTPChannel::getTimeout() gskhttpchannel.cpp [426]

>   25577|230126|23:21:31.511|     854|00007FAB88044700|                         <GSKHTTPChannel::getTimeout()

>   25578|230126|23:21:31.534|     854|00007FAB88044700|                        <GSKHTTPPollChannel::readData()

>   25579|230126|23:21:31.534|     854|00007FAB88044700|                       <GSKHttpClient::readBytes()

>   25580|230126|23:21:31.534|     854|00007FAB88044700|                       >GSKHttpClient::checkMaxPayload() gskhttpclient.cpp [808]

>   25581|230126|23:21:31.534|     854|00007FAB88044700|                       <GSKHttpClient::checkMaxPayload()

>   25582|230126|23:21:31.534|     854|00007FAB88044700|                       >GSKHttpClient::checkMaxPayload() gskhttpclient.cpp [808]

>   25583|230126|23:21:31.534|     854|00007FAB88044700|                       <GSKHttpClient::checkMaxPayload()

>   25584|230126|23:21:31.534|     854|00007FAB88044700|                       >GSKHttpClient::checkMaxPayload() gskhttpclient.cpp [808]

>   25585|230126|23:21:31.534|     854|00007FAB88044700|                       <GSKHttpClient::checkMaxPayload()

>   25586|230126|23:21:31.534|     854|00007FAB88044700|                       >GSKHttpClient::closeChannel() gskhttpclient.cpp [407]

>   25587|230126|23:21:31.534|     854|00007FAB88044700|                        >GSKHTTPChannel::close() gskhttpchannel.cpp [273]

>   25588|230126|23:21:31.534|     854|00007FAB88044700|                         >GSKHTTPChannel::CloseChannel() gskhttpchannel.cpp [898]

>   25589|230126|23:21:31.534|     854|00007FAB88044700|                         <GSKHTTPChannel::CloseChannel()

>   25590|230126|23:21:31.534|     854|00007FAB88044700|                        <GSKHTTPChannel::close()

>   25591|230126|23:21:31.534|     854|00007FAB88044700|                       <GSKHttpClient::closeChannel()

>   25592|230126|23:21:31.534|     854|00007FAB88044700|                      <GSKHttpClient::getResponse()

>   25593|230126|23:21:31.534|     854|00007FAB88044700|                     <GSKHttpCRLClient::getViaGet()

>   25594|230126|23:21:31.534|     854|00007FAB88044700|                    <GSKHttpCRLClient::getHttpResponse()

>   25595|230126|23:21:31.534|     854|00007FAB88044700|                    >GSKHttpDataSource::setCRLEncoding() gskhttpdatasource.cpp [502]

>   25596|230126|23:21:31.534|     854|00007FAB88044700|                     >setDEREncoding(const GSKASNCBuffer) gskasnutility.cpp [103]

>   25597|230126|23:21:31.534|     854|00007FAB88044700|                     <setDEREncoding(const GSKASNCBuffer)

>   25598|230126|23:21:31.535|     854|00007FAB88044700|                     gskhttpdatasource.cpp [506]

>                                                                      CRL not in DER format

>   25599|230126|23:21:31.535|     854|00007FAB88044700|                     >decodeData_BASE64() gskkryutility.cpp [3765]

>   25600|230126|23:21:31.535|     854|00007FAB88044700|                      >getDefaultAlgorithmFactory() gskkryutility.cpp [131]

>   25601|230126|23:21:31.535|     854|00007FAB88044700|                       >getDefaultImpl() gskkrycompositealgorithmfactory.cpp [591]

>   25602|230126|23:21:31.535|     854|00007FAB88044700|                        gskkrycompositealgorithmfactory.cpp [609]

>                                                                         ICC_FIPS_ExplicitLoad is not set

>   25603|230126|23:21:31.535|     854|00007FAB88044700|                       <getDefaultImpl()

>   25604|230126|23:21:31.535|     854|00007FAB88044700|                      <getDefaultAlgorithmFactory()

>   25605|230126|23:21:31.535|     854|00007FAB88044700|                      >decodeData_BASE64() gskkryutility.cpp [3765]

>   25606|230126|23:21:31.535|     854|00007FAB88044700|                       >ICCKRYAlgorithmFactory::make_BASE64_DecodeAlgorithm() icckryalgorithmfactory.cpp [3276]

>   25607|230126|23:21:31.535|     854|00007FAB88044700|                        >ICCKRYDecodeAlgorithm::ctor() icckrydecodealgorithm.cpp [88]

>   25608|230126|23:21:31.535|     854|00007FAB88044700|                        <ICCKRYDecodeAlgorithm::ctor()

>   25609|230126|23:21:31.535|     854|00007FAB88044700|                       <ICCKRYAlgorithmFactory::make_BASE64_DecodeAlgorithm()

>   25610|230126|23:21:31.535|     854|00007FAB88044700|                       >ICCKRYDecodeAlgorithm::decodeData() icckrydecodealgorithm.cpp [111]

>   25611|230126|23:21:31.535|     854|00007FAB88044700|                        >ICCKRYDecodeAlgorithm::decodeDataInit() icckrydecodealgorithm.cpp [126]

>   25612|230126|23:21:31.535|     854|00007FAB88044700|                        <ICCKRYDecodeAlgorithm::decodeDataInit()

>   25613|230126|23:21:31.535|     854|00007FAB88044700|                        >ICCKRYDecodeAlgorithm::decodeDataUpdate() icckrydecodealgorithm.cpp [140]

>   25614|230126|23:21:31.535|     854|00007FAB88044700|                        <ICCKRYDecodeAlgorithm::decodeDataUpdate()

>   25615|230126|23:21:31.535|     854|00007FAB88044700|                       <ICCKRYDecodeAlgorithm::decodeData()

>   25616|230126|23:21:31.535|     854|00007FAB88044700|                       >ICCKRYDecodeAlgorithm::dtor() icckrydecodealgorithm.cpp [100]

>   25617|230126|23:21:31.535|     854|00007FAB88044700|                       <ICCKRYDecodeAlgorithm::dtor()

>   25618|230126|23:21:31.535|     854|00007FAB88044700|                      <decodeData_BASE64()

>   25619|230126|23:21:31.535|     854|00007FAB88044700|                     <decodeData_BASE64()

>   25620|230126|23:21:31.535|     854|00007FAB88044700|                     gskhttpdatasource.cpp [513]

>                                                                      CRL not base64 either

>   25621|230126|23:21:31.535|     854|00007FAB88044700|                     >Base64DearmorPemToBuf() gskutility.cpp [1854]

>   25622|230126|23:21:31.537|     854|00007FAB88044700|                     <Base64DearmorPemToBuf()

>   25623|230126|23:21:31.537|     854|00007FAB88044700|                     gskhttpdatasource.cpp [520]

>                                                                      CRL not PEM on retry

>   25624|230126|23:21:31.537|     854|00007FAB88044700|                     gskhttpdatasource.cpp [526]

>                                                                      CRL not DER on retry

>   25625|230126|23:21:31.537|     854|00007FAB88044700|                    <GSKHttpDataSource::setCRLEncoding()

>   25626|230126|23:21:31.537|     854|00007FAB88044700|                    >getErrorString() gskutility.cpp [452]

>   25627|230126|23:21:31.537|     854|00007FAB88044700|                    <getErrorString()

>   25628|230126|23:21:31.537|     854|00007FAB88044700|                    gskhttpdatasource.cpp [364]

>                                                                     GSKICCException(GSKKRY_ERR_DECODE_FAILED), in ./kryicc/src/icckrydecodealgorithm.cpp[168]

>   25629|230126|23:21:31.537|     854|00007FAB88044700|                    gskhttpdatasource.cpp [373]

>                                                                     http CRL response [0..500]:0é>

>   25630|230126|23:21:31.537|     854|00007FAB88044700|                   <GSKHttpDataSource::getViaURI()

>   25631|230126|23:21:31.537|     854|00007FAB88044700|                   gskvalcert.cpp [2070]

>                                                                    Failed to determined revocation status

> 

 {noformat}",21/Feb/23 8:33 PM;5b232b2fd85e5b59b066f57f;@phorner - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,21/Feb/23 8:46 PM;5b15d9517dab4c51f61b5190;Still waiting for another update from gskit,24/Mar/23 12:26 AM;617a5f2cf485cd0068cb98af;customer need an update on this please,"29/Mar/23 11:07 AM;5b15d9517dab4c51f61b5190;[~accountid:617a5f2cf485cd0068cb98af] 

I checked with  gskit today and they are still looking it at it but did not give me any more details.

Will check again next week ","31/Mar/23 4:29 PM;5b15d9517dab4c51f61b5190;Update from gskit 

{color:#4c9aff}The CRL in question is PEM encoded and used a PEM label that we do not recognize as being a CRL{color}

{color:#4c9aff}I have checked various sources and RFC 7468 does allow the label the customer is using and so we will need to update our PEM decoder to recognize this. A fix will be in a future build … {color}
{color:#4c9aff}In the meantime, a workaround is for the customer to use binary encoding of the CRL which is the normal use case.{color}

gskit do not do fixpacks - only releases.

It will likely be months before gskit release a version containing the fix.","04/Apr/23 10:56 AM;5b15d9517dab4c51f61b5190;[~accountid:617a5f2cf485cd0068cb98af] 

Got Another update from gskit

They are not sure of their initial analysis.

They are going to provide me a  test version of gskit - to gather some more detailed trace to get to the cause of the issue.

I don’t have a timeframe for this - other than they are working on it now - so I don’t expect it to be too long

I will package that into a test fixpack for the customer

The fixpack will not fix anything - it will require re generation of the gskit trace.

Will update again when I have built the fixpack.

The fixpack will be for this customer only - so I will attach it to this Jira item",18/Apr/23 11:13 PM;5b232b2fd85e5b59b066f57f;@phorner - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,19/Apr/23 8:48 PM;5b15d9517dab4c51f61b5190;Still waiting for gskit to provide test version,"08/May/23 11:12 AM;5b15d9517dab4c51f61b5190;gskit have provided a test version to gather the trace they need

I am attaching the fixpack containing the test gskit version to this item

When installed it will restart webseal servers

gskit have requested “Please use it to to generate GSKit trace with a concurrent wire trace of the communication to the CRL server”","11/May/23 9:13 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d9517dab4c51f61b5190] Customer had installed it GSKit trace fixpack, reproduced the issue and uploaded support file isva_10.0.5.0_20230511-124537_smbmpr121.fw.skoda.vwg.support with GSKit trace and packet capture file:

{{\var\pdweb\mobile\server-root\lib\junction-root\gskit.trc \var\pdweb\mobile\server-root\lib\junction-root\gskit.trc.1 \var\tcptrace\trace01.pcap}}

[TS011931384 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011931384&path=TS011931384%2F2023-05-11%2F&filepath=TS011931384%2F2023-05-11%2Fisva_10.0.5.0_20230511-124537_smbmpr121.fw.skoda.vwg.support]",12/May/23 10:22 AM;5b15d9517dab4c51f61b5190;Trace has been forwarded to gskit,22/May/23 10:29 AM;5b232b2fd85e5b59b066f57f;Note sent to GSKit L3 asking for status. ,"12/Jun/23 1:48 PM;5b232b2fd85e5b59b066f57f;For SUPPORT reference: 

The trace is showing that the CRL is too large for what has been configured: 

{noformat}GSKHTTPClientException(GSK_HTTPCLN_ERR_CONTENT_TOO_BIG_ERROR), in ./gskcms/src/gskhttpclient.cpp[812]:  Max payload size exceeded{noformat}

GSK_HTTP_CDP_MAX_RESPONSE_SIZE has been set according to /ecurep/sf/TS011/931/TS011931384/0-all_data/isva_10.0.5.0_20230511-124537_smbmpr121.fw.skoda.vwg.support_unpack/var/pdweb/mobile/etc/webseald-mobile.conf:


{noformat}gsk-attr-name = number:316:3145728{noformat}

I have asked a follow up question of GSKit support as to why this attribute setting does not seem to be taking effect. ",22/Jun/23 2:31 PM;5b232b2fd85e5b59b066f57f;GSKit L3 still investigating.,28/Jun/23 12:59 PM;5ac57757d9a96536d1f0daa9;GSKit L3 still investigating.,"13/Jul/23 1:47 PM;5b15d9517dab4c51f61b5190;[~accountid:617a5f2cf485cd0068cb98af] 

GSKIT have identified an issue in handling the CRL response

They are currently testing their fix

Once they have completed their testing - they will supply me with another test version - and I will build

another fixpack

Will let you know when I know more",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA 10.0.5 doesn't fix IJ41346,ISAMSUP-4747,278200,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,26/Jan/23 10:27 PM,04/Apr/23 9:39 PM,14/Jul/23 2:47 PM,04/Apr/23 9:39 PM,,Support Management,,0,,,,"Customer previously opened TS010839283, because the webseal behind a terminating Amazon application loadbalancer (ALB) was prematurely closing the connection. In that case I was told, that for this issue there is the APAR IJ41346 WEBSEAL FRONT-END PERSISTING CONNECTION SEND HTTP CONNECTION:CLOSE, which comes with 10.0.5. I now installed 10.0.5 in the Amazon cloud, but we still face the very same issue: webseal prematurely closes the connection for no reason. I attach some trace files: 1. grp-qa.global.volkswagenag.com.har browser har file, where you see the request to [https://grp-qa.global.volkswagenag.com/mga/sps/static/grp/resources/js/lang.js|https://grp-qa.global.volkswagenag.com/mga/sps/static/grp/resources/js/lang.js] which is responded by the ALB with 502 (pointing to that issue) 2. ALB_502.json Amazon application load balancer request log with that one problematic request causing 502 3. ISVA packet tracing ALB: 11.240.18.94 Webseal: 11.240.18.68 packet 1833: webseals sends [FIN,ACK] packet 1834: webseals sends [RST,ACK] !!! packet 1840: webseals sends [RST,ACK] !!! packet 1842: webseals sends [RST] !!! So the problem is not fixed in 10.0.5, or the APAR was not implemented correctly? Maybe I have to activate a switch in order to enable the APAR? This problem is preventing us from installing the current ISVA version, so we still have to run on the old version 10.0.1, which is a real security issue. (the same problem we face with 10.0.3 and 10.0.4) Please include L3 to verify, how the APAR can be activated.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011952655,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,KION Information Management Services GmbH,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17usn:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-26 23:36:05.794,,,,,26/Jan/23 10:31 PM;617a5f2cf485cd0068cb98af;the data uploaded by customer [TS011952655 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011952655&path=TS011952655%2F2023-01-26%2F&filepath=TS011952655%2F2023-01-26%2Fisva-trace01.pcap],"27/Jan/23 9:36 AM;5b17571b91981f4fdde632c1;* Your description is unreadable
** Please STOP posting unformatted/unreadable data in the description
*** Everyone can format it properly
*** Either please reformat or post in comment
**** If you start with THREE left ` characters it opens a grey empty box
***** It will retain the format  
**** For example
***** The exact format is preserved

{noformat}One
	Two
		Three
			Four{noformat}","27/Jan/23 9:43 AM;5b17571b91981f4fdde632c1;{noformat}[server]
# The maximum number of idle client persistent connections.  This value
# should be less than the maximum number of connections supported by the
# WebSEAL server to ensure that the idle connections do not consume all of
# the available connections.
max-idle-persistent-connections = 512{noformat}

* What is your [server] max-idle-persistent-connections ?","07/Feb/23 8:33 PM;617a5f2cf485cd0068cb98af;[~accountid:5b17571b91981f4fdde632c1] It's still the default value:

max-idle-persistent-connections = 512

Already","09/Feb/23 2:12 AM;5b17571b91981f4fdde632c1;{quote}max-idle-persistent-connections = 512{quote}

* By this configuration you have WebSEAL front-end persistent connections
** Once a socket is persistent we cannot go back and change the prior response to add HTTP header ‘{color:#bf2600}Connection: close{color}’
* {color:#bf2600}*max-idle-persistent-connections = 0*{color}
** Will disable all WebSEAL front-end persistent connections
*** APAR IJ41346: New feature allows us to send the HTTP header ‘{color:#ff5630}Connection: close{color}’ *on each response* when WebSEAL front-end persistent connections are disabled
**** The client MUST honor the HTTP header ‘Connection: close’ and close the connection
**** This will force a full/partial SSL/TLS handshake on every request
***** To avoid unnecessary contention it would be better to scale horizontally with this configuration",15/Feb/23 7:43 AM;5b17571b91981f4fdde632c1;* What is status?,08/Mar/23 8:55 AM;5b17571b91981f4fdde632c1;* What is the status of the is workitem?,08/Mar/23 6:53 PM;617a5f2cf485cd0068cb98af;[~accountid:5b17571b91981f4fdde632c1] Waiting for customer reply,29/Mar/23 2:25 AM;5b17571b91981f4fdde632c1;* What is status?,"04/Apr/23 9:39 PM;5b232b2fd85e5b59b066f57f;Case closed - closing WI. 

[~accountid:617a5f2cf485cd0068cb98af] - please DO NOT set the “APAR” field unless a new APAR has been opened to address the issue. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"failed client cert auth should not refer to failed ""authentication level mismatch""",ISAMSUP-4745,278154,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,26/Jan/23 6:16 AM,04/Mar/23 3:49 AM,14/Jul/23 2:47 PM,04/Mar/23 3:49 AM,,,,0,,,,"Customer gets an error message about failed reauth when there is no reauth.

Customer attempts to perform client certificate authentication. The customer's cert does not successfully map to an ISVA user, so we expect the client cert auth to fail. However, after the failed client cert auth, customer sees this error message:

{{Error Text: DPWWA1130E Authentication level mismatch when performing reauthentication}}

*Problem:* There is no reauth attempt, so the error message should not refer to reauth.  Instead, the customer is expecting a more generic error about failed client cert auth/mapping.

Support file is here: /ecurep/sf/TS011/775/TS011775892/2023-01-09/

WebSEAL instance is *default*. Here are a few key settings:

{noformat}accept-client-certs = required
reauth-for-inactive = no
reauth-at-any-level = no{noformat}

A pdweb trace is here: /ecurep/sf/TS011/775/TS011775892/2023-01-25/pdweb_1_.log

You can follow thread(35) in the pdweb trace.

As I mentioned eariler, the client cert does not map to an ISVA user, so we expect the client cert auth to fail and we see 0x13212065 (this is good).

2023-01-25-12:39:46.943-05:00I----- thread(35) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-getcreds.cpp:184: [10.36.216.20] CII EXIT get_cert_cred with status:  0x13212065 and creds: 0

A little bit later, the code drops into process_junction, and then comes out with 0x38cf0427 (this is the reported problem)

2023-01-25-12:39:46.943-05:00I----- thread(35) trace.pdweb.wns.authn:6 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:4090: [10.36.216.20] CEI EXIT process_junction with status=0x38cf0427

[~accountid:5b15d99b4c20165700edecad] was also looking at this case and thinks the problem might be related to case cert code.",,David Hayes,Gabe,khansen,Nick Lloyd,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011775892,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Reagan Knowles,5b15d9e44c4ed14b83af8723,,,,PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17uin:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-27 16:10:10.707,,,,,"26/Jan/23 6:25 AM;5b15d9e44c4ed14b83af8723;{noformat}/pdweb/webseald/authn/framework/authn-resp.cpp
399-430{noformat}



Is the flow going to the else {{dceweb_st_reauth_auth_level_mismatch}} in the following code?

{noformat}    case cert: {
        if ( (valid_auth_types & auth_type_cert) &&
            WsSslInterface::isCertPromptAsNeeded(h->connector) ) {
            /* 
             * We know at this point that the client is requesting a resource
             * residing in the certificate authentication level. Therefore,
             * block out all the other authentication prompts.
             */
            macroList->set(M_BASICAUTHN, ""<!--"");
            macroList->set(M_TOKENAUTHN, ""<!--"");
            macroList->set(M_EAIAUTHN, ""<!--"");
            macroList->set(M_OIDCAUTHN, ""<!--"");

            write_template_file_with_code(h,
                                          request,
                                          response,
                                          outInfo,
                                          OP_CERT_LOGIN,
                                          http_status,
                                          status_to_report,
                                          macroList);
        }
        else {
            http_status = dceweb_st_reauth_auth_level_mismatch;
        }
        }
        break;{noformat}","26/Jan/23 6:33 AM;5b15d9e44c4ed14b83af8723;Customer states that changing {{accept-client-certs}} to prompt_as_needed did not change the behavior, same reauth error message appears","27/Jan/23 1:01 AM;5b15d9e44c4ed14b83af8723;Annelise provided some analysis. Below, I am paraphrasing some of her words.

Customer has both ""accept-client-certs = required"" and a POP with value 1, then it outputs the problem error message.

After the client cert fails, the flow continues to process the stepup config: ""In the event an unauthenticated user requests a protected resource which requires a step-up operation, control what login prompt is shown to that user.""  But the customer has client-certs required and can't do a stepup, so the flow fails with the error about mismatched levels.

That main fix in my view is only auth-main should be setting dceweb_st_reauth_auth_level_mismatch
auth-resp needs to have a different, more accurate error for the cases and not just reuse a ""close enough"" error message.

like:
{{<Message ID=""DPWWA2045W "" prefix=""yes"">    <!-- code wand_s_bad_cert_stepup_config -->    <MsgText msgIndex=""2045"" varFormat=""C"">    A client attempted to Step-up to certificates, but the server is not configured for Step-up to certificates. (0x38cf07fd)}}
{{<Message ID=""DPWWA1061E "" prefix=""yes"">    <!-- code ivacl_s_authn_stepup_details -->    <MsgText msgIndex=""1061"" varFormat=""C"">    Provide your authentication details for method: (0x1005b425)}}
{{<Message ID=""DPWWA1062E "" prefix=""yes"">    <!-- code ivacl_s_authn_stepup_unknown_level -->    <MsgText msgIndex=""1062"" varFormat=""C"">    An invalid authentication level has been detected in a POP object. (0x1005b426)}}

authn-resp.cpp
line 357 should use ivacl_s_authn_stepup_unknown_level
line 430 should use wand_s_bad_cert_stepup_config
etc..","28/Jan/23 2:10 AM;5b15d9e581c3df12acf53c4a;I have not checked all the traces yet but if you have not collected it yet, can you please get the full trace meaning:

Instead of specify a component like  pdweb.debug etc, please select just “pdweb” which will capture all.

Among other, I am mainly interested in pdwen.wns ( which “pdweb” will have it ) which will show source code lines which are very easy to track and see where things are  going wrong.

By the way, if you can reproduce it, seems like it is reproducible, you can collect traces from your own reproduction, just let me know which version so that I can use same source code to follow the traces.



If you already have the traces ( what I need, minimum, is pdweb.wns ) then let me know where it it is.",28/Jan/23 2:38 AM;5b15d99b4c20165700edecad;A pdweb trace is here: /ecurep/sf/TS011/775/TS011775892/2023-01-25/pdweb_1_.log,"28/Jan/23 6:12 AM;5b15d9e581c3df12acf53c4a;Thanks Reagan, you are right about the source file, with pdweb.wns trace, it shows code line so it can be followed which way it is going and what other options , if any, it is considering and why………",01/Feb/23 5:35 AM;5b15d9e44c4ed14b83af8723;[~accountid:5b15d9e581c3df12acf53c4a] Customer is asking for an update. Can I create an APAR to have the message corrected?,"01/Feb/23 7:40 AM;5b15d9e581c3df12acf53c4a;Just hold a little bit longer please, I saw something in the code path that may or may not have a different explanation but I have not traced it all they way back yet….I just need to make sure all the options ( Webseal has thousand and one option ……..) specified in the conf file are all playing nicely all together. I will update soon,",02/Feb/23 12:34 AM;5b15d9e44c4ed14b83af8723;[~accountid:5b15d9e581c3df12acf53c4a] Customer is asking again for an update. I’ve asked the customer to provide some context to help us understand why this is such an important issue for them.,"02/Feb/23 6:05 AM;5b15d9e581c3df12acf53c4a;There is, apparently, little bit more going on in the code, to be 100% sure, I need to recreate it, I have not attempted the recreate yet,  I see that it is a certificate authentication along with eai, I understand that they are not stepping up to eai, just authenticating via cert, can you give me some generic steps or if you have already recreated it, can you give me the steps?

Going through the code, I just feel like there must be a minor config issue some where, I see that in the code, for some reason, we did not map the error code from authentication module i.e. error code 0x132120de to a good error code ivauthn_bad_authentication_info  i.e. 0x132120c9, I need to find out why or it simply could be a bug……..","02/Feb/23 6:40 AM;5b15d9e581c3df12acf53c4a;Also, if you have a recreate env or ask customer to try the following hidden option:

[certificate]

always-map-certfailure-required = yes



Restart and try, it should map the error more properly.",09/Feb/23 3:00 AM;5b15d9e44c4ed14b83af8723;Still waiting on the customer. They said they had to schedule a change request for this item.,04/Mar/23 3:49 AM;5b15d9e44c4ed14b83af8723;Customer stopped responding. I closed the case. I don’t know if “always-map-certfailure-required” changed the behavior.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Fixpack for vulnerability,ISAMSUP-4743,278105,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,25/Jan/23 7:31 PM,27/Mar/23 10:19 AM,14/Jul/23 2:47 PM,27/Mar/23 10:19 AM,,,,0,,,,"client need fixpack to solve this vulnerability described here? [https://www.ibm.com/support/pages/node/6855297|https://www.ibm.com/support/pages/node/6855297|smart-link]  

they are on version 10.0.3.1.",,Aaron.Richie.Dias,Alan Wong,Ayush Singh,BRIANORO,David Flynn,Dermot Daly,Surya Prakash,,,,,,,,,6194c472fe9f300068e5252f,6092aca0f0db130069d19687,61409dc154762c006932ffc7,6154906364ff01007106e189,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,60f541a6d0134900692d91b7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011884153,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,NORDEA BANK AB,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17u7r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-01-31 19:42:35.189,,,,,27/Jan/23 6:49 PM;61409dc154762c006932ffc7;[~accountid:5b15d8fd6e93913e31e279fb] any updates?,31/Jan/23 7:27 PM;61409dc154762c006932ffc7;[~accountid:5b15d8fd6e93913e31e279fb]  any updates on this also we have another query from client the client had fixpack [IJ41819-jsrsasign.fixpack.md5|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011232590&path=TS011232590/2022-11-18/&filepath=TS011232590/2022-11-18/IJ41819-jsrsasign.fixpack.md5] do they need to install with the new fixpack requested for this case.,"01/Feb/23 5:42 AM;5b15d8fd6e93913e31e279fb;This is not possible.  The fixes were delivered on a base of code that is not compatible with the OS base that was delivered with ISVA 10.0.3.1.

Consider the following.

AIX Released the following versions. 7.1, 7.2, 7.3. Packages delivering fixes in AIX 7.3 cannot be run on AIX 7.1. This is similar to the versions of the OS that is delivered for the ISVA Appliance. Another thing to consider is that packages are moved to newer levels in the rebases. A package like rsync may be updated in the rebase from versoin 1.x to 2.x and the vulnerability may only affect the 2.x version of the package.

This is part of why the ISVA Support Policy provides that security fixes are supplied on the most recent modification level.

[https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|smart-link]",13/Feb/23 10:30 PM;61409dc154762c006932ffc7;[~accountid:5b15d8fd6e93913e31e279fb] the client is asking for detailed explanation why we can  not deliver the fixpack for this vulnerability on the ISVA version client are running?,15/Feb/23 4:46 AM;5b15d8fd6e93913e31e279fb;We cannot discuss MCP with customers and so I cannot give a detailed answer without disclosing the MCP and how the IBM Team is supporting it.  [~accountid:5ac57757d9a96536d1f0daa9] is going to provide a response that we can legally discuss with the customer.,15/Feb/23 6:04 PM;61409dc154762c006932ffc7;[~accountid:5b15d8fd6e93913e31e279fb] thanks for confirming that [~accountid:5ac57757d9a96536d1f0daa9] please let us know the response that we can provide to customer.,21/Feb/23 7:58 PM;61409dc154762c006932ffc7;[~accountid:5ac57757d9a96536d1f0daa9] do we have a response for customer as they are looking for an update.,"22/Feb/23 9:52 PM;61409dc154762c006932ffc7;[~accountid:5b15d8fd6e93913e31e279fb]  & [~accountid:5ac57757d9a96536d1f0daa9] the client is pushing for an update.

They have few queries sharing the same below please update on this

If there wont be a fix for our version 10.0.3.1, to me it states that this version will be out of support from your side?

I also would like to know what our options is here.

Is an upgrade to the latest version 10.0.5 the only way to go or can we close this vulnerability in some other way by disable/remove some specific module or functionality within ISVA?



And if we decide to stay on our current version, what is the actual risk of doing that?","22/Feb/23 10:12 PM;6092ac9ff6c0960069d47a67;[~accountid:5ac57757d9a96536d1f0daa9], as per Ayush’s messages, is there an update you can provide to give to the customer?",24/Feb/23 6:09 PM;61409dc154762c006932ffc7;[~accountid:5b15d8fd6e93913e31e279fb] & [~accountid:5ac57757d9a96536d1f0daa9] could you please provide an update ???,01/Mar/23 2:04 AM;5b15d8fd6e93913e31e279fb;[~accountid:61409dc154762c006932ffc7] The only way to get this fix is to move up to ISVA 10.0.5.0.  This is consistent with our Support Policy that security vulnerabilities are only fixed on the latest Mod level of a release.  This is documented at [https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|smart-link] There is no mitigations that can be applied to remediate any of the issues in the Security Bulletin.,01/Mar/23 2:38 AM;61409dc154762c006932ffc7;[~accountid:5b15d8fd6e93913e31e279fb] thanks for clarifying will share it with client,27/Mar/23 10:19 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Multiple vulnerabilities with ISVA v10.0.5 container image,ISAMSUP-4742,278080,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Virag Patel,5b17571a82e05b22cc7d5d9e,Virag Patel,5b17571a82e05b22cc7d5d9e,25/Jan/23 3:42 PM,17/Feb/23 2:05 AM,14/Jul/23 2:47 PM,17/Feb/23 2:05 AM,,Support,,0,,,,"customer found multiple medium and low vulnerabilities of RHEL, as listed below in the 10.0.5 image. 

v10.0.5 image uses Red Hat v8.7 and most of them are were fixed on v9. 

customer would like to know when they can expect v10.0.5 image to be upgraded with RHEL v9 to make sure all known OS level vulnerabilities are fixed.



*List of vulnerabilities found at OS level:*

{noformat}CVE-2019-9705 CVE-2019-9704 CVE-2022-43552 CVE-2022-35252 RHSA-2023:0096 CVE-2022-42012 CVE-2020-35512 CVE-2022-42010 CVE-2022-42011 CVE-2022-43680 CVE-2022-23990 RHSA-2023:0103 CVE-2019-8906 CVE-2019-8905 CVE-2021-4209 CVE-2020-21674 CVE-2017-14166 CVE-2017-14501 CVE-2018-1000879 CVE-2018-1000880 CVE-2022-36227 CVE-2019-12904 CVE-2022-47629 CVE-2021-44568 RHSA-2023:0116 CVE-2021-46848 CVE-2018-1000654 RHSA-2023:0173 CVE-2022-40304 CVE-2022-40303 CVE-2019-13117 CVE-2019-13118 CVE-2016-4607 CVE-2021-39537 CVE-2018-19211 CVE-2018-19217 CVE-2020-15778 CVE-2019-6110 CVE-2018-15919 CVE-2018-1121 CVE-2021-35937 CVE-2021-35939 CVE-2021-35938 CVE-2022-0235 CVE-2018-20839 CVE-2022-3821 CVE-2022-4415 RHSA-2023:0100 CVE-2021-20193 CVE-2019-9923{noformat}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011936195,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Virag Patel,5b17571a82e05b22cc7d5d9e,,,,"Ministry of Finance, SG",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17u27:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-01 19:28:52.752,,,,,"02/Feb/23 1:04 AM;5b17571a82e05b22cc7d5d9e;Hi Jim,

Got a chance to take a look. Customer is following up on this.",02/Feb/23 5:28 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac577587028785d133fbc46] [~accountid:5ac57757d9a96536d1f0daa9] Is there a plan to move to RedHat UBI 9?,07/Feb/23 11:52 PM;5b17571a82e05b22cc7d5d9e;[~accountid:5b15d8fd6e93913e31e279fb] pls update ,09/Feb/23 3:24 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b17571a82e05b22cc7d5d9e] The update to RedHat UBI 9 is not something that can be done in service without Development first updating and running the full regression testing on it.  I have tagged [~accountid:5ac577587028785d133fbc46] [~accountid:5ac57757d9a96536d1f0daa9] and am adding [~accountid:5ac577577331be74a80d5ab4] to respond for development plans for this update.,"09/Feb/23 7:30 AM;5ac577577331be74a80d5ab4;I don’t know if there are any planned changes to move to UBI-9, but the changes shouldn’t be taken lightly and will need development effort.  We really need to keep the product in sync, which means that when we decide to move to UBI-9 we will need to update our build environment, MCP (for the appliance), and our docker containers.",15/Feb/23 4:48 AM;5b15d8fd6e93913e31e279fb;The customer needs to open a RFE for this so that development can consider and plan the upgrade of the UBI layer.,"16/Feb/23 12:58 PM;5b17571a82e05b22cc7d5d9e;[~accountid:5b15d8fd6e93913e31e279fb] thanks for clarification.

customer has below query regarding security practice followed by us. could you pls share your comments ?



We have a audit question on how the API is managed and tested (pen tested) to make sure the ISAM api's are secure from vulnerabilities. 

I am not able to find the document on API lifecycle management on ISAM appliance. T

*he requested question are* 

*1.* If any vulnerability is found in the language/os used by ISAM, how IBM takes care of the vulnerability including the regression testing. 

*2.* What is frequency of pen testing carried out for ISAM as a product. Since ISAM is a black box for us, is it possible to provide some explanation on the above questions.

----",17/Feb/23 2:05 AM;5b15d8fd6e93913e31e279fb;The Customer SF case has been closed.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
10.0.5.0 pkg disappears from console post upload,ISAMSUP-4734,277864,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,23/Jan/23 3:54 PM,06/Feb/23 1:53 PM,14/Jul/23 2:47 PM,06/Feb/23 1:53 PM,,,,0,,,,"HI



Customer is trying to upgrade to 10.0.5.0 from 10.0.4.0 IF1 

In December, they had applied signing.fixpack as well. and post that when they upload 10.0.5.0 pkg file , it gets uploaded by disappears from LMI after some time.



L2 able to recreate the issue:



1.get to version 10.0.4.0 and apply 10.0.4.0 IF1

2.apply signing.fixpack

3.try to upload 10.0.5.0 pkg file

The following is shown

{noformat}023/01/20 23:51:32.128 T:140662604086464 LumLogger.cpp:154:<global function, LumLogger_Init> Entered method.
2023/01/20 23:51:32.553 T:140662604086464 main.cpp:613:Ready
2023/01/21 00:20:11.707 T:140662514444032 [ERROR]UpdateMgr.cpp:735:An error was encountered while trying to find available remote updates. Reason: 'Unable to download the update catalog. [ID=0xc75d0011]'
2023/01/21 03:08:08.555 T:140662514444032 [ERROR]UpdateMgr.cpp:735:An error was encountered while trying to find available remote updates. Reason: 'Unable to download the update catalog. [ID=0xc75d0011]'
2023/01/21 03:08:08.556 T:140662514444032 [ERROR]UpdateUtils.cpp:388:Verifying the digital signature of '/var/spool/updates/isva_10.0.5.0_20221129-1716.pkg' failed. Reason: The file does not contain a valid signature or is missing required data  fields. [ID=0xc7320207]
2023/01/21 03:08:08.697 T:140662514444032 [ERROR]UpdateMgr.cpp:762:An error was encountered while trying to find available local updates. Reason: 'The update package file failed signature verification. [ID=0xc75d0017]'
2023/01/22 02:40:03.701 T:140662514444032 [ERROR]UpdateMgr.cpp:735:An error was encountered while trying to find available remote updates. Reason: 'Unable to download the update catalog. [ID=0xc75d0011]'
2023/01/23 03:05:21.707 T:140662514444032 [ERROR]UpdateMgr.cpp:735:An error was encountered while trying to find available remote updates. Reason: 'Unable to download the update catalog. [ID=0xc75d0011]'
2023/01/23 13:43:50.728 T:140662514444032 [ERROR]UpdateMgr.cpp:735:An error was encountered while trying to find available remote updates. Reason: 'Unable to download the update catalog. [ID=0xc75d0011]'
2023/01/23 13:43:50.729 T:140662514444032 [ERROR]UpdateUtils.cpp:388:Verifying the digital signature of '/var/spool/updates/isva_10.0.5.0_20221129-1716.pkg' failed. Reason: The file does not contain a valid signature or is missing required data  fields. [ID=0xc7320207]
2023/01/23 13:43:50.887 T:140662514444032 [ERROR]UpdateMgr.cpp:762:An error was encountered while trying to find available local updates. Reason: 'The update package file failed signature verification. [ID=0xc75d0017]'
/var/log #{noformat}



uninstall signing fixpack doesn’t change anything.



I got. recreate env incase anything is required.(although signing.fixpack isn’t suppose to be applied) but if applied will it result in breaking further ability to upgrade( ideally it shouldn’t have mattered as far as signing is concerned and shouldn’t reject the uploaded package)



Customer’s logs at:

/ecurep/sf/TS011/867/TS011867670/2023-01-20/





There is nothing in /var/spool/update , post upgrade.

MD5 of pkg file matches.",,Annelise Quap,BRIANORO,Nick Lloyd,,,,,,,,,,,,,5b15d950d9936c61022057fe,6154906364ff01007106e189,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011867670,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,DHA Australia,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17sq7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-23 20:33:09.781,,,,,"24/Jan/23 2:01 AM;5c53d3ac23f5bf672621c868;Yesterday I observed the following in my lab:



1.on 10.0.4.0 , applied 10.0.4.0 IF1 (got applied successfully)

2.then applied signing fixpack

3.then rolled back signing fixpack

4.rolled back 10.0.4.0 IF1



at this point. I am not able to apply 10.0.4.0 IF1 again. and it's giving signature failure. 



{noformat}an 23 21:31:34 mesa_config[7077]: Last message repeated 1 times
Jan 23 21:31:34 mesa_config[7077]: Warning: Ignoring invalid tuning parameter at line 325
Jan 23 21:39:23 mesa_control[9251]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.4.0_IF1.fixpack
Jan 23 21:44:22 mesa_install_fixpack: 10.0.4.0_IF1: Failed to verify signature
Jan 23 21:44:22 mesa_control[9251]: Error: Fixpack /tmp/fixpacktmpdir/10.0.4.0_IF1.fixpack: Failed to verify signature
Jan 23 21:44:22 mesa_control[9251]: GLGFP1004E:: GLG_events:: |file=10.0.4.0_IF1.fixpack|
Jan 24 00:02:13 mesa_config[20337]: GLGSY0020I:: GLG_events:: |user=admin|
Jan 24 00:02:13 mesa_config[20337]: GLGSY0103I:: GLG_events:: |user=admin,host=9.43.224.73|
Jan 24 00:02:13 sshd[20317]: Accepted keyboard-interactive/pam for admin from 9.43.224.73 port 51197 ssh2
Jan 24 00:02:1{noformat}



seems signing fixpack is not working well at 10.0.4.0 ( although its not suppose to be appleid but still if someone applies shouldn’t cause such behaviour)","24/Jan/23 6:33 AM;5b15d950d9936c61022057fe;FYI, just to also add some more to this.    I had a customer also report a problem with the same errors in the logs.

Even with a clean 10.0.4.0_if1  without applying a the updated signatures fixpack.



I was able to recreate the error.


If I upload the 10.0.5 pkg that works.  When I first upload it if I wait the the loading to finish it shows me the file as a local update that is idle.  If I then press the “refresh” button in that list, suddenly this disables the “refresh” and ”install” buttons.   If I then reload the page in the browser now the update is missing from the list.

When I reload the page in the browser the following is logged in the /var/log/messages file:

Jan 23 14:22:10 iss-lum[1372]: GLGUP1012E:: GLG_events:: ||
Jan 23 14:22:10 iss-lum[1372]: id=update time=""2023-01-23 14:22:10"" fw=ISVA10041.local.hostonly pri=3 op=discover issueid=7000003 name=Update_Error msg=""Unable to download the primary update catalog file. Reason: Unknown error 2001 [ID=2001]""
Jan 23 14:22:10 iss-lum[1372]: GLGUP1013E:: GLG_events:: |file=/var/spool/updates/isva_10.0.5.0_20221129-1716.pkg|
Jan 23 14:22:10 mesa_config[8830]: Error: ""Unable to discover available updates. Reason: The update package file failed signature verification.""



If I then upload the pkg file again and wait for a few seconds after the upload completes it will show up in the list again.  There are no errors logged when I reupload the file.

If I select it before reloading the page and click install it installs 10.0.5 as expected. 

It seems somehow that the actions of refreshing the page is breaking the signature validation.   So customers that are impatient after uploading the file will have problems with the signature and the file disappearing from the list.  ","24/Jan/23 7:15 AM;5b15d950d9936c61022057fe;It will also occasionally show a system error for a second just after the upload finishes, about not being able to reach the update server.  This can be ignored.  A customer may see this brief flash of a red dialog and think something was wrong with the upload.     


Sometimes, when reuploading the file it will display “""Unable to discover available updates. Reason: The update package file failed signature verification.” twice in quick succession.  This is also when  the red system error will appear just before it switches to the “loading …” animation. 


The error doesn’t always happen with just refreshing the page in the browser or reuploading the pkg.  The trigger for the disappearing item from the list seems to be clicking the refresh button in the list display and then reloading the page.  ","24/Jan/23 10:42 AM;5b15d954b0d76456f36daf33;I was able to recreate this too. The main issue is the refresh button/page reload that is unable to validate the pkg file. As a result the file itself is deleted.

Will investigate further, but looks like it warrants an APAR anyway.","25/Jan/23 1:55 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 



Have some queries around isva signing fixpack?

how do someone removes it? 

IT looks my customer applied it. I applied it too and rolled it back and post that even usual fixpack cannot be installed.

example: if signing fixpack is installed on top of 10.0.4.0 and its rollback then 10.0.4.0 IF1 can’t be installed.



We know we specify that signing fixpack doesn’t need to be installed at 10.0.4.0 but customer still does . Is there a way to completely undo its installation 



basically, customer would like to get all their if continue to install once signing fixpack is rolledback",25/Jan/23 4:10 PM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] do you still need clarification about these? Or was our slack discussion enough?,"25/Jan/23 4:22 PM;5c53d3ac23f5bf672621c868;Hi Bhavan



Yeah our slack discussion good enough. Issue is indeed only when refresh button is clicked.

I will work on what we can do about signing fixpack .","25/Jan/23 4:31 PM;5b15d954b0d76456f36daf33;Is the customer in the same situation as you are after rolling back the isva.signing and 10.0.4.0_IF1 fixpacks?

If not, let’s get their 10.0.5.0 upgrade working first.","25/Jan/23 5:26 PM;5c53d3ac23f5bf672621c868;sure . they are not in the same situation.



just wanted to check: is this refresh problem going to be on 10.0.5.0 as well when its going to have a firmware update?","25/Jan/23 5:36 PM;5c53d3ac23f5bf672621c868;I checked 10.0.5.0 ( by uploading a dummy 10.0.5.0 pkg file) .  



refresh button didn’t cause pkg file to go away at 10.0.5.0 



The reason looks like 10.0.5.0 uses a set of rest api ( discover is not called) which is inline with your explanation.



Summarily:

1.just get the customer upgraded to 10.0.5.0 (they shouldn’t face any issue post that)

2.Will it ever be fixed at 10.0.4.0 (from our discussion , it may not be , if customer  is already going to 10.0.5.0) ","27/Jan/23 9:52 AM;5b15d954b0d76456f36daf33;[~accountid:5c53d3ac23f5bf672621c868] thanks for confirming this is specific to 10.0.4.0. 

Like discussed, the best course of action is to get the upgrade to 10.0.5.0 going as soon the upload is done.","30/Jan/23 11:54 AM;5b15d954b0d76456f36daf33;There might be a way to make the pkg file stay in spite of the errors. 

{noformat}update.delete.failed.install = false{noformat}

This ATP prevents those files that fail install or verify from being deleted automatically.

 It fixed the problem with the ‘refresh’ button deleting the pkg file in my local environment:","03/Feb/23 12:09 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d954b0d76456f36daf33] 

case is closed. the issue is fixed. Jira can be closed as well.

Thankyou very much.



I will open a separate internal Jira for the effects of signing fixpack and its behaviour even after uninstall",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Saml20 Logout failure,ISAMSUP-4725,276674,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,19/Jan/23 8:30 PM,15/Jun/23 11:28 PM,14/Jul/23 2:47 PM,15/Jun/23 11:28 PM,,Support,,0,escalated,,,"Customer encounter the following error in the runtime federation log when trying to log out from a website:


{noformat}16108 [1/13/23, 16:07:38:012 CET] 000118a5 id=00000000 m.saml20.protocol.actions.slo.SAML20BuildLogoutRequestAction E setSessionIndex FBTSML220E Cannot determine the session index for the logout request. 
16109 [1/13/23, 16:07:38:012 CET] 000118a5 id=00000000 m.saml20.protocol.actions.slo.SAML20BuildLogoutRequestAction 1 setSessionIndex Error: Cannot set required SessionIndex; halting with ErrorBuildingRequestInterrupt {noformat}

They expect that SessionIndex isn't required for a logout. There IDP expects to use NameID for this. However it seems like ISVA does require SessionIndex to be set.


When I check on the article below it suggest we support to exclude SessionIndex as IDP:
[https://www.ibm.com/docs/en/sva/10.0.4?topic=information-saml-20-identity-provider-worksheet|https://www.ibm.com/docs/en/sva/10.0.4?topic=information-saml-20-identity-provider-worksheet|smart-link] 

In this case, ISVA act as SP in this scenario

Is it possible if we can remove dependency on SessionIndex for single logout?

If customer chose to exclude SessionIndex coming from another IDP then do we support it?



[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011831752&path=TS011831752%2F2023-01-13%2F&filepath=TS011831752%2F2023-01-13%2Fisva_10.0.4.0_20230113-160821_grnpx009.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011831752&path=TS011831752%2F2023-01-13%2F&filepath=TS011831752%2F2023-01-13%2Fisva_10.0.4.0_20230113-160821_grnpx009.support]
",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,Virag Patel,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011831752,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,DIENST UITVOERING ONDERWIJS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17qq7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-23 21:47:44.611,,,,,"24/Jan/23 7:47 AM;5b15d99182e05b22cc7d5947;Hello Prabhjeet,

In this scenario ISVA is a SP federation and is receiving logout from a IDP partner where SessionIndex is missing? Just want to confirm.

Does the support file mentioned above contain the IDP partner SLO request? If yes what time stamp is the SLO request in federation traces contained in [10.0.4.0_20230113-160821_grnpx009.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011831752&path=TS011831752%2F2023-01-13%2F&filepath=TS011831752%2F2023-01-13%2Fisva_10.0.4.0_20230113-160821_grnpx009.support]?

Thanks!","03/Feb/23 1:55 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 
Customer just shared the trace.log


Please find where the SessionIndex is missing along with timestamp below:

{noformat}[2/2/23, 13:48:35:259 CET] 000045d2 id=00000000 com.tivoli.am.fim.fedmgr2.page.PageImpl                      
3 InitialVariablesInWriteTo() macros [{@PAGE_IDENTIFIER@=/saml20/error_building_msg.html, @TARGET@=null, @PARTNER_ENTITY_ID@=, @ERROR_MESSAGE@=FBTSML220E Cannot determine the session index for the logout request., @FEDERATION_NAME@=MijnDUO-2-DigiDCC, @FEDERATION_ENTITY_ID@=urn:nl-eid-gdi:1.0:DV:00000001800866472000:entities:9000, @REQ_ADDR@=/sps/MijnDUO-2-DigiDCC/saml20/sloinitial, @ERROR_CODE@=FBTSML220E, @EXCEPTION_STACK@=, @PARTNER_NAME@=, @TIMESTAMP@=2023-02-02T12:48:35Z, @SAMLSTATUS@=<fim:FIMStatusCollection xmlns:fim=""urn:ibm:names:ITFIM:saml"" xmlns:samlp=""urn:oasis:names:tc:SAML:2.0:protocol""><fim:FIMStatusCollectionEntry><samlp:Status><samlp:StatusCode Value=""urn:oasis:names:tc:SAML:2.0:status:Responder""></samlp:StatusCode><samlp:StatusDetail><fim:FIMStatusDetail MessageID=""required_session_index_not_found""></fim:FIMStatusDetail></samlp:StatusDetail></samlp:Status></fim:FIMStatusCollectionEntry></fim:FIMStatusCollection>, @EXCEPTION_MSG@=}]
{noformat}

Thanks","04/Feb/23 11:36 AM;5b15d99182e05b22cc7d5947;Hello Prabbhjeet,

Do we know if this issue is a regression where the slo request has worked? But customer now sees issue after an upgrade to 10.0.4.0? 

Or is customer’s setup a new 10.0.4.0 setup.

Thanks!","07/Feb/23 10:05 PM;627a7fb30d1e73006f7c21cf;Yes, the customer has recently upgraded to 10.0.4 but I don’t think it is a regression issue. 
I have asked the customer over the case update.","07/Feb/23 10:13 PM;5c53d3ac23f5bf672621c868;putting update from Yongming from slack



----

In saml-profiles-2.0-os.pdf 4.4.4.1, it mentioned: ""If the requester is a session participant, it MUST include at least one <SessionIndex> element in the
request. If the requester is a session authority (or acting on its behalf), then it MAY omit any such
elements to indicate the termination of all of the principal's applicable sessions.""   ISVA as SP can't disable SessionIndex

----

--

[~accountid:627a7fb30d1e73006f7c21cf] let us know about customer feedback","08/Feb/23 1:31 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 
Update from the customer

“This is a new Federation so it has not worked yet. We are not doing a SSO, so it is not an official SLO but Just a logoff to the IDP over SAML, we want to make everything correct and neatly.”","14/Feb/23 3:15 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 

Any update for the Customer on this?","16/Feb/23 8:26 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 

Any update for the Customer on this?","17/Feb/23 3:59 AM;5b15d99182e05b22cc7d5947;Hello Prabhjeet,

Seems Tushar and YongMing has answered why sessionindex is required.

Thanks!","17/Feb/23 8:13 PM;627a7fb30d1e73006f7c21cf;Hi,

I have updated that why SessionIndex is required in the case…","20/Feb/23 9:04 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 

Customer’s update, according to  saml-core-2.0-os.pdf"" chapter *3.7.1 Element <LogoutRequest>*

----

“ I couldnt find your citation in its exact wording, but was able to see what you meant by checking chapter 4.4.4.1.

However when i check the documentation from ""saml-core-2.0-os.pdf"" chapter 3.7.1 it is explicitly mentioned that sessionindex is optional within the logoutrequest”

----","21/Feb/23 1:48 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 
Some more finding on this case from (IBM Security Expert Essentials Account Manager) product documentation to find some hints related to this issue.


1.  When an ISVA is used as an IDP -  https://www.ibm.com/docs/en/sva/10.0.5?topic=information-saml-20-identity-provider-worksheet (Check Single logout settings)  

So, ISVA as an IDP has a provision to exclude Session Index.  

2.  When ISVA is used as an SP – https://www.ibm.com/docs/en/sva/10.0.5?topic=information-saml-20-service-provider-worksheet (Check Single logout settings)  

So, ISVA as an SP has no provision to exclude Session Index. At least the latest documentation says this. And I believe there must be some reason why this is not provided.  

An , as I understand DUO's use case, ISVA is used as an SP and IDP is different source.

  

Why ISVA as an SP doesn’t have the option to exclude the session index?",28/Feb/23 8:59 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] any update on this?,"01/Mar/23 4:57 AM;5b15d99182e05b22cc7d5947;Hello Prabhjeet,

The standards as already noted look consistent which describes “If the requester is a *session participant*, it *MUST* include at least one {{<SessionIndex> }}element in the
request. If the requester is a *session authority* (or acting on its behalf), then it MAY omit any such elements to indicate the termination of all of the principal's applicable sessions.” (saml-profiles-2.0 4.4.4.1). The elements described in saml-core-2.0-os section 3.7.1 on first line indicate “A session participant *OR* session authority sends a {{<LogoutRequest> }}message to indicate that a session has been terminated”. I bolded the ‘OR’ since this is the reason 3.7.1 “<SessionIndex> [Optional]” contains the word “Optional” when considering both session authorities and session participants.

Also further down in section 3.7.3.1 (saml-core-2.0-os) provides additional guidance where:

“Session Participant Rules
When a session participant receives a {{<LogoutRequest> }}message, the session participant MUST
authenticate the message. *If the sender is the authority that provided an assertion containing an authentication statement linked to the principal's current session, the session participant MUST invalidate the principal's session(s) referred to by the <saml:BaseID>, <saml:NameID>, or <saml:EncryptedID> element, and any <SessionIndex> elements supplied in the message. If no <SessionIndex> elements are supplied, then all sessions associated with the principal MUST be invalidated.”*



Therefore both saml-profiles-2.0 and saml-core-2.0-os are consistent where only session authority can omit the session index which indicates a logout from all sessions for a particular principal.



For customer would like to know actual requirements. Is the customer needing where IDP (ie session authority) is sending a SLO where <SessionIndex>  is empty?



Thanks!","03/Mar/23 2:31 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947]  Please find the link of trace and support file shared by customer
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011831752|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011831752]","06/Mar/23 10:06 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 
Again

Please find where the SessionIndex is missing along with timestamp below:

{noformat}[2/2/23, 13:48:35:259 CET] 000045d2 id=00000000 com.tivoli.am.fim.fedmgr2.page.PageImpl                      
3 InitialVariablesInWriteTo() macros [{@PAGE_IDENTIFIER@=/saml20/error_building_msg.html, @TARGET@=null, @PARTNER_ENTITY_ID@=, @ERROR_MESSAGE@=FBTSML220E Cannot determine the session index for the logout request., @FEDERATION_NAME@=MijnDUO-2-DigiDCC, @FEDERATION_ENTITY_ID@=urn:nl-eid-gdi:1.0:DV:00000001800866472000:entities:9000, @REQ_ADDR@=/sps/MijnDUO-2-DigiDCC/saml20/sloinitial, @ERROR_CODE@=FBTSML220E, @EXCEPTION_STACK@=, @PARTNER_NAME@=, @TIMESTAMP@=2023-02-02T12:48:35Z, @SAMLSTATUS@=<fim:FIMStatusCollection xmlns:fim=""urn:ibm:names:ITFIM:saml"" xmlns:samlp=""urn:oasis:names:tc:SAML:2.0:protocol""><fim:FIMStatusCollectionEntry><samlp:Status><samlp:StatusCode Value=""urn:oasis:names:tc:SAML:2.0:status:Responder""></samlp:StatusCode><samlp:StatusDetail><fim:FIMStatusDetail MessageID=""required_session_index_not_found""></fim:FIMStatusDetail></samlp:StatusDetail></samlp:Status></fim:FIMStatusCollectionEntry></fim:FIMStatusCollection>, @EXCEPTION_MSG@=}]
{noformat}",15/Mar/23 9:20 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] Please provide the update on this case.,22/Mar/23 1:30 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] Any update ?,"27/Mar/23 8:31 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 
Customer just escalated this case for the update

“We expected that a SessionIndex isnt required for a logout. Our IDP expects us to use NameID for this. However it seems like ISVA does require SessionIndex to be set.

{noformat}https://logius.gitlab.io/digid-combiconnect/1.0/index.html#federated-login-and-logout {noformat}

Why does ISVA require SessionIndex in this case and can not function on NameID?”



Please provide an update on this case.","30/Mar/23 1:40 PM;5b232b2fd85e5b59b066f57f;[~accountid:627a7fb30d1e73006f7c21cf] - in order to progress, we require answers to the following: 


# In this scenario, is the third party IDP also acting as the session authority? 
# Is the SLO request being initiated from the IDP or the SP? 
# Is the customer trying to initiate an SLO requests at their SP federation that generates a logout with an empty sessionindex?



I have spoken with [~accountid:5b15d99182e05b22cc7d5947]. He will be focusing on this WI and will work through the provided data and provide an update in the coming days. ","30/Mar/23 11:27 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5b15d99182e05b22cc7d5947] 

Please find the required details below:

# In this scenario, is the third party IDP also acting as the session authority?
*The third party IDP is the session authority.*
# Is the SLO request being initiated from the IDP or the SP?
*SLO request is initiated by the SP (our ISVA).*
# Is the customer trying to initiate an SLO requests at their SP federation that generates a logout with an empty sessionindex?
*Customer’s ISVA initiates an SLO request at their IDP federation and it sends back nameID and no SessionIndex.*","31/Mar/23 12:29 AM;5b15d99182e05b22cc7d5947;Hello Prabhjeet,

Answers to 2. and 3. are contradicting. 

Answer to 2. is indicating customer is initiating a SLO request at  SP using ISVA.

Answer to 3. is indicating customer is initiating a SLO request at IDP federation. Where is this IDP federation? Within customer environment but not using ISVA? Please explain.



Thanks!","03/Apr/23 5:47 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 
There ISVA as SP sends a SLO request to the third party IDP. The third party IDP sends back the nameID, but not a SessionIndex.

ISVA (SP) requires the Sessionindex in the LogoutRequest, which it does not receive.

Customer wants to have an understanding of the issue in the original message:

""We expected that a SessionIndex isnt required for a logout. Our IDP expects us to use NameID for this. However it seems like ISVA does require SessionIndex to be set.""

So in short. Which is the correct interpretation of the SAML documentation for our use-case: the SAML-core document or the SAML-profile documentation?

There IDP has links to the SAML documents on the previously shared site 

{noformat} (https://logius.gitlab.io/digid-combiconnect/1.0/index.html#frameworks).{noformat}","14/Apr/23 6:27 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d99182e05b22cc7d5947] 
Customer is looking for the update on this case, can you please provide the time frame for this case.","18/Apr/23 8:21 PM;5ac57757d9a96536d1f0daa9;IBM Internal - 

[~accountid:5b232b2fd85e5b59b066f57f] as discussed today I have assigned this item to you for your assessment. From today's discussion I believe that we need some assistance from the development team to confirm your understanding. Please let me know if I can assist in any other way. ",24/Apr/23 10:47 AM;5b232b2fd85e5b59b066f57f;Quick update - I’m still discussing this with the Development team. ,"24/Apr/23 11:04 PM;5b232b2fd85e5b59b066f57f;L2 - please let the customer know that I have been and am continuing to work through the customer’s scenario with the Development team in order to ensure that all aspects of this behaviour are understood and reviewed. At this stage, I plan to have an update by end of this week. Thanks. ","02/May/23 11:53 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

Customer has requested an update on this issue because we have already provided them a timeframe of last week. Please provide an update.","03/May/23 9:24 PM;5af05450e6f95a2c1c89193d;INTERNAL

# Is it failing after an upgrade or a they are trying it for the first time?","04/May/23 4:49 PM;5b232b2fd85e5b59b066f57f;[~accountid:627a7fb30d1e73006f7c21cf] - We have been working through the customer’s trace and provided files - it seems that the logout is being initiated at the SP, in which case as per the spec the SessionIndex is required. Because the SessionIndex is not available, the flow fails. What we are investigating is why the SessionIndex is not available given that the other session attributes are available. 

Can we set up a call with the customer TUE next week (09MAY)? Please be aware of different timezones - I am GMT +10hrs; Sumana is GMT +8hrs; and we will also need L2 and obviously the customer on as well. The reason that I am suggesting 09MAY is that we may have some requests of the customer that would be good to have carried out prior to the call. 

Thanks. ","04/May/23 10:59 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

Webex meeting is scheduled with customer on Tuesday the 9th May.
9.30am CET timezone","08/May/23 11:42 AM;5b232b2fd85e5b59b066f57f;Hi [~accountid:627a7fb30d1e73006f7c21cf] - for the customer call, could we get the customer to do the following and give us the outcome and trace?: 

# SSO (HTTP Post- HTTP Post) and SLO SP init HTTP Post
# SSO (HTTP Artifact-HTTP Artifact) and SLO SP init HTTP Post
# SSO (HTTP Post- HTTP Post , NameIdEmail) and SLO SP init HTTP Post

I also notice that on the invite I can’t see [~accountid:5af05450e6f95a2c1c89193d] - can you please add her to the call? ",08/May/23 11:23 PM;6092ac9ff6c0960069d47a67;[~accountid:5b232b2fd85e5b59b066f57f] I have updated the case with the request you sent and asked Sumana to join the call as per my email,"15/May/23 1:04 PM;5b232b2fd85e5b59b066f57f;From call with customer last week (TUE 09MAY).



+Key points discussed:+  

# L3 / Dev explained to customer that the issue is that the third party IDP is not providing a session index during single sign on (SSO). Due to this, ISVA as the SP does not have a SessionIndex to use during single log out (SLO) and the flow fails. 
# There seems to be an inconsistency between the 2 SAML specs [http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf|http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf]  and [http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf|http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf]  relating to the use of SessionIndex during SLO / SSO. 
# ISVA’s implementation is adhering to the spec at [http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf|http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf] which states that the SessionIndex MUST be provided during SSO in order to support SLO.
# The customer indicated that the third party IDP is adhering to the spec at [http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf|http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf] which states that SessionIndex is optional during SSO / SLO. 

+Next steps:+ 

# IBM to document reasoning behind ISVA implementation (see below +ISVA Implementation Justification (for customer to use in discussion with IDP provider)+).
# Customer to engage with third party IDP provider and table IBM’s reasoning (step 1) and see if they can adjust their implementation to adhere to saml-profiles spec. 
# ISVA L3 / Dev happy to have further call with customer / IDP provider if required. 

----

+ISVA Implementation Justification (for customer to use in discussion with IDP provider):+

*Issue:*

      The SLO failure is caused due to the fact that ISVA as Session Participant is not able to build a LogoutRequest due to missing SessionIndex.

*Cause:*

      The SessionIndex is missing because, during the SingleSignOn flow, the IdP is expected to send the SessionIndex in the <AuthnStatement>, since this is not set during SSO, SLO fails.



*SAML 2.0 Specification and Interpretation*

*SAMLCore vs SAMLProfile*

|*SAMLCore*|*SAMLProfile*|
|The SAMLCore states that SessionIndex is [OPTIONAL]in a AuthnStatement.
2.7.2 Element <AuthnStatement>
The <AuthnStatement> element describes a statement by the SAML authority asserting that the
assertion subject was authenticated by a particular means at a particular time. Assertions containing
<AuthnStatement> elements MUST contain a <Subject> element.
SessionIndex [Optional]
Specifies the index of a particular session between the principal identified by the subject and the
authenticating authority|The SAMLProfile states that SessionIndex is a [MUST] if the identity provider support Single Logout Profile.
4.1.4.3 <Response> Message Processing Rules
At least one assertion containing an <AuthnStatement> MUST contain a <Subject> element with
at least one <SubjectConfirmation> element containing a Method of
urn:oasis:names:tc:SAML:2.0:cm:bearer. If the identity provider supports the Single Logout
profile, defined in Section 4.4, any such authentication statements MUST include a SessionIndex
attribute to enable per-session logout requests by the service provider.|
|The SAML Core states that SessionIndex is [OPTIONAL]in a LogoutRequest.
3.7.1 Element <LogoutRequest>
<SessionIndex> [Optional]
The identifier that indexes this session at the message recipient.|The SAMLProfile states that SessionIndex is [MUST]if it is a LogoutRequest initiated by the Session Participant(SP).

4.4.4.1 <LogoutRequest> Usage
*If the requester is a session participant, it MUST include at least one <SessionIndex> element in therequest*. If the requester is a session authority (or acting on its behalf), then it MAY omit any such
elements to indicate the termination of all of the principal's applicable sessions|

ISVA as a Service Provider conforms to the SAML Profile specification.

There is an apparent discrepancy between SAMLCore and SAMLProfile; researching this online finds [http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-tech-overview-2.0-cd-02.html|http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-tech-overview-2.0-cd-02.html] which states:

*Profiles:* SAML profiles define how the SAML assertions, protocols, and bindings are combined and constrained to provide greater interoperability in particular usage scenarios. Some of these profiles are examined in detail later in this document. The profiles defined by SAML V2.0 are:

* *Web Browser SSO Profile:* Defines how SAML entities use the Authentication Request Protocol and SAML Response messages and assertions to achieve single sign-on with standard web browsers. It defines how the messages are used in combination with the HTTP Redirect, HTTP POST, and HTTP Artifact bindings.
* *Enhanced Client and Proxy (ECP) Profile:* Defines a specialized SSO profile where specialized clients or gateway proxies can use the Reverse-SOAP (PAOS) and SOAP bindings. 
* *Identity Provider Discovery Profile:* Defines one possible mechanism for service providers to learn about the identity providers that a user has previously visited.
* *Single Logout Profile:* Defines how the SAML Single Logout Protocol can be used with SOAP, HTTP Redirect, HTTP POST, and HTTP Artifact bindings.
* *Assertion Query/Request Profile:* Defines how SAML entities can use the SAML Query and Request Protocol to obtain SAML assertions over a synchronous binding, such as SOAP. 
* *Artifact Resolution Profile:* Defines how SAML entities can use the Artifact Resolution Protocol over a synchronous binding, such as SOAP, to obtain the protocol message referred to by an artifact.
* *Name Identifier Management Profile:* Defines how the Name Identifier Management Protocol may be used with SOAP, HTTP Redirect, HTTP POST, and HTTP Artifact bindings.
* *Name Identifier Mapping Profile:* Defines how the Name Identifier Mapping Protocol uses a synchronous binding such as SOAP.

In 1.1 Profile Concepts of the SAMLProfile ([https://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf|https://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf])

A particular example of the latter are those that address SAML attributes. The SAML <Attribute>
element provides a great deal of flexibility in attribute naming, value syntax, and including in-band
metadata through the use of XML attributes. Interoperability is achieved by constraining this flexibility
when warranted by adhering to profiles that define how to use these elements with greater specificity than
the generic rules defined by [SAMLCore]

Essentially, SAMLCore defines generic rules and SAMLProfiles constrains it for use in various practical scenarios; and thus should have precedence over SAMLCore. ","15/Jun/23 11:28 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] Issue is resolved now, closing the case",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 Access /mga/scim/configuration it takes a very long time,ISAMSUP-4703,275779,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,12/Jan/23 7:14 PM,02/Feb/23 6:19 AM,14/Jul/23 2:47 PM,02/Feb/23 6:19 AM,,,,0,,,,"We are not sure if this is ISAM related or LDAP related, but when we are trying to access /mga/scim/configuration it takes a very long time before we can access the page. Sometimes we are lucky and can access it within a few minutes. But those occasions are very rare. The normal behavior is that we have to wait 30-45min before we can access the page.

Do you have any ideas on how we can troubleshoot this?

Have you seen it before?

The predefined LDAP server that we have seems to be working just fine.""

*After some suggestion given to Customer of testing the Tcp connect*

“the issue was accessing /mga/scim/configuration . Is it not happening anymore, and now is just when clicking on ""User Profile"" that hangs for 16 min?”

*Other findings*

Customer changed it to point directly to node number 1 to rule out any cluster/load balancing issues.

So server connection which SCIM is using is using ip 10.84.96.31.

ISAM should not freeze for 16 minutes and block me completely from using the configuration page only to break after the freeze.

Regarding retransmit, the ldapsearch is working without any issues from the server CLI during the ""freeze"" in GUI.





[https://ecurep.mainz.de.ibm.com/ae5/#id=TS009168660&path=TS009168660%2F2022-12-01%2F&filepath=TS009168660%2F2022-12-01%2Fisva_10.0.4.0_20221201-140757_ISAM-DMZ-WS1-TEST.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS009168660&path=TS009168660%2F2022-12-01%2F&filepath=TS009168660%2F2022-12-01%2Fisva_10.0.4.0_20221201-140757_ISAM-DMZ-WS1-TEST.support]",,Daniel Comeau,Dermot Daly,Edvan Ponciano,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,614dd52af1c1740068534813,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS009168660,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,TIETOEVRY NORWAY AS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17lef:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-01-15 21:14:59.084,,,,,"12/Jan/23 7:17 PM;627a7fb30d1e73006f7c21cf;We also suggested: 
Customer can try setting the following java environment variables for the LMI first because it appears to be the problem.

-Dcom.sun.jndi.ldap.connect.timeout

-Dcom.sun.jndi.ldap.read.timeout

These are both set in milliseconds.  To set these variables you do this through System > Advanced Tuning Parameters.

The key will be lmi.jvm_option.X where X is just a unique increasing number.   If you don't have any of these already defined, then you can start with 1 and then 2 for the next one.   If you already have some defined then just start with the next one in the list.

So for example if you don't have any already you could set

key: lmi.jvm_option.1

value: -Dcom.sun.jndi.ldap.connect.timeout=10000

key: lmi.jvm_option.2

value: -Dcom.sun.jndi.ldap.read.timeout=10000

You can see if this helps or not.

I don't believe this is necessary, but if this doesn't help we can try setting this for the AAC runtime service too. You can do the exact same thing except the key will be:

runtime_profile.jvm_option.X

instead of

lmi.jvm_option.X



After changes, it made no difference",12/Jan/23 7:17 PM;627a7fb30d1e73006f7c21cf;what tracing we could use in the LMI to see what is happening to try to correlate what is happening in the LMI to network traces.,"16/Jan/23 7:14 AM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}[11/30/22, 15:50:50:781 CET] 000051dc id=00000000                                                              E  javax.naming.NamingException: LDAP connection has been closed; remaining name ''
javax.naming.NamingException: LDAP connection has been closed; remaining name ''
-----
[12/1/22, 14:01:29:994 CET] 00007467 id=00000000                                                              E  javax.naming.NamingException: LDAP connection has been closed; remaining name ''
javax.naming.NamingException: LDAP connection has been closed; remaining name ''
	at java.naming/com.sun.jndi.ldap.LdapRequest.getReplyBer(Unknown Source)
	at java.naming/com.sun.jndi.ldap.Connection.readReply(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapClient.getSearchReply(Unknown Source)
	
	at com.ibm.isam.scim.common.LdapHandler.getLdapValuesRaw(LdapHandler.java:238)
	at com.ibm.isam.scim.common.LdapHandler.getLdapAttributesRaw(LdapHandler.java:165)
	
	at com.ibm.isam.scim.up.UserProfileScimlet.getLdapAttributes(UserProfileScimlet.java:1134)
	at com.ibm.isam.scim.up.UserProfileScimlet.getLdapValues(UserProfileScimlet.java:1242)
	at com.ibm.isam.scim.up.UserProfileScimlet.getLdapAttributes(UserProfileScimlet.java:1159)
	
	at com.ibm.isam.mga.scim.ScimConfiguration.doRestGet(ScimConfiguration.java:867)
	at com.ibm.mesa.servlet.MesaServlet.routeRestRequest(MesaServlet.java:766)
	at com.ibm.mesa.servlet.MesaServlet.routeRequest(MesaServlet.java:663)
	at com.ibm.mesa.servlet.MesaServlet.service(MesaServlet.java:164)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:791){noformat}","16/Jan/23 7:15 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] 

# Is this specific to /mga/scim/configuration or any other LMI pages? 
# Is the LDAP connection remote or runtime ldap? 
# Gather all LDAP connection - config properties
# Enable Browser Dev tools to debug which specific calls are taking long 
# Enable com.ibm.isam.* in LMI trace and recreate the issue - get new support file 
# Is this issue browser specific? have they tried other browsers? ",02/Feb/23 6:19 AM;614dd52af1c1740068534813;The customer has chosen to cancel/pause MMFA project. Hence closing the JIRA. Thx,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"API Protection parameter ""Enable multiple refresh tokens for fault tolerance"" is not working as expected",ISAMSUP-4698,275435,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Gabe,5b15d99b4c20165700edecad,Gabe,5b15d99b4c20165700edecad,11/Jan/23 1:01 AM,24/Feb/23 9:42 AM,14/Jul/23 2:47 PM,24/Feb/23 9:42 AM,,,,0,,,,"The parameter ""Enable multiple refresh tokens for fault tolerance"" states the following: 
[https://www.ibm.com/docs/en/sva/10.0.5?topic=protection-api-token-management-properties|https://www.ibm.com/docs/en/sva/10.0.5?topic=protection-api-token-management-properties|smart-link]
Specifies how refresh tokens are handled. When this option is enabled, and a refresh request is made, the initially-used refresh token remains active (assuming it was initially active), even after a successful refresh request is made and a new token pair (access token and refresh token) is returned. *Only upon the subsequent use of the new access token or new refresh token will the initially presented refresh token be invalidated.* If the initially used refresh token is presented again, the tokens issued on the first refresh request (Pair 1) are revoked, and another token pair (access token and refresh token) is issued. This new pair (Pair 2) is valid, and Pair 1 is invalid.


From testing we have found after issuing a new access/refresh token and after subsequent use only the original access token is invalidated while the original refresh token remains active. Is this broken and a APAR or working as intended and a doc APAR?


Recreate steps with trace from my lab appliance. 

1)Initiate the flow by first requesting a code. This is with ""Enable multiple refresh tokens for fault tolerance"" checked in the API definition. 

[https://172.16.209.129:444/mga/sps/oauth/oauth20/authorize?grant_type=client_credentials&client_id=clientId&client_secret=clientSecret&redirect_uri=https://test.com&response_type=code|https://172.16.209.129:444/mga/sps/oauth/oauth20/authorize?grant_type=client_credentials&client_id=clientId&client_secret=clientSecret&redirect_uri=https://test.com&response_type=code]

Returned code
[https://test.com/?code=JzjhXbtElYUlOllUCoO9Pxg98b0QeP|https://test.com/?code=JzjhXbtElYUlOllUCoO9Pxg98b0QeP]

2) Exchange the above code for a access and refresh token. 

curl -v -k -H ""Content-Type: application/x-www-form-urlencoded;charset=UTF-8"" -d ""grant_type=authorization_code&code=JzjhXbtElYUlOllUCoO9Pxg98b0QeP&client_id=clientId&client_secret=clientSecret&redirect_uri=[https://test.com&response_type=code""|https://test.com&response_type=code%22] [https://172.16.209.129:444/mga/sps/oauth/oauth20/token|https://172.16.209.129:444/mga/sps/oauth/oauth20/token]

Original access and refresh token. 
{""access_token"":""*uAXvndMA8EVcttBaw3Iw*"",""refresh_token"":""*G2sIKQQv1XWJ61YMv2d7vnNCzwJTFqoOPzFrLOt5*"",""scope"":"""",""token_type"":""bearer"",""expires_in"":3599}%

3) Use the original refresh token for a new access and refresh token. 

curl -v -k -H ""Authorization:Basic Y2xpZW50SWQ6Y2xpZW50U2VjcmV0"" -H ""Content-Type: application/x-www-form-urlencoded;charset=UTF-8"" -d ""grant_type=refresh_token&refresh_token=*G2sIKQQv1XWJ61YMv2d7vnNCzwJTFqoOPzFrLOt5*&redirect_uri=[https://test.com""|https://test.com%22] [https://172.16.209.129:444/mga/sps/oauth/oauth20/token|https://172.16.209.129:444/mga/sps/oauth/oauth20/token]

New tokens {""access_token"":""*xnE3VE7VuikFgxPaprGX*"",""refresh_token"":""3Y9rts0jabHykRKNpZhblhx5XoWfyNGqoAeQrkOV"",""scope"":"""",""token_type"":""bearer"",""expires_in"":3599}%

4) Introspect the new access token which should then invalidate the original access and refresh tokens. 

curl -v -k -H ""Authorization:Basic Y2xpZW50SWQ6Y2xpZW50U2VjcmV0"" -H ""Content-Type: application/x-www-form-urlencoded;charset=UTF-8"" -d ""token=*xnE3VE7VuikFgxPaprGX*&token_type_hint=access_token"" [https://172.16.209.129:444/mga/sps/oauth/oauth20/introspect|https://172.16.209.129:444/mga/sps/oauth/oauth20/introspect]

{""scope"":"""",""active"":true,""token_type"":""bearer"",""exp"":1673363845,""iat"":1673360245,""client_id"":""clientId"",""username"":""sec_master""}

5) Now introspect the original access token. This access token is invalid as expected. 

curl -v -k -H ""Authorization:Basic Y2xpZW50SWQ6Y2xpZW50U2VjcmV0"" -H ""Content-Type: application/x-www-form-urlencoded;charset=UTF-8"" -d ""token=uAXvndMA8EVcttBaw3Iw&token_type_hint=access_token"" [https://172.16.209.129:444/mga/sps/oauth/oauth20/introspect|https://172.16.209.129:444/mga/sps/oauth/oauth20/introspect]

{""active"":false}

6) Requesting a new access/refresh token using the original refresh token. This should fail but I am able to request additional tokens using this refresh token. 

curl -v -k -H ""Authorization:Basic Y2xpZW50SWQ6Y2xpZW50U2VjcmV0"" -H ""Content-Type: application/x-www-form-urlencoded;charset=UTF-8"" -d ""grant_type=refresh_token&refresh_token=*G2sIKQQv1XWJ61YMv2d7vnNCzwJTFqoOPzFrLOt5*&redirect_uri=[https://test.com""|https://test.com%22] [https://172.16.209.129:444/mga/sps/oauth/oauth20/token|https://172.16.209.129:444/mga/sps/oauth/oauth20/token]

{""access_token"":""sO94i5kIsZS0IDh5IcG3"",""refresh_token"":""aZV8U2yibn9m6Iucn6mqe3GQP6uFLfkVDjy2O1b1"",""scope"":"""",""token_type"":""bearer"",""expires_in"":3599}

{""access_token"":""1CgEOMWHVIRz8AtbYdvA"",""refresh_token"":""M6GYEcU1s3ZGxSiKJxKxqnMPKNDk31H6xTdLmuJO"",""scope"":"""",""token_type"":""bearer"",""expires_in"":3599

{""access_token"":""Eq63yznmFye4czGy3Kgx"",""refresh_token"":""WbTCyHpk5OwSn6ZPT5cGD2TV3SKPZpFoDDs50hRM"",""scope"":"""",""token_type"":""bearer"",""expires_in"":3599}



In the trace I can see fault tolerance is working but I never see it try to remove the original refresh token. 
Based on the documentation it should keep it only until the new access/refresh token is used. 


[1/10/23, 9:17:25:115 EST] 0000002b id=00000000 auth20.strategy.commands.RemoveOAuthTokenByCacheLookupKeyCmd 3 *execute Keep the previous refresh token for fault tolerance.*",,David Hayes,Gabe,khansen,Motiur Rahman,Nick Lloyd,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,11/Jan/23 1:02 AM;gabrbell;trace_TS011707295_recreate.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/176937,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011707295,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Charles David Hooks,5b15d9936d76184b7d989c82,,,,VOYA SERVICES COMPANY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17jfb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,2023-01-11 05:43:57.129,,,,,"11/Jan/23 1:07 AM;5b15d99b4c20165700edecad;One more thing, if I try to use the new fresh token I am unable to request a new access/refresh token. It appears only the original refresh token is valid. 

{""error_description"":""FBTOAU211E The [authorization_grant] received of type [refresh_token] does not exist."",""error"":""invalid_grant""}","11/Jan/23 3:43 PM;5af4ad7d4dd24c579110120b;

Initial refresh token:

{{tsbTbo4CHCJosFbYpEswNXoDQSjUbzpt8JX0CX23}}

Current and Previous token will be stored in the database if the fault tolerance option is enabled.

curl -k -v -X POST -H ‘Content-type: application/x-www-form-urlencoded’ -d ""client_id=testclient2&client_secret=testclient2password&grant_type=refresh_token&refresh_token=tsbTbo4CHCJosFbYpEswNXoDQSjUbzpt8JX0CX23"" [https://10.160.100.17:444/mga/sps/oauth/oauth20/token|https://10.160.100.17:444/mga/sps/oauth/oauth20/token]

{""access_token"":""IBnLdP7l3pFaE4IRResC"",""refresh_token"":""PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF"",""scope"":"""",""token_type"":""bearer"",""expires_in"":3599}

{noformat} PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF | authorization_grant | refresh_token | 1673415585048 |  1673415585055 |   599105 | PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF | testclient2 | testuser1 |       |              | uuid9f008e88-0185-1102-a4d0-d196324ae028 | Y             | tsbTbo4CHCJosFbYpEswNXoDQSjUbzpt8JX0CX23
 tsbTbo4CHCJosFbYpEswNXoDQSjUbzpt8JX0CX23 | authorization_grant | refresh_token | 1673415322276 |  1673415322287 |   599368 | tsbTbo4CHCJosFbYpEswNXoDQSjUbzpt8JX0CX23 | testclient2 | testuser1 |       |              | uuid9f008e88-0185-1102-a4d0-d196324ae028 | Y             | 
 IBnLdP7l3pFaE4IRResC                     | access_token        | bearer        | 1673415585032 |  1673415585043 |     3600 | IBnLdP7l3pFaE4IRResC                     | testclient2 | testuser1 |       |              | uuid9f008e88-0185-1102-a4d0-d196324ae028 | Y             | tsbTbo4CHCJosFbYpEswNXoDQSjUbzpt8JX0CX23
(3 rows){noformat}

Use the access token:

curl -k --location --request GET '[https://10.160.100.17:444/test.html'|https://10.160.100.17:444/test.html'] 
--header 'Authorization: Bearer IBnLdP7l3pFaE4IRResC' 
--header 'Accept: application/json'

{noformat} PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF | authorization_grant | refresh_token | 1673415585048 |  1673415585055 |   599105 | PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF | testclient2 | testuser1 |       |              | uuid9f008e88-0185-1102-a4d0-d196324ae028 | Y             | 
 IBnLdP7l3pFaE4IRResC                     | access_token        | bearer        | 1673415585032 |  1673415652041 |     3600 | IBnLdP7l3pFaE4IRResC                     | testclient2 | testuser1 |       |              | uuid9f008e88-0185-1102-a4d0-d196324ae028 | Y             | 
(2 rows){noformat}



Use a refresh token flow with {{PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF}}

curl -k -v -X POST -H ‘Content-type: application/x-www-form-urlencoded’ -d ""client_id=testclient2&client_secret=testclient2password&grant_type=refresh_token&refresh_token=PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF"" [https://10.160.100.17:444/mga/sps/oauth/oauth20/token|https://10.160.100.17:444/mga/sps/oauth/oauth20/token]

{""access_token"":""WH2UapI8Vup45hIGoi70"",""refresh_token"":""Gjn8WrEsb7wMolQs5p06MUJn8nNTMBKk4wfiL8Xf"",""scope"":"""",""token_type"":""bearer"",""expires_in"":3599}

{noformat} PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF | authorization_grant | refresh_token | 1673415585048 |  1673415585055 |   599105 | PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF | testclient2 | testuser1 |       |              | uuid9f008e88-0185-1102-a4d0-d196324ae028 | Y             | 
 WH2UapI8Vup45hIGoi70                     | access_token        | bearer        | 1673415757013 |  1673415757034 |     3600 | WH2UapI8Vup45hIGoi70                     | testclient2 | testuser1 |       |              | uuid9f008e88-0185-1102-a4d0-d196324ae028 | Y             | PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF
 Gjn8WrEsb7wMolQs5p06MUJn8nNTMBKk4wfiL8Xf | authorization_grant | refresh_token | 1673415757041 |  1673415757050 |   598933 | Gjn8WrEsb7wMolQs5p06MUJn8nNTMBKk4wfiL8Xf | testclient2 | testuser1 |       |              | uuid9f008e88-0185-1102-a4d0-d196324ae028 | Y             | PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF{noformat}

New set available till the access token is used.

Does this help? 



On the invalid_grant - message - check the tokens available for that client at the time when you requested the refresh. 

I can use {{PSeJwoAXETiklRExCMDYTDNvJdYEo9hb1ooT6KEF}} or {{Gjn8WrEsb7wMolQs5p06MUJn8nNTMBKk4wfiL8Xf}} in my next refresh token flow to get a new token.","26/Jan/23 1:09 AM;5b15d99b4c20165700edecad;The customer is assuming an introspect of the access token would trigger the invalidation of the previous refresh token but that doesn’t seem to be the case. To be fair our wording in the documentation is vague and only implies “use” of the token. 

”Only upon the subsequent use of the new access token or new refresh token will the initially presented refresh token be invalidated.”

Like you found, if I pass the bearer token for authorization the previous refresh token is invalidated as expected. 

Based on the Introspection RFC the token being queried isn’t used for authorization to the endpoint so I think we can say it isn’t “used” per say but queried. 

Would you say this is an accurate statement that we can provide to the customer?
Introspecting a token is not the same as using the token so an invalidation should not occur. 



","26/Jan/23 2:13 PM;5af4ad7d4dd24c579110120b;Yes  I agree with this statement-

{{Introspecting a token is not the same as using the token so an invalidation should not occur.}}","24/Feb/23 9:42 AM;5af4ad7d4dd24c579110120b;Closing this as answered, if you have any questions please feel free to reopen.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Skipping disabled accounts in AD,ISAMSUP-4696,275224,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,10/Jan/23 3:56 AM,20/Jan/23 12:04 PM,14/Jul/23 2:47 PM,20/Jan/23 12:04 PM,,Support,,0,,,,"Customer US SOCIAL SECURITY ADMINISTRATION has a requirement where they need to fetch active accounts from AD and discard disabled accounts for the same user.  

Same user has 

* [userpin@ba.ad.ssa.gov|mailto:userpin@ba.ad.ssa.gov]
* [userpin@ny.ad.ssa.gov|mailto:userpin@ny.ad.ssa.gov] 

And one of the accounts is disabled. When they do the search, they are getting both accounts. That is causing the issue because only the active account has the required groups/roles.

*L2 suggested:* 

This sounds like you need to clean up your LDAP instead of trying to solve it with ISVA. In this article [How to Find Disabled Active Directory User Accounts (activedirectorypro.com)|https://activedirectorypro.com/find-disabled-active-directory-user-accounts/] example 3 may be relevant, but likely a question for Microsoft, not for IBM.

*Customer responded:* 

Deleting disabled accounts is purely an Agency policy. 

Active directory is using the *_userAccountControl_* attribute, where one of the bits indicates that user's account is disabled.

In order to filter out such disabled accounts from the search results, they need to employ LDAP_MATCHING_RULE_BIT_AND operation (aka 1.2.840.113556.1.4.803).

So, the question is: what support ISVA has for bitwise operations in the queries, and how they can use them?

I think the question is whether our APIs can send those specific operational attributes, but I don't know the answer? 

The screenshot is their search filter.

!image-20230109-175609.png|width=951,height=828!",,Brandon Garay,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,,,,60e721f12d49fd00698bb49d,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,10/Jan/23 3:56 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230109-175609.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/176794,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011703290,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,US SOCIAL SECURITY ADMINISTRATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"Citrix: S:\sf\TS011\703\TS011703290\2023-01-03\Capture_AD-disabled_account.PNG

Windows: S:\ecurep\sf\TS011\703\TS011703290\2023-01-03\Capture_AD-disabled_account.PNG",,,,,,,,,,,,,,,,,,,,,,,0|i17i5b:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-01-12 23:48:14.503,,,,,"13/Jan/23 9:48 AM;5af4ad7d4dd24c579110120b;<Notes>

AD :	172.20.0.87 
","17/Jan/23 11:39 AM;5af4ad7d4dd24c579110120b;<Notes>

From case it looks like customer has used a search filter that has worked to find the active users only from AD:

{noformat}(&(objectCategory=Person)(sAMAccountName={AZN_CRED_PRINCIPAL_NAME})(!(userAccountControl:1.2.840.113556.1.4.803:=2))).{noformat}",20/Jan/23 12:04 PM;5af4ad7d4dd24c579110120b;case closed hence closing jira.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
API Clients created with the same name are overwritten when using an Oracle Config DB,ISAMSUP-4691,274896,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Gabe,5b15d99b4c20165700edecad,Gabe,5b15d99b4c20165700edecad,06/Jan/23 11:33 PM,11/May/23 8:40 PM,14/Jul/23 2:47 PM,11/May/23 8:40 PM,,,,0,,,,"ISVA 10.0.3.1

The scenario is AT&T is creating new API Clients via Rest calls and their practice is to use the same names but different clientIDs. This worked as expected with ISAM 9.0.7 but in ISVA 10.0.3.1 they noticed clients were being overwritten by the previous entry instead of a new entry being created. 

For example create the following API. 
name: myATT Mobile App-IOS
clientID: m21255

Next create 
name: myATT Mobile App-IOS
clientID: m21257

Afterward only clientID: m21257 will exist. 


I’ve attempted to recreate this on my appliance with an internal Postgres DB and noticed entries for each of the above above clients were created instead of one. I captured a LMI trace during this process and noticed for Postgres we use an INSERT statement. 

 *INSERT INTO OAUTH_CLIENT_INSTANCE* (INSTANCE_ID,INSTANCE_NAME,DEFINITION_ID,CLIENT_ID,CLIENT_SECRET,REDIRECT_URI,COMPANY_NAME,COMPANY_URL,CONTACT_PERSON,EMAIL_ADDRESS,PHONE_NUMBER,CONTACT_TYPE,OTHER_INFO,REQUIRE_PKCE,JWKS_URI,JWT_ENC_DB,JWT_ENC_CERT,DYN_DATA,INTROSPECT_SECRET)

From the trace of AT&Ts client creation we see it’s an UPDATE instead of a INSERT. 

[1/5/23, 18:16:28:134 GMT] 00000029 id=00000000 om.ibm.security.access.managed.resources.pending.DBStatement > DBStatement ENTRY 

*UPDATE OAUTH_CLIENT_INSTANCE* SET INSTANCE_NAME = ?, CLIENT_ID = ?, CLIENT_SECRET = ?, REDIRECT_URI = ?, COMPANY_NAME = ?, COMPANY_URL = ?, CONTACT_PERSON = ?, EMAIL_ADDRESS = ?, PHONE_NUMBER = ?, CONTACT_TYPE = ?, OTHER_INFO = ?,REQUIRE_PKCE = ?, JWKS_URI = ?, JWT_ENC_DB = ?, JWT_ENC_CERT= ?, DYN_DATA = ?, INTROSPECT_SECRET = ? WHERE INSTANCE_ID = ? [Ljava.lang.Object;@f66c985d false


From what I can tell we don’t care if the names are duplicate so the SQL for an Oracle Db should be an INSERT instead of the UPDATE right?

Customers LMI trace
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011722597&path=TS011722597%2F2023-01-05%2F&filepath=TS011722597%2F2023-01-05%2Ftrace.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011722597&path=TS011722597%2F2023-01-05%2F&filepath=TS011722597%2F2023-01-05%2Ftrace.log]",,David Hayes,khansen,Motiur Rahman,Nick Lloyd,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011722597,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Gabe,5b15d99b4c20165700edecad,,,,AT&T Services,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17g4n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-01-11 08:12:09.115,,,,,"11/Jan/23 6:12 PM;5b15d954b0d76456f36daf33;The calls to insert and update are distinct. Which means for whatever reason, the Oracle one is asking for an update of the client rather than insert.

Going to check if this was deliberate or an oversight.","01/Feb/23 2:12 PM;5b15d954b0d76456f36daf33;@Gabe can you get hold of the full RAPI command they are using? I tried this in a local 10.0.3.1 + Oracle config db. 

I see the expected behaviour of new clients being created.",20/Feb/23 9:04 AM;5b15d954b0d76456f36daf33;[~accountid:5b15d99b4c20165700edecad] any update here?,07/Mar/23 3:38 PM;5b15d954b0d76456f36daf33;[~accountid:5b15d99b4c20165700edecad] there is no update in the case since Jan 6 and here since the Jira was created. What do you want to do with this?,07/Mar/23 11:17 PM;5b15d99b4c20165700edecad;I’ll request the RAPI AT&T is using. If this isn’t something we can recreate I might also see if we can get some tracing from Oracle to see the queries. ,"29/Mar/23 10:27 PM;5b15d99b4c20165700edecad;AT&T is using Ansible scripts to update these APIs. First they check if the API already exists. If so they update it otherwise they create a new one. 


They provided the ansible below but basically it should be 


GET [https://{appliance_hostname}/iam/access/v8/clients/|https://%7Bappliance_hostname%7D/iam/access/v8/clients/] 
then
POST [https://{appliance_hostname}/iam/access/v8/clients/|https://%7Bappliance_hostname%7D/iam/access/v8/clients/] 
or
PUT [https://{appliance_hostname}/iam/access/v8/clients/2|https://%7Bappliance_hostname%7D/iam/access/v8/clients/2]


Creating or Modifying an API Protection Definition

if (search(isamAppliance, name=name))['data'] == {}:# Force the add - we already know policy does not exist [logger.info|https://logger.info/](""Definition {0} had no match, requesting to add new one."".format(name)) return add(isamAppliance, name, definitionName, companyName, redirectUri=redirectUri, companyUrl=companyUrl,contactPerson=contactPerson, contactType=contactType, email=email, phone=phone, otherInfo=otherInfo,clientId=clientId, clientSecret=clientSecret, requirePkce=requirePkce, encryptionDb=encryptionDb,encryptionCert=encryptionCert, jwksUri=jwksUri, extProperties=extProperties,check_mode=check_mode, force=True)

else:

# Update request

[logger.info|https://logger.info/](""Definition {0} exists, requesting to update."".format(name))

return update(isamAppliance, name, definitionName, companyName, redirectUri=redirectUri, companyUrl=companyUrl,contactPerson=contactPerson, contactType=contactType, email=email, phone=phone,otherInfo=otherInfo, clientId=clientId, clientSecret=clientSecret, new_name=new_name,requirePkce=requirePkce, encryptionDb=encryptionDb, encryptionCert=encryptionCert,jwksUri=jwksUri, extProperties=extProperties, check_mode=check_mode, force=force)","03/Apr/23 4:58 PM;5b15d954b0d76456f36daf33;[~accountid:5b15d99b4c20165700edecad] like I said I can’t locally recreate this problem. 

Have you tried to use those native RAPI calls underneath the ansible scripts?","13/Apr/23 12:46 AM;5b15d99b4c20165700edecad;I don’t have an Oracle database but I do have DB2 and I could not recreate his either. As long as both API clients are created with POSTs it worked as expected. But if I used a PUT to update the API it was overwritten as expected. 

From the code can you tell if the POST (Create API) should be a INSERT and the PUT (Update API) should be a UPDATE? This could just be a case where we fixed this behavior and its now working as expected. ","13/Apr/23 10:32 AM;5b15d954b0d76456f36daf33;That makes sense because to create a new resource you use POST, but to update an existing resource you use PUT. That sounds like it is working as expected.","17/Apr/23 1:40 PM;5b15d954b0d76456f36daf33;[~accountid:5b15d99b4c20165700edecad] the POST and PUT calls are set to “create” and “update” respectively as expected.

Their trace log indicates, they are only potentially doing a PUT:

{noformat}[1/5/23, 18:16:19:433 GMT] 00000029 id=00000000 com.ibm.security.access.management.rest.Clients              > update(JSONObject, String) ENTRY{noformat}",11/May/23 8:40 PM;5b15d954b0d76456f36daf33;Case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Specifically crafted HTTP request crashes webseald process,ISAMSUP-4688,274734,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,06/Jan/23 1:52 AM,23/Feb/23 7:54 AM,14/Jul/23 2:47 PM,23/Feb/23 7:54 AM,10.0.6,Support,05/Jan/23 12:00 AM,0,,,,"Hello Team, Client mentioned that when they specifically crafted HTTP request crashes webseald process. Issue can be re-created consistently in our environment with many different webseal instances.

Please handle the case with urgency as this problem leaves our system vulnerable for 'denial of service' attacks. Webseal message log shows the following events related to the issue: 

Webseal Instance - www00xkubhty

2023-01-05-12:40:41.417+02:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 654 0x7fe90980f700 -- WGAWA0034E The process, /opt/pdweb/bin/webseald, was terminated by the signal, 7. The process will be automatically restarted. -- IBM Security Verify Access WebSEAL Version 10.0.1.0 (Build 20201125_1048) -- Copyright (C) IBM Corporation 1994-2020. All Rights Reserved.

2023-01-05-12:40:53.419+02:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 654 0x7fe90980f700 -- WGAWA0034E The process, /opt/pdweb/bin/webseald, was terminated by the signal, 11. The process will be automatically restarted. -- IBM Security Verify Access WebSEAL Version 10.0.1.0 (Build 20201125_1048) -- Copyright (C) IBM Corporation 1994-2020. All Rights Reserved.


2023-01-05-12:40:51.539+02:00I----- 0x38B9A41E webseald ERROR wns session WSRemoteCacheKey.cpp 256 0x7fe1d7cf3700 -- DPWNS1054E Invalid session ID. 2023-01-05-12:40:51.539+02:00I----- 0x38CF0462 webseald WARNING wwa http authn-getsess.cpp 325 0x7fe1d7cf3700 -- DPWWA1122W Corrupted session cookie: PD-H-SESSION-ID.

Following are the re-create queries with Burp tool and curl: 

Burp -> GET /?websealtest HTTP/1.1 Host: [www002.kube.hty.op-palvelut.net|https://www002.kube.hty.op-palvelut.net] Cookie: PD-H-SESSION-ID=5___ Connection: close 

curl loop --> for ((i=1;i<=3;i++)); do curl --header ""Cookie:PD-H-SESSION-ID=10___"" -I [https://www002.kube.hty.op-palvelut.net|https://www002.kube.hty.op-palvelut.net]; done

So far we have identified that the problem occurs when webseal is configured to use DSC.
They have also re-created the issue on ISVA 10.0.4 version.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011725509&path=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011725509&path=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2F]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011725509&path=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2Fvar%2Fpdweb%2Fwww00xkubhty%2Ftrace%2F&filepath=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2Fvar%2Fpdweb%2Fwww00xkubhty%2Ftrace%2Fpdweb.snoop.log.0.out|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011725509&path=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2Fvar%2Fpdweb%2Fwww00xkubhty%2Ftrace%2F&filepath=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2Fvar%2Fpdweb%2Fwww00xkubhty%2Ftrace%2Fpdweb.snoop.log.0.out]",,Alan Wong,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,,,,,,,,,,6092aca0f0db130069d19687,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4699,,,,,,,,,,,,,,,,,IJ44876,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011725509,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,OP-PALVELUT OY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-01-11T09:53:35.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS011725509&path=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2Fvar%2Fpdweb%2Fwww00xkubhty%2Ftrace%2F&filepath=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2Fvar%2Fpdweb%2Fwww00xkubhty%2Ftrace%2Fpdweb.snoop.log.0.out

https://ecurep.mainz.de.ibm.com/ae5/#id=TS011725509&path=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2Fvar%2Fpdweb%2Fwww00xkubhty%2Ftrace%2F&filepath=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2Fvar%2Fpdweb%2Fwww00xkubhty%2Ftrace%2Fpdweb.debug.log

https://ecurep.mainz.de.ibm.com/ae5/#id=TS011725509&path=TS011725509%2F2023-01-05%2Fisva_10.0.1.0_20230105-124705_5OGBLTIAMAP01.support_unpack%2F",,,,,,,,,AIX,Linux 86_64,,,,,,,,,,,,,0|i17fav:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,ISVA 10.0.4.0,,,,,,,,,,,,2023-01-05 21:49:54.243,,,,,"06/Jan/23 7:49 AM;5b15d94b6256d01ad54eb020;Took a look at this one today.  

The signal  7 crash is occurring in

AMWSMSReplicaSetClient::validateSessionID

The signal 11 crash  is occurring in

AMWSMSSessionID::validate

Nothing obvious to me in either routine as to what caused it.  We are still  investigating.","06/Jan/23 11:21 PM;60f541a6d0134900692d91b7;Hey [~accountid:5b15d94b6256d01ad54eb020] the client confirmed that in their personal sandbox environment. He created a new webseal instance and modified the following settings in the webseal config:

[session]
dsess-enabled = yes

[replica-sets]
replica-set = default

[dsess]
dsess-cluster-name = dsess

[dsess-cluster]
server = 9,[http://127.0.0.1:2035/DSess/services/DSess|http://127.0.0.1:2035/DSess/services/DSess]

Also previously I had to create a new certificate in to pdsrv certificate keystore for webseal as the default certificate ( WebSEAL-Test-Only ) had been expired. So, on the new webseal instance configuration I set the webseal-cert-keyfile-label to point to valid certificate:

webseal-cert-keyfile-label = WebSEAL-Test-Only-New

Then after deploying changes and restarting the webseal instance I could re-create the crash with:

for ((i=1;i<=3;i++)); do curl -k --header ""Cookie:PD-S-SESSION-ID=3___"" -I [https://192.168.11.220:447/|https://192.168.11.220:447/]; done","07/Jan/23 1:13 AM;5b15d94b6256d01ad54eb020;[~accountid:60f541a6d0134900692d91b7] Did it require multiple curl requests as your script indicated or did it also crash on a single curl call?

Update:  I tried this on 10.0.4.0  and my webseald did not crash so there must be more going on.   

Please recreate again but with webseal tracing enabled and then send in a new support file.  Thanks","07/Jan/23 3:07 AM;5b15d94b6256d01ad54eb020;  There were significant  improvements made from 10.0.1.0 to 10.0.4.0  with regards to header validation.   Please have the customer retest  and verify that the problem still occurs at 10.0.4.0. 

Also send in a support file from 10.0.4.0  so we can compare.","09/Jan/23 9:22 AM;5b15d9517dab4c51f61b5190;I have recreated the crash

Please open an APAR “Reverse Proxy Session Cookie issue when using DSC”",09/Jan/23 7:20 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9517dab4c51f61b5190] I have created an APAR IJ44876 with the title name you mentioned thank you,"10/Jan/23 3:41 PM;5b15d9517dab4c51f61b5190;[~accountid:60f541a6d0134900692d91b7] 

For which version(s) does the customer need a fixpack.

Just 10.0.4.0 or 10.0.1.0 as well?","10/Jan/23 4:36 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c7e140fdc975fa51847cb9343f1eed0524890ae7
   * description: ISAMSUP-4688 IJ44876 Reverse Proxy Session Cookie issue when using DSC

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82471338.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4688) which we publish.","10/Jan/23 7:25 PM;60f541a6d0134900692d91b7;Hi, [~accountid:5b15d9517dab4c51f61b5190]  they request a fix to ISVA v10.0.1 and could you please tell me how long it will take?","11/Jan/23 1:42 AM;5b15d9e44c4ed14b83af8723;This APAR needs to be hidden from public view until the fix is available. This is a legitimate vulnerability. Here is the publicly available technote: [https://www.ibm.com/support/pages/apar/IJ44876|https://www.ibm.com/support/pages/apar/IJ44876]

L2 used to have a “Security” check box when opening APARs that dealt with vulnerabilities. I don’t see that check box is available to us anymore.

 [~accountid:5b15d9e581c3df12acf53c4a] Can you edit the APAR to make it private?

[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5b15d9e6dda5f94d06b985b4] FYI","11/Jan/23 9:53 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a77f096714c75940d9b63b72101a7bc4593a756d
   * description: ISAMSUP-4688 IJ44876 Reverse Proxy Session Cookie issue when using DSC (#5646)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82540865.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230110235037-a77f09671.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","11/Jan/23 11:04 AM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9e44c4ed14b83af8723] 

Code change has been done and I am currently building fixpacks.

[~accountid:5b15d954b0d76456f36daf33] updated the APAR to make it IBM Confidential - assume  website will get updated

hope to have 10.0.1.0 and 10.0.4.0 fixpacks today.

Then 10.0.5.0 (which will be first fixpack built for 10.0.5.0 - may take a little longer)","11/Jan/23 11:09 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a77f096714c75940d9b63b72101a7bc4593a756d
   * description: ISAMSUP-4688 IJ44876 Reverse Proxy Session Cookie issue when using DSC (#5646)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82543964.


This build has not been published as the commit is not currently within a branch (20230110235037-a77f09671) which we publish.","11/Jan/23 2:00 PM;5b15d9517dab4c51f61b5190;[~accountid:60f541a6d0134900692d91b7] 

The 10.0.1.0 fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4699|https://cloudidentity.atlassian.net/browse/ISAMSUP-4699|smart-link] ",13/Jan/23 3:41 PM;5b15d9517dab4c51f61b5190;The 10.0.5.0 fixpack is now attached ot [https://cloudidentity.atlassian.net/browse/ISAMSUP-4699|https://cloudidentity.atlassian.net/browse/ISAMSUP-4699|smart-link] ,30/Jan/23 9:54 PM;60f541a6d0134900692d91b7;Hello [~accountid:5b15d9517dab4c51f61b5190] Customer is asking Is there or is there going to be CVE created for this vulnerability?,"02/Feb/23 7:55 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9517dab4c51f61b5190] any update on this, the customer said,

“Could you share us a fix which would clean up the webseal core and crashmap files from appliance? I suppose there is no such command in ISVA 10.0.1 which would remove core/crashmap files”","02/Feb/23 9:20 PM;5b15d9517dab4c51f61b5190;If you create a support file - the core files are added to the support file then deleted.

So you could create and delete a support file to remove the cores.

Not sure whether same thing happens with crashmaps.

Will verify - if not handled by support file creation - I will build a fixpack to clean them up

We are working on creating a PSIRT Advisory",02/Feb/23 10:19 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9517dab4c51f61b5190] Thanks for the update i will let the client know about it,06/Feb/23 2:52 PM;5b15d9517dab4c51f61b5190;I checked on 10.0.5.0 and confirmed that creating a support file deletes the crashmap files,08/Feb/23 10:27 AM;5b15d9517dab4c51f61b5190;PSIRT Advisory ADV0077029 has been created and sent to X-Force for scoring.,09/Feb/23 8:49 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9517dab4c51f61b5190] thanks for the update I will let the customer know this and will keep you updated,15/Feb/23 2:24 AM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9517dab4c51f61b5190] the customer was asking if there is a CVE id for the ADV0077029?,21/Feb/23 8:33 PM;5b232b2fd85e5b59b066f57f;@phorner - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,21/Feb/23 8:51 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d8fd6e93913e31e279fb] Can you answer the CVE question?,21/Feb/23 9:16 PM;5b15d9517dab4c51f61b5190;Since we have given a fix - dropping severity,22/Feb/23 2:05 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b15d9517dab4c51f61b5190] [~accountid:60f541a6d0134900692d91b7] Yes a CVE has been assigned to this issue but due to PSIRT Legal rules it can only disclosed in a Security Bulletin when the fix has been included in a release and that release is available.,22/Feb/23 10:53 PM;60f541a6d0134900692d91b7;Hi[~accountid:5b15d9517dab4c51f61b5190] [~accountid:5b15d8fd6e93913e31e279fb] Thank you for the support the client agreed to close the case,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISAM 9 to ISVA 10.0.5 upgrade issue,ISAMSUP-4687,274708,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,05/Jan/23 10:50 PM,27/Jan/23 12:19 AM,14/Jul/23 2:47 PM,27/Jan/23 12:19 AM,,Support,06/Jan/23 12:00 AM,0,,,,"Customer (AirBus) trying to upgrade ISAM federation from 9.0.6.0 version to 10.0.5.0.
After firmware upgrade, customer does not see Federation configurations.
i.e. from #verify-access Slack channel, related [thread|https://ibm-security.slack.com/archives/C307GJRN1/p1671646052071919].
Customer has a few OIDC definitions (federation module; RP):

* upgrading from 9.0.6.0 -> 9.0.7.2 IF4; everything looks ok
* added snapshot & signing fixpacks
* upgrading from 9.0.7.2 IF4 -> 10.0.5.0; no federation definition shows (0 count)
* no obvious errors in config database log
* no obvious errors in federation module logs

L2 ran a utility to extract configuration data (config.dat) to XML.

The fed.xml outputs are located + as follows i.e.
[Pre upgrade 9.0.7.2 ( 433 lines )|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011630423&path=TS011630423%2F2023-01-05%2Fisam_9.0.7.2_20230104-230105_S0I1I1MUTISA001.i1.asphsc.admin.support_unpack%2Fpostgresql%2F]
[Post upgrade 10.0.5 ( 285 lines )|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011630423&path=TS011630423%2F2023-01-03%2Fisva_10.0.5.0_20230103-205213_S0I1I1MUTISA001.i1.asphsc.admin.support_unpack%2Fpostgresql%2F]",,Dermot Daly,gvacek,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5c87cb8d88f9ec6ae0afb306,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011630423,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,AIRBUS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS011630423&path=TS011630423%2F0-all_data%2F,,,,,,,,,Linux 86_64,,,,,,,,,,,,,,0|i17f53:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.2,ISVA 10.0.5.0,,,,,,,,,,,,2023-01-11 00:29:22.927,,,,,"10/Jan/23 7:20 PM;6154906364ff01007106e189;Hi [~accountid:5b15d954b0d76456f36daf33]just asking any findings/progress on your side, as customer is seeking an update in [TS011630423|https://w3.ibm.com/tools/caseviewer/case/TS011630423].","11/Jan/23 10:29 AM;5b15d954b0d76456f36daf33;[~accountid:6154906364ff01007106e189] I had a look at the data that was in both support files.

Like that slack thread mentioned, legacy OIDC based federations might have been removed automatically on upgrade.

But looking at their config.dat at 10.0.5.0 for the appliance {{S0I1I1MUTISA001.i1.asphsc.admin}}

{noformat}--
-- Data for Name: db_schema_updates
--

      dsu_install_date      | dsu_version | dsu_file 
----------------------------+-------------+----------
 2022-12-22 12:54:52.624265 |   202211299 | Install
(1 row){noformat}

That indicates this ia a fresh 10.0.5.0 install rather than an upgrade. In which case it makes sense that there are no new federations.

If you look at the same file at 9.0.7.2, it will show subsequent upgrades like this:

{noformat}--
-- Data for Name: db_schema_updates
--

      dsu_install_date      | dsu_version |                                            dsu_file                                            
----------------------------+-------------+------------------------------------------------------------------------------------------------
 2016-09-05 13:41:40.140495 |   201604189 | Install
 2019-03-14 07:49:09.312636 |   201605130 | /opt/ibm/FIM/upgrade/database/postgresql/config/cluster_config_postgresql_update_201605130.sql
 ......
 2022-12-21 09:30:08.464571 |           1 | /opt/ibm/rba/upgrade/database/postgresql/config/cluster_config_postgresql_update_000000001.sql
 2022-12-21 09:30:08.532705 |           2 | /opt/ibm/rba/upgrade/database/postgresql/config/cluster_config_postgresql_update_000000002.sql
 2022-12-21 09:30:08.551497 |           3 | /opt/ibm/rba/upgrade/database/postgresql/config/cluster_config_postgresql_update_000000003.sql
(108 rows){noformat}

Can you get them to confirm?

I upgraded a local appliance from 9.0.6.0 to 10.0.5.0 and it worked as expected and my federations showed up in tact.","12/Jan/23 7:07 PM;6154906364ff01007106e189;[~accountid:5b15d954b0d76456f36daf33] Customer yet to confirm that it is an appliance upgrade, but I would be 99.99% sure that it is an appliance upgrade. As per recent 9.0.7.02 rollback → [update.history.yaml|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011630423&path=TS011630423%2F2023-01-09%2Fisam_9.0.7.2_20230109-141120_S0I1I1MUTISA001.i1.asphsc.admin.support_unpack%2Fetc%2Flum%2F&filepath=TS011630423%2F2023-01-09%2Fisam_9.0.7.2_20230109-141120_S0I1I1MUTISA001.i1.asphsc.admin.support_unpack%2Fetc%2Flum%2Fupdate-history.yaml]

{{  name: Firmware	  version: !str 9.0.7.2	  event_type: Install	  date: 2022-12-21 09:28:43	  success: 1	  log_file: 	  readme:}}
{{  name: Firmware	  version: !str 9.0.6.0	  event_type: Install	  date: 2019-03-14 08:44:43	  success: 1	  log_file: 	  readme:}}
{{  name: Firmware	  version: !str 9.0.1.0	  event_type: Install	  date: 2016-08-12 12:18:59	  success: 1	  log_file: 	  readme:   }}
{{  name: Firmware	  version: !str 9.0.0.0	  event_type: Install	  date: 2016-08-02 07:32:02	  success: 1	  log_file: 	  readme: }}

Received an escalation task on TS011630423 this morning from Expert Labs i.e. 
”_We received an email from Customer asking us for more focus on this case. Could you please put more focus on this case. The upgrade project is blocked and during that time the customer is in an unsupported version. From customer point of view, more than 5 days they have provided the support file without a real answer from L3. Thanks. Submitted by:_ [_laurent.lapiquionne@fr.ibm.com_|mailto:laurent.lapiquionne@fr.ibm.com] _“_","12/Jan/23 11:45 PM;6154906364ff01007106e189;Customer has confirmed in TS011630423 that it is an upgrade.
I also attempted a basic base build out and upgrade path similar to the customers.
Unlike customer, in my local test scenario, the config.dat populates successfully all the way up from ISAM 9 to ISVA 10.
Earliest ISVA 9 ISO file I could see on FixCentral is 9.0.0.1.
So I built out ISAM 9.0.0.1 	= no \postgresql\config.dat file present.
Upgraded to ISAM 9.0.1.0	= config.dat	13 rows present
Upgraded to ISAM 9.0.6.0	= config.dat	91 rows present
Upgraded to ISAM 9.0.7.2	= config.dat	120 rows present
Upgraded to ISVA 10.0.5.0 	= config.dat	179 rows present","13/Jan/23 1:23 PM;5b15d954b0d76456f36daf33;According to their 9.0.7.2 support file, the only federation I see missing is {{ISAMRP}}. This is defined as a {{Legacy OpenID Connect}} type federation. On upgrade, this will be automatically removed. I saw the same in my local upgrade. You should be able to do this too in your local environment.

You can refer to this document for further details about the deprecation of that protocol: [https://www.ibm.com/docs/en/sva/10.0.0?topic=overview-whats-new-in-this-release|https://www.ibm.com/docs/en/sva/10.0.0?topic=overview-whats-new-in-this-release|smart-link] 

Do they have a screenshot of their federations page at 9.0.7.2? And altogether how many are missing? 

We only need this information from the cluster primary master. All other nodes will get a copy of whatever is on the primary.","14/Jan/23 12:33 AM;6154906364ff01007106e189;Thanks [~accountid:5b15d954b0d76456f36daf33] appears your observations are correct wrt “the only federation I see missing is {{ISAMRP}}. “ Customer provided screen grabs [here|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011630423&path=TS011630423%2F2023-01-13%2F] confirm this. Have updated [TS011630423|https://w3.ibm.com/tools/caseviewer/case/TS011630423] regarding this to which customer has replied 

_“ We have asked and suspected from the beginning and there is no way we checked whether it is legacy ISAMRP or not. “_

😕 ","14/Jan/23 1:25 AM;6154906364ff01007106e189;To update, customer will try to reconfigure the federations in 10.0.5.0 environment. So guess I was going down a wrong rabbit hole, thank you [~accountid:5b15d954b0d76456f36daf33] for correct steer on this. I will hold this Jira work item for now, until customer closes [TS011630423|https://w3.ibm.com/tools/caseviewer/case/TS011630423] 🤞. ","27/Jan/23 12:19 AM;6154906364ff01007106e189;TS011630423 now closed, so good to close this Jira work item.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Problem importing certificate,ISAMSUP-4685,274642,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,05/Jan/23 6:53 AM,06/Jan/23 2:42 AM,14/Jul/23 2:47 PM,06/Jan/23 2:42 AM,,Support,,0,,,,"Cust is running 10.0.4 docker container.    They are trying to import a certificate from a p12 file which worked fine at 10.0.3, but report getting an error on the screen when they do…



{noformat}The specified certificate file could not be imported. The file itself may be invalid or of the incorrect format, or the specified password may be incorrect : Error outputting keys and certificates
140168042116928:error:0607B0C8:digital envelope routines:EVP_CipherInit_ex:disabled for FIPS:crypto/evp/evp_enc.c:227:
140168042116928:error:06074078:digital envelope routines:EVP_PBE_CipherInit:keygen failure:crypto/evp/evp_pbe.c:131:
140168042116928:error:23077073:PKCS12 routines:PKCS12_pbe_crypt:pkcs12 algor cipherinit error:crypto/pkcs12/p12_decr.c:41:
140168042116928:error:2306A075:PKCS12 routines:PKCS12_item_decrypt_d2i:pkcs12 pbe crypt error:crypto/pkcs12/p12_decr.c:94:{noformat}


Their config shows

FIPS Mode: On
nist.sp800-131a.strict = true



The certificate in question (well the public portion at least) is

{noformat}Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1649254916 (0x624da204)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: C = US, O = U.S. Government, OU = Department of Homeland Security, OU = Certification Authorities, OU = DHS CA4
        Validity
            Not Before: Dec 28 15:12:53 2022 GMT
            Not After : Jan 28 15:42:53 2024 GMT
        Subject: C = US, O = U.S. Government, OU = Department of Homeland Security, OU = TSA, OU = Devices, CN = ajsfdvotscn11
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    00:8d:62:17:fd:ec:40:7f:ce:9b:cc:96:b2:c7:5b:
                    e7:0d:23:8e:b2:b7:4e:45:71:d9:11:e2:c3:f8:03:
                    2d:47:e6:f2:6d:c7:29:17:83:6f:a1:6a:21:4a:18:
                    59:57:ec:5a:37:e4:96:5a:88:8e:5c:d3:63:98:61:
                    8a:93:b3:3a:82:7c:70:6b:65:fe:78:66:94:43:13:
                    a6:16:1f:31:ab:8d:c0:ad:b9:16:16:27:ca:1e:0c:
                    7a:57:cb:21:a5:6d:9c:8e:0c:06:b9:2b:96:98:ad:
                    17:b1:87:00:74:3f:96:58:aa:9e:76:64:43:f7:cd:
                    02:41:2a:a0:c7:f7:cd:3f:d6:d3:d1:96:e2:46:25:
                    8c:52:b4:48:93:aa:b6:3d:e9:54:81:99:23:f0:c0:
                    eb:7d:d8:e1:99:4a:f1:91:1a:db:c2:52:0f:a5:31:
                    65:a7:85:df:04:52:b8:c6:74:4a:50:ca:e7:aa:fe:
                    df:a4:9a:ea:84:a1:a7:78:1a:36:e8:cd:4c:c2:a8:
                    2b:93:ed:7d:b6:d0:6c:7f:21:48:80:db:78:ce:4d:
                    97:e4:a4:8a:2f:93:5b:51:08:cd:a4:82:bb:48:ea:
                    de:6f:1e:c8:d6:94:18:a9:34:29:d8:ee:2c:7b:69:
                    98:e2:db:29:65:a8:4e:d8:cb:69:73:92:c5:9d:51:
                    9c:75
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Certificate Policies:
                Policy: 2.16.840.1.101.3.2.1.3.8

            Authority Information Access:
                CA Issuers - URI:http://pki.dimc.dhs.gov/dhsca_ee_aia.p7c
                CA Issuers - URI:ldap://ldap01.dimc.dhs.gov/ou=DHS%20CA4,ou=Certification%20Authorities,ou=Department%20of%20Homeland%20Security,o=U.S.%20Government,c=US?cACertificate;binary
                OCSP - URI:http://ocsp.dimc.dhs.gov

            X509v3 Extended Key Usage:
                TLS Web Server Authentication
            X509v3 Subject Alternative Name:
                DNS:ajsfdvotscn11, DNS:ajsfdvotscn11.dvot.tsa.dhs.gov, DNS:dtrui.dvot.tsa.dhs.gov, DNS:dvotools.dvot.tsa.dhs.gov, iac-cm.dvot.tsa.dhs.gov, DNS:iam.dvot.tsa.dhs.gov, DNS:scheduler.dvot.tsa.dhs.gov, DNS:scs.dvot.tsa.dhs.gov, DNS:ucpstui.dvot.tsa.dhs.gov, DNS:ucpui.dvot.tsa.dhs.gov, DNS:infra-prov.dvot.tsa.dhs.gov, DNS:repoui.dvot.tsa.dhs.gov
            X509v3 CRL Distribution Points:

                Full Name:
                  URI:http://pki.dimc.dhs.gov/DHS_CA3.crl

                Full Name:
                  DirName:C = US, O = U.S. Government, OU = Department of Homeland Security, OU = Certification Authorities, OU = DHS CA4, CN = CRL12308
                  URI:ldap://ldap01.dimc.dhs.gov/cn=CRL12308,ou=DHS%20CA4,ou=Certification%20Authorities,ou=Department%20of%20Homeland%20Security,o=U.S.%20Government,c=US?certificateRevocationList

            X509v3 Authority Key Identifier:
{noformat}


Did anything maybe change in the FIPS or nist libraries/requirements between 10.0.3 and 10.0.4 that could explain this?

How can we debug what is going on?

I had him try 
[https://cloudidentity.atlassian.net/browse/ISAMSUP-4136|https://cloudidentity.atlassian.net/browse/ISAMSUP-4136]

and send in a support file, which can be found at 
/ecurep/sf/TS011/688/TS011688152/2023-01-04/isva_10.0.4.0_20230104-085111_config.support_unpack

and the gskit trace at 
/ecurep/sf/TS011/688/TS011688152/2023-01-04/isva_10.0.4.0_20230104-085111_config.support_unpack/tmp/liberty_dump.zip_unpack/logs/gskit

but I don’t see any errors and I didn’t think it captured any import operation, but I could have just missed it.    Does the import use gskit or something else?

Something else I noticed is that there are a bunch of error messages in 
/ecurep/sf/TS011/688/TS011688152/2023-01-04/isva_10.0.4.0_20230104-085111_config.support_unpack/tmp/liberty_dump.zip_unpack/logs/messages.log

Stuff like 



{noformat}[1/4/23, 8:12:21:332 EST] 0000001e LogService-85-com.ibm.security.access.common                 E CWWKE0702E: Could not resolve module: com.ibm.security.access.common [85]
  Unresolved requirement: Import-Package: org.jose4j
    -> Export-Package: org.jose4j; bundle-symbolic-name=""com.tivoli.am.fim.lib.thirdparty""; bundle-version=""8.0.0""; version=""0.0.0""

and

[1/4/23, 8:12:22:324 EST] 0000001e LogService-183-com.tivoli.am.rba.common                      E CWWKE0702E: Could not resolve module: com.tivoli.am.rba.common [183]
  Unresolved requirement: Import-Package: com.ibm.websphere.management.exception
    -> Export-Package: com.ibm.websphere.management.exception; bundle-symbolic-name=""com.tivoli.am.fim.lib.thirdparty""; bundle-version=""8.0.0""; version=""0.0.0""
       com.tivoli.am.fim.lib.thirdparty [233]
         Unresolved requirement: Import-Package: com.sun.jndi.ldap
         Unresolved requirement: Import-Package: org.eclipse.hyades.logging.java

and others{noformat}


This looks bad but I don’t know if this could be related to the issue at hand or not.



Any help would be appreciated.    Thanks!


",,Annelise Quap,khansen,Nick Lloyd,,,,,,,,,,,,,5b15d950d9936c61022057fe,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011688152,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,,,,US Dept of Homeland Security,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,Yes,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17eqf:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,,,,,,"06/Jan/23 2:42 AM;5b15d9a0dda5f94d06b985b3;Closing jira.   Update from the cust…

The issue was with the hashing algorithm used while creating the P12 file. I found this article on the web. 

[https://access.redhat.com/solutions/5477211|https://access.redhat.com/solutions/5477211]

I added the flag ""-certpbe NONE"" to the openssl command I used to create the P12 file from a PEM file. I was then able to import the cert. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Junctions are not correctly listed when using detailed=true in CURL command execute ,ISAMSUP-4683,274525,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,03/Jan/23 7:25 PM,30/Mar/23 1:03 PM,14/Jul/23 2:47 PM,30/Mar/23 1:03 PM,,,,0,,,,"The customer When they use CURL command to list list all junctions with *detailed=true* as parameter, junction s with the -b ignore setting are not displayed.”

The cammand this use:  curl -sk -H Accept:application/json --user $creds [https://aut21682.test.iam.itz.itzbund.net/wga/reverseproxy/dev.itpluto.itzbund/junctions?detailed=true|https://aut21682.test.iam.itz.itzbund.net/wga/reverseproxy/dev.itpluto.itzbund/junctions?detailed=true]

They get this:

!image-20230103-092005.png|width=375,height=334!

After they created a second junction with the same configuration /itpluto2 with the same command they get:

!image-20230103-092136.png|width=631,height=380!

Please let me know if you have any trace for it.

I tested the same cammand on my VM it works without issue. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,03/Jan/23 7:25 PM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230103-092005.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/176100,03/Jan/23 7:25 PM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230103-092136.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/176099,10/Feb/23 12:48 AM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230209-144543.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182811,10/Feb/23 12:48 AM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230209-144632.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182808,10/Feb/23 12:48 AM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230209-144738.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182810,10/Feb/23 12:48 AM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230209-144829.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182809,10/Feb/23 9:52 AM;ashashiv;image-20230209-234139.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182976,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011308882,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,Informationstechnikzentrum Bund (ITZBund),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17e1r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-09 01:20:52.932,,,,,"09/Jan/23 11:20 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6092aca0f0db130069d19687] 

I tested it on 10050 as well and it seems to work fine with *detailed=true* and without.

What happens when they see the junctions load in browser and have the developer tools on

Enable LMI tracing to trace: _=config=enabled:com.ibm.isam._=ALL:com.ibm.mesa.*=ALL and check if there is any difference in the curl sent in your environment and customers environment.

If they recreate a dummy junction with -b ignore does that work?

Is this specific to one junction or across all junctions with -b ignore. 

Is this specific to this appliance or is it across all their appliances.

If they create a new reverse proxy instance and create a new junction in that does that list ?","09/Jan/23 6:37 PM;6092aca0f0db130069d19687;[~accountid:5af4ad7d4dd24c579110120b] thanks. I tested it on my side too. it works as expected. 

_If they create a new reverse proxy instance and create a new junction in that does that list ?_

The customer said it works after the created new junctions. The issue is it does not work on the junction they created before.

Yes I will get the trace from him.

Thanks. ","10/Jan/23 9:56 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6092aca0f0db130069d19687] 

If the same reverse proxy has other junctions working , have they tried to modify something on this junction and deploy and see if that lists the junction with detailed=true? ",10/Jan/23 6:28 PM;6092aca0f0db130069d19687;[~accountid:5af4ad7d4dd24c579110120b] Yes I will check it with the customer.,"18/Jan/23 8:43 PM;6092aca0f0db130069d19687;[~accountid:5af4ad7d4dd24c579110120b] The customer replied : 

“if I create a second junction with the same settings, and it is listed correctly.

However, I deleted the existing junction and recreated it with the same settings and it still cannot be listed.

*If you recreate a dummy junction with -b ignore does that work?*

Yes, even a copy of the same junction using a different junction point works.

*Is this specific to one junction or across all junctions with -b ignore?*

I initially thought it applies to all -b ignore junctions, but since I'm able to create new ones, I cannot fully ensure that this is the case.

*Is this specific to this appliance or is it across all their appliances?*

We see this issue on many clusters.”","19/Jan/23 7:39 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6092aca0f0db130069d19687] 

Which junction and reverse proxy instance should I be looking at in the support logs?



*Is this specific to this appliance or is it across all their appliances?* 

We see this issue on many clusters. →
 ------ Is this for same junction or multiple junctions of same kind across these clusters? ",19/Jan/23 6:48 PM;6092aca0f0db130069d19687;[~accountid:5af4ad7d4dd24c579110120b] Opp. sorry I will check it with the customer.,"25/Jan/23 12:55 AM;6092aca0f0db130069d19687;The customer came back and said:

“I enabled the trace and made a GET with and without the ?detailed=true on the dev.itpluto.itzbund instance.

I then create a test junction /itpluto_test using the same parameters as /itpluto_nb.

I then deleted and recreated /itpluto_nb.

This issue persists on many different junctions across many different server and instances

I've checked more junctions and I can definitly see missing junctions with the default ""filter"" option enabled. So -b ignore is not the reason.”","25/Jan/23 1:11 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:6092aca0f0db130069d19687] 

So is the issue now - with ?detailed=true not all junctions are listed randomly.

* not specific to a junction
* not specific to a flag on junction ( or -b)
* not specific to a cluster.machine 

It is random junctions not listed and issue with the api having a filter details=true? 



Can you set up an environment with cluster and multiple junctions and see of you can recreate the issue? ","10/Feb/23 12:48 AM;6092aca0f0db130069d19687;[~accountid:5af4ad7d4dd24c579110120b] I tested it in CMD curl -sk -H Accept:application/json --user admin $creds [https://192.168.42.103/wga/reverseproxy/default/junctions?detailed=true|https://192.168.42.103/wga/reverseproxy/default/junctions?detailed=true]

The result:

!image-20230209-144543.png|width=1894,height=301!

But When I tested in postaman with [https://192.168.42.103/wga/reverseproxy/default/junctions?detailed=true|https://192.168.42.103/wga/reverseproxy/default/junctions?detailed=true]

!image-20230209-144632.png|width=660,height=53!

*Tested without detailed= true*

Result: 

!image-20230209-144738.png|width=1212,height=65!

Tested in postman Result:

!image-20230209-144829.png|width=660,height=54!","10/Feb/23 9:52 AM;5af4ad7d4dd24c579110120b;[~accountid:6092aca0f0db130069d19687]  

It works on postman and curl in my environment.

!image-20230209-234139.png|width=743,height=837!

{noformat}curl -i -k --location --request GET 'https://192.168.42.14/wga/reverseproxy/default/junctions?detailed=true' --header 'Accept: application/json' --header 'Content-Type: application/json' --header 'Authorization: Basic YWRtaW46YWRtaW4='
HTTP/1.1 200 OK
X-FRAME-OPTIONS: SAMEORIGIN
Cache-Control: no-cache, no-store
Content-Security-Policy: default-src 'self' 'unsafe-inline' 'unsafe-eval'
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Pragma: no-cache
Content-Type: application/json
Content-Language: en-US
Strict-Transport-Security: max-age=31536000; includeSubDomains
Set-Cookie: LtpaToken2=pM5ZK+wvqLMKY/sSV3kGPMDp1gHnYMyToyII7bgRkOn/BeEmhRwakvtVIXozoUDplztmyS2l6M7DsQXsV4Sffhyj9dTidDGd3VNTQf8lANZO4oNEbiM2LzGgRqggp/JciADsQO9GvpNl995dS582w4Ct7SBRLyl1b57mXNoBtzNMgzyB6v/BwCHCBkyX1y0Jn+kedfxYez/UNtHWHUH06MU+diZ6EqlTMKdPIaehiXrB4apSQZJVH5beoD45NJSsw5C9S1ku50HDqKZwdOxKfBwk4WdMUvgVDQqEU6WPWkWR9a7wwnjsW0T3ZPeVCgRP; Path=/; Secure; HttpOnly; SameSite=Strict
Set-Cookie: JSESSIONID=0000Pedcmmjj_Bpt1Gnkkp_ZGkM:5c06c6b2-e85a-4499-86f3-bfb6cfb7e613; Path=/; Secure; HttpOnly; SameSite=Strict
Transfer-Encoding: chunked
Date: Fri, 10 Feb 2023 07:39:55 GMT
Expires: Thu, 01 Dec 1994 16:00:00 GMT

[{""junction_type"":""Local"",""servers"":"""",""junction_point"":""/"",""active_worker_threads"":""0"",""junction_soft_limit"":""0 - using global value"",""junction_hard_limit"":""0 - using global value"",""type"":""standard""}, {""junction_point"":""/abc"",""http_header_ident"":""insert - iv_user iv_user_l iv_creds"",""insert_session_cookies"":""no"",""request_encoding"":""UTF-8, URI Encoded"",""basic_auth_mode"":""filter"",""junction_soft_limit"":""0 - using global value"",""junction_hard_limit"":""0 - using global value"",""authz_rules"":""no"",""type"":""standard"",""client_ip_http"":""do not insert"",""fsso_config_file"":""disabled"",""servers"":""server_uuid!d3ce400a-a88a-11ed-8b80-000c290b7d9c;server_state!running;operation_state!Online;server_hostname!192.168.2.135;server_port!8000;http_port!8000;virtual_junction_hostname!192.168.2.135:8000;priority!9;server_dn!;server_cn!;local_ip!;query_content_url!/cgi-bin/query_contents;query_contents!unknown;case_sensitive_url!no;windows_style_url!no;current_requests!0;total_requests!193;"",""boolean_rule_header"":""no"",""stateful_junction"":""no"",""remote_http_header"":""insert - iv_user iv_user_l iv_creds"",""scripting_support"":""no"",""transparent_path_junction"":""no"",""junction_type"":""TCP"",""delegation_support"":""no"",""preserve_cookie"":""no"",""active_worker_threads"":""0"",""forms_based_sso"":""disabled"",""tfim_sso"":""no"",""session_cookie_backend_portal"":""no"",""cookie_include_path"":""no"",""mutual_auth"":""no""}]{noformat}





Under LMI-->Administrator Settings--> LMI Tracing → Set trace level to -

{noformat}*=config=enabled:com.ibm.isam.*=ALL:HTTPChannel=ALL:SSL=ALL:SSLChannel=ALL{noformat}

Run your queries from postman/curl

You should see entries in management_ui/trace.log 



This is with detailed=true → which calls {{showJunctions}} 

{noformat}[2/10/23, 18:02:59:601 AEST] 00000024 id=00000000 Junctions                                                    > doRestGet(req, default, resp) ENTRY
[2/10/23, 18:02:59:602 AEST] 00000024 id=00000000 Junctions                                                    > showJunctions(default) ENTRY
[2/10/23, 18:02:59:603 AEST] 00000024 id=00000000 com.ibm.isam.common.utils.WgaCommand                         1 Using user : admin
[2/10/23, 18:02:59:655 AEST] 00000024 id=00000000 Junctions                                                    > parseJunction ENTRY
[2/10/23, 18:02:59:655 AEST] 00000024 id=00000000 Junctions                                                    < parseJunction RETURN
[2/10/23, 18:02:59:655 AEST] 00000024 id=00000000 Junctions                                                    > parseJunction ENTRY
[2/10/23, 18:02:59:656 AEST] 00000024 id=00000000 Junctions                                                    < parseJunction RETURN
[2/10/23, 18:02:59:656 AEST] 00000024 id=00000000 Junctions                                                    < showJunctions(default) RETURN 0
[2/10/23, 18:02:59:658 AEST] 00000024 id=00000000 Junctions                                                    < doRestGet(req, default, resp) RETURN
[2/10/23, 18:02:59:658 AEST] 00000024 id=00000000                                                              1  GET https://192.168.42.14/wga/junctions/default?detailed=true (057 msecs 334 usecs)
[2/10/23, 18:02:59:658 AEST] 00000024 id=16e97c6f com.ibm.wsspi.http.ee7.HttpOutputStreamEE7                   > getVc Entry {noformat}

This is with detailed=false → Which calls {{listJunctions}}  

{noformat}[2/10/23, 18:05:55:014 AEST] 0000007a id=00000000 Junctions                                                    > doRestGet(req, default, resp) ENTRY
[2/10/23, 18:05:55:014 AEST] 0000007a id=00000000 Junctions                                                    > listJunctions(req, default, resp) ENTRY
[2/10/23, 18:05:55:017 AEST] 0000007a id=00000000 com.ibm.isam.common.utils.WgaCommand                         1 Using user : admin
[2/10/23, 18:05:55:066 AEST] 0000007a id=00000000 com.ibm.isam.common.utils.WgaCommand                         1 Using user : admin
[2/10/23, 18:05:55:118 AEST] 0000007a id=00000000 com.ibm.isam.common.utils.WgaCommand                         1 Using user : admin
[2/10/23, 18:05:55:167 AEST] 0000007a id=00000000 Junctions                                                    1 listJunctions(req, default, resp) No virtualhost junctions for default
[2/10/23, 18:05:55:167 AEST] 0000007a id=00000000 Junctions                                                    < listJunctions(req, default, resp) RETURN
[2/10/23, 18:05:55:168 AEST] 0000007a id=00000000 Junctions                                                    < doRestGet(req, default, resp) RETURN
[2/10/23, 18:05:55:168 AEST] 0000007a id=00000000                                                              1  GET https://192.168.42.14/wga/junctions/default?detailed=false (154 msecs 006 usecs)
[2/10/23, 18:05:55:168 AEST] 0000007a id=9c403ee3 com.ibm.wsspi.http.ee7.HttpOutputStreamEE7                   > getVc Entry {noformat}

You can enable these trace and check in your environment.",10/Feb/23 7:53 PM;6092aca0f0db130069d19687;[~accountid:5af4ad7d4dd24c579110120b] oh i see. Should we ask the customer to change the option in LMI and let him test it again?,"13/Feb/23 9:12 AM;5af4ad7d4dd24c579110120b;[~accountid:6092aca0f0db130069d19687] 

I guess you tested this on your environment from your comment on 10th feb on

[https://192.168.42.103/wga/reverseproxy/default/junctions?detailed=true|https://192.168.42.103/wga/reverseproxy/default/junctions?detailed=true] ? 



If so - you also should run the same test on your environment and also get the customer to run with this trace setting on and see if show junctions and list junctions are called and they list the junctions.","13/Feb/23 6:21 PM;6092aca0f0db130069d19687;[~accountid:5af4ad7d4dd24c579110120b] Yes, I will ask the customer to run the same test and get the LMI trace.",30/Mar/23 1:03 PM;5af4ad7d4dd24c579110120b;case closed.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
pd.jar and websphere support,ISAMSUP-5211,310870,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,rholman,5bac25a83a6aa22dbebb46cf,rholman,5bac25a83a6aa22dbebb46cf,07/Jul/23 3:04 AM,12/Jul/23 11:25 PM,14/Jul/23 2:47 PM,,,,,0,,,,"Customer Request:

Can I get a support matrix that includes ISVA 10.x?

We've run into a problem where pd.jar in ISVA10.x seems to require java 11, but WAS9 runs on Java 8.  So it looks like the highest pd.jar we can run on the WAS servers is the pd.jar from ISAM 9.   (which we've been running for a long time, and works fine against the ISVA10 environment we have.)

But I'd like to have an official page / statement on ISVA support using the pd.jar from ISAM9 on ISVA10 systems.
Does that exist?

I have the matrix referenced below, which is really good, but stops short of calling out ISVA specifically.

[https://www.ibm.com/support/pages/websphere-isam-tam-embedded-pdjar|https://www.ibm.com/support/pages/websphere-isam-tam-embedded-pdjar]

(this question is stemming from another ticket I have with HCL regarding my Websphere Portal system, which we use PUMA and pd.jar with, suddenly stopped working...  It was running fine on pd.jar 9.x for a long time...)

We have informed the customer that he will need to provide feedback on the matrix link with a request for the new version certification but the customer has escalated this to get an answer so i said I would inquire about this as well. I did tell him that there is no guarantee as to a time frame or if this will even be done, but I think this is something that we need to have out there.",,David Hayes,khansen,Motiur Rahman,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013457998,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,oscar.jimen,6333216f748d1bfcb85982ca,,,,CELESTICA INTERNATIONAL INC.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1df07:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.0.0,ISVA 10.0.0.1,ISVA 10.0.1.0,ISVA 10.0.2.0,ISVA 10.0.3.0,ISVA 10.0.3.1,ISVA 10.0.4.0,ISVA 10.0.5.0,ISVA 10.0.6.0,,,,,2023-07-06 20:46:26.8,,,,,"07/Jul/23 6:46 AM;5b15d94b6256d01ad54eb020;You should be able to run 10.0.2.0  without any issues with Java 8.   There are problems with the 10.0.3.x  versions  which are fixed in 10.0.6.0.

The 10.0.6.0  is intended to work with either IBM Java or Openjdk.   The 10.0.2.0 version is limited to IBM  Java 8.

Since you are running ISVA  10 Policy Server  and Java 8, I’d recommend    10.0.2.0  since 10.0.6.0  is still pretty new. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
"Customer Queries regarding ""Node.js jsrsasign module""",ISAMSUP-5191,309328,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,28/Jun/23 3:50 PM,04/Jul/23 2:55 PM,14/Jul/23 2:47 PM,04/Jul/23 2:55 PM,,Support,,0,,,,"Hi Team,

I have a customer who has some questions regarding the Node.js jsrsasign module. As for the vulnerability part I have already shared this - [https://www.ibm.com/support/pages/node/6833870|https://www.ibm.com/support/pages/node/6833870]

# how to check whether the ""Node.js jsrsasign module"" is used or enabled in our environment. They want to know the procedure to check.
# Is this being used for Advance Access Control? How to verify?

Requesting your help in answering these questions.

Thanks",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013437495,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,INLAND REVENUE AUTHORITY OF SINGAPORE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d5nz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-06-28 06:29:08.652,,,,,"28/Jun/23 4:29 PM;5b232b2fd85e5b59b066f57f;The jsrsasign module (jsrsasign-all-min.js) is used within the Federation functionality - specifically in relation to template pages. 

Having said that, we cannot guarantee that not using this module will be enough to mitigate the vulnerability. ISVA 10.0.5 contains the vulnerability fix, and it was also back-ported to 10.0.4.0_IF1 - the recommendation is that the customer upgrade. 

For Support Reference:- 

Note that the customer should be aware of this based on previous cases / WIs from this customer ( [https://cloudidentity.atlassian.net/browse/ISAMSUP-4301|https://cloudidentity.atlassian.net/browse/ISAMSUP-4301|smart-link] )

Vulnerability was patched in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4313|https://cloudidentity.atlassian.net/browse/ISAMSUP-4313|smart-link]",30/Jun/23 4:26 PM;62d0e51aec233f24684a5d3a;Thanks David for the explanation. I will cascade the same to the customer.,04/Jul/23 2:55 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 What is the maximum value which can be kept for the Advanced Tuning Paramter authdb.lockout.period?,ISAMSUP-5185,309203,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,28/Jun/23 12:09 AM,12/Jul/23 8:50 AM,14/Jul/23 2:47 PM,12/Jul/23 8:50 AM,,,,0,,,,"What is the maximum value which can be kept for the Advanced Tuning Parameter authdb.lockout.period?

Follow up PMR as customer as customer wants to configure the lockout policy on the lmi admin password.",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013358755,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,FIRST ABU DHABI BANK P.J.S.C,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d4wf:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-28 01:47:05.758,,,,,"28/Jun/23 11:47 AM;5af4ad7d4dd24c579110120b;[~accountid:614dd566a995ad0073ec0622] 

authdb.lockout.period  -  there is no hardcoded maximum value for this tuning parameter to be set.
To be used wisely when the tuning parameter is set.
But since the type is long integer which has a

Key: authdb.lockout.period 
Value: In seconds 

* The number of seconds for which an account will be locked out.

Key: authdb.lockout.attempts
Value: 5/0/number

* Defines the number of failed authentication attempts before the account will be locked out. This will default to a value of 5. A value of 0 will disable the account lockout functionality.

Let me know if this answers.",29/Jun/23 2:17 AM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] So it could be maximum value of 2^63^-1 seconds?!,29/Jun/23 2:31 AM;5b15d9e6dda5f94d06b985b4;[~accountid:614dd566a995ad0073ec0622] Yes.,11/Jul/23 6:21 PM;614dd566a995ad0073ec0622;PMR closed.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
p12 files should take precedence over kdb files during upgrade,ISAMSUP-5173,308181,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,23/Jun/23 10:38 AM,07/Jul/23 12:57 PM,14/Jul/23 2:47 PM,29/Jun/23 12:41 PM,,Support,,0,,,,"In the upgrade post migration code

if there is a p12 file and kdb file with the same name in /var/pdweb/shared/keytab

then the p12 file is deleted and the kdb converted to p12

In the customers case - the p12 was the file referenced by reverse proxies - and the kdb file could no be opened - so this process prevented a number of reverse proxies from starting post upgrade

Since the presence of both p12 and kdb indicates previous version has already gone thru the conversion process - we should skip the conversion (ie leave p12 alone) rather than try to convert again",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5164,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,None,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=9, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":9,""lastUpdated"":""2023-07-07T12:57:54.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":9,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cypj:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-28 14:01:09.351,,,,,"29/Jun/23 12:01 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 9ede802f68aec862a663867fb32f33423ef5d880
   * description: ISAMSUP-5173 p12 files take precedence over kdb files during upgrade

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1876337.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5173) which we publish.","29/Jun/23 12:06 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has failed for the following commit: 
   * id: 96753a86cd4a448b1412571191d1aab43f68e06a
   * description: Merge pull request #6010 from ISAM/ISAMSUP-5173

ISAMSUP-5173 p12 files take precedence over kdb files during upgrade

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1939458.

","06/Jul/23 1:50 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c5ac7f209be2ec871a1ee6856579f7eecdb3c2b3
   * description: Revert ""Merge pull request #6010 from ISAM/ISAMSUP-5173""

This reverts commit 96753a86cd4a448b1412571191d1aab43f68e06a, reversing
changes made to b8f74e19440bb939e623ce33620efda0e715f57e.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2227234.


This build has not been published as the commit is not currently within a branch (ISAMDEV-10515) which we publish.","07/Jul/23 12:57 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 41aa2aef63b0af060893c6d5bb55720141290372
   * description: Merge pull request #6018 from ISAM/ISAMDEV-10515

Revert ""Merge pull request #6010 from ISAM/ISAMSUP-5173""

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2293345.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230707025438-41aa2aef6.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
After 10.0.6 upgrade -  FIDO2ServerException: FID001E The system couldn't process the request because an internal error occurred.,ISAMSUP-5172,308130,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,22/Jun/23 11:43 PM,03/Jul/23 7:12 AM,14/Jul/23 2:47 PM,03/Jul/23 7:12 AM,10.0.7,,,0,,,,"*Problem Description:*
After firmware upgrade from 10.0.5.1 to 10.0.6.0 FIDO2 authentication is failing with the following error- ""FIDO2ServerException: FID001E The system couldn't process the request because an internal error occurred."" 

messages.log- 

{noformat}[6/20/23, 16:06:48:217 PDT] 000007b5 com.tivoli.am.fim.fido.server.FIDORegistrationManager I org.postgresql.util.PSQLException: ERROR: syntax error at or near ""("" Position: 41 ... 

[6/20/23, 16:06:48:221 PDT] 000007b5 com.tivoli.am.fim.fido.server.FIDOServer I com.tivoli.am.fim.fido.exception.FIDO2ServerException: FID001E The system couldn't process the request because an internal error occurred. 

postgresql-Tue.log- 2023-06-20 23:06:48 GMT:www-dataERROR: syntax error at or near ""("" at character 41 2023-06-20 23:06:48 GMT:www-dataSTATEMENT: INSERT INTO FIDO_USER_IDS(USER_ID, LOWER(USERNAME), RP_ID, TENANT_ID) VALUES ($1,$2,$3,$4){noformat}

That SQL seems fine. This is internal DBs so no concern on external schema concerns.

Did we run into something new with 10.0.6?

Data is on ecurep:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013382298&path=TS013382298%2F0-all_data%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013382298&path=TS013382298%2F0-all_data%2F]",,Asha Shivalingaiah,cholt@us.ibm.com,David Hayes,Motiur Rahman,Nick Lloyd,,,,,,,,,,,5af4ad7d4dd24c579110120b,5b15d994dda5f94d06b985b2,5b232b2fd85e5b59b066f57f,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5187,,,,,,,,,,,,,,,,,,,,,IJ47417,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013382298,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,cholt@us.ibm.com,5b15d994dda5f94d06b985b2,,,,Name STATE COMPENSATION INSURANCEFUND,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-06-28T14:25:48.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013382298&path=TS013382298%2F0-all_data%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1cyef:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-22 23:02:29.888,,,,,"23/Jun/23 9:02 AM;5b15d954b0d76456f36daf33;— internal —

The error stack is pointing to changes added as part of [https://cloudidentity.atlassian.net/browse/ISAMDEV-9716|https://cloudidentity.atlassian.net/browse/ISAMDEV-9716|smart-link] 

Setting up a local recreate will be the fastest way to debug.","26/Jun/23 1:49 PM;5b15d954b0d76456f36daf33;[~accountid:5b15d994dda5f94d06b985b2] go ahead and create an APAR as this is obviously a problem. It looks to me like there is an issue converting the username to lower case before updating the registration.

Also if you have a local recreate, can you use this trace spec and see what sql statement gets logged : {{com.ibm.security.access.utils.*=ALL}}

If not, I’ll give it a try when I’m back from my leave (11/07).",28/Jun/23 11:10 AM;5b15d9f03993e9196502f607;[~accountid:5b15d954b0d76456f36daf33] [~accountid:5b232b2fd85e5b59b066f57f] I have found the problem here and made a fix in the 10.0.7.0 tree. [https://github.ibm.com/ISAM/isam/pull/6007|https://github.ibm.com/ISAM/isam/pull/6007] Let me know if you need my to do anything else.,"28/Jun/23 12:30 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: bb917ef73f9b18f9f39c890c75041bda48b38630
   * description: ISAMSUP-5172

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1873199.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5172) which we publish.","28/Jun/23 2:25 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 88fcb3110c45120505a4329988455d08c5929b70
   * description: Merge pull request #6007 from ISAM/ISAMSUP-5172

ISAMSUP-5172 Remove invalid LOWER usage on insert

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1875736.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230628042257-88fcb3110.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","28/Jun/23 3:45 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d994dda5f94d06b985b2] 

Here is a fixpack - [https://cloudidentity.atlassian.net/browse/ISAMSUP-5187|https://cloudidentity.atlassian.net/browse/ISAMSUP-5187|smart-link] 

let me know if this revolves the issue.","28/Jun/23 3:45 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 88fcb3110c45120505a4329988455d08c5929b70
   * description: Merge pull request #6007 from ISAM/ISAMSUP-5172

ISAMSUP-5172 Remove invalid LOWER usage on insert

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1877121.


This build has not been published as the commit is not currently within a branch (20230628042257-88fcb3110) which we publish.",01/Jul/23 2:31 AM;5b15d99b4c20165700edecad;This fixed the customers issue. ,01/Jul/23 3:00 AM;5b15d99b4c20165700edecad;It looks like this will be in 10.0.7.0. Any chance it will also make it into 10.0.6.0 via IF?,"03/Jul/23 7:10 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d99b4c20165700edecad] 

Yes it will be in 10.0.7.0.

If there is an IF for 10.0.6.0 will include this.

Thanks",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
LMI Session Persistence screen incorrectly generates distributedSessionCache.externalServers value,ISAMSUP-5171,308127,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,22/Jun/23 11:04 PM,28/Jun/23 11:01 AM,14/Jul/23 2:47 PM,28/Jun/23 11:01 AM,10.0.7,Support,22/Jun/23 12:00 AM,0,,,,"Hello, 

On the AAC > Session Persistence screen on the Stores tab the value of the distributedSessionCache.externalServers Advanced Configuration Property generated incorrectly uses colons "","" as the separator between external servers instead of the expect semicolon "";"". Incorrect values cause errors in AAC functionality (authentication flows) when DSC is used for session persistence. Documentation of this parameter: [https://www.ibm.com/docs/en/sva/10.0.6?topic=configuration-advanced-properties#aac_advcfgprop__d249e2312|https://www.ibm.com/docs/en/sva/10.0.6?topic=configuration-advanced-properties#aac_advcfgprop__d249e2312|smart-link]  

Steps to reproduce: - Navigate to AAC > Session Persistence -> Stores tab - Select the ""External Distributed Session Cache"" radiobutton - Add at least two rows in the table of servers (can be dummy data) - See the incorrectly generated value at the bottom of the page - See the same value at AAC > Advanced Configuration 
This issue was originally encountered on a version 10.0.4_IF1 appliance, but can be reproduced on version 10.0.6 as well. Affects containerized version as well.

!Screenshot 2023-06-22 at 13.59.16.png|width=1792,height=411!

!Screenshot 2023-06-22 at 13.58.52.png|width=1657,height=898!",,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,Tushar Prasad,Virag Patel,,,,,,,,,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,,,,,,,,,,,,,,22/Jun/23 11:04 PM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-06-22 at 13.58.52.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/207941,22/Jun/23 11:04 PM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-06-22 at 13.59.16.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/207940,23/Jun/23 8:37 AM;ashashiv;image-20230622-223616.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208027,,,,,,,,,,,,,IJ47356,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013389453,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,RAIFFEISEN BANK S.A,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-06-27T11:00:15.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS013389453&path=TS013389453%2F2023-06-21%2F&filepath=TS013389453%2F2023-06-21%2Fadv_conf.png

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013389453&path=TS013389453%2F2023-06-22%2F",,,,,,,,,AIX,Linux 86_64,Windows Server 20xx,,,,,,,,,,,,0|i1cydr:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-06-22 22:37:04.375,,,,,"23/Jun/23 8:37 AM;5af4ad7d4dd24c579110120b;[~accountid:60f541a6d0134900692d91b7] 

It already says it is a comma separated list of entries, when you hover over the option.
Working as designed.


What is the issue caused to the AAC flow because of this option being comma separated and not semicolon separated.

!image-20230622-223616.png|width=906,height=638!","23/Jun/23 9:59 PM;60f541a6d0134900692d91b7;[~accountid:5af4ad7d4dd24c579110120b] 
I also reviewed the support file and I could not see any error they state,
Customer says,

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
That's because I didn't go as far as trying any authentication flows. The support file is from my local sandbox environment. To reproduce fully, I'd need to involve the customer team, because the environment where we encountered this issue is airgapped.

This would take a lot of effort, and I fail to see how it is relevant. Once again, *the official product documentation states to use semicolons*.

when using colons as the separator AAC authentication flows fail, with HTTP 500 errors coming for requests sent to /apiauthsvc. In the logs we see SSL Handshake errors to the DSC hosts. In this case the FIM_DSC_HTTP_SESSION_REPLICA_SET replica set doesn't even get created in the DSC.

When using semicolons as the separator, authentication flows are all working as expected and we can see entries created in the FIM_DSC_HTTP_SESSION_REPLICA_SET replica set in the DSC.

I'd like to reiterate that the documentation for this property also shows *semicolons* as the separator: [https://www.ibm.com/docs/en/sva/10.0.6?topic=configuration-advanced-properties#aac_advcfgprop__d249e2312|https://www.ibm.com/docs/en/sva/10.0.6?topic=configuration-advanced-properties#aac_advcfgprop__d249e2312|smart-link] 

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","26/Jun/23 11:14 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60f541a6d0134900692d91b7] 

Here is a fixpack to change the entries to have semicolon instead of comma, 

name: dsc_extserverlist_10040IF1
fixpack: [https://ibm.box.com/s/edde5j8ttdnr1nq9cya4rcdi56wyjgds|https://ibm.box.com/s/edde5j8ttdnr1nq9cya4rcdi56wyjgds|smart-link] 
checksum: [https://ibm.box.com/s/2o6dh5tg3c0b6rives7lwnyo8nmtyptb|https://ibm.box.com/s/2o6dh5tg3c0b6rives7lwnyo8nmtyptb|smart-link] 
version: 10050
files changed:
/opt/ibm/wlp/usr/servers/default/dropins.disabled/mga.ear

Let me know if this resolves the AAC flow issue too by having this in place.","26/Jun/23 9:44 PM;60f541a6d0134900692d91b7;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for the fixpack customer confirmed the parameter is generated with semicolons, subsequently DSC connections and authentication flows are working as expected.

Customer is requesting 
”Can you share with me the APAR number for this? Will this fix be available in the next release (e.g. 10.0.7)?”","27/Jun/23 8:29 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a0d15fe66ddb008ecbcefa212bd029f1ff6d2021
   * description: ISAMSUP-5171 Dsc external servers entry breaks AAC flow

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1805104.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5171) which we publish.","27/Jun/23 9:39 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60f541a6d0134900692d91b7] 

Can you create an APAR for this.
Thanks","27/Jun/23 11:00 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 996d4ae5fdc90908225a502e633a17833875f8ec
   * description: Merge pull request #6005 from ISAM/ISAMSUP-5171

ISAMSUP-5171 Dsc external servers entry breaks AAC flow

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1809098.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230627005730-996d4ae5f.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","27/Jun/23 12:19 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 996d4ae5fdc90908225a502e633a17833875f8ec
   * description: Merge pull request #6005 from ISAM/ISAMSUP-5171

ISAMSUP-5171 Dsc external servers entry breaks AAC flow

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1810256.


This build has not been published as the commit is not currently within a branch (20230627005730-996d4ae5f) which we publish.","27/Jun/23 9:15 PM;60f541a6d0134900692d91b7;[~accountid:5af4ad7d4dd24c579110120b] Apar created, APAR number: IJ47356","27/Jun/23 11:02 PM;60f541a6d0134900692d91b7;[~accountid:5af4ad7d4dd24c579110120b] Thanks for the work should I close the Jira, since client agreed to close the case?",28/Jun/23 11:01 AM;5af4ad7d4dd24c579110120b; Thanks Surya.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Reverse proxy should only parse POST request body when necessary ,ISAMSUP-5165,307974,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,21/Jun/23 8:58 PM,05/Jul/23 9:41 AM,14/Jul/23 2:47 PM,05/Jul/23 9:41 AM,10.0.7,Support,,0,Performance,,,"When [azn-decision-info] contains post-data lines

If there are no json post-data items - then we shouldnt parse the body of json POST requests

If there are json post-data items - then we should parse the body of json POST requests

if there are no form post data items  - then we shouldnt parse html form data requests

if there are form post data items  - then we should parse html form data requests",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,None,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2023-07-01T09:16:37.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":5,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cxg7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-22 03:17:15.482,,,,,"21/Jun/23 10:39 PM;5b15d9517dab4c51f61b5190;This is a side issue I found when looking at the JSON memory leak [https://cloudidentity.atlassian.net/browse/ISAMSUP-4880|https://cloudidentity.atlassian.net/browse/ISAMSUP-4880|smart-link] 

In that case the customer had no json post-data items - yet still hit the json memory leak because we are parsing the json post data when we didnt need to.","22/Jun/23 1:17 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: cc75acea5e44eabfb42fcda54abb7d589a23b038
   * description: ISAMSUP-5165 should only parse POST request body when necessary

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1631047.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5165) which we publish.","30/Jun/23 6:10 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 2e894a165805eb7319a2c21443a4187aec227ddb
   * description: ISAMSUP-5165 should only parse POST request body when necessary (#5995)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2001779.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230630080659-2e894a165.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","30/Jun/23 7:35 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 2e894a165805eb7319a2c21443a4187aec227ddb
   * description: ISAMSUP-5165 should only parse POST request body when necessary (#5995)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2005273.


This build has not been published as the commit is not currently within a branch (20230630080659-2e894a165) which we publish.","01/Jul/23 9:16 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 2e894a165805eb7319a2c21443a4187aec227ddb
   * description: ISAMSUP-5165 should only parse POST request body when necessary (#5995)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2045270.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230630231341-2e894a165.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Certificate p12 DB file removed post upgrade from 10.0.3.1 to 10.0.5.0,ISAMSUP-5164,307972,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,21/Jun/23 8:37 PM,03/Jul/23 9:47 PM,14/Jul/23 2:47 PM,03/Jul/23 9:47 PM,,Support,22/Jun/23 12:00 AM,0,,,,"Client’s pre-prod environment running 10.0.3.1 and they upgraded to 10.0.5.0. Post this event a number of their WebSEAL instances failed to start correctly. From the ISVA support data, there are 30 WRP’s and 15 of these appear to have been affected i.e. 
{{DPWIV1210W Function call, gsk_environment_init, failed error: 000000ca GSK_KEYRING_OPEN_ERROR.}}

The certificate file “+_pdjct_COMMBE4.p12_+"" can be seen in the 10.0.3.1 support data, but not 10.0.5.0 i.e.
{{[0:iei81220@debug71]:/ecurep/sf/TS013/366/TS013366346/2023-06-19/isva_10.0.3.1_20230619-020149.885145_s1s003si.snapshot.zip_unpack $ find . -name pdjct_COMMBE4*}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.p12}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.kdb}}
{{./var/pdweb/shared/keytab/jks/pdjct_COMMBE4.jks}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.sth}}

{{[0:iei81220@debug71]:/ecurep/sf/TS013/366/TS013366346/2023-06-20/isva_10.0.3.1_20230620-170122_s1s003si.support_unpack $ find . -name pdjct_COMMBE4*}}
{{./iswga/pdjct_COMMBE4.p12.txt}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.p12}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.kdb}}
{{./var/pdweb/shared/keytab/jks/pdjct_COMMBE4.jks}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.sth}}

{{[0:iei81220@debug71]:/ecurep/sf/TS013/366/TS013366346/2023-06-19/isva_10.0.5.0_20230619-200121_s1s003si.support_unpack $ find . -name pdjct_COMMBE4*}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.kdb}}
{{./var/pdweb/shared/keytab/jks/pdjct_COMMBE4.jks}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.sth}}

{{[0:iei81220@debug71]:/ecurep/sf/TS013/366/TS013366346/2023-06-19/isva_10.0.5.0_20230619-200842_s1s003si.support_unpack $ find . -name pdjct_COMMBE4*}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.kdb}}
{{./var/pdweb/shared/keytab/jks/pdjct_COMMBE4.jks}}
{{./var/pdweb/shared/keytab/pdjct_COMMBE4.sth}}


Client, KBC, has managed some work arounds via file copy and renames, but this is hit and miss, and is not entirely happy or confident re this as they are due to upgrade their Prod environment over the coming weekend(s). Hence they are seeking any reason(s) as to why one of their critical P12 certificate files has disappeared post upgrade from 10.0.3.1 to 10.0.5.0. 
L2 asking for analysis, review re this scenario, please.",,Aaron.Richie.Dias,Dermot Daly,gvacek,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,6194c472fe9f300068e5252f,6092ac9ff6c0960069d47a67,5c87cb8d88f9ec6ae0afb306,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5173,,,,,,22/Jun/23 9:20 PM;phorner;cleanup_kdbs.fixpack;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/207894,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013366346,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,KBC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013366346&path=TS013366346%2F0-all_data%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1cxfz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,ISVA 10.0.5.0,,,,,,,,,,,,2023-06-21 12:37:58.317,,,,,"21/Jun/23 10:37 PM;5c87cb8d88f9ec6ae0afb306;One thing that I noticed for the keystore that is not getting updated is that the pdjct_COMMBE4.kdb file cannot be opened with gskit commands: 

gsk8capicmd_64 -cert -list -db pdjct_COMMBE4.kdb -stashed
CTGSK3026W The key file ""pdjct_COMMBE4.kdb"" does not exist or cannot be read.
CTGSK2016W An invalid database password was encountered.

While the .p12 file can be opened: 
gsk8capicmd_64 -cert -list -db pdjct_COMMBE4.p12 -stashed
Certificates found

* default, - personal, ! trusted, # secret key
!       ""DigiCert Global Root G2""

….

I checked one of the other keystores (that is getting migrated), and the .kdb file can be opened.   gsk8capicmd_64 -cert -list -db pdjct_COMMBE8.kdb -stashed
Certificates found

* default, - personal, ! trusted, # secret key

…



I’m not sure how all of the .p12 and .kdb files are used in an update from 10.0.3.1 to 10.0.5.0, but I wanted to point this out as an observation.  


","22/Jun/23 12:12 AM;5c87cb8d88f9ec6ae0afb306;Several of the .kdb files cannot be opened. 

It seems likely that ISVA is doing an “unnecessary” conversion of the .kdb and that is failing.  Causing the .p12, .sth, and .kdb to be deleted.   

In 10.0.3.1, the bad .kdb file was not causing an issue with the proxy, because the proxy was using the .p12 file.  But, during the upgrade to 10.0.5.0, the files were removed, causing issues with the proxy. 

In this case, should ISVA just be deleting the .kdb file and not trying to convert it?  A .p12 already exists. ","22/Jun/23 2:45 PM;5b15d9517dab4c51f61b5190;Because the upgrade does not know what version you are coming from

It tries to convert all kdb’s to p12 files as part of the upgrade post processing

I looked at the code.

If there is a p12 of the same name - it deletes it before attempting the conversion

So need to remove all kdbs with same names as p12 files in /var/pdweb/shared/keytab before upgrading

Do you know of any way to do this

I am thinking we need a fixpack to do the cleanup

It would  try to open all kdbs in 

if it can open kdb - it ignores it

if it fails

it looks for a p12 with same name eg name.p12

if it exists - it will delete just the name.kdb

if it doesnt it will delete name.*","22/Jun/23 9:23 PM;5b15d9517dab4c51f61b5190;I have been trying out the cleanup_kdbs fixpack (attached)

It is intended to be run before upgrading

It only removes  kdbs that cant be opened.

But what this means is that any good kdbs  left - will get converted by the upgrade process

So any existing p12 files with the same name as a kdb - will get deleted and recreated

So if there are any certificates in the existing p12 that are not in the corresponding kdb before the upgrade  - the upgrade will effectively delete them. 

If this is an issue - I would need to build an alternative  fixpack to delete all the kdb files where there is a matching p12

If you still have 10.0.3.1 on the other partition 

You could swap back to that, apply the fixpack, and redo the upgrade to 10.0.5.0 - to see that it does what you need",22/Jun/23 10:36 PM;6154906364ff01007106e189;Thank you [~accountid:5b15d9517dab4c51f61b5190] will inform and provide customer of same and will let you know outcome regarding this.,"23/Jun/23 2:24 AM;6154906364ff01007106e189;Hi [~accountid:5b15d9517dab4c51f61b5190] ( plus [~accountid:5c87cb8d88f9ec6ae0afb306] ) customer has come back with 25 support files 😕 and also with the following assumptions/queries 🤯 

~#1 I remember there was a migration from kdb format to pkcs12 in the past. That migration is still present in the appliance, probably due to the possible upgrade paths. However, we can assume something went wrong when going to 10.0.5. Maybe the migration was attempted again, failed and cleared the pkcs12 even though the migration actually did not have to take place. Is that a correct assumption?~

~#2 The proposed clean will remove kdbs which can't be opened because there probably was already a change to the pkcs12 and the stash file is in line with the pkcs12 but not with the kdbs.~
~So for the removed kdbs the migration would not happen. All clear on that.~

~#3 However, what worries me a bit is there could again be a migration from kdbs which still can be opened to pkcs12 and we might loose the pkcs12.I'm not sure that is very interesting...~

~#4 I actually just created support files for the primary masters we're going to upgrade. I'll upload those. Can I ask you evaluate those to see if we might run into trouble? Maybe there won't be such a situation in production and we don't need the fixpack?~ 

~#5 The following alternative also exists for me; upload the broken key store with a different name. Deploy the change. Rename the newly uploaded key store to the name of the broken one.~

~#6 Maybe we can benefit from a quick call to discuss the ideas?~


Any thoughts, comments on above, much appreciated.","23/Jun/23 9:39 AM;5b15d9517dab4c51f61b5190;Re #1

The upgrade will attempt to convert every kdb in the /var/pdweb/shared/keytab directory after deleting the corresponding kdb.

I dont know how the password for the kdb and p12 got out of sync

We do this because of cluster migration paths with keystore replication. When first boot into new version (10.0.5.0) - we dont know what the previous version was.

Since it could have been pre 10.0.3.0 we need to keep the kdbs - because if we removed them and it was replicated - it leaves the cluster nodes at the previous version inoperable

(It would make sense going forward to have the p12 take priority - ie not delete the p12 and attempt the conversion of kdb if p12 already exists - but cant change existing upgrade behaviour)



Re #3 

Because of the need to keep the kdbs for a cluster (described above) - there is no automation of bulk kdb deletion

But what I have found is that we keep the kdb file until the corresponding p12 is changed

So where you have a corresponding p12 and kdb - if you make a change to a p12, then the kdb will be deleted

So (in combination with the fixpack) via this mechanism you can cleanup the all kdbs on 10.0.3.1 thru the LMI prior to the upgrade

Re #4

 I will look at support files

Re #5

Above LMI way is simpler

Re #6

Happy to have a call.","23/Jun/23 10:16 AM;5b15d9517dab4c51f61b5190;I looked at new support file pdjct_COMMBE4.kdb has same issue on the primary

[43:phorner@ecurep]:/ecurep/sf/TS013/366/TS013366346/2023-06-22/isva_10.0.3.1_20230622-132811_s0ab07rf.support_unpack/var/pdweb/shared/keytab $ gsk8capicmd_64 -cert -list -db pdjct_COMMBE4.kdb -stashed

CTGSK3026W The key file ""pdjct_COMMBE4.kdb"" does not exist or cannot be read.

CTGSK2016W An invalid database password was encountered.



Call me slow - but I only just realised that by modifying pdjct_COMMBE4.p12 through the LMI

It will delete the pdjct_COMMBE4.kdb without the need of the fixpack","23/Jun/23 10:39 AM;5b15d9517dab4c51f61b5190;I have created a Jira item so we fix this upgrade behaviour

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5173|https://cloudidentity.atlassian.net/browse/ISAMSUP-5173|smart-link] ","23/Jun/23 7:24 PM;6154906364ff01007106e189;Thank you Peter for you feedback & comments. To update further from TS013366346, Gary Vacek very kindly (+ thank you too) via some unix script magic listed the the KDB files from 13 of the 25 appliances which require pre-upgrade remediation.

KBC then put forward the following remedial actions i.e.

{{To end up in a good environment we probably better update all key stores to get rid of the kdb file?}}
{{Or will they eventually truly automagically disappear?}}
{{Current options are;}}
{{updating the kdb (add cert, deploy, delete cert)}}
{{re-uploading the key store with a different name, deploy, rename and deploy}}
{{deploy the proposed fixpack with a risk a more recent p12 is overwritten as the migration will happen again}}

To which I have replied back to KBC with the following;
"" Another more likely option from recent L3 finding is - by modifying pdjct_COMMBE4.p12 through the LMI, this will delete the pdjct_COMMBE4.kdb without the need of the fixpack. Is this possible to test on your side? ""

Awaiting to hear back from KBC.","23/Jun/23 7:42 PM;5b15d9517dab4c51f61b5190;I think my update p12 through lmi is the same as their {{updating the kdb (add cert, deploy, delete cert)}} option

it just its really updating the p12, not the kdb - but I think that kdb in this context just means keystore

FYI

I tried export keystore, delete keystore, import keystore

The import also removed the kdb file of the same name","27/Jun/23 5:17 PM;6154906364ff01007106e189;FYI - waiting to hear back from customer as they had to postpone their upgrade due to a “incompatible application issue” found, which they need to resolve, prior.","03/Jul/23 9:47 PM;6154906364ff01007106e189;Hi [~accountid:5b15d9517dab4c51f61b5190] update from customer, KBC;
” _The upgrade was deployed last weekend and all seems fine. We did a manipulation to the pdjct before the upgrade and that was sufficiënt. Thank you for the support._ “

Closing out this work item as SF case TS013366346 is now closed out as resolved.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Can't import html files anymore in to Management Root,ISAMSUP-5158,307759,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,oscar.jimen,6333216f748d1bfcb85982ca,oscar.jimen,6333216f748d1bfcb85982ca,21/Jun/23 12:54 AM,26/Jun/23 11:48 AM,14/Jul/23 2:47 PM,26/Jun/23 11:48 AM,,,,0,,,,"*Problem Description:*
Hello, When we try to import an html file in webseal under management root, we can get an error which says ""System error The uploaded file is not of the correct type"". Uploading html files worked fine before, I am thinking it might be related to the upgrade from 10.0.3 to 10.0.5?



From L2: I tested to upload the file and into my ISVA test, and it was successfully able to upload the file.

HTML file from the customer:

[2023-06-07/login.html|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013255610&path=TS013255610/2023-06-07/&filepath=TS013255610/2023-06-07/login.html]

Video record of the customer showing the import HTML error.

[2023-06-13/html_import_error.mp4|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013255610&path=TS013255610/2023-06-13/&filepath=TS013255610/2023-06-13/html_import_error.mp4]



HAR file collected:

[2023-06-15/ttnweb9dev3mgt_Archive_23-06-15_14-04-15_.har|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013255610&path=TS013255610/2023-06-15/&filepath=TS013255610/2023-06-15/ttnweb9dev3mgt_Archive_23-06-15_14-04-15_.har]

I found the following error on the HAR file:



HTTP/1.1 *400 Bad Request*

X-FRAME-OPTIONS: SAMEORIGIN

Cache-Control: no-cache, no-store

Content-Security-Policy: default-src 'self' 'unsafe-inline' 'unsafe-eval'

X-Content-Type-Options: nosniff

X-XSS-Protection: 1; mode=block

Pragma: no-cache

Content-Type: text/html;charset=utf-8

Content-Language: en-US

Strict-Transport-Security: max-age=31536000; includeSubDomains

Connection: *Close*

Date: Thu, 15 Jun 2023 18:04:00 GMT

Content-Length: 104



<html><body><textarea>{""*error*"":""T*he uploaded file is not of the correct type*.""}</textarea></body></html>

Suggestion that I did with the customer:

Did you try to copy your HTML code, paste it into a new notepad, and save it with a .html extension? And then try to upload again?

Customer response: “Copying the HTML into a new file did not seem to work. We still encounter the same error.”

# Try to upload the file into another file location to see if you receive the same error message?

for instance, uploading the file into the file *bu* instead of *bu_orig*

# Try to rename the file and upload the file 

*bu_orig*? Let me know the result. If the result is the same, try to upload the renamed file into the *BU* file, and let me know the result.

# As far as I can see from the video, you are trying to upload the file from the Shared file system. Can you save the 

*login.html* into your computer, connect to LMI, and then upload the file importing from your computer, not from the shared file system?

Customer response: “We are getting the same result for all 3 of your suggestions.“



# From where browser name did you try to upload the file?

# Try to connect to LMI from another browser to check for any difference when uploading the file.

# Try connecting to LMI from incognito windows/private mode. And let me know the result.

Customer response:

# From where browser name did you try to upload the file?

*Mozilla Firefox*

# Try to connect to LMI from another browser to check for any difference when uploading the file.

*Tried with Google Chrome and Edge but got the same result.*

# Try connecting to LMI from incognito windows/private mode. And let me know the result.

*Got the same result with incognito mode.*",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24/Jun/23 3:59 AM;6333216f748d1bfcb85982ca;image-20230623-175618.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208217,24/Jun/23 3:59 AM;6333216f748d1bfcb85982ca;image-20230623-175722.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208216,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013255610,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,oscar.jimen,6333216f748d1bfcb85982ca,,,,STATE OF NEW JERSEY | Deep Puri,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cw4n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-21 00:49:36.097,,,,,21/Jun/23 10:49 AM;5b15d954b0d76456f36daf33;This looks like is a regression introduced by the fix for IJ40285 but subsequently fixed in IJ45430,"21/Jun/23 11:18 AM;5c53d3ac23f5bf672621c868;[~accountid:6333216f748d1bfcb85982ca] 



seems similar to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4977|https://cloudidentity.atlassian.net/browse/ISAMSUP-4977|smart-link] 

10.0.6.0 is available now",21/Jun/23 11:25 AM;5b15d954b0d76456f36daf33;[~accountid:6333216f748d1bfcb85982ca]  Can they upgrade to 10.0.6.0?,"24/Jun/23 3:59 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d954b0d76456f36daf33]  It came to my mind to try this alternative way:

1.Please go to Manage Reverse proxy Management Root.

2.Select the folder you want to add/have the login.html file.

3.Once the folder is selected> click File>New>File

!image-20230623-175618.png|width=360,height=253!

4.On the windows displayed, add the Name: Login.html (add the extension) and New File Contents (Optional): paste the de HTML code.

save.

!image-20230623-175722.png|width=651,height=552!

*Reply from the customer:* “Oscar,This appears to have been successful in adding the file. Thanks, Jordan”



Now, checking with customer if he wants to upgrade to 10.0.6? Once I received a comment from the customer I’ll let you know. thx ","26/Jun/23 11:48 AM;5b15d954b0d76456f36daf33;[~accountid:6333216f748d1bfcb85982ca] that sounds like they have a viable workaround. Plus the fix is available in the latest version.

Based on those two, I think it is safe to close this item. Let me know if there is anything else.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Delete on AUTH_SVC_SESSION_CACHE Error Msg = ORA-01795:,ISAMSUP-5156,307696,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,20/Jun/23 8:58 PM,01/Jul/23 7:37 AM,14/Jul/23 2:47 PM,,,Support,22/Jun/23 12:00 AM,0,,,,"Customer is attempting a delete operation on their AUTH_SVC_SESSION_CACHE i.e. “267737 of which 254917 are expired”. So having 250K + values, the query ends up to be to long and gives a parse exception i.e.

~[6/14/23 11:39:59:024 CEST] 00000047 e.commands.StartSessionCleanupThreadCmd$SessionCleanupThread I java.sql.SQLSyntaxErrorException: ORA-01795: maximum number of expressions in a list is 1000~
~Caused by: Error : 1795, Position : 6947, Sql = DELETE FROM AUTH_SVC_SESSION_CACHE WHERE STATE_ID IN (:1 , :2 , :3 ,~ 
…………………………………………………………………… 
~?, ?, ?, ?, ?), Error Msg = ORA-01795: maximum number of expressions in a list is 1000~
	~at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:498)~
	~... 22 more~",,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013318196 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,CREDITO EMILIANO S.P.A.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013318196&path=TS013318196%2F2023-06-14%2F&filepath=TS013318196%2F2023-06-14%2Fmessages-11.log,,,,,,,,,,,,,,,,,,,,,,,0|i1cvqv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-06-21 02:06:49.15,,,,,"20/Jun/23 9:16 PM;6154906364ff01007106e189;I asked customer for more information and if possible a support file, with traces. Customer provided the following;

 _I can't provide a support file from affected ISVA because I do not have the error anymore. To prevent the HVDB from getting too big we have truncated the table AUTH_SVC_SESSION_CACHE and restarted the system. It is a production env so, in any case, we cannot turn the traces on. What happened in detail is as follows;_

{noformat} 1- at night our oracle HVDB had a disk error and went out of service for some 10 minutes.
 2- the database recovered but the primary master server did not clean the connection pool and kept on performing the delete queries on broken connection, they all failed. 
 3- when we restarted the federation runtime on the following morning deletes started again, but AUTH_SVC_SESSION_CACHE had 30000 record expired and to be deleted.Also the OAUTH_TOKEN_CACHE and OAUTH_TOKEN_CACHE_ATTRIBUTES had many records expired.
 4- ISAM successfully deleted OAUTH_TOKEN_CACHE and OAUTH_TOKEN_CACHE_ATTRIBUTES.
 5- ISAM then tried to delete the AUTH_SVC_SESSION_CACHE records all at once. This did not work but even if it did it could have given problems while performing a big transaction.{noformat}

_I suppose ISAM should create and execute delete sql statement against oracle built on some IDS and not all. The other tables, OAUTH_TOKEN_CACHE for example, work this way. This means that if it have to delete 10000 records from the AUTH_SVC_SESSION_CACHE it should do it some records at a time. With a lazy process. As we are planning to upgrade soon, are these problems fixed in 10.0.5 or 10.0.6?_


Researching the "" Error Msg = ORA-01795: maximum number of expressions in a list is 1000 "" I have come across 2 other cases that are ongoing with related L3 Jira work items assigned i.e. links provided above near subject summary description. Seeking L3 peer review, as well as possible duplication check on this SF case TS013318196 issue.","21/Jun/23 12:06 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:6154906364ff01007106e189] - the end symptom is the same and the resolution may be very similar - but these are all different issues in the sense they they are different functional (and code) flows and impact different tables in the DB. 

[~accountid:5b15d94b6256d01ad54eb020] can you please take a look at this one and see if we can put in a similar change as [https://cloudidentity.atlassian.net/browse/ISAMSUP-4421|https://cloudidentity.atlassian.net/browse/ISAMSUP-4421|smart-link]  - or even better - a common change - to fix these issues? Thanks. ",21/Jun/23 11:31 PM;5b15d94b6256d01ad54eb020;The two older work items mentioned do appear to be related to this. I’m almost done with a code change to help resolve that.,26/Jun/23 9:35 PM;6154906364ff01007106e189;Just to update customer has upgraded their Dev environment to 10.0.6 and shortly same to their Test env. So are enquiring will the change/fix planned for this issue also be available for 10.0.6.,"27/Jun/23 3:47 AM;5b15d94b6256d01ad54eb020;[~accountid:6154906364ff01007106e189] Does the customer have a test environment where they have recreated the issue?    I’m almost done with this but I don’t have an oracle db so I cannot test it. 

I should have a fix pack for them in a couple of days .","28/Jun/23 9:04 PM;6154906364ff01007106e189;[~accountid:5b15d94b6256d01ad54eb020] FYI re customer reply on testing is as follows; 

"" _I can't easily recreate this problem. I suppose I should turn off the primary master. Run a stress test to issue some ten thousand tokens and then again when the db has a lot of expired things to delete turn on the master again. But now I'm in the middle of an upgrade to 10.0.6 so I could manage to do this on this latest version if as I understand that it is affected from this bug too. So if the fix is also for 10.0.6 I can try to recreate this problem and see if it works fine. But I can probably do this no sooner than August._ ""","01/Jul/23 7:37 AM;5b15d94b6256d01ad54eb020;Here are the fix packs for this issue:  Please test the installation prior to sending it out.  

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5200|https://cloudidentity.atlassian.net/browse/ISAMSUP-5200|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
discrepancy in the timing of statistics sent to statsd,ISAMSUP-5155,307688,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,20/Jun/23 7:20 PM,06/Jul/23 4:59 PM,14/Jul/23 2:47 PM,,,,,0,,,,"Customer has reported that its sending statistics about pdweb.threads to both rsyslog server and to statsd and they don’t see matching values.

customer provided a picture showing difference



S:\sf\TS013\216\TS013216787\2023-06-05\



L2 has its own recreate and from my recreate its the statsd  stats collection of pdweb.threads is not what that does an exact match for a file based stats collector

10.0.5.0 IF1

{noformat} /usr/sbin/mesa_control fixpack_get_history
Thursday, April 27, 2023 at 9:11:55 PM|10.0.5.0_IF1|10.0.5.0_IF1|Yes|Installed|This fixpack contains security and defect fixes for IBM Security Verify Access. Applying it will reboot the appliance.|1682593915
{noformat}",,Nick Lloyd,,,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,20/Jun/23 7:31 PM;tushar.prasad;pdweb.statsd.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/207318,20/Jun/23 7:31 PM;tushar.prasad;stats.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/207317,20/Jun/23 7:31 PM;tushar.prasad;webseald-default.conf;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/207319,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013216787,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cvp3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-21 03:36:46.188,,,,,"20/Jun/23 7:32 PM;5c53d3ac23f5bf672621c868;I did a recreate in my env

local configuration

[^webseald-default.conf]

* logged pdweb.threads into a file 
* also enabled pdweb.statsd
* Here are the entries in pdweb.statsd trace.log
* {noformat}2023-06-20-15:41:50.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:42:00.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:42:00.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:42:10.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:42:10.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:42:10.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.threads.active:5|g

2023-06-20-15:42:21.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:42:21.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:42:31.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:42:31.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:42:31.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.threads.active:0|g

2023-06-20-15:42:41.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:42:41.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:42:41.001+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.threads.active:60|g

2023-06-20-15:42:52.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:42:52.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:43:02.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:43:02.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:43:13.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:43:13.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:43:24.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:43:24.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:43:35.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:43:35.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:43:46.003+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:43:46.003+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:43:57.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-20-15:43:57.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:43:57.001+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.threads.active:58|g
{noformat}
* against the configuration( I will attach the conf from local recreate)
* {noformat}[statistics]

# The server name or IP address on which the statsd server is listening for
# requests. The generation of statistics will only occur if this entry has
# been set.
server = 9.30.92.253

# The port on which the statsd server is listening for requests.
port = 8125

# The frequency (in seconds) that statistics are sent from the memory buffer
# to the statsd server.  The minimum value for this configuration entry is 1,
# indicating that statistics would be sent every second.
frequency = 10

# The name of a statistical component which is to be enabled.  Statistics from
# enabled components will be sent to the statsd server.  For a list of
# available components please refer to the 'Sending Statistics to Statsd'
# topic in the auditing guide in the Knowledge Centre.
#
# This entry may be repeated multiple times, once for each component which is
# to be enabled.
#
# Example:
#  component = pdweb.https
component = pdweb.threads

# An optional prefix which will be prepended to the statistic component name
# when generating the name of the metric which is sent to the statsd server.
#
# Example:
#   prefix = instanceA.
prefix = default

# The redis stanza is used to define the Redis servers which can be used
# to store remote session information.
{noformat}

[^pdweb.statsd.log]

If you observe the trace, 

from 15:41:50 to 15:43:57 

only 5 times stats were sent and as per the configuration it should have been every 10 seconds.

It seems there is some kind of loop going on wherein its not able to send stats every 10 seconds.

repeating pattern

2023-06-20-15:41:50.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-20-15:42:00.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
202



If you observe local file stats collection 

{noformat}stats = pdweb.threads 10
logcfg = stats.pdweb.threads:file path=stats.log,rollover=-1,log_id=stats,buffer_size=65536,queue_size=48,max_rollover_files=7{noformat}

It correctly logs the stats

from 15:41:50 to 15:41:57



{noformat}2023-06-20-15:41:50.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:41:50.000+08:00I----- pdweb.threads active	 : 0
2023-06-20-15:41:50.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:41:50.000+08:00I----- pdweb.threads 'default' active	 : 0
2023-06-20-15:41:50.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:42:00.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:42:00.000+08:00I----- pdweb.threads active	 : 0
2023-06-20-15:42:00.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:42:00.000+08:00I----- pdweb.threads 'default' active	 : 0
2023-06-20-15:42:00.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:42:10.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:42:10.000+08:00I----- pdweb.threads active	 : 5
2023-06-20-15:42:10.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:42:10.000+08:00I----- pdweb.threads 'default' active	 : 5
2023-06-20-15:42:10.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:42:20.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:42:20.000+08:00I----- pdweb.threads active	 : 5
2023-06-20-15:42:20.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:42:20.000+08:00I----- pdweb.threads 'default' active	 : 5
2023-06-20-15:42:20.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:42:30.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:42:30.000+08:00I----- pdweb.threads active	 : 0
2023-06-20-15:42:30.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:42:30.000+08:00I----- pdweb.threads 'default' active	 : 0
2023-06-20-15:42:30.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:42:40.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:42:40.000+08:00I----- pdweb.threads active	 : 60
2023-06-20-15:42:40.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:42:40.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-06-20-15:42:40.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:42:50.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:42:50.000+08:00I----- pdweb.threads active	 : 58
2023-06-20-15:42:50.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:42:50.000+08:00I----- pdweb.threads 'default' active	 : 58
2023-06-20-15:42:50.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:43:00.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:43:00.000+08:00I----- pdweb.threads active	 : 59
2023-06-20-15:43:00.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:43:00.000+08:00I----- pdweb.threads 'default' active	 : 59
2023-06-20-15:43:00.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:43:10.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:43:10.000+08:00I----- pdweb.threads active	 : 60
2023-06-20-15:43:10.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:43:10.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-06-20-15:43:10.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:43:20.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:43:20.000+08:00I----- pdweb.threads active	 : 60
2023-06-20-15:43:20.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:43:20.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-06-20-15:43:20.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:43:30.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:43:30.000+08:00I----- pdweb.threads active	 : 59
2023-06-20-15:43:30.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:43:30.000+08:00I----- pdweb.threads 'default' active	 : 59
2023-06-20-15:43:30.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:43:40.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:43:40.000+08:00I----- pdweb.threads active	 : 60
2023-06-20-15:43:40.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:43:40.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-06-20-15:43:40.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:43:50.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:43:50.000+08:00I----- pdweb.threads active	 : 60
2023-06-20-15:43:50.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:43:50.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-06-20-15:43:50.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-06-20-15:44:00.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-06-20-15:44:00.000+08:00I----- pdweb.threads active	 : 60
2023-06-20-15:44:00.000+08:00I----- pdweb.threads total	 : 1201
2023-06-20-15:44:00.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-06-20-15:44:00.000+08:00I----- pdweb.threads 'default' total{noformat}

[^stats.log]



could you check why statsd is not able to send the events at the supposed frequency? and whether it will lead issues in statds as obviously when do a comparison , statsd will be missing events as these were not sent every 10 seconds.","21/Jun/23 1:36 PM;5b232b2fd85e5b59b066f57f;[~accountid:5c53d3ac23f5bf672621c868] - I’m not sure I fully follow. 

Looking at your trace, I see stats being sent every 10s (i.e. “Sending the list of statsd events.”) which matches the configured frequency. I see 13 occurrences between 15:41:50 to 15:43:57 which is what I would expect. Am I missing something here? 

Note that the “frequency” represents the wait time between the end of one iteration of sending statsd events and the start of the next rather than the time between the start of one iteration and the start of the next. Due to time required to execute the actual operations, the start time of each iteration will gradually drift over time. This is expected. 

For my reference: i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:280",21/Jun/23 1:45 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] is there a reason it’s logged only 5 times?,"21/Jun/23 2:43 PM;5b232b2fd85e5b59b066f57f;Thanks [~accountid:5c53d3ac23f5bf672621c868] for Slack conversation. 

From our discussion, I now understand that the issue is that the actual stats are only being logged intermittently. 

Is this specific to only thread stats - or other stats as well? ","21/Jun/23 3:03 PM;5b232b2fd85e5b59b066f57f;For my reference: 

i4w/pdweb/webseald/ras/stats/ws_stats_threads.cpp:298

possible that already initialised and therefore returning prematurely?","21/Jun/23 6:41 PM;5c53d3ac23f5bf672621c868;I set pdweb.https which seems to be okay

{noformat}023-06-21-16:36:19.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:36:19.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:36:19.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:1032|ms|@0.00
defaultpdweb.https.process.time:1031|ms|@0.00
defaultpdweb.https.reqs:374|c

2023-06-21-16:36:29.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:36:29.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:36:29.001+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:1346|ms|@0.00
defaultpdweb.https.process.time:1345|ms|@0.00
defaultpdweb.https.reqs:621|c

2023-06-21-16:36:39.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:36:39.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:36:39.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:584|ms|@0.00
defaultpdweb.https.process.time:583|ms|@0.00
defaultpdweb.https.reqs:992|c

2023-06-21-16:36:49.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:36:49.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:36:49.001+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:529|ms|@0.00
defaultpdweb.https.process.time:529|ms|@0.00
defaultpdweb.https.reqs:1155|c

2023-06-21-16:37:00.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:37:00.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:37:00.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:390|ms|@0.00
defaultpdweb.https.process.time:389|ms|@0.00
defaultpdweb.https.reqs:540|c

2023-06-21-16:37:10.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:37:10.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:37:10.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:357|ms|@0.04
defaultpdweb.https.process.time:356|ms|@0.04
defaultpdweb.https.reqs:27|c

2023-06-21-16:37:20.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:37:20.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:37:20.001+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:13737|ms|@0.03
defaultpdweb.https.process.time:13736|ms|@0.03
defaultpdweb.https.reqs:40|c

2023-06-21-16:37:31.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:37:31.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:37:31.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:10538|ms|@0.01
defaultpdweb.https.process.time:10537|ms|@0.01
defaultpdweb.https.reqs:112|c

2023-06-21-16:37:41.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:37:41.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:37:41.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:5041|ms|@0.00
defaultpdweb.https.process.time:5040|ms|@0.00
defaultpdweb.https.reqs:234|c

2023-06-21-16:37:51.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:37:51.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:37:51.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:303|ms|@0.00
defaultpdweb.https.process.time:302|ms|@0.00
defaultpdweb.https.reqs:1995|c

2023-06-21-16:38:01.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:38:01.001+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:38:01.001+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:246|ms|@0.00
defaultpdweb.https.process.time:246|ms|@0.00
defaultpdweb.https.reqs:2383|c

2023-06-21-16:38:12.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:38:12.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:38:12.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:254|ms|@0.00
defaultpdweb.https.process.time:253|ms|@0.00
defaultpdweb.https.reqs:2554|c

2023-06-21-16:38:22.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:38:22.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-06-21-16:38:22.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:277|ms|@0.00
defaultpdweb.https.process.time:276|ms|@0.00
defaultpdweb.https.reqs:2165|c

2023-06-21-16:38:32.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-06-21-16:38:32.000+08:0{noformat}","21/Jun/23 6:44 PM;5c53d3ac23f5bf672621c868;I am checking statsd

whether there would be a different interpretation of 

* c → counters
* g → gauges","26/Jun/23 3:56 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] 

Is the counter and gauge collection causing an issue? I suppose they should be sent regularly to the statsd","03/Jul/23 12:15 PM;5b232b2fd85e5b59b066f57f;Yes - it is likely because it is set as a gauge rather than a count. 

Comment from code (for my ref: AMWStatsdMgr.hpp:Gauge)

{noformat}    /** \class Gauge
     * 
     * The following class is used to manage a guage statistic.  It will
     * maintain a copy of the prior value to ensure that we only send the
     * statistical information if the value actually changes.
     */{noformat}

Looking at the values of statsd vs. local file logging from your example, this seems to be what is occuring. There are a few discrepancies, but I suspect because the times don’t align 100% there could be slight variations. ","03/Jul/23 2:07 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] 

right . At present the gauge doesn’t seem to send the data as rsyslog (every 10 seconds) 



do we need to change it to counts?","03/Jul/23 2:20 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] 



In the document it says this



[https://github.com/statsd/statsd/blob/master/docs/metric_types.md|https://github.com/statsd/statsd/blob/master/docs/metric_types.md|smart-link] 

StatsD also supports gauges. A gauge will take on the arbitrary value assigned to it, and will maintain its value until it is next set.

{noformat}gaugor:333|g
{noformat}

If the gauge is not updated at the next flush, it will send the previous value. You can opt to send no metric at all for this gauge, by setting {{config.deleteGauges}}



I am not sure. but I am hoping there is a setting to send even when the value hasn’t changed.



[https://github.com/micrometer-metrics/micrometer/issues/403|https://github.com/micrometer-metrics/micrometer/issues/403|smart-link] ","03/Jul/23 2:50 PM;5c53d3ac23f5bf672621c868;IF we can do something like this

*publishUnchangedMeters*",03/Jul/23 5:23 PM;5b232b2fd85e5b59b066f57f;[~accountid:5c53d3ac23f5bf672621c868] - No - I don’t think that will work. The behaviour is due to our code (ref: AMWStatsdMgr.cpp:addGauge(…) { … value.get(…) - i.e. the event is only added if the value has changed). I think I can see how to change this behaviour - however the real question is why we are are doing it in this manner. I’ll need to understand this before changing the behaviour. ,"04/Jul/23 12:32 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] 

There are few questions I am trying to find an answer to (seems my lab env went down. I am tyring to get it up. by any chance do you have a statsd setup)

1.when guage data is sent, is it still accurately done as pdweb.threads to remote ryslog?

2.when guage data is sent to statsd(since its not sent at regular internal) whether any aggregation is done by the statsd?

[3.Is|http://3.Is] guage a right metric for pdweb.threads?","04/Jul/23 1:14 PM;5b232b2fd85e5b59b066f57f;[~accountid:5c53d3ac23f5bf672621c868] - no, I don’t have a statsd set up in the lab. 

Answers to your questions: 

# From what I can see - yes, it is accurate. The small discrepancies that can be seen in your example can be put down to the fact that the timing between the syslog and statsd logging is slightly different due to time drift (i.e. the time between one log entry and the next can vary as it includes the frequency + the time required to do the work). 
# No aggregation occurs based on what I can see in the code. 
# Unknown - discussing with development as to why we are using gauge in this case. ","05/Jul/23 4:18 PM;5c53d3ac23f5bf672621c868;I did some data comparison



--the below is few instance of stats.log(logcfg entry for pdweb.threads)

{noformat}2023-07-05-10:23:10.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-07-05-10:23:10.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-07-05-10:23:20.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-07-05-10:23:20.000+08:00I----- pdweb.threads active	 : 59
2023-07-05-10:23:20.000+08:00I----- pdweb.threads total	 : 1201
2023-07-05-10:23:20.000+08:00I----- pdweb.threads 'default' active	 : 59
2023-07-05-10:23:20.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-07-05-10:23:30.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-07-05-10:23:30.000+08:00I----- pdweb.threads active	 : 60
2023-07-05-10:23:30.000+08:00I----- pdweb.threads total	 : 1201
2023-07-05-10:23:30.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-07-05-10:23:30.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-07-05-10:23:40.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-07-05-10:23:40.000+08:00I----- pdweb.threads active	 : 60
2023-07-05-10:23:40.000+08:00I----- pdweb.threads total	 : 1201
2023-07-05-10:23:40.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-07-05-10:23:40.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-07-05-10:23:50.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-07-05-10:23:50.000+08:00I----- pdweb.threads active	 : 58
2023-07-05-10:23:50.000+08:00I----- pdweb.threads total	 : 1201
2023-07-05-10:23:50.000+08:00I----- pdweb.threads 'default' active	 : 58
2023-07-05-10:23:50.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-07-05-10:24:00.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-07-05-10:24:00.000+08:00I----- pdweb.threads active	 : 59
2023-07-05-10:24:00.000+08:00I----- pdweb.threads total	 : 1201
2023-07-05-10:24:00.000+08:00I----- pdweb.threads 'default' active	 : 59
2023-07-05-10:24:00.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-07-05-10:24:10.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-07-05-10:24:10.000+08:00I----- pdweb.threads active	 : 59
2023-07-05-10:24:10.000+08:00I----- pdweb.threads total	 : 1201
2023-07-05-10:24:10.000+08:00I----- pdweb.threads 'default' active	 : 59
2023-07-05-10:24:10.000+08:00I----- pdweb.threads 'default' total	 : 1201
2023-07-05-10:24:20.000+08:00I----- HPDRA0387I   pdweb.threads statistics report
2023-07-05-10:24:20.000+08:00I----- pdweb.threads active	 : 60
2023-07-05-10:24:20.000+08:00I----- pdweb.threads total	 : 1201
2023-07-05-10:24:20.000+08:00I----- pdweb.threads 'default' active	 : 60
2023-07-05-10:24:20.000+08:00I----- pdweb.threads 'default' total	 : 1201{noformat}



below are the stats of pdweb.statsd

{noformat}2023-07-05-10:23:09.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:2933|ms|@0.01
defaultpdweb.https.process.time:2905|ms|@0.01
defaultpdweb.https.reqs:180|c
defaultpdweb.threads.active:60|g

2023-07-05-10:23:24.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:23:24.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:23:24.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:1335|ms|@0.00
defaultpdweb.https.process.time:1335|ms|@0.00
defaultpdweb.https.reqs:904|c

2023-07-05-10:23:39.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:23:39.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:23:39.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:449|ms|@0.00
defaultpdweb.https.process.time:448|ms|@0.00
defaultpdweb.https.reqs:2005|c

2023-07-05-10:23:54.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:23:54.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:23:54.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:378|ms|@0.00
defaultpdweb.https.process.time:378|ms|@0.00
defaultpdweb.https.reqs:2369|c

2023-07-05-10:24:09.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:24:09.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:24:09.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:362|ms|@0.00
defaultpdweb.https.process.time:362|ms|@0.00
defaultpdweb.https.reqs:2462|c

2023-07-05-10:24:24.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:24:24.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:24:24.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:327|ms|@0.00
defaultpdweb.https.process.time:327|ms|@0.00
defaultpdweb.https.reqs:2758|c

2023-07-05-10:24:39.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:24:39.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:24:39.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:304|ms|@0.00
defaultpdweb.https.process.time:304|ms|@0.00
defaultpdweb.https.reqs:2925|c

2023-07-05-10:24:54.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:24:54.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:24:54.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:272|ms|@0.00
defaultpdweb.https.process.time:272|ms|@0.00
defaultpdweb.https.reqs:3293|c
defaultpdweb.threads.active:58|g

2023-07-05-10:25:09.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:25:09.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:25:09.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:260|ms|@0.00
defaultpdweb.https.process.time:260|ms|@0.00
defaultpdweb.https.reqs:3437|c
defaultpdweb.threads.active:60|g

2023-07-05-10:25:24.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:25:24.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:25:24.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:256|ms|@0.00
defaultpdweb.https.process.time:255|ms|@0.00
defaultpdweb.https.reqs:3489|c
defaultpdweb.threads.active:59|g

2023-07-05-10:25:39.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:301: Generating the list of statsd events.
2023-07-05-10:25:39.000+08:00I----- thread(2) trace.pdweb.statsd:9 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:315: Sending the list of statsd events.
2023-07-05-10:25:39.000+08:00I----- thread(2) trace.pdweb.statsd:1 /build/isam/src/i4w/pdwebrte/webcore/AMWStatsdMgr.cpp:320: Sending the statsd events: defaultpdweb.https.worker.time:237|ms|@0.00
defaultpdweb.https.process.time:237|ms|@0.00
defaultpdweb.https.reqs:3759|c
defaultpdweb.threads.active:60|g{noformat}



The below is a data exprot(time zone is different but look at the values). could be an issue with statsd but I am not sure how does it aggregate

{noformat}stats.gauges.defaultpdweb.threads.active,2023-07-05 02:25:00,60.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:26:00,59.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:27:00,59.166666666666664
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:28:00,59.333333333333336
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:29:00,59.666666666666664
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:30:00,60.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:31:00,59.666666666666664
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:32:00,59.166666666666664
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:33:00,59.5
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:34:00,60.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:35:00,59.5
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:36:00,59.5
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:37:00,59.833333333333336
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:38:00,60.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:39:00,60.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:40:00,60.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:41:00,60.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:42:00,59.166666666666664
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:43:00,59.666666666666664
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:44:00,60.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:45:00,59.833333333333336
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:46:00,59.5
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:47:00,59.666666666666664
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:48:00,60.0
stats.gauges.defaultpdweb.threads.active,2023-07-05 02:49:00,60.0
{noformat}





Here is summary 



Timeline---pdweb.threads in stats.log                      timeline -- pdweb.statsd

# 10:23:10 → 60                                                        10:23:09 → 60
# 10:23:20 → 59                                                        10:24:54 → 58
# 10:23:40 → 60                                                         10:25:25 → 59
# 10.23:50 → 58                                                          10:25:39 → 60
# 10:24:00 → 59
# 10:24:10 → 59                  
# 10:24:10 → 59
# 10.24:20 → 60



from 10.23:10 → the values changed 5 times(from the previous values)



but there is no correlation of fixed pattern in case of pdweb.statsd .

so there can’t be any comparison between pdweb.threads collection via rsyslog and pdweb.statsd collection? 

can’t be used to compare at all , 

this brings to my last question which you are working with dev team

1.Does dev expect customer to compare two methods of stats collection? definitely they are not going to match. They may give an indication of usage not but a match?



for statsd, there seems there is no fixed interval when stats will be sent. and whenever the stats is sent may not necessarily be the stat at that instant","06/Jul/23 1:02 PM;5b232b2fd85e5b59b066f57f;[~accountid:5c53d3ac23f5bf672621c868] - can you clarify the following from your last post? 

# I’m assuming that the “stats.gauges.defaultpdweb” trace is what is being logged on the statsd server and “{{trace.pdweb.statsd}}"" is what is logged on the ISVA instance over the same period (understanding there is a potential discrepancy in timezones)? 

If so: 

# It seems that even though ISVA is configured to generate stats every 15 sec(?), regardless of how often we send the stats the statsd server is only logging every minute? 
# I suspect that the decimal values on the statsd side is something to do with the statsd server config - potentially the fact it looks like it is configured to only log every minute; it is probably giving the average value for that period (1m) based on the data sent from ISVA. From ISVA, we only ever send whole integer values. 

I believe that all of this is working as intended / expected. Because the statsd implementation is using a gauge mechanism, ISVA will only send the stats when they change from the previous value. I’m not an expert in statsd servers - but there may be some config on statsd server side to tell it to log regardless - and it looks like there must also be a setting on the statsd server side to tell it how frequently to log given in your last example it is logging every minute regardless of what ISVA is sending. It is also worth keeping in mind that from an ISVA perspective, statsd is a different implementation and will be executed under a different worker thread to the syslog / local pdweb.thread stat tracing, so the threads may initiate at slightly different times and therefore report slightly different values (again - explaining the discrepancy in your last post). ","06/Jul/23 1:47 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] 

there is no timezone difference .



pdweb.threads → stats is logged into the appliance

trace.pdweb.statsd → is also from same appliance 



I believe the guage collection should be changed to counters , unless there is some benefit by setting pdweb.threads collection as Guage (Guage doesn’t seem to be able to give an instantaneous stats)

From the use case of how pdweb.threads is observed, any customer will need a value at that instance and able to plot against time. 

From Support point , we also need some time match so that we can say from these statistics that thread usage at this time was this (as thread usage may fluctuate)



The pain point here is:

Customer has a means to determine what was thread count using pdweb.threads stats or stats get, which obviously can never be accurately reported by statsd(there will always be mismatch)

Is that good enough to change it from Guage to Counters?",06/Jul/23 2:11 PM;5b232b2fd85e5b59b066f57f;Where/what is {{stats.gauges.defaultpdweb.threads.active}}? I assume this is the logging on the statsd server side? Why is it logging every minute? How is this configured? What happens if you change this to log / flush at the same frequency as set on ISVA? ,"06/Jul/23 4:33 PM;5c53d3ac23f5bf672621c868;[~accountid:5b232b2fd85e5b59b066f57f] 

can we just ignore what its doing on statsd or how graphite /statsd reports it. ([https://cloudidentity.atlassian.net/browse/ISAMSUP-5155?focusedCommentId=676289|https://cloudidentity.atlassian.net/browse/ISAMSUP-5155?focusedCommentId=676289|smart-link] )



Instead, see what and how its sent from ISVA? I need a way to tell accurately that if at 10:30:00 , I ran a pdweb.threads stats get  to get a value.

from pdweb.statsd can we get the same value at ( I know we can’t when we use guage to report it . do we need it to change to counter? ) if  we are not considering the change. then I will just let customer know that guage is the way it will be reported and they can expect some deviation because this is how guage report works.



why Gauge reporting is most suitable? Is counter going to give a more accurate reporting of pdweb.threads when statsd is used?","06/Jul/23 4:59 PM;5b232b2fd85e5b59b066f57f;Sorry [~accountid:5c53d3ac23f5bf672621c868] - I’m struggling a little to understand what the issue is here. Is it simply that the values differ and this is what the customer is questioning? 

Values reported - whether to statsd or local / rsyslog are accurate. Neither is more accurate than the other.

The reason the values differ slightly is because:

1. The work is triggering at slightly different times - i.e. the local / rsyslog stats are triggering at a different time to when the statsd stats are triggering. You can see this from your trace. These are different implementations and being executed by different worker threads in ISVA. This is somewhat out of our control as it is dependent on thread startup from the parent process. 

2. statsd server appears to flush/log at certain intervals (I assume this can be configured on the statsd server) - this will effectively average the values that have been sent to statsd over that period - potentially resulting in decimal values and values which appear to differ from local / rsyslog stats. Again, you can see this from your trace. 

Because the statsd implementation is using a gauge mechanism, we only send the data when the data changes. We use a gauge mechanism as this represents a point in time and is more appropriate for reporting currently active threads; whereas count is the sum of those values during the given period (in our case “frequency”) and would therefore not serve our purposes. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Unable to fetch the user list via SCIM (/scim/Users) endpoint,ISAMSUP-5153,307679,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,20/Jun/23 4:36 PM,12/Jul/23 8:52 PM,12/Jul/23 8:50 PM,,,Support,,0,,,,"Hi Team, 

# I have a customer who is trying to fetch the User list by calling (/scim/Users) but unable to do so. Although they are able to perform other operations like (/scim/Users/{id}) . 

2.  I have tried to reproduce the issue in my local lab setup but it works fine for me and am able to fetch the  list. So am unable to reproduce.

3. They see the below error while calling the API via postman - 

[https://10.106.33.70:443/scim/Users|https://10.106.33.70/scim/Users]

{

""schemas"": [

*""urn:ietf:params:scim:api:messages:2.0:Error""*

],

*""status"": ""500""*

}

4. I checked the Trace log and found that SCIM is able to fetch the list of users but somehow unable to display it.

*##This call has found the Users* 

*com.ibm.isam.scim.common.LdapHandler                         < findMatchingResources RETURN* [ [users, users, users, users, ecomdevwpsbind, PGTest01, PGTest02, ecomdevisam, users, users, users, users, SITwpsbind, PGTest01, PGTest02, SITisam, users, users, users, users, CERTwpsbind, PGTest01, PGTest02, CERTisam, users, users, users, users, PPRDwpsbind, PGTest01, PGTest02, PPRDisam, PPRDisam, sec_master, ivmgrd/master, users, moayasartstusr1, ECOM-DEV-webseald/KECMSHR1ISAM01, ECOM_FT-webseald/KECMSHR1ISAM01, ECOM_SIT-webseald/KECMSHR1ISAM01, CommonWPS-webseald/KECMSHR1ISAM01, 

*##But it fails on this call - Unable to return the search result - Null pointer Exception*

000000a8 id=00000000 com.ibm.isam.scim.transaction.TransactionScimlet             < search RETURN
6421      [6/20/23 9:05:19:126 AST] 000000a8 id=00000000 *SystemErr                                                    R java.lang.NullPointerException*



*##Below is the Log*

6374      [6/20/23 9:05:18:534 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                > setUserHeaders(HttpServletRequest, Connection) ENTRY
6375      [6/20/23 9:05:18:544 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                > setRequestAttributes(HttpServletRequest, Connection, String) ENTRY
6376      [6/20/23 9:05:18:544 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                > getAdminGroup(Connection, String) ENTRY
6377      [6/20/23 9:05:18:544 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                1 Admin group not in cache.
6378      [6/20/23 9:05:18:546 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                < getAdminGroup(Connection, String) RETURN adminGroup
6379      [6/20/23 9:05:18:546 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                > getDbBoolean(HttpServletRequest, String, ScimContextDataCache, String, Connection) ENTRY ENABLE_TAI
6380      [6/20/23 9:05:18:546 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                1 Not in cache
6381      [6/20/23 9:05:18:548 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                < getDbBoolean(HttpServletRequest, String, ScimContextDataCache, String, Connection) RETURN true
6382      [6/20/23 9:05:18:548 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                > getRequiredAttrs(HttpServletRequest, Connection, String) ENTRY
6383      [6/20/23 9:05:18:548 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                1 Required attributes not in cache.
6384      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                < getRequiredAttrs(HttpServletRequest, Connection, String) RETURN
6385      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                > setIvCredAttributes(HttpServletRequest, Map<String, Object>, Set<String>, String) ENTRY adminGroup
6386      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                > getCred(HttpServletRequest) ENTRY
6387      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                < getCred(HttpServletRequest) RETURN
6388      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                < setIvCredAttributes(HttpServletRequest, Map<String, Object>, Set<String>, String) RETURN
6389      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                1 Set scim-user : easuser
6390      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                1 Add request attribute : scim-user : easuser
6391      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                > getIsAdmin(HttpServletRequest, String, Boolean) ENTRY adminGroup
6392      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                1 Using native groups
6393      [6/20/23 9:05:18:549 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                < getIsAdmin(HttpServletRequest, String, Boolean) RETURN true
6394      [6/20/23 9:05:18:550 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                1 Add request attribute : is-scim-administrator : true
6395      [6/20/23 9:05:18:550 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                < setRequestAttributes(HttpServletRequest, Connection, String) RETURN
6396      [6/20/23 9:05:18:550 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                < setUserHeaders(HttpServletRequest, Connection) RETURN
6397      [6/20/23 9:05:18:550 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                > getDbBoolean(HttpServletRequest, String, ScimContextDataCache, String, Connection) ENTRY ENABLE_AUTHZ_FILTER
6398      [6/20/23 9:05:18:550 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                1 Not in cache
6399      [6/20/23 9:05:18:552 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                < getDbBoolean(HttpServletRequest, String, ScimContextDataCache, String, Connection) RETURN true
6400      [6/20/23 9:05:18:552 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimResourceServlet                        > checkAuthorization(HttpServletRequest) ENTRY
6401      [6/20/23 9:05:18:552 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimServlet                                1 Short circuit. Either is admin or is own data
6402      [6/20/23 9:05:18:552 AST] 000000a8 id=00000000 com.ibm.isam.scim.ScimResourceServlet                        < checkAuthorization(HttpServletRequest) RETURN true
6403      [6/20/23 9:05:18:554 AST] 000000a8 id=00000000 com.ibm.isam.scim.up.UserProfileScimlet                      > getLdapConnection() ENTRY
6404      [6/20/23 9:05:18:554 AST] 000000a8 id=00000000 com.ibm.isam.scim.up.UserProfileScimlet                      > getLdapConnection() ENTRY
6405      [6/20/23 9:05:18:555 AST] 000000a8 id=00000000 com.ibm.isam.scim.up.UserProfileScimlet                      < getLdapConnection() RETURN
6406      [6/20/23 9:05:18:555 AST] 000000a8 id=00000000 com.ibm.isam.scim.up.UserProfileScimlet                      < getLdapConnection() RETURN
6407      [6/20/23 9:05:18:565 AST] 000000a8 id=00000000 com.ibm.isam.scim.common.LdapHandler                         > findMatchingResources ENTRY dc=ecom.saudipayments,dc=com cn (&(|(objectclass=person)(objectclass=organizationalPerson)(objectclass=inetOrgPerson))(cn=*))
6408      [6/20/23 9:05:18:565 AST] 000000a8 id=00000000 com.ibm.isam.scim.common.LdapHandler                         > initialiseLdapContext() ENTRY
6409      [6/20/23 9:05:18:569 AST] 000000a8 id=00000000 com.ibm.isam.scim.common.LdapHandler                         < initialiseLdapContext() RETURN
6410      [6/20/23 9:05:18:627 AST] 000000a8 id=00000000 com.ibm.isam.scim.common.LdapHandler                         < findMatchingResources RETURN [users, users, users, users, ecomdevwpsbind, PGTest01, PGTest02, ecomdevisam, users, users, users, users, SITwpsbind, PGTest01, PGTest02, SITisam, users, users, users, users, CERTwpsbind, PGTest01, PGTest02, CERTisam, users, users, users, users, PPRDwpsbind, PGTest01, PGTest02, PPRDisam, PPRDisam, sec_master, ivmgrd/master, users, moayasartstusr1, ECOM-DEV-webseald/KECMSHR1ISAM01, ECOM_FT-webseald/KECMSHR1ISAM01, ECOM_SIT-webseald/KECMSHR1ISAM01, CommonWPS-webseald/KECMSHR1ISAM01, apiacq01, apiacq02, apiacq03, apiacq04, apiptsp01, apiptsp02, apiptsp03, apiptsp04, apipg01, apipg02, apipg03, apipg04, apipa01, apipa02, apipa03, apipa04, acqadmin01, acqoptmaker01, acqoptmaker02, acqoptchecker01, acqoptchecker02, acqadmin02, acqoptmaker03, acqoptchecker03, acqoptmaker04, acqoptchecker04, ptspadmin02, ptspopt03, ptspopt04, pgadmin02, pgopt03, pgopt04, pgopt01, pgopt02, pgadmin01, ptspadmin01, ptspopt01, ptspopt02, paadmin01, paoptmaker01, paoptmaker02, paoptchecker01, paoptchecker02, paadmin02, paoptmaker03, paoptmaker04, paoptchecker03, paoptchecker04, sitapiacq01, sitapiacq02, sitapiacq03, sitapiacq04, sitapiptsp01, sitapiptsp02, sitapiptsp03, sitapiptsp04, sitapipg01, sitapipg02, sitapipg03, sitapipg04, sitapipa01, sitapipa02, sitapipa03, sitapipa04, sitacqoptmaker01, sitacqoptmaker02, sitacqoptchecker01, sitacqoptchecker02, sitacqadmin02, sitacqoptmaker03, sitacqoptchecker03, sitacqoptmaker04, sitacqoptchecker04, sitptspadmin02, sitptspopt03, sitptspopt04, sitpgadmin02, sitpgopt03, sitpgopt04, sitpgopt01, sitpgopt02, sitpgadmin01, sitptspadmin01, sitptspopt01, sitptspopt02, sitpaadmin01, sitpaoptmaker01, sitpaoptmaker02, sitpaoptchecker01, sitpaoptchecker02, sitpaadmin02, sitpaoptmaker03, sitpaoptmaker04, sitpaoptchecker03, sitpaoptchecker04, sitacqadmin01, UMTestUser1, UMTestUser2]
6411      [6/20/23 9:05:18:627 AST] 000000a8 id=00000000 com.ibm.isam.scim.u2f.TokenScimlet                           > search ENTRY
6412      [6/20/23 9:05:18:633 AST] 000000a8 id=00000000 com.ibm.isam.scim.u2f.TokenScimlet                           < search RETURN
6413      [6/20/23 9:05:18:633 AST] 000000a8 id=00000000 com.ibm.isam.scim.OTPScimlet                                 > search ENTRY
6414      [6/20/23 9:05:18:636 AST] 000000a8 id=00000000 com.ibm.isam.scim.OTPScimlet                                 < search RETURN
6415      [6/20/23 9:05:18:636 AST] 000000a8 id=00000000 com.ibm.isam.scim.EndUserLicenceAgreementScimlet             > search ENTRY
6416      [6/20/23 9:05:18:638 AST] 000000a8 id=00000000 com.ibm.isam.scim.EndUserLicenceAgreementScimlet             < search RETURN
6417      [6/20/23 9:05:18:638 AST] 000000a8 id=00000000 com.ibm.isam.scim.mmfa.AuthenticatorScimlet                  > search ENTRY
6418      [6/20/23 9:05:18:639 AST] 000000a8 id=00000000 com.ibm.isam.scim.mmfa.AuthenticatorScimlet                  < search RETURN
6419      [6/20/23 9:05:18:639 AST] 000000a8 id=00000000 com.ibm.isam.scim.transaction.TransactionScimlet             > search ENTRY
6420      [6/20/23 9:05:18:641 AST] 000000a8 id=00000000 com.ibm.isam.scim.transaction.TransactionScimlet             < search RETURN
6421      [6/20/23 9:05:19:126 AST] 000000a8 id=00000000 SystemErr                                                    R java.lang.NullPointerException
6422      [6/20/23 9:05:19:127 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.isam.scim.IsamScimlet.search(IsamScimlet.java:357)
6423      [6/20/23 9:05:19:127 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.isam.scim.ScimResourceServlet.performQuery(ScimResourceServlet.java:302)
6424      [6/20/23 9:05:19:127 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.isam.scim.ScimResourceServlet.doGet(ScimResourceServlet.java:156)
6425      [6/20/23 9:05:19:127 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.isam.scim.ScimServlet.service(ScimServlet.java:159)
6426      [6/20/23 9:05:19:128 AST] 000000a8 id=00000000 SystemErr                                                    R 	at javax.servlet.http.HttpServlet.service(HttpServlet.java:791)
6427      [6/20/23 9:05:19:128 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1230)
6428      [6/20/23 9:05:19:128 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:729)
6429      [6/20/23 9:05:19:128 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:426)
6430      [6/20/23 9:05:19:128 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.invokeTarget(WebAppFilterChain.java:182)
6431      [6/20/23 9:05:19:129 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:93)
6432      [6/20/23 9:05:19:129 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.isam.core.security_filter.SecurityFilter.doFilter(SecurityFilter.java:235)
6433      [6/20/23 9:05:19:129 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:201)
6434      [6/20/23 9:05:19:129 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:90)
6435      [6/20/23 9:05:19:129 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.isam.core.tenant_filter.TenantFilter.doFilter(TenantFilter.java:262)
6436      [6/20/23 9:05:19:129 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:201)
6437      [6/20/23 9:05:19:130 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:90)
6438      [6/20/23 9:05:19:130 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:1001)
6439      [6/20/23 9:05:19:130 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1139)
6440      [6/20/23 9:05:19:130 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1010)
6441      [6/20/23 9:05:19:130 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleRequest(CacheServletWrapper.java:75)
6442      [6/20/23 9:05:19:131 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer40.servlet.CacheServletWrapper40.handleRequest(CacheServletWrapper40.java:83)
6443      [6/20/23 9:05:19:131 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:936)
6444      [6/20/23 9:05:19:131 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.webcontainer.osgi.DynamicVirtualHost$2.run(DynamicVirtualHost.java:279)
6445      [6/20/23 9:05:19:131 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink$TaskWrapper.run(HttpDispatcherLink.java:1141)
6446      [6/20/23 9:05:19:131 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink.wrapHandlerAndExecute(HttpDispatcherLink.java:422)
6447      [6/20/23 9:05:19:131 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink.ready(HttpDispatcherLink.java:381)
6448      [6/20/23 9:05:19:132 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.http.channel.internal.inbound.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:565)
6449      [6/20/23 9:05:19:132 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.http.channel.internal.inbound.HttpInboundLink.handleNewRequest(HttpInboundLink.java:499)
6450      [6/20/23 9:05:19:132 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.http.channel.internal.inbound.HttpInboundLink.processRequest(HttpInboundLink.java:359)
6451      [6/20/23 9:05:19:132 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.http.channel.internal.inbound.HttpInboundLink.ready(HttpInboundLink.java:326)
6452      [6/20/23 9:05:19:132 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.channel.ssl.internal.SSLConnectionLink.determineNextChannel(SSLConnectionLink.java:1100)
6453      [6/20/23 9:05:19:132 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.channel.ssl.internal.SSLConnectionLink.readyInboundPostHandshake(SSLConnectionLink.java:757)
6454      [6/20/23 9:05:19:133 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.channel.ssl.internal.SSLConnectionLink$MyHandshakeCompletedCallback.complete(SSLConnectionLink.java:427)
6455      [6/20/23 9:05:19:133 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.channel.ssl.internal.SSLUtils.handleHandshake(SSLUtils.java:954)
6456      [6/20/23 9:05:19:133 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.channel.ssl.internal.SSLHandshakeIOCallback.complete(SSLHandshakeIOCallback.java:85)
6457      [6/20/23 9:05:19:134 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.tcpchannel.internal.WorkQueueManager.requestComplete(WorkQueueManager.java:504)
6458      [6/20/23 9:05:19:134 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.tcpchannel.internal.WorkQueueManager.attemptIO(WorkQueueManager.java:574)
6459      [6/20/23 9:05:19:134 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.tcpchannel.internal.WorkQueueManager.workerRun(WorkQueueManager.java:958)
6460      [6/20/23 9:05:19:134 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.tcpchannel.internal.WorkQueueManager$Worker.run(WorkQueueManager.java:1047)
6461      [6/20/23 9:05:19:134 AST] 000000a8 id=00000000 SystemErr                                                    R 	at com.ibm.ws.threading.internal.ExecutorServiceImpl$RunnableWrapper.run(ExecutorServiceImpl.java:239)
6462      [6/20/23 9:05:19:134 AST] 000000a8 id=00000000 SystemErr                                                    R 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1160)
6463      [6/20/23 9:05:19:135 AST] 000000a8 id=00000000 SystemErr                                                    R 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
6464      [6/20/23 9:05:19:135 AST] 000000a8 id=00000000 SystemErr                                                    R 	at java.lang.Thread.run(Thread.java:820)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5193,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012652551,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,SAUDI ARABIAN MONETARY AGENCY BANKING TECHNOLOGY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cvn3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-20 23:12:16.571,,,,,21/Jun/23 9:12 AM;5b15d954b0d76456f36daf33;[~accountid:62d0e51aec233f24684a5d3a] is your local configuration same as the customer's? Can you work with them to match yours to see if there is either a local recreate or if a misconfiguration of theirs is causing the problem?,"21/Jun/23 10:42 AM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d954b0d76456f36daf33] I had a webex with customer and I had made them configure their system as same as mine but they are facing this issue while it works fine for me.

We are having remote registry (SDS) for both of us. We have our SCIM configured with Server connection as this SDS. We have an explicit interface configured for the runtime which we are hitting for SCIM calls.

I was thinking if it is misconfigured the other SCIM endpoint calls shouldn’t work, but it is working fine for them. 

Also this call (/scim/Users) for get user list, fetches the result but is somehow unable to return the result.","22/Jun/23 12:09 PM;5b15d954b0d76456f36daf33;It looks to me like they are using an ISVA runtime connection rather than a direct LDAP server connection. It shouldn’t really matter either way. 

The logical explanation for the error they are seeing is that the rgy API could not find the ISAM user they are looking for. Will see what else I can find.","27/Jun/23 3:42 PM;62d0e51aec233f24684a5d3a;# Hi [~accountid:5b15d954b0d76456f36daf33] we tried both the runtime and direct LDAP server connection methods and its the same result for both the cases. 

2. I also took the logs from my working envt. Check it below for your reference - 

 [6/27/23, 11:05:10:967 IST] 000000b4 id=00000000 com.ibm.isam.scim.common.LdapHandler                         > initialiseLdapContext() ENTRY
52        [6/27/23, 11:05:10:968 IST] 000000b4 id=00000000 com.ibm.isam.scim.common.LdapHandler                         < initialiseLdapContext() RETURN
53        [6/27/23, 11:05:10:970 IST] 000000b4 id=00000000 com.ibm.isam.scim.common.LdapHandler                         < *findMatchingResources RETURN [test, varun, test]*
54        [6/27/23, 11:05:10:970 IST] 000000b4 id=00000000 com.ibm.isam.scim.transaction.TransactionScimlet             > search ENTRY
55        [6/27/23, 11:05:10:972 IST] 000000b4 id=00000000 com.ibm.isam.scim*.transaction.TransactionScimlet             < search RETURN*",27/Jun/23 5:10 PM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] assigning this item to you as Bhavan will be on leave as of tomorrow. ,"28/Jun/23 1:46 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:62d0e51aec233f24684a5d3a] 

What is the find user in question, Is it returned in findMatchingResources? 
Is the scim configuration for user DN , suffix info, filter  rechecked? 
(UID, CN,etc) 
If the same filter is run outside of scim as an ldapsearch does it return the same user? ","28/Jun/23 2:07 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

# We are not calling the endpoint for a particular user. We are trying to fetch the list of all the users by calling the endpoint - */scim/users*
# Yes we can see that the list of the Users is fetched as matching resources but the same is not returned as a result for the call and it throws 500 error- (check line 6410 of the shared logs) *com.ibm.isam.scim.common.LdapHandler < findMatchingResources RETURN* [users, users, users, users, ecomdevwpsbind, PGTest01, PGTest02, ecomdevisam, users, users, users, users, SITwpsbind, PGTest01, PGTest02, SITisam, users, users, users, users, CERTwpsbind, PGTest01, PGTest02, CERTisam, users, users, users, users, PPRDwpsbind, PGTest01, PGTest02, PPRDisam, PPRDisam, sec_master, ivmgrd/master, users, moayasartstusr1, ECOM-DEV-webseald/KECMSHR1ISAM01, ECOM_FT-webseald/KECMSHR1ISAM01 ]
# The filters are correct since the *other SCIM endpoint calls works perfectly fine* such as /scim/{uid}, etc.
# As mentioned we are not making the call for a specific user.","29/Jun/23 4:32 PM;5af4ad7d4dd24c579110120b;<Notes>

Adding fix pack with additional trace and [https://github.ibm.com/ISAM/isam/pull/5776|https://github.ibm.com/ISAM/isam/pull/5776] ","30/Jun/23 4:24 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

Is the fixpack for collecting additional traces for SCIM? So after applying the fixpack we need to collect the traces again?

I am unable to access the fixpack on GitHub its shows 404 page not found.","30/Jun/23 4:26 PM;5af4ad7d4dd24c579110120b;[~accountid:62d0e51aec233f24684a5d3a] I’m building the fixpack, I’ll add the link once it’s ready.

This notes in my prev comment was for my reference. ","03/Jul/23 7:28 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:62d0e51aec233f24684a5d3a] 

Here is a fixpack : [https://cloudidentity.atlassian.net/browse/ISAMSUP-5193|https://cloudidentity.atlassian.net/browse/ISAMSUP-5193|smart-link] to add debug trace to see where the fall out is.

Enable trace with - {{com.tivoli.am.fim.*=ALL:com.ibm.security.access.*=ALL:com.ibm.isam.scim.*=ALL:com.tivoli.pd.*=ALL}} and get the support file. 

Note - This is only a debug fix pack since I cant recreate the issue, it lists the users and returns fine for me when I access /scim/Users.

[https://ibm.box.com/s/xcytja54c6mu2m6c3t3u91l3xl8srvbp|https://ibm.box.com/s/xcytja54c6mu2m6c3t3u91l3xl8srvbp|smart-link] 

name: scim_users_debugfixpack_10050
fixpack: [https://ibm.box.com/s/bxepjpqgu55l784afzqypd7uruf9p8vd|https://ibm.box.com/s/bxepjpqgu55l784afzqypd7uruf9p8vd|smart-link] 
checksum: [https://ibm.box.com/s/enhgzyxjjzve1t1s92c8e9bkbdqjtmng|https://ibm.box.com/s/enhgzyxjjzve1t1s92c8e9bkbdqjtmng|smart-link] 

Installing this fixpack will restart rp and aac/fed runtimes.

Thanks","03/Jul/23 1:47 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

I will share the fixpack with the customer and ask them to collect the traces. Procedure - 

# Install the fixpack.
# Enable the traces.
# Recreate the issue","05/Jul/23 1:48 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] , am unable to install the fixpack --> getting (System Error: The system failed to install the fix pack. )","05/Jul/23 3:05 PM;5af4ad7d4dd24c579110120b;[~accountid:62d0e51aec233f24684a5d3a] 

That fixpack was for 10050, which version did you try installing it on?

Did you check the fixpack install log file to see if what caused the fail? ","05/Jul/23 3:22 PM;62d0e51aec233f24684a5d3a;*Hi* [~accountid:5af4ad7d4dd24c579110120b] ,

Apologies, I tried installing it on 10.0.4 which is why it was failing. I tried it on my 10.0.5 system and it was successfully installed.

Am confirming with the customer what version they are on. Will update you if they are on different version.","05/Jul/23 6:24 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

The customer just confirmed that they are on 10.0.2 version. Can you please provide a fixpack for 10.0.2

Thanks","10/Jul/23 2:53 PM;62d0e51aec233f24684a5d3a;Hi Asha,

The customer upgraded to 10.0.5 , applied the fixpack and collected the logs.

I could still see the list is being fetched but still the same error -

[7/9/23, 13:42:39:055 AST] 00000168 id=00000000 SystemErr                                                    R java.lang.NullPointerException

Can you please have a look at the logs and provide your inputs.","12/Jul/23 5:20 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] , any update on this?","12/Jul/23 8:52 PM;5af4ad7d4dd24c579110120b;[~accountid:62d0e51aec233f24684a5d3a] 

You need to run the same fixpack in your test environment and compare the trace as to what's the difference - which attribute or entry is null.

Run tests in your environment with the fixpack and upload the trace file so we can compare.

Note - If you don't switch the response due to L3 it won't show up in my queue that you are waiting for an update.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
LMI Certificate Authentication breaks Management Authorization at 10.0.5.0,ISAMSUP-5150,307536,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Motiur Rahman,5b15d9e581c3df12acf53c4a,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,20/Jun/23 5:37 AM,14/Jul/23 2:23 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"The below uses the ‘User Mapping’ functionality for the certificate authentication.

10.0.5.0:

# Certificate is 'cn=juser,dc=iswga'
# User Mapping is used to transform the DN
# Mapping returns 'cn=Joseph User,CN=Users,DC=Hyperv,DC=Lab'
# Bind as configured Bind-DN
# Search for 'member=cn=Joseph User,CN=Users,DC=Hyperv,DC=Lab' which succeeds
# Bind as configured Bind-DN
# Search for 'sAMAccountName=cn=Joseph User,CN=Users,DC=Hyperv,DC=Lab' which fails.
# Get unauthorized.

10.0.4.0:

# Certificate is 'cn=juser,dc=iswga'
# User Mapping is used to transform the DN
# Mapping returns 'cn=Joseph User,CN=Users,DC=Hyperv,DC=Lab'
# Bind as configured Bind-DN
# Search for 'member=cn=Joseph User,CN=Users,DC=Hyperv,DC=Lab' which succeeds
# Get in



This prevents a valid client certificate from being able to be mapped and gain access to the console via Group Authorization Roles when Management Authorization is enabled.



Why is there the additional call to search using the configured ‘User DN Attribute’ at 10.0.5.0 and not at 10.0.4.0, and furthermore, why does it search for the full DN returned from the user mapping? That’s what makes the least sense.",,David Hayes,jcyarbor,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,30/Jun/23 8:37 AM;jcyarbor;juser.p12;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/209306,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013269642,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,US Social Security,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1curb:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-22 06:04:11.713,,,,,22/Jun/23 4:04 PM;5b232b2fd85e5b59b066f57f;[~accountid:5bac25aaabfcbf73d13e733b] - have we got any trace on this? Quickest way forward would be to find a pointer into the code and I can check what has changed in that area between versions. ,"23/Jun/23 1:27 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b232b2fd85e5b59b066f57f] ,

Figured since I provided recreate steps it wouldn’t be necessary.

What trace specification do you want so I’m not gathering multiple rounds of traces?",28/Jun/23 1:14 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] we are just rebalaning some of the Jira items in Dave's queue. Can you please take a look at this one for us.,29/Jun/23 3:43 AM;5b15d9e581c3df12acf53c4a;Would you please provide the setup steps ( I got the steps you provided ) so that I know which code path it LMI will be taking so that I can figure out what traces needed to be turned on …….,"29/Jun/23 6:01 AM;5b15d9e581c3df12acf53c4a;I read through but I could not see where exactly the difference ( between 10.0.5 and 10.0.4 ) is, there is but I cannot catch it.

This trace will help us:

LMI:

com.ibm.isam._=ALL:com.ibm.mesa._=ALL

And ATP: Good old

debug.level=2","30/Jun/23 8:37 AM;5bac25aaabfcbf73d13e733b;LDAP Mapping rule used:

{noformat}function mapUser(props) {
  var user = props.get(""cn"");
  if(user == 'juser'){
  return ""CN=Joseph User,CN=Users,DC=hyperv,DC=lab"";
  }
}{noformat}

Certificate used

[^juser.p12]

Recreate settings using any LDAP
1. Management authentication set to ‘Remote Management Authentication’ using the above user mapping rule. Change it to map directly to whatever user you use with whatever attribute is ‘juser’
 - For my system I used AD with the following settings:
  – Host : 10.2.1.2
  – Port: 389
  – LDAP Debugging enabled
  – Bind DN: CN=Administrator,CN=Users,DC=Hyperv,DC=Lab
  – User Attribute : sAMAccountName
  – LDAP Group attribute : member
  – Base DN: CN=Users,DC=Hyperv,DC=Lab
  – Management Group : CN=LMI Users,CN=Users,DC=Hyperv,DC=Lab
  – SSL Enabled : No
  – User Mapping Rule : See Above
   --- This is only used in certificate authentication

2. Enable Management Authorization
3. Set ‘Validate Certificate Identity' in the ‘Administrator Settings’ to ‘true’ 
4. Edit the ‘Full Write’ permission and add group ‘LMI Users’ from the Remote User Registry
 – This has to be done because when one authenticates with a certificate the full DN returned from the User Mapping Rule is used as the username and this does not match the short names that are configured when you add users directly to a Management Authorization Role


Then, when you attempt to log in using the certificate in ISVA 10.0.4.0 authentication is successful and you have access to the LMI.

When attempting at ISVA 10.0.5.0 with the exact same settings it does not work as expected.","01/Jul/23 9:04 AM;5bac25aaabfcbf73d13e733b;Had to upload the support files here:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013269642&path=TS013269642%2Fsupport_files%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013269642&path=TS013269642%2Fsupport_files%2F]

10.0.4.0 is working

10.0.5.0 does not

nothing changed between versions aside from the firmware.","07/Jul/23 2:22 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15d9e581c3df12acf53c4a] ,

Were you able to see the expected data in the collected traces?",07/Jul/23 2:36 AM;5b15d98f78cd734fe39f29a1;[~accountid:5b15d9e581c3df12acf53c4a] Customer is asking for an update? ,07/Jul/23 3:29 AM;5b15d9e581c3df12acf53c4a;I am looking into it now…..will update soon.,"07/Jul/23 5:58 AM;5b15d9e581c3df12acf53c4a;On the failure case, what error message or error code customer see when authorization fails?

I am trying to pick on that error and trace backward to see where things are going wrong?

Beside error message/code, if you could share any other message that will help me please do share….



Also, I notices that java traces were not on i.e. the following:

This trace will help us:

LMI:

*com.ibm.isam.**_=ALL:com.ibm.mesa._**=ALL*

And ATP: Good old

debug.level=2","07/Jul/23 7:01 AM;5bac25aaabfcbf73d13e733b;Hello Motiur,

Looks like I forgot to enable the Liberty tracing and only did the advanced tuning parameter.

Will upload another round.

The error that you see is ‘Access is Forbidden’ or ‘403:Authentication Failed’","11/Jul/23 4:21 AM;5bac25aaabfcbf73d13e733b;This is the unexpected error message that you get:

{noformat}
Access Denied

You do not have permission to perform the requested action on the following feature:

=====
https://10.2.5.80/unauthorized{noformat}

This error is not encountered at the 10.0.4.0 version. I’m getting traces now.","12/Jul/23 8:45 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15d9e581c3df12acf53c4a] ,

I’ve uploaded the new traces here:

/ecurep/sf/TS013/269/TS013269642/support_files/2023-7-11/

They should have the data you need.","13/Jul/23 2:13 AM;5b15d9e581c3df12acf53c4a;L3 Only

===================

[7/11/23, 17:36:41:548 CDT] 0000007c id=00000000 com.ibm.mesa.security.authentication.modules.WebServicesTAI  1 Certificate username : CN=juser,DC=iswga
[7/11/23, 17:36:41:549 CDT] 0000007c id=00000000 com.ibm.mesa.security.authentication.modules.WebServicesTAI  1 Validating Certificate username : CN=juser,DC=iswga
[7/11/23, 17:36:41:549 CDT] 0000007c id=00000000 com.ibm.mesa.security.authentication.modules.WebServicesTAI  1 Mapping Certificate username : CN=juser,DC=iswga
[7/11/23, 17:36:41:556 CDT] 0000007c id=00000000 com.ibm.mesa.security.authentication.modules.WebServicesTAI  1 extracted SAN from cert : null
[7/11/23, 17:36:41:588 CDT] 0000007c id=00000000 com.ibm.mesa.security.authentication.modules.WebServicesTAI  1 Translated username : CN=Joseph User,CN=Users,DC=hyperv,DC=lab
[7/11/23, 17:36:41:599 CDT] 0000007c id=00000000 com.ibm.isam.common.utils.WgaCommand                         1 Using default user : admin
[7/11/23, 17:36:41:757 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SecurityFilter             > doFilter ENTRY
[7/11/23, 17:36:41:764 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            > checkInactivityTimeout(String) ENTRY uYMPRRMziOhJ29Wzmb8feoI
[7/11/23, 17:36:41:764 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            > checkSubjectCreationTime(String) ENTRY uYMPRRMziOhJ29Wzmb8feoI
[7/11/23, 17:36:41:765 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            < checkSubjectCreationTime(String) RETURN true
[7/11/23, 17:36:41:766 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            < checkInactivityTimeout(String) RETURN true
[7/11/23, 17:36:41:768 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SecurityFilter             1 /
[7/11/23, 17:36:41:772 CDT] 0000007c id=00000000 com.ibm.ws.webcontainer.servlet.ServletWrapper               I init SRVE0242I: [fwdapp] [/] [WgaRedirect]: Initialization successful.
[7/11/23, 17:36:41:777 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SecurityFilter             > doFilter ENTRY
[7/11/23, 17:36:41:777 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            > checkInactivityTimeout(String) ENTRY uYMPRRMziOhJ29Wzmb8feoI
[7/11/23, 17:36:41:778 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            > checkSubjectCreationTime(String) ENTRY uYMPRRMziOhJ29Wzmb8feoI
[7/11/23, 17:36:41:778 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            < checkSubjectCreationTime(String) RETURN true
[7/11/23, 17:36:41:778 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            1 checkInactivityTimeout(String) : Check last access time is valid
[7/11/23, 17:36:41:778 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            < checkInactivityTimeout(String) RETURN true
[7/11/23, 17:36:41:779 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SecurityFilter             1 /
[7/11/23, 17:36:41:780 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SecurityFilter             > doFilter ENTRY
[7/11/23, 17:36:41:780 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            > checkInactivityTimeout(String) ENTRY uYMPRRMziOhJ29Wzmb8feoI
[7/11/23, 17:36:41:781 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            > checkSubjectCreationTime(String) ENTRY uYMPRRMziOhJ29Wzmb8feoI
[7/11/23, 17:36:41:781 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            < checkSubjectCreationTime(String) RETURN true
[7/11/23, 17:36:41:781 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            1 checkInactivityTimeout(String) : Check last access time is valid
[7/11/23, 17:36:41:781 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SessionActivity            < checkInactivityTimeout(String) RETURN true
[7/11/23, 17:36:41:782 CDT] 0000007c id=00000000 com.ibm.isam.core.security_filter.SecurityFilter             1 /
[7/11/23, 17:36:41:815 CDT] 0000007c id=00000000                                                              1  I18n stage.1=com.ibm.isam.wga.i18n.LabelResource
[7/11/23, 17:36:41:815 CDT] 0000007c id=00000000                                                              1  I18n stage.2=com.ibm.isam.mga.i18n.LabelResource
[7/11/23, 17:36:41:816 CDT] 0000007c id=00000000                                                              1  I18n stage.3=com.ibm.mesa.i18n.LabelResource
[7/11/23, 17:36:41:823 CDT] 0000007c id=00000000 com.ibm.mesa.common.MesaCommand                              1 Using user : CN=Joseph User,CN=Users,DC=hyperv,DC=lab
[7/11/23, 17:36:41:888 CDT] 0000007c id=00000000 com.ibm.mesa.common.MesaCommand                              1 Using user : CN=Joseph User,CN=Users,DC=hyperv,DC=lab
[7/11/23, 17:36:41:942 CDT] 0000007c id=00000000 com.ibm.mesa.common.MesaCommand                              1 Using user : CN=Joseph User,CN=Users,DC=hyperv,DC=lab
[7/11/23, 17:36:42:168 CDT] 0000007c id=00000000                                                              1  MesaServletPipeline stage.1=com.ibm.mesa.servlet.MesaHeadersStage
[7/11/23, 17:36:42:170 CDT] 0000007c id=00000000                                                              1  MesaServletPipeline stage.2=com.ibm.mesa.feature.security.MesaSecurityStageWrapper
[7/11/23, 17:36:42:173 CDT] 0000007c id=00000000                                                              1  MesaServletPipeline stage.3=com.ibm.mesa.servlet.extension.MesaConfigStage
[7/11/23, 17:36:42:174 CDT] 0000007c id=00000000                                                              1  MesaServletPipeline stage.4=com.ibm.mesa.feature.authorization.AuthorizationStage
[7/11/23, 17:36:42:195 CDT] 0000007c id=00000000 com.ibm.ws.webcontainer.servlet.ServletWrapper               I init SRVE0242I: [xgs_50] [/core] [Dashboard]: Initialization successful.
[7/11/23, 17:36:42:218 CDT] 0000007c id=00000000 com.ibm.mesa.common.MesaCommand                              1 Using user : CN=Joseph User,CN=Users,DC=hyperv,DC=lab
*_[7/11/23, 17:36:42:276 CDT] 0000007c id=00000000 com.ibm.mesa.common.MesaCommand                              1 Using user : CN=Joseph User,CN=Users,DC=hyperv,DC=lab_*
*_[7/11/23, 17:36:42:333 CDT] 0000007c id=00000000 AuthorizationStage                                           1 doStage Authorization failed_*
*_[7/11/23, 17:36:42:334 CDT] 0000007c id=00000000 AuthorizationStage                                           1 doStage User does not exist_*
[7/11/23, 17:36:42:334 CDT] 0000007c id=00000000 AuthorizationStage                                           1 doStage URL        : [https://10.2.5.80/core/dashboard|https://10.2.5.80/core/dashboard]

====================================================

From /var/log/messages:

Jul 11 17:36:41 mesa_config[15798]: Debug: Executing command: 'wga.auth' 'is_user' 'CN=Joseph User,CN=Users,DC=hyperv,DC=lab'
Jul 11 17:36:41 mesa_config[15798]: Debug: ad.hyperv.lab: 389: No keyfile
Jul 11 17:36:41 mesa_config[15798]: Debug: Binding CN=Administrator,CN=Users,DC=Hyperv,DC=Lab
Jul 11 17:36:41 mesa_config[15798]: Debug: Perform an LDAP search with a filter of: (member=CN=Joseph User,CN=Users,DC=hyperv,DC=lab)
*_Jul 11 17:36:41 mesa_config[15798]: Debug: The user is a member of the administrators group._*
Jul 11 17:36:41 mesa_config[15798]: GLGSY0103I:: GLG_events:: |user=CN=Joseph User,CN=Users,DC=hyperv,DC=lab|
Jul 11 17:36:41 mesa_config[15798]: Debug: Removing temporary file /tmp/tmp.L72ff4
Jul 11 17:36:41 mesa_config[15809]: Debug: Resolving observers
Jul 11 17:36:41 mesa_config[15809]: Debug: Resolving dependencies
Jul 11 17:36:41 mesa_config[15809]: Debug: Calculating commit order
Jul 11 17:36:41 mesa_config[15809]: Debug: Calculating snapshot command execution order
Jul 11 17:36:41 mesa_config[15809]: Debug: Executing command: 'isam.activation' 'is_activated' 'mga'
Jul 11 17:36:41 mesa_config[15809]: Debug: offering: wga = true

…………….

…………….

*_Jul 11 17:36:42 mesa_config[15842]: Debug: Executing command: 'wga.auth' 'roles' 'CN=Joseph User,CN=Users,DC=hyperv,DC=lab'_*
Jul 11 17:36:42 mesa_config[15842]: Debug: ad.hyperv.lab: 389: No keyfile
Jul 11 17:36:42 mesa_config[15842]: Debug: Binding CN=Administrator,CN=Users,DC=Hyperv,DC=Lab
Jul 11 17:36:42 mesa_config[15842]: Debug: Perform an LDAP search from CN=Users,DC=Hyperv,DC=Lab, with a filter of: (sAMAccountName=CN=Joseph\20User,CN=Users,DC=hyperv,DC=lab)
Jul 11 17:36:42 mesa_config[15842]: Debug: Removing temporary file /tmp/tmp.2QP2Tm
Jul 11 17:36:42 mesa_config[15852]: Debug: Resolving observers
Jul 11 17:36:42 mesa_config[15852]: Debug: Resolving dependencies
Jul 11 17:36:42 mesa_config[15852]: Debug: Calculating commit order
Jul 11 17:36:42 mesa_config[15852]: Debug: Calculating snapshot command execution order
*_Jul 11 17:36:42 mesa_config[15852]: Debug: Executing command: 'wga.auth' 'permissions' 'CN=Joseph User,CN=Users,DC=hyperv,DC=lab'_*
Jul 11 17:36:42 mesa_config[15852]: Debug: ad.hyperv.lab: 389: No keyfile
Jul 11 17:36:42 mesa_config[15852]: Debug: Binding CN=Administrator,CN=Users,DC=Hyperv,DC=Lab
Jul 11 17:36:42 mesa_config[15852]: Debug: Perform an LDAP search from CN=Users,DC=Hyperv,DC=Lab, with a filter of: (sAMAccountName=CN=Joseph\20User,CN=Users,DC=hyperv,DC=lab)
Jul 11 17:36:42 mesa_config[15852]: Debug: Removing temporary file /tmp/tmp.oVbcAa
Jul 11 17:36:42 mesa_config[15862]: Debug: Resolving observers

……………

…………..



Command for “roles” and “permission” failed as it could not find a valid user with  filter: “(sAMAccountName=CN=Joseph\20User,CN=Users,DC=hyperv,DC=lab)”

and that’s why Authorization failed……



===================================================================

Here are some differences in 10.0.4.0 and 10.0.5.0 code specially in determining “roles” i.e. for command

mesa_config wga.auth roles userDN 

i.e.

mesa_config 'wga.auth' 'roles' 'CN=Joseph User,CN=Users,DC=hyperv,DC=lab'

in config_wga_auth.cpp for 10.0.4.0

        rc = AMWAInitialiseConnection(
                g_guestUser.data(), g_guestPwd.data(), connection);

        if (rc != 0) {
            return rc;
        }

        /*
         * Determine the DN for the user.
         */

        std::string userDN;

        *_if (cnPtr != NULL) {

            /*
             * The user authenticated with a client certificate.
             * The presented username is the DN!
             */

            userDN = argv[2];_*

        } else {

            /*
             * If the user authenticated via forms, we only know
             * the user attribute and need to determine their DN.
             */

            rc = AMWAGetUserDN(user, userDN, connection);
        }

……………………………………………..

……………………………………………

In 10.0.5.0

       /*
         * Determine the DN for the user.
         */

        std::string userDN;
        /*
         * in remote mode
         * configurable user attribute is in g_userAttribute
         */
        std::string remoteClientCertUserKey = g_userAttribute + ""="";
        *_userPtr  = (char*) strstr(user, remoteClientCertUserKey.data());_*
        if (userPtr != NULL) {

            /*
             * The user authenticated with a client certificate.
             * The presented username is the DN!
             */

            userDN = argv[2];

        } else {

            /*
             * If the user authenticated via forms, we only know
             * the user attribute and need to determine their DN.
             */

            rc = AMWAGetUserDN(user, userDN, connection);
        }

…………………………

……………………



I think 

*_userPtr  = (char*) strstr(user, remoteClientCertUserKey.data());_*

is the culprit, user will NOT have g_userAttribute in the userDN to begin with.","13/Jul/23 4:48 AM;5b15d9e581c3df12acf53c4a;Jack

Got a question for you:

I know that same configuration was working in 10.0.4.0 and prior but a fixed went into 10.0.5.0 that is making me thing whether or not our configuration is proper………….



The Certificate that you are using is:

Issuer : CN=juser,DC=iswga
Subject : CN=juser,DC=iswga



and 

 authdb.remote.userAttribute = sAMAccountName

………………

………………



I am wondering about userAttribute= sAMAccountName

does it should be “ sAMAccountName” or it should be “CN” or “cn”??

If you use “cn” then it should work because that was what was in prior release in the code, it did not use the value provided in “authdb.remote.userAttribute”

The fix that went into in 10.0.5.0 is saying that it should be “cn” or it could be “uid” etc.","13/Jul/23 5:03 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d9e581c3df12acf53c4a] ,

Regardless of what the attribute is set to why is it using the full DN when searching for that attribute?

{noformat}10.0.5.0
Jul 11 17:36:42 mesa_config[15852]: Debug: Perform an LDAP search from CN=Users,DC=Hyperv,DC=Lab, with a filter of: (sAMAccountName=CN=Joseph\20User,CN=Users,DC=hyperv,DC=lab){noformat}

Why in 10.0.4.0 when given the full DN of the user, which is the whole point of the user certificate mapping, to map the certificate DN to user DN, does the search work? 

It seems like in 10.0.4.0 when using certificate authentication when it already has the full DN it doesn’t look up the user using the ‘User Attribute’.



The ‘User Attribute’ is supposed to be used to search for the input username in the login prompt to find the DN of the user. That DN is then searched as the value to the ‘Group Member Attribute’ to confirm whether the DN that was acquired from the ‘User Attribute’ search is part of the administrative group.



If the ‘User Mapping’, which is only used for certificate authentication, returns a full DN why in 10.0.5.0 do we search for the full DN using the already acquired full DN as the value to the ‘User Attribute’ which is supposed to be used to find the full DN?



Seems like THATs broken.","13/Jul/23 7:09 AM;5b15d9e581c3df12acf53c4a;That’s the thing, in 10.0.4.0 was using  “CN=”,  it did not use attribute provided in “authdb.remote.userAttribute”

and the changed made in 10.0.5.0 is using that attribute and search is failing in 10.0.5 but passing in 10.0.4.0

In 10.0.4.0, it was not really searching for full dn, presence of “CN=” is interpreted as user being in dn form, but in 10.0.5.0, because of that changed, it cannot find “sAMACcountName” in user and assume it is not in DN format and hence trying to search for it and failing.","13/Jul/23 7:19 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15d9e581c3df12acf53c4a] ,

Then I think we need to define what the ‘User Attribute’ is supposed to be.



If that’s supposed to be the RDN value then we need to document it as that.

My understanding was it’s the attribute of the user’s username which may not necessarily be the RDN value.","13/Jul/23 7:21 AM;5bac25aaabfcbf73d13e733b;10.0.6.0 documentation in question:

[https://www.ibm.com/docs/en/sva/10.0.6?topic=settings-configuring-management-authentication|https://www.ibm.com/docs/en/sva/10.0.6?topic=settings-configuring-management-authentication|smart-link] 

“Specify the name of the LDAP attribute that holds the supplied authentication user name of the user in the User Attribute field.”

It can be any LDAP attribute that holds the supplied authentication user name. 



What is the ‘User Mapping’ supposed to return, a full DN or just the username?","13/Jul/23 7:22 AM;5bac25aaabfcbf73d13e733b;From the SAME documentation for the User Mapping:
”The User mapping script field contains a placeholder script that will be set as the default unless a new script is entered. The script contains a Javascript function that takes a Map as an input and returns a String that represents the new DN. The map contains the following values that can be used in the mapping:”

Specifically “returns a string that represents the new DN”

Meaning that it should directly supply the DN of the user, meaning that searching for the User Attribute is not necessary because the full DN is already supplied.","14/Jul/23 1:11 AM;5b15d9e581c3df12acf53c4a;“Specify the name of the LDAP attribute that holds the supplied authentication user name of the user in the User Attribute field.”

The above description is correct e.g. in ISVA, a user juser  whose full DN could be:

cn=juser,o=ibm,c=us

or

uid=juser,o=ibm,c=us

In the above two cases, it is LDAP attribute “cn” in first example and LDAP attribute “uid” in the 2nd example is containing the user id.

In code, if you provide the proper LDAP attribute ( in the above examples i.e. either cn or uid) then code has logic to figure out whether or not supplied user is on DN form  ( i.e. cn/uid=juser,o=ibm,c=us) or just simple user ID form i.e. “juser”

If it is simple userid i.e. “juser” then it will search LDAP and get it’s DN.

Remember, “LDAP attributes”  are

“cn”, “uid”, “o”, “c”

Here, it is  “cn” or “uid” that points of user id

and also remember, we can modify LDAP Schema and define some other attributes ( any string)  which can be used to construct DN of a user id.

So, ONLY reason it was working on 10.0.4.0 or earlier is because it was using hard coded “cn” as LDAP Attribute, so even in ISVA 10.0.4.0, if your user’s DN happens to be of the form

“uid=juser,o=ibm,c=us” then it will not work.","14/Jul/23 2:02 AM;5bac25aaabfcbf73d13e733b;I don’t agree. 

If that’s the way it’s going to be the documentation needs to be changed. 

Right now it seems like you can specify any LDAP attribute on the user entry to specify where to look for the username.



What you’re saying is that it’s also a requirement that said LDAP attribute also be the RDN value which is not the way it is in most deployments.

For example, in AD the sAMAccountName is the shortname of the userPrincipalName and the ‘uid’ and ‘cn’ are often different than that of the user’s login name. If users didn’t know their ‘uid’ value or the DNs were formatted cn=name,ou=something,dc=blah,dc=blah' but their user IDs were held in the sAMAccountName they would not be able to log in using their familiar username.","14/Jul/23 2:23 AM;5b15d9e581c3df12acf53c4a;Let me do some in-depth analysis and see why the code was changed they way it was changed,  I need to dig deeper into the old problem that was solved which caused this whole issue.

Will update soon.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
"""HSTS Missing From HTTPS Server"" Vulnerability noted on Port 7135",ISAMSUP-5144,307097,Support,To Do,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,jwade,5b15d8fd6e93913e31e279fb,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,16/Jun/23 2:43 PM,11/Jul/23 1:58 PM,14/Jul/23 2:47 PM,,,,,0,,,,"Hi Team,

Customer has found this vulnerability in their envt. The scan was done using Nessus Professional.

I have shared with them this tech note but it seems it is applicable for webseal HTTPS port (443)

[https://www.ibm.com/support/pages/provide-steps-configure-ibm-security-access-manager-webseal-enable-hsts|https://www.ibm.com/support/pages/provide-steps-configure-ibm-security-access-manager-webseal-enable-hsts]

How can we remediate it for policy server port 7135 ?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013288446,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,SINGAPORE IMMIGRATION AND REGISTRATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cs1b:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-16 12:30:25.568,,,,,16/Jun/23 10:30 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] can you please take a look at this issue for our customer and confirm their observations. ,"19/Jun/23 2:23 PM;62d0e51aec233f24684a5d3a;Hi Team, any updates on this?",20/Jun/23 1:22 AM;5b15d8fd6e93913e31e279fb;[~accountid:62d0e51aec233f24684a5d3a] I am looking into this,"27/Jun/23 1:14 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d8fd6e93913e31e279fb] any update on this? Need to reply back to customer.

Thanks","04/Jul/23 2:01 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d8fd6e93913e31e279fb] any update on this? Customer is waiting on response.

Thanks","05/Jul/23 7:43 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d8fd6e93913e31e279fb] , any update on this?",07/Jul/23 4:51 AM;5b15d8fd6e93913e31e279fb;[~accountid:62d0e51aec233f24684a5d3a] I apologize for the delay.  I have been trying to get access to a Nessus Scanner and need an environment to verify this against.  Can you help with setting up a recreate environment?,"10/Jul/23 2:55 PM;62d0e51aec233f24684a5d3a;Hey [~accountid:5b15d8fd6e93913e31e279fb] l too don't have an access to Nessus scanner, can you let me know what I can help you with.","11/Jul/23 6:07 AM;5b15d8fd6e93913e31e279fb;[~accountid:62d0e51aec233f24684a5d3a] I am still trying to get access to a Nessus scanner, but if you could help setup an environment similar to the customers that would help.","11/Jul/23 1:58 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d8fd6e93913e31e279fb] , I have installed the 10.0.5 version in my local lab , similar to the clients envt. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do
webseal cluster doesn't inform when ssl certificates are updated in the non master appliance,ISAMSUP-5140,306650,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Peter Horner,5b15d9517dab4c51f61b5190,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,14/Jun/23 8:44 PM,11/Jul/23 6:17 PM,14/Jul/23 2:47 PM,,,,,0,,,,"In the customer’s production webseal appliances (and also the rest of the environments) they have configured a cluster that includes in the services managed by it, the ssl certificate databases that are used in the webseal instances. 

In this way, when one is updated or included, the databases of both nodes (master and replica) are automatically updated. 

In the master, the affected instances after the change in a certificate database, indicate that it is necessary to restart them (yellow signal and text), but in the machine that is not the master of the cluster, nothing is indicated (all in green) and apparently the instances are fine.

In the database of certificates updated by the cluster on the machine that is not the master, the certificate is already updated. But until the instances are restarted and the new one is loaded, the old one is still operative. 

Customer would like to know if there is any way to show the same warning on the non-master machine that it is necessary to restart the instances affected by the change of certificates, as it is done on the master.

After Analysing Webseal.conf

webseal-cert-keyfile = /var/pdweb/shared/keytab/wbeprod.p12.

I have replicate the issue and find the same behaviour on non-master machine. I followed the steps in the documentation below:

[https://www.ibm.com/docs/en/sva/10.0.4?topic=settings-managing-cluster-configuration|https://www.ibm.com/docs/en/sva/10.0.4?topic=settings-managing-cluster-configuration|smart-link] 

Customer also shared the support file
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013161814&path=TS013161814/2023-06-06/&filepath=TS013161814/2023-06-06/isva_10.0.4.0_20230606-095237_sxtam102.bde.es.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013161814&path=TS013161814/2023-06-06/&filepath=TS013161814/2023-06-06/isva_10.0.4.0_20230606-095237_sxtam102.bde.es.support]










",,Alan Wong,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092aca0f0db130069d19687,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013161814,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,BANCO DE ESPAÑA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cpef:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-06-15 11:46:01.866,,,,,15/Jun/23 9:46 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9517dab4c51f61b5190] can you please take an initial look at this item for us. ,"16/Jun/23 12:23 PM;5b15d9517dab4c51f61b5190;Currently we only calculate what needs to be restarted when changes are deployed. So when a keystore is modified on the primary and deployed - we recalculate what needs to be restarted only on the primary.

The cluster replication doesn’t use the deploy mechanism. The files are copied directly to the same location on all the cluster nodes. This mechanism doesn't reevaluate if anything needs to be restarted on the nodes.

The cluster manager on each node detects the updated keystore. I am investigating whether it is possible to have the cluster manger on each node re evaluate the restart list when it detects an updated keystore. We would only want to re evaluate the list when keystore replication is enabled in a non primary node of a cluster.

Will update when I have investigated further",03/Jul/23 7:32 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d9517dab4c51f61b5190] any update on this please.,11/Jul/23 6:17 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d9517dab4c51f61b5190] any update on this please?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
SCIM 41s delay.,ISAMSUP-5138,306456,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,14/Jun/23 8:34 AM,27/Jun/23 8:48 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"Customer has SCIM setup and seeing a 41s delay when the code attempts to get the user’s Knowledge Questions from the HVDB.  There are no messages related to HVDB issues.  There is always the 41s delay.  We have bottomed out on trace.



See [https://ecurep.mainz.de.ibm.com/ae5/#id=TS013230883&path=TS013230883%2F2023-06-07%2Fisva_10.0.3.1_20230607-161150_GNPSSTES05.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F&filepath=TS013230883%2F2023-06-07%2Fisva_10.0.3.1_20230607-161150_GNPSSTES05.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F000019a0.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013230883&path=TS013230883%2F2023-06-07%2Fisva_10.0.3.1_20230607-161150_GNPSSTES05.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F&filepath=TS013230883%2F2023-06-07%2Fisva_10.0.3.1_20230607-161150_GNPSSTES05.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F000019a0.log]

{noformat}[6/7/23, 16:13:34:403 CDT] 000019a0 id=00000000 com.ibm.isam.scim.common.RgyHandler                          > findMatchingResources ENTRY cn (&(|(objectclass=person)(objectclass=organizationalPerson)(objectclass=inetOrgPerson))(|(cn=8142574)(uid=8142574)))
[6/7/23, 16:13:34:404 CDT] 000019a0 id=00000000 com.ibm.isam.scim.common.RgyHandler                          < findMatchingResources RETURN
[6/7/23, 16:13:34:404 CDT] 000019a0 id=00000000 com.ibm.isam.scim.ScimUserServlet                            > constructJsonForResource ENTRY
[6/7/23, 16:13:34:404 CDT] 000019a0 id=00000000 com.ibm.isam.scim.up.UserProfileScimlet                      > getLdapConnection() ENTRY
[6/7/23, 16:13:34:404 CDT] 000019a0 id=00000000 com.ibm.isam.scim.up.UserProfileScimlet                      < getLdapConnection() RETURN
[6/7/23, 16:13:34:404 CDT] 000019a0 id=00000000 com.ibm.isam.scim.common.RgyHandler                          > getResourceAttributes ENTRY cn oskar respaldo medico
[6/7/23, 16:13:34:405 CDT] 000019a0 id=00000000 com.ibm.isam.scim.common.RgyHandler                          < getResourceAttributes RETURN
[6/7/23, 16:13:34:405 CDT] 000019a0 id=00000000 com.ibm.isam.scim.UserKnowledgeQuestionsScimlet              > handleGet ENTRY

[6/7/23, 16:14:14:441 CDT] 000019a0 id=425110af com.ibm.ws.rsadapter.jdbc.WSJdbcDataSource                   3 getConnection
[6/7/23, 16:14:14:441 CDT] 000019a0 id=425110af com.ibm.ws.rsadapter.jdbc.WSJdbcDataSource                   > getConnection Entry{noformat}



AAC auditing is not enabled so the Knowledge Question audit record code is not called.  That would add 3 more lines at line 9 but no need.

The SCIM config is fine, connection to LDAP is fine.  After 41s the threads gets a handle to the HVDB and the SQL calls are performed within milliseconds.",,khansen,Tushar Prasad,,,,,,,,,,,,,,5b15d901fa615349cb01778b,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013230883,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nick Lloyd,5b15d9e6dda5f94d06b985b4,,,,"GRUPO NACIONAL PROVINCIAL, S.A.B.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=9, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":9,""lastUpdated"":""2020-11-04T13:54:09.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":9,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1co6f:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-06-15 11:44:28.048,,,,,14/Jun/23 8:46 AM;5b15d9e6dda5f94d06b985b4;Have asked customer to collect thread dumps.,15/Jun/23 9:44 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e6dda5f94d06b985b4] thanks for the updates on this this item. I wanted to check did you or the team have a chance to confirm this time delay in a local recreated?  [~accountid:5b15d94b6256d01ad54eb020] can you please take a quick look at this one for us. The fact that this seems to be consistent should allow us to fairly quickly isolate what might be causing this issue. Please let me know if I can support in anyway. ,15/Jun/23 10:46 PM;5b15d9e6dda5f94d06b985b4;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b15d94b6256d01ad54eb020] I am not able to recreate at 1031/1050.  At 1031 even enabled AAC auditing (customer has disabled) but did not see a delay.,22/Jun/23 1:08 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9e6dda5f94d06b985b4] I haven’t had a chance to look into this yet.  Are you suspecting  the  RGY API?    Is the registry local or remote ?,"22/Jun/23 1:21 AM;5b15d9e6dda5f94d06b985b4;[~accountid:5b15d94b6256d01ad54eb020] I am not suspecting the LDAP pieces at all.  Those searches have already been issued and the data retrieved.  The SCIM connection is points to a remote LDAP though.  PDMGRD is using a remote LDAP.

After the LDAP data is retrieved the code needs to go into the HVDB to get Knowledge Questions, MMFA, and OTP info.  That is where the hangs starts.  The logs do not show any issues with the embedded HVDB.",22/Jun/23 1:23 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9e6dda5f94d06b985b4] Okay thanks.  I saw RgyHandler above is why I asked.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
More insights in the configuration of the rsyslogd,ISAMSUP-5137,306445,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,14/Jun/23 6:02 AM,15/Jun/23 7:51 PM,14/Jul/23 2:47 PM,15/Jun/23 7:51 PM,,,,0,,,,"The customer is asking if it would be possible to get more insights in the configuration of the rsyslogd?

For example RebindInterval or the action settings for rsyslogd?
Like the options which might be present in the config which can not be selected in the LMI?

Assuming there is a “rsyslog.conf” configuration file with specific options for the rsyslog daemon.

The customer simply wanted to see the contents to see if I would be able to determine which rsyslog options can be optimized as consequently.  
The *settings.txt*  from the support file is also fairly limited to the extent of the many options rsyslog actually offers.

",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012724833,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,KBC GROUP NV,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1co3z:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-06-14 01:04:34.825,,,,,"14/Jun/23 6:04 AM;614dd52af1c1740068534813;I don’t think ISVA expose such settings, maybe the customer needs to open an RFE?
Hope I can have some advise from L3.

Thanks in advance","14/Jun/23 11:04 AM;5b15d954b0d76456f36daf33;[~accountid:614dd52af1c1740068534813] unfortunately we don’t have a way to control a lot of rsyslog parameters.

The only ones that can be set as advanced tuning parameters are these:

{noformat}Name: rsyslog_forwarder.poll_interval
Default value: 10 seconds
(Specifies how often files are to be polled for new data. The time specified is in seconds.
 Shorter the interval, the more system resources are consumed. Setting it to 0 will be a drain
 on the CPU!!)

Name: rsyslog_forwarder.state_interval
Default value: 0
(Specifies how often the state file shall be written when the remote syslog forwarder processes
 the input file. 0 means write when the monitored file is being closed. A value of 'n' means
 write the file after 'n' lines are processed.)

Name: rsyslog_forwarder.max_message_size
Value: 2-128
(Specifies the maximum supported message size (both for sending and receiving) in kilobytes)){noformat}

If they need anything beyond these, it needs to go the RFE way.",15/Jun/23 7:51 PM;614dd52af1c1740068534813;Got it. Thanks for the support! ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Questions about Vulnerability RHSA-2023:3018 (libarchive),ISAMSUP-5133,305798,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Mitsukazu Nakai,5bb6a576c39135735a7db132,Mitsukazu Nakai,5bb6a576c39135735a7db132,12/Jun/23 4:48 PM,19/Jun/23 3:02 PM,14/Jul/23 2:47 PM,19/Jun/23 3:02 PM,,,,0,,,,"The customer use verify-access-wrp container (10.0.3).
Could you please confirm whether the below Vulnerability is ""vulnerable"" or ""affected"". ie is the library in use.

RHSA-2023:3018 (libarchive)
[https://access.redhat.com/errata/RHSA-2023:3018|https://access.redhat.com/errata/RHSA-2023:3018|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013085544,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Mitsukazu Nakai,5bb6a576c39135735a7db132,,,,MACQUARIE GROUP SERVICES AUSTRALIA PTY LIMITED,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1ck3r:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-06-12 13:06:57.382,,,,,12/Jun/23 11:06 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] one for yo to review and update. ,13/Jun/23 8:13 AM;5b15d8fd6e93913e31e279fb;[~accountid:5bb6a576c39135735a7db132] This library is not shipped on the Appliance.  I doubt very much it is shipped in the Container but I do not have one handy that I can check.  You can check that and respond to the customer if libarchive exists below the libarchive-3.3.3-5.el8.x86_64.rpm level.,"13/Jun/23 12:26 PM;5bb6a576c39135735a7db132;Hi [~accountid:5b15d8fd6e93913e31e279fb] 
Thank you for your support.

Thank you for your answer.
The container had a libarchive.so.13.3.3:

{{ % podman run -ti icr.io/isva/verify-access-wrp:10.0.5.0 ls -l /usr/lib64/libarchive\*}}
{{lrwxrwxrwx. 1 root root     20 Jul 18  2022 /usr/lib64/libarchive.so.13 -> libarchive.so.13.3.3}}
{{-rwxr-xr-x. 1 root root 775592 Jul 18  2022 /usr/lib64/libarchive.so.13.3.3}}


Therefore, I will answer ""affected"" to the customer.
Thank you.

Regards,
Mitsukazu Nakai","19/Jun/23 3:00 PM;5bb6a576c39135735a7db132;Hi [~accountid:5b15d8fd6e93913e31e279fb] 
Sorry for the late update.

The customer has agreed to close the SF Case, so could you please close this Jira item as well?
Thank you very much!

Regards,
Mitsukazu Nakai",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
LUA script causes empty response in browser,ISAMSUP-5131,305675,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,10/Jun/23 1:48 AM,26/Jun/23 11:42 AM,14/Jul/23 2:47 PM,26/Jun/23 11:42 AM,10.0.7,,,0,,,,"Hi team,

When the customer try to log in with this URL, it doesnt work: [https://beta.testgjensidige.no/mga/sps/authsvc/policy/username_login?URL=https://beta.testgjensidige.no/kunde/privat&username=notworking&partref=notworking&type=no-privat|https://beta.testgjensidige.no/mga/sps/authsvc/policy/username_login?URL=https://beta.testgjensidige.no/kunde/privat&username=notworking&partref=notworking&type=no-privat] 

There is just an empty response message in browser. This is only a problem when we use the LUA script Trusteer_lua 

The LUA scipt:

local charset = ""qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM1234567890""

function randomString(length)

local ret = {}

local r

for i = 1, length do

r = math.random(1, #charset)

table.insert(ret, charset:sub(r, r))

end

return table.concat(ret)

end

--[[

if HTTPResponse.containsCookie(""tr_user_csid"") then

HTTPResponse.removeCookie(""tr_user_csid"")

end

--]]

math.randomseed(os.time())

tagvalue_session_index = Session.getCredentialAttribute(""tagvalue_session_index"")

if tagvalue_session_index then

local cookieValue = tagvalue_session_index .. "":"" .. randomString(15)

local cookieString = string.format(""%s; Domain=[beta.testgjensidige.no|https://beta.testgjensidige.no/]; Path=/; Secure; HttpOnly"", cookieValue)

HTTPResponse.setCookie(""tr_user_csid"", cookieString)

end

The trace looks like the EAI mechansism and the LUA mechanism don't like each other.

The EAI server server response is a bit weird, but it looks ok

{noformat}2023-06-09-09:55:14.856+02:00I----- thread(66) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- PD <=== BackEnd -----------------
Thread 66; fd 259; local 127.0.0.1:53536; remote 127.0.0.1:8443
HTTP/1.1 200 OK
connection: Close
content-language: en-US
content-length: 0
date: Fri, 09 Jun 2023 07:55:14 GMT
am-eai-ext-user-groups: min_oversikt
x-frame-options: SAMEORIGIN
am-eai-ext-user-id: notworking
cache-control: no-cache=""set-cookie, set-cookie2""
tagvalue_eai_common_name: Fake Login : notworking
expires: Thu, 01 Dec 1994 16:00:00 GMT
authenticationmechanismtypes: urn:ibm:security:authentication:asf:mechanism:username_only_remember_me
am-eai-redir-url: https://beta.testgjensidige.no/kunde/privat
tagvalue_partref_s2000: notworking
authentication_level: 8
am-eai-xattrs: authenticationTypes,AUTHENTICATION_LEVEL,authenticationMechanismTypes,tagvalue_partref_s2000,tagvalue_eai_common_name,tagvalue_auth_mechanism
authenticationtypes: urn:ibm:security:authentication:asf:username_login
tagvalue_auth_mechanism: BankID
Set-Cookie: JSESSIONID=0000j1Nh4Eo5JZwdDioQQGSoF06:c9c2ccc5-2656-4a49-8dde-5c750df4d33f; Path=/; Secure; HttpOnly{noformat}

But after the http transformations we get an error code 0x3898319e  which we can't find in the docs

{noformat}2023-06-09-09:55:14.865+02:00I----- thread(66) trace.pdweb.http.transformation:6 /build/isam/src/i4w/pdweb/webseald/http/transformation/HTTPTransformationEngine.cpp:228: ENTER HTTPTransformationEngine::processResponseByResource Trusteer_Lua
2023-06-09-09:55:14.865+02:00I----- thread(66) trace.pdweb.http.transformation:6 /build/isam/src/i4w/pdweb/webseald/http/transformation/lua/HTTPLuaTransformationRule.cpp:194: ENTER HTTPLuaTransformationRule::processResponse(/var/pdweb/shared/xslt/http-transformation/Trusteer_Lua.lua)
2023-06-09-09:55:14.865+02:00I----- thread(66) trace.pdweb.http.transformation:6 /build/isam/src/i4w/pdweb/webseald/http/transformation/lua/HTTPLuaTransformationRule.cpp:212: ENTER HTTPLuaTransformationRule::executeRule(/var/pdweb/shared/xslt/http-transformation/Trusteer_Lua.lua)
2023-06-09-09:55:14.865+02:00I----- thread(66) trace.pdweb.http.transformation:2 /build/isam/src/i4w/pdweb/webseald/http/transformation/lua/LuaSession.cpp:333: Retrieved the credential attribute: tagvalue_session_index / e6f8441e-069a-11ee-92b2-005056823e02
2023-06-09-09:55:14.865+02:00I----- thread(66) trace.pdweb.http.transformation:2 /build/isam/src/i4w/pdweb/webseald/http/transformation/lua/LuaHttpResponse.cpp:448: Setting response cookie: tr_user_csid (e6f8441e-069a-11ee-92b2-005056823e02:8i1ZDJVaJoIr5BF; Domain=beta.testgjensidige.no; Path=/; Secure; HttpOnly)
2023-06-09-09:55:14.865+02:00I----- thread(66) trace.pdweb.http.transformation:5 /build/isam/src/i4w/pdweb/webseald/http/transformation/lua/HTTPLuaTransformationRule.cpp:262: Returning the Lua handle to the pool.
2023-06-09-09:55:14.865+02:00I----- thread(66) trace.pdweb.http.transformation:9 /build/isam/src/i4w/pdweb/webseald/http/transformation/HTTPTransformationEngine.cpp:308: Process response line: GET /mga/sps/authsvc/policy/username_login?URL=https://beta.testgjensidige.no/kunde/privat&username=notworking&partref=notworking&type=no-privat HTTP/1.1 with rule: Trusteer_Lua.
2023-06-09-09:55:14.865+02:00I----- thread(66) trace.pdweb.wns.authn:8 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-doauth.cpp:2230: [10.113.110.182] CII EXIT doEAIAuth with status:  0x3898319e and return code: 1{noformat}


",,Daniel Comeau,Dermot Daly,Gabe,gvacek,Nick Lloyd,Tushar Prasad,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5c87cb8d88f9ec6ae0afb306,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5151,,,,,,,,,,,,,,,,,,,,,IJ47289,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013273921,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,TIETOEVRY NORWAY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-06-21T18:00:07.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cjdz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-09 15:56:19.038,,,,,"10/Jun/23 1:56 AM;5b15d9a0dda5f94d06b985b3;The traces that Alan is referring to but didn’t mention can be found at 

/ecurep/sf/TS013/273/TS013273921/2023-06-09/isva_10.0.4.0_20230609-095726_ISAM-DMZ-WS1-TEST.support_unpack/var/pdweb/beta_gjensidige_no/trace

and in particular the thread 66 one

wstrace_pdweb.snoop_pdweb.log.66.out


The lua transformation rule seems to work but returns an error code that EAI seems to interpret as an error",12/Jun/23 7:37 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] can you take the initial look at this one for us.,"16/Jun/23 1:18 AM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Is there any update, please?","16/Jun/23 11:07 AM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] I’m still investigating, will add an update when I find anything to share","19/Jun/23 11:56 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Is there any update, please? The customer is asking for update.","20/Jun/23 12:20 AM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] The customer would like to have a call with you about this case. 

Will you be free @ 18:30 on June 20th. Please confirm if you can attend. 

My Webex is [https://ibm.webex.com/meet/alanwong12|https://ibm.webex.com/meet/alanwong12|smart-link] 

Thanks","20/Jun/23 12:25 PM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] I’m unfortunately not free today. What is the purpose of the call?

I have been able to recreate the problem they mentioned and also verify a test fix successfully. It is attached in the linked item [https://cloudidentity.atlassian.net/browse/ISAMSUP-5151|https://cloudidentity.atlassian.net/browse/ISAMSUP-5151|smart-link] 

Can you have them try (it is compatible with the fixes they already have installed) and see how it goes?

Also create an APAR.","20/Jun/23 1:15 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e9fca85b6475ffc397110e0a8c75634a619291e6
   * description: ISAMSUP-5131 Ensure Lua response processing returns correct status

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1522111.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5131) which we publish.",20/Jun/23 5:45 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] No problem. Thanks for your great work to produce the fix pack. They are on v10.0.4 (not IF1) is it ok?,20/Jun/23 9:38 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] The customer confirm the fix pack solved the issue.,21/Jun/23 12:05 AM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Thanks for your great work. I am raising an APAR for it. Could you let us know what is the actual issue you found? So i can put it in APAR ,21/Jun/23 8:46 AM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] I thought the linked item spelled out clearly what the issue is and the fix does?,"21/Jun/23 11:13 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e9fca85b6475ffc397110e0a8c75634a619291e6
   * description: ISAMSUP-5131 Ensure Lua response processing returns correct status

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1522111.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5131) which we publish.","21/Jun/23 6:00 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ea945d3cc83487bc9a0c4728f38b2c9816728884
   * description: ISAMSUP-5131 Ensure Lua response processing returns correct status (#5989)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1579409.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230621075717-ea945d3c.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",21/Jun/23 10:59 PM;6092aca0f0db130069d19687;APAR  IJ47289 is created,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Need documentation update from TAMOriginalURL to ISAMOriginalURL,ISAMSUP-5128,305393,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,08/Jun/23 2:45 AM,09/Jun/23 1:40 AM,14/Jul/23 2:47 PM,09/Jun/23 1:40 AM,,Support,,0,,,,"The following documentation still references ‘TAMOriginalURL’ when the current template files use ‘ISAMOriginalURL’:

[https://www.ibm.com/docs/en/sva/10.0.5?topic=redirection-preserving-html-fragments|https://www.ibm.com/docs/en/sva/10.0.5?topic=redirection-preserving-html-fragments|smart-link] 

I found this while working case TS013241672. It doesn’t affect the closing of the case but it was brought up by the customer during a WebEx.",,David Hayes,jcyarbor,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013241672,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,KPMG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1chn3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-08 02:39:48.86,,,,,"08/Jun/23 2:47 AM;5bac25aaabfcbf73d13e733b;The documentation update should be pretty cut and dry. Replace all instances of ‘TAMOriginalURL’ to ‘ISAMOriginalURL’.

You can check the templates for ‘login.html’ and ‘redirect.html’ to confirm that it is indeed ‘ISAMOriginalURL’.","08/Jun/23 12:39 PM;5b232b2fd85e5b59b066f57f;[https://github.ibm.com/isva-idd/SSPREK_10.0.x/pull/259|https://github.ibm.com/isva-idd/SSPREK_10.0.x/pull/259] created. 

Can close this out? ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA jQuery vulnerability enquiry,ISAMSUP-5127,305343,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,07/Jun/23 7:54 PM,09/Jun/23 1:40 AM,14/Jul/23 2:47 PM,09/Jun/23 1:40 AM,,Support,08/Jun/23 12:00 AM,0,,,,"Customer, Koninklijke Ahold Delhaize, are saying they have a high severity disclosure finding in ISVA 10.0.1.0 and are stating the following;
"" _The Vuln number is CWE-200 and Vuln/SSPR/02. The vulnerability is complaining about jquery-3.3.1min.js. Can you pls. suggest on how we can fix this vulnerability? Also is it possible to restrict this javascript at the webseal level? If we can, will there by any impact? We also noticed that this javascript is being called by the apps._ ""

L2 asked customer if they could provide more information or even a CVE ID reference, no such information has been provided except the following;
"" _The finding is that we should mask up version number in the file name( jquery-3.3.1.min.js). Is there anyway that we can hide / rename the file?_ ""
And later, more recent update;
” _The question here is that we do not want to render the version number in the jquery*.js file name. Currently it showing jquery-3.3.1.js and we would like get rid off the version number (3.3.1). Can we rename this file name from jquery-3.3.1.js to jquery.js?_ “

L2 struggling to find definitive information concerning jQuery and ISVA, and seeking clarification from L3 concerning this matter in relation to the customers query.",,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,07/Jun/23 8:36 PM;ug:0d23f3f4-385c-47fa-b5f8-ecbd0333ad03;image-20230607-102014.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204411,07/Jun/23 8:36 PM;ug:0d23f3f4-385c-47fa-b5f8-ecbd0333ad03;image-20230607-102700.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204410,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013166284,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,Koninklijke Ahold Delhaize,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1chd3:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-06-08 03:04:15.472,,,,,"07/Jun/23 8:36 PM;6154906364ff01007106e189;According to the following community article back in Sept 2021
[https://community.ibm.com/community/user/security/communities/community-home/digestviewer/viewthread?MessageKey=8fbf4278-e0a6-4a4f-a540-062712756c68&CommunityKey=e7c36119-46d7-42f2-97a9-b44f0cc89c6d&tab=digestviewer#bm8adb86cf-2446-4656-99ea-3fd2d42c65a4|https://community.ibm.com/community/user/security/communities/community-home/digestviewer/viewthread?MessageKey=8fbf4278-e0a6-4a4f-a540-062712756c68&CommunityKey=e7c36119-46d7-42f2-97a9-b44f0cc89c6d&tab=digestviewer#bm8adb86cf-2446-4656-99ea-3fd2d42c65a4|smart-link] “ In v10.0.1 we moved to JQuery v3.5.1. “  BUT ……

I spun out a basic ISVA 10.0.1.0 VM and under;
LMI → AAC → Template files → c → mmfa → user → mgmt → mmfa → usc → static → js → vendor → jquery.js
see the following header;

jQuery JavaScript Library v1.12.3  i.e.

!image-20230607-102014.png|width=380,height=124!

Whereas in an ISVA 10.0.4.0 VM I do see v3.5.1 i.e.

!image-20230607-102700.png|width=377,height=115!

Are there any tech note URLs on this topic re ISVA & jQuery? As I cannot find any. What are customers options re this scenario?
i.e.
1) Can the jQuery file be renamed?
2) Can the jQuery file be edited?
3) Can the jQuery file be replaced?
4) Or do they need to upgrade ISVA?","07/Jun/23 9:35 PM;6154906364ff01007106e189;Wish to add that the ISVA 10.0.4.0 VM where I do see v3.5.1 was built off the isva_10.0.4.0 iso installation file back in 2022.

While the ISVA 10.0.41.0 VM I spun out this morning was built off the isva_10.0.1.0 iso install file, I then upgraded this VM to 10.0.4.0 via isva_10.0.4.0 pkg file, after which still see “ jQuery JavaScript Library v1.12.3 “ under Template files → c → mmfa → user → mgmt → mmfa → usc → static → js → vendor → jquery.js.
😕 ","08/Jun/23 1:04 PM;5b232b2fd85e5b59b066f57f;[~accountid:6154906364ff01007106e189] - in order to get the new jquery engine and remove the vulnerability - they will need to upgrade the ISVA firmware. We likely don’t update the template files on upgrade as these could have been modified / customised by the user. Ultimately, if the engine is upgraded, the vulnerability is removed - the comment in the js file regarding version is irrelevant. ","08/Jun/23 5:38 PM;6154906364ff01007106e189;Thanks [~accountid:5b232b2fd85e5b59b066f57f] for above.
Just to clear up my thinking please i.e.
In the community [article|https://community.ibm.com/community/user/security/communities/community-home/digestviewer/viewthread?MessageKey=8fbf4278-e0a6-4a4f-a540-062712756c68&CommunityKey=e7c36119-46d7-42f2-97a9-b44f0cc89c6d&tab=digestviewer#bm8adb86cf-2446-4656-99ea-3fd2d42c65a4] mentioned, Scott Exton → “ _In v10.0.1 we moved to JQuery v3.5.1. No updates have been made since then…….._ “
Customer says they are running ISVA 10.0.1.0 yet, their vulnerability test are complaining about jquery-3.3.1min.js ?
What is the minimum ISVA version customer needs to upgrade to in this scenario, if any?","09/Jun/23 1:40 AM;6154906364ff01007106e189;Informed customer earlier today i.e.
Feedback from ISVA L3 is as follows; "" _if the jQuery engine is upgraded, the vulnerability is removed, so in order to get the new jQuery engine and remove the vulnerability, one will need to upgrade ISVA firmware._ ""

ISVA L2/L3 do +_NOT_+ support or recommend any form of modify, amend, delete on the jQuery component in ISVA. The only method to do so, is via an ISVA firmware upgrade.

----

Customer has now agreed to close TS013166284, so we are good to close here too. Thank you.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
IAG: Inactive timeout is not effective with server/failover configuration ,ISAMSUP-5116,304518,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Kenji Seta,5b209ff1a56d9112a2a6f638,Kenji Seta,5b209ff1a56d9112a2a6f638,02/Jun/23 12:07 PM,13/Jun/23 11:28 AM,14/Jul/23 2:47 PM,13/Jun/23 11:28 AM,,,,0,,,,"The customer configures server/failover on IAG and its working.

The failover cookie seems to be valid same duration of session timeout.

They also configures inactivity timeout as follows.

{noformat}server:
  session:
    timeout: 43200
    inactive_timeout: 10800
  failover:
    key: ""@secret_files/oct-512-bit.bin""
    cookie_name: IAG-JWE
    domain_cookie: false{noformat}

However, when an end user accesses IAG after inactive timeout, he can access IAG by failover authentication. So, inactive timeout is not effective with this configuration.

Are there any way to work inactive-timeout with server/failover?

 

For reference, the reverse proxy of ISVA can keep inactive timeout working after failover cookie authentication. By configuring to add session-activity-timestamp into failover cookie. So, customer tried as follows but this was not working.

{noformat}advanced:
  configuration: 
    - stanza: ""failover""
      entry: ""failover-update-cookie""
      operation: set
      value: 
        - 300
    - stanza: ""failover-add-attributes""
      entry: ""session-activity-timestamp""
      operation: set
      value: 
        - add{noformat}

 

Tenant name:

* Production: kjcs
* Test: kjcs-dev",,khansen,Nick Lloyd,prashant_kamat,Tushar Prasad,Yutaka Kanemoto,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,5b15d9ec6d76184b7d989c83,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013122823,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Kenji Seta,5b209ff1a56d9112a2a6f638,,,,TOKIO M/F TABATA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cccv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-07 05:23:37.978,,,,,07/Jun/23 3:23 PM;5b232b2fd85e5b59b066f57f;Working with IAG dev. ,12/Jun/23 1:50 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b209ff1a56d9112a2a6f638] - feedback from IAG dev is that the this capability within IAG is not at the same level as within ISVA. An ‘idea’ should be opened in order to look at implementing this within IAG. ,"12/Jun/23 2:55 PM;5b209ff1a56d9112a2a6f638;Hi David, thank you for your answer. I informed to the customer. Please close this ticket.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Migrates appliance cluster to docker,ISAMSUP-5114,304289,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Kenji Seta,5b209ff1a56d9112a2a6f638,Kenji Seta,5b209ff1a56d9112a2a6f638,01/Jun/23 11:38 AM,09/Jun/23 2:47 PM,14/Jul/23 2:47 PM,09/Jun/23 2:47 PM,,,,0,,,,"The customer have H/W appliance cluster as production environment.

They have a plan to migrate to docker (kubernetes) environment.

However, when they tried to use snapshot generated on primary master (appliance), following error was shown.

* System Error: The snapshot file is not valid. The following validation errors were found: ""WGAWA0430E Clustering is not supported in a Docker environment.""

Since their appliance cluster is production environment, they cannot de-cluster it for taking snapshot.

Are there any way to migrate appliance cluster to docker without changing of current env?

The customer would like to request a fixpack solution for this migration.",,khansen,Nick Lloyd,prashant_kamat,Tushar Prasad,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013151365,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Kenji Seta,5b209ff1a56d9112a2a6f638,,,,INLAND REVENUE AUTHORITY OF SINGAPORE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1caxz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-05 01:08:26.338,,,,,"05/Jun/23 11:08 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b209ff1a56d9112a2a6f638] - unfortunately, using a snapshot from a clustered ISVA environment on a Docker ISVA deployment is not a supported model. The customer will need to either first uncluster the environment before creating a snapshot, or they will need to build the Docker ISVA environment from scratch. ",06/Jun/23 10:04 AM;5b209ff1a56d9112a2a6f638;Thank you so much for your answer.,09/Jun/23 2:47 PM;5ac57757d9a96536d1f0daa9;Closing as the L3 team has provided guidance as to how the customer can move forwards. Setting this Jira items status to Done. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
After ISAM upgrade from 10.0.2 to 10.0.5 the WebSEAL config file not accepting ssl-keyfile entires with .kdb.,ISAMSUP-5106,303734,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,31/May/23 5:25 PM,27/Jun/23 4:33 PM,14/Jul/23 2:47 PM,27/Jun/23 4:33 PM,,Support,,0,,,,"After upgrade to 10.0.5 , customer unable to save webseald-default configuration file even if no change is made. It shows

*_System Error_*

*_Error: DPWAP0015E An value which is not valid, 'default-webseald', was supplied for the configuration entry, 'ssl-keyfile', in the [dsess-cluster] stanza._*

What should be the ssl-keyfile and ssl-keyfile-stash to use for ISVA 10.0.5.0?

Can we set ssl-keyfile and ssl-keyfile-stash as follows:

+*ssl-keyfile = /var/pdweb/shared/keytab/pdsrv.p12*+

+*ssl-keyfile-stash = /var/pdweb/shared/keytab/pdsrv.sth*+",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013032205,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,AVP ONLY - PUBLIC BANK BERHAD,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1c7in:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-31 18:31:33.517,,,,,01/Jun/23 4:31 AM;5b15d94b6256d01ad54eb020;[~accountid:62d0e51aec233f24684a5d3a]  severity needs to match the case.  I updated to reflect that.,01/Jun/23 4:40 AM;5b15d94b6256d01ad54eb020;No you don’t set those. If you want to your own certificates you can import them.  Then use the LMI to edit your reverse proxy to use them.   This is documented.,01/Jun/23 11:51 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] can you please take a look at this item for us if there is additional questions being asked. ,"02/Jun/23 4:05 AM;5b15d9e581c3df12acf53c4a;[~accountid:62d0e51aec233f24684a5d3a] 

Upgrade is supposed to convert those .kdb file to .p12 file ( e.g.  pdsrv.kdb to pdsrv.p12 )

If conf file is still referring to pdsrv.kdb and keytab contains pdsrv.p12, then yes, you can change it.",27/Jun/23 4:33 PM;5ac57757d9a96536d1f0daa9;Case closed. Updating Jira item to reflect this status. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
WebSeal crash on HTTP/2 requests,ISAMSUP-5105,303485,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,31/May/23 1:35 AM,03/Jul/23 6:59 PM,14/Jul/23 2:47 PM,03/Jul/23 6:59 PM,,Support,09/Jun/23 12:00 AM,0,Crash,webseal,,"Hello Team, 

The customer has a reverse proxy on HTTP/2 requests to a standard junction: the WebSeal process is crashing when they enable HTTP/2 support on both the client and junction sides. If they disable HTTP/2, the reverse proxy is working fine. The impacted Reverproxy is BIDP-BNPPF-ECH-TEST in the support file attached.
several occurrences in the webseal_message.log:
{{2023-05-25-08:57:09.280+00:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 657 0x7fca6ce61700 -- WGAWA0034E The process, /opt/pdweb/bin/webseald, was terminated by the signal, 11. The process will be automatically restarted. -- IBM Security Verify Access WebSEAL Version 10.0.4.0 (Build 20220608_0037) -- Copyright (C) IBM Corporation 1994-2022. All Righut}}

{noformat}2023-05-25-09:04:12.348+00:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 657 0x7fca6ce61700 -- WGAWA0034E   The process, /opt/pdweb/bin/webseald, was terminated by the signal, 11.  The process will be automatically restarted. -- IBM Security Verify Access WebSEAL Version 10.0.4.0 (Build 20220608_0037) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.
2023-05-25-09:04:12.517+00:00I----- 0x38CF0156 webseald WARNING wwa server config.cpp 6221 0x7f6c1c554dc0 -- DPWWA0342W  The configuration data for this WebSEAL instance has been logged in '/var/pdweb/BIDP-BNPPF-ECH-TEST/log/config_data__BIDP-BNPPF-ECH-TEST-webseald-stsra735.log'
2023-05-25-09:04:12.599+00:00I----- 0x1354A0CD webseald WARNING ivc general azn_maint.cpp 5957 0x7f6c1c554dc0 -- HPDCO0205W  ------------------------------------------------
2023-05-25-09:04:12.599+00:00I----- 0x1354A0CC webseald WARNING ivc general azn_maint.cpp 5960 0x7f6c1c554dc0 -- HPDCO0204W  Informational Message - The environment variable for the running process : -- SSH_CLIENT=10.65.96.40 55940 22 -- USER=www-data -- IBM_JAVA_OPTIONS=-Xshareclasses:name=liberty-{noformat}


Core stack(seeing the same logs in the 3 stacks):

{noformat}Thread 1 (Thread 0x7f52975b9700 (LWP 25837)):
#0  0x00007f52cbf1760b in HTTPMessage::moveFrom(HTTPMessage*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#1  0x00007f52cbf176e1 in HTTPResponse::moveFrom(HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#2  0x00007f52cbf5301e in MuxStream::doRead(HTTPResponse*, HTTPParser*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#3  0x00007f52cbf1c0ff in HTTPParser::doParseResponse(HTTPResponse*, unsigned char) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#4  0x00007f52cbf1c2a4 in HTTPParser::parseResponse(InByteStream*, HTTPResponse*, unsigned char) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#5  0x00007f52cbfb04e5 in ThirdPartyServer::doDispatchRequest(h_s_t*, HTTPRequest*, HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#6  0x00007f52cbfa716d in JunctionServer::dispatchRequest(h_s_t*, HTTPRequest*, HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#7  0x00007f52cbfaa91e in RemoteJunction::doHandleRequest(h_s_t*, ResourceInfo*, wand_client_ident_s_t const*, HTTPRequest*, HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#8  0x00007f52cbf9364b in Junction::handleRequest(h_s_t*, ResourceInfo*, wand_client_ident_s_t const*, HTTPRequest*, HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#9  0x00007f52cbf9868e in requestDispatch(h_s_t*, Junction*, HTTPRequest*, ClientOutputInfo&, HTTPResponse&, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#10 0x00007f52cbf8f46f in zprocess_and_convert(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#11 0x00007f52cbf8f7ec in process_junction(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#12 0x00007f52cbea559c in authAndProcess(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#13 0x00007f52cbf2dc1f in handleCallInternal(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned long*, unsigned int*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#14 0x00007f52cbf2f8ef in handle_call(h_s_t*, HTTPRequest*, HTTPResponse*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#15 0x00007f52cbf2c929 in call_start () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#16 0x00007f52cbf32930 in WsWorker::work() () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#17 0x00007f52cbf333a2 in WsWorkerThread () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#18 0x00007f52c903517a in start_thread () from /lib64/libpthread.so.0
No symbol table info available.
#19 0x00007f52c8435df3 in clone () from /lib64/libc.so.6
No symbol table info available.{noformat}

We also made a TCP dump on client side (F5 Big-IP) with decryption keys and we see ISVA is getting all the client requests, but it's sending back several TCP resets at the time of the process crash: 
- bidp_3_http2.pcap 
- bidp_3_sessionsecretshttp2.pms 
The same packet tracing has been done on ISVA side and is available in the support file. 
Input for the TCP dump: 
- end-user client IP: 193.58.1.131 
- F5 server IP for end-user: 10.9.168.11 
- F5 client IP for ISVA: 10.9.169.11 
- ISVA RP server IP: 10.9.176.21

Attaching the Support file and webseal_msg.logs also the Stack traces, HAR traces
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fcore_file_stack_trace%2F&filepath=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fcore_file_stack_trace%2Fcore_webseald.24484.stack|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fcore_file_stack_trace%2F&filepath=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fcore_file_stack_trace%2Fcore_webseald.24484.stack]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fvar%2Fpdweb%2FBIDP-BNPPF-ECH-TEST%2Flog%2F&filepath=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fvar%2Fpdweb%2FBIDP-BNPPF-ECH-TEST%2Flog%2Fwebseald.BIDP-BNPPF-ECH-TEST.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fvar%2Fpdweb%2FBIDP-BNPPF-ECH-TEST%2Flog%2F&filepath=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fvar%2Fpdweb%2FBIDP-BNPPF-ECH-TEST%2Flog%2Fwebseald.BIDP-BNPPF-ECH-TEST.log]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2F&filepath=TS013125477%2F2023-05-25%2Fidp.testaccess.qabnpparibasfortis.be.har|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2F&filepath=TS013125477%2F2023-05-25%2Fidp.testaccess.qabnpparibasfortis.be.har]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2F&filepath=TS013125477%2F2023-05-25%2Fbidp_3_http2.pcap|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2F&filepath=TS013125477%2F2023-05-25%2Fbidp_3_http2.pcap]",,Alan Wong,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,Tushar Prasad,Virag Patel,,,,,,,,6092aca0f0db130069d19687,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013125477,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,BNP PARIBAS PARTNERS FOR INNOVAT,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fcore_file_stack_trace%2F&filepath=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fcore_file_stack_trace%2Fcore_webseald.24484.stack

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fvar%2Fpdweb%2FBIDP-BNPPF-ECH-TEST%2Flog%2F&filepath=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2Fvar%2Fpdweb%2FBIDP-BNPPF-ECH-TEST%2Flog%2Fwebseald.BIDP-BNPPF-ECH-TEST.log

https://ecurep.mainz.de.ibm.com/ae5/#id=TS013125477&path=TS013125477%2F2023-05-25%2Fisva_10.0.4.0_20230525-110616_stsra735.support_unpack%2F",,,,,,,,,AIX,Linux 86_64,Windows Server 20xx,,,,,,,,,,,,0|i1c5zb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-30 23:49:06.529,,,,,"31/May/23 9:49 AM;5b15d954b0d76456f36daf33;This looks like a duplicate of the problem in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4726|https://cloudidentity.atlassian.net/browse/ISAMSUP-4726|smart-link] 

So you can ask the customer to try the workaround mentioned there with:

{{persistent-con-timeout=0}}",31/May/23 5:33 PM;60f541a6d0134900692d91b7;[~accountid:5b15d954b0d76456f36daf33] thank you i will update the customer,"02/Jun/23 7:41 PM;60f541a6d0134900692d91b7;[~accountid:5b15d954b0d76456f36daf33] The customer tested with {{persistent-con-timeout=0}} and it worked for them but they say,

“According to this doc - [https://www.ibm.com/docs/en/sva/10.0.4?topic=stanza-persistent-con-timeout|https://www.ibm.com/docs/en/sva/10.0.4?topic=stanza-persistent-con-timeout|smart-link] , the value 0 is not valid, as the minimum value is 1. So I was wondering what does the value of 0 means:

is it disabling persistent connections or is it making persistent connections valid forever, until the backend is closing it?

As you may know, those persistent connections are required in our Prod environment, to allow better performances and avoid too many TLS-handshakes. So it's a valid workaround, but not for our Prod environment, unfortunately.”","03/Jun/23 9:06 AM;5b17571b91981f4fdde632c1;* Please confirm
** *NOT WebSEAL front-end for this change* {color:#bf2600}*[server] persistent-con-timeout=0*{color}
** WebSEAL back-end
*** [junction] persistent-con-timeout = 0
**** -OR-
*** [junction:{junction_id}] = 0



* Difference between junction and junction sever
** A junction is unique and separate from other junctions
*** A junction may have
**** One server defined :   A junction with ONE +junction server+
***** -OR-
**** <NUMBER> servers defined:  A junction with  <NUMBER> +junction servers+



* WebSEAL back-end architecture is *completely* different than the front-end
** Each WebSEAL back-end +junction server+ would have it  *OWN* connection pool
*** The WebSEAL back-end +junction server+ only communicates with that ONE server
**** The SSL/TLS session reuse would make this lighter performance
***** The customer *can* test the performance impact to prove lighter performance
*** {color:#ff991f}*Unless the customer has a load-balancer between WebSEAL back-end and back-end junction server.  If not terminated at the load balancer, then most likely they are doing full SSL/TLS handshakes.*{color}



* {color:#bf2600}*[server] persistent-con-timeout=0*{color} 
** WebSEAL front-end architecture has many different clients talking to the one server
*** Which *could* have higher performance requirements
**** To my knowledge one customer was forced to [server] persistent-con-timeout=0 due to WebSEAL poor front-end client behavior
***** They tested the performance and found no difference
****** Not a guarantee
*** Customer *should* test the performance impact for the setting","05/Jun/23 11:53 AM;5b15d954b0d76456f36daf33;[~accountid:60f541a6d0134900692d91b7] 

Setting the value to 0 disbales the persistent connection. As noted in the other item I linked at the beginning:

_The issue was the http2 junctions are supposed to ignore the junction persistent connection settings - as http2 only makes 1 connection to the junction server and sends all the requests over the single connection._

There is no need for a fixpack if the customer is happy with leaving the {{persistent-con-timeout = 0}} setting in place for each specific http2 junction. But if they really want to, they can apply the fixpack in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4911|https://cloudidentity.atlassian.net/browse/ISAMSUP-4911|smart-link]  to achieve the same.

Have them try that and see if it helps address their concerns.","03/Jul/23 6:59 PM;60f541a6d0134900692d91b7;[~accountid:5b15d954b0d76456f36daf33] Thank you for your help, the customer has accepted to close the case",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Questions about vulnerabilities (RHSA-2022:7089 RHSA-2023:0625 CVE-2023-27536),ISAMSUP-5102,302690,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Mitsukazu Nakai,5bb6a576c39135735a7db132,Mitsukazu Nakai,5bb6a576c39135735a7db132,29/May/23 7:02 PM,02/Jun/23 1:44 PM,14/Jul/23 2:47 PM,02/Jun/23 1:44 PM,,,,0,,,,"The following security advisories and vulnerability information have been released:
RHSA-2022:7089
[https://access.redhat.com/errata/RHSA-2022:7089|https://access.redhat.com/errata/RHSA-2022:7089|smart-link] 
RHSA-2023:0625
[https://access.redhat.com/errata/RHSA-2023:0625|https://access.redhat.com/errata/RHSA-2023:0625|smart-link] 
CVE-2023-27536
[https://nvd.nist.gov/vuln/detail/CVE-2023-27536|https://nvd.nist.gov/vuln/detail/CVE-2023-27536|smart-link] 

* There were no reports related to these information in ""IBM Product Security Central""...


Customers have the following questions regarding these:
Q1. Is verify-access-wrp container (10.0.3) affected by these vulnerabilities?
Q2. Does verify-access-wrp container (10.0.3) use libksba library or curl library?
Q3. Which version of ISVA fixes these vulnerabilities? (Is it already fixed in 10.0.5?)

Could you please answer these questions?
Thank you.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013085544,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Mitsukazu Nakai,5bb6a576c39135735a7db132,,,,MACQUARIE GROUP SERVICES AUSTRALIA PTY LIMITED,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1c0fb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-05-30 22:00:01.473,,,,,"31/May/23 8:00 AM;5b15d8fd6e93913e31e279fb;[~accountid:5bb6a576c39135735a7db132] 

For RHSA-2022:7089 the affected library is present in the RedHat UBI shipped with 10.0.3.  It should be fixed in the RedHat UBI shipped with 10.0.5.  We do not use the functions in the library so we are not “vulnerable” only “affected”.

For RHSA-2023:0625 the affected library is present in the RedHat UBI shipped with 10.0.3.  It will not be fixed until the RedHat UBI shipped with 10.0.6.

We do not use the functions in the library so we are not “vulnerable” only “affected”.

For CVE-2023-27536 it is listed as “Affected” in RedHat UBI 8 so there is not a fix available and will not be available in the RedHat UBI until they have fixed the issue.  I am not aware if we are vulnerable or not since it has not been evaluated until the fix is available.



Please see our RedHat UBI support policy for containers at [https://www.ibm.com/support/pages/ibm-security-access-manager-and-ibm-security-verify-access-docker-support-policy|https://www.ibm.com/support/pages/ibm-security-access-manager-and-ibm-security-verify-access-docker-support-policy]","01/Jun/23 11:09 AM;5bb6a576c39135735a7db132;Hi [~accountid:5b15d8fd6e93913e31e279fb] 
Thank you for your support.

Thank you very much for your detailed answer.

Regards,
Mitsukazu Nakai",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"Multiple UDPManager threads can be run, which leads to 'maximum number of DatagramSockets reached' errors over time",ISAMSUP-5097,302236,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,26/May/23 7:36 AM,11/Jul/23 7:20 AM,14/Jul/23 2:47 PM,,,,,0,,,,"Customer reported that in 10.0.3.1 they are still seeing the error {{maximum number of DatagramSockets reached}} In [https://cloudidentity.atlassian.net/browse/ISAMSUP-5095|https://cloudidentity.atlassian.net/browse/ISAMSUP-5095|smart-link] it was confirmed the previous fix is included in 10.0.3.1 and later. 



At one point the customer had the runtime throw a javacore, due to the number of threads.  For example there are 421 threads in UDPManager.java

javacore.20230520.000245.9389.0004.txt:4XESTACKTRACE                at com/ibm/isam/logging/syslogclient/UDPManager.run(UDPManager.java:102(Compiled Code))

javacore.20230520.000245.9389.0004.txt:4XESTACKTRACE                at com/ibm/isam/logging/syslogclient/UDPManager.run(UDPManager.java:110(Compiled Code))


Because there are many threads running this has caused there to be 4136 threads using a UDP connection

Most are like this

javacore.20230520.000245.9389.0004.txt:4XESTACKTRACE                at com/ibm/isam/logging/syslogclient/UDPConnector.call(UDPConnector.java:84(Compiled Code))

It also looks like there are 3 threads that had attempted to create a new socket but the bind failed and are logging the exception.

Such as:

{{5/20/23, 19:43:28:736 EDT] 01cff666 com.ibm.isam.logging.syslogclient.UDPConnector I java.net.SocketException: maximum number of DatagramSockets reached at java.base/sun.net.ResourceManager.beforeUdpCreate(Unknown Source) at java.base/java.net.AbstractPlainDatagramSocketImpl.create(Unknown Source) at java.base/java.net.DatagramSocket.createImpl(Unknown Source) at java.base/java.net.DatagramSocket.<init>(Unknown Source) at java.base/java.net.DatagramSocket.<init>(Unknown Source) at com.ibm.isam.logging.syslogclient.UDPConnector.bind(UDPConnector.java:133) at com.ibm.isam.logging.syslogclient.UDPConnector.call(UDPConnector.java:75) at java.base/java.util.concurrent.FutureTask.run(Unknown Source) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.base/java.lang.Thread.run(Unknown Source)}}


This is clearly a defect as there should never be nearly 5000 threads in these states. 



I’ve been able to recreate the issue where I have multiple threads and multiple tied up UDP connections.   For me the sequence to trigger it is to register a new webAuthn authenticator, reload the runtime, a *new thread with UDPManager.java:110 will appear, along with x new threads from the number configured Sender Threads in the audit config setting.*     I’ve been able to repeat this several times but I’ve not yet identified the execution chain that could lead to new SyslogHandler being called multiple times The sysloghandler calls new 

 pool.execute(new UDPManager(props.getServerHost(), props.getPort(),..




The customer reported this at 10.0.3.1 and I’ve recreated it at 10.0.5 No IF.
",,Annelise Quap,David Hayes,jcyarbor,khansen,Nick Lloyd,,,,,,,,,,,5b15d950d9936c61022057fe,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013081200,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,Allstate,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bxnz:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,ISVA 10.0.5.0,,,,,,,,,,,,2023-05-26 20:44:06.83,,,,,26/May/23 7:36 AM;5b15d950d9936c61022057fe;[~accountid:5bb2c13f59e46d7be31a9e54] [~accountid:5bac25aaabfcbf73d13e733b] I was looking at this case as they asked about it on the AVP call. ,"26/May/23 8:59 AM;5b15d950d9936c61022057fe;On further testing this does not appear to be triggered by reloading the runtime.   Simply the act of removing/adding a new webAuth seems to trigger it. 

Timeline
5:20 restarted runtime.
5:22 took first javacore    (1 UDPManager thread + 10 SenderThreads)
5:24 reloaded runtime
5:26 took second javacore   (1 UDPManager thread + 10 SenderThreads)
5:28 reloaded runtime
5:30 took third javacore    (1 UDPManager thread + 10 SenderThreads)
5:35 logged in, removed and created a new webauthn authenticator.
5:38 took fourth javacore   (2 UDPManager threads + 20 SenderThreads)
5:40 reloaded runtime
5:42 took fifth javacore    (2 UDPManager threads + 20 SenderThreads)
5:44 removed and created a new webauthn authenticator.
5:46 reloaded runtime
5:48 took sixth javacore    (3 UDPManager threads + 30 SenderThreads)
5:50 removed and created a new webauthn authenticator.
5:52 took seventh javacore  (4 UDPManager threads + 40 SenderThreads)
5:54 removed and created a new webauthn authenticator.
5:56 took eighth javacore   (5 UDPManager threads + 50 SenderThreads)
5:58 took ninth javacore    (5 UDPManager threads + 50 SenderThreads)

I had my Sender Threads to 10, so at the end of the run I had 55 threads when the expected result would just be 11 total.",26/May/23 9:07 AM;5b15d950d9936c61022057fe;Repeated calls to remove add the authenticator only result in 1 extra thread till a new javacore is collected.  So there appears to be another part to the trigger. ,"26/May/23 9:11 AM;5b15d950d9936c61022057fe;If I create new webauthn registration, reload runtime, and then create a new webauthn, then take a javacore that will show two new threads. ",26/May/23 9:14 AM;5b15d950d9936c61022057fe;If needed I can supply traces from my lab with the Javacores but this is something that L3 can also recreate locally,"27/May/23 6:44 AM;5b15d94b6256d01ad54eb020;*Internal comments:*

I think I see what’s going on.  In the messages file we do have a stack from when it was trying to create a thread.

Here’s a partial stack: 

{noformat}        at java.base/java.lang.Thread.startImpl(Native Method)
        at java.base/java.lang.Thread.start(Unknown Source)
        at java.base/java.util.concurrent.ThreadPoolExecutor.addWorker(Unknown Source)
        at java.base/java.util.concurrent.ThreadPoolExecutor.execute(Unknown Source)
        at java.base/java.util.concurrent.Executors$DelegatedExecutorService.execute(Unknown Source)
        at com.ibm.isam.logging.syslogclient.SyslogHandler.<init>(SyslogHandler.java:153)
        at com.tivoli.am.fim.audit.handler.impl.CBEXMLSyslogEventHandler.init(CBEXMLSyslogEventHandler.java:117)
        at com.tivoli.am.fim.audit.event.impl.AuditAdapterImpl.initializePlugin(AuditAdapterImpl.java:246)
        at com.tivoli.am.fim.audit.event.impl.AuditAdapterImpl.initialize(AuditAdapterImpl.java:156)
        at com.tivoli.am.fim.audit.event.impl.AuditAdapterImpl.<init>(AuditAdapterImpl.java:108)
        at com.tivoli.am.fim.audit.event.impl.RuntimeAuditAdapterImpl.<init>(RuntimeAuditAdapterImpl.java:47)
        at com.tivoli.am.fim.audit.event.impl.AuditFactorySingleton.doInit(AuditFactorySingleton.java:128)
        at com.tivoli.am.fim.audit.event.impl.AuditFactorySingleton.doInit(AuditFactorySingleton.java:107)
        at com.tivoli.am.fim.audit.event.impl.AuditFactorySingleton.getAuditInstance(AuditFactorySingleton.java:427)
        at com.tivoli.am.fim.audit.event.AuditHelper.getAuditAdaptor(AuditHelper.java:2061)
        at com.tivoli.am.fim.audit.event.AuditHelper.isAuditable(AuditHelper.java:2084)
        at com.tivoli.am.fim.audit.event.AuditHelper.isAuditable(AuditHelper.java:2051)
        at com.tivoli.am.fim.trustserver.sts.modules.STSMapDefault.executeMappingRules(STSMapDefault.java:230)
        at com.tivoli.am.fim.trustserver.sts.modules.OAuth20MappingRuleSTSModule.doMap(OAuth20MappingRuleSTSModule.java:317)
        at com.tivoli.am.fim.trustserver.sts.modules.STSMapDefault.invoke(STSMapDefault.java:73){noformat}



You get a new thread every time when these are  called.

        at com.ibm.isam.logging.syslogclient.SyslogHandler.<init>(SyslogHandler.java:153)
        at com.tivoli.am.fim.audit.handler.impl.CBEXMLSyslogEventHandler.init(CBEXMLSyslogEventHandler.java:117)



I think this same stack is called every time a mapping rule is run.","27/May/23 10:23 AM;5b15d950d9936c61022057fe;It seems something is triggering the audit init twice in close timing.   Causing the first set of threads to be orphaned.  That is the root cause (which if found should be fixed) but it leads to the orphaned threads like  UDPConnector callables are deadlocked on a ArrayBlockingQueue.take and thus never get cleaned up.  Because the init happens twice the interrupt is never sent to do the cleanup on the first set of threads and they just sit there and build up in deadlock states.

Even changing the threads so that they don’t block forever they will never receive the interrupt in the case since they got orphaned.    

I’ll do some more testing on Tuesday to see if I can find what is kicking off the init the second time in less than 100 ms orphaning the threads. 



I’m thinking it has to do with a lazy loading/init and two requests being sent in with the second one starting processing before the first has finished setting up the audit handlers, thus the second call thinking it hasn’t been done yet and starts it again. ",31/May/23 7:58 AM;5b15d94b6256d01ad54eb020;The problem is this line:   AuditAdapterImpl.java:246   from the stack.  That  line calls  CBEXMLSyslogEventHandler.init() which creates a new SyslogHandler.   This is done every time a rule  is run.    So if you run a  rule  a 100 times you will probably get 100 new threads.  This is due to how the  JS  executed using   the mozilla engine. They sandboxed it so every execution of a rule is run in isolation.   So what I think happens is that resources are getting created but not cleaned up.  In this case I would think we would only need to create one SyslogHandler and reuse it.  I don’t think it is used by the javascript code itself.,"02/Jun/23 12:20 AM;5b15d950d9936c61022057fe;It is not creating the thread group everytime*.*   It only creates it the first time it is run after the reload and checks to see if there is an existing handler, but when two requests come in at the same time both of the requests trigger the creation, in the process the pointer to the first is overwritten/lost and the thread group orphaned.   This do not need a mapping rule to be run to trigger this. ",07/Jun/23 8:51 AM;5b15d94b6256d01ad54eb020;There could be  multiple paths to creating the problem.   If  it is  running any js  in a sandboxed  environment  like the stack I was looking at you will get a new thread every time.,"09/Jun/23 12:45 AM;5b15d950d9936c61022057fe;But no matter the path is it not expected that the threads would clean up or self terminate, rather than blocking forever on a queue?",14/Jun/23 1:55 AM;5b15d950d9936c61022057fe;Is there any update on this issue?.   I need to provide an update to Allstate. ,14/Jun/23 1:57 AM;5b15d950d9936c61022057fe;May I open an APAR for this?,14/Jun/23 2:09 AM;5b15d950d9936c61022057fe;One possible partial resolution for this may be to change the UDPConnector callables so that they do not deadlocked on a ArrayBlockingQueue.take which will never get updates.    I don’t know if changing this to a poll that can timeout would fully allow the threads to detect the threadinterrupt and fully clean up as I’m not certain that signal is fully reached when the handle to the manager class and queue is overwritten rather than shutdown.    ,22/Jun/23 12:45 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d950d9936c61022057fe]   I’ve been out some recently so I am a little bit behind on things.  I’ll try to get back to you later today or tomorrow.,22/Jun/23 2:50 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d950d9936c61022057fe]  Do you still have the javacores from your tests?   I’d like to take a look at them.  Thanks.,"22/Jun/23 8:09 AM;5b15d950d9936c61022057fe;I no longer have the full set of logs from May 25, 2023 Looks like I only saved off the 3rd and 4th, and the rest were purged to to other tests.

[https://ibm.box.com/s/ljqq6oi27rpl66rbs21nd3rmckiy5xv0|https://ibm.box.com/s/ljqq6oi27rpl66rbs21nd3rmckiy5xv0|smart-link] ",22/Jun/23 8:10 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d950d9936c61022057fe]  I’ll take a look at what you have.  Thanks.,"11/Jul/23 7:12 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15d94b6256d01ad54eb020] , have you looked at the logs in Annelise’s box folder yet in her last comment?",11/Jul/23 7:18 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25aaabfcbf73d13e733b] I have the logs but I’m not done reviewing them.,"11/Jul/23 7:20 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15d94b6256d01ad54eb020] ,

Thank you the update!!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
APAR IJ33789 on 10.0.3.1,ISAMSUP-5095,301898,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Carlos Rosales,5bb2c13f59e46d7be31a9e54,Carlos Rosales,5bb2c13f59e46d7be31a9e54,25/May/23 2:55 AM,02/Jun/23 12:57 PM,14/Jul/23 2:47 PM,02/Jun/23 12:57 PM,,,,0,,,,"is the fix for APAR IJ33789 on ISVA 10.0.3.0 FP001? according to the APAR page [https://www.ibm.com/support/pages/apar/IJ33789|https://www.ibm.com/support/pages/apar/IJ33789] the fix is included on 10.0.3.0 FP001 however the list of APARs for FP001 doesn’t show IJ33789 listed [https://www.ibm.com/support/pages/node/6556988|https://www.ibm.com/support/pages/node/6556988]
",,jcyarbor,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ33789,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013081200,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Carlos Rosales,5bb2c13f59e46d7be31a9e54,,,,ALLSTATE INSURANCE CO,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bvlz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-05-24 18:09:07.173,,,,,25/May/23 4:09 AM;5b15d94b6256d01ad54eb020;APAR IJ33789  is in 10.0.3.1 ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
GLGSY0032E Error: Failed to add route:,ISAMSUP-5092,301799,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,24/May/23 7:09 PM,03/Jul/23 8:31 PM,14/Jul/23 2:47 PM,03/Jul/23 8:31 PM,,Support,25/May/23 12:00 AM,0,,,,"Customer Compass Group UK have recently upgraded both their Dev & UAT environments i.e. on March 23rd 2023 from ISAM 9.0.3 to ISVA 10.0.4 and are due to upgrade Production in June. They are using AWS and have DHCP enabled on both Management and Application interfaces. Post upgrade the following errors are appearing on afaik their Application interface only +_excessively_+ in their system message logs i.e.
~GLGSY0032E:: GLG_events:: |route_detail=inet 10.133.128.64/26 via 10.133.128.1 dev 1.2 metric 0 table main|~
~Error: Failed to add route: inet 10.133.128.64/26 via 10.133.128.1 dev eth1 metric 0 table main~

Came across similar cases raised related to these errors / noise, but these cases got closed out with no apparent explanation or resolution i.e. 

TS012375747 Deutsche Bundesbank
TS008496554 Belastingdienst CAO
TS011673809 Kyndryl

Where on the latter a Jira was raised i.e. ISAMSUP-4791 which also got closed with no findings as Kyndryl went non-responsive in TS011673809. 

Customer so far has not noticed any issues concerning these errors and is flagging should there be any concerns when they are due to upgrade Production. Customer cannot explain why DHCP is being used, has been like this since they got ISAM deployed in AWS a few years back i.e. looks like 2017. I have asked customer to carry out basic ping and traceroute tests on the erroring network to confirm there are no issues from these tests, and awaiting their reply on this.

In the meantime, seeking L3 peer review concerning this query.",,David Hayes,Dermot Daly,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,,,5b232b2fd85e5b59b066f57f,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,14/Jun/23 2:58 AM;whannon;image-20230613-165448.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/205855,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013024931,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,Compass Group UK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013024931&path=TS013024931%2F2023-05-22%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1buzz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-28 22:07:18.223,,,,,29/May/23 8:07 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] can you please review this case and provide guidance that will assist our customer to move forwards. ,02/Jun/23 2:47 AM;5b17571b91981f4fdde632c1;Downloading to l3pmrsupport,"02/Jun/23 5:29 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** Observations only
*** Last bootstrap 2023/03/23
*** Hypervisor detected: Xen HVM
*** “Failed to add route” since 2023/03/23
**** 5606 Error: Failed to add route: inet 10.133.128.0/26 via 10.133.128.65 dev eth1 metric 0 table main
**** 5661 Error: Failed to add route: inet 10.133.128.64/26 via 10.133.128.1 dev eth1 metric 0 table main
*** ","03/Jun/23 4:36 AM;5b17571b91981f4fdde632c1;* Discussed these steps with Nick Lloyd
** Nick is currently reviewing the final update
*** Posting in mean time for L2 to read and review

{noformat}================================================================================
*** Please note ***
  When you have an ipadress like a.b.c.d/##
    The subnet mask (##) translates to MANY ipaddresses
      These instructions are written so that you can compare
        All IPV4 or IPV6 subnet ipaddress(es) 
        All IPV4 or IPV6        ipaddress(es)

      When you have a failure of ipaddress(es) collisions with existing ""ip route""
        
  Please carefully follow the instructions step for step
    If something is not clear ... ask ... and I will update the instructions (if possible)
================================================================================
================================================================================

For each failing system create separate spreadsheet
  ________________________________________________________________________________

  Open new/empty  spreadsheet
    Here are Line 1 titles for each column
    Column  Title
      A     Start
      B
      C     End
      D     Address_optional_mask
      E     Adapter
      F     Line
  ________________________________________________________________________________

  Retrieve reported error
    Either
      From customer
          -OR-
      From current var/log/messages* extract

  Here is one example:
    Error: Failed to add route: inet a.b.c.d/## via w.x.y.z dev <adapter>eth1 metric 0 table main
                                     ^^^^^^^^^^
    Place first ipaddress/ipaddress_optonal_mask above in Line 2 column F ""Line""
      HIGHLIGHT Line 2 column F ""Line"" with bright background color (suggest red)
        After the spreadsheet is sorted below, it is critical to compare against the failure
  ________________________________________________________________________________

  From current Support file
    Open file support.txt
      find '+ ip route'
        For each ip route line
          Place each line in their own column F ""Line""
            Starting at Line 3 
  ________________________________________________________________________________

  For each column F ""Line"" starting at line 2
    Find the adapter name (i.e: eth0, eth1, lo0, etc)
      Copy adapter name to SAME line column E ""Adapter""
        Critical for future sort
  ________________________________________________________________________________

  For each column F ""Line""
    Copy FIRST ipaddress -OR- ipaddress/subnet
      Paste on same line column D ""Address_optional_mask""
  ________________________________________________________________________________

  #
  # For ipaddress(es) in column D ""Address_optional_mask"" that do NOT contain any slash ""/""
  #
  For each column D ""Address_optional_mask""
    Copy column D ""Address_optional_mask""
      Paste on same line column A ""Start""
      Paste on same line column C ""End""
  ________________________________________________________________________________

  #
  # For ipaddress(es) in columnn D ""Address_optional_mask"" that DO contain slash ""/""
  #
  For each columnn D ""Address_optional_mask""
    Open https://www.coderstool.com/ipv6-subnet-calculator
      This converts both IPV4/IPV6 ipaddress/subnet
        Copy column D ""Address_optional_mask"" ipaddress ONLY paste on webpage ""IPv4 or IPv6 address"" box
        REMEMBER column D ""Address_optional_mask"" subnet
          On ipv6-subnet-calculator webpage to the right of the ""IPv4 or IPv6 address"" box there is a /<number> selector
            MUST match the column D ""Address_optional_mask"" subnet
              Please double check for accuracy
                Click ""Calculate"" button
                  Copy ""Network Range"" first address (before ""-"")
                    Paste same line column A ""Start""

                  Copy ""Network Range"" second address (after ""-"")
                    Paste same line column C ""End""
  ________________________________________________________________________________

  At this point ALL columns A, C, D, E and F should NOT be empty
    Save the spreadsheet
  ________________________________________________________________________________

  #
  # Sorted by End ipadress(es)  
  #
  Sort the spreadsheet
    1)  Column E ""Adapter""
    2)  Column C ""End""

    Check line before the red box
      Compare ipaddress range from column A ""Start"" up to including column C ""End""
        For line above red box line
        For            red box line
      
    Compare ipaddress range from column A ""Start"" up to including column C ""End""
      For            red box line
      For line below red box line

  #
  # Sorted by Start ipadress(es)  
  #
  Sort the spreadsheet by Adapter/Start
    1)  Column E ""Adapter""
    2)  Column A ""Start""

    Check line before the red box
      Compare ipaddress range from column A ""Start"" up to including column C ""End""
        For line above red box line
        For            red box line
 
 Sort the spreadsheet by Adapter/End
    1)  Column E ""Adapter""
    2)  Column C ""End""     
    Compare ipaddress range from column A ""Start"" up to including column C ""End""
      For            red box line
      For line below red box line{noformat}","06/Jun/23 11:10 PM;6154906364ff01007106e189;Hi [~accountid:5b17571b91981f4fdde632c1], thank you for instructions above, but I am at a loss in understanding your flow when attempting to put your instructions together in spreadsheet format. I proceeded to review the support files and combined your instruction flow with the following;

[isva_10.0.4.0_20230522-104120_ukisecqweb001.ukippd.compass|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013024931&path=TS013024931%2F2023-05-22%2Fisva_10.0.4.0_20230522-104120_ukisecqweb001.ukippd.compass.support_unpack%2F]
1. From interfaces.txt --> eth1      inet addr:10.133.128.5  Bcast:10.133.128.63  Mask:255.255.255.192
2. From var/log/messages dominant error --> Error: Failed to add route: inet 10.133.128.64/26 via 10.133.128.1 dev eth1 metric 0 table main
3. From support.txt related routes to eth1;
10.133.128.0/26 dev eth1 scope link src 10.133.128.5   
10.133.128.64/26 via 10.133.128.1 dev eth1     
broadcast 10.133.128.0 dev eth1 table local scope link src 10.133.128.5
local 10.133.128.5 dev eth1 table local scope host src 10.133.128.5
broadcast 10.133.128.63 dev eth1 table local scope link src 10.133.128.5
fe80::/64 dev eth1 metric 256     
local fe80::47f:f9ff:fec2:86e dev eth1 table local metric 0  
multicast ff00::/8 dev eth1 table local metric 256  

----

[isva_10.0.4.0_20230522-104402_ukisecqweb002.ukippd.compass|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013024931&path=TS013024931%2F2023-05-22%2Fisva_10.0.4.0_20230522-104402_ukisecqweb002.ukippd.compass.support_unpack%2F]

# From interfaces.txt --> "" inet addr:10.133.128.108  Bcast:10.133.128.127  Mask:255.255.255.192 "" 
# From var/log/messages dominant error --> ""Error: Failed to add route: inet 10.133.128.0/26 via 10.133.128.65 dev eth1 metric 0 table main"" 
# From support.txt related routes to eth1;
10.133.128.0/26 via 10.133.128.65 dev eth1     
10.133.128.64/26 dev eth1 scope link src 10.133.128.108   
broadcast 10.133.128.64 dev eth1 table local scope link src 10.133.128.108
local 10.133.128.108 dev eth1 table local scope host src 10.133.128.108
broadcast 10.133.128.127 dev eth1 table local scope link src 10.133.128.108
fe80::/64 dev eth1 metric 256     
local fe80::862:baff:fe3e:12d6 dev eth1 table local metric 0  
multicast ff00::/8 dev eth1 table local metric 256  

----

Applying lookups on [https://www.coderstool.com/ipv6-subnet-calculator|https://www.coderstool.com/ipv6-subnet-calculator|smart-link] 
10.133.128.64/26 has a usable Host IP Range = 10.133.128.65 to 10.133.128.126 and a Broadcast Address = 10.133.128.127
10.133.128.0/26 has a usable Host IP Range = 10.133.128.1 to 10.133.128.62 and a Broadcast Address = 10.133.128.63

Attempting to put above information together with my limited networking nous - have the 2 appliance support files invalid routes applied?

Comment, feedback, any correct steering welcome.","14/Jun/23 2:58 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** Are you familiar with spreadsheets?
*** If not then we can ask [~accountid:5b15d9e6dda5f94d06b985b4] who he would suggest to help you with the spreadsheet steps
** Please explain
*** Exactly what steps you successfully completed
**** Let me see your spreadsheet
*** Exactly what step/part is not understood
**** What do you think the step means?
**** What is not clear about that step?
** Here is the example of one “ip route” unchanged
*** !image-20230613-165448.png|width=1577,height=53!

*** Column F: “ip route”  unchanged
** Columns D & E come from you manually copying the pertinent part from the “ip route” unchanged
** Columns A & E come from you manually when you use add_mask from the website provide
*** Column D because of the the netmask 
***# Becomes a range of addresses
***## Column A: start
***### All the way to
***## Column B:end
** If you follow all of the instructions the final steps of the instructions sorting the spreadsheet
*** Two ways
**** In order
***** Review 
**** Reverse order
***** Review
*** Allow you to find any IP conflict/collisio
** Because of the netmasks the ranges are very error prone if done incorrectly … the spreadsheet is the be way to do the steps, sort and identify

-","03/Jul/23 8:31 PM;6154906364ff01007106e189;L2 provided the following feedback to the customer on June 9th

{{It appears that the application interface IP address is not within the range of the static route defined/added.}}
{{Its best to use an online ipv4-subnet-calculator to understand this scenario a bit more to determine the number of IPv4 hosts, host range, network and broadcast, subnet mask etc., i.e. there are multiple to choose from online, one example URL is }}[https://www.coderstool.com/ipv4-subnet-calculator|https://www.coderstool.com/ipv4-subnet-calculator|smart-link]{{ }}

{{Taking ukisecqweb001 as an example;}}

# {{application interface is ""eth1"" and is assigned ""inet addr:10.133.128.5	Bcast:10.133.128.63  Mask:255.255.255.192 (/26)""}}
# {{message log errors are ""Error: Failed to add route: inet 10.133.128.64/26 via 10.133.128.1 dev eth1 metric 0 table main""}}
# {{there are 2 networking routes to ""eth1"" i.e. from support.txt in the root folder of the support file;}}
{{ 10.133.128.0/26 dev eth1 scope link  src 10.133.128.5}}
{{ 10.133.128.64/26 via 10.133.128.1 dev eth1}}
{{ broadcast 10.133.128.0 dev eth1 table local scope link  src 10.133.128.5}}
{{ broadcast 10.133.128.63 dev eth1 table local scope link  src 10.133.128.5}}
# {{using ipv4-subnet-calculator for 10.133.128.64/26}}
{{Usable Host IP Range	10.133.128.65 - 10.133.128.126 and a Broadcast Address	10.133.128.127}}
{{The ""eth1"" interface IP address of 10.133.128.5 is NOT within the ""Usable Host IP Range"" of 10.133.128.65 - 10.133.128.126}}
# {{using ipv4-subnet-calculator for 10.133.128.0/26}}
{{Usable Host IP Range	10.133.128.1 - 10.133.128.62 and a Broadcast Address	10.133.128.63}}
{{The ""eth1"" interface IP address of 10.133.128.5 IS within the ""Usable Host IP Range"" of 10.133.128.1 - 10.133.128.62}}

{{ISVA L2 recommend to liaise with your networking team to redefine networking routes on or for your application interfaces.}}

Post which customer went non-responsive, L2 chased for an update and customer replied back today to say;

_“ Thanks for the update. I am happy for this case to be closed. We updated the production environment last week and do not appear to be getting any issue with the application. “_

So as per their original request i.e.

“ _Can this message be ignored?  We were not seeing this message before.  Services do not seem to be interrupted since the update._ “

It appears the customer is choosing to ignore.
Closing this Jira as a result of SF case TS013024931 now being closed.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISAM config container is repeatedly modify secCertDN and secCertSerialNumber,ISAMSUP-5090,301331,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,23/May/23 1:45 AM,30/Jun/23 1:55 PM,14/Jul/23 2:47 PM,30/Jun/23 1:55 PM,,Support,,0,,,,"When starting up the config container pod, I am seeing these changes come into LDAP repeatedly, each time the pod is recycled (extracted from the changelog db):

changenumber=487,cn=changelog
objectclass=top
objectclass=changelogentry
objectclass=ibm-changelog
changenumber=487
targetdn=principalName=ivmgrd/master,cn=Users,secAuthority=Default
changetype=modify
changetime=20230518135724
ibm-changeInitiatorsName=CN=IVMGRD/MASTER,CN=SECURITYDAEMONS,SECAUTHORITY=DEFAULT
changes=replace: secCertDN
secCertDN: CN=ivmgrd/master,O=Policy Director,C=US

changenumber=488,cn=changelog
objectclass=top
objectclass=changelogentry
objectclass=ibm-changelog
changenumber=488
targetdn=principalName=ivmgrd/master,cn=Users,secAuthority=Default
changetype=modify
changetime=20230518135724
ibm-changeInitiatorsName=CN=IVMGRD/MASTER,CN=SECURITYDAEMONS,SECAUTHORITY=DEFAULT
changes=replace: secCertSerialNumber
secCertSerialNumber: 10000001

Can you help me understand why the config container is sending these changes? The values aren't actually changing from the previous value, but for some reason, the pod is asking LDAP to change the values.",,khansen,tonyferg,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24/May/23 8:34 AM;nlloyd;config-container.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202162,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013064512,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nick Lloyd,5b15d9e6dda5f94d06b985b4,,,,KEYBANK NATIONAL ASSOCIATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,Yes,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bs5r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-23 14:16:40.503,,,,,"23/May/23 1:46 AM;5b15d9e6dda5f94d06b985b4;The product has done this for years.  Software, VM, and now container.  Customer is asking for an explanation given the values are always the same.",24/May/23 12:16 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] can you please assist [~accountid:5b15d9e6dda5f94d06b985b4] with the assessment of this Jira item?,"24/May/23 6:17 AM;5b17571b91981f4fdde632c1;* Search raw ISVA 10.0.5.0 code for
** Did not find any
*** Object class
**** *changelogentry*
**** *ibm-changelog*
*** ibm-changeInitiatorsName
*** secCertSerialNumber
* Please collect a LDAP client trace",24/May/23 8:35 AM;5b15d9e6dda5f94d06b985b4;Traces/Logs attached.,24/May/23 8:36 AM;5b15d9e6dda5f94d06b985b4;Will have to put in Box folder.  Too large to attach.,24/May/23 10:46 AM;5b15d9e6dda5f94d06b985b4;[https://ibm.ent.box.com/folder/209173908862|https://ibm.ent.box.com/folder/209173908862|smart-link] ,"25/May/23 6:46 AM;5b17571b91981f4fdde632c1;* For ISVA L3 Support only
** Still peeling the onion
*** {noformat}2023-05-23-16:30:40.384-05:00I-----	0x7fcd60ff9700	pdmgrd DEBUG8 mgr general /build/isam/src/i4w/pd/mts/PDCertAuthority.cpp 621 	CII ENTRY: PDCertAuthority::certRefreshed()
2023-05-23-16:30:40.499-05:00I-----	0x7fcd60ff9700	pdmgrd DEBUG8 mgr general /build/isam/src/i4w/pd/ivmgrd/pdmgrapi/cfgmgr.cpp 1079 	CII ENTRY: update ivmgr cert dn and serial number
	void MgrKdbObserver::update(ZObservableInterface &ob, const ZObservedParm &arg)
	{
		PD_TRACE_CII_ENTRY(COMP_PD_MGRD,SUBCOMP_MGRD_GENERAL,""update ivmgr cert dn and serial number"");

	--------------------------------------------------------------------------------

	{
		{ZObserverInterface}
			{pd_db_update}
			isva1050/src/i4w/pd/db/pddbapi.cpp pd_db_update::update 422 void pd_db_update::update(ZObservableInterface &ob, const ZObservedParm &arg)
	
			{Notifier}
			isva1050/src/i4w/pd/ivmgrd/IVNotifier.cpp Notifier::update 859 void Notifier::update(ZObservableInterface &ob, const ZObservedParm &arg)
	
			{AznServers}
			isva1050/src/i4w/pd/ivmgrd/objMgr/AznServers.cpp AznServers::update 3218 void AznServers::update(ZObservableInterface &ob, const ZObservedParm &arg)
	
	===>	{MgrKdbObserver}
			isva1050/src/i4w/pd/ivmgrd/pdmgrapi/cfgmgr.cpp MgrKdbObserver::update 1077 void MgrKdbObserver::update(ZObservableInterface &ob, const ZObservedParm &arg)
	
			{daMgmtDomain}
			isva1050/src/i4w/pd/ivmgrd/pdmgrapi/daMgmtDomain.cpp daMgmtDomain::update 493 void daMgmtDomain::update(ZObservableInterface &ob,const ZObservedParm &arg)
	
			{MrMgmtDomainMan}
			isva1050/src/i4w/pd/ivmgrd/pdmgrapi/MrMgmtDomainMan.cpp MrMgmtDomainMan::update 999 void MrMgmtDomainMan::update(ZObservableInterface &ob, const ZObservedParm &arg)
	
			{AznRulesEvaluator}
			isva1050/src/i4w/pd/libivacl/AznRulesEval.cpp AznRulesEvaluator::update 1494 void AznRulesEvaluator::update(ZObservableInterface &ob, const ZObservedParm &arg)
	
			{ReplicatedAuthznSvcPI}
			isva1050/src/i4w/pd/libivacl/ivauthzn_cache.cpp ReplicatedAuthznSvcPI::update 903 virtual void update(ZObservableInterface &ob, const ZObservedParm &arg) 
	
		isva1050/src/i4w/pd/Z/ZObserve.cpp ZAbstractObservable::notifyObservers 81 for (int i=0; i < l;++i) { Voyeur *o = (Voyeur*)observerslst_.get(i); o->voyeur_->update(*this,arg);

--------------------------------------------------------------------------------

		isva1050/src/i4w/pd/Z/ZObserve.cpp ZAbstractObservable::notifyObservers 74 void ZAbstractObservable::notifyObservers(const ZObservedParm &arg)
			isva1050/src/i4w/pd/mts/PDCertAuthority.cpp PDCertAuthority::certRefreshed 651 notifyObservers(oparm);
{noformat}","25/May/23 9:33 AM;5b17571b91981f4fdde632c1;For IBM ISVA l3 Support Only:

* #1 from pdmgrd main()

{noformat}void IVCfgManager::doInit(IVTstatus &status)
{
  ...
  // At this point update the registry with ivmgr certdn and serial number.
  // We do this in a separate thread as it can block the start-up of the
  // policy server if the LDAP server is currently unavailable.
  kdbobserver_ = new MgrKdbObserver(this);{noformat}

* 
** #2 {{MgrKdbObserpver}} spawns new thread ZThrea

{noformat}MgrKdbObserver::MgrKdbObserver(IVCfgManager* mgr)
	:ZThread(true), mgr_(mgr)
{
{noformat}

* 
** 
*** #3 {{MgrKdbObserver}} thread run
**** At thread creation time

{noformat}IVCfgManager* mgr_;
... 
void MgrKdbObserver::run()
{
	mgr_->certRefreshed();{noformat}","03/Jun/23 4:30 AM;5b17571b91981f4fdde632c1;* For IBM ISVA Support (for now … until we discuss … then it will be removed)
** Issued from pdmgrd initialization
*** Looks like it has always been this way

[~accountid:5b15d9e6dda5f94d06b985b4] ",27/Jun/23 4:46 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e6dda5f94d06b985b4] next steps on this one please? Do you need assistance from the ISVA dev team on this? ,30/Jun/23 1:55 PM;5b15d9e6dda5f94d06b985b4;Updated case this is WAD and behavior will remain.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Problems with lualdap:modify in HTTP Transformation,ISAMSUP-5073,299524,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,13/May/23 4:29 AM,22/May/23 10:16 AM,14/Jul/23 2:47 PM,22/May/23 10:16 AM,,Support,,0,,,,"The customer is trying to use ldap operations from their lua http transformation rule.

The transformation rule they are using can be found at 


{noformat}/ecurep/sf/TS013/007/TS013007659/2023-05-12/isva_10.0.5.0_20230512-123544_sasamd0022.support_unpack/var/pdweb/shared/xslt/http-transformation/lua_ldap.lua
{noformat}


They are doing a search, add, delete, and modify just to test things out.    The other operations work, but when it gets to the modify

{noformat}ld:modify {""cn=DTCC 274E6CC0-7D14-8903-DC0B-41A7279250FC,ou=users,o=kgc0418"",{ '=', givenName = ""New"", cn = ""New"", sn = ""User"", },}(){noformat}


They get an error in webseal

2023-05-12-10:09:18.676-04:00I----- 0x38CF0CEA webseald ERROR wwa lua HTTPLuaTransformationRule.cpp 448 0x7fd9f2e39700 -- DPWWA3306E   An error occurred within the Lua scripting engine: ‘/var/pdweb/shared/xslt/http-transformation/lua_ldap.lua:33: bad argument #1 to 'modify' (string expected, got table)'.

I did some testing here, and I’m seeing exactly the same thing.   

When I compare it to the example shown here

[https://lualdap.github.io/lualdap/manual/#example|https://lualdap.github.io/lualdap/manual/#example]

I can’t see anything wrong with their syntax.    We thought it might have been the space in the DN, but I get the same error even without the space.

We even saw some references online suggesting to use 
ld.modify instead of ld:modify
but that didn’t help.

Could this be a bug?

The support file that I pointed to which contains the lua file had all “pdweb” tracing enabled, but I really see nothing useful in there,

Thanks",,cholt@us.ibm.com,Daniel Comeau,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b15d994dda5f94d06b985b2,5b15d9a0dda5f94d06b985b3,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013007659,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,,,,THE DEPOSITORY TRUST & CLEARING  CORPORATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bh53:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-14 22:38:07.638,,,,,15/May/23 8:38 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] as this support case falls under the new ISVA lua implementation I thought this would be a good introduction into this implementation for your. Please let me know if you need any support on this items initial assessment. ,"15/May/23 11:51 AM;5af4ad7d4dd24c579110120b;<notes>

10.160.20.84

admin/admin

testuser1/Passw0rd

{noformat}87        2023-05-14-21:48:18.669-04:00I----- 0x38CF0CEA webseald ERROR wwa lua HTTPLuaTransformationRule.cpp 448 0x7fa03971e700 -- DPWWA3306E   An error occurred within the Lua scripting engine: '/var/pdweb/shared/xslt/http-transformation/testlua.lua:34: bad argument #1 to 'modify' (string expected, got table)'.{noformat}

[https://lualdap.github.io/lualdap/manual/|https://lualdap.github.io/lualdap/manual/|smart-link] 



This worked to add new attributes: 

{noformat}ld:modify (""cn=newuser,dc=hyperv,dc=lab"",{ '+', givenName = ""New001"", cn = ""New002"", sn = ""User003"", })
{noformat}

This worked to replace an attribute:

{noformat}ld:modify (""cn=newuser,dc=hyperv,dc=lab"",{ '=', givenName = ""New001""}){noformat}

This worked:

{noformat}ld:modify (""cn=newuser,dc=hyperv,dc=lab"",{ '=', givenName = ""Newgn001""}, { '=', sn = ""Newsn001""}, { '=', mail = ""Newcn001""}){noformat}","15/May/23 1:20 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9a0dda5f94d06b985b3] 

This worked for me:

{noformat}ld:modify (""cn=newuser,dc=hyperv,dc=lab"",{ '=', givenName = ""Newgn002""}, { '=', sn = ""Newsn002""}, { '+', mail = ""Newcn001""})
{noformat}

In this above sample I updated givenName and surName and added new attribute mail.

It worked to update.

I am not sure if there are restrictions updating certain attributes.","15/May/23 10:27 PM;5b15d9a0dda5f94d06b985b3;Thanks Asha, that works for me too.    But why doesn’t it work when we use the example in the lua docs ?   Is it a bug in our parser or something?    We don’t document lua ourselves, so either we should be able to handle what is shown in the lua docs that we refer to, wouldn’t you agree?","16/May/23 11:17 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9a0dda5f94d06b985b3] 

Format on lualdap says-

h3. {{conn:modify (distinguished_name, table_of_operations*)}}

I tried the same format and this worked too.. 

h3. {{distinguished_name as string ""cn=newuser,dc=hyperv,dc=lab"" }}  

h3. {{table_of_operations multiples as { '=', givenName = ""Newgn003""}, { '=', sn = ""Newsn003""}, { '+', mail = ""Newcn003""} }}

May be the typo is with {} vs () for passing the params to the method. 

ld:modify (""cn=newuser,dc=hyperv,dc=lab"",{ '=', givenName = ""Newgn003""}, { '=', sn = ""Newsn003""}, { '+', mail = ""Newcn003""})()

We do not do any parsing of these attributes it's based to the Lua module. ","17/May/23 3:30 AM;5b15d9a0dda5f94d06b985b3;Ok, thanks.   Waiting to see what the customer says, but I think they should be good with that.",22/May/23 10:16 AM;5af4ad7d4dd24c579110120b;Case closed hence closing Jira.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Dojo Vulnerability ,ISAMSUP-5070,299460,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,12/May/23 8:28 PM,02/Jun/23 1:43 PM,14/Jul/23 2:47 PM,02/Jun/23 1:43 PM,,Support,,0,Vulnerability,,,"Hi Team,

The client wants to know the Is this a known vulnerability and what version of ISVA will address this?

CVSSv1: 9.8 CVE-2018-15494

In Dojo Toolkit, there is unescaped string injection in dojox/Grid/DataGrid.

CVSSv1: 8.8 CVE-2010-2276

The default configuration of the build process in Dojo has the copyTests=true and mini=false options, which makes it easier for remote attackers to have an unspecified impact via a request to a (1) test or (2) demo component.

CVSSv1: 8.6 CVE-2020-5259
In affected versions of dojox (NPM package), the jqMix method is vulnerable to Prototype Pollution. Prototype Pollution refers to the ability to inject properties into existing JavaScript language construct prototypes, such as objects. An attacker manipulates these attributes to overwrite, or pollute, a JavaScript application object prototype of the base object by injecting other values.",,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,,,,,,,,,,,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012994323,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,DIENST UITVOERING ONDERWIJS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,AIX,Linux 86_64,Windows Server 20xx,,,,,,,,,,,,0|i1bgrb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-05-14 22:36:12.227,,,,,15/May/23 8:36 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] please start the PSIRT assessment process associated with this support item.,31/May/23 6:36 PM;60f541a6d0134900692d91b7;[~accountid:5b15d8fd6e93913e31e279fb] Any update on this issue please let me know if you need any further information,"31/May/23 11:52 PM;5b15d8fd6e93913e31e279fb;[~accountid:60f541a6d0134900692d91b7] 

The version of dojo in our ADKS is 1.16.3.

CVE-2018-15494 is fixed in 1.15.

CVE-2010-2276 is fixed in versions after 1.4
CVE-2020-5259 is fixed in 1.16.2

So we are not vulnerable to these CVEs.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 Config database not running V10.0.4,ISAMSUP-5060,298890,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,10/May/23 7:47 PM,22/May/23 10:03 AM,14/Jul/23 2:47 PM,22/May/23 10:03 AM,,,,0,,,,"Hello team,

We have customer complain that they cannot activate the federation module and the internal config database is not running (HVDB is running). 

They did tried to force restart in CLI and change the database pointed to external dummy DB, both action did not fix the issue.

I checked the inactive partition  it is very old verion (V9).

Please advise how to get the DB running again.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012469455,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,nikzentrum Bund (ITZBund),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bd8n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-11 10:36:19.788,,,,,11/May/23 6:43 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Please let me know if you need any trace.,"11/May/23 8:36 PM;5b15d954b0d76456f36daf33;The config db log is telling you what the problem is:

{noformat}2023-03-20 12:49:09 GMT:FATAL:  could not open log file ""/var/postgresql/logs/config/server/postgresql-Mon.log"": No such file or directory{noformat}

From their ls.txt:

{noformat}/var/postgresql/logs/config:
lrwxrwxrwx    1 pgresql  pgresql         34 Aug  9  2022 server -> /var/postgresql/config/data/pg_log{noformat}

Basically that {{server}} is pointing to a non-existent location on the appliance. Which is why the db is failing to start.

I think this is a known issue at one of the 9.0.x versions which left a stale link like this. If you compare it to hvdb, the {{server}} is a solid directory.

Fortunately, there is an existing fixpack that corrects this problem : [https://cloudidentity.atlassian.net/browse/ISAMSUP-37|https://cloudidentity.atlassian.net/browse/ISAMSUP-37|smart-link] 

Applying it will remove the stale link and restart the cluster service (which should automatically create the real {{server}} directory under config and start the db). Have them try it and see how it goes.",11/May/23 9:05 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Thank you for quick response 👍 ,22/May/23 10:03 AM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] we should be done with this. Let me know if not.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
mesa_config generate checksum issue,ISAMSUP-5052,298407,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,09/May/23 11:53 AM,10/May/23 4:50 PM,14/Jul/23 2:47 PM,10/May/23 2:30 PM,10.0.6,Support,,0,,,,"When using the mesa_config generate_checksums command

If the file containing the list of files to generate checksums for the contains a directory

mesa_config crashes with seg fault

Directories should be ignored",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-05-10T15:33:47.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1ba9z:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-09 03:25:00.327,,,,,"09/May/23 1:25 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5b8b6e0fdcb21e4ac503e512802a8103967da57a
   * description: ISAMSUP-5052 ignore directories when generating checksums

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/343139.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5052) which we publish.","10/May/23 3:33 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5096bf61c783619a32d879fcba06ea56c6a246ec
   * description: Merge pull request #5942 from ISAM/ISAMSUP-5052

ISAMSUP-5052 ignore directories when generating checksums

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/367460.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230510053034-5096bf61.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","10/May/23 4:25 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5096bf61c783619a32d879fcba06ea56c6a246ec
   * description: Merge pull request #5942 from ISAM/ISAMSUP-5052

ISAMSUP-5052 ignore directories when generating checksums

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/368037.


This build has not been published as the commit is not currently within a branch (20230510050648-b0a79a29) which we publish.","10/May/23 4:50 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5096bf61c783619a32d879fcba06ea56c6a246ec
   * description: Merge pull request #5942 from ISAM/ISAMSUP-5052

ISAMSUP-5052 ignore directories when generating checksums

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/368352.


This build has not been published as the commit is not currently within a branch (20230510053034-5096bf61) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Pkmslogout doesn't work for LTPA token cookie,ISAMSUP-5050,298316,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,08/May/23 7:33 PM,12/Jul/23 7:47 PM,14/Jul/23 2:47 PM,11/Jul/23 11:35 AM,,Support,19/May/23 12:00 AM,0,LTPAToken,requiresUpdate,,"Hi team,

The client faces the problem where Pkmslogout doesn't work for the LTPA token cookie was not removed and the user remains logged in.

{noformat}(189) 2023-04-19-13:13:50.797 Client (192.168.2.1:62404) to WebSEAL (192.168.2.86:443) sending 3153 bytes
GET /smartaccess HTTP/1.1
Host: webrun.notariato.it
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
sec-ch-ua: ""Chromium"";v=""112"", ""Google Chrome"";v=""112"", ""Not:A-Brand"";v=""99""
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: ""Windows""
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-Dest: document
Referer: https://webrun.notariato.it/pkmslogout
Accept-Encoding: gzip, deflate, br
Accept-Language: it-IT,it;q=0.9,fr;q=0.8,en-US;q=0.7,en;q=0.6
Cookie: AMWEBJCT!%2Fmypage!%2F!COOKIE_SUPPORT=true; AMWEBJCT!%2Fmypage!%2F!GUEST_LANGUAGE_ID=it_IT; _pk_id.5.7571=9c1319eccc49a56b.1680269042.; PD_STATEFUL_f8eb8960-4855-11ec-a383-74fe483ff5c5=%2Fsmartrun; PD_STATEFUL_37325010-0b5f-11e8-9c45-74fe48065e8a=%2Falbonotai; PD_STATEFUL_a699e628-c2a6-11e6-811b-74fe48065e8a=%2Finfocamere; AMWEBJCT!%2Flogininfo!TS01e9146c=01090ee16ecd1e575dd4ea9796f8779abbb09d22a4c362e3b1742fcfebb5cbf2be944d99c8c6deb7a26354a3bb2282f785925ea367; TS0194429f=01090ee16ecd1e575dd4ea9796f8779abbb09d22a4c362e3b1742fcfebb5cbf2be944d99c8c6deb7a26354a3bb2282f785925ea367; LFR_SESSION_STATE_8998395=1681893846024; AMWEBJCT!%2Fftele!nortelapp_ctx=rmfzoz53mn0kxugafvcsmmkf; AMWEBJCT!%2Fftele!culture=it; AMWEBJCT!%2Fftele!__RequestVerificationToken=s0Ta6s3wvm65RI07dtcDOedgnfhDreB4-qMjmRfVBG-gj-m3iTCEKBZFzwgEJj73drCD7g1kuJiYCTgpOhd_eZ5zPk9syJPR6nmwj0QpnaQ1; AMWEBJCT!%2Flogininfo!TS019934f0=01090ee16e99d2bd9f22c81f0d9dcd952ee3b02778087e30ef87fbd37f9d90850addd31b15dd6d10d0100e653baaf9085723ca609c; PD_STATEFUL_e43a23e8-693c-11e2-a444-005056b63684=%2Farsos; AMWEBJCT!%2FCNNNotizie!JSESSIONID=F1A7033526DED77248A854A47A17C783; PD_STATEFUL_9917fa20-db87-11e8-a6c5-74fe48065e8a=%2Frun3; _pk_id.2.7571=220038aa88db5b0c.1681895969.; AMWEBJCT!%2Flogininfo!TS0138fb12=01090ee16e3435293d3bc4fbd483648f1ecc50ae8b29795254decdc75e668ac8318f9caa8935337f9dc6d024841d3082f784b20a7c; LFR_SESSION_STATE_33783263=1681895994324; AMWEBJCT!%2Flogininfo!JSESSIONID=4RWfL4PC6jVxFfKCxmupljzfMIjdSA_m7wSPfec9.login2; AMWEBJCT!%2Frun3!JSESSIONID=5E4838936E4FC068673C63A5509C6891; AMWEBJCT!%2Fmypage!%2F!JSESSIONID=7BF3A4025817C95FE80FB212318B9CCE.mypagelf2; AMWEBJCT!%2Fmypage!%2F!TS0138fb12=01090ee16e189d75443936bb877b9db5998b83486ee047390eab540818ff4d77e7a47eddc751b7595200bdf3616903bd3e50b48265; IV_JCT=%2Frun3; 
LtpaToken2=GiGriAx3eyp0vC88iR6ngBLR+7HnpESDBeFd8I0IcfQ6/6U5ukHRCTfygS327ONEoIRZBYIeti3H84pSaYEvyC8jsVdTHQ8GGZQ16YZUcHuD7IZ8uGO/9L9HLB+QQF3p6MoRJHPFLcI94C1K5A4HW/Z2pQ+0dfBkuprwzy7EqytEw1XPp6jhfKW/h5f9nGfx1SyFZbygFxSLaVSE9eFcj+Tq599GxJ+ecsN54izvjFhOzAj8sn/jSbKnFhPjcbp4qy2d5Rew9z4ZSHVr3LI4t4IfO8D18tuRHtb0vXlIdMTriMv5ZMGOmj0ghOrGkf6pqbnWatKPLI9tLIwF0KxV10Nt5Fwg1XqVUhNbCoijmzqjpNkBAIfOF2Jq3ITe7u9EdLhWhBSu9X8X77BxYwo2h2mxQhKxXyqZYF/pFh9FnQE=; AMWEBJCT!%2Fsmartaccess!smartaccess=%7B%22smartaccess%22%3Atrue%2C%22released%22%3A%222023-04-19%2001%3A13%3A11%22%7D

thread(363), thread(375), thread(374) Same for all the other threads the LTPA token is not removed after the pkmslogout

2023-05-04-15:12:40.359+02:00I----- thread(363) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- PD <=== BackEnd -----------------

Thread 363; fd 260; local 192.168.24.229:43656; remote 192.168.25.125:8087
HTTP/1.1 302 Found
connection: close
content-length: 118
content-type: text/html; charset=utf-8
date: Thu, 04 May 2023 13:12:00 GMT
location: https://webrun.notariato.it/smartrun/
vary: Accept
x-powered-by: Express
Set-Cookie: LtpaToken2=qpRjCFydEAQx6/7vCLoO20CKkbhveCiBEVOAZIOH0/s3o3e0ZhnB4TbJcW/WJ2xA1O8pheDak46aLuvTSJdKQXfR/Y/8mlZq51wTjpqNaeyNJcdKds5xA7DQL6CE/eJn08//nRdEQtWD+WITzilDqRcv7aGWk9jCSRmkAye2mzykTIdn57zhFCR9fChICftFzOiaQda3yxtwgLd3lzMjyJXUw9otAT3g+zi0qMyUQ8rwyD5GdTvCc6NrBZ6h/eCsTLbxYiQciWr686COYXogdNd57oJjXJJ9/1Tg29fJn0qMyTjwdFpaTa9ucNRs7okFDgu3wCbDmaWTU2wPPf06wT2p1ZBzeU3Wo6wB+6hkEOBUhbYLS9KueuLQCRLpSS5KTJHp9kChGMXh7Jws2FonU3KKxBzt8vZCaVmY5RpO+LE=; Domain=notariato.it; Path=/; HttpOnly
Set-Cookie: smartaccess=%7B%22smartaccess%22%3Atrue%2C%22released%22%3A%222023-05-04%2003%3A12%3A00%22%7D; Path=../{noformat}

Also attaching the HAR file traces and the client has shared the video of Working logout and not working logout

Working pkmslogout HAR file where ltpa token is removed

!Screenshot 2023-05-08 at 10.29.34.png|width=948,height=471!

Not working pkmslogout HAR file where ltpa token is not removed

!Screenshot 2023-05-08 at 10.29.02.png|width=1610,height=1010!

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-04-24%2F&filepath=TS012712289%2F2023-04-24%2Fwebrun.notariato.it.noworklogouthar.har|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-04-24%2F&filepath=TS012712289%2F2023-04-24%2Fwebrun.notariato.it.noworklogouthar.har]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2F&filepath=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2Fpdweb.debug.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2F&filepath=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2Fpdweb.debug.log]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2F&filepath=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2Frequest.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2F&filepath=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2Frequest.log]",,cholt@us.ibm.com,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,Virag Patel,William Hannon Jr,,,,,,,,5b15d994dda5f94d06b985b2,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-3051,,,,08/May/23 7:33 PM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-05-08 at 10.29.02.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/199695,08/May/23 7:33 PM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-05-08 at 10.29.34.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/199696,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012712289,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,NOTARTEL SPA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-04-24%2F&filepath=TS012712289%2F2023-04-24%2Fwebrun.notariato.it.noworklogouthar.har

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2F&filepath=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2Fpdweb.debug.log

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2F&filepath=TS012712289%2F2023-05-04%2FDebug_request_log.zip_unpack%2Frequest.log",,,,,,,,,AIX,Linux 86_64,Windows Server 20xx,,,,,,,,,,,,0|i1b9pz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.0.1,ISVA 10.0.1.0,,,,,,,,,,,,2023-05-09 00:20:18.08,,,,,"09/May/23 10:20 AM;5b15d9517dab4c51f61b5190;Possibly IJ29437 see  [https://cloudidentity.atlassian.net/browse/ISAMSUP-2619|https://cloudidentity.atlassian.net/browse/ISAMSUP-2619|smart-link] 

As far as i can see there is not a fixpack for 10.0.1.0 - but there is a work around mentioned in the item

The second image shows the ltpa set-cookie  is missing the domain attribute which matches the APAR",09/May/23 10:40 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] I believe [~accountid:5b15d9517dab4c51f61b5190] has provided a good start to this case with him updated. Can you please run with this one and assist where you can if anything more is needed. ,"09/May/23 8:13 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9517dab4c51f61b5190] Nick helped me to suggest customer this workaround,
[cookie-attributes]
# Static attributes which will be added to the cookies before they are passed
# back to the client. Each configuration entry will be of the format:
# <cookie-name-pattern> = {[+|-<user-agent-group>]}<attr-1>{;<attr-2>;...}
#
# The '<cookie-name-pattern>' is used to match a cookie. The '*?'
# pattern matching characters can be used.
#
Example:
LtpaToken2 = Domain=""a.b""
whatever that real domain was from the config file*.*

It helps them in the logout but they can't use this workaround because their BE application using ltpa token doesn't work.","10/May/23 1:37 AM;5b17571b91981f4fdde632c1;* TS012712289/2023-04-24
** Currently have
*** Working case
**** *.mp4
**** *.har
*** Non-working case
**** *.mp4
**** *.har
** What if the difference between working and non-working cases?
*** Configuration changes?
*** Time between?
*** Please provide as much detail as possible
** Required for each  (working, non-working) scenario
*** Before starting recreate
**** IP trace started from WebSEAL
**** pdweb.snoop started from WebSEAL
*** Freshly started browser 
**** With no prior activity
**** Start har capture
**** If possible capture client ip trace
*** Recreate scenario
**** If successful recreating scenario
***** Capture exact time of recreation
***** Close browser
***** Stop IP trace
***** Stop pdweb.snoop
***** Group all data from same scenario together","18/May/23 4:11 AM;5b17571b91981f4fdde632c1;* Please also get infrastructure diagram/details
** From the the browser … all the way to the WebSEAL
*** Where the *har files were capture
** *In TRUE order (not how written below)*
*** Network balancer(s) {color:#bf2600}( layer:4 non-terminating   -or-   layer:7 terminating ){color}
*** Load balancer(s)       {color:#bf2600}( layer:4 non-terminating   -or-   layer:7 terminating ){color}
*** WebServer(s)            {color:#bf2600}( layer:4 non-terminating   -or-   layer:7 terminating ){color}
*** etc.","19/May/23 10:20 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b17571b91981f4fdde632c1] The client has shared the traces as requested for workinglogout and notworking logout
Not Working logout:
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-18%2FNoworkingLogout_passthrough_displace_meccanismFiles.zip_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-18%2FNoworkingLogout_passthrough_displace_meccanismFiles.zip_unpack%2F]


Working logout:
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-18%2Fworkingfiles.zip_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-18%2Fworkingfiles.zip_unpack%2F]



“Configuration changes? No changes.
Time between? They can't establish a recurring time.
Our environment have only single-session users and when they pass through the displace mechanism the logout issue occurs all the times”

Infrastructure details
In the production environment, The balancer are configured passthrough for SSL and the webseal close the handshake.
My test environment contact an not balanced Webseal instance directly on the Front end interface of instance and it close the handshake SSL. We have the same issue in the production environment and in my test environment.

I have parsed the pdweb.snoop files but there are many recurring threads with ltpa token2 for notworking logout,
(375) 2023-05-18-15:31:11.735 BackEnd (192.168.25.106:80) to WebSEAL (192.168.24.229:19866) sending 4096 bytes

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-18%2FNoworkingLogout_passthrough_displace_meccanismFiles.zip_unpack%2F&filepath=TS012712289%2F2023-05-18%2FNoworkingLogout_passthrough_displace_meccanismFiles.zip_unpack%2Fpdweb.snoop.log.2023-05-18-15-31-12.0.out|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012712289&path=TS012712289%2F2023-05-18%2FNoworkingLogout_passthrough_displace_meccanismFiles.zip_unpack%2F&filepath=TS012712289%2F2023-05-18%2FNoworkingLogout_passthrough_displace_meccanismFiles.zip_unpack%2Fpdweb.snoop.log.2023-05-18-15-31-12.0.out]

I need to review the HAR file and timestamp in pdweb.snoop traces","19/May/23 11:05 PM;5b15d9a0dda5f94d06b985b3;Hi Bill,

Just helping out with this one.    Here is the crux of the issue.

Looking in /ecurep/sf/TS012/712/TS012712289/2023-05-18/NoworkingLogout_passthrough_displace_meccanismFiles.zip_unpack/all.snoop.log.0.out

We find the login…



{noformat}(372) 2023-05-18-15:31:11.666 Client (192.168.2.1:54771) to WebSEAL (192.168.2.86:443) sending 1346 bytes
POST /pkmslogin.form HTTP/1.1
Host: webrun.notariato.it
Cookie: _pk_id.1.7571=afca27a3828427f5.1684414821.; _pk_ses.1.7571=1; _pk_id.5.7571=367174ddde29de78.1684414831.; AMWEBJCT!%2Fsmartaccess!smartaccess=%7B%22smartaccess%22%3Atrue%2C%22released%22%3A%22
2023-05-18%2003%3A06%3A19%22%7D; PD_STATEFUL_f8eb8960-4855-11ec-a383-74fe483ff5c5=%2Fsmartrun; PD-H-SESSION-ID=0_VIJx2R9uaUV3YFCO92o2WbhhU2o2jXtFl+eQUmopIOL1sCs/tAw=


(372) 2023-05-18-15:31:11.698 WebSEAL (192.168.2.86:443) to Client (192.168.2.1:54771) sending 2625 bytes
HTTP/1.1 302 Moved Temporarily
Set-Cookie: LtpaToken2=eCqzXvbxOsVohIo5n9JrC0lUOWXqDiUZJZFt/oYm11Tf4I9uy7a9fgqXZKUDkJuaIpuXk3eG2wNDEbW57BBIVFsLUTv4ANUr/kASjBcEvAkiXt+a7dRYu1xBgAf35Rf4zxNen1N/xtIRSSnOYsctr7vZcch6M4tJv9gMMuDhc+azTwVpLMG2zQYqv+Uya17Z6O0YPc56C+cSpKE6+NX+302kibz2BW5P5eB1zZ7aFOsbUQbqsWeS1EgrL9zyhLmxZYHZhvu/8ViPhLBagoG1PDih016F62jVWnge72dWWOi3R0eKPpa9/Fv3gOqwDmUgugFJ099ATkcWNJYHwLzxrSU1GO4Rpg85SR3ccN9a1xybXajERHghAd16MWNBuLE4dFATNiemQO6HnTyfb1mgvS1vQiP29QsAX9+lsvLWPu4=; Domain=notariato.it; Path=/; HttpOnly
Set-Cookie: PD-H-SESSION-ID=1_EtxGcT0BMFPNhxrKDUW+8ix/x9vMsFMPc8PgXaaY6+7yXRRcog0=_AAAAAQA=_WHr9B0quVE9STNODHdnAFGvCcUA=; Domain=.notariato.it; Path=/; HttpOnly{noformat}


Notice the domain here….
Set-Cookie: LtpaToken2=eCqzXvbxOsVohIo5n9JrC0lUOWXqDiUZJZFt/oYm11Tf4I9uy7a9fgqXZKUDkJuaIpuXk3eG2wNDEbW57BBIVFsLUTv4ANUr/kASjBcEvAkiXt+a7dRYu1xBgAf35Rf4zxNen1N/xtIRSSnOYsctr7vZcch6M4tJv9gMMuDhc+azTwVpLMG2zQYqv+Uya17Z6O0YPc56C+cSpKE6+NX+302kibz2BW5P5eB1zZ7aFOsbUQbqsWeS1EgrL9zyhLmxZYHZhvu/8ViPhLBagoG1PDih016F62jVWnge72dWWOi3R0eKPpa9/Fv3gOqwDmUgugFJ099ATkcWNJYHwLzxrSU1GO4Rpg85SR3ccN9a1xybXajERHghAd16MWNBuLE4dFATNiemQO6HnTyfb1mgvS1vQiP29QsAX9+lsvLWPu4=; [*Domain=notariato.it*|http://Domain=notariato.it]; Path=/; HttpOnly


Then we look at the logout….



{noformat}(301) 2023-05-18-15:31:48.500 Client (192.168.2.1:54821) to WebSEAL (192.168.2.86:443) sending 1706 bytes
GET /pkmslogout HTTP/1.1
Host: webrun.notariato.it
Cookie: _pk_id.1.7571=afca27a3828427f5.1684414821.; _pk_ses.1.7571=1; _pk_id.5.7571=367174ddde29de78.1684414831.; PD_STATEFUL_f8eb8960-4855-11ec-a383-74fe483ff5c5=%2Fsmartrun; PD_STATEFUL_e43a23e8-693c-11e2-a444-005056b63684=%2Farsos; LtpaToken2=eachBo/OtDsXofQ8zHOOqfrVF2AXjHRGIDhuqG8yCEv5kL8ijvh87FwuPd+D7leSr2ZUkfOwA0vMUH35Y8l0T51lrYin7NuQduto5zXnyyJiY6cD1ul1WQNU6m6Rnv0lx9JhWaOMKUICFA2kY4FvpFokiI2G1HMNZeNbLmW/oCrQcNlWNGDzpDgblRAH3NbtJMU6GJpLEC8CfLwoEad0CHnFWz6ndHZube0IZm2sCr68WBTIv91dPJ+scQD+QIPdeIjiGEoimYK23LuK+v3HT4T5CrhhxQQn7604sYWB2PpqPctcoGqwSEpfLh10SrjcqKGUhsz9HzDR4d+HBSGTl0wSQdugx0Xbq9A/Vm/3HJ2z88bzo97VgUbCpfVOAG1mP+YugyWokte0pSRrxr2E2S0H5VZO2vf6R6GHJ17RbGU=; AMWEBJCT!%2Fsmartaccess!smartaccess=%7B%22smartaccess%22%3Atrue%2C%22released%22%3A%222023-05-18%2003%3A31%3A04%22%7D; PD-H-SESSION-ID=1_I5l6l9FN33P2k+IlzkvFvTBupTfoSmHusyc2J0wEA1lFfbH4fsU=_AAAAAQA=_8xpfP/ehxoEOMLpBpmnLrRZgtZ4=


(301) 2023-05-18-15:31:48.502 WebSEAL (192.168.2.86:443) to Client (192.168.2.1:54821) sending 1000 bytes
HTTP/1.1 200 OK
Set-Cookie: LtpaToken2=; Max-Age=0; Expires=""Sun, 01-Jan-1995 01:00:00 GMT""
Set-Cookie: PD-H-SESSION-ID=; Max-Age=0; Domain=.notariato.it; Path=/; Expires=""Sun, 01-Jan-1995 01:00:00 GMT""; HttpOnly{noformat}


Notice the domain is missing 
Set-Cookie: LtpaToken2=; Max-Age=0; Expires=""Sun, 01-Jan-1995 01:00:00 GMT""

so the end result is we do not successfully clear that cookie which we set.",01/Jun/23 2:13 AM;5b17571b91981f4fdde632c1;Reviewing,"02/Jun/23 2:10 AM;5b17571b91981f4fdde632c1;* For ISVA Support
** HAR files *.har are clear text
** ** Please note for future **
*** For *BOTH* “request” and “response”
**** “*headers*”->”*Cookie*”
***** Appears to be the *all* of the cookies transmitted for request or response
****** Including Set-Cookie*
**** “*cookies*”
***** {color:#bf2600}Appears to be the client’s cookie jar current status{color}
****** {color:#0747a6}Only “name” and “value” are transmitted each time{color}
****** Remaining attributes are ONLY transmitted on with the Set-Cookie … yet they appear on all



[~accountid:5b15d9e6dda5f94d06b985b4] Would any of this be helpful for L2 Brown bag?

[~accountid:5ac57757d9a96536d1f0daa9] FYI


","02/Jun/23 2:24 AM;5b17571b91981f4fdde632c1;* Using the HAR information below
** Working: TS012712289/2023-04-20/webrun.notariato.it_work_logout_new.har
*** Pulling “response”->”headers”->”Cookie”
**** Isolating LtpaToken2
***** Set-Cookie=LtpaToken2=; Max-Age=0; [Domain=notariato.it|http://Domain=notariato.it]; Path=/; Expires=\""Sun, 01-Jan-1995 01:00:00 GMT\""
*** Now using “Response”->”Cookies”->LtpaToken2
**** LtpaToken2=		; path=/"",		; [domain=notariato.it|http://domain=notariato.it]"",		; expires=2023-04-20T13:03:05.226Z"",		; httpOnly=false,		; secure=false
** Non-working:  TS012712289/2023-04-20/HAR_Files.zip_unpack/webrun.notariato.it_logout_no_working.har
*** Pulling “response”->”headers”->”Cookie”
**** Isolating LtpaToken2
***** Set-Cookie=LtpaToken2=; Max-Age=0; Expires=\""Sun, 01-Jan-1995 01:00:00 GMT\""
*** Now using “Response”->”Cookies”->LtpaToken2
**** LtpaToken2=		; [domain=webrun.notariato.it|http://domain=webrun.notariato.it]"",		; expires=2023-04-19T11:12:10.816Z"",		; httpOnly=false,		; secure=false



* What is different?
** What does that mean?
** ** Please note**
*** We do not have the creation of the LtpaToken2
**** Only the /pkmslogout 
*** If anything else needed 
**** Would require entire life of LtpaToken2
***** Creation to /pkmslogout
**** Including pdweb.snoops
***** For both working and non-working
****** Just in-case coming from outside of WebSEAL

[~accountid:5b15d9e6dda5f94d06b985b4] ","03/Jun/23 3:41 AM;5b15d9a0dda5f94d06b985b3;Bill, I was looking at what you showed and looking at the traces again, but I’m still not making the connection in my mind.   

So are you saying that let's say you have two webseals using DSC.....ws1 is configured with domain session cookie, and ws2 is configured to just use a host cookie.

If I login to ws2 and get get a host cookie, and then do a pkmslogout to ws1 webseal knows that the original session cookie was created as a host cookie, and then just uses host cookie reset even though it's configured to create domain session cookies?



I don’t know what kind of logic is in the code to decide how/why the reset of the ltpatokenb2 cookie is done as host cookie instead of a domain cookie, 


{noformat}(301) 2023-05-18-15:31:48.500 Client (192.168.2.1:54821) to WebSEAL (192.168.2.86:443) sending 1706 bytes
GET /pkmslogout HTTP/1.1
Host: webrun.notariato.it
Cookie: _pk_id.1.7571=afca27a3828427f5.1684414821.; _pk_ses.1.7571=1; _pk_id.5.7571=367174ddde29de78.1684414831.; PD_STATEFUL_f8eb8960-4855-11ec-a383-74fe483ff5c5=%2Fsmartrun; PD_STATEFUL_e43a23e8-693c-11e2-a444-005056b63684=%2Farsos; LtpaToken2=eachBo/OtDsXofQ8zHOOqfrVF2AXjHRGIDhuqG8yCEv5kL8ijvh87FwuPd+D7leSr2ZUkfOwA0vMUH35Y8l0T51lrYin7NuQduto5zXnyyJiY6cD1ul1WQNU6m6Rnv0lx9JhWaOMKUICFA2kY4FvpFokiI2G1HMNZeNbLmW/oCrQcNlWNGDzpDgblRAH3NbtJMU6GJpLEC8CfLwoEad0CHnFWz6ndHZube0IZm2sCr68WBTIv91dPJ+scQD+QIPdeIjiGEoimYK23LuK+v3HT4T5CrhhxQQn7604sYWB2PpqPctcoGqwSEpfLh10SrjcqKGUhsz9HzDR4d+HBSGTl0wSQdugx0Xbq9A/Vm/3HJ2z88bzo97VgUbCpfVOAG1mP+YugyWokte0pSRrxr2E2S0H5VZO2vf6R6GHJ17RbGU=; AMWEBJCT!%2Fsmartaccess!smartaccess=%7B%22smartaccess%22%3Atrue%2C%22released%22%3A%222023-05-18%2003%3A31%3A04%22%7D; PD-H-SESSION-ID=1_I5l6l9FN33P2k+IlzkvFvTBupTfoSmHusyc2J0wEA1lFfbH4fsU=_AAAAAQA=_8xpfP/ehxoEOMLpBpmnLrRZgtZ4=


(301) 2023-05-18-15:31:48.502 WebSEAL (192.168.2.86:443) to Client (192.168.2.1:54821) sending 1000 bytes
HTTP/1.1 200 OK
Set-Cookie: LtpaToken2=; Max-Age=0; Expires=""Sun, 01-Jan-1995 01:00:00 GMT""
Set-Cookie: PD-H-SESSION-ID=; Max-Age=0; Domain=.notariato.it; Path=/; Expires=""Sun, 01-Jan-1995 01:00:00 GMT""; HttpOnly
{noformat}


",13/Jun/23 12:18 PM;5b232b2fd85e5b59b066f57f;@whannon - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"14/Jun/23 7:19 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** Will review and comment","20/Jun/23 6:10 AM;5b17571b91981f4fdde632c1;{quote}I don’t know what kind of logic is in the code to decide how/why the reset of the ltpatokenb2 cookie is done as host cookie instead of a domain cookie,{quote}



[~accountid:5b15d9e6dda5f94d06b985b4] : Would  add anything else from below?



* When you re-review keep traces with the Set-Cookie attributes 
** Creation
*** Notice
**** Different domain -and- subdomain
**** path='/' a -and- no path
** {color:#bf2600}Deletion {color}{color:#bf2600}*must match* {color}{color:#bf2600}critical attributes{color}
*** To successfully delete the cookie

{noformat}Set-Cookie attributes:
  Domain=<domain-value>
  Expires=<date>
  HttpOnly
  Max-Age=<number>
  Partitioned
  Path=<path-value>
  SameSite
  Secure

If a Set-Cookie's Domain and Path attributes are not specified
  default to the domain and path of the resource that was requested.

================================================================================

The Set-Cookie attributes ONLY appear with Set-Cookie
  The client browser keeps track of the cookie attributes

  Afterward only the cookie NAME=VALUE appears in the request

================================================================================

These Set-Cookies have the SAME cookie name
  With different cookie values
  With different attributes
    
Set-Cookie: EXAMPLE=abc,domain=.abc.com;

Set-Cookie: EXAMPLE=def,domain=.abc.com,path=/

Set-Cookie: EXAMPLE=123,path=/

Set-Cookie: EXAMPLE=456

================================================================================

Under worst case scenario
  ALL FOUR of the these cookies COULD appear on a single HTTP request 
    The server will NOT know which cookie the client wants;

================================================================================

To properly remove all cookies requires
  FOUR Set-Cookie with MATCHING attributes above

WebSEAL will only DELETE one
  It would be the customer's responsiblity ... to delete the remaining cookies

================================================================================

IBM Support's recommendation is to properly fix this the SAME cookie should have the SAME attributes across the ENTIRE enterprise
  Then WebSEAL will delete the one and only cookie{noformat}","20/Jun/23 11:13 AM;5b17571b91981f4fdde632c1;* For ISVA L3 Support only
** pdweb/webseald/authn/modules/ltpa/authn-ltpa.cpp
*** Notice path is set to “/”
**** Your other scenario has *no path*

{noformat}static void
create_cookie(
              h_t               *h,
              WSCredsCacheEntry *cache_entry,
              bool              found_cookie,
              HTTPResponse      *response,
              error_status_t    *rc)
{
  ...
  int ltpa_status = ltpa_token_encode2(
                                       keys_, (char*)userName.getChars(), (long)secsToLive, &token);

  if (ltpa_status != LTPA_S_SUCCESS) {
    ...
  } else {
    ...
    Cookie* cookie = new Cookie();

    if (!cookie) {
      ...
    } else {
      cookie->name_     = ltpa_cookie_name;
      cookie->value_    = token;
      cookie->path_     = ""/"";
      cookie->httpOnly_ = g_use_http_only_cookies;

      cookie->secure_ = get_auth_cookie_type(h) != HTTP_COOKIE_ID_TYPE;

      if (ltpa_cookie_domain) {
        cookie->domain_ = ltpa_cookie_domain;
      }

      response->getCookies().put(cookie, CookieSet::same_name);

      /*
       * Update our cache entry based on the cookie data.  We only do this
       * if we really need to based on our configuration.
       */

      if (ltpa_update_cookie >= 0) {
        cache_entry->setLtpaTimestamp(now);
      }

      if (resend_webseal_cookies || ltpa_update_cookie == 0) {
        ZString cookieStr;

        cookie->appendToString(&cookieStr);

        cache_entry->setCachedLtpaCookieId(cookieStr);
      }

      /*
       * We always add the cookie
       * as a managed cookie so that it will be cleared when we
       * log out.
       * Previously would not be added on stepup (since request contained ltpa cookie)
       * which caused no domain to be sent in the Set-Cookie header to reset it on logout
       */

      *rc = cache_entry->getCookieJar()->manageCookie(NULL, cookie);
      ...
    }
    ...
  }
  ...
}{noformat}","21/Jun/23 1:22 AM;5b15d9a0dda5f94d06b985b3;Hi Bill,
I’m sorry I still don’t get what you’re trying to say.    Yes I understand that it’s critical that the cookie parameters match or you will end up not clearing the right cookie.    So yes, if they have different settings in the environment that can cause problems for them.    However, that’s not the problem we’re chasing here. 








Let me try this again.    If we look at 
S:\sf\TS012\712\TS012712289\2023-05-18\NoworkingLogout_passthrough_displace_meccanismFiles.zip_unpack\noworking_logout.har


We see the LTPAToken2 cookie first set here

#	Result	Protocol	Host	URL	Body	Caching	Content-Type	Process	Comments	Custom	RequestMethod	ClientBeginRequest	

123	200	HTTPS	[webrun.notariato.it|http://webrun.notariato.it]	/smartrun/	0	no-store	text/html				GET	09:31:38.896	


Set-Cookie: LtpaToken2=eachBo/OtDsXofQ8zHOOqfrVF2AXjHRGIDhuqG8yCEv5kL8ijvh87FwuPd+D7leSr2ZUkfOwA0vMUH35Y8l0T51lrYin7NuQduto5zXnyyJiY6cD1ul1WQNU6m6Rnv0lx9JhWaOMKUICFA2kY4FvpFokiI2G1HMNZeNbLmW/oCrQcNlWNGDzpDgblRAH3NbtJMU6GJpLEC8CfLwoEad0CHnFWz6ndHZube0IZm2sCr68WBTIv91dPJ+scQD+QIPdeIjiGEoimYK23LuK+v3HT4T5CrhhxQQn7604sYWB2PpqPctcoGqwSEpfLh10SrjcqKGUhsz9HzDR4d+HBSGTl0wSQdugx0Xbq9A/Vm/3HJ2z88bzo97VgUbCpfVOAG1mP+YugyWokte0pSRrxr2E2S0H5VZO2vf6R6GHJ17RbGU=; [Domain=notariato.it|http://Domain=notariato.it]; Path=/; HttpOnly



note:    [Domain=notariato.it|http://Domain=notariato.it]; Path=/


Then  we see the user going through pkmsdisplace
#	Result	Protocol	Host	URL	Body	Caching	Content-Type	Process	Comments	Custom	RequestMethod	ClientBeginRequest	

144	200	HTTPS	[webrun.notariato.it|http://webrun.notariato.it]	/pkmsdisplace	0	no-store	text/html				GET	09:31:42.186	


Then we see them going through 

#	Result	Protocol	Host	URL	Body	Caching	Content-Type	Process	Comments	Custom	RequestMethod	ClientBeginRequest	

147	200	HTTPS	[webrun.notariato.it|http://webrun.notariato.it]	/smartrun/	0	public, max-age=0	text/html;charset=UTF-8				GET	09:31:42.224	


The request contained 
	LtpaToken2=	eachBo/OtDsXofQ8zHOOqfrVF2AXjHRGIDhuqG8yCEv5kL8ijvh87FwuPd+D7leSr2ZUkfOwA0vMUH35Y8l0T51lrYin7NuQduto5zXnyyJiY6cD1ul1WQNU6m6Rnv0lx9JhWaOMKUICFA2kY4FvpFokiI2G1HMNZeNbLmW/oCrQcNlWNGDzpDgblRAH3NbtJMU6GJpLEC8CfLwoEad0CHnFWz6ndHZube0IZm2sCr68WBTIv91dPJ+scQD+QIPdeIjiGEoimYK23LuK+v3HT4T5CrhhxQQn7604sYWB2PpqPctcoGqwSEpfLh10SrjcqKGUhsz9HzDR4d+HBSGTl0wSQdugx0Xbq9A/Vm/3HJ2z88bzo97VgUbCpfVOAG1mP+YugyWokte0pSRrxr2E2S0H5VZO2vf6R6GHJ17RbGU=

	PD-H-SESSION-ID= 1_I5l6l9FN33P2k+IlzkvFvTBupTfoSmHusyc2J0wEA1lFfbH4fsU=_AAAAAAA=_8xpfP/ehxoEOMLpBpmnLrRZgtZ4=



which results in the session cookie being set
Set-Cookie: PD-H-SESSION-ID=1_I5l6l9FN33P2k+IlzkvFvTBupTfoSmHusyc2J0wEA1lFfbH4fsU=_AAAAAQA=_8xpfP/ehxoEOMLpBpmnLrRZgtZ4=; [Domain=.notariato.it|http://Domain=.notariato.it]; Path=/; HttpOnly

So we see the [Domain=.notariato.it|http://Domain=.notariato.it]; Path=/; 


So far so good.

Then we get to 
#	Result	Protocol	Host	URL	Body	Caching	Content-Type	Process	Comments	Custom	RequestMethod	ClientBeginRequest	

266	200	HTTPS	[webrun.notariato.it|http://webrun.notariato.it]	/pkmslogout	0	no-store	text/html				GET	09:31:46.535	

The request to pkmslogout contained 
	LtpaToken2=		eachBo/OtDsXofQ8zHOOqfrVF2AXjHRGIDhuqG8yCEv5kL8ijvh87FwuPd+D7leSr2ZUkfOwA0vMUH35Y8l0T51lrYin7NuQduto5zXnyyJiY6cD1ul1WQNU6m6Rnv0lx9JhWaOMKUICFA2kY4FvpFokiI2G1HMNZeNbLmW/oCrQcNlWNGDzpDgblRAH3NbtJMU6GJpLEC8CfLwoEad0CHnFWz6ndHZube0IZm2sCr68WBTIv91dPJ+scQD+QIPdeIjiGEoimYK23LuK+v3HT4T5CrhhxQQn7604sYWB2PpqPctcoGqwSEpfLh10SrjcqKGUhsz9HzDR4d+HBSGTl0wSQdugx0Xbq9A/Vm/3HJ2z88bzo97VgUbCpfVOAG1mP+YugyWokte0pSRrxr2E2S0H5VZO2vf6R6GHJ17RbGU=

PD-H-SESSION-ID=	1_I5l6l9FN33P2k+IlzkvFvTBupTfoSmHusyc2J0wEA1lFfbH4fsU=_AAAAAQA=_8xpfP/ehxoEOMLpBpmnLrRZgtZ4=



Again, so far so good.

But the response contains

Response sent 63 bytes of Cookie data:

	Set-Cookie: LtpaToken2=; Max-Age=0; Expires=""Sun, 01-Jan-1995 01:00:00 GMT""

Response sent 108 bytes of Cookie data:

	Set-Cookie: PD-H-SESSION-ID=; Max-Age=0; [Domain=.notariato.it|http://Domain=.notariato.it]; Path=/; Expires=""Sun, 01-Jan-1995 01:00:00 GMT""; HttpOnly



The session cookie is correctly rest with the domain, but not the LTPAToken2



Doesn’t this sound to you like the same or very similar issue that [~accountid:5b15d9517dab4c51f61b5190] mentioned originally back on May 8th?     ","21/Jun/23 1:23 AM;5b17571b91981f4fdde632c1;* You do not have the data you are chasing
** William Hannon Jr  May 9, 2023, 10:37 AM
*** Require everything documented
**** working case
**** failing case
** Would even suggest WSCookieJar traces","21/Jun/23 2:05 AM;5b17571b91981f4fdde632c1;{quote}[junction] reset-cookies-list = JSESS*,Ltpa*{quote}

* The cookie jar only allows ONE cookie","21/Jun/23 2:28 AM;5b15d9a0dda5f94d06b985b3;You confused me again.   Which cookie jar are you referring to?   These cookies are all sent to the browser, so not related to the managed-cookies-list cookie jar or any junction cookies.   These are just set by webseal and sent back to the browser","21/Jun/23 2:34 AM;5b17571b91981f4fdde632c1;{quote}You confused me again.  Which cookie jar are you referring to?{quote}

* I provided the configuration *from the customer*
* [~accountid:5b15d9e6dda5f94d06b985b4] what would you suggest?",23/Jun/23 1:17 AM;60f541a6d0134900692d91b7;Hey [~accountid:5b15d9e6dda5f94d06b985b4] any advise on this??,"24/Jun/23 9:05 AM;5b15d9e6dda5f94d06b985b4;[~accountid:60f541a6d0134900692d91b7] [~accountid:5b15d9a0dda5f94d06b985b3] [~accountid:5b17571b91981f4fdde632c1] 

What Bill is talking about does not appear to happen at 10.0.5.0 so something changed.  However, enabling ltpa-auth breaks the /pkmspublic endpoint (which was not around at 10.0.1.0) so we cannot ask the customer to upgrade.",27/Jun/23 4:44 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e6dda5f94d06b985b4] can you please assess this Jira item and advise what you believe are the next steps needed to move this item forwards? ,"06/Jul/23 7:57 AM;5b15d9e6dda5f94d06b985b4;[~accountid:60f541a6d0134900692d91b7] [~accountid:5b15d9a0dda5f94d06b985b3] 

See [https://cloudidentity.atlassian.net/browse/ISAMSUP-3051|https://cloudidentity.atlassian.net/browse/ISAMSUP-3051|smart-link] for a 10.0.1.0 IF1 fixpack.  The customer needs to apply IF1 first.",06/Jul/23 7:24 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e6dda5f94d06b985b4] Thanks for the update I will let the client know ,11/Jul/23 11:35 AM;5ac57757d9a96536d1f0daa9;[~accountid:60f541a6d0134900692d91b7] I can see in the case that the customer seems to be making good progress for this case with the provided appliance fix pack. As this is the case I am closing out this item by setting it to Done.,"12/Jul/23 12:31 AM;60f541a6d0134900692d91b7;[~accountid:5ac57757d9a96536d1f0daa9] Yes thanks for the fix, the client mentioned they are making progress as they did the test in their test machine and hope it will be the same result in their production as well ","12/Jul/23 4:04 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9e6dda5f94d06b985b4] [~accountid:60f541a6d0134900692d91b7] 

Development found a regression in the original fixpack

There is an updated fixpack IJ29437_v2_10010IF1.fixpack atttached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-3051|https://cloudidentity.atlassian.net/browse/ISAMSUP-3051|smart-link] which fixes the issue

The regression was that It does not update the ltpa cookie according to the [ltpa] update-cookie setting","12/Jul/23 7:47 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9517dab4c51f61b5190] Thanks for updating me, I will update this to client ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
WebSEAL - rules not working on new WAF CRS issue,ISAMSUP-5046,297686,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,04/May/23 9:30 PM,15/Jun/23 7:29 PM,14/Jul/23 2:47 PM,15/Jun/23 7:29 PM,,,,0,,,,"The customer migrating to a new WAF and they need to set exceptions for some situation. The server is currently running in *Detection Only mode* and they try to define exceptions according to waf_events.log file (uploaded). Most of the exceptions work (entries disappear from the log), but they encountered two (unexplainable to them) cases where the exception does not apply, although according to the debug log the request meets the specified conditions.

Unfortunately they cannot switch the WAF to blocking mode. It is because its a production system linked to assembly line. The customer provided logs and support files here:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012879987&path=TS012879987%2F2023-04-28%2F&filepath=TS012879987%2F2023-04-28%2Fwaf_debug_1004.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012879987&path=TS012879987%2F2023-04-28%2F&filepath=TS012879987%2F2023-04-28%2Fwaf_debug_1004.log]

# Rule ID 1004

SecRule REQUEST_URI ""@rx ^(?i)/LdapWs11/srv/(app|user)/._/(app|role|users|userList)/._"" \
    ""id:1004,\
    phase:1,\
    t:normalizePath,\
    pass,\
    nolog,\
    msg:'Exception 1004',\
    chain,\
    ctl:ruleRemoveById=200002,\
    ctl:ruleRemoveById=920180,\
    ctl:ruleRemoveById=920600""
    SecRule REQUEST_METHOD ""(^GET$|^POST$)"" \
        ""t:none""

[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] (Rule: 1004) Executing operator ""Rx"" with param ""^(?i)/LdapWs11/srv/(app|user)/._/(app|role|users|userList)/._"" against REQUEST_URI.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9]  T (0) t:normalizePath: ""/LdapWs11/srv/app/SKASKOMV/role/USERS?type=java""
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Target value: ""/LdapWs11/srv/app/SKASKOMV/role/USERS?type=java"" (Variable: REQUEST_URI)
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Matched vars updated.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] Rule returned 1.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] Executing chained rule.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] (Rule: 0) Executing operator ""Rx"" with param ""(^GET$|^POST$)"" against REQUEST_METHOD.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Target value: ""GET"" (Variable: REQUEST_METHOD)
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Matched vars updated.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] Rule returned 1.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Running action: log
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Saving transaction to logs
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Running action: auditlog
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Saving transaction to logs
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Running action: log
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Saving transaction to logs
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Running action: auditlog
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Saving transaction to logs
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Saving msg: Exception 1004
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Running action: nolog
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Running action: ctl
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Running action: ctl
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Running action: ctl
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] Not running any disruptive action (or block): pass. SecRuleEngine is not On.

2023-04-28T15:19:28+02:00 smbmfr002.adm.skoda.vwg console:crit waf[25548]: ModSecurity: Warning. Matched ""Operator {{Rx' with parameter }}^(?:(?:\_|\[^\""(),\/:;<=>?![\x5c\]{}\]+)\/(?:\_|\[^\""(),\/:;<=>?![\x5c\]{}\]+))(?:\s*+;\s*+(?:(?:charset\s*+=\s*+(?:\""?(?:iso-8859-15?|windows-1252|utf-8)\b\""?))|(?:(?:c(?:h(?:a(?:r(?:s(?:e[^t\""(),\/:;<=> (714 characters omitted)' against variable {{REQUEST_HEADERS:accept' (Value: }}text/html, image/gif, image/jpeg, *; q=.2, _/_; q=.2' ) [file ""/var/pdweb/shared/waf/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf""] [line ""1147""] [id ""920600""] [rev """"] [msg ""Illegal Accept header: charset parameter""] [data ""text/html, image/gif, image/jpeg, *; q=.2, _/_; q=.2""] [severity ""2""] [ver ""OWASP_CRS/3.3.4""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-protocol""] [tag ""paranoia-level/1""] [tag ""OWASP_CRS""] [hostname ""10.217.116.142""] [uri ""/LdapWs11/srv//app/SKASKOMV/role/USERS""] [unique_id ""168268794870.521250""] [ref ""v70,52t:lowercase""]

# Rule ID 1008

SecRule REQUEST_URI ""@rx ^/was90ssl/Transdis/GSBws.*"" \
    ""id:1008,\
    phase:1,\
    t:none,\
    pass,\
    nolog,\
    msg:'Exception 1008',\
    chain,\
    ctl:ruleRemoveTargetById=920600;REQUEST_HEADERS:accept""
    SecRule REQUEST_METHOD ""^POST$"" \
        ""t:none""

[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] (Rule: 1008) Executing operator ""Rx"" with param ""^/was90ssl/Transdis/GSBws.*"" against REQUEST_URI.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Target value: ""/was90ssl/Transdis/GSBws"" (Variable: REQUEST_URI)
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Matched vars updated.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] Rule returned 1.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] Executing chained rule.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] (Rule: 0) Executing operator ""Rx"" with param ""^POST$"" against REQUEST_METHOD.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Target value: ""POST"" (Variable: REQUEST_METHOD)
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Matched vars updated.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] Rule returned 1.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Running action: log
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Saving transaction to logs
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Running action: auditlog
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Saving transaction to logs
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Running action: log
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Saving transaction to logs
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Running action: auditlog
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Saving transaction to logs
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Saving msg: Exception 1008
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Running action: nolog
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Running action: ctl
[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] Not running any disruptive action (or block): pass. SecRuleEngine is not On.

2023-04-28T15:23:38+02:00 smbmfr002.adm.skoda.vwg console:crit waf[25548]: ModSecurity: Warning. Matched ""Operator {{Rx' with parameter }}^(?:(?:\_|\[^\""(),\/:;<=>?![\x5c\]{}\]+)\/(?:\_|\[^\""(),\/:;<=>?![\x5c\]{}\]+))(?:\s*+;\s*+(?:(?:charset\s*+=\s*+(?:\""?(?:iso-8859-15?|windows-1252|utf-8)\b\""?))|(?:(?:c(?:h(?:a(?:r(?:s(?:e[^t\""(),\/:;<=> (714 characters omitted)' against variable {{REQUEST_HEADERS:accept' (Value: }}text/xml, text/html, image/gif, image/jpeg, *; q=.2, _/_; q=.2' ) [file ""/var/pdweb/shared/waf/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf""] [line ""1147""] [id ""920600""] [rev """"] [msg ""Illegal Accept header: charset parameter""] [data ""text/xml, text/html, image/gif, image/jpeg, *; q=.2, _/_; q=.2""] [severity ""2""] [ver ""OWASP_CRS/3.3.4""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-protocol""] [tag ""paranoia-level/1""] [tag ""OWASP_CRS""] [hostname ""10.217.116.142""] [uri ""/was90ssl/Transdis/GSBws""] [unique_id ""16826882126.122877""] [ref ""v47,62t:lowercase""]",,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012879987,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,SKODA AUTO A.S.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1b5wn:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-04 23:18:19.735,,,,,05/May/23 9:18 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] can you please take a look at this one. This is the WAF technology that we added to the ISVA release. Please let me know if you need any support to move this one forwards. ,"06/May/23 6:57 AM;5b15d9e581c3df12acf53c4a;To L2, can you add your findings and investigation here as to what is going on?","11/May/23 1:16 AM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] I asked for the PDweb.Debug, Snoop and the WAF log to check what is the request look like.","22/May/23 11:19 PM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] Hello Motiur, I found there is the same error on both problem rules within the internal WAF debug log. Is it related to a configuration issue?

Rule 1008

[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] Not running any disruptive action (or block): pass. SecRuleEngine is not On.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] (Rule: 901141) Executing operator ""Eq"" with param ""0"" against TX:error_anomaly_score.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Target value: ""0"" (Variable: TX:error_anomaly_score)
[16826882126.122877] [/was90ssl/Transdis/GSBws] [9] Matched vars updated.
[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] Running [independent] (non-disruptive) action: setvar
[16826882126.122877] [/was90ssl/Transdis/GSBws] [8] Saving variable: TX:error_anomaly_score with value: 4
[16826882126.122877] [/was90ssl/Transdis/GSBws] [4] Rule returned 1.

Rule 1004

[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] Not running any disruptive action (or block): pass. SecRuleEngine is not On.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] (Rule: 901141) Executing operator ""Eq"" with param ""0"" against TX:error_anomaly_score.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Target value: ""0"" (Variable: TX:error_anomaly_score)
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [9] Matched vars updated.
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] Running [independent] (non-disruptive) action: setvar
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [8] Saving variable: TX:error_anomaly_score with value: 4
[168268794870.521250] [/LdapWs11/srv//app/SKASKOMV/role/USERS?type=java] [4] Rule returned 1.","23/May/23 5:17 AM;5b15d9e581c3df12acf53c4a;[~accountid:6092aca0f0db130069d19687] What I meant by L2’s findings is that , can you put some context around the issue i.e.

what exactly the problem is?

What their expectation is?

e.g. if they set a specific rule  say  xyz, what their expectation of the output is supposed to be?

Knowing all these information will provide me an idea where to look in the ISVA code or it could be the issue is in the WAF code ( thirdparty code ) that ISVA bundled, either way, I need an example…..

You could also try to reproduce the issue, reproduction does not has to be exactly like what Customer has, you can come with your own scenario, play around and see you can come close to what customer is seeing? 

Any time when Third Party code involved, without a good reproduction scenario, it is hard to debug.",23/May/23 5:34 AM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] Thanks for the clarification. I will gather the information you need.,"24/May/23 7:49 AM;5b15d9e581c3df12acf53c4a;I was looking at this issue little more but I could not make out what exactly going on here…..

Did they configured WAF that comes with WebSEAL or the Customer has their own WAF?

Also, the rule they mentioned in the description does not seem to referred to in the conf file that came with the support file.

Reading their description, it does not seem like WAF of our appliance being used here…..I will need more clarification as I also mentioned in my earlier comment.",24/May/23 8:09 AM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] they said “we switched the built-in WCP to built-in ModSecurity WAF after migration to V10.0.5.“,"24/May/23 8:16 AM;5b15d9e581c3df12acf53c4a;[~accountid:6092aca0f0db130069d19687] OK, still I am having difficulty finding their configuration….as mentioned earlier, please do get the details, as I mentioned earlier, you do not have to reproduce their exact issue but do figure out their configuration as close as possible.",24/May/23 8:20 AM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] Yes I will. Thanks ,"24/May/23 8:21 AM;5b15d9e581c3df12acf53c4a;OK, I found some information about ModSecurity, in the meantime, please do get the details of their configuration.","25/May/23 12:06 AM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] Hello Motiur, The customer replied: “Both rules (1004 and 1008) should work similarly - if the URI of the incoming request matches the specified regular expression and the method (GET or POST) matches, then WAF should ignore the rules defined by ctl:ruleRemoveTargetById. Unfortunately, even though both conditions are met (according to the debug log), the WAF logs the entry to the waf_events.log file.

As for the location of the configuration files, they are in standard places in the support file:

\var\pdweb\vyroba\etc\modsecurity.conf

\var\pdweb\shared\waf\config\crs-setup.conf

Rules (1004 and 1008): \var\pdweb\shared\waf\rules\REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf

Please let me know if I miss any information.",27/May/23 7:48 AM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] did you see my update? Is there anything missing?,"31/May/23 1:26 AM;5b15d9e581c3df12acf53c4a;I need to study this new feature little bit more, will update soon.",31/May/23 1:33 AM;6092aca0f0db130069d19687;thank you 👍 ,"07/Jun/23 6:07 AM;5b15d9e581c3df12acf53c4a;So far I do not see anything wrong in the rules that jump to me……, will look into it little more and will update latter.","08/Jun/23 4:06 AM;5b15d9e581c3df12acf53c4a;OK, I did some more digging, as far as all the logs present i.e. waf_debug_1004.log or waf_debug_1008.log

there is no errors processing those rules at all.

Your comment on May 22 mentioned that some problems with rules 1004 or 1008 but there is no problem….

What the waf_debug log indicated is the proper processing of the rules, there is nothing wrong from ISVA side of the processing of these two rules at all.



If you guys have something more specific for me to look into, let me know.",08/Jun/23 6:16 PM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] thanks for your great work and help. I will let the customer know the outcome.,"08/Jun/23 11:34 PM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] The customer said: “ Thank you very much for information from L3 team. Their conclusion is the same as mine. But it also doesn't explain why the exceptions don't apply and why are recorded in waf_events.log file. Fortunately, the records aren't connected with message “Inbound Anomaly Score Exceeded” and the requests aren’t blocked, even though we disabled Detection Only mode. Can the cause of this anomalous behavior be found? Thank you very much in advance for your help.”","09/Jun/23 5:48 PM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] The customer also said 

As I wrote, fortunately the records from this issue  aren't connected with message “Inbound Anomaly Score Exceeded” and the requests aren’t blocked. But I'm sending you a sample of the records leading up to the request being blocked:

2023-06-08T07:17:24+02:00 smbmfr001.adm.skoda.vwg console:crit waf[4527]: ModSecurity: Warning. detected SQLi using libinjection. [file ""/var/pdweb/shared/waf/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf""] [line ""46""] [id ""942100""] [rev """"] [msg ""SQL Injection Attack Detected via libinjection""] [data ""Matched Data: n)o1) found within ARGS:actionBean.mista[20].vzorecDefinice: ((prum7-prum3)/2)-19.1""] [severity ""2""] [ver ""OWASP_CRS/3.3.4""] [maturity ""0""] [accuracy ""0""] [hostname ""10.217.116.141""] [uri ""/was90ssl/Kovnar/kov286.action""] [unique_id ""168620142411.475893""] [ref ""v54720,22""]
2023-06-08T07:17:24+02:00 smbmfr001.adm.skoda.vwg console:crit waf[4527]: ModSecurity: Warning. detected SQLi using libinjection. [file ""/var/pdweb/shared/waf/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf""] [line ""46""] [id ""942100""] [rev """"] [msg ""SQL Injection Attack Detected via libinjection""] [data ""Matched Data: n)o1) found within ARGS:actionBean.mista[21].vzorecDefinice: ((prum8-prum3)/2)+38.2""] [severity ""2""] [ver ""OWASP_CRS/3.3.4""] [maturity ""0""] [accuracy ""0""] [hostname ""10.217.116.141""] [uri ""/was90ssl/Kovnar/kov286.action""] [unique_id ""168620142411.475893""] [ref ""v54720,22v57463,22""]
2023-06-08T07:17:24+02:00 smbmfr001.adm.skoda.vwg console:crit waf[4527]: ModSecurity: Warning. detected SQLi using libinjection. [file ""/var/pdweb/shared/waf/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf""] [line ""46""] [id ""942100""] [rev """"] [msg ""SQL Injection Attack Detected via libinjection""] [data ""Matched Data: n)o1) found within ARGS:actionBean.mista[21].vzorecDefinice: ((prum8-prum3)/2) 38.2""] [severity ""2""] [ver ""OWASP_CRS/3.3.4""] [maturity ""0""] [accuracy ""0""] [hostname ""10.217.116.141""] [uri ""/was90ssl/Kovnar/kov286.action""] [unique_id ""168620142411.475893""] [ref ""v54720,22v57463,22v57463,22t:urlDecodeUni""]
2023-06-08T07:17:24+02:00 smbmfr001.adm.skoda.vwg console:crit waf[4527]: ModSecurity: Warning. detected SQLi using libinjection. [file ""/var/pdweb/shared/waf/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf""] [line ""46""] [id ""942100""] [rev """"] [msg ""SQL Injection Attack Detected via libinjection""] [data ""Matched Data: n)o1) found within ARGS:actionBean.mista[18].vzorecDefinice: ((prum7-prum3)/2)+19.1""] [severity ""2""] [ver ""OWASP_CRS/3.3.4""] [maturity ""0""] [accuracy ""0""] [hostname ""10.217.116.141""] [uri ""/was90ssl/Kovnar/kov286.action""] [unique_id ""168620142411.475893""] [ref ""v54720,22v57463,22v57463,22t:urlDecodeUniv49220,22""]
2023-06-08T07:17:24+02:00 smbmfr001.adm.skoda.vwg console:crit waf[4527]: ModSecurity: Warning. detected SQLi using libinjection. [file ""/var/pdweb/shared/waf/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf""] [line ""46""] [id ""942100""] [rev """"] [msg ""SQL Injection Attack Detected via libinjection""] [data ""Matched Data: n)o1) found within ARGS:actionBean.mista[18].vzorecDefinice: ((prum7-prum3)/2) 19.1""] [severity ""2""] [ver ""OWASP_CRS/3.3.4""] [maturity ""0""] [accuracy ""0""] [hostname ""10.217.116.141""] [uri ""/was90ssl/Kovnar/kov286.action""] [unique_id ""168620142411.475893""] [ref ""v54720,22v57463,22v57463,22t:urlDecodeUniv49220,22v49220,22t:urlDecodeUni""]
2023-06-08T07:17:24+02:00 smbmfr001.adm.skoda.vwg console:crit waf[4527]: ModSecurity: Warning. detected SQLi using libinjection. [file ""/var/pdweb/shared/waf/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf""] [line ""46""] [id ""942100""] [rev """"] [msg ""SQL Injection Attack Detected via libinjection""] [data ""Matched Data: n)o1) found within ARGS:actionBean.mista[19].vzorecDefinice: ((prum8-prum3)/2)-38.2""] [severity ""2""] [ver ""OWASP_CRS/3.3.4""] [maturity ""0""] [accuracy ""0""] [hostname ""10.217.116.141""] [uri ""/was90ssl/Kovnar/kov286.action""] [unique_id ""168620142411.475893""] [ref ""v54720,22v57463,22v57463,22t:urlDecodeUniv49220,22v49220,22t:urlDecodeUniv51973,22""]
2023-06-08T07:17:24+02:00 smbmfr001.adm.skoda.vwg console:crit waf[4527]: [client 10.217.116.188] ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator {{Ge' with parameter }}5' against variable {{TX:ANOMALY_SCORE' (Value: }}30' ) [file ""/var/pdweb/shared/waf/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""81""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 30)""] [data """"] [severity ""2""] [ver ""OWASP_CRS/3.3.4""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-generic""] [hostname ""10.217.116.141""] [uri ""/was90ssl/Kovnar/kov286.action""] [unique_id ""168620142411.475893""] [ref """"]
But this is correct/expected behavior and is not the subject of this issue.","14/Jun/23 3:20 AM;5b15d9e581c3df12acf53c4a;What makes this kind of issues to debug for ISVA team impossible is for the fact that ISVA is just using this ModSecurity library, ISVA does not own the code, ISVA is just using this third Party library, as such, if the error is not originating in the ISVA, we cannot debug it.

Also please Note that, even ModSecurity website advises to do lots of trial and error to find the best suitable rules sets for protection because ModSecurity might throws lots of false positive.

Even for Anomaly Scoring, here is few lines  as tip from OWASP site:

A common practice when working with a *new* CRS deployment is to start in blocking mode from the very beginning with _very high anomaly score thresholds_ (even as high as 10000). The thresholds can be gradually lowered over time as an iterative process.



Sorry that ISVA is bit unable to provide exact clue as to why this particular issue is occurring here.",14/Jun/23 3:27 AM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] Thank you for your great help. I will communicate with the customer.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
9.0.7.3 introspect endpoint not working correctly,ISAMSUP-5035,297026,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,02/May/23 1:02 PM,31/May/23 9:51 AM,14/Jul/23 2:47 PM,31/May/23 9:51 AM,,,,0,,,,"As part of upgrade testing from older versions to 10.0.6.0, dev (Sumana) discovered that at 9.0.7.3 the introspect endpoint is not working correctly.

This is caused by the runtime profile not being able to load the necessary isam jars correctly.",,David Hayes,Keiran Robinson,Sumana Srinath Narasipur,tonyferg,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5ac577587028785d133fbc46,5af05450e6f95a2c1c89193d,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,02/May/23 1:03 PM;bkumar;trace.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198737,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1b20f:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.3,,,,,,,,,,,,,,,,,,"03/May/23 1:06 PM;5b15d954b0d76456f36daf33;Set up a fresh 9.0.7.3 install using jenkins. But cannot recreate this problem. I’m able to introspect tokens:

{noformat}$ curl -k -d ""client_id=testclient1&grant_type=password&username=user1&password=passw0rd&client_secret=testclient1passw0rd"" https://10.160.21.57/mga/sps/oauth/oauth20/token
{""access_token"":""pi5nwTnkHbDpYfo1b4Bq"",""refresh_token"":""1g9HmLRdU2hBK5s3bxpHkZTHp134pvYBinXOonm0"",""scope"":"""",""token_type"":""bearer"",""expires_in"":3599} 

$ curl -k -d ""client_id=testclient1&grant_type=password&username=user1&password=passw0rd&client_secret=testclient1passw0rd&token=pi5nwTnkHbDpYfo1b4Bq"" https://10.160.21.57/mga/sps/oauth/oauth20/introspect
{""scope"":"""",""active"":true,""token_type"":""bearer"",""exp"":1683085241,""iat"":1683081641,""client_id"":""testclient1"",""username"":""user1""}{noformat}

Checking with Sumana","31/May/23 9:51 AM;5b15d954b0d76456f36daf33;I can’t recreate this problem. Talking to Sumana, she mentioned her upgrade path was 9.0.7.0 → 9.0.7.3

The path that I tried was 9.0.7.2 → 9.0.7.3 (mainly because that is the version all remaining 9.0.x customers are/have to be at)

I’m going to close this as cannot recreate.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Prometheus /metrics API not working in 10.0.5,ISAMSUP-5033,296827,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,29/Apr/23 2:52 AM,10/May/23 10:01 AM,14/Jul/23 2:47 PM,10/May/23 10:01 AM,10.0.6,,,0,,,,"Prometheus /metrics API not working. I replicated customer issue whereby they activated Prometheus api by enabling:[Runtime monitoring using Prometheus - IBM Documentation|https://www.ibm.com/docs/en/sva/10.0.5?topic=settings-runtime-monitoring-using-prometheus]



!image-20230428-165125.png|width=1444,height=389!",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,29/Apr/23 2:52 AM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230428-165125.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198621,09/May/23 11:19 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230509-131932.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200007,,,,,,,,,,,,,, IJ46618,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012855048,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,Volkswagen AG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1b0rz:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-01 00:45:32.294,,,,,"01/May/23 10:45 AM;5b15d954b0d76456f36daf33;I believe this is a duplicate of the problem described in [https://cloudidentity.atlassian.net/browse/ISAMDEV-9626|https://cloudidentity.atlassian.net/browse/ISAMDEV-9626|smart-link] for which a fix should be available from the next version.

The nature of the problem and fix means this cannot be provided as a personal fixpack. It will be corrected during a firmware install/upgrade.

[~accountid:614dd566a995ad0073ec0622] while you are free to open APARs fro problems that are obviously defects in the product, it might be beneficial to discuss first if one is needed.",02/May/23 5:23 PM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33] I was advised to open an apar. I will inform customer it will be fixed hopefully in 10.0.6. It was supposed to be fixed in 10.0.4?,02/May/23 7:07 PM;5b15d954b0d76456f36daf33;It was fixed in 10.0.4 but looks like a regression was introduced in 10.0.5. You can tel the customer the fix will be in 10.0.6 which is tentatively due mid June,09/May/23 9:48 PM;5b232b2fd85e5b59b066f57f;[~accountid:614dd566a995ad0073ec0622] - what is the state of the APAR - has it been closed as invalid or is it still active? ,"09/May/23 11:19 PM;614dd566a995ad0073ec0622;[~accountid:5b232b2fd85e5b59b066f57f] I can’t access the Apar: 

!image-20230509-131932.png|width=1592,height=885!",09/May/23 11:35 PM;614dd566a995ad0073ec0622;[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5b15d954b0d76456f36daf33]  Reagan verified it is still open.,"10/May/23 9:51 AM;5b15d954b0d76456f36daf33;Case is closed, so closing this Jira and the APAR",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Kerberos authentication failure in ISVA 10.0.5.0,ISAMSUP-5029,296463,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,27/Apr/23 12:48 AM,09/May/23 9:49 PM,14/Jul/23 2:47 PM,09/May/23 9:49 PM,,,,0,,,,"On this case, Customer having issue with Kerberos authentication failure in ISVA 10.0.5.0.

After patching to 10.0.5.0 from 10.0.4.0,Customer noticed that for some reverse proxies we get the following errors:

0x30923082 webseald ERROR bst general amstli.c 2791 0x7f3445565e80 -- HPDST0130E  The security service function krb5_get_init_creds_keytab returned the error 'Preauthentication failed' (code 0x96c73a18/-1765328360).

And

0x389834BC webseald ERROR wad junction jct-mgmt-rpc.cpp 392 0x7f3445565e80 -- DPWAD1212E  Initialization of Kerberos authentication failed.

As such, they are unable to restart the impacted reverse proxies and our current only solution available is just to rollback the update. Is that a known issue on your end? Nothing has changed apart from us updating from 10.0.4.0 to 10.0.5.0 on the appliance impacted.

After analyse the support file and Network trace on working scenarios v10.0.4.0 and non working v10.0.5.0

Our findings are below:

Please find the file uploaded .txt of v10.0.5.0 where it will shows

In the keytables, number of entries are 5 and have multiple principal

Each ciper shows different encryption and only AES256 is matching with the v10.0.4.0.

[https://editor.apps.cloud.itc.ibm.com/sse/edit/edit.html#/sse/bigfile/Prabhjeet.Multani@ibm.com-OrionContent/TS012611313/2023-04-17/output1050_sepl.txt|https://editor.apps.cloud.itc.ibm.com/sse/edit/edit.html#/sse/bigfile/Prabhjeet.Multani@ibm.com-OrionContent/TS012611313/2023-04-17/output1050_sepl.txt]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012611313,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,BNP PARIBAS PARTNERS FOR INNOVAT,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1ayjj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-27 22:58:43.99,,,,,28/Apr/23 8:58 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] please complete the initial review of this item and let me know if you need any support. ,29/Apr/23 12:39 AM;5b15d9e581c3df12acf53c4a;Investigating……..will update with my findings…,"29/Apr/23 1:06 AM;5b15d9e581c3df12acf53c4a;In jct-mgmt-rpc.cpp::jct_setup()

It loaded all the junctions and did the setup correctly until it came to the point of kerberos initialization i.e.

………….

    // Construct the cache name based on the instance name
    krb_ccache_name = ""MEMORY:krb5cc_"";
    krb_ccache_name.append(g_server_instance_name);

    *_// Call kinit to authenticate to the KDC and obtain a TGT
    *status = amstli_Kinit(g_krb_principal_name, g_krb_keytab, NULL, krb_ccache_name.data());_*
    if ( *status != error_status_ok ) {
        *status = kerberos_init_keytab_failed;
        pd_svc_printf(KERBEROS_INIT_KEYTAB_FAILED_MSG);
        return;
    }



In amstli.c::amstli_Kinit()

all setup is correct until it gets to:

…………

/* If keytab_name isn't NULL, obtain the initial creds with the key table. */
if(keytab_name != NULL) {
    /* Request the initial credentials for the client based on the key table. */
    error_code = *_krb5_get_init_creds_keytab(context, &creds, client_princ, keytab,
                                            0, NULL, options);_*
    if (error_code) {
        amstli_logKrb5Err(""krb5_get_init_creds_keytab"", context, error_code);
        LOGERROR4(amstli_s_function_error, ""krb5_get_init_creds_keytab"", 0, (int)error_code);
    }

…………….



So there is no code change at all in ISVA side in 10.0.5.0 as far as kerberos is concerned.

It is having trouble connecting to KDC to get TGT, any thing changed on their KDC side? any communication issue?


You mentioned that customer’s finding is in uploaded.txt file? I could not find that file?

Can you provide that file as well as any other context?



Also , let me know which RP instance and junction is seeing this issue so that I can investigate the current logs/traces?",09/May/23 9:49 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
OIDC /UserInfo endpoint unable to handle Finnish language special characters,ISAMSUP-5010,296049,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Akshatha,61548f169cdb9300722d0c1f,Akshatha,61548f169cdb9300722d0c1f,24/Apr/23 10:07 PM,18/May/23 10:59 AM,14/Jul/23 2:47 PM,18/May/23 10:59 AM,,,,0,,,,"The customer is facing an issue while returning the OIDC /userinfo endpoint response which has firstname of the user with Finnish special characters. 



First, /authorize endpoint get call, where post token mapping rule associates firstname with state_id, as shown below : 

var fn = stsuu.getAttributeValueByName(""tagvalue_credattrs_givenName""); OAuthMappingExtUtils.associate(state_id, ""fn"", fn, false, false) 



Later /userinfo endpoint get call, where the posttoken mapping rule try to fetch the first name value against state_id and add inside /userinfo response parameter as below : 

var given_name = OAuthMappingExtUtils.getAssociation(state_id, ""fn""); 

System.out.println(""OAUTH endpoint: /userinfo. given_name : "" + given_name); stsuu.addContextAttribute(new com.tivoli.am.fim.trustserver.sts.uuser.Attribute(""given_name"", ""urn:ibm:names:ITFIM:oauth:response:attribute"",given_name)); 



Output : ""OAUTH endpoint: /userinfo. given_name : ""PÄÄLLIKKÖ"" $ curl -s -k -x '' [https://xxx.xxx.xxx/oauth/userinfo|https://xxx.xxx.xxx/oauth/userinfo] -H ""Authorization: Bearer plac_holder_accesstokenvalue"" {""given_name"":""P\u00c4\u00c4LLIKK\u00d6""} 



Note:System.out.println statement shows the correct given_name. But have an issue when that value gets set against urn:ibm:names:ITFIM:oauth:response:attribute value",,BRIANORO,Dermot Daly,khansen,Nick Lloyd,Sten Drescher,Tushar Prasad,,,,,,,,,,6154906364ff01007106e189,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,28/Apr/23 10:46 AM;ashashiv;image-20230428-004357.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198422,28/Apr/23 10:46 AM;ashashiv;image-20230428-004417.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198420,28/Apr/23 10:46 AM;ashashiv;image-20230428-004503.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198421,28/Apr/23 10:56 AM;ashashiv;image-20230428-005542.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198427,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012730614,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Akshatha,61548f169cdb9300722d0c1f,,,,OP OSUUSKUNTA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1aw13:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-04-27 22:59:46.483,,,,,"24/Apr/23 10:09 PM;61548f169cdb9300722d0c1f;There is no error when /userinfo endpoint returns response.

49 [4/17/23 12:50:14:727 EEST] 00021964 id=00000000 SystemOut O OAUTH endpoint: /userinfo. given_name : PÄÄLLIKKÖ

50 [4/17/23 12:50:14:729 EEST] 00021964 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY oauth [TRACE] State_ID :uuid8e9da0fb-0187-1bed-b360-c771a57fe85c, x_request_id : 1e4b4f33-133f-4425-8660-fae275245096, request_type : userinfo, OAUTH PostToken STSUU: <?xml version=""1.0"" encoding=""UTF-8""?><stsuuser:STSUniversalUser xmlns:stsuuser=""urn:ibm:names:ITFIM:1.0:stsuuser""><stsuuser:Principal/><stsuuser:AttributeList><stsuuser:Attribute name=""iss"" type=""urn:ibm:jwt:claim""><stsuuser:Value>[https://www002.opcloud.jty.op-palvelut.net</stsuuser:Value></stsuuser:Attribute>|https://www002.opcloud.jty.op-palvelut.net</stsuuser:Value></stsuuser:Attribute>];.....","24/Apr/23 10:10 PM;61548f169cdb9300722d0c1f;/Userinfo endpoint posttoken.js stsuu string details which shows firstName and LastName get added as expected, but userinfo response not showing in correct format after curl hit.

curl userinfo endpoint response :

{""sub"":""XXXXXXXXX"",""given_name"":""P\u00c4\u00c4LLIKK\u00d6"",""family_name"":""AUTO-VPT""}

/ecurep/sf/TS012/730/TS012730614/2023-04-17/UserInfoPostToken_STSUU.PNG","24/Apr/23 10:11 PM;61548f169cdb9300722d0c1f;The customer followed the suggested doc:

[https://www.ibm.com/support/pages/fine-tuning-id-tokens-isam-advanced-access-control-oidc-flows#userinfo_azncode|https://www.ibm.com/support/pages/fine-tuning-id-tokens-isam-advanced-access-control-oidc-flows#userinfo_azncode]

As per the doc, first, get state_id associated value of credMail and add that value with type urn:ibm:names:ITFIM:oauth:response:attribute in contextAttribute.



var email = OAuthMappingExtUtils.getAssociation(state_id,""credMail"");

if(email != null && email.length() >0){

stsuu.addContextAttribute(new Attribute(""mail"",""urn:ibm:names:ITFIM:oauth:response:attribute"",email));



In the customer scenario also, they did the same, but the first name did not get displayed correctly.

var given_name = OAuthMappingExtUtils.getAssociation(state_id, ""fn"");

System.out.println(""OAUTH endpoint: /userinfo. given_name : "" + given_name);

stsuu.addContextAttribute(new com.tivoli.am.fim.trustserver.sts.uuser.Attribute(""given_name"", ""urn:ibm:names:ITFIM:oauth:response:attribute"",given_name));



Output :

""OAUTH endpoint: /userinfo. given_name : ""PÄÄLLIKKÖ""

$ curl -s -k -x '' [https://xxx.xxx.xxx/oauth/userinfo|https://xxx.xxx.xxx/oauth/userinfo] -H ""Authorization: Bearer plac_holder_accesstokenvalue""

{""given_name"":""P\u00c4\u00c4LLIKK\u00d6""}



So basically, facing an issue if the value contain Finnish language characters",28/Apr/23 8:59 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] as we continue to build skills across the wider team within the OIDC spare this item might be a good one to move forwards. ,"28/Apr/23 10:46 AM;5af4ad7d4dd24c579110120b;<Notes>

Configure webseal
Configure AAC /mga endpoint 

Create a user with this username in Policy server admin : 

PÄÄLLIKKÖ

{noformat}https://10.160.21.11/mga/sps/oauth/oauth20/authorize?scope=openidemailcustom&claims={""userinfo"": {""age"": {""essential"": true}},""id_token"": {""age"": {""essential"": true}}}&response_type=code&client_id=testclient1&client_secret=testclient1password&redirect_uri=https://jwt.io&state=STATE&nonce=NONCE{noformat}

{noformat}curl -k -d ""grant_type=authorization_code&code=Ovtb5y6Q3KOBFobIqrI3XiWmgKQtfg&client_id=testclient1&client_secret=testclient1password&redirect_uri=https://jwt.io"" https://10.160.21.11/mga/sps/oauth/oauth20/token{noformat}

{noformat}https://10.160.21.11/mga/sps/oauth/oauth20/userinfo?access_token=nyqxk7BqML9T4K5lGHP1{noformat}

Unicode characters in browser show up ok -


!image-20230428-004357.png|width=462,height=77!

When you switch to raw output -

!image-20230428-004417.png|width=462,height=77!

When you use curl to get the response: 

!image-20230428-004503.png|width=794,height=22!","28/Apr/23 10:47 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:61548f169cdb9300722d0c1f] 

If we access via browser the values show up fine and the unicode characters are only in curl - Is my understanding correct?

I have detailed the steps of what I see can you confirm with the customer that browser shows up claims with unicode characters ok? 

if using curl is the only issue in this case - curl cannot handle unicode/special characters entirely so using query to format should resolve the issue -

Example: see *| jq .* at the end of curl

response is 

*{*

  *""sub"":* ""päällikkö""

*}*


curl and screenshot here - 

{noformat} curl -s -k -x '' https://10.160.21.11/mga/sps/oauth/oauth20/userinfo --header 'Accept: application/json' --header 'Content-Type: x-www-form-urlencoded' -H ""Authorization: Bearer nyqxk7BqML9T4K5lGHP1"" | jq .{noformat}

!image-20230428-005542.png|width=853,height=33!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
how to generate kid using certificate which is sent to junction?,ISAMSUP-5009,296025,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,24/Apr/23 6:40 PM,16/May/23 8:55 AM,14/Jul/23 2:47 PM,16/May/23 8:55 AM,10.0.6,Support,,0,,,,"The customer is using JSON Web Tokens in HTTP Headers:
  [https://www.ibm.com/docs/en/sva/10.0.5?topic=solutions-json-web-tokens-in-http-headers|https://www.ibm.com/docs/en/sva/10.0.5?topic=solutions-json-web-tokens-in-http-headers]


The customer would like to generate kid in kdb by using certificate itself,
to use it in their ansible notebook to work with Amazon ALB.

Is it possible to tell the customer how to generate kid from certificate and/or any other info, instead of using jwks local-app?

By the way, since 10.0.5, kid is hashed value due to IJ43866 change ([https://cloudidentity.atlassian.net/browse/ISAMSUP-4367|https://cloudidentity.atlassian.net/browse/ISAMSUP-4367|smart-link] ).
But jwks local-app still returns key label.

The customer would like us to provide any way to generate kid from certificate.
He does not want to access local-app from ansible.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5034,,,,,,26/Apr/23 8:20 PM;ashashiv;jwks.json;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198039,27/Apr/23 12:48 PM;kanemoto;traces.zip;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198185,27/Apr/23 12:54 PM;kanemoto;webseald-default.conf;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198186,,,,,,,,,,,,,IJ46696,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012786240,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,SECOM,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=13, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":13,""lastUpdated"":""2023-05-15T17:26:48.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":13,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1avvz:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-25 23:16:18.867,,,,,26/Apr/23 9:16 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] hoping you have some prior knowledge regarding this one. Can you please complete the initial assessment. ,"26/Apr/23 9:44 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9ec6d76184b7d989c83] 

Create a an RP 
Create a standard junction Ex:  /api

Update the webseal config file with: key-label that I want to use from the cert store - {{server}} 

{noformat}jct-cert-keyfile = /var/pdweb/shared/keytab/rt_profile_keys.p12 

[jwt:/api]
claim = attr::AZN_CRED_PRINCIPAL_NAME::sub
key-label = server
hdr-name = jwt
include-empty-claims = true
hdr-format = %TOKEN%
lifetime = 0
renewal-window = 15{noformat}

Access the /api via RP 

Decode the generated jwt it will have the algorithm and the kid with the name of the key label i.e. server : 

{{{ ""alg"": ""RS256"", ""kid"": ""server"" }}}

Is the query here different to what can be achieved by doing this? ","26/Apr/23 10:41 AM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

I tried both 10.0.4 and 10.0.5. These are kid in  IV_JWT header which is received by backend server:

{quote}10.0.5
% curl -s -k -u testuser:password1 [http://vaa5w.battle.mil/ds64/k/env.cgi|http://vaa5w.battle.mil/ds64/k/env.cgi] | grep IV_JWT | sed -e 's/.* = //;s/<.*//' | ruby -rjwt -ne 'pp JWT.decode($_,nil,false)'
[{""exp""=>1682472829, ""nbf""=>1682469109, ""iat""=>1682469229, ""jti""=>""02fab802-e3ca-11ed-99ee-000c294b5e9e"", ""iss""=>""[www.ibm.com|http://www.ibm.com]"", ""is_jwt""=>true, ""sub""=>""testuser""},
 {""alg""=>""RS256"", ""kid""=>""*MogQeZrVVC6Em0p4S8Xe1c5--URKA9yVwmTAfgzan30*""}]

10.0.4
% curl -s -k -u testuser:password1 [http://vaa4w.battle.mil/ds64/k/env.cgi|http://vaa4w.battle.mil/ds64/k/env.cgi] | grep IV_JWT | sed -e 's/.* = //;s/<.*//' | ruby -rjwt -ne 'pp JWT.decode($_,nil,false)'
[{""exp""=>1682472837, ""nbf""=>1682469117, ""iat""=>1682469237, ""jti""=>""07e329e4-e3ca-11ed-b1cd-000c292ed02f"", ""iss""=>""[www.ibm.com|http://www.ibm.com]"", ""is_jwt""=>true, ""sub""=>""testuser""}, {""alg""=>""RS256"", ""kid""=>""*server*""}]{quote}

The customer would like to know the kid in 10.0.5, to let Amazon ALB know while configuring them (without checking IV_JWT header).

By the way, this customer activated only “base” activation, so there’s no AAC/Fed runtime in their environment.
So, I tried jwks local-app of web reverse proxy but it returned “server” as kid even in 10.0.5.
(I’m not sure if this is expected behavior or not.)

Anyway, unfortunately, the customer would not like to enable local-app, so he is looking for any way to calculate kid from certificate if possible.","26/Apr/23 12:10 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9ec6d76184b7d989c83] 

Can you enable pdweb.debug and 

In webseal tracing config enable {{pd:*.9:UTF8FILE:pdweb_trace.log}} and send me trace from your environment.

This is what I see when I access my [https://RP/isam/sps/jwks|https://RP/isam/sps/jwks] 

[^jwks.json]

there is no label name in kid its all hashed values.



Are you asking the opposite of what was done in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4367|https://cloudidentity.atlassian.net/browse/ISAMSUP-4367|smart-link] ? 

previously it was sending the kid with the label and now it sends the hashed value to be inline with _/sps/jwks endpoint._



Thanks","27/Apr/23 11:11 AM;5b15d9ec6d76184b7d989c83;[~accountid:5af4ad7d4dd24c579110120b] ,
Sorry for my poor explanation.

'local-app' means, local application of web reverse proxy, which can be enabled by adding following in webseald-<instance name>.conf:

{quote}[local-apps]
# An example local application definition which enables the authorization
# decision API and makes this application available at the /aznapi path on the
# local junction:
#
# azn-decision = aznapi
cred-viewer = creds
jwks = jwks{quote}

then we can see keys by accessing like : [https://wrp.example.com/jwks|https://wrp.example.com/jwks]
This does not need AAC/Fed to be activated.
The change done by the APAR is important and we do not intend to ask you to revert it.
The end point by wrp does not return hashed value at this point.

Anyway, is it possible to generate the kid from certificate itself?

I’ll collect traces. Give me sometime.","27/Apr/23 12:50 PM;5b15d9ec6d76184b7d989c83;Since{{pd:*.9:UTF8FILE:pdweb_trace.log}}  didn’t generate the trace, I used {{*:*.9:UTF8FILE:pdweb_trace.log}} 

Please check traces.zip. It contains pdweb.debug.log and  pdweb_trace.log.

I sent following two requests while collecting traces:

{quote}% curl -s -u testuser:password1 [http://vaa5w.battle.mil/ds64/k/env.cgi|http://vaa5w.battle.mil/ds64/k/env.cgi] | grep IV_JWT |  sed -e 's/.* = //;s/<.*//' | ruby -rjwt -ne 'pp JWT.decode($_,nil,false)'
[{""exp""=>1682567185,
  ""nbf""=>1682563465,
  ""iat""=>1682563585,
  ""jti""=>""b3d61e4c-e4a5-11ed-8a82-000c294b5e9e"",
  ""iss""=>""[http://www.ibm.com|http://www.ibm.com|smart-link] "",
  ""is_jwt""=>true,
  ""sub""=>""testuser""},
 {""alg""=>""RS256"", ""kid""=>""MogQeZrVVC6Em0p4S8Xe1c5--URKA9yVwmTAfgzan30""}]

% curl -s -u testuser:password1 [http://vaa5w.battle.mil/jwks|http://vaa5w.battle.mil/jwks] | jq
{
  ""keys"": [
    {
      ""kty"": ""RSA"",
      ""kid"": ""server"",
      ""e"": ""AQAB"",
      ""n"": ""2vnWPTkvX7QMiX8Lxje2MjuNRNVc5dYHx0dT8dp9yS5h1vcW8aiK5I7Y03LZ4iJlHiS2Ub9WKPAzXM0oN1AjE0b14fTKuvzuAh4XU3GYygT0OqG7SVm9EUTc3ndt3-Q-3LmcVm1vUnUAuI7JKBy9FHmEmVSmA9n8q6Unkuo7znPdFUUF7RlVywtSct2H-SUlhhT6rMXyOmbLRJ4u9sNtuevpehbCCxxJTBaOz7_14b1--kNS4ICYUTmrwLUBwzgPvH19WMCyqzUUSyNFmhEGRUfNEB2kytbvSEx0W3OUzK2BaxNdwr0f7Mya3mHnf4iWHmYhy3SrJoF8EOAIXH2gHQ"",
      ""alg"": ""RS256""
    }
  ]
}{quote}

If you need any other info, please let me know.","27/Apr/23 12:52 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9ec6d76184b7d989c83] 

Can you attach the Webseal config file please.

Would it help if we checked if there was a way to change the response from -

[http://vaa5w.battle.mil/jwks|http://vaa5w.battle.mil/jwks] 
to have hashed value instead of label? ","27/Apr/23 12:54 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,
I attached my webseald-default.conf.","27/Apr/23 1:01 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9ec6d76184b7d989c83] 

Would it help if we checked if there was a way to change the response from -

[http://vaa5w.battle.mil/jwks|http://vaa5w.battle.mil/jwks] 
to have hashed value instead of label?","27/Apr/23 3:12 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,
I, personally, think if kid is not generated in standardized way (like RFC etc.), then we do not need to disclose how to generate it. But if so, then jwks local-app should have hashed value.

If we disclose how to generate the hashed value, then we need to publish it as document, and can not change the behavior easily. I think providing end point is enough. But in some case, the customer would not like to use local-app. For example, if we can provide any way to check the kid in somewhere in LMI menu, it would be helpful for some customers, but it would be enhancement request.

So, if we can modify the behavior of local-app, then let me try to persuade the customer to use the end point to retrieve kid. If we should not change the behavior of jwks local-app, then it would be helpful if we can provide any other way to know kid.","28/Apr/23 10:27 AM;5af4ad7d4dd24c579110120b;<Notes>
AMWJwksApp.cpp 

label shows up WebSEAL-Test-Only, this needs to be hashed and added to jwks key.

{noformat}        unsigned char localhashedkid[AMWICC_HASH_DIGEST_SIZE];
        size_t hashedLen;
        char*  hashedKid_;
        cjose_err err;
        const cert_data_elem& cenew = cert_elems[idx];

        AMWICCHashRaw(cenew.cert_data_l,cenew.cert_data_p, AMWICC_HASH_DIGEST_SIZE, localhashedkid) ;
        cjose_base64_encode((const unsigned char*)localhashedkid, sizeof(localhashedkid), &hashedKid_, &hashedLen, &err) ;

        fprintf(stdout, ""ASHA0000 jwksapp label %s \n"", label);
        fprintf(stdout, ""ASHA0000 jwksapp hashed %s \n"", localhashedkid);{noformat}

 ASHA0000 jwksapp label WebSEAL-Test-Only  -- ASHA0000 jwksapp hashed ºa˜ê^6÷¹‘â éa°Ÿ.!êorË¦U8³ñ ","02/May/23 3:12 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9ec6d76184b7d989c83] 

Here is a fixpack for localapps /JWKS to send hashed kid instead of label:

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5034|https://cloudidentity.atlassian.net/browse/ISAMSUP-5034|smart-link] 

Let me know how you go.

Thanks","02/May/23 10:27 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

Thank you very much for providing me the fixpack so quickly.
It works as expected in local environment.

Let me confirm some things.
Can this be used with 10.0.5 IF1?
If the customer insists to provide any way to know the kid without using local-app, can I recommend the customer to open new “Ideas” to implement such new function?


","03/May/23 9:51 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9ec6d76184b7d989c83] 

10.0.5.0 IF1 will need a new fixpack built, let me know if you need one.

Yes - they can open a new idea if they need such a functionality.

Please create an APAR to track this.

Thanks","03/May/23 11:16 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 74d836fda428cd473a295de71e7d66650e150788
   * description: ISAMSUP-5009 Update local jwks app to send hashed kid instead of label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/255017.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5009) which we publish.","05/May/23 1:44 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 66f6207bbd377c04b5c97df833e930f5e4616340
   * description: ISAMSUP-5009 Update dealloc based on review

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/296146.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5009) which we publish.","05/May/23 2:26 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: bc845352428d99073e949b3c14b1c433009eeb67
   * description: ISAMSUP-5009 Update based on review

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/296728.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5009) which we publish.","05/May/23 3:58 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 259ae0bfecd776301dbf820c819d5fc3639d549c
   * description: ISAMSUP-5009 Move up declaration

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/297008.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5009) which we publish.","08/May/23 11:25 AM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,
Sorry to late to respond. We have several national holidays last week in Japna.
I opened IJ46696 for this issue. {color:#ffffff}IJ46696{color} {color:#ffffff}IJ46696{color}","08/May/23 11:55 AM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,
The customer has some more questions.
1 . can this be fixed in 10.0.6?
2 . Is the hashed value based only on certificate?

Since the customer would not like to enable local app in their production environment,
he would like to prepare another appliance and check the kid. So, he would like to know if he can acquire the same kid using another appliance. For example, does he need to set the same key label on the different appliance to get the same kid?

Any comments are really appreciated.","09/May/23 10:58 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9ec6d76184b7d989c83] 

I have submitted the changes, it might get into 10.0.6

will let you know if otherwise.

The kid generated on an appliance for the same label will be different. so I am not sure if they can use it from different appliance.

If you’d like to test the same:

I set up 2 appliances with local-apps for jwks and for WebSeal-Test-Only I got 2 different kid -

appliance1: jyAFMfGbXygOdRTDrGa-Smourd7Lh8aVblSjYyAAeYg

appliance2: d8AsvJ9dqLoql7ioupqPgwkKQTbO5ozOaT96FCT3cq4","09/May/23 4:34 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] 

I put the same certificates to different appliance, and checked the kids by accessing /jwks.
Luckily, they are the same even if I changed their labels.
I guess, in your env, certificates labeled as WebSeal-Test-Only are different certificates.

{noformat}# curl -s -u testuser:password1 http://vaa5w.battle.mil/jwks | jq -C -r '.keys[]|.kid' | sort
Pe1UTu2HaoOTHMPk2SAhzf9DqcZbWyb5RYkAoN6-Edk
UdljZ342DyHgKNUxsVtBz-SEH4AK87ROVeHiTulf1rI
V_Q0crCwsoIMvXV3WcohaQb92alu566-Zb6VfqfjIjw

# curl -s -u testuser:password1 http://upgw.battle.mil/jwks | jq -C -r '.keys[]|.kid' | sort
Pe1UTu2HaoOTHMPk2SAhzf9DqcZbWyb5RYkAoN6-Edk
UdljZ342DyHgKNUxsVtBz-SEH4AK87ROVeHiTulf1rI
V_Q0crCwsoIMvXV3WcohaQb92alu566-Zb6VfqfjIjw
{noformat}

So, I think kid is based only on certificate itself. What do you think?
I mean, if the customer set necessary certificate on the other appliance and can get kid from it, if my guess is correct.",09/May/23 4:36 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9ec6d76184b7d989c83] yes that’s correct ,"09/May/23 5:42 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

The customer agreed to close the case.
Thank you very much for co-operation!
","15/May/23 1:15 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 3e6459804850d18c0df0946ca429540de624a79a
   * description: ISAMSUP-5009 Changes based on review

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/444156.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5009) which we publish.","15/May/23 5:26 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f9e99818a2be99df464783b0c6f705e82a96745f
   * description: Merge pull request #5894 from ISAM/ISAMSUP-5009

ISAMSUP-5009 Update local jwks app to send hashed kid instead of label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/445796.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230515072324-f9e99818.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","15/May/23 6:43 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f9e99818a2be99df464783b0c6f705e82a96745f
   * description: Merge pull request #5894 from ISAM/ISAMSUP-5009

ISAMSUP-5009 Update local jwks app to send hashed kid instead of label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/446984.


This build has not been published as the commit is not currently within a branch (20230515072324-f9e99818) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 Normal memory usage for Weseal? V10.0.5_IF1,ISAMSUP-4990,295449,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Peter Horner,5b15d9517dab4c51f61b5190,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,19/Apr/23 6:57 PM,03/Jul/23 9:30 AM,14/Jul/23 2:47 PM,,,,,0,Growth,,,"The customer having high memeory (80%) memory usage warning and they can see it is growing. It was upgrade was 10.0.3.1 -> 10.0.5 -> 10.0.5-ISS-ISVA_IF0001 Fixpack on April 13th. Their envirement is two node cluster. Both nodes equipemt 32GB memory.The second node seems not effected. They said they have around 10 000 - 50 000 userlogins a day.  When they do a restart the high memory consumption decreased and it is building up again.

!image-20230419-085806.png|width=1666,height=632!

!image-20230419-085854.png|width=1812,height=327!

*Waiting for Core file from customer.*",,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4460,,,,,,,19/Apr/23 7:04 PM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230419-085806.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/196729,19/Apr/23 7:04 PM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230419-085854.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/196728,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012774999,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,ET FOR ØKONOMISTYRING,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1asi7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-19 22:57:42.209,,,,,20/Apr/23 8:57 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] assigning this item to you to assess as part of the other similar issues. ,"25/Apr/23 4:00 AM;5b17571b91981f4fdde632c1;* For all WebSEAL memory issues
** Please add yourself as a watcher to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]
*** The top line of the comment for all WebSEAL memory watchers/issues will be something similar to
**** “For all WebSEAL memory issues”
*** Since the instructions are changing rapidly based on data and analysis
**** All status, instructions and updates will be done in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link] so everyone is working on the latest instructions
** This customer’s analysis will be provided in in this work item
*** Once root cause(s) are uniquely identified, then we may potentially collapse the same work items
** Please note for one customer so far we have two completely different problems","09/May/23 3:34 AM;5b17571b91981f4fdde632c1;[https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]

* From 2023-04-24 L3 instruction for each {color:#bf2600}*Critical and Required* {color}section
** Please provide current and complete status","30/May/23 3:21 AM;5b17571b91981f4fdde632c1;* All memory leaks must be watching [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link] for common instruction
* From [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]
** 2023-04-24 L3 instruction for each {color:#bf2600}*Critical and Required* {color}section
*** Please provide current and complete status","06/Jun/23 7:06 PM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] I just updated the instructions for the customer as below and wait for them to reply.

We need two sets of data. One is daily process statistics files and one is system core files:

+The daily process statistics file+

Right before you make the change below, Please take one final set of CLI -> Diagnostics -> ps (we need the out as txt file)

Update the WebSEAL configuration file with:

[system-environment-variables]

*MALLOC_CHECK_=3* ( Please NOTE the underbar at the end )

*GLIBC_TUNABLES=glibc.malloc.tcache_count=0*

Tunable: glibc.malloc.tcache_count

The maximum number of chunks of each size to cache.

The default is 7.

The upper limit is 65535.

If set to zero, the per-thread cache is effectively disabled.

Continue monitoring process and CPU graphs with the lowest granularity system CPU%

(requires restart)

Once the change is in effect capture the pidstat/ps data every day for a week. Make sure you name the files with the date so we can easily track the CPU and memory utilization.

After 7 days of collection with the change, upload the data to us for analysis.

+System core file+

To do this, we need core dumps of the webseal process over a period of time as the memory grows over 85% before it crash.

Please be aware that when the core is generated, it will use up close to the amount of disk space that the process was using in memory at the time of the core. As you progress, the core files will get bigger and bigger, so you need to ensure you have disk space enough to generate the core and the support file. Once the support .file is generated it will delete the core from the appliance so there should be no need to clean it up manually.

Don’t forget to provide us with the support file.","13/Jun/23 11:03 AM;5b17571b91981f4fdde632c1;* For IBM ISVA Support only
** ssl-max-entries

{noformat}  1 [ssl]	ssl-max-entries 1048576
  1 [ssl]	ssl-max-entries 4096{noformat}



*  
** max-entries

{noformat}      1 [session]	max-entries 4096{noformat}",03/Jul/23 8:58 AM;5ac57757d9a96536d1f0daa9;Reassigning Jira item to [~accountid:5b15d9517dab4c51f61b5190] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Issue with framing parameter in config file,ISAMSUP-4978,294683,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,14/Apr/23 6:12 PM,31/May/23 10:24 AM,14/Jul/23 2:47 PM,31/May/23 10:24 AM,,,,0,,,,"Hello Team,

The issue is related to editing/saving in webseal configuration file.

The customer trying to delete the incorrect entries of stanza [rsp-header-names]

After they removed the old wrong setting with new one(suggested by us) but after deploy the old wrong setting are coming by automatically.

We suggested the stanza set this way:

_[rsp-header-names:x-frame-options: SAMEORIGIN]_
_[rsp-header-names:x-frame-options: ALLOW]_
_[rsp-header-names:x-xss-protection: 1]_

They were using the following:
[rsp-header-names:VH001ATROPOS]
x-content-type-options = nosniff
x-frame-options = ALLOW
x-xss-protection = 1

We tested it on our VM and we get the same behaviour.",,BRIANORO,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,6154906364ff01007106e189,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012698129,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,KBC GROUP NV,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1antr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-04-17 01:37:15.663,,,,,"17/Apr/23 11:37 AM;5b15d954b0d76456f36daf33;There seems to be an issue with deleting these using the configuration editor.  But for other valid junction stanzas, it works as expected.

However you can still delete these using the documented RAPI command:

{noformat}DELETE https://{appliance}/wga/reverseproxy/{instance}/configuration/stanza/rsp-header-names:x-xss-protection: 1{noformat}","17/Apr/23 4:24 PM;5b15d954b0d76456f36daf33;We could have stanzas that could potentially be without any entries (eg: [interfaces] , [validate-headers]). In such cases, the default action is to retain the stanzas in the conf file.

Since what this customer added were essentially empty stanzas, they were being treated similarl to [interfaces] or [validate-names].

Apart from the RAPI workaround I suggested before, they could add any dummy entries under each of those stanzas, save and deploy the changes. Then they should be able to select the stanzas and the entries underneath to delete them all.",19/Apr/23 12:02 AM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Is it bug or works as design? Please advise,19/Apr/23 10:03 AM;5b15d954b0d76456f36daf33;It is working as designed. You get the same behaviour if you for example try to delete the [interfaces] stanza. It will be automatically added back.,19/Apr/23 5:34 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Thanks for your confirmation. I will explain it to customer. ,"31/May/23 10:24 AM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687]  we should be done with this, so closing the item.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
JWT Stanza is not listing groups as an Array if there is only one group,ISAMSUP-4972,294210,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,13/Apr/23 6:47 PM,20/Jun/23 8:40 AM,14/Jul/23 2:47 PM,20/Jun/23 8:40 AM,,,,0,,,,"[jwt:<jct-id>] 

claim = attr::AZN_CRED_GROUPS::groups

 if session has single group then result JWT token looks like 

{noformat}{ ""exp"": 1679495286, ""nbf"": 1679494566, ""iat"": 1679494686, ""jti"": ""5d40b038-c8bc-11ed-8974-005056823e02"", ""groups"": ""group1"", . . } {noformat}

If session has more then one group then it outcome is as follow 

{noformat}{ ""jti"": ""wKKQ4sIg"", ""iat"": 1679493428, ""nbf"": 1679493428 ""groups"": [ ""group1"", ""group2"", ],{noformat}



Customer is expecting an array in all circumstances. The customer discussed this with Philip Nye whom believes a fixpack is needed. ",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012516317,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,TIETOEVRY NORWAY AS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1akwv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-13 20:14:16.843,,,,,"14/Apr/23 6:14 AM;5b15d94b6256d01ad54eb020;The JWT code is generic and handles any attribute from the credential.   Not all attributes in the credential are multi-valued.   The only way the code can tell if it should be an array or not is if it is a multi-valued object.   To always return an array for the group would mean all attributes would be converted to arrays which I don’t think makes sense to do.

In my opinion this is working as designed.",17/Apr/23 5:44 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] I saw this Jira set to L2? Are you attempting this or referring to Bill?,"17/Apr/23 6:29 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:614dd566a995ad0073ec0622] 

This is a common code where the attributes are processed and it is working as designed.

As Bill mentioned - not all attributes in a credential are multi valued so this design won't change as it caters for attributes with single and multi values.



----

This is for your reference only to under stand what the single and multi valued attributes look like based on a sample test I ran - 

{noformat}webseal config changes -
jct-cert-keyfile = pdsrv
jct-cert-keyfile-stash = pdsrv.sth
[jwt:/jwtjct]
key-label = WebSEAL-Test-Only
claim = attr::AZN_*
claim = attr::AZN_CRED_PRINCIPAL_NAME::sub
include-empty-claims = false
hdr-name = iv-jwt
hdr-format = %TOKEN%
lifetime = 0
renewal-window = 15
Use https://jwt.io to see the debug values- {noformat}

This is a JWT with  ""AZN_CRED_GROUPS"": ""secmgrd-servers""

{noformat}eyJraWQiOiJQZFJwS1hIOGhsemJIV2JWczB0X1hwVUNPU1lrUkVfY1pFWmFBTjZzSWY4IiwiYWxnIjoiUlMyNTYifQ.eyJBWk5fQ1JFRF9BVVRIX01FVEhPRCI6InBhc3N3b3JkIiwiQVpOX0NSRURfR1JPVVBfVVVJRFMiOiI3ODJkNmE3YS1kYWI1LTExZWQtOTFlMi1mYTE2M2UxODk0M2EiLCJ0YWd2YWx1ZV91c2VyX3Nlc3Npb25faWQiOiJiRzlqWVd4b2IzTjBMV1JsWm1GMWJIUUFfWkR6RzF3QUFBQUlBQUFBdzE4WThaTWlISVlTdmZ3QUFka05VWkZWVmJsaGFNemRuT0d0UFVFNVdZMlpEYm1kM1puUXlNbVpHUnpCNE9YTlVPV05WUVd4eGJWaG1WbXhhOmRlZmF1bHQiLCJBWk5fQ1JFRF9QUklOQ0lQQUxfVVVJRCI6IjgzZjFlNmYyLWRjZDUtMTFlZC1iMGU5LWZhMTYzZTE4OTQzYSIsIkFaTl9DUkVEX1FPUF9JTkZPIjoiU1NLOiBUTFNWMTI6IDJGIiwiQVpOX0NSRURfUFJJTkNJUEFMX0RPTUFJTiI6IkRlZmF1bHQiLCJBVVRIRU5USUNBVElPTl9MRVZFTCI6IjEiLCJBWk5fQ1JFRF9SRUdJU1RSWV9JRCI6ImNuPXRlc3R1c2VyMSxkYz1pc3dnYSIsIkFaTl9DUkVEX0FVVEhfRVBPQ0hfVElNRSI6IjE2ODE3MDQ2NjMiLCJBWk5fQ1JFRF9ORVRXT1JLX0FERFJFU1NfU1RSIjoiMTAuMTY2LjEuMTAiLCJBWk5fQ1JFRF9BVVRITk1FQ0hfSU5GTyI6IkxEQVAgUmVnaXN0cnkiLCJBWk5fQ1JFRF9HUk9VUFMiOiJzZWNtZ3JkLXNlcnZlcnMiLCJBWk5fQ1JFRF9QUklOQ0lQQUxfTkFNRSI6InRlc3R1c2VyMSIsIkFaTl9DUkVEX0lQX0ZBTUlMWSI6IkFGX0lORVQiLCJ0YWd2YWx1ZV9zZXNzaW9uX2luZGV4IjoiZDkzMjI3MzAtZGNkNS0xMWVkLWJkZjAtZmExNjNlMTg5NDNhIiwiQVpOX0NSRURfTkVUV09SS19BRERSRVNTX0JJTiI6IjB4MGFhNjAxMGEiLCJBWk5fQ1JFRF9CUk9XU0VSX0lORk8iOiJNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMC4xNTsgcnY6MTA5LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTExLjAiLCJBWk5fQ1JFRF9HUk9VUF9SRUdJU1RSWV9JRFMiOiJjbj1zZWNtZ3JkLXNlcnZlcnMsY249U2VjdXJpdHlHcm91cHMsc2VjQXV0aG9yaXR5PURlZmF1bHQiLCJBWk5fQ1JFRF9WRVJTSU9OIjoiMHgwMDAwMTAwNiIsIkFaTl9DUkVEX01FQ0hfSUQiOiJJVl9MREFQX1YzLjAiLCJBWk5fQ1JFRF9BVVRIWk5fSUQiOiJjbj10ZXN0dXNlcjEsZGM9aXN3Z2EiLCJ0YWd2YWx1ZV9tYXhfY29uY3VycmVudF93ZWJfc2Vzc2lvbnMiOiJ1bnNldCIsInRhZ3ZhbHVlX2xvZ2luX3VzZXJfbmFtZSI6InRlc3R1c2VyMSIsImlhdCI6MTY4MTcwNDY2M30.T6vEBYvwjGYyiu5D-m1UGLFLj88wf1AOxR6xIYh2_y6QrhMu9iBCw5t8KmBtWpWO-e_oCzXyI4NMY8kzSKjcgcLMTr99sH-xKQz_kg8v6BrHuttOhEPXC1PJMFEs_SuTk_A0P3GiSumDylT0NEfTCI5Tq3g-5IIi7kvV64bcRJU{noformat}

This is a JWT with ""AZN_CRED_GROUPS"": [
    ""ivacld-servers"",
    ""remote-acl-users"",
    ""su-admins""
  ],

{noformat}eyJraWQiOiJQZFJwS1hIOGhsemJIV2JWczB0X1hwVUNPU1lrUkVfY1pFWmFBTjZzSWY4IiwiYWxnIjoiUlMyNTYifQ.eyJBWk5fQ1JFRF9BVVRIX01FVEhPRCI6InBhc3N3b3JkIiwiQVpOX0NSRURfR1JPVVBfVVVJRFMiOlsiNzgxZWQ0ZWMtZGFiNS0xMWVkLTkxZTItZmExNjNlMTg5NDNhIiwiNzgyMDU2ODItZGFiNS0xMWVkLTkxZTItZmExNjNlMTg5NDNhIiwiN2UxZjY0OWMtZGFiNS0xMWVkLWIwZTktZmExNjNlMTg5NDNhIl0sInRhZ3ZhbHVlX3VzZXJfc2Vzc2lvbl9pZCI6ImJHOWpZV3hvYjNOMExXUmxabUYxYkhRQV9aRHpHNmdBQUFBSUFBQUF3NnNZOFpGaGRMSVN2ZndBQU1reFBRVGR1VWtGME4xcHVaa0UyZFdaR2VYRnVjMlpuWTBOT1dqTmpha3RPVlRsUlkxWnhUM053VDJ4NVQwbEU6ZGVmYXVsdCIsIkFaTl9DUkVEX1BSSU5DSVBBTF9VVUlEIjoiOWMzMmMyMTgtZGNkNS0xMWVkLWIwZTktZmExNjNlMTg5NDNhIiwiQVpOX0NSRURfUU9QX0lORk8iOiJTU0s6IFRMU1YxMjogMkYiLCJBWk5fQ1JFRF9QUklOQ0lQQUxfRE9NQUlOIjoiRGVmYXVsdCIsIkFVVEhFTlRJQ0FUSU9OX0xFVkVMIjoiMSIsIkFaTl9DUkVEX1JFR0lTVFJZX0lEIjoiY249dGVzdHVzZXIyLGRjPWlzd2dhIiwiQVpOX0NSRURfQVVUSF9FUE9DSF9USU1FIjoiMTY4MTcwNDY4MiIsIkFaTl9DUkVEX05FVFdPUktfQUREUkVTU19TVFIiOiIxMC4xNjYuMS4xMCIsIkFaTl9DUkVEX0FVVEhOTUVDSF9JTkZPIjoiTERBUCBSZWdpc3RyeSIsIkFaTl9DUkVEX0dST1VQUyI6WyJpdmFjbGQtc2VydmVycyIsInJlbW90ZS1hY2wtdXNlcnMiLCJzdS1hZG1pbnMiXSwiQVpOX0NSRURfUFJJTkNJUEFMX05BTUUiOiJ0ZXN0dXNlcjIiLCJBWk5fQ1JFRF9JUF9GQU1JTFkiOiJBRl9JTkVUIiwidGFndmFsdWVfc2Vzc2lvbl9pbmRleCI6ImU1YTVkNjljLWRjZDUtMTFlZC1iZGYwLWZhMTYzZTE4OTQzYSIsIkFaTl9DUkVEX05FVFdPUktfQUREUkVTU19CSU4iOiIweDBhYTYwMTBhIiwiQVpOX0NSRURfQlJPV1NFUl9JTkZPIjoiTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTAuMTU7IHJ2OjEwOS4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzExMS4wIiwiQVpOX0NSRURfR1JPVVBfUkVHSVNUUllfSURTIjpbImNuPWl2YWNsZC1zZXJ2ZXJzLGNuPVNlY3VyaXR5R3JvdXBzLHNlY0F1dGhvcml0eT1EZWZhdWx0IiwiY249cmVtb3RlLWFjbC11c2Vycyxjbj1TZWN1cml0eUdyb3VwcyxzZWNBdXRob3JpdHk9RGVmYXVsdCIsImNuPXN1LWFkbWlucyxjbj1TZWN1cml0eUdyb3VwcyxzZWNBdXRob3JpdHk9RGVmYXVsdCJdLCJBWk5fQ1JFRF9WRVJTSU9OIjoiMHgwMDAwMTAwNiIsIkFaTl9DUkVEX01FQ0hfSUQiOiJJVl9MREFQX1YzLjAiLCJBWk5fQ1JFRF9BVVRIWk5fSUQiOiJjbj10ZXN0dXNlcjIsZGM9aXN3Z2EiLCJ0YWd2YWx1ZV9tYXhfY29uY3VycmVudF93ZWJfc2Vzc2lvbnMiOiJ1bnNldCIsInRhZ3ZhbHVlX2xvZ2luX3VzZXJfbmFtZSI6InRlc3R1c2VyMiIsImlhdCI6MTY4MTcwNDY4M30.vAfDjLuF1hoKQS3_6mXhhTrMdaDoHFuVLVI55HeNJlytVdIpBEHXYwiPWxWuwXGH-rn1KNLs7t-EC6Q3D88Y6uKQdxAVNxgZ6JoVKnxPNgdXB8JuAoEVHyhww1nBeUawQLwzhFSGYjfHkk69fbo_KnGk2TtOUHXpi9jBRmMoImg{noformat}",23/May/23 6:16 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] Customer has hit the escalation button for the PMR for this issue. I have advised I would ask L3 again for a fix. Please confirm that a fix can be provided or simply reiterate that this feature is working as designed and I can simply push to close the PMR. thank you. ,"24/May/23 9:09 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:614dd566a995ad0073ec0622] 

This is working as designed and it might affect backward compatibility since a lot of other clients will be using the same format and also there are multiple other AZN attributes, so there needs to be an informed call on a blanket change or specific change.

 Can you get the customer to log an RFE and the dev will take a call on if the changes can be implemented.

Thanks",24/May/23 5:17 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] So a custom fixpack for this customer is not possible nor recommeneded?,"24/May/23 5:32 PM;5af4ad7d4dd24c579110120b;Customer can log an RFE and that will be reviewed and if accepted the change will be made in the product.

As of today no fixpack.","30/May/23 10:59 AM;5af4ad7d4dd24c579110120b;<notes>

JWTManager.cpp 

error_status_t JWTManager::addAttribute(
Changing count>1 to count>=1 will make an array when attributes are single but this affects all AZN attributes.

{noformat}if (count >= 1) {
    element = json_array();

    json_object_set_new(root, claimName, element);
}

        if (status == AZN_S_COMPLETE) {
            if (count >= 1) {
                json_array_append_new(element, json_string(str_value));
                
                
  if (status == AZN_S_COMPLETE) {
            if (count > 1) {{noformat}

{noformat}eyJhbGciOiAiUlMyNTYiLCAia2lkIjogImpCdEg2SWVTVEw5M1FLZUg0TFk4V2JqMUR6cjQtSWpCSTV0aHFGREt3TmsifQ.eyJleHAiOiAxNjg1NDExMzQwLCAibmJmIjogMTY4NTQwNzYyMCwgImlhdCI6IDE2ODU0MDc3NDYsICJqdGkiOiAiYzdmZTk5N2UtZmU4My0xMWVkLWE0M2ItZmExNjNlOTFhNzdlIiwgInN1YiI6IFsidGVzdHVzZXIiXSwgIkFaTl9DUkVEX0FVVEhOTUVDSF9JTkZPIjogWyJMREFQIFJlZ2lzdHJ5Il0sICJBWk5fQ1JFRF9BVVRIWk5fSUQiOiBbImNuPXRlc3R1c2VyLGRjPWlzd2dhIl0sICJBWk5fQ1JFRF9BVVRIX0VQT0NIX1RJTUUiOiBbIjE2ODU0MDc3NDYiXSwgIkFaTl9DUkVEX0FVVEhfTUVUSE9EIjogWyJwYXNzd29yZCJdLCAiQVpOX0NSRURfQlJPV1NFUl9JTkZPIjogWyJNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMC4xNTsgcnY6MTA5LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTEzLjAiXSwgIkFaTl9DUkVEX0dST1VQUyI6IFsid2Vic2VhbC1zZXJ2ZXJzIl0sICJBWk5fQ1JFRF9HUk9VUF9SRUdJU1RSWV9JRFMiOiBbImNuPXdlYnNlYWwtc2VydmVycyxjbj1TZWN1cml0eUdyb3VwcyxzZWNBdXRob3JpdHk9RGVmYXVsdCJdLCAiQVpOX0NSRURfR1JPVVBfVVVJRFMiOiBbIjdiNDZiYWMwLWZkYzEtMTFlZC1iMGY0LWZhMTYzZTkxYTc3ZSJdLCAiQVpOX0NSRURfSVBfRkFNSUxZIjogWyJBRl9JTkVUIl0sICJBWk5fQ1JFRF9NRUNIX0lEIjogWyJJVl9MREFQX1YzLjAiXSwgIkFaTl9DUkVEX05FVFdPUktfQUREUkVTU19CSU4iOiBbIjB4MGFhNjAxMDYiXSwgIkFaTl9DUkVEX05FVFdPUktfQUREUkVTU19TVFIiOiBbIjEwLjE2Ni4xLjYiXSwgIkFaTl9DUkVEX1BSSU5DSVBBTF9ET01BSU4iOiBbIkRlZmF1bHQiXSwgIkFaTl9DUkVEX1BSSU5DSVBBTF9OQU1FIjogWyJ0ZXN0dXNlciJdLCAiQVpOX0NSRURfUFJJTkNJUEFMX1VVSUQiOiBbIjk3OGY2NzFjLWZkYzItMTFlZC1iY2JlLWZhMTYzZTkxYTc3ZSJdLCAiQVpOX0NSRURfUU9QX0lORk8iOiBbIlNTSzogVExTVjEyOiAyRiJdLCAiQVpOX0NSRURfUkVHSVNUUllfSUQiOiBbImNuPXRlc3R1c2VyLGRjPWlzd2dhIl0sICJBWk5fQ1JFRF9VU0VSX0lORk8iOiBbIiJdLCAiQVpOX0NSRURfVkVSU0lPTiI6IFsiMHgwMDAwMTAwNSJdfQ.Zqi0ReCNehPpL4paZKsaaKopsPLnlMPQqv3x1Z4dKWEuuGImJ_tHnO0czDlpoZvsZjQbmdLqxnT-Dyikgk7KW44tXCw-R-U6k9cN-7o-Z82jJZuBhBo4J3SUoABNjd5Z_9fpuH0MKrIPyFGm3YFBzOLBsQo9Q2_rvFIBpn0y1xkyOTEEovbKfXHOostkRgrgOnTmwVm56ZqHrfGket0SNouOHqpHtKMQBPPu8pXflLuubKCIJQXatjHfjzpKMZqIsyzOu6ygTRQThUpgnj78tej_hQEXFbHjHem-E9AH1vAu-Wssd2cN6VBvmMzBe8TWYoiYPQOmGtgWE8eZeBi3IA{noformat}

But this affects all attributes. Not sure if we should go the path of changing specific attributes.
This might affect backward compatibility and/or the way sub and its etc are consumed. 


Hence communicated to log an RFE.
",20/Jun/23 8:40 AM;5af4ad7d4dd24c579110120b;case closed. hence closing jira.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
order of fixpack installation,ISAMSUP-4970,294070,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,13/Apr/23 3:11 AM,26/Apr/23 12:08 AM,14/Jul/23 2:47 PM,26/Apr/23 12:08 AM,,,,0,,,,"Customer has the following fixpack installed: updt_server_xml_bin_1050_v1.fixpack

Customer wants to install v10.0.5 IF1.

Does the customer need to perform any additional steps before/after the v10.0.5 IF install to ensure the updt_server_xml_bin fixpack is still working as expected?",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012711732,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Reagan Knowles,5b15d9e44c4ed14b83af8723,,,,Royal Bank,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{branch={count=1, dataType=branch}, json={""cachedValue"":{""errors"":[],""summary"":{""branch"":{""overall"":{""count"":1,""lastUpdated"":null,""dataType"":""branch""},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1ak0v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-12 19:12:55.2,,,,,"13/Apr/23 5:12 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9e44c4ed14b83af8723]  That fix pack updates mesa_config  so I might need to build you a new version.  I’ll check on it.

Update:  The final fix for that issue will be in 10.0.6.0 but it’s not in 10.0.5.0 IF1 so I need to build a new version for IF1.  

When do they need it?","13/Apr/23 6:06 AM;5b15d9e44c4ed14b83af8723;Are you talking days or weeks? I’m guessing it can be available in 4-5 business days. It’s hard to tease that information out of the customer without just blatantly asking, because they will simply say “as soon as possible.”",13/Apr/23 6:13 AM;5b15d94b6256d01ad54eb020;It shouldn’t take very long.  I thought maybe they had mentioned their plan.  If you need a time frame let’s say about a week  (it will probably be a day or two depending on when I start on it).,"13/Apr/23 6:26 AM;5b15d9e44c4ed14b83af8723;Customer just provided this update:

“We were planning to start the IF1 rollout next week (week of April 17). One of the two vulnerabilities (CVE-2022-29154) has a high CVSS score.

Can IF1 be installed safely on a Base appliance (no AAC or Fed) *before* we apply IF1 + new updt_server_xml_bin fixpack to the AAC/Fed appliance that has the AAC runtime used by WebSEALs on the Base appliance?”",13/Apr/23 6:55 AM;5b15d94b6256d01ad54eb020;The only thing that fix pack does is fix the tuning parameter.   It’s a small change so I already started  a build.  Baring any problems I can get it to you tomorrow or Friday.,"14/Apr/23 7:42 AM;5b15d94b6256d01ad54eb020;Here is the  10.0.5.0_IF1 version of the fix pack.

[https://ibm.ent.box.com/folder/203304936376|https://ibm.ent.box.com/folder/203304936376|smart-link] ",18/Apr/23 1:33 AM;5b15d9e44c4ed14b83af8723;Thanks. I am sending this to the customer now.,"26/Apr/23 12:08 AM;5b15d9e44c4ed14b83af8723;Customer upgraded and installed the fixpack successfully. Customer agreed to close the case. Thanks, Bill!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"Is there any chance ISAM had to do with this IP dns.qry.name == ""141.96.156.10.in-addr.arpa"" ",ISAMSUP-4969,293917,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,12/Apr/23 2:19 PM,31/May/23 11:43 PM,14/Jul/23 2:47 PM,31/May/23 11:43 PM,,,,0,,,,"Its been found there is a dns query [dns.qry.name|https://dns.qry.name/] == ""[+141.96.156.10.in-addr.arpa+|https://141.96.156.10.in-addr.arpa/]""



Customer is in singapore and the ip is from belgium and customer has denied they had to do anything with this.

this is a hardware appliance.(from 904) and upgraded to 10.0.4.0



Is there any chance that its been used in the appliance?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012371483,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,Great Eastern,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1aj3r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-12 13:52:28.299,,,,,"12/Apr/23 2:21 PM;5c53d3ac23f5bf672621c868;logs can be found in S:\sf\TS012\371\TS012371483\2023-03-08\Packet_Trace.zip_unpack\



trace01-differentSubnet.pcap



look for dns query around : [+dns.qry.name+|https://dns.qry.name/] == ""[+141.96.156.10.in-addr.arpa+|https://141.96.156.10.in-addr.arpa/]""","12/Apr/23 2:22 PM;5c53d3ac23f5bf672621c868;support file : 

S:\sf\TS012\371\TS012371483\2023-03-09\Support.doc_unpack\support.zip_unpack\



snapshot

S:\sf\TS012\371\TS012371483\2023-03-24\Trace_files.zip_unpack\isva_10.0.4.0_20230324-113849.641106.snapshot_unpack\





scan of the above didn’t show the ips",12/Apr/23 11:52 PM;5b15d94b6256d01ad54eb020;No we do not have any hard coded ip addresses other than localhost  (127.0.0.1).,"13/Apr/23 10:44 AM;5b15d9517dab4c51f61b5190;That is a reverse dns lookup of address 10.156.96.141

If you use a filter of ip.host==10.156.96.41 on the differentsubnet pcap you will see that ip is connected to appliance

on 10.163.127.81:443

I know webseal does not do reverse dns lookups of the ip addresses that connect to it.

But I don’t know about the java side of the appliance - and 10.163.127.81:443 is the java runtime server

The dns query is coming from the appliance

with filter dns on the differentsubnet pcap it  shows the reverse lookup originating from 10.163.127.80 and retrying after no response in 5 seconds

If you use a filter ip.host==10.156.96.141 || dns you can see them together","14/Apr/23 2:10 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9517dab4c51f61b5190] 

the reverse lookup is comming from the runtime.



but it seems not clear why as customer has no association with the ip



[https://github.com/OpenLiberty/open-liberty/issues/14063|https://github.com/OpenLiberty/open-liberty/issues/14063|smart-link] ","14/Apr/23 3:21 PM;5b15d9517dab4c51f61b5190;all ip addresses starting with 10 are reserved for private networks

[https://en.wikipedia.org/wiki/Reserved_IP_addresses|https://en.wikipedia.org/wiki/Reserved_IP_addresses|smart-link] 

eg We use a 10 network in our lab

So it has to be coming from within their network

I think there was a misunderstanding in reading the ip address backwards in the reverse lookup ",31/May/23 11:43 PM;5b15d901fa615349cb01778b;case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unable to delete sub folder from Template files in Federation.,ISAMSUP-4960,292702,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,07/Apr/23 1:20 AM,31/May/23 5:54 PM,14/Jul/23 2:47 PM,30/May/23 10:01 AM,,,,0,,,,"Customer unable to delete sub folder from Template files in Federation such as ‘ar’ shown below. Previous cases have indicated a fixpack would be needed?



!image-20230406-151917.png|width=1869,height=792!",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,07/Apr/23 1:20 AM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230406-151917.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/194873,07/Apr/23 6:41 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230407-084023.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/195064,14/Apr/23 11:21 AM;ashashiv;image-20230414-011837.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/195997,18/May/23 9:18 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230518-111619.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/201350,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012608959,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,OP OSUUSKUNTA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1ablz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-04-10 14:17:07.832,,,,,07/Apr/23 1:25 AM;614dd566a995ad0073ec0622;Hold off on any work on this Jira at the moment as it seems they could be trying to delete a root folder called ‘ar’ instead of ‘ar’ under 'c'.,"07/Apr/23 6:41 PM;614dd566a995ad0073ec0622;Latest update. They are trying to delete an empty root folder such as shown in a blue circle in the screenshot. Is that allowed or possible?

!image-20230407-084023.png|width=1050,height=914!","11/Apr/23 12:17 AM;5b15d94b6256d01ad54eb020;Right, you cannot delete those folders. Moving response due  back to L2","11/Apr/23 9:11 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:614dd566a995ad0073ec0622] 

How did they get to this state of empty folders? 
Was that from a deletion of files/upgrade? 



Here is a fixpack that will attempt to delete this folder -

Fixpack: [https://ibm.box.com/s/6yezc13ivwb67tq9nwfynkin6eylix7t|https://ibm.box.com/s/6yezc13ivwb67tq9nwfynkin6eylix7t|smart-link]  

Checksum: [https://ibm.box.com/s/6nbg6cgs66l7o723jfar27a1w7fd2g6l|https://ibm.box.com/s/6nbg6cgs66l7o723jfar27a1w7fd2g6l|smart-link] 

If this doesnt clear the folder, can you get a support file from this environment.",11/Apr/23 6:22 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] I don’t know what happened. I will ask. will i hold off provideding fixpack till i get an answer. From some reason they seem quiet determined to remove the folder. Any reason why? ,11/Apr/23 8:45 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] They advised they deleted the contenst of the folder because they have a requirement to only keep C folder and remove other language folders? Should we gave them the fixpack?,11/Apr/23 9:23 PM;5af4ad7d4dd24c579110120b;You could send them the fixpack.,"13/Apr/23 7:24 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] Asha, fixpack didn’t work. I have asked for support file. ","14/Apr/23 10:57 AM;5af4ad7d4dd24c579110120b;[~accountid:614dd566a995ad0073ec0622] 

I checked the screenshot on ecurep that has been uploaded from the customer.

This fixpack was to delete ar folder not cs as in the screenshot.

!image-20230414-011837.png|width=1683,height=703!

Is their requirement to delete all folders apart from C? 
We don't reccomend doing that but if they do need I’ll have to change the fixpack based on what they need to delete.

I provided a fixpack to delete ar since we don't support the ar any more and was ok to be deleted.

In any case- this fixpack will be custom. so they cant apply the same fixpack to delete all files.
",14/Apr/23 8:22 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] Ok I will ask for a list of folders they want to delete. Then we will inform what can be deleted.,14/Apr/23 10:50 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] They would like a fixpack to remove all language folders except the 'C' folder?,"17/Apr/23 8:29 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:614dd566a995ad0073ec0622] 

Here is a fixpack  to delete all other folders except  C -

[https://ibm.box.com/s/qk3a84osfhbh6fu5zbg1mh2drsz1h1s3|https://ibm.box.com/s/qk3a84osfhbh6fu5zbg1mh2drsz1h1s3|smart-link]  

[https://ibm.box.com/s/4kf0gzj6619ki5g9ye5ohx4jscvcd4fr|https://ibm.box.com/s/4kf0gzj6619ki5g9ye5ohx4jscvcd4fr|smart-link] 

I have tested it and it works. 

If it doesn’t work you will need to get the support file and check the fixpack install log to see where it failed.",12/May/23 1:10 AM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] The fixpack is not working for one of their appliances. I looked at a system logs but could not discern any information. ,"12/May/23 10:20 AM;5af4ad7d4dd24c579110120b;Updated fixpack: 

[https://ibm.box.com/s/qk3a84osfhbh6fu5zbg1mh2drsz1h1s3|https://ibm.box.com/s/qk3a84osfhbh6fu5zbg1mh2drsz1h1s3|smart-link] 

[https://ibm.box.com/s/4kf0gzj6619ki5g9ye5ohx4jscvcd4fr|https://ibm.box.com/s/4kf0gzj6619ki5g9ye5ohx4jscvcd4fr|smart-link] ",12/May/23 8:28 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] Unfortunately fixpack did not work?,12/May/23 8:53 PM;5af4ad7d4dd24c579110120b;[~accountid:614dd566a995ad0073ec0622] have you checked the fixpack log why it didn’t work ,12/May/23 9:12 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] Would that be under /support/fixpack in a upto date support file?,"15/May/23 6:02 PM;614dd566a995ad0073ec0622;Hello,



I believe is below fixpack log from a support file I received today? Looks ok? [~accountid:5af4ad7d4dd24c579110120b] 



{noformat}clean_aactemplate_folder_all_1_ install successful
ck24260.pvrdPJ

source /tmp/mesa_install_fixpack24260.pvrdPJ/fixpack.info

FIXPACK_ID=CLEAN_AAC_TEMPLATE_FOLDER

FIXPACK_NAME=Clean_AAC_Template_Folder

FIXPACK_DESCRIPTION=This fixpack clears all folders in aac template files except C

FIXPACK_FIRMWARE_VERSION=*

ROLLBACK_DIR=/var/fixpacks

mkdir -p /var/fixpacks

mktemp -d /var/fixpacks/fixpack.XXXXXX

tmpdir=/var/fixpacks/fixpack.zDpwIH

set -e

[ -e /tmp/mesa_install_fixpack24260.pvrdPJ/pre_install.sh ]

true

STATUS=0

[ 0 -ne 0 ]

[ -f /tmp/mesa_install_fixpack24260.pvrdPJ/backup.lst ]

[ -s /tmp/mesa_install_fixpack24260.pvrdPJ/backup.lst ]

set -e

tar -cz -C / -T /tmp/mesa_install_fixpack24260.pvrdPJ/backup.lst -f /var/fixpacks/fixpack.zDpwIH/backup.tgz

STATUS=0

[ 0 -ne 0 -a  != 1 ]

[ -e /tmp/mesa_install_fixpack24260.pvrdPJ/remove.lst ]

read filename

[ -e /tmp/mesa_install_fixpack24260.pvrdPJ/manifest ]

true

[ -e /tmp/mesa_install_fixpack24260.pvrdPJ/norollback ]

true

[ -e /tmp/mesa_install_fixpack24260.pvrdPJ/pre_rollback.sh ]

true

[ -e /tmp/mesa_install_fixpack24260.pvrdPJ/post_rollback.sh ]

true

cp /tmp/mesa_install_fixpack24260.pvrdPJ/fixpack.info /var/fixpacks/fixpack.zDpwIH

set -e

[ -e /tmp/mesa_install_fixpack24260.pvrdPJ/rootfs.cgz ]

true

STATUS=0

[ 0 -ne 0 ]

set -e

[ -e /tmp/mesa_install_fixpack24260.pvrdPJ/post_install.sh ]

. /tmp/mesa_install_fixpack24260.pvrdPJ/post_install.sh /tmp/mesa_install_fixpack24260.pvrdPJ

list=ar cs de es fr hu it ja ko pl pt_BR ru zh_CN zh_TW

echo ar
ar

mkdir /root/deleteme1
mkdir: can't create directory '/root/deleteme1': File exists

true

STATUS=0

[ 0 -ne 0 ]

rm -rf /var/fixpacks/fixpack-9

[ -d /var/fixpacks/fixpack-8 ]

[ -d /var/fixpacks/fixpack-7 ]

[ -d /var/fixpacks/fixpack-6 ]

expr 6 + 1

mv /var/fixpacks/fixpack-6 /var/fixpacks/fixpack-7

[ -d /var/fixpacks/fixpack-5 ]

expr 5 + 1

mv /var/fixpacks/fixpack-5 /var/fixpacks/fixpack-6

[ -d /var/fixpacks/fixpack-4 ]

expr 4 + 1

mv /var/fixpacks/fixpack-4 /var/fixpacks/fixpack-5

[ -d /var/fixpacks/fixpack-3 ]

expr 3 + 1

mv /var/fixpacks/fixpack-3 /var/fixpacks/fixpack-4

[ -d /var/fixpacks/fixpack-2 ]

expr 2 + 1

mv /var/fixpacks/fixpack-2 /var/fixpacks/fixpack-3

[ -d /var/fixpacks/fixpack-1 ]

expr 1 + 1

mv /var/fixpacks/fixpack-1 /var/fixpacks/fixpack-2

[ -d /var/fixpacks/fixpack-0 ]

expr 0 + 1

mv /var/fixpacks/fixpack-0 /var/fixpacks/fixpack-1

mv /var/fixpacks/fixpack.zDpwIH /var/fixpacks/fixpack-0

RemoveTempFiles

[ 1 -eq 0 ]

rm -rf /tmp/install.sh24281.*

{noformat}","18/May/23 2:25 PM;5af4ad7d4dd24c579110120b;Here is a fixpack- 

This is specific to that not working appliance.

[https://ibm.box.com/s/gmk44sojp7xyrgop8lck8tt8yu1t6bll|https://ibm.box.com/s/gmk44sojp7xyrgop8lck8tt8yu1t6bll|smart-link]  ","18/May/23 9:19 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] 

Issue still there. Screenshot below. Log showed some errors as listed below. 





 

{noformat}[ -e /tmp/mesa_install_fixpack25202.zWyOJP/post_install.sh ]

. /tmp/mesa_install_fixpack25202.zWyOJP/post_install.sh /tmp/mesa_install_fixpack25202.zWyOJP

list=ar cs de es fr hu it ja ko pl pt_BR ru zh_CN zh_TW
/tmp/mesa_install_fixpack25202.zWyOJP/install.sh: /tmp/mesa_install_fixpack25202.zWyOJP/post_install.sh: line 333: syntax error: unexpected ""done"" (expecting ""fi"")

STATUS=2

[ 2 -ne 0 ]

ERRMSG=Unable to execute post_install script, restoring files and aborting installation

Restore

[ -f /var/fixpacks/fixpack.wXh2oT/backup.tgz ]

tar -zx -f /var/fixpacks/fixpack.wXh2oT/backup.tgz -C / --exclude dev/null

rm -rf /var/fixpacks/fixpack.wXh2oT

echo Unable to execute post_install script, restoring files and aborting installation
Unable to execute post_install script, restoring files and aborting installation

exit 2

RemoveTempFiles

[ 1 -eq 0 ]

rm -rf /tmp/install.sh25225.*

{noformat}

!image-20230518-111619.png|width=1530,height=1035!",29/May/23 8:32 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] Any update?,"30/May/23 10:01 AM;5af4ad7d4dd24c579110120b;[~accountid:614dd566a995ad0073ec0622] 

[https://ibm.box.com/s/qk3a84osfhbh6fu5zbg1mh2drsz1h1s3|https://ibm.box.com/s/qk3a84osfhbh6fu5zbg1mh2drsz1h1s3|smart-link]  

[https://ibm.box.com/s/4kf0gzj6619ki5g9ye5ohx4jscvcd4fr|https://ibm.box.com/s/4kf0gzj6619ki5g9ye5ohx4jscvcd4fr|smart-link] ","31/May/23 5:54 PM;614dd566a995ad0073ec0622;[~accountid:5af4ad7d4dd24c579110120b] Fixpack worked, Closing case.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Timezone data on appliance outdated,ISAMSUP-4953,292107,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,05/Apr/23 4:42 AM,03/May/23 6:26 AM,14/Jul/23 2:47 PM,03/May/23 6:26 AM,,Support,,0,,,,"Customer has appliance configured to UTC-600 Mexico City timezone and that timezone no longer changes time during daylight savings time. I confirmed in my lab that it still jumps forward.

Customer is at 10.0.1.0 (unconfirmed) but I recreated this at 10.0.3.1.

I’ll test at 10.0.5.0 as well.

What is the process to update the timezone definitions on the appliance?",,David Hayes,jcyarbor,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4943,,,,,,,,,,,,,,,,,,,IJ46451,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012634102,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,BANCO REGIONAL SA INST. DE BANCA MULTIPL BANREGIO,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a7zb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.0.1,ISVA 10.0.3.1,,,,,,,,,,,,2023-04-04 19:33:18.525,,,,,05/Apr/23 5:33 AM;5b15d94b6256d01ad54eb020;This is a duplicate  of [https://cloudidentity.atlassian.net/browse/ISAMSUP-4943|https://cloudidentity.atlassian.net/browse/ISAMSUP-4943|smart-link] ,"05/Apr/23 7:49 AM;5ac57757d9a96536d1f0daa9;[~accountid:5bac25aaabfcbf73d13e733b] can you please confirm that you agree that this item is a duplicate of the item that Bill has identified?

[~accountid:5b15d94b6256d01ad54eb020] have we answered the the being asked in this above in the other Jira item?","05/Apr/23 7:54 AM;5b15d94b6256d01ad54eb020;[~accountid:5ac57757d9a96536d1f0daa9] there is no doubt that this is the same as 4943. Motiur is working on that one.   It has not yet been resolved.   I added a comment to that work item, repeated here:

“Internal comment:

There are two parts to this. One is the tzdata  for the system but the other is  the Java jre which will use it’s own.”

[https://www.oracle.com/java/technologies/tzdata-versions.html|https://www.oracle.com/java/technologies/tzdata-versions.html|smart-link] 

We’ll want to be sure to address both parts.",05/Apr/23 7:57 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020] thank you for the update here. I will reassign this item to [~accountid:5b15d9e581c3df12acf53c4a] to close out both items together,"05/Apr/23 8:32 AM;5bac25aaabfcbf73d13e733b;[~accountid:5ac57757d9a96536d1f0daa9] ,

Yes, it is a duplicate, seems to be the same parent org but different organization. I’m not sure how I didn’t find the other. I’ll just follow that one as well.","19/Apr/23 2:41 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d9e581c3df12acf53c4a] ,

Now that the APAR is created and we know it’s going to be in 10.0.6.0 is there any resolution for my customer at 10.0.1.0. They stated they cannot upgrade.","19/Apr/23 3:30 AM;5b15d9e581c3df12acf53c4a;Hmmmm, Let me see we can create a possible fixpack or not………..","22/Apr/23 2:24 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15d9e581c3df12acf53c4a] ,

Following up on this one.

Are we going to be able to get a fixpack for 10.0.1.0?","25/Apr/23 1:12 AM;5b15d9e581c3df12acf53c4a;[~accountid:5bac25aaabfcbf73d13e733b] I was looking into creating a fixpack but that turning out to be a bit difficult as 10.0.1.0 is being very very old.

So, at this point, I just have to ask that it is fixed in next release and customer will have to upgrade to get the fix.","26/Apr/23 5:29 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d9e581c3df12acf53c4a] ,

As the customer cannot upgrade what is the correct workaround for this?","26/Apr/23 5:46 AM;5b15d9e581c3df12acf53c4a;Currently, only work around is to set the TZ to appropriate hours that correspond to their time zone now.",03/May/23 6:26 AM;5bac25aaabfcbf73d13e733b;Customer has closed the case.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 Issue with docker manifest for isva,ISAMSUP-4951,292080,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Cesar Mendoza,62fd292b88b05653fa7d4647,Cesar Mendoza,62fd292b88b05653fa7d4647,05/Apr/23 1:53 AM,15/Apr/23 12:46 AM,14/Jul/23 2:47 PM,15/Apr/23 12:46 AM,,,,0,,,,"Customer is trying to pull from IBM repo [icr.io|https://icr.io/] but are unable to pull the image from [icr.io|https://icr.io/] as it is using manifest v2 schema 1 which is deprecated. [https://docs.docker.com/registry/spec/deprecated-schema-v1/|https://docs.docker.com/registry/spec/deprecated-schema-v1/|smart-link] 

we already mentioned that *docker pull* [*icr.io/isva/verify-access:10.0.5.0*|http://icr.io/isva/verify-access:10.0.5.0] works



Also, we recommended them checking [https://docs.verify.ibm.com/ibm-security-verify-access/docs/containers#configuration-container|https://docs.verify.ibm.com/ibm-security-verify-access/docs/containers#configuration-container|smart-link] 



Which says that IBM will no longer host IBM Security Verify containers on Docker Hub after December 31st, 2022. All containers should be sourced from the IBM Container registry links.

But issue still persists.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012601876,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Cesar Mendoza,62fd292b88b05653fa7d4647,,,,KEYBANK NATIONAL ASSOCIATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a7tb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-04 17:18:43.292,,,,,"05/Apr/23 3:18 AM;5b15d94b6256d01ad54eb020;We’re not using schema 1  so what I think they are seeing is probably the same as this:

[https://stackoverflow.com/questions/61355620/jfrog-artifactory-error-pushing-docker-images-with-manifest-v2-schema-1-to-this|https://stackoverflow.com/questions/61355620/jfrog-artifactory-error-pushing-docker-images-with-manifest-v2-schema-1-to-this|smart-link] ","05/Apr/23 3:21 AM;62fd292b88b05653fa7d4647;[~accountid:5b15d94b6256d01ad54eb020] Thanks, should I provide that to the customer and advise we are not using schema 1?",05/Apr/23 3:23 AM;5b15d94b6256d01ad54eb020;You can.  It might be a good idea to do a few more internet searches to see if you can find other explanations for the error that might help.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Continuously increasing memory,ISAMSUP-4949,292019,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,04/Apr/23 8:33 PM,06/Jul/23 1:07 PM,14/Jul/23 2:47 PM,,,,,0,Growth,,,"Since ISVA 10.0.5 firmware upgrade, Customer recognized that the memory usage is increasing continuously. When they restart the cluster runtime, then the memory usage drops back to around 30% on the active appliance. With 10.0.4 they did not face this issue.

After checking, which processes are using the most memory based on the top_memory command. Results are the following:



vaf210p002b.wob.sec.vw.vwg:diagnostics> monitor top_memory
+ /usr/bin/top -b -n1 -m
Mem total:16401072 anon:12008616 map:135552 free:2410960
slab:200684 buf:247456 cache:1417156 dirty:288 write:0
Swap total:2057212 free:2032480
PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
7522 14.8g 8262m 7357m 72300 7277m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx8192m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.a
21350 6927m 4585m 4283m 68740 4211m     4   128 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Djava.security.properties=/opt/IBM/wlp/usr/servers/default/java.security -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -



Customer shared created 2 supports files before the runtime restart and 1 after the cluster runtime restart.



[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012597010&path=TS012597010%2F2023-03-30%2F&filepath=TS012597010%2F2023-03-30%2Fisva_10.0.5.0_20230330-125549_vaf210p002b.wob.sec.vw.vwg.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012597010&path=TS012597010%2F2023-03-30%2F&filepath=TS012597010%2F2023-03-30%2Fisva_10.0.5.0_20230330-125549_vaf210p002b.wob.sec.vw.vwg.support]",,BRIANORO,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,6154906364ff01007106e189,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5130,,04/Apr/23 8:37 PM;ug:0d611a25-0ff2-486d-afc9-64342bb96b9c;Screenshot 2023-04-04 at 10.47.59.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/194112,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012597010,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,Volkswagen AG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a7en:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-04 21:43:33.026,,,,,"04/Apr/23 8:37 PM;627a7fb30d1e73006f7c21cf;!Screenshot 2023-04-04 at 10.47.59.png|width=1747,height=128!

On the cpu.txt it shows
94.3 memory consumption on:

{noformat}/opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx8192m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.auth{noformat}

and when I checked the Core_java file size is 6 GB",05/Apr/23 7:43 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9517dab4c51f61b5190] adding this item to your backlog for assessment. We are tracking a couple of other items where customer are seeing potential memory leaks so appreciate a quick review of this over the next couple of days.,18/Apr/23 11:13 PM;5b232b2fd85e5b59b066f57f;@phorner - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"19/Apr/23 5:45 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d9517dab4c51f61b5190]

The customer is asking for an update on this issue.","19/Apr/23 6:12 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d9517dab4c51f61b5190] 

The customer requests an update on this issue.","19/Apr/23 8:46 PM;5b15d9517dab4c51f61b5190;The runtime is configured with an upper limit of 8GB of heap (The -Xmx8192m argument)

So it will grow until it reaches the limit

The RSS size is only 7357m indicating is hasn’t got there yet

If you dont want it to use so much memory - reduce the limit","10/May/23 9:00 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d9517dab4c51f61b5190] 

Customer is asking on the some questions on heap size:
What is our recommendation, what value should they set the upper limit of heap size to?
What is the advantages, if they set to a lower value the maximum heap size?","18/May/23 12:57 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

Customer is asking on the some questions on heap size:
What is our recommendation, what value should they set the upper limit of heap size to?
What is the advantages, if they set to a lower value the maximum heap size?","22/May/23 10:23 AM;5b232b2fd85e5b59b066f57f;[~accountid:627a7fb30d1e73006f7c21cf] - I have been working on another issue which may have some relationship to this one - [https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|smart-link] . We have identified a leak in the Java JVM that ships with 10.0.5 which seems to impact EC crypto operations. To rule this in / out for this customer, can you review the customer’s support files and check whether they have any EC crypto occurring? ","06/Jun/23 7:18 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] 

Customer confirmed that they are using the Elliptic-curve Ciphers.",15/Jun/23 11:56 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] any update on this please.,16/Jun/23 10:41 PM;5ac57757d9a96536d1f0daa9;[~accountid:627a7fb30d1e73006f7c21cf] Dave is currently our on leave and returning Tuesday next week. Can you please review the details in [https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|https://cloudidentity.atlassian.net/browse/ISAMSUP-5062|smart-link] and confirm if you agree what has been advised may also assist with our customer here. ,26/Jun/23 9:15 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b232b2fd85e5b59b066f57f] As customer confirmed that they are using Elliptic-curve Ciphers. Do we any fixpack to be provided on V10.0.5.0?,27/Jun/23 4:04 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] quick check on this item to confirm if we can provide the fix the Java fix to this customer? ,28/Jun/23 1:03 PM;5b232b2fd85e5b59b066f57f;[~accountid:627a7fb30d1e73006f7c21cf] - can you please have customer apply [https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|smart-link] and see if there is any improvement? ,03/Jul/23 9:35 AM;5ac57757d9a96536d1f0daa9;[~accountid:627a7fb30d1e73006f7c21cf] just a quick reminder to please update the customer with Dave's below recommendation. Appreciate the support. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Customer receiving Garbage Collection alerts frequently,ISAMSUP-4947,291976,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,04/Apr/23 3:26 PM,27/Jun/23 7:09 PM,14/Jul/23 2:47 PM,27/Jun/23 7:09 PM,10.0.7,Support,,0,,,,"Hi team, 

# I have a customer where he gets garbage collection alerts frequently which gets resolved after the runtime restarts. I have requested the heap dumps and found a possible leak suspect after analysing it - The class *com.tivoli.am.fim.fedmgr2.page.USCPageHelper* occupies *5,500,622,744 (84.25%)* bytes. The memory is accumulated in one instance of *java.util.HashMap$Node[]* which occupies *5,500,622,568 (84.25%)* bytes.

Requesting your insight into this.

2. The customer is on 10.0.2 version and on reading the fix pack details for 10.0.2 IF 1 - it mentions about fixing memory leaks - I have already recommended the customer for it. Do you think this would resolve the issue?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4989,,,,,,,,,,,,,,,,,,,,,IJ47347,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011844672,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,ABU DHABI ISLAMIC BANK NEAR CENTRAL BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-06-21T18:58:24.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a76f:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-04-04 06:32:06.983,,,,,04/Apr/23 4:32 PM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please take the initial look at this Jira item for us? ,"04/Apr/23 10:50 PM;5af4ad7d4dd24c579110120b;<Notes>

[https://ecurep.mainz.de.ibm.com:444/rest/download/TS011844672/2023-04-03/heapdump.20230116.102314.1782.0004_Leak_Suspects.zip_unpack/pages/19.html|https://ecurep.mainz.de.ibm.com:444/rest/download/TS011844672/2023-04-03/heapdump.20230116.102314.1782.0004_Leak_Suspects.zip_unpack/pages/19.html]

{noformat}
java.util.HashMap$Node[16777216] @ 0x7ad6a2fa0
67,108,872	5,500,622,568
\
java.util.HashMap @ 0x64263f610
40	5,500,622,608
.\
java.util.Collections$SynchronizedMap @ 0x642637fe8
32	5,500,622,640
..\
class com.tivoli.am.fim.fedmgr2.page.USCPageHelper @ 0x641f33bd0 System Class
80	5,500,622,744
{noformat}","05/Apr/23 12:11 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:62d0e51aec233f24684a5d3a] 

Upgrade date for 10020 from the support file shows -    2022-06-03.

Have a few questions here - 

* Is this alert for GC  from Dynatrace? 
* Is this issue with GC heap recent after any changes or have they been getting this since 10020 upgrade or before ?
* Have they seen any other performance issues with the flow/ISVA apart from these alerts? 
* Is there a specific flow that they use like Infomap/authorize code flow etc to get these alerts?
* Is this their prod or lower environments? ","05/Apr/23 1:49 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

Please find the response below -

* Is this alert for GC from Dynatrace? → Customer is using ISAM verify Dynatrace extension agent.
* Is this issue with GC heap recent after any changes or have they been getting this since 10020 upgrade or before ? → no configuration and tuning changes in the system.

Sent over your queries to the customer , waiting their response. Will update you.","05/Apr/23 5:38 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

Please find the response below - 

* Is this issue with GC heap recent after any changes or you have been getting this since 10020 upgrade or before ?

*I can not surely tell you that ,but we have observability for this error after monitoring our appliances with Dynatrace .*

* Have you seen any other performance issues with the flow/ISVA apart from these alerts?

*we have found slow response when we have received that error.*

*  Is there a specific flow that you use like Infomap/authorize code flow etc when you get these alerts?

*We are using Infomap flows for authentication and registration flow.*

* Is this your prod or lower environment?

*This is our production environment.*

Thanks

Varun","10/Apr/23 5:53 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] 

Any updates on this?

Thanks","13/Apr/23 4:01 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

Any updates on this one?

Thanks","18/Apr/23 4:43 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] , Any updates on this. Customer is asking for updates.

Also can you please confirm → The customer is on 10.0.2 version and on reading the fix pack details for 10.0.2 IF 1 - it mentions about fixing memory leaks - I have already recommended the customer for it. Do you think this would resolve the issue?

Thanks","18/Apr/23 5:10 PM;62d0e51aec233f24684a5d3a;Got an Update from the customer → They have applied the 10.0.2 IF 1 already but no luck.

Its been very long since this case is opened , can we have an update on this please.",18/Apr/23 11:13 PM;5b232b2fd85e5b59b066f57f;@ashashiv - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"19/Apr/23 3:05 PM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}private static Map _pageIdToMacrosMap = Collections.synchronizedMap(new LinkedHashMap<String, HashMap>() {


        private static final int MAX_ENTRIES = 32;

        protected boolean removeEldestEntry(Map.Entry eldest) {
            boolean result = false;
            if (size() > MAX_ENTRIES) {
                result = true;
            }
            return result;
        }
 });{noformat}","19/Apr/23 3:06 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:62d0e51aec233f24684a5d3a] 

Here is a fixpack -

 [https://cloudidentity.atlassian.net/browse/ISAMSUP-4989|https://cloudidentity.atlassian.net/browse/ISAMSUP-4989|smart-link] 

Test it on a lower environment and validate before promoting to production.","01/Jun/23 8:28 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:62d0e51aec233f24684a5d3a] 

Any updates about the fixpack?","12/Jun/23 1:12 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:62d0e51aec233f24684a5d3a] 

Any update on the fixpack? Can you also log an APAR for this.

Thanks","12/Jun/23 2:17 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

I had shared the fixpack with the customer. I have sent a follow up and waiting for their response will keep you posted. Thanks for helping out.","13/Jun/23 3:16 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: d9a27ca9df5a95c7777e2fc04d63e4bb12f84120
   * description: ISAMSUP-4947 Synchronized map heap leak

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1262441.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4947) which we publish.","16/Jun/23 9:56 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:62d0e51aec233f24684a5d3a] 

Please create an APAR for this.","19/Jun/23 2:24 PM;62d0e51aec233f24684a5d3a;Hi Asha, Sure . Can you share me the link where I need to raise an APAR.

Thanks","20/Jun/23 4:44 PM;5af4ad7d4dd24c579110120b; [~accountid:62d0e51aec233f24684a5d3a] 

Here is the link - 

[https://kirk-front.csptools.cloud.ibm.com/|https://kirk-front.csptools.cloud.ibm.com/|smart-link] ","21/Jun/23 6:58 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ec533ef728510d4a71429cdd5b55537ef73d7c3e
   * description: Merge pull request #5984 from ISAM/ISAMSUP-4947

ISAMSUP-4947 Synchronized map heap leak

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1581745.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230621085532-ec533ef7.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","21/Jun/23 7:18 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ec533ef728510d4a71429cdd5b55537ef73d7c3e
   * description: Merge pull request #5984 from ISAM/ISAMSUP-4947

ISAMSUP-4947 Synchronized map heap leak

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1582577.


This build has not been published as the commit is not currently within a branch (20230621075717-ea945d3c) which we publish.","21/Jun/23 8:19 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ec533ef728510d4a71429cdd5b55537ef73d7c3e
   * description: Merge pull request #5984 from ISAM/ISAMSUP-4947

ISAMSUP-4947 Synchronized map heap leak

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1584930.


This build has not been published as the commit is not currently within a branch (20230621085532-ec533ef7) which we publish.","27/Jun/23 6:41 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5af4ad7d4dd24c579110120b] , I have created an APAR - IJ47347. Thanks.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
WebSEAL - WAF CRS issue,ISAMSUP-4945,291799,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,04/Apr/23 12:18 AM,17/Apr/23 9:17 PM,14/Jul/23 2:47 PM,17/Apr/23 9:17 PM,10.0.6,Support,,0,WAF,,,"Hi Team,

Customer rule says if the query string in the URI has 'mod_security_test' and there are no cookies, block

{noformat}
SecRule ARGS ""mod_security_test"" \
  ""id:99999,\
  t:normalisePathWin,\
  deny,\
  status:403,\
  log,\
  chain,\
  msg:'Test Attack'""
  SecRule &REQUEST_COOKIES ""@eq 0"" \
    ""t:lowercase""

Sent a request with mod_security_test BUT with cookies: https://192.168.2.132:444/l/?test=mod_security_test
included JSESSIONID, PD-S-SESSION, and LtpaToken2 but was blocked.

Tested a rule that does not include the chained check for COOKIES and that worked as expected. Also just did a single SecRule that
did the cookies check and it worked as expected. Also reversed the chain rule to check cookies first then chained the ARGS check 
but it did not worked as expected.

Issue seems to be with chained rules that check &REQUEST_COOKIES. This should work per:

https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v3.x%29#user-content-REQUEST_COOKIES

Customer verified this works in NGINX which uses the same version of the ModSecurity package. {noformat}



Attaching you the screenshot of testing in our local appliance and also the logs from the customer,

!Screenshot 2023-04-03 at 15.15.34.png|width=1912,height=688!

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012540697&path=TS012540697%2F2023-03-24%2Fisva_10.0.5.0_20230324-150225_smbmtr211.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fcpndealnet%2Flog%2F&filepath=TS012540697%2F2023-03-24%2Fisva_10.0.5.0_20230324-150225_smbmtr211.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fcpndealnet%2Flog%2Fwaf_debug.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012540697&path=TS012540697%2F2023-03-24%2Fisva_10.0.5.0_20230324-150225_smbmtr211.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fcpndealnet%2Flog%2F&filepath=TS012540697%2F2023-03-24%2Fisva_10.0.5.0_20230324-150225_smbmtr211.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fcpndealnet%2Flog%2Fwaf_debug.log]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012540697&path=TS012540697%2F2023-03-24%2Fisva_10.0.5.0_20230324-150225_smbmtr211.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fcpndealnet%2Flog%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012540697&path=TS012540697%2F2023-03-24%2Fisva_10.0.5.0_20230324-150225_smbmtr211.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fcpndealnet%2Flog%2F]",,Asha Shivalingaiah,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,Tushar Prasad,Virag Patel,,,,,,,,5af4ad7d4dd24c579110120b,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4959,,04/Apr/23 12:18 AM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-04-03 at 15.15.34.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193880,,,,,,,,,,,,,,, IJ46306,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012540697,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,SKODA AUTO A.S.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-04-12T18:14:02.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS012540697&path=TS012540697%2F2023-03-24%2Fisva_10.0.5.0_20230324-150225_smbmtr211.fw.skoda.vwg.support_unpack%2F

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012540697&path=TS012540697%2F2023-03-24%2Fisva_10.0.5.0_20230324-150225_smbmtr211.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fcpndealnet%2Flog%2F&filepath=TS012540697%2F2023-03-24%2Fisva_10.0.5.0_20230324-150225_smbmtr211.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fcpndealnet%2Flog%2Fwaf_debug.log",,,,,,,,,AIX,Linux ppc64,,,,,,,,,,,,,0|i1a65b:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-04 02:35:22.491,,,,,"04/Apr/23 12:35 PM;5b15d9517dab4c51f61b5190;Please open an APAR “WAF rules accessing request cookies don't work as expected”

The reverse proxy is not passing on the request cookies to modsecurity

So requests are always evaluated as if they contain no request cookies.

This affects all rules not just chaining of rules

IBM Internal only

To modsecurity - cookies are just another header

Internally we handle cookies separately to all other request headers

We are not currently passing any cookies to  modsecurity",06/Apr/23 1:38 AM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9517dab4c51f61b5190] Apar created IJ46306,"06/Apr/23 11:08 AM;5b15d9517dab4c51f61b5190;[~accountid:60f541a6d0134900692d91b7] 

The issue affects response cookies as well

Response rules are being evaluated as if they contain no “Set-Cookie” Headers

Response cookie handling by modsecurity will also  be fixed as part of IJ46306","06/Apr/23 11:24 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 3f3536785daba16cbe15a3541d9ac839f4d356b8
   * description: ISAMSUP-4945 IJ46306 WAF rules accessing cookies don't work as expected

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/77908.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4945) which we publish.","06/Apr/23 5:30 PM;5b15d9517dab4c51f61b5190;The fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4959|https://cloudidentity.atlassian.net/browse/ISAMSUP-4959|smart-link] 

It requires 10.0.5.0 IF1 is already installed",07/Apr/23 7:16 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9517dab4c51f61b5190] The customer asks the fix is only for testing or if it can eventually be deployed in production?,08/Apr/23 8:27 AM;5b15d9517dab4c51f61b5190;yes fixpack is fully supported and can be deployed in production,"12/Apr/23 5:14 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: adf47525b7a28f6735cbeb1f384cda81ddd95d37
   * description: Merge pull request #5815 from ISAM/ISAMSUP-4945

ISAMSUP-4945 IJ46306 WAF rules accessing cookies don't work as expected

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/89816.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230412071101-adf47525.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","12/Apr/23 6:03 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: adf47525b7a28f6735cbeb1f384cda81ddd95d37
   * description: Merge pull request #5815 from ISAM/ISAMSUP-4945

ISAMSUP-4945 IJ46306 WAF rules accessing cookies don't work as expected

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/89898.


This build has not been published as the commit is not currently within a branch (20230412064445-ea1b755b) which we publish.","12/Apr/23 6:30 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: adf47525b7a28f6735cbeb1f384cda81ddd95d37
   * description: Merge pull request #5815 from ISAM/ISAMSUP-4945

ISAMSUP-4945 IJ46306 WAF rules accessing cookies don't work as expected

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/89946.


This build has not been published as the commit is not currently within a branch (20230412071101-adf47525) which we publish.","14/Apr/23 10:53 AM;5b15d9517dab4c51f61b5190;[~accountid:60f541a6d0134900692d91b7] 

FYI There is another modsecurity issue  - about rule file load order IJ46400

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4963|https://cloudidentity.atlassian.net/browse/ISAMSUP-4963|smart-link] 

I will be building another fixpack to include both issues",17/Apr/23 9:17 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9517dab4c51f61b5190] Thank you very much for the fixpack client is happy to close this case,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Discrepancy in MD5 value for 10.0.5-ISS-ISVA-FP0001,ISAMSUP-4942,291773,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,03/Apr/23 7:17 PM,04/Apr/23 3:49 PM,14/Jul/23 2:47 PM,04/Apr/23 3:49 PM,,Support Release,,0,,,,"Customer raised an issue stating that 10.0.5-ISS-ISVA-FP0001 MD5 value is different from IBM provided. 

On checking it seems to be the case that the MD5 values are actually different. Requesting you to please check on this.

Multiple cases with same issue - TS012624187 , TS012622192.",,Surya Prakash,,,,,,,,,,,,,,,60f541a6d0134900692d91b7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS012622192, TS012624187",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,DEPARTMENT OF HOME AFFAIRS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a5zj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-03 21:22:45.876,,,,,"03/Apr/23 7:18 PM;62d0e51aec233f24684a5d3a;the MD5 value we got is 72e7320bba7db1c77921d4731003e45e, 

the MD5 value IBM provided is 8a6d0ba8c193d6a7d20ba4118a889617","04/Apr/23 7:22 AM;5af4ad7d4dd24c579110120b;[~accountid:62d0e51aec233f24684a5d3a] 

Updated md5 now. Should be fixed.",04/Apr/23 3:27 PM;62d0e51aec233f24684a5d3a;Thanks [~accountid:5af4ad7d4dd24c579110120b] for the updates. I have cascaded the same to the customer. We are good to close this.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
QA about settings for communicating with CloudWatchLogs when ISVA is configured in a private subnet.,ISAMSUP-4938,291679,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Mitsukazu Nakai,5bb6a576c39135735a7db132,Mitsukazu Nakai,5bb6a576c39135735a7db132,31/Mar/23 11:39 PM,26/Apr/23 9:15 AM,14/Jul/23 2:47 PM,26/Apr/23 9:15 AM,,,,0,,,,"The customer wants to install IBM Security Verify Access Extension for Amazon CloudWatch Agent on ISVA10.0.5 (Legacy) on AWS and communicate with CloudWatchLogs.
ElasticIP is not assigned to ISVA, and it is configured in a private subnet.

If the route is as follows, what kind of settings are required for ISVA or Extension?
(a) Via Internet: Set to pass through a proxy.
(b) Via VPC endpoint: Set the VPC endpoint for CloudWatch.

He would like to confirm how to set it on the ISVA side or if it is not supported.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012568432,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Mitsukazu Nakai,5bb6a576c39135735a7db132,,,,TOTO INFOM LTD.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a5ev:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-03 02:08:21.865,,,,,"03/Apr/23 12:08 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bb6a576c39135735a7db132] 

The configuration using Proxy or VPC endpoint are outside of what has been tested with cloud watch. 
The configuration that is available to edit are under - the auxiliary files - amazon-cloud-watch.json 

{noformat}""agent"":{
    ""metrics_collection_interval"": 90,
    ""region"":""us-west-1"",
    ""debug"":false,
},{noformat}

Installing an extension and modifying this json file is what is allowed and exposed in/on ISVA.
There is nothing else that I see from the extension side that can be changed.



If the 2 options that you mentioned are used on a different environment was there any specific steps to be performed, I could check if that is applicable in ISVA? 
Has the customer tried one of the options and are facing any issues/are the logs not been exported? ","03/Apr/23 5:14 PM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for your answer.

I will report your answer to the customer.
Thank you.

Regards,
Mitsukazu Nakai","18/Apr/23 3:19 AM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for your support.

Could you please answer the additional question?

There are the following setting items in ""System"" -> ""System Settings: Administrator Settings"" in the LMI menu of ISVA.

* HTTP proxy
* HTTPS proxy

If we set this proxy, will the CloudWatch agent also communicate via the set proxy when sending metrics collection information?

Regards,
Mitsukazu Nakai","18/Apr/23 11:05 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bb6a576c39135735a7db132] 

In theory if the  interface is set to communicate on the HttpProxy , cloud watch should use the same config and send logs. 

However - Since these are custom use cases this has not been tested.

Customer can set the proxy and test it. ","18/Apr/23 10:02 PM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for your answer.

I will report your answer to the customer.
Thank you.

Regards,
Mitsukazu Nakai","25/Apr/23 6:19 PM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for your support.

Since the customer has agreed to close the SF case, would you please close this Jira item as well?
Thank you very much!

Regards,
Mitsukazu Nakai",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISO certification for ISVA,ISAMSUP-4937,291678,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,,,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,31/Mar/23 11:38 PM,31/Mar/23 11:39 PM,14/Jul/23 2:47 PM,31/Mar/23 11:39 PM,,Support,,0,,,,"Hello Team,

The customer is seeking ISO certification for our tools.  

They said “I know that IBM Cloud are ISO 22301 certified, and have that certificate. I have been asked to find out asap if ISV is covered under that certification or has it's own certification to ISO 22301. I believe it will be covered by the IBM Cloud one, but need to be able to say IBM have confirmed this.”",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012608122,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,CLYDESDALE BANK PLC (TRADING AS VIRGIN MONEY),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a5en:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Import of signer Certificate via rest api as string as a opposed to file,ISAMSUP-4934,291433,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,30/Mar/23 8:51 PM,13/Jun/23 5:20 PM,14/Jul/23 2:47 PM,,,,,0,,,,"Hello,



According to below documentation it states it should be possible to import a signer cert as a string as opposed to a file as illustrated in request body in screenshot. this is the customer believed. After testing it can only be done by form data. We even tried to send cert as string in bash variable  but that didn’t work. Do you you concur? Will I create a apar? 



[https://www.ibm.com/docs/en/sva/10.0.5?topic=developing-rest-api-documentation|https://www.ibm.com/docs/en/sva/10.0.5?topic=developing-rest-api-documentation|smart-link] 



!image-20230330-104345.png|width=880,height=227!",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,,,,,,,,,,,,,,,,,,,,,,,,,,,,,30/Mar/23 8:51 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230330-104345.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193418,,,,,,,,,,,,,,,IJ46354,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012303025,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,PFA PENSION EDB-AFDELINGEN,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a3z3:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-03-30 15:54:06.629,,,,,"31/Mar/23 1:54 AM;5b15d94b6256d01ad54eb020;No I don’t concur, you haven’t provided enough information.

Did you try it?   You should provide  an example of the command you used. Most likely a syntax error on the command.    

What error did you get from the REST command?

Do you have a support file?","31/Mar/23 2:59 AM;5b15d9e6dda5f94d06b985b4;[~accountid:5b15d94b6256d01ad54eb020] We used [https://github.com/IBM-Security/isam-support/blob/master/appliance/restapi/Manage-SystemSettings/Secure-Settings/SSL-Certificates/Signer-Certificates/Importing-a-signer-certificate-into-a-certificate-database.sh|https://github.com/IBM-Security/isam-support/blob/master/appliance/restapi/Manage-SystemSettings/Secure-Settings/SSL-Certificates/Signer-Certificates/Importing-a-signer-certificate-into-a-certificate-database.sh|smart-link]  as a base.  The script works fine when using --form cert=@ca.pem.

When try with --form cert=”cert_as_string” it keeps failing.

Tried different permutations.

We tried passing the strings as:

{noformat}-----BEGIN CERTIFICATE-----
MIIE..
-----END CERTIFICATE-----{noformat}

or

{noformat}MIIEnDCCA4SgAw….{noformat}

We noticed when browser debugging LMI it sends “Content-Type: application/x-x509-ca-cert” but that did not work for us either.

We also noticed the LMI call is somewhat different.  Note:

POST [https://isva1020.kvm.org:9447/isam/ssl_certificates/BB/signer_cert.js?browserCalled=true|https://isva1020.kvm.org:9447/isam/ssl_certificates/BB/signer_cert.js?browserCalled=true]

The browserCalled I get, but note:

signer_cert.js
vs
signer_cert



Is the doc wrong?  Is this even possible with direct RAPI?

This is failure using the RAPI as documented:


{noformat}+ curl -v -s -k -u admin:secret -H 'Accept: application/json' -X POST https://isva1020.kvm.org:9447/isam/ssl_certificates/BB/signer_cert --form 'cert=-----BEGIN CERTIFICATE-----
MIIEnDCCA4SgAwIBAgIUFVtu3YKxGkRZydwtl1h9pDbsaXIwDQYJKoZIhvcNAQEL
BQAwgYgxFTATBgNVBAMTDElTQU1ET0NLRVJDQTELMAkGA1UEBhMCVVMxCzAJBgNV
BAgTAlRYMQ8wDQYDVQQHEwZBdXN0aW4xDDAKBgNVBAoTA0lCTTE2MDQGCSqGSIb3
DQEJARYnbmxsb3lkQGlzYW1kb2NrZXIudGl2bGFiLmF1c3Rpbi5pYm0uY29tMB4X
DTE5MDcxNDAxNTE1NFoXDTM5MDcwODAxNTE1NFowgYgxFTATBgNVBAMTDElTQU1E
T0NLRVJDQTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAlRYMQ8wDQYDVQQHEwZBdXN0
aW4xDDAKBgNVBAoTA0lCTTE2MDQGCSqGSIb3DQEJARYnbmxsb3lkQGlzYW1kb2Nr
ZXIudGl2bGFiLmF1c3Rpbi5pYm0uY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAxoJ/XOlS1UByeZtMp423OCFERhAgwt2dAMmNcpUpjhDRYVOW5Sjd
VqHWLadxMrpoBNwPmZ3gxuqexbR9R9pQSpMyv9+IQerArIG/7M/nEaXr3pouWwvu
EZ4OqtHpbyl8mAkxSfFp3M0J7yPnSCDNWXvAEQim4bgje4EcD2vSGqDagg/jL+Ny
Zq7aVWsKIFhhDeywOt3/obMYXK0z0teBb/QtNr3VqF5jBdqSFUxe5MKUUYUF3RtZ
lbhGFG0NdPP7eAsKF+sxDtyWAFx3EDwznei4Sd2H3eU8xtaYNUuQK0alZjIknYoy
O72SdY7ZchHUAmyLKilqV8ACDA46ZndyEQIDAQABo4H7MIH4MB0GA1UdDgQWBBQO
g0Kc1gaSyxXLtuaoD9ETAwjKZzCByAYDVR0jBIHAMIG9gBQOg0Kc1gaSyxXLtuao
D9ETAwjKZ6GBjqSBizCBiDEVMBMGA1UEAxMMSVNBTURPQ0tFUkNBMQswCQYDVQQG
EwJVUzELMAkGA1UECBMCVFgxDzANBgNVBAcTBkF1c3RpbjEMMAoGA1UEChMDSUJN
MTYwNAYJKoZIhvcNAQkBFidubGxveWRAaXNhbWRvY2tlci50aXZsYWIuYXVzdGlu
LmlibS5jb22CFBVbbt2CsRpEWcncLZdYfaQ27GlyMAwGA1UdEwQFMAMBAf8wDQYJ
KoZIhvcNAQELBQADggEBAHuhyy3X3+wfCGM8SbL62jE9/vsM+dQ0ilWoxDCBxue7
YIHk0UMQ1yBI9LOkILxHFH+BDXgUaG6z5JgylUKBzICaqFa5CQwUKLQ0M9jhgYLL
6oKnVM6EoWoBT3/fGGow8oJqdBh+GkJYeizRg8eleGYR4G9BvdgLDJJFYre6HfQP
aYL/1fW5d0u6GkwEwk7f9ByE5oMEGr8ebPv6PvP1oEe4PsJw3S5rQjHJ86qJkN2b
DEbYxUU1RjNYS5EAyXtvKBQz/wtMsb+R/oc3MRzs3aiSZS9yfv38ylqayyQt/JPh
tGrvGjYQ471V9dcZ/cm1Sx/5ySkIRtmyTnzcXIBmNos=
-----END CERTIFICATE-----' --form label=CA --form preserve_label=true
*   Trying 9.48.172.17...
* TCP_NODELAY set
* Connected to isva1020.kvm.org (9.48.172.17) port 9447 (#0)
* ALPN, offering h2
* ALPN, offering http/1.1
* successfully set certificate verify locations:
*   CAfile: /etc/pki/tls/certs/ca-bundle.crt
  CApath: none
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
* TLSv1.3 (IN), TLS handshake, Server hello (2):
* TLSv1.2 (IN), TLS handshake, Certificate (11):
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
* TLSv1.2 (IN), TLS handshake, Server finished (14):
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
* TLSv1.2 (OUT), TLS handshake, Finished (20):
* TLSv1.2 (IN), TLS handshake, Finished (20):
* SSL connection using TLSv1.2 / ECDHE-RSA-AES256-GCM-SHA384
* ALPN, server did not agree to a protocol
* Server certificate:
*  subject: C=US; ST=TX; O=IBM; CN=*.kvm.org; emailAddress=admin@kvm.org
*  start date: Nov 10 19:14:46 2021 GMT
*  expire date: Nov  8 19:14:46 2031 GMT
*  issuer: CN=ISAMDOCKERCA; C=US; ST=TX; L=Austin; O=IBM; emailAddress=nlloyd@isamdocker.tivlab.austin.ibm.com
*  SSL certificate verify result: unable to get local issuer certificate (20), continuing anyway.
* Server auth using Basic with user 'admin'
> POST /isam/ssl_certificates/BB/signer_cert HTTP/1.1
> Host: isva1020.kvm.org:9447
> Authorization: Basic YWRtaW46YmlnaHVsazk5
> User-Agent: curl/7.61.1
> Accept: application/json
> Content-Length: 2000
> Content-Type: multipart/form-data; boundary=------------------------152eb5fc86c81dc2
> Expect: 100-continue
>
< HTTP/1.1 100 Continue
< Content-Length: 0
< Date: Thu, 30 Mar 2023 16:56:49 GMT
< HTTP/1.1 400 Bad Request
< Date: Thu, 30 Mar 2023 16:56:49 GMT
< X-FRAME-OPTIONS: SAMEORIGIN
< Cache-Control: no-cache, no-store
< Content-Security-Policy: default-src 'self' 'unsafe-inline' 'unsafe-eval'
< X-Content-Type-Options: nosniff
< X-XSS-Protection: 1; mode=block
< Pragma: no-cache
< Content-Type: application/json
< Content-Language: en-US
< Strict-Transport-Security: max-age=31536000; includeSubDomains
< Content-Length: 107
< Set-Cookie: LtpaToken2=...
< Set-Cookie: JSESSIONID=0000MLD2yx-WwAz2HUGHxvcy23C:13b72ae9-386d-4163-948c-e7a4f2c8257a; Path=/; Secure; HttpOnly
< Connection: Close
< Expires: Thu, 01 Dec 1994 16:00:00 GMT
<
* Closing connection 0
* TLSv1.2 (OUT), TLS alert, close notify (256):
{""message"":""The request does not contain the file to import. Check that your parameters are correct. file""}{noformat}","31/Mar/23 3:30 AM;5b15d94b6256d01ad54eb020;Thanks Nick,  I’ll look into it.","31/Mar/23 4:35 AM;5b15d94b6256d01ad54eb020;Looking at the code, I don’t see any way it can work with anything but a file. So I think this most likely a doc apar.  Let me check into that before you open one.",03/Apr/23 11:22 PM;5b15d94b6256d01ad54eb020;I checked with development and they think this was an oversight.  So a string format should be supported. You can open an APAR.,07/Apr/23 6:45 PM;614dd566a995ad0073ec0622;Apar attached.,"13/Jun/23 5:20 PM;614dd566a995ad0073ec0622;PMR closed,",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
SCIM_EAS_SCHEMAS & SCIM_EAS_CONFIGURATION tables in 10.0.5,ISAMSUP-4933,291430,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,30/Mar/23 8:02 PM,04/Apr/23 9:37 PM,14/Jul/23 2:47 PM,04/Apr/23 9:37 PM,,,,0,,,,SCIM_EAS_SCHEMAS & SCIM_EAS_CONFIGURATION tables in 10.0.5.  Customer updated their appliance from 10.0.4 to 10.0.5. This appliance has an external Config db. Initially the upgrade did not go well as they were running the db update tool before upgrading the appliance itself. So eventually they proceeded in correct order. However these two scim tables now exist in the config db. I don’t know why they still exist. This  appliance has always had an external config db or so I have been assured.  So do we leave those tables there or ask customer to drop them?,,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011805309 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,Volkswagen AG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a3yf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-30 10:50:42.684,,,,,"30/Mar/23 8:50 PM;5b15d954b0d76456f36daf33;They are safe to be deleted by the customer. They were briefly introduced in an earlier release, but were subsequently deemed extraneous. As such they are unused by ISVA at this point.",04/Apr/23 9:37 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
EAI flow not working after upgraded from V9.0.7.1 to V10.0.4,ISAMSUP-4932,291423,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,30/Mar/23 6:44 PM,19/Apr/23 10:44 AM,14/Jul/23 2:47 PM,19/Apr/23 10:44 AM,10.0.6,,,0,,,,"Hello Team,

The customer complained their EAI envirioement stop working after upgraded.

Reagan is helping me on this case.

We found out that Salesforce:TS012157918/2023-03-24/isva_10.0.4.0_20230324-145336_uk-ex-wrp-myaviva-np-sit-b01.support_unpack/var/pdweb/ukdcp_SIT_external/trace/*

Thread(142) it *setOrigUrl =* [https://www.direct.rwy-aviva.co.uk/oauthaccess/auth?redirect_uri=applesqh://oauth_qa/callback&code_verifier=1ycEgC0raFLgmSzSQBe1FFN9Rry6OZZ3AdOwtYqCyMo=&state=barry&client_id=digicareoauthuser&scope=protectionavb&app=squarehealth|https://www.direct.rwy-aviva.co.uk/oauthaccess/auth?redirect_uri=applesqh://oauth_qa/callback&code_verifier=1ycEgC0raFLgmSzSQBe1FFN9Rry6OZZ3AdOwtYqCyMo=&state=barry&client_id=digicareoauthuser&scope=protectionavb&app=squarehealth]
I see hasLastUserName = 0 getReauthRequired = 0 within Thread(142) within the trace

CII EXIT set_last_url with return code:  1
Then look at Thread(142) Set-Cookie: PD-S-SESSION-ID=1_2_0_uOQ78suJQlAt8i6n5Fq9uwjm5yQhE4XmwBgUQmdvMgTMCQH3So I trace the PD-S-SESSION-ID it lead to Thread(157) then  Unauthenticated in PD---> Backend


After all I tried to search for the *setOrigUrl = NULL* to see what is going on.
I found Thread(198) Browser ===> PD it used PD-S-SESSION-ID=1_2_0_uOQ78suJQlAt8i6n5Fq9uwjm5yQhE4XmwBgUQmdvMgTMCQH3 (same as above)
In the pdweb.wns.authn.log I can see No HTTP header named Authorization, so it can't be OAuth 2.0 in Thread(198)

thread(198) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:454: [10.63.46.99] Added EC cookie to the response.
thread(198) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/authn/framework/authn-main.cpp:506: [10.63.46.99] EAI specified a URL and eai-redir-url-priority = yes.  Redirecting to: /MyAccount/Mfa/Verify
thread(198) trace.pdweb.wns.authn:9 /build/isam/src/i4w/pdweb/webseald/credscache/WSCredsCacheEntry.cpp:2077: [10.63.46.99] WSCredsCacheEntry::setOrigUrl = (null)

It does not not show “{{CII EXIT set_last_url with return code:  "" in the trace}}

At last I tried to search 1_2_1 related PD-S-SESSION-ID. I found 1_2_1_OmqppCU0kwR4SN1cSvy-I7cXmd3dQhrur33gUjuUf9XFCATF related thread. There are a few of thread use that PD-S-SESSION-ID. However, *I cannot find when and where it was set within PDweb.debug file.* 

The customer keep saying there is only one webseal. 
",,Dermot Daly,Gabe,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4976,,,,,,,,,,,,,,,,,IJ46255,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012157918,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,CELERITY LIMITED,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-04-13T16:43:43.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a3wv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-31 01:46:03.729,,,,,"31/Mar/23 11:46 AM;5b15d9517dab4c51f61b5190;There was a change in behaviour introduced by IJ31103 in 10.0.2.0

When the the initial eai login is done with the am-eai-redir-url specified 

the original url is being cleared. (This is the WSCredsCacheEntry::setOrigUrl = (null) in the trace)

The rationale being - since the original url has been bypassed and the user is now authenticated - it is no longer needed 

So when a second eai login is done in the same flow - there is no cached url - and the login success page is shown

I will talk to development about this issue","03/Apr/23 10:24 AM;5b15d9517dab4c51f61b5190;[~accountid:6092aca0f0db130069d19687] 

Please open an APAR  “EAI  not redirecting to expected page after upgrade”

After discussion with development we are going to add a new eai flag to control whether the cached url will be cleared

when am-eai-redir-url specified. The default will be to clear it (current behaviour). The new flag will stop it being cleared 

which will enable the old behaviour.

So the fix will require a change to the EAI to return the new flag",03/Apr/23 9:42 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] Thanks I opneded an APAR IJ46255.,"11/Apr/23 5:41 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 4469402fb136b3a32d8a89f766b15b4339b54248
   * description: ISAMSUP-4932 IJ46255 EAI not redirecting to expected page after upgrade

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87030.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4932) which we publish.",12/Apr/23 10:30 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] the customer asked when is the fix be ready?,"13/Apr/23 8:44 AM;5b15d9517dab4c51f61b5190;[~accountid:6092aca0f0db130069d19687] 

I have made the change - waiting for it to be reviewed

So should be have fixpack  this week or early next week","13/Apr/23 4:45 PM;5b15d9517dab4c51f61b5190;[~accountid:6092aca0f0db130069d19687] 

Change has been approved - will have fixpack tomorrow","13/Apr/23 4:48 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has failed for the following commit: 
   * id: 82bd6e074ac091dc4f68418530e0eb28f8be022e
   * description: Merge pull request #5822 from ISAM/ISAMSUP-4932

ISAMSUP-4932 IJ46255 EAI not redirecting to expected page after upgrade

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/92779.

","14/Apr/23 10:42 AM;5b15d9517dab4c51f61b5190;[~accountid:6092aca0f0db130069d19687] 

The fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4976|https://cloudidentity.atlassian.net/browse/ISAMSUP-4976|smart-link] 

The customer will need to change their EAI to return the new EAI flag “save-cached-url” to get the desired behaviour.

This change will be in 10.0.6.0

I have not backported it to 10.0.5.0

If they are intending to go to 10.0.5.0 - I will need to build a fixpack for 10.0.5.0 as well",14/Apr/23 5:27 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] THANK YOU very very very much !! 👍  ,14/Apr/23 5:58 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] The customer said “We are in process of upgrading to v10.0.5. Could you please provide fix pack for v10.0.5?”,"14/Apr/23 8:58 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] the customer changed their mind: “ With further development, it's decided to upgrade with 10.0.6.0 now.

So we don't require fix for 10.0.5 any more.”",19/Apr/23 10:44 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
AAC uses template file scripting for the /apiauthsvc for setting response cookie/header,ISAMSUP-4930,291098,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,29/Mar/23 2:29 AM,14/Apr/23 2:25 AM,14/Jul/23 2:47 PM,14/Apr/23 2:25 AM,,Support,,0,,,,"Customer have a requirement for setting response cookie/header in InfoMap and OTP when using /apiauthsvc. 

Theye use /apiauthsvc to call InfoMap and OTP authentication policies which return 204 response for success. In the InfoMap and OTP calling backend RSA AA is made and backend returns cookies, and they want to send the cookies back to browser.  Is there any better workaround?


We can think of, when success in InfoMap/OTP, store the cookies in SPSSession, and let client call additional authentication policy through /authsvc to get the response using template returning the cookies.

Is this possible? Any suggestions.?",,Brandon Garay,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,,,,60e721f12d49fd00698bb49d,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,03/Apr/23 11:47 AM;ashashiv;image-20230403-014639.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193802,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012573186,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,BANK OF MONTREAL,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1a1xb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-03-28 22:44:21.285,,,,,29/Mar/23 8:44 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] spoke to Dave today and he indicated that you may be working in the same area of code for another Jira ticket. Can you please review this and let us know if you need any additional support. ,"29/Mar/23 9:04 PM;5af4ad7d4dd24c579110120b;[~accountid:60e721f12d49fd00698bb49d] 



{{curl -k -v -H 'Accept: application/json' -H 'Content-Type: application/json' ""https://192.168.42.2:444/mga/sps/apiauthsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1""}}

Within infomap:

{noformat}var hr = new HttpResponse();
url = https://backendurl.com
hr = HttpClient.httpGet(url);
        if (hr != null) {
            IDMappingExtUtils.traceString(""code: "" + hr.getCode());
            IDMappingExtUtils.traceString(""body: "" + hr.getBody());
            IDMappingExtUtils.traceString(""headers: "" + getHeaders());
            //get header keys and values 
            //parse cookie
            cookiename = ""newcookie"";
            cookievalue = ""123455555"" 
        }

var abc = new Attribute(""newcookie"", ""urn:ibm:security:asf:request"", ""123455555);
stsuuCtxAttrs.setAttribute(abc);

OR

IDMappingExtUtils.setSPSSessionData(""newcookie"", ""123455555);
Get when necessary:
IDMappingExtUtils.getSPSSessionData(""newcookie"");
{noformat}


Then in the browser call - to be able to use the same {{newcookie}}? 

{{https://192.168.42.2:444/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest2}}

is this what they are trying to achieve? 

Which template files is the reference to in this description? 



Can you get more information - if they already have something working with what they have described can they share the flows and the mapping rule to confirm and validate if there is an alternate.","30/Mar/23 8:59 AM;60e721f12d49fd00698bb49d;Hey [~accountid:5af4ad7d4dd24c579110120b]  - Thanks for your quick response. I have asked customer and got the below response:

This is new project so the requirement is new.

All authentication requests are going through /aac/sps/apiauthsvc/policy/policy-name. The Policy returns 204 response for success. In this 204 response and previous 200 responses, we need send cookie back to client. As we know the template page and templateContext is not available for the 204 response, so there is no way adding cookie in response using template page. Also reading from the url below scripting is not possible ""[https://community.ibm.com/community/user/security/discussion/isam-template-page-scripting-in-aac""|https://community.ibm.com/community/user/security/discussion/isam-template-page-scripting-in-aac%22] 

We do not have any workaround in place, we are looking for solution for this requirement. After internal discussion, we have 2 options now. (1) The first is above, adding extra call to /aac/sps/authsvc and template page setting response set-cookie header. (2) The second is adding the cookie value in credential attribute on AAC and inserting the cookie in response using HTTPTransformation on WebSEAL.

*Would you please any recommendations?* ","03/Apr/23 11:47 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

Yes both are possible options depending on what they need in their environment.

Set the cookie from backend by calling authsvc 
Or
Use Http Transformation rule to set a cookie


They could use the Http Redirect policy to call the endpoint if this is a possibility in their environment.

!image-20230403-014639.png|width=795,height=677!","14/Apr/23 2:25 AM;60e721f12d49fd00698bb49d;Thanks [~accountid:5af4ad7d4dd24c579110120b] 

I’ll close this one.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"""static"" JSON template files are not properly processed with embedded JS",ISAMSUP-4917,289920,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bill Tyler,5b15d94b6256d01ad54eb020,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,24/Mar/23 10:17 AM,11/Jul/23 11:47 AM,14/Jul/23 2:47 PM,,,,,0,,,,"When a file with the .json extension that should have the contents processed, and is recognized as such in the code the *StaticPageHandler.java* is now treating it as a binary page, thus skipping the process to run the embedded script.

Customer reports that this is not happening in 10.0.3.1 I recreated the problem at 10.0.5.

If all I do in 10.0.5 is rename the file to .html it gets processed properly as a template with macros.


It seems there was a change to how a binary file is detected. 

In 10.0.5

[3/23/23, 16:51:43:360 CDT] 00000028 id=00000000 com.tivoli.am.fim.pages.StaticPageDelegateProtocol           3 processRequest Request made to /static/obligation_action.json with method GET
[3/23/23, 16:51:43:360 CDT] 00000028 id=00000000 com.tivoli.am.fim.pages.handlers.StaticPageHandler           > actionGet ENTRY
[3/23/23, 16:51:43:369 CDT] 00000028 id=00000000 com.tivoli.am.fim.pages.handlers.StaticPageHandler           3 actionGet Found content type of *[application/json]*



In 10.0.3.1

[3/23/23, 19:02:00:911 CDT] 00000049 id=00000000 com.tivoli.am.fim.pages.StaticPageDelegateProtocol           3 processRequest Request made to /static/obligation_action.json with method GET
[3/23/23, 19:02:00:912 CDT] 00000049 id=00000000 com.tivoli.am.fim.pages.handlers.StaticPageHandler           > actionGet ENTRY
[3/23/23, 19:02:00:918 CDT] 00000049 id=00000000 com.tivoli.am.fim.pages.handlers.StaticPageHandler           3 actionGet Found content type of *[text/plain]*





It looks like in the older version URLConnection.guessContentTypeFromName(pageId) returned null for the json file. This results in the json being given the default contentType = ""text/plain"";

Which then allows the check if(contentType.startsWith(TEXT)) to treat is as a proper page template.



It seems at some point this  URLConnection.guessContentTypeFromName(pageId) started returning *application/json* for the file.

This is a problem as the code check only processes templates that start with text/  



The code in *StaticPageHandler.java* should not be treating a json file as binary page file as *BinaryPageImpl.java* has no logic to check if (this._checkJSembed) { like there is in *PageImpl.java*


This appears to be an APAR, this appears to be caused by a change in behavior for the URLConnection.guessContentTypeFromName() method, the fix should be simple and that is do some extension to the work done in IJ23926 so that *StaticPageHandler.java* does not just check if(contentType.startsWith(TEXT)) {  but also checks if the file name matches sps.page.jsCompileFileExtensions and treats that as a normal page not a binary file. 



This appears to have only been working in the past due to a reliance on URLConnection.guessContentTypeFromName() not returning a value and an thus an oversight in the logic that if the JVM method does start returning, like it does now, that files will not be processed correctly as no prevision was made for content-types that do not start with “text/”



[~accountid:5b15d99182e05b22cc7d5947] 

Please let me know that I have L3's permission to open what is clearly an APAR. ",,Annelise Quap,David Hayes,George Benavides,khansen,Nick Lloyd,,,,,,,,,,,5b15d950d9936c61022057fe,5b232b2fd85e5b59b066f57f,5b15d99182e05b22cc7d5947,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ46643,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012533559,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,SCHOOLSFIRST FEDERAL CREDIT UNION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=2, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":2,""lastUpdated"":""2023-07-11T10:25:51.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":2,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19uo7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-30 22:50:39.457,,,,,"31/Mar/23 8:50 AM;5b15d99182e05b22cc7d5947;Hello Annelise,

Will need to be reacquainted with this area of code. Unfortunately this area of code has seen some past problems. 

However since this particular scenario is indicating a regression this issue most likely warrants an apar. Will start taking a look. Hopefully will have an answer by next week.

I see 10.0.4.0 in listed versions. Do we know if regression started in 10.0.4.0 or only seen in 10.0.5.0.?

Thanks!",05/Apr/23 4:00 AM;5b15d950d9936c61022057fe;The 10.0.4 was a accidental click I’ve only recreated this on 10.0.5.,20/Apr/23 1:13 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020] assigning this item to you to assist in the future. If you need support can you please work work with [~accountid:5b15d99182e05b22cc7d5947]  on this.,"21/Apr/23 1:54 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d950d9936c61022057fe]  George thinks this is regression, do you know the latest version this worked  correctly in? If not I’ll try to figure that out.","21/Apr/23 2:08 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d950d9936c61022057fe] this looks like a pretty simple fix so go ahead and open an APAR.



Looks like this is fixed in a later version of java so for now we’ll work around it.

[https://bugs.openjdk.org/browse/JDK-8273655|https://bugs.openjdk.org/browse/JDK-8273655]",03/May/23 2:12 AM;5b15d901fa615349cb01778b;[~accountid:5b15d950d9936c61022057fe] - please open the APAR,"03/May/23 2:23 AM;5b15d950d9936c61022057fe;First appears in 10.0.5.


IJ46643","03/May/23 2:31 AM;5b15d950d9936c61022057fe;Just to be clear the issue is caused by the fix that you listed.  The code was expecting the URLConnection.guessContentTypeFromName(pageId) to return null   when the JVM fixed the missing type this broke the logic in the pagehandler.    The page handler only processes templates that start with text/   So now that a json file properly returns application/json it is treated as binary file. 

This needs to be an extension to the work done in IJ23926 so that StaticPageHandler.java does not just check if(contentType.startsWith(TEXT)) {  but also checks if the file name matches sps.page.jsCompileFileExtensions and treats that as a normal page not a binary file. ","08/Jun/23 6:56 AM;5b15d94b6256d01ad54eb020;Like I said it is a simple fix.  It won’t make it into 10.0.6.0  but should go in either our next fix pack  and/or next release.

Do you need a fix pack for this?",14/Jun/23 1:44 AM;5b15d901fa615349cb01778b;They have implemented the workaround.  setting back to L3 to complete the APAR,"11/Jul/23 10:25 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 8738800aea3330cbb33b3a0f74755ca91ba41d5b
   * description: Merge pull request #5986 from ISAM/ISAMSUP-4917

ISAMSUP-4917  Update StaticPageHandler.java

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2436352.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230711002249-8738800ae.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","11/Jul/23 10:50 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 8738800aea3330cbb33b3a0f74755ca91ba41d5b
   * description: Merge pull request #5986 from ISAM/ISAMSUP-4917

ISAMSUP-4917  Update StaticPageHandler.java

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2437040.


This build has not been published as the commit is not currently within a branch (20230710232622-6279b9296) which we publish.","11/Jul/23 10:52 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 8738800aea3330cbb33b3a0f74755ca91ba41d5b
   * description: Merge pull request #5986 from ISAM/ISAMSUP-4917

ISAMSUP-4917  Update StaticPageHandler.java

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2437015.


This build has not been published as the commit is not currently within a branch (20230710232508-39100b2b0) which we publish.","11/Jul/23 11:47 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 8738800aea3330cbb33b3a0f74755ca91ba41d5b
   * description: Merge pull request #5986 from ISAM/ISAMSUP-4917

ISAMSUP-4917  Update StaticPageHandler.java

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2438240.


This build has not been published as the commit is not currently within a branch (20230711002249-8738800ae) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA 10.0.5.0/Docs/SAML,ISAMSUP-4910,289654,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,23/Mar/23 6:03 AM,22/May/23 12:18 PM,14/Jul/23 2:47 PM,22/May/23 12:18 PM,10.0.6,,,0,,,,"Federation/SAMl/IDP -> Edit IDP -> ""Single SignOn Settings"" there the documentation is wrong.
attached “pic_1”

!Pic_1.jpg|width=1741,height=891!

as well as the entry above that. On the IDP side, it will not be receiving assertions, but rather it will be getting requests.    This seems like just a copy and paste of the SP side, so they should fix this one as well as the one you mentioned (pic_2)


!Pic_2.jpg|width=731,height=83!

These two should probably be re-written too, they don't make a lot of sense (pic_3)

!Pic_3.jpg|width=778,height=216!",,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,23/Mar/23 6:03 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;Pic_1.jpg;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191942,23/Mar/23 6:03 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;Pic_2.jpg;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191944,23/Mar/23 6:03 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;Pic_3.jpg;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191943,23/Mar/23 6:14 AM;nlloyd;image-20230322-201457.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191947,12/Apr/23 3:42 AM;ug:1a201dc3-cbfc-43a4-a135-bc31994299c3;image-20230411-174122.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/195531,,,,,,,,,,,IJ46164,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012500894,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,T-Systems International GmbH,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19t0v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-22 20:14:05.14,,,,,"23/Mar/23 6:08 AM;614dd52af1c1740068534813;Wondering if L3 is also responsible for document changes? If not, may someone can point me in the right direction?",23/Mar/23 6:14 AM;5b15d9e6dda5f94d06b985b4;[~accountid:614dd52af1c1740068534813] Open a DOC APAR noting the changes which need to be made.,"23/Mar/23 6:15 AM;5b15d9e6dda5f94d06b985b4;!image-20230322-201457.png|width=1867,height=241!",28/Mar/23 2:12 AM;614dd52af1c1740068534813;[~accountid:607d9b00de3440007177d56b] APAR created (IJ46164),"30/Mar/23 2:42 PM;5b232b2fd85e5b59b066f57f;Pull req: [https://github.ibm.com/isva-idd/SSPREK_10.0.x/pull/205|https://github.ibm.com/isva-idd/SSPREK_10.0.x/pull/205]

Under review. ",11/Apr/23 10:35 AM;5b232b2fd85e5b59b066f57f;[~accountid:614dd52af1c1740068534813] - can you please review [https://github.ibm.com/isva-idd/SSPREK_10.0.x/pull/205|https://github.ibm.com/isva-idd/SSPREK_10.0.x/pull/205] and confirm that this addresses all of the issues? Thanks. ,"12/Apr/23 3:42 AM;614dd52af1c1740068534813;[~accountid:5b232b2fd85e5b59b066f57f] I can’t access the link


!image-20230411-174122.png|width=1426,height=583!


I asked the L2 US team but no joy.

It seems L2 doesn't have Development Github access.","19/Apr/23 8:17 PM;614dd52af1c1740068534813;Hi [~accountid:5b232b2fd85e5b59b066f57f] . Do we have any update on that?



Thanks,

Edvan",21/Apr/23 1:46 PM;5b232b2fd85e5b59b066f57f;Still waiting for review. I’ve ping Dev and will continue to chase. ,26/Apr/23 10:15 AM;5b232b2fd85e5b59b066f57f;[~accountid:614dd52af1c1740068534813] - doc change has been merged and APAR closed. It should be published once 10.0.6 is available. If done - please close out this WI. Thanks. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Rolling the WAF(SecMod) Audit log,ISAMSUP-4907,289633,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Gabe,5b15d99b4c20165700edecad,Gabe,5b15d99b4c20165700edecad,23/Mar/23 3:36 AM,05/Apr/23 8:55 AM,14/Jul/23 2:47 PM,05/Apr/23 8:55 AM,10.0.6,,,0,,,,"Our current WAF modsecurity configuration is using the serial option for SecAuditLogType which is leading to some customers filling their drives. Even with Remote Syslog Forwarding this will be a problem. 

[https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-(v2.x)#secauditlogtype|https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-(v2.x)#secauditlogtype|smart-link] 

I’ve tested setting the log-cfg but that seems to only work for events. Shouldn’t the audit log have the same rolling/size options as the events log? The lack of rolling/sizing will be an problem in the future for any customer enabling auditing. 

As a quick test I used this config. 
[waf]
request-match = [1-2,5]GET /*
log-cfg = file path=waf_events.log,hi_water=1,flush_interval=1,rollover_size=1,max_rollover_files=2
log-cfg = file path=waf_audit.log,hi_water=1,flush_interval=1,rollover_size=1,max_rollover_files=2

The result was the events being written to the waf_audit.log and instead of the waf_events.log. 

The other option for SecAuditLogType is concurrent but that would lead to the same result, full drive with tons of little files. ",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ46217,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012514782,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Gabe,5b15d99b4c20165700edecad,,,,PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=2}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":2,""lastUpdated"":""2023-04-06T10:48:11.000+1000"",""stateCount"":2,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":2,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19swf:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-23 06:49:41.068,,,,,"23/Mar/23 4:49 PM;5b15d9517dab4c51f61b5190;We currently have no mechanism to rollover the modsecurity audit log

The only mechanism we currently have available to manage the space are the export and clear options in the LMI

I have talked to development about this issue

Please request customer to open an RFE for the issue","23/Mar/23 4:54 PM;5b15d9517dab4c51f61b5190;IBM Internal Only - not for customer

Response from Development to my query

It doesn’t look like we have any control of the audit or debug logs – those files are written to directly by modsecurity. 

For the event log, we initialise modsecurity with a logging callback which receives these events and allows us to control how logs are written. I’ve spent some time reviewing the modsecurity source and it seems there is no similar mechanism for audit or debug.

 I was able to find a comment from one of the modsec authors which alludes to this being the case: [https://github.com/SpiderLabs/ModSecurity/issues/2726#issuecomment-1108726711|https://github.com/SpiderLabs/ModSecurity/issues/2726#issuecomment-1108726711|smart-link] 

 We could either:

 Allow clients to configure SecAuditLogType ([https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v3.x%29#user-content-SecAuditLogType|https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v3.x%29#user-content-SecAuditLogType|smart-link] ) with the HTTPS mode and specify their own endpoint.

 Use logrotate but with the copytruncate option (which is a little ugly [https://github.com/SpiderLabs/ModSecurity-nginx/issues/121|https://github.com/SpiderLabs/ModSecurity-nginx/issues/121|smart-link] ) to work around the issue you encountered.

FYI this was in response to me trying out  /usr/sbin/logrotate to see if it would solve the issue)

 I do think that this is an RFE as it will not be simple, and we need something more practical than how things are today.","30/Mar/23 5:16 AM;5b15d99b4c20165700edecad;The customer opened *ISAM-I-1183* to address the audit log rotation.

On a side note is it okay if we doc APAR the rollover_size parameter? The RP conf shows the size in MB but its actually bytes. 

# rollover_size file, rsyslog For rsyslog, events which are sent to
# a remote syslog server are initially
# written to a local file. This parameter
# controls the maximum size of the file
# *before it is rolled over (in MB)*.",30/Mar/23 9:30 AM;5b15d9517dab4c51f61b5190;Yes - open a Doc APAR and I will get it changed,"31/Mar/23 2:53 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d99b4c20165700edecad] 

I thought this was a doc change - but I see it is a webseal configuration template file change

It uses the incorrect MB in multiple places

I will change them all to bytes","31/Mar/23 5:24 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 78562dcf3d96e9810c91f0cfd64cc616c9a5826e
   * description: ISAMSUP-4907 IJ46217 wrong units for rollover_size

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87874794.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4907) which we publish.",03/Apr/23 11:31 AM;5b15d9517dab4c51f61b5190;Updated webseal template will be in 10.0.6.0,"03/Apr/23 11:49 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f4af3b15a21ae12bac68e25b3c2d16bfcfe4adfe
   * description: Merge pull request #5801 from ISAM/ISAMSUP-4907

ISAMSUP-4907 IJ46217 wrong units for rollover_size

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/73443.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230403014700-f4af3b15.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","03/Apr/23 12:00 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f4af3b15a21ae12bac68e25b3c2d16bfcfe4adfe
   * description: Merge pull request #5801 from ISAM/ISAMSUP-4907

ISAMSUP-4907 IJ46217 wrong units for rollover_size

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/73457.


This build has not been published as the commit is not currently within a branch (20230403004123-a9dea32f) which we publish.","03/Apr/23 1:06 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f4af3b15a21ae12bac68e25b3c2d16bfcfe4adfe
   * description: Merge pull request #5801 from ISAM/ISAMSUP-4907

ISAMSUP-4907 IJ46217 wrong units for rollover_size

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/73531.


This build has not been published as the commit is not currently within a branch (20230403014700-f4af3b15) which we publish.",04/Apr/23 9:38 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9517dab4c51f61b5190] - can we close this one out? ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
IBM Verify Device is not deleted in Grants,ISAMSUP-4898,288276,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Carsten Hagemann,5af4ad7f39d04955d9e20da6,Aaron.Richie.Dias,6194c472fe9f300068e5252f,Aaron.Richie.Dias,6194c472fe9f300068e5252f,21/Mar/23 2:24 AM,07/Jun/23 5:06 PM,14/Jul/23 2:47 PM,02/Jun/23 1:52 PM,,,,0,verifyapp,,,"Customer faces a problem with device deletion from IBM Verify mobile app
With Android phones :
The account is deleted on the phone but not the grant in ISAM, both grants from AAC admin LMI and device from [https://url/mga/sps/mmfa/user/mgmt/html/mmfa/usc/manage.html|https://url/mga/sps/mmfa/user/mgmt/html/mmfa/usc/manage.html]

With iPhone :
The account is deleted on the phone and the grant is deleted in ISAM as well, both grants from AAC LMI and device and [https://url/mga/sps/mmfa/user/mgmt/html/mmfa/usc/manage.html|https://url/mga/sps/mmfa/user/mgmt/html/mmfa/usc/manage.html]



What is the IBM Verify app version you are using?
IOS : v2.5.2(4)
Android : 2.5.10(107)
 ISVA v10.0.4
Please send us a screenshot of the URL([https://access-ppd.web.bpifrance.fr/mga/sps/mmfa/user/mgmt/html/mmfa/usc/manage.html|https://access-ppd.web.bpifrance.fr/mga/sps/mmfa/user/mgmt/html/mmfa/usc/manage.html|smart-link] ) you are using

Please find screenshot attached below 


Does this also happen when the user registers an account with Verify and then deletes the account a few minutes later on the phone?

It only happens after a while ( 1 hour) and only on android devices
It works fine if we delete devices a few minutes after device registration",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CI-113155,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012041098,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Aaron.Richie.Dias,6194c472fe9f300068e5252f,,,,BPIFRANCE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19jw7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,CI Sprint 114,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-28 22:46:12.712,,,,,21/Mar/23 2:25 AM;6194c472fe9f300068e5252f;I have been working with [~accountid:5af4ad7f39d04955d9e20da6] on slack on this issue [https://ibm-security.slack.com/archives/C5SLE8KJ5/p1677087848294319|https://ibm-security.slack.com/archives/C5SLE8KJ5/p1677087848294319|smart-link] ,29/Mar/23 8:46 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7f39d04955d9e20da6] can you please provide an update on the progress that has been made for this issue in this Jira item. Let me know if I can support in anyway. ,29/Mar/23 7:01 PM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] I’m having problems to reproduce this issue. Do all users (reproducible) experience this problem? Or just a few of them at random times?,29/Mar/23 11:50 PM;6194c472fe9f300068e5252f;I have requested the customer to provide an update on your query and will get back with their response. ,"31/Mar/23 1:31 PM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] I’ve found the issue. Fix will be incorporated in the next release. 

Could we please have someone (tester, developer - the like) with access to the customers system, joining the beta group in order to verify the fix prior to public release?",31/Mar/23 9:02 PM;6194c472fe9f300068e5252f;I will request that with the customer and get back to you on it. ,"12/Apr/23 6:05 PM;6194c472fe9f300068e5252f;[~accountid:5af4ad7f39d04955d9e20da6] 

The customer mentioned they can have someone help test the fix, can you let me know what is needed from them?

============================================= 

We are the final customer and have access to our system

Our ISVA is running on release 10.0.4.0 IF1

What are the actions requested to verify the fix ?

=============================================","12/Apr/23 10:39 PM;5af4ad7f39d04955d9e20da6;Thanks [~accountid:6194c472fe9f300068e5252f].

I need to know the Google ID of that user(s). That ID should be same as the one that is used on their Android phone.","13/Apr/23 6:11 PM;6194c472fe9f300068e5252f;alright, I will request that from the customer and get back to you with the details. ","19/Apr/23 7:50 PM;6194c472fe9f300068e5252f;[~accountid:5af4ad7f39d04955d9e20da6] customer has provided their google id below, let me know if you require any further info:

===============================

Google Id is [rb52613@gmail.com|mailto:rb52613@gmail.com]



Regards

Romuald

==============================",20/Apr/23 10:33 AM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] Thanks! I have submitted a request to add him the group of beta testers and will send him some instructions.,"24/Apr/23 10:58 PM;6194c472fe9f300068e5252f;[~accountid:5af4ad7f39d04955d9e20da6] Thanks for the update. The customer has got back on the case saying:

======================================================================

I have to contact MDM team to allow my account for installing this app on my phone.

I come back to you when it's done

Regards

Romuald

======================================================================",02/May/23 2:42 PM;5af4ad7f39d04955d9e20da6;Fixed app version 2.5.11 has been released to Beta (already on the 11.04.2023). Customer has been added to the Beta group (see below) to test the functionality.,"09/May/23 12:25 AM;6194c472fe9f300068e5252f;Hello [~accountid:5af4ad7f39d04955d9e20da6], below is the update from the customer on the case:

=========================================

 Hello Aaron,



I could done tests, It works fine with my 2 mfa accounts ( prod & test )

Do you know when this fix will be available ?

Thank for your help

Regards,

Romuald

=========================================",09/May/23 9:13 AM;5af4ad7f39d04955d9e20da6;[~accountid:6194c472fe9f300068e5252f] Thanks for the confirmation. I’m planning to start a public rollout by the end of this week.,22/May/23 2:55 PM;5af4ad7f39d04955d9e20da6;App has been released on the 11.05.2023 at 50% staging.,23/May/23 8:10 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7f39d04955d9e20da6] can you please confirm what the timeline might be to have this release published? ,"23/May/23 10:24 AM;5af4ad7f39d04955d9e20da6;[~accountid:5ac57757d9a96536d1f0daa9] App has been released on the 11.05.2023 for all new users and to 50% of the existing users (randomly selected by Google). If no issues are getting raised, I’m planning to set the release to 100% by the end of this week.",07/Jun/23 5:06 PM;6194c472fe9f300068e5252f;Hey [~accountid:5af4ad7f39d04955d9e20da6] I have closed the salesforce case and let the customer know to check for available updates. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Installation ISVA 10.0.5 is failing,ISAMSUP-4895,288138,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,18/Mar/23 2:29 AM,09/May/23 9:51 PM,14/Jul/23 2:47 PM,09/May/23 9:51 PM,,Support,,0,,,,"Customer BCO. HIPOTECARIO S.A is trying to install from scratch the ISVA 10.0.5 version.

ISO’s they have tried to install, but same result:

* isva_10.0.5.0_20221129-1716.iso 
* Sec_Ver_Acc10.0.5_BVAISOFi_ML.iso

I connected with customer, and this is happening only with ISVA 10.0.5, we tried to install 10.0.4 and no errors have been seen, same VM. Using VMware vSphere Client 6.0

From my side (L2) I wasn’t able to reproduce the error. 

Getting the following error:

!image-20230317-162541.png|width=1230,height=153!",,Brandon Garay,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,60e721f12d49fd00698bb49d,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,18/Mar/23 2:29 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230317-162541.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190881,21/Mar/23 5:38 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230320-193233.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191286,21/Mar/23 8:08 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230320-220729.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191333,22/Mar/23 2:52 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230321-164836.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191622,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012278701,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,, BCO. HIPOTECARIO S.A.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19j1r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-17 16:38:23.62,,,,,"18/Mar/23 2:38 AM;5b15d94b6256d01ad54eb020;Are they using  “sys.direct.update.allowed=true”  as described here:

[https://www.ibm.com/support/pages/ibm-security-verify-access-isva-upgrade-information|https://www.ibm.com/support/pages/ibm-security-verify-access-isva-upgrade-information|smart-link] ","18/Mar/23 2:41 AM;60e721f12d49fd00698bb49d;Hey [~accountid:5b15d94b6256d01ad54eb020] 

They are not upgrading - they are installing the image from scratch on their VM’s.","18/Mar/23 2:42 AM;5b15d94b6256d01ad54eb020;Then they need to use the iso file, not the pkg.

Also check the VM and make sure it meets the minimum requirements.

What is the error they are getting trying to install using the ISO?  The attached image  show the pkg attempt.","18/Mar/23 2:42 AM;60e721f12d49fd00698bb49d;I saw this with same error from customer: [https://cloudidentity.atlassian.net/browse/ISAMDEV-9014|https://cloudidentity.atlassian.net/browse/ISAMDEV-9014|smart-link] 

But difference is that BCO. HIPOTECARIO S.A. are installing from scratch and not upgrading..","20/Mar/23 8:13 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9517dab4c51f61b5190] can you please review this item during your day today please? 

[~accountid:5b232b2fd85e5b59b066f57f] FYI.","20/Mar/23 9:44 AM;5b15d9517dab4c51f61b5190;I agree with [~accountid:5b15d94b6256d01ad54eb020] 

they need to use the iso not the pkg

If they have downloaded the iso then they need to check the downloaded file matches the published md5sum","21/Mar/23 5:38 AM;60e721f12d49fd00698bb49d;I met with customer once again today.

* Downloaded the iso from the below webpage
** [IBM Support: Fix Central - Download files using HTTPS|https://www.ibm.com/support/fixcentral/swg/downloadFixes?parent=IBM%20Security&product=ibm/Tivoli/IBM+Security+Verify+Access&release=10.0.4.0&platform=All&function=fixId&fixids=10.0.5-ISS-ISVA-FP0000&includeRequisites=1&includeSupersedes=0&downloadMethod=http]
** Using the .iso file
*** !image-20230320-193233.png|width=289,height=297!

Tried to install the .iso image of ISVA 10.0.5 using their Hypervisor which is VMware vSphere Client 6.0 and I can see from reports that is supported.

This is not happening when we tried to install from scratch the 10.0.4 .iso.

I can confirm, they are not using the .pkg. … they are using the .iso file which I used on my environment and wasn’t able to recreate.

What do you mean by “If they have downloaded the iso then they need to check the downloaded file matches the published md5sum”

They are using: 

* [isva_10.0.5.0_20221129-1716.iso (1.1 GB)|https://ak-delivery04-mul.dhe.ibm.com/sar/CMA/TIA/0b1nj/0/isva_10.0.5.0_20221129-1716.iso]
* {{f661d3549de18355dcbada6d03d43b7f  isva_10.0.5.0_20221129-1716.iso}} as per md5sum.txt.","21/Mar/23 5:46 AM;5b15d94b6256d01ad54eb020;{color:#4c9aff}“What do you mean by “If they have downloaded the iso then they need to check the downloaded file matches the published md5sum””{color}

That means to generate your own check sum and compare it with the one provided in  md5sum.txt.  They should match exactly.   

example:  

cat  isva_10.0.5.0_20221129-1716.iso | md5sum

you should get:  f661d3549de18355dcbada6d03d43b7f

Is that how you got the value you listed?

That is the same iso I used  and I had no problems with it at all.



What is the error they are getting trying to install using the ISO?  ","21/Mar/23 8:08 AM;60e721f12d49fd00698bb49d;User ran following script. Seems it’s matching.

*_certutil -hashfile <file> MD5_*

!image-20230320-220729.png|width=657,height=79!","22/Mar/23 2:29 AM;5b15d94b6256d01ad54eb020;Brandon.  I still need an answer to these questions:

What is the error they are getting trying to install using the ISO?  

Have you checked to be sure their VM meets our minimums requirements?","22/Mar/23 2:52 AM;60e721f12d49fd00698bb49d;Hi Bill.

This is the error they are getting. I know that from screenshot it seems they are using wrong file and using the .pkg… but believe me.. they are not. They are using the .iso file. I met yesterday with them and downloaded a new .iso and it’s getting the same error message. 

In terms of requirements, we checked their VM and they are good enough with resources as per below guideline.

The general minimum requirements for the virtual appliance are:

* Disk space requirement: 100 GB
* Memory requirement: 4 GB
* Virtual network devices: 1 (Maximum 8)

!image-20230321-164836.png|width=1212,height=158!","22/Mar/23 4:52 AM;5b15d94b6256d01ad54eb020;Brandon,

Please check again on that file because we do not hard code file names. I’m sure that if it says pkg then it’s a pkg.",12/Apr/23 12:12 AM;5b15d94b6256d01ad54eb020;[~accountid:60e721f12d49fd00698bb49d] what is the status of this?,"12/Apr/23 4:18 AM;60e721f12d49fd00698bb49d;Hi Bill.

Still struggling with customer. Will provide an update at the end of this week.",09/May/23 9:51 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Snapshot applied but errors lingering,ISAMSUP-4891,287953,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,16/Mar/23 10:52 PM,28/Jun/23 2:52 AM,14/Jul/23 2:47 PM,28/Jun/23 2:52 AM,,,,0,,,,"Customer migrated one of one their non-prod environments to different hardware.  The affected server crashed, all settings gone; hostname etc.  This happened at the same time an attempt to start  a previous dev broken machine in the same vmware environment. When the affected server crashed it created a snapshot.  The licenses were missing so we restored those. This most recent snapshot was applied successfully although it left these errors:



{noformat}Error: WGAWA0256E Incorrect usage for the mesa_config isam.cluster command.
WGAWA0384E The cluster master cannot currently be reached, and must be reachable in order to complete the operation.
Error: WGAWA0003I An error occurred while executing the command: /usr/bin/ssh -l cluster -o PreferredAuthentications=publickey -o BatchMode=yes -o CheckHostIP=no -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i /home/cluster/.ssh/id_rsa -p 22 -- 139.113.34.80 /usr/sbin/mesa_config isam.cluster flag set runtime_profile
(0x1) WGAWA0384E The cluster master cannot currently be reached, and must be reachable in order to complete the operation. {noformat}

So is this machine stable? Are these errors an issue? Recent snapshots have been uploaded to the pmr.  I am awaiting confirmation if the customer used vmware vmotion.",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,William Hannon Jr,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011612600,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,TIETOEVRY NORWAY AS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19hyn:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-29 12:30:35.034,,,,,21/Mar/23 6:38 PM;614dd566a995ad0073ec0622;Vmotion was not used.,"29/Mar/23 9:45 PM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] Customer needs this machine back up for testing. Any update? The machine seems fine except when they tried to install trusteer PIP extension as shown below. Is there any relevance?



{noformat}1 Trusteer PIP Extension: START INSTALL

2 Trusteer PIP Extension: LMI User admin@local

3 Trusteer PIP Extension: Directory /var/extensions/

4 % Total % Received % Xferd Average Speed Time Time Time Current

5 Dload Upload Total Spent Left Speed

6

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 31938 100 31938 0 0 182k 0 --:--:-- --:--:-- --:--:-- 182k

7 Trusteer PIP Extension: Creating attribute Pinpoint Detect Web Login Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:recommendation.

8 % Total % Received % Xferd Average Speed Time Time Time Current

9 Dload Upload Total Spent Left Speed

10

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 419 0 0 100 419 0 2074 --:--:-- --:--:-- --:--:-- 2064

100 525 100 106 100 419 193 764 --:--:-- --:--:-- --:--:-- 956

11 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web Login Reason ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:reason_id.

12 % Total % Received % Xferd Average Speed Time Time Time Current

13 Dload Upload Total Spent Left Speed

14

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 405 0 0 100 405 0 2004 --:--:-- --:--:-- --:--:-- 2004

100 511 100 106 100 405 200 764 --:--:-- --:--:-- --:--:-- 962

15 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web Login Risk Score of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:risk_score.

16 % Total % Received % Xferd Average Speed Time Time Time Current

17 Dload Upload Total Spent Left Speed

18

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 408 0 0 100 408 0 2029 --:--:-- --:--:-- --:--:-- 2019

100 514 100 106 100 408 185 714 --:--:-- --:--:-- --:--:-- 898

19 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web Login Bot Detected of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:is_bot.

20 % Total % Received % Xferd Average Speed Time Time Time Current

21 Dload Upload Total Spent Left Speed

22

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 408 0 0 100 408 0 2029 --:--:-- --:--:-- --:--:-- 2019

100 514 100 106 100 408 185 713 --:--:-- --:--:-- --:--:-- 897

23 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web Login Bot ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:bot_id.

24 % Total % Received % Xferd Average Speed Time Time Time Current

25 Dload Upload Total Spent Left Speed

26

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 396 0 0 100 396 0 1960 --:--:-- --:--:-- --:--:-- 1950

100 502 100 106 100 396 194 727 --:--:-- --:--:-- --:--:-- 921

27 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web Login Bot Label of type String with ID urn:ibm:security:trusteer:pinpoint:cd:login:recommendation:bot_label.

28 % Total % Received % Xferd Average Speed Time Time Time Current

29 Dload Upload Total Spent Left Speed

30

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 510 100 106 100 404 189 724 --:--:-- --:--:-- --:--:-- 912

100 510 100 106 100 404 189 724 --:--:-- --:--:-- --:--:-- 912

31 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web In-Session Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:recommendation.

32 % Total % Received % Xferd Average Speed Time Time Time Current

33 Dload Upload Total Spent Left Speed

34

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 537 100 106 100 431 189 771 --:--:-- --:--:-- --:--:-- 958

100 537 100 106 100 431 189 771 --:--:-- --:--:-- --:--:-- 958

35 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web In-Session Reason ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:reason_id.

36 % Total % Received % Xferd Average Speed Time Time Time Current

37 Dload Upload Total Spent Left Speed

38

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 523 100 106 100 417 186 734 --:--:-- --:--:-- --:--:-- 919

100 523 100 106 100 417 186 734 --:--:-- --:--:-- --:--:-- 919

39 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web In-Session Risk Score of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:risk_score.

40 % Total % Received % Xferd Average Speed Time Time Time Current

41 Dload Upload Total Spent Left Speed

42

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 526 100 106 100 420 200 795 --:--:-- --:--:-- --:--:-- 994

100 526 100 106 100 420 200 793 --:--:-- --:--:-- --:--:-- 994

43 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web In-Session Bot Detected of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:is_bot.

44 % Total % Received % Xferd Average Speed Time Time Time Current

45 Dload Upload Total Spent Left Speed

46

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 526 100 106 100 420 194 770 --:--:-- --:--:-- --:--:-- 965

47 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web In-Session Bot ID of type Integer with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:bot_id.

48 % Total % Received % Xferd Average Speed Time Time Time Current

49 Dload Upload Total Spent Left Speed

50

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 514 100 106 100 408 197 761 --:--:-- --:--:-- --:--:-- 958

51 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web In-Session Bot Label of type String with ID urn:ibm:security:trusteer:pinpoint:cd:session:recommendation:bot_label.

52 % Total % Received % Xferd Average Speed Time Time Time Current

53 Dload Upload Total Spent Left Speed

54

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 522 100 106 100 416 183 719 --:--:-- --:--:-- --:--:-- 903

55 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web Add Payee Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:payee:recommendation:recommendation.

56 % Total % Received % Xferd Average Speed Time Time Time Current

57 Dload Upload Total Spent Left Speed

58

0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

100 533 100 106 100 427 184 741 --:--:-- --:--:-- --:--:-- 925

59 {""result"":""FBTRBA094E The generation of an ID from the KEYS table for resource type [Attributes] failed.""}Trusteer PIP Extension: Creating attribute Pinpoint Detect Web Transaction Recommendation of type String with ID urn:ibm:security:trusteer:pinpoint:cd:transaction:recommendation:recommendation.

60 % Total % Received % Xferd Average Speed Time Time Time Current

61 Dload Upload Total Spent Left Speed

{noformat}","29/Mar/23 10:30 PM;5b17571b91981f4fdde632c1;For ISVA L3 only:

[~accountid:5ac57757d9a96536d1f0daa9] 

[~accountid:5b232b2fd85e5b59b066f57f] 

Per the work item review from last night:  The instructions were leave the last two remaining item to you.

What is the next step?",30/Mar/23 2:08 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] thanks for calling this out but I think there was a misunderstanding on your side. I said that I would take a look at these to confirm if there is anything that we could do as we ran out of time at our meeting. This does not mean that you should not look at these as they are still assigned to you. Please ensure that these are reviewed during your day tomorrow and an update that can assist the customer to move forwards with their issue.,"31/Mar/23 1:59 AM;5b17571b91981f4fdde632c1;* {{WGAWA0256E}}
** Not in support file
* {{WGAWA0384E}}
** Not in support file",31/Mar/23 8:00 PM;614dd566a995ad0073ec0622;Ok [~accountid:5b17571b91981f4fdde632c1] let me review and update.,"01/Apr/23 6:41 AM;5b17571b91981f4fdde632c1;* For ISVA Support

{noformat}  <Message ID=""WGAWA0256E   "" prefix=""yes"">
    <!-- code iswga_m_incorrect_usage -->
    <MsgText msgIndex=""256"" varFormat=""C"">
        Incorrect usage for the mesa_config <Variable formatSpec=""%1$s"">%s</Variable> command. (0x38a70100)

    </MsgText>
    <!-- Notes to translators: 1: the name of the command-->
    <Explanation>
      <p>The command line options which were supplied to the mesa_config program were not valid.</p>
    </Explanation>
    <AdminResponse>
      <p>Retry the command, supplying the correct command line options.</p>
    </AdminResponse>
    <!-- sub-component iswga_config_s -->
  </Message>{noformat}



{noformat}  <Message ID=""WGAWA0384E   "" prefix=""yes"">
    <!-- code iswga_s_cluster_master_not_available -->
    <MsgText msgIndex=""384"" varFormat=""C"">
        The cluster master cannot currently be reached, and must be reachable in order to complete the operation. (0x38a70180)

    </MsgText>
    <Explanation>
      <p>The operation failed because the cluster master cannot currently be reached.</p>
    </Explanation>
    <AdminResponse>
      <p>Ensure that the cluster master is running and can be reached.</p>
    </AdminResponse>
    <!-- sub-component iswga_config_s -->
  </Message>{noformat}



{noformat}  <Message ID=""WGAWA0003I   "" prefix=""yes"">
    <!-- code iswga_m_system_error -->
    <MsgText msgIndex=""3"" varFormat=""C"">
        An error occurred while executing the command: <Variable formatSpec=""%1$s"">%s</Variable> (0x<Variable formatSpec=""%2$x"">%x</Variable>) (0x38a70003)

    </MsgText>
    <!-- Notes to translators: 1: the name of the command; 2: the error value-->
    <Explanation>
      <p>An attempt to execute a system command failed.</p>
    </Explanation>
    <AdminResponse>
      <p>Check the system log for further information.</p>
    </AdminResponse>
    <!-- sub-component iswga_common_s -->
  </Message>{noformat}","01/Apr/23 10:00 AM;5b17571b91981f4fdde632c1;* Their logs shows a bunch of times where  {{139.113.34.80}} could not be contacted
** What did they do to fix previously?",03/Apr/23 8:15 PM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] I will review. A long case so it will take me time to confirm.,"04/Apr/23 11:14 PM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] The errors I posted originally in the description were errors returned in the cli. However I posted below to the PMR. However when I looked at the most recent support file there was no var directory. What I posted in the PMR as shown below looks like it would have came from the var directory. I looked again at the ecurep directory folder in question and unpacked the support zip file and it now shows the var directory. I did a quick search of the system message log and that error '{{WGAWA0003I}}' is present numerous times.





{noformat}Jan 25 03:32:40 mesa_config[22586]: Applying snapshot
Jan 25 03:32:40 mesa_config[22586]: Snapshot file: /var/support/isva_10.0.4.0_20221215-165436.434628_ISAM-DMZ-WS2-TEST.snapshot

Jan 25 03:32:57 mesa_translate[22903]: Error: built xmlns schema not found: /etc/schemas/cml/mga/runtime_profile/runtime_profile2_0_0.xsd

Jan 25 03:32:57 mesa_translate[22903]: Error: Unable to locate necessary attribute for DCA DB Auto-update

Jan 25 03:33:07 mesa_config[22905]: Error: WGAWA0003I   An error occurred while executing the command: /usr/bin/ssh -l cluster -o PreferredAuthentications=publickey -o BatchMode=yes -o CheckHostIP=no -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i /home/cluster/.ssh/id_rsa -p 22 -- 139.113.34.80 /usr/sbin/mesa_config isam.cluster flag set  runtime_profile
 (0x1)

Jan 25 03:33:08 mesa_config[22905]: Error: WGAWA0003I   An error occurred while executing the command: /usr/bin/ssh -l cluster -o PreferredAuthentications=publickey -o BatchMode=yes -o CheckHostIP=no -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i /home/cluster/.ssh/id_rsa -p 22 -- 139.113.34.80 /usr/sbin/mesa_config isam.cluster flag set  runtime_profile
 (0x1)

Jan 25 03:33:09 mesa_control[22893]: Policy changes committed
Jan 25 03:33:09 mesa_control[22893]: Policy changes have been kept.
Jan 25 03:33:09 mesa_control[22893]: Released lock: /var/run/mesa_control.translate.lock
Jan 25 03:33:09 mesa_control[22893]: LMI restart required
Jan 25 03:33:09 mesa_config[22586]: Invoking Snapshot Post functions
Jan 25 03:33:09 mesa_config[22586]: Snapshot applied successfully
Jan 25 03:33:09 mesa_config[22586]: Snapshot requires LMI restart{noformat}","04/Apr/23 11:21 PM;5b17571b91981f4fdde632c1;For the failing message that is in the log … what command failed?  From a high level what does the failing *command* do (*not* what the *whole command line* does)?

Correct the other two error messages are not present … did you find them?

I included all messages, so you could see what the potential responses.  Based on those  messages, what do you think the problem maybe?

Where is the support file for the master?",04/Apr/23 11:32 PM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] The other two error codes are not in the messages log. I will ask for a support file of the master. As to to your previous question; after we recommended customer remove node from cluster and re add it; the snapshot applied albeit with errors. As to what is happening i am unsure. The customer might be trying to do something not recommended. The applaince could be damaged and not totally recoverable. Or there is a ssl issue between the master and this node.,"04/Apr/23 11:35 PM;5b17571b91981f4fdde632c1;{quote}Or there is a ssl issues between the master and this node{quote}

👍 More specifically ssh (maybe ssl)

The other support file may help.

But would also suggest ip traces on both side during problem.",04/Apr/23 11:39 PM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] Should the pcap on both master and node be done while we attempt reapplication of snapshot on the affected node?,04/Apr/23 11:43 PM;5b17571b91981f4fdde632c1;Yes,11/Apr/23 8:50 PM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] The customer does not want to reapply fixpack as they are currently using the machine? Can we conduct some test without reapplication of snapshot?,18/Apr/23 11:13 PM;5b232b2fd85e5b59b066f57f;@whannon - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,24/Apr/23 6:07 PM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] Update?,"27/Apr/23 11:57 PM;5b17571b91981f4fdde632c1;{quote}The customer does not want to reapply fixpack as they are currently using the machine? Can we conduct some test without reapplication of snapshot?{quote}

* L2
** Please confirm no one else in the world is having this problem?
*** What do you think your chances are of recreating the problem?
**** What do you think your chances are of guaranteed identical root cause of the customer’s problem?

[~accountid:5b15d9e6dda5f94d06b985b4] 

* Do you have any suggestions?",08/May/23 9:17 PM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] [~accountid:5b15d9e6dda5f94d06b985b4] Will i just ask customer to close case until they can perform test as initially specified?,"12/May/23 9:13 AM;5b17571b91981f4fdde632c1;* My questions left unanswered
** So your call",28/Jun/23 2:52 AM;5b15d901fa615349cb01778b;case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"After upgrade to 10.0.5.0 customer observing following message WGAWA0678W - ""Due to consecutive failures, the appliance will not attempt to contact the update notification service for 24 hours.""",ISAMSUP-4888,287865,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,adarsh.nair,605c0c04b18de50071046740,adarsh.nair,605c0c04b18de50071046740,16/Mar/23 12:57 PM,11/Apr/23 8:25 AM,14/Jul/23 2:47 PM,11/Apr/23 8:25 AM,,Support,,0,,,,"After upgrade to 10.0.5.0 customer is observing  following message

WGAWA0678W - ""Due to consecutive failures, the appliance will not attempt to contact the update notification service for 24 hours.""

following ATP’s found in support file.

sys.direct.update.allowed = true
update.delete.failed.install = false

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012415449&path=TS012415449%2F0-all_data%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012415449&path=TS012415449%2F0-all_data%2F]

Can this message be ignored?
Is there any fix ?",,Dermot Daly,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS012415449, TS012500995",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,adarsh.nair,605c0c04b18de50071046740,,,,LAND TRANSPORT AUTHORITY OF SINGAPORE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012415449&path=TS012415449%2F0-all_data%2F,,,,,,,,,,,,,,,,,,,,,,,0|i19hfr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-16 21:37:45.928,,,,,"17/Mar/23 7:37 AM;5b15d94b6256d01ad54eb020;*Can this message be ignored*? Yes for now, since you are at the latest version.  But you will want to find out why you cannot connect to it.

*Is there any fix ?*    I think it is most likely a problem on your network.   

[https://www.ibm.com/docs/en/sva/10.0.5?topic=licensing-installing-updates|https://www.ibm.com/docs/en/sva/10.0.5?topic=licensing-installing-updates|smart-link] ","17/Mar/23 8:56 AM;5b15d954b0d76456f36daf33;It should be OK to ignore because starting 10.0.5.0, automatic updates are deprecated. We need to check if there is a way to suppress these notifications as they are no longer relevant ","21/Mar/23 10:44 PM;6194c472fe9f300068e5252f;[~accountid:5b15d954b0d76456f36daf33] I have another customer on case TS012500995, reporting the same issue as this. Can you please let me know how we can suppress these notifications? ",27/Mar/23 9:27 PM;6194c472fe9f300068e5252f;[~accountid:5b15d954b0d76456f36daf33] could you please let me know how we can suppress these notifications?,"28/Mar/23 10:20 AM;5b15d954b0d76456f36daf33;[~accountid:6194c472fe9f300068e5252f] you can set an advanced tuning parameter to disable the update notification service.

{noformat}Name:  wga_notifications.updates.enabled
Value : false{noformat}

Alternately, you can set the frequency of checks:

{noformat}Name: wga_notifications.updates.frequency
Value : Default is 24 (hours), -1 disables it{noformat}","29/Mar/23 1:40 AM;6194c472fe9f300068e5252f;thank you, Bhavan. I have let the customer know the same. ",11/Apr/23 8:25 AM;5b15d954b0d76456f36daf33;Both cases closed.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Webseal memory leak on ISVA v10.0.4.0 (High CPU Usage),ISAMSUP-4880,287428,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Peter Horner,5b15d9517dab4c51f61b5190,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,15/Mar/23 12:08 AM,13/Jul/23 1:40 PM,13/Jul/23 2:00 PM,,10.0.7,Support,,0,Growth,high_cpu,MemoryLeak,"The customer is facing an issue after they have upgraded the appliance firmware from v10.0.3.1 to v10.0.4.0, impacted ISVA in November 2022 it took more than 2 months to fill the RAM up to 80%. When they do a restart the high memory consumption decreased and it is stable upto 20%
Also the client says it's difficult to confirm, because they don't have a detailed memory consumption history from last November

Affected reverse proxy is {{webseald-EMPL-BRANCHES-SUG-PROD.conf -foreground -noenv}}

{{30182 30175 ivmgr S 21.9g 69.1 7 0.6 /opt/pdweb/bin/webseald -config etc/webseald-EMPL-BRANCHES-SUG-PROD.conf -foreground -noenv }}
{{28320 28313 ivmgr S 4848m 14.9 1 0.6 /opt/pdweb/bin/webseald -config etc/webseald-EMPL-EBE-SUG-PILOT.conf -foreground -noenv 3456 1 www-data S 7102m 21.8 5 0.0 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=false -Dsun.net.inetaddr.ttl=300 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true }}

After they have restarted the appliance with pstack_dump_fix.fixpack
{{27938 1 www-data S 7112m 21.8 7 1.1 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=false -Dsun.net.inetaddr.ttl=300 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.au 3735 3721 ivmgr S 9286m 28.5 4 0.0 /opt/pdweb/bin/webseald -config etc/webseald-EMPL-BRANCHES-SUG-PROD.conf -foreground -noenv 1991 1 www-data S 5936m 18.2 3 0.0 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Djava.security.properties=/opt/IBM/wlp/usr/servers/default/java.security -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dor}}

Attaching the screenshot of the graph of 30 days of gradually increasing also attaching the support file,

!Screenshot 2023-03-14 at 13.47.44.png|width=1775,height=723!

!Screenshot 2023-03-14 at 13.48.07.png|width=1738,height=754!

Without core dump files support file
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-02-16%2Fisva_10.0.4.0_20230216-185251_spsrd833.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-02-16%2Fisva_10.0.4.0_20230216-185251_spsrd833.support_unpack%2F]
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-02-16%2Fisva_10.0.4.0_20230216-185251_spsrd833.support_unpack%2Fiswga%2F&filepath=TS011967699%2F2023-02-16%2Fisva_10.0.4.0_20230216-185251_spsrd833.support_unpack%2Fiswga%2Fcpu.txt|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-02-16%2Fisva_10.0.4.0_20230216-185251_spsrd833.support_unpack%2Fiswga%2F&filepath=TS011967699%2F2023-02-16%2Fisva_10.0.4.0_20230216-185251_spsrd833.support_unpack%2Fiswga%2Fcpu.txt]

With core dump files and support file

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fcore_file_stack_trace%2F&filepath=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fcore_file_stack_trace%2Fcore_webseald.stack|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fcore_file_stack_trace%2F&filepath=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fcore_file_stack_trace%2Fcore_webseald.stack]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2F]

Please let me know if you need more information from client, thank you",,Aaron.Richie.Dias,Alan Wong,Asha Shivalingaiah,Ayush Singh,BRIANORO,cholt@us.ibm.com,Dermot Daly,Gabe,khansen,Nick Lloyd,Surya Prakash,Tushar Prasad,Virag Patel,,,6194c472fe9f300068e5252f,6092aca0f0db130069d19687,5af4ad7d4dd24c579110120b,61409dc154762c006932ffc7,6154906364ff01007106e189,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,ISAMSUP-4460,,,,,ISAMSUP-5188,,15/Mar/23 12:08 AM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-03-14 at 13.47.44.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190027,15/Mar/23 12:08 AM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-03-14 at 13.48.07.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190026,29/Mar/23 9:21 PM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-03-29 at 12.20.13.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193206,30/Mar/23 11:34 PM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-03-30 at 14.29.07.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/193444,,,,,,,,,,,,IJ47321,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011967699,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,BNP PARIBAS PARTNERS FOR INNOVAT,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-06-21T20:41:50.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fcore_file_stack_trace%2F&filepath=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fcore_file_stack_trace%2Fcore_webseald.stack

https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2F
",,,,,,,,,,,,,,,,,,,,,,,0|i19err:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-23 18:28:11.513,,,,,"15/Mar/23 12:12 AM;60f541a6d0134900692d91b7;Recent cpu.txt shows its gradually increasing, its in 13.0gb 

{noformat}Mem: 32682580K used, 240276K free, 22168K shrd, 567968K buff, 14282492K cached
CPU: 1.1% usr 0.0% sys 0.0% nic 98.8% idle 0.0% io 0.0% irq 0.0% sirq
Load average: 0.91 0.43 0.22 1/7052 27857
PID PPID USER STAT VSZ %VSZ CPU %CPU COMMAND
15563 1 www-data S 7116m 21.8 2 1.1 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=false -Dsun.net.inetaddr.ttl=300 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.au
31984 31966 ivmgr S 13.0g 41.2 0 0.0 /opt/pdweb/bin/webseald -config etc/webseald-EMPL-BRANCHES-SUG-PROD.conf -foreground -noenv
8696 1 www-data S 5935m 18.2 5 0.0 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Djava.security.properties=/opt/IBM/wlp/usr/servers/default/java.security -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dor{noformat}

also was able to find this information in var/msg.log,

{noformat}Jan 31 18:06:36 mesa_config[1168]: WGAWA0665I:: WGA_events:: |1=EMPL-BRANCHES-SUG-PROD,2=root|
Feb 2 23:41:59 mesa_config[27102]: WGAWA0666I:: WGA_events:: |1=EMPL-BRANCHES-SUG-PROD,2=admin@local|
Feb 2 23:42:04 wga_notifications: WGAWA0047W:: WGA_events:: |1=EMPL-BRANCHES-SUG-PROD,msg=Reverse Proxy is not running: EMPL-BRANCHES-SUG-PROD|
Feb 2 23:59:55 mesa_config[31932]: WGAWA0665I:: WGA_events:: |1=EMPL-BRANCHES-SUG-PROD,2=admin@local|
Feb 3 00:00:04 wga_notifications: WGAWA0648I:: WGA_events:: |1=EMPL-BRANCHES-SUG-PROD,msg=The reverse proxy has recovered: EMPL-BRANCHES-SUG-PROD|{noformat}","24/Mar/23 4:28 AM;5b17571b91981f4fdde632c1;* TS011918547
** Subject: ISVA 10.0.5.0 pdjrtecfg on openjdk fails with CLASS NOT FOUND excpetion
*** [https://w3.ibm.com/tools/caseviewer/case/TS011918547|https://w3.ibm.com/tools/caseviewer/case/TS011918547]
* Returned to L2","25/Mar/23 1:05 AM;60f541a6d0134900692d91b7;Hey[~accountid:5b17571b91981f4fdde632c1] I don't understand is this Memory leak issue related to this case TS011918547. Do you mean this Jira?
[https://cloudidentity.atlassian.net/browse/ISAMSUP-4693|https://cloudidentity.atlassian.net/browse/ISAMSUP-4693|smart-link] ","25/Mar/23 1:52 AM;5b17571b91981f4fdde632c1;{quote}TS011918547

Subject: ISVA 10.0.5.0 pdjrtecfg on openjdk fails with CLASS NOT FOUND excpetion

     [https://w3.ibm.com/tools/caseviewer/case/TS011918547|https://w3.ibm.com/tools/caseviewer/case/TS011918547]{quote}

* Let’s go over the Jira current facts
** Customer name: BNP PARIBAS PARTNERS FOR INNOVAT
** SalesForce case: TS011918547
* [https://w3.ibm.com/tools/caseviewer/case/TS011918547|https://w3.ibm.com/tools/caseviewer/case/TS011918547]
** What do you notice between
*** This Jira SalesForce Case number listed above
*** The SalesForce viewer case number in the link
* For SalesForce case: TS011918547
** What is the customer name?
** What is the problem description?
* Please correct","27/Mar/23 7:09 PM;60f541a6d0134900692d91b7;[~accountid:5b17571b91981f4fdde632c1] Oh yes sorry my mistake I put another case number here I corrected now, the customer name and problem description are same","28/Mar/23 2:02 AM;5b17571b91981f4fdde632c1;* Please do my readelf instructions
** [https://cloudidentity.atlassian.net/issues/?jql=|https://cloudidentity.atlassian.net/issues/?jql=]
*** JQL search
**** (project = 'ISAM Support') && ( (summary ~ 'readelf' || text ~ 'readelf') )
* From ECUREP linux machine
** Issue readelf command against core file
*** Count the number of “COUNT”
*  Post the “LOAD” results here
** It is the easiest way to checking this","29/Mar/23 9:21 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b17571b91981f4fdde632c1] I did like you said i just see 2 Jira cases,

!Screenshot 2023-03-29 at 12.20.13.png|width=1664,height=372!","29/Mar/23 10:20 PM;5b17571b91981f4fdde632c1;{quote}I did like you said i just see 2 Jira cases,{quote}

That is 1/3 of the instructions … you performed a search to find the readelf instructions.  That search ability is one of the most powerful steps for JIRA.



You must then open the work item and search for readelf instructions.

Then perform the remaining 2/3 steps.

","30/Mar/23 11:34 PM;60f541a6d0134900692d91b7;Hi[~accountid:5b17571b91981f4fdde632c1]  we did it sharing the screenshot and the path, let me know if you need any other information

!Screenshot 2023-03-30 at 14.29.07.png|width=1636,height=165!



[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fvar%2Fsupport%2Fcore_webseald.gz_unpack%2F&filepath=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fvar%2Fsupport%2Fcore_webseald.gz_unpack%2Fcorewebseald.out|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011967699&path=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fvar%2Fsupport%2Fcore_webseald.gz_unpack%2F&filepath=TS011967699%2F2023-03-13%2Fisva_10.0.4.0_20230313-224607_spsrq833.support_unpack%2Fvar%2Fsupport%2Fcore_webseald.gz_unpack%2Fcorewebseald.out]","05/Apr/23 8:18 PM;60f541a6d0134900692d91b7;Hi[~accountid:5b17571b91981f4fdde632c1] Any update on this case let me know if you need any further traces or information.

Thanks in advance!!!","12/Apr/23 1:25 AM;60f541a6d0134900692d91b7;Hi[~accountid:5b17571b91981f4fdde632c1] Any update on this case let me know if you need any further traces or information.

Thanks in advance!!!","14/Apr/23 8:44 PM;60f541a6d0134900692d91b7;Hi[~accountid:5b17571b91981f4fdde632c1] Any update on this case let me know if you need any further traces or information.

Thanks in advance!!!","17/Apr/23 11:48 PM;5b17571b91981f4fdde632c1;* Status and steps for all RAM (until we can identify fingerprint) in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]
** Start at MALLOC_CHECK_=3","25/Apr/23 4:01 AM;5b17571b91981f4fdde632c1;* For all WebSEAL memory issues
** Please add yourself as a watcher to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]
*** The top line of the comment for all WebSEAL memory watchers/issues will be something similar to
**** “For all WebSEAL memory issues”
*** Since the instructions are changing rapidly based on data and analysis
**** All status, instructions and updates will be done in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link] so everyone is working on the latest instructions
** This customer’s analysis will be provided in in this work item
*** Once root cause(s) are uniquely identified, then we may potentially collapse the same work items
** Please note for one customer so far we have two completely different problems","09/May/23 3:33 AM;5b17571b91981f4fdde632c1;[https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]

* From 2023-04-24 L3 instruction for each {color:#bf2600}*Critical and Required* {color}section
** Please provide current and complete status","30/May/23 3:14 AM;5b17571b91981f4fdde632c1;* All memory leaks must be watching [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link] for common instruction
* From [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]
** 2023-04-24 L3 instruction for each {color:#bf2600}*Critical and Required* {color}section
*** Please provide current and complete status","13/Jun/23 10:59 AM;5b17571b91981f4fdde632c1;* For ISVA Support only
** ssl-max-entries

{noformat}     17 [ssl]	ssl-max-entries 4096000
     14 [ssl]	ssl-max-entries 1048576
      4 [ssl]	ssl-max-entries 4096{noformat}

* 
** max-entries

{noformat}     14 [session]	max-entries 16384
     16 [session]	max-entries 4096{noformat}","21/Jun/23 2:48 PM;5b15d9517dab4c51f61b5190;Please open an APAR “Reverse proxy Memory leak processing JSON array data”

The core file shows the leak is related to JSON POST Data

We have reproduced the leak and found the cause of the leak

When  parsing a json array we are losing track of all but the first element

So when reverse proxy is finished processing a JSON array we are only freeing the first element.  - 

The size of the leak grows with the number of elements in the array as well as the number of name value pairs in each array element.

The customers leak is quite large

We have identified the code change that caused the issue. It was made in Dec 2021

The leak affects 10.0.4.0 10.0.5.0 and 10.0.6.0

IBM Internal Only

This is where we are leaking

{noformat}==15277== 1,689,757 (68,800 direct, 1,620,957 indirect) bytes in 4,300 blocks are definitely lost in loss record 1,876 of 1,876
==15277==    at 0x4C3BE4B: calloc (vg_replace_malloc.c:1328)
==15277==    by 0x4FF7021: makeJSONArray(_TOKENS**) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x4FF6E1F: makeJSONValue(_TOKENS**) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x4FF7A73: makeJSONNameValues(_TOKENS**) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x4FF7D0A: makeJSONNameValues(_TOKENS**) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x4FF66D4: makeJSONObject(_TOKENS**) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x4FF8E40: parseJSONData(char const*, unsigned long) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x4FEC79E: HTTPParser::parseJSONRequest(char const*, unsigned long, _JSONOBJECT**) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x4FA8FCE: prepare_azn_decision_info(HTTPRequest*, h_s_t*, long*) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x4FA59BC: requestAuthorize(h_s_t*, wand_client_ident_s_t*, Junction*, HTTPRequest*, HTTPResponse*, ResourceInfo*, ZUTF8String*, char const*, unsigned int*, unsigned int*, unsigned long*) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x5069B24: requestDispatch(h_s_t*, Junction*, HTTPRequest*, ClientOutputInfo&, HTTPResponse&, unsigned long*) (in /opt/pdweb/lib/libwsdaemon.so)
==15277==    by 0x5060BB6: zprocess_and_convert(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, nvlist_s_t*, unsigned long*) (in /opt/pdweb/lib/libwsdaemon.so)
==15277=={noformat}","21/Jun/23 3:36 PM;5b15d9517dab4c51f61b5190;The latest support file from Mar 13 shows 10.0.4.0 with no fixpacks

Is the customer still at 10.0.4.0 and have any fixpacks been installed since the last support file

I would prefer to build the fixpack for 10.0.4.0 IF1

I would recommend 10.0.4.0 IF1 as it contains (among others)

|IJ39126|THREAD LEAK IN AAC/FEDERATION RUNTIME LEADS TO OOM ERROR AND CRASH|

Is customer willing to install 10.0.4.0 IF1 (in which case I will build fix based on the  IF1 source) which will require IF1 already installed

or do they want the fix for current 10.0.4.0 GA with no other fixpacks","22/Jun/23 1:23 AM;60f541a6d0134900692d91b7;Hey [~accountid:5b15d9517dab4c51f61b5190] Thanks for the information, yes they are still at 10.0.4.0 previously we suggested them MALLOC_CHECK_=3 but they didn't update the case after that I guess it has not crashed them yet. I will ask the client if they are willing to update to v10.0.4.0 IF1 and will update you","23/Jun/23 9:16 AM;5b15d9e44c4ed14b83af8723;[~accountid:60f541a6d0134900692d91b7] did you open the APAR yet? If not, please create it and note the ID number here. Ping me if you need assistance.","23/Jun/23 6:41 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e44c4ed14b83af8723] No I have not opened an APAR, I was confirming with the client if they would upgrade to v10.0.4 IF1 like peter mentioned and was waiting for their response",23/Jun/23 11:16 PM;5b15d9e44c4ed14b83af8723;I created APAR IJ47321 for this issue.,"28/Jun/23 12:24 PM;5b15d9517dab4c51f61b5190;The fixpack for 10.0.4.0 IF1 is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-5188|https://cloudidentity.atlassian.net/browse/ISAMSUP-5188|smart-link]  

I will build  a fixpack for 10.0.4.0 GA only if you request it","28/Jun/23 8:26 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9517dab4c51f61b5190] Thank you for the information, I have not heard back from the customer about any update
I followed back with them and still no response, I will just wait for this week and if no update from them we can close this case","29/Jun/23 6:06 PM;60f541a6d0134900692d91b7;Hey[~accountid:5b15d9517dab4c51f61b5190] The client was asking if this issue is fixed in the latest v10.0.6, Do we need a fix on this latest ISVA version as well?

As they plan to directly upgrade to the latest version","29/Jun/23 7:37 PM;5b15d9517dab4c51f61b5190;It is not fixed in 10.0.6.0

I will be building a fixpack for 10.0.6.0","03/Jul/23 7:05 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9517dab4c51f61b5190] Client confirmed they are planning to upgrade to v10.0.6, they said they can keep it under control by performing restarts when required as its an intermittent issue","06/Jul/23 9:22 PM;60f541a6d0134900692d91b7;Hey [~accountid:5b15d9517dab4c51f61b5190] is this the same APAR for v10.0.6 ? In the link, it is mentioned it will be fixed in v10.0.7

[https://www.ibm.com/support/pages/apar/IJ47321|https://www.ibm.com/support/pages/apar/IJ47321]",07/Jul/23 1:59 PM;5b15d9517dab4c51f61b5190;It will be fixed in 10.0.7.0. But I will be creating a fixpack for 10.0.6.0,"13/Jul/23 1:40 PM;5b15d9517dab4c51f61b5190;[~accountid:60f541a6d0134900692d91b7] 

The fixpack for 10.0.6.0 is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-5188|https://cloudidentity.atlassian.net/browse/ISAMSUP-5188|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Getting error on adding new node in existing cluster,ISAMSUP-4876,287322,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,14/Mar/23 3:31 PM,03/Jul/23 10:19 PM,14/Jul/23 2:47 PM,03/Jul/23 10:19 PM,,Support,,0,,,,"Customer has cluster of 5 nodes with Oracle as config and runtime database.
First 2 nodes have been added with hostname as cluster identifier.
and 3 nodes with IP.
cluster has been recently upgraded to 10.0.2
Customer is now adding new node in existing cluster but getting below error on LMI
DB details have been replicated on new node. All the functonality is working as expected.
Only concern with error coming on LMI.

System Error

Error: DPWAP0003I An error occurred while executing the command: /usr/sbin/mesa_control commit /tmp/clusterp (0xffffffff)
WGAWA0581I Converting the mode of the 'Configuration' database from 'Standalone' to 'None'.
WGAWA0581I Converting the mode of the 'High Volume' database from 'Standalone' to 'None'.
WGAWA0598I Deleting the 'Configuration' database in preparation for a new mode.
Error: DPWAP0003I An error occurred while executing the command: /bin/chown -Rh -- pgresql:pgresql /var/postgresql/config (0x1)
WGAWA0598I Deleting the 'High Volume' database in preparation for a new mode.
Error: DPWAP0003I An error occurred while executing the command: /bin/chown -Rh -- pgresql:pgresql /var/postgresql/hvdb (0x1)
Error: DPWAP0003I An error occurred while executing the command: /usr/sbin/sqlfuse /sqlfuse/fs -o use_ino,allow_other,default_permissions,big_writes (0x1)
Error: WGAWA0003I An error occurred while executing the command: /usr/bin/rsync -avz -e ssh -o PreferredAuthentications=publickey -o BatchMode=yes -o CheckHostIP=no -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i /home/cluster/.ssh/id_rsa -p 22 -- /tmp/clusterp/cml/isam/cluster/cluster7_0_0.xml [cluster@LQP2DTSAPCIAM021.adib.co.ae|mailto:cluster@LQP2DTSAPCIAM021.adib.co.ae]:/var/isam/cluster/policies/cml/isam/cluster/cluster7_0_0.xml
(0xff)
kex_exchange_identification: read: Connection reset by peer
rsync: connection unexpectedly closed (0 bytes received so far) [sender]
rsync error: unexplained error (code 255) at io.c(226) [sender=3.1.3]
Error: WGAWA0654E The server, [LQP2DTSAPCIAM021.adib.co.ae|http://LQP2DTSAPCIAM021.adib.co.ae], could not be contacted.
Error: WGAWA0010E An internal error has occurred (/workspace/src/appliance/app-core/modules/config_wga_rte.cpp:1285).
Error: WGAWA0010E An internal error has occurred (/workspace/src/appliance/app-core/modules/config_wga_rte.cpp:1285).
Error: WGAWA0010E An internal error has occurred (/workspace/src/appliance/app-core/modules/config_wga_rte.cpp:3972).
chown: /var/postgresql/config: No such file or directory
chown: /var/postgresql/hvdb: No such file or directory
fuse: device not found, try 'modprobe fuse' first

Added hostname [LQP2DTSAPCIAM021.adib.co.ae|http://LQP2DTSAPCIAM021.adib.co.ae] entry in host file. Verified nslookup output as well.
Also added node post disabling ssl certificate replication still same error.

Customer is asking if we can ignore LMI error. I am afraid that should not create any problem in future.

Support files available in Ecurep.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012157461&path=TS012157461%2F2023-03-03%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012157461&path=TS012157461%2F2023-03-03%2F]",,Tushar Prasad,,,,,,,,,,,,,,,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4926,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012157461,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nilesh Amrutkar,5b1757156d76184b7d98a0c3,,,,ABU DHABI ISLAMIC BANK NEAR CENTRAL BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19e4n:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-03-15 00:59:39.613,,,,,"15/Mar/23 10:59 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

I don't see LMI errors in - 
 /ecurep/sf/TS012/157/TS012157461/2023-03-03/isva_10.0.2.0_20230303-103706_LQP2DTSAPCIAM02.adib.co.ae.support_unpack/tmp/liberty_dump.zip_unpack/workarea/org.eclipse.osgi/68/data
and 
/ecurep/sf/TS012/157/TS012157461/2023-03-03/isva_10.0.2.0_20230303-012634_LQP2DTSAPCIAM12.support_unpack/tmp/liberty_dump.zip_unpack

Am I supposed to be looking in a different file?
Also - Was this [LQP2DTSAPCIAM021.adib.co.ae|http://LQP2DTSAPCIAM021.adib.co.ae] added after upgrade or before upgrade? 
Is the new side being added - [LQP2DTSAPCIAM021.adib.co.ae|http://LQP2DTSAPCIAM021.adib.co.ae] or a different IP address? 

Have they tried removing and reading the node that is not resolved? 

Could be related to -
[https://cloudidentity.atlassian.net/browse/ISAMSUP-3393|https://cloudidentity.atlassian.net/browse/ISAMSUP-3393|smart-link]  

However will need to attempt a recreate and see if it is the same issue.","15/Mar/23 7:05 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] 
You could see this error in /var/log/messages

isva_10.0.2.0_20230303-012634_LQP2DTSAPCIAM12.support_unpack/var/log/messages.1:Mar  3 01:24:29 mesa_config[4736]: Error: WGAWA0654E   The server, [LQP2DTSAPCIAM021.adib.co.ae|http://LQP2DTSAPCIAM021.adib.co.ae], could not be contacted.

This was [LQP2DTSAPCIAM021.adib.co.ae|http://LQP2DTSAPCIAM021.adib.co.ae] there before upgrade as well. 

Existing cluster has never tried to break and rejoin. Only new node has been removed and readded to recreate error.","16/Mar/23 9:09 AM;5af4ad7d4dd24c579110120b;[~accountid:5b1757156d76184b7d98a0c3] 

You mention - 

{noformat}Customer is asking if we can ignore LMI error. {noformat}

Which LMI error?
Was - Error: WGAWA0654E The server, [LQP2DTSAPCIAM021.adib.co.ae|http://LQP2DTSAPCIAM021.adib.co.ae], could not be contacted. in LMI? 
Is this when they add the new node? 

Is it a possibility that they can remove and read - [LQP2DTSAPCIAM021.adib.co.ae|http://LQP2DTSAPCIAM021.adib.co.ae] ? 

If they are using external DB’s  the Postgres logs don't make sense.
","20/Mar/23 11:24 AM;5af4ad7d4dd24c579110120b;<Notes>

{{172.29.25.131}} 

{{172.29.25.235}} 

{{LQP2DTSAPCIAM021.adib.co.ae}}

{{LQP2DTSAPCIAM02.adib.co.ae}} 

Do these 4 entries all map to primary master? 

{noformat}  
  
<host addr=""172.29.25.131"">
    <hostnames name=""isamaaclmi""/>
    <hostnames name=""isamaaclmi.adib.co.ae""/>
    <hostnames name=""isampdadmin""/>
    <hostnames name=""LQP2DTSAPCIAM021.adib.co.ae""/>
</host>
    
hosts.6.address = 172.29.25.131
hosts.6.name = isamaaclmi
hosts.6.name = isamaaclmi.adib.co.ae
hosts.6.name = isampdadmin
hosts.6.name = LQP2DTSAPCIAM021.adib.co.ae


    
    <host addr=""172.29.25.235"">
        <hostnames name=""isamaaclmi.adib.co.ae""/>
        <hostnames name=""isamaaclmi""/>
        <hostnames name=""isampdadmin""/>
        <hostnames name=""LQP2DTSAPCIAM12""/>
    </host>
hosts.10.address = 172.29.25.131
hosts.10.name = LQP2DTSAPCIAM021.adib.co.ae
hosts.10.name = LQP2DTSAPCIAM02.adib.co.ae


<masters primary=""LQP2DTSAPCIAM021.adib.co.ae"" primary_seq_num=""3"" master_ere=""172.29.25.129""/>

LQP2DTSAPCIAM021.adib.co.ae,
[flags]
runtime_profile = no
runtime_profile_reload_required = no
clear_databases = yes

LQP2DTSAPCIAM031.adib.co.ae,
[flags]
runtime_profile = no
runtime_profile_reload_required = no
clear_databases = no{noformat}

{noformat}
[mgr]
isPrimary = no
isLocal = no
isSqlfuse = yes
primary = LQP2DTSAPCIAM021.adib.co.ae
primary_seq_num = 3
secondary =
tertiary =
quaternary =
first-port = 2020
sshd-port = 22
mga-enabled = yes

[cfgdb]
isLocal = no

[hvdb]
isLocal = no

[dsc]
enabled = no
node-id = 0
external-port = 2026
{noformat}

Notes:

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4171|https://cloudidentity.atlassian.net/browse/ISAMSUP-4171|smart-link] ","20/Mar/23 12:05 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

You might be hitting the same problem as this Jira item here - 

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4171|https://cloudidentity.atlassian.net/browse/ISAMSUP-4171|smart-link]  

It could be related to static routes - 

[https://www.ibm.com/support/pages/node/6606671|https://www.ibm.com/support/pages/node/6606671|smart-link]  

can you check if cleaning up the bad static routes on the appliance with this error helps.",23/Mar/23 3:28 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] I could not find any error related to bad static routes in support file. Though I had asked customer to verify with network team and no issues in static route.,23/Mar/23 3:30 PM;5af4ad7d4dd24c579110120b;Did you check if they have a support file from their before upgrade? ,28/Mar/23 2:30 PM;5b1757156d76184b7d98a0c3;Sent Calender invite for webex tomorrow(29th) at 11:30AM IST,"03/Apr/23 11:43 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4926|https://cloudidentity.atlassian.net/browse/ISAMSUP-4926|smart-link]  

Here is a fixpack, can you test it in your environment before yo send it off to customer to test.

Thanks","05/Apr/23 8:04 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] I could recreate issue. 

I have installed fixpack on problematic node but could not help to join cluster. 

Do I need to install fixpack on primary as well?",05/Apr/23 8:06 PM;5af4ad7d4dd24c579110120b;[~accountid:5b1757156d76184b7d98a0c3] yes,"13/Apr/23 9:10 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] fixpack didnt work
I could see same issue on 10.0.4 as well.","14/Apr/23 8:02 AM;5af4ad7d4dd24c579110120b;[~accountid:5b1757156d76184b7d98a0c3] 

Let me know if we get on web ex today.","17/Apr/23 6:31 PM;5af4ad7d4dd24c579110120b;<Notes>

Had a web ex
Modifying host file entry allowed adding the node without any error.
Nilesh will be running a few more tests in 10040 fresh install and an upgrade with the same change to see the behavior.","19/Apr/23 9:00 PM;5b1757156d76184b7d98a0c3;Booted appliance on 10.0.2

Modified hosts entry but that could not solve the issue. Not sure how it worked on webex.",19/Apr/23 9:05 PM;5af4ad7d4dd24c579110120b;[~accountid:5b1757156d76184b7d98a0c3] on a fresh install of 10020 not an upgrade so you see the same issue,19/Apr/23 9:09 PM;5b1757156d76184b7d98a0c3;I need to reinstall appliance which will Take time. But current setup won't be available to test fix if we need to.,16/May/23 4:01 PM;5b1757156d76184b7d98a0c3;[~accountid:5af4ad7d4dd24c579110120b] any update on debug fixpack to check routes ? ,"16/May/23 4:10 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

I have tested the upgrade from 9060IF2 to 10.0.4.0 with the cluster name different to the appliance hostname.
I did not see the issue.

Next step as discussed earlier on slack are-

# A Fresh install of 10020/10040 to see if the issue can be can be recreated
# A debug fixpack to see some host side logs

test the fresh install if possible, I’ll have to revisit what needs to be traced to see where it is falling out which might take sometime since I don't have a recreate.","17/May/23 10:41 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b1757156d76184b7d98a0c3] 

I have an environment set up with hostname and cluster identifier different on 907.

Let me know when you are online today for a web ex, we can go over the environment before I upgrade if we are on the same page.","03/Jul/23 7:21 PM;5b1757156d76184b7d98a0c3;Asked customer to break the cluster

Made the primary as standalone node. Then created cluster with appliance hostname. Added remaining nodes.

Which solved the issue. If issue persists customer will reopen case. For now this Jira can be closed.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"Access to Java class ""com.ibm.security.access.ciclient.CiClientBase$AccessToken"" is prohibited.",ISAMSUP-4863,287067,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,11/Mar/23 1:23 AM,23/May/23 12:11 AM,14/Jul/23 2:47 PM,23/May/23 12:11 AM,10.0.6,,,0,,,,"Hi,

Customer raised this case and having issue with:

Access to Java class ""com.ibm.security.access.ciclient.CiClientBase$AccessToken"" is prohibited.

They are getting this error when they try to run this infomap rule:

{noformat}importPackage(Packages.com.ibm.security.access.ciclient);
importPackage(Packages.com.ibm.security.access.server_connections);
importClass(Packages.com.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils);

IDMappingExtUtils.traceString(""JonatanTest Mappingrule start"");

var conn = ServerConnectionFactory.getCiConnectionByName(""gjensidige.verify.ibm.com"");
var resp = CiClientV2.getAccessToken(conn);
var json = getJSON(resp);

IDMappingExtUtils.traceString(""Jonatan: "" + json);
IDMappingExtUtils.traceString(""JonatanTest Mappingrule end"");
success.setValue(true);{noformat}

Also they have tried CiClient.getAccessToken, same result

After checking below document, getAccessToken is not listed as an accessible method for InfoMap, nor does it appear to be on the allowed list

[https://www.ibm.com/docs/en/sva/10.0.5?topic=cimam-embedded-cloud-identity-api-calls-in-info-map-mechanism|https://www.ibm.com/docs/en/sva/10.0.5?topic=cimam-embedded-cloud-identity-api-calls-in-info-map-mechanism|smart-link] 

But when I checked Javadoc  it shows getaccesstoken is a valid method in the screenshot

!Screenshot 2023-03-10 at 10.51.34.png|width=1737,height=767!",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,11/Mar/23 1:23 AM;ug:0d611a25-0ff2-486d-afc9-64342bb96b9c;Screenshot 2023-03-10 at 10.51.34.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/189473,,,,,,,,,,,,,,,IJ46256,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012316911,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,TIETOEVRY NORWAY AS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-04-07T02:49:23.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19cl7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-10 17:08:47.881,,,,,"11/Mar/23 3:08 AM;5b15d94b6256d01ad54eb020;com.ibm.security.access.ciclient.CiClient

com.ibm.security.access.ciclient.CiClientV2 

are both already allowed. It looks like we need to add com.ibm.security.access.ciclient.CiClientBase   to the list of allowed classes.   Which should be ok but we’ll need to confirm it first.","14/Mar/23 7:22 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d94b6256d01ad54eb020] 
Any update on this ?",14/Mar/23 11:29 PM;5b15d94b6256d01ad54eb020;Nothing new at this time.  I’m trying to find out why that class was prohibited but I don’t have an answer yet.,"21/Mar/23 10:21 PM;627a7fb30d1e73006f7c21cf;Hi [~accountid:5b15d94b6256d01ad54eb020] 
Any update on this ?","22/Mar/23 6:06 AM;5b15d94b6256d01ad54eb020;Hi [~accountid:627a7fb30d1e73006f7c21cf]  yes after looking into this, it will be little more involved than simply allowing that class.   You can open an APAR.    

Is the customer wanting a fix pack for the issue?  If so I need a complete list of all the fix packs they are currently using and the exact version they need the fix pack for.  ","22/Mar/23 7:26 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d94b6256d01ad54eb020] 

 Current fixpacks installed: 

10.0.4.0_IF1

SCIM_Groups_Fetch_Members_Fix_10040

IJ44133_10040IF1

And the version should be for version 10.0.4",23/Mar/23 1:28 AM;5b15d94b6256d01ad54eb020;[~accountid:627a7fb30d1e73006f7c21cf] I’m going to work on this today.  We are going to need to test this. Have you recreated the problem?,"23/Mar/23 1:33 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d94b6256d01ad54eb020] 
I have not recreated the problem but when I checked Javadoc  it shows getaccesstoken is a valid method..","23/Mar/23 1:39 AM;5b15d94b6256d01ad54eb020;We already determined that it was supported, I’m concerned about testing the fix. ",01/Apr/23 12:05 AM;5b15d94b6256d01ad54eb020;[~accountid:627a7fb30d1e73006f7c21cf] did you open an APAR on this yet?,"01/Apr/23 12:11 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d94b6256d01ad54eb020] 

I will open the APAR now","01/Apr/23 1:35 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 19a928ec13fd53fd7d9e0b5ab4e901f17ed2b9e4
   * description: Backported development version of fix for ISAMSUP-4863

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87906935.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4906) which we publish.","01/Apr/23 3:07 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 19a928ec13fd53fd7d9e0b5ab4e901f17ed2b9e4
   * description: Backported development version of fix for ISAMSUP-4863

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87915564.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230331170420-19a928ec-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","01/Apr/23 4:33 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 19a928ec13fd53fd7d9e0b5ab4e901f17ed2b9e4
   * description: Backported development version of fix for ISAMSUP-4863

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87921994.


This build has not been published as the commit is not currently within a branch (20230331170420-19a928ec-support) which we publish.","03/Apr/23 8:53 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d94b6256d01ad54eb020] 
APAR created successfully with number: IJ46256{color:#ffffff}r: IJ46256{color}","07/Apr/23 2:49 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 19a928ec13fd53fd7d9e0b5ab4e901f17ed2b9e4
   * description: Backported development version of fix for ISAMSUP-4863

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/79019.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230406164620-19a928ec-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","07/Apr/23 4:05 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 19a928ec13fd53fd7d9e0b5ab4e901f17ed2b9e4
   * description: Backported development version of fix for ISAMSUP-4863

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/79173.


This build has not been published as the commit is not currently within a branch (20230406164620-19a928ec-support) which we publish.","07/Apr/23 5:24 AM;5b15d94b6256d01ad54eb020;The link to the 10.0.4.0  fix pack is in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4906|https://cloudidentity.atlassian.net/browse/ISAMSUP-4906|smart-link] 

L2 will need to this since I haven’t recreated it.  Development actually provided the final fix and I think it should work.","22/May/23 12:56 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020] the case associated with this Jira item has been closed. Can you please confirm the status of the fix by updating the Fix Version, closing the APAR and closing the Jira ticket if it can be.",23/May/23 12:11 AM;5b15d94b6256d01ad54eb020;[~accountid:5ac57757d9a96536d1f0daa9] this is fixed in 10.0.6.0. Closing this Jira,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"AAC message log flooded with Info messages ""JDBC is Configed for DMAP""",ISAMSUP-4860,286908,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,10/Mar/23 4:28 AM,22/Mar/23 9:44 PM,14/Jul/23 2:47 PM,22/Mar/23 9:44 PM,,Support,20/Mar/23 12:00 AM,0,,,,"Client (Customer - IBM Expert Labs) can see this issue in 10.0.3.1 but apparently is not happening in 10.0.5.0 (IBM Expert Labs local test lab). ISVA L2 (i.e. me) has been looking for same/similar past cases in Support Search, but not seeing any related cases, so asking here, please.

Seeing very high % of the runtime message logs taken up with this excessive logging i.e.
^[1:iei81220@debug71]:/ecurep/sf/TS012/374/TS012374082/2023-03-09/isva_10.0.3.1_20230309-092612_s002aa237paaf.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs $ wc messages.log^
  ^589665 5966312 73711024 messages.log^
^092612_s002aa237paaf.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs $ grep ""JDBC is Configed for DMAP"" messages.log | wc^
  ^515600 5671600 64224778^

Or as an example 15 occurrences over a split second i.e. 
{{com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:09:950 CET] 0000801e }}
{{com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:016 CET] 000080a0 com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:023 CET] 0000809f com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:038 CET] 0000801e com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:060 CET] 000080a1 com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:061 CET] 0000809f com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:126 CET] 0000801e com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:126 CET] 0000801d com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:151 CET] 0000801d com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:152 CET] 00008048 com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:153 CET] 00007fb6 com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:348 CET] 000080a1 com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:458 CET] 0000801d com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:872 CET] 000080a0 com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:875 CET] 000080a0 com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:10:955 CET] 0000809e com.tivoli.am.fim.distributed.LibertyDistributedMapFactory   I JDBC is Configed for DMAP [3/8/23, 7:48:11:042 CET] 000080a0 }}

To add, this issue occurred post resolution on SF case TS012090976 =
""When DMAP is enabled as cookieless option and webseal junction points to multiple AAC backends, login fails""

Customer was told to refer to ISVA Advanced configuration properties at [https://www.ibm.com/docs/en/sva/10.0.3?topic=ac-advanced-configuration-properties.|https://www.ibm.com/docs/en/sva/10.0.3?topic=ac-advanced-configuration-properties.|smart-link] and the summary resolution in TS012090976 was to set session.store = DMAP",,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4865,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012374082 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,ADB-KONTORET,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-03-10T14:45:33.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"Unix = /ecurep/sf/TS012/374/TS012374082/2023-03-09/isva_10.0.3.1_20230309-092612_s002aa237paaf.support_unpack/
Citrix = S:\sf\TS012\374\TS012374082\2023-03-09\isva_10.0.3.1_20230309-092612_s002aa237paaf.support_unpack\",,,,,,,,,,,,,,,,,,,,,,,0|i19bmj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-03-10 00:22:09.809,,,,,"10/Mar/23 10:22 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build error occurred while generating the build for the following commit: 
   * id: 237c63e4377c5c67db91636c06cfc504d03dcc35
   * description: ISAMSUP-4860_10031 fixpack buid

Failed to create the release in the isam repo!

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86403189.

","10/Mar/23 2:45 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 6571182c7f6b122ca967f46a1a259f7d5be7ba38
   * description: ISAMSUP-4860_10031 build

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86411491.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230310044416-6571182c-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","10/Mar/23 4:01 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 6571182c7f6b122ca967f46a1a259f7d5be7ba38
   * description: ISAMSUP-4860_10031 build

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86414240.


This build has not been published as the commit is not currently within a branch (20230310044416-6571182c-support) which we publish.","12/Mar/23 5:59 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:6154906364ff01007106e189] 

Here is a fixpack [https://cloudidentity.atlassian.net/browse/ISAMSUP-4865|https://cloudidentity.atlassian.net/browse/ISAMSUP-4865|smart-link] 
The change is com.tivoli.am.fim.* set to INFO will not add this trace in the config only when set to FINEST these logs will appear in the trace file.

Let me know how you go with this.

Thanks",20/Mar/23 7:29 PM;6154906364ff01007106e189;Waiting on client feedback re dmap_aac_logs_supress_10031.fixpack deployment.,"20/Mar/23 9:03 PM;6154906364ff01007106e189;Hi [~accountid:5af4ad7d4dd24c579110120b] can you advise please wrt client query on this dmap logs fixpack and ISVA 10.0.5.0 i.e.

----

“_We are upgrading to 10.0.5 on Sunday. Is this fixed in 10.0.5 or should we apply the fix prior to upgrade and will it stay installed or be overwritten by the upgrade._” ","21/Mar/23 9:45 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6154906364ff01007106e189] 

It is fixed in 10050, they won't need a fixpack.
Logs will appear if the level is set to FINEST.

Thanks","22/Mar/23 9:44 PM;6154906364ff01007106e189;TS012374082  case is now closed, closing off this Jira work item as well.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Lmi unavailable; Cli available,ISAMSUP-4859,286860,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,09/Mar/23 10:32 PM,03/May/23 2:06 AM,14/Jul/23 2:47 PM,03/May/23 2:06 AM,,,,0,,,,"Lmi became unavailable for at least five appliances in this non-prod environment.  Cli was available and after reboot via cli, issue resolved. 

I initially found these errors below on at least one of the machines:

{noformat}[1/31/23, 10:23:03:759 CET] 0000011e id=00000000 com.ibm.ws.channel.ssl.internal.SSLHandshakeErrorTracker     E CWWKO0801E: Unable to initialize SSL connection. Unauthorized access was denied or security settings have expired. Exception is javax.net.ssl.SSLHandshakeException: no cipher suites in common
	at java.base/sun.security.ssl.Alert.createSSLException(Unknown Source)
	at java.base/sun.security.ssl.Alert.createSSLException(Unknown Source)
	at java.base/sun.security.ssl.TransportContext.fatal(Unknown Source)
	at java.base/sun.security.ssl.TransportContext.fatal(Unknown Source)
	at java.base/sun.security.ssl.TransportContext.fatal(Unknown Source)
	at java.base/sun.security.ssl.ServerHello$T12ServerHelloProducer.chooseCipherSuite(Unknown Source)
	at java.base/sun.security.ssl.ServerHello$T12ServerHelloProducer.produce(Unknown Source)
	at java.base/sun.security.ssl.SSLHandshake.produce(Unknown Source)
	at java.base/sun.security.ssl.ClientHello$T12ClientHelloConsumer.consume(Unknown Source)
	at java.base/sun.security.ssl.ClientHello$ClientHelloConsumer.onClientHello(Unknown Source)
	at java.base/sun.security.ssl.ClientHello$ClientHelloConsumer.consume(Unknown Source)
	at java.base/sun.security.ssl.SSLHandshake.consume(Unknown Source)
	at java.base/sun.security.ssl.HandshakeContext.dispatch(Unknown Source)
	at java.base/sun.security.ssl.SSLEngineImpl$DelegatedTask$DelegatedAction.run(Unknown Source)
	at java.base/sun.security.ssl.SSLEngineImpl$DelegatedTask$DelegatedAction.run(Unknown Source)
	at java.base/java.security.AccessController.doPrivileged(Unknown Source)
	at java.base/sun.security.ssl.SSLEngineImpl$DelegatedTask.run(Unknown Source)
	at com.ibm.ws.channel.ssl.internal.SSLUtils.handleHandshake(SSLUtils.java:751)
	at com.ibm.ws.channel.ssl.internal.SSLConnectionLink.readyInbound(SSLConnectionLink.java:589)
	at com.ibm.ws.channel.ssl.internal.SSLConnectionLink.ready(SSLConnectionLink.java:336)
	at com.ibm.ws.tcpchannel.internal.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:167)
	at com.ibm.ws.tcpchannel.internal.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:75)
	at com.ibm.ws.tcpchannel.internal.WorkQueueManager.requestComplete(WorkQueueManager.java:504)
	at com.ibm.ws.tcpchannel.internal.WorkQueueManager.attemptIO(WorkQueueManager.java:574)
	at com.ibm.ws.tcpchannel.internal.WorkQueueManager.workerRun(WorkQueueManager.java:958)
	at com.ibm.ws.tcpchannel.internal.WorkQueueManager$Worker.run(WorkQueueManager.java:1047)
	at com.ibm.ws.threading.internal.ExecutorServiceImpl$RunnableWrapper.run(ExecutorServiceImpl.java:238)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at java.base/java.lang.Thread.run(Unknown Source) {noformat}

Subsequently on advisement I investigated the following error:

{noformat}[2/17/23, 12:18:04:800 CET] 00000029 com.ibm.ws.logging.internal.impl.IncidentImpl I FFDC1015I: An FFDC Incident has been created: ""java.io.IOException: Broken pipe com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter 260"" at ffdc_23.02.17_12.18.04.0.log [2/17/23, 12:18:04:809 CET] 00000029 com.ibm.ws.webcontainer.util.ApplicationErrorUtils E SRVE0777E: Exception thrown by application class 'sun.nio.ch.FileDispatcherImpl.write0:-2' java.io.IOException: Broken pipe{noformat}

I found no OutOfMemory errors to identify any memory issues. They are 2gb machines; would that be an issue?",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,28/Mar/23 6:25 PM;ug:2ce3c75f-9379-41c1-9fd8-86100213c299;image-20230328-082527.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/192937,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012050451 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,R+V Allgemeine Versicherung AG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19bc3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-09 23:18:48.237,,,,,"10/Mar/23 9:18 AM;5b15d954b0d76456f36daf33;What does LMI unavailable actually mean? No response in any browser (what if any were the errors)? 

Did they check from the CLI if the <management ip>:443 connection was open? 

What is the date/time we are looking at when this happened? So you can look for any other errors around that time in the LMI logs.","14/Mar/23 9:29 PM;614dd566a995ad0073ec0622;Hello,



They opened the file stating lmi was unavailable with below errors plus responses to the below curl commands. They didn’t check cli was open at the time. It was I whom advised to test the cli which was ok and allowed them to reboot and recover the lmi. Issue was first noticed on the 24th of January. Upgrade from 10.0.2 to 10.0.4 occurred after that. Issue happened again on the 31st of January.  Reboot via from 9th February started to resolve the issue.  The errors I attached initially to the case are all I found?



[https://rwsal01/|https://rwsal01/] Error: Secure connection failed An error occurred when connecting to rwsal01. PR_END_OF_FILE_ERROR

[https://rwsal02/|https://rwsal02/] Error: Secure connection failed An error occurred when connecting to rwsal01. PR_END_OF_FILE_ERROR > 

{noformat}curl -vvv https://rwsal01/isam/ssl_certificates * About to connect() to rwsal01 port 443 (#0) * Trying 10.192.167.152... * Connected to rwsal01 (10.192.167.152) port 443 (#0) * Initializing NSS with certpath: sql:/etc/pki/nssdb * CAfile: /etc/pki/tls/certs/ca-bundle.crt CApath: none * NSS error -5938 (PR_END_OF_FILE_ERROR) * Encountered end of file * Closing connection 0 curl: (35) Encountered end of file {noformat}

{noformat}> curl -vvv https://rwsal02/isam/ssl_certificates * About to connect() to rwsal02 port 443 (#0) * Trying 10.192.167.153... * Connected to rwsal02 (10.192.167.153) port 443 (#0) * Initializing NSS with certpath: sql:/etc/pki/nssdb * CAfile: /etc/pki/tls/certs/ca-bundle.crt CApath: none * NSS error -5938 (PR_END_OF_FILE_ERROR) * Encountered end of file * Closing connection 0 curl: (35) Encountered end of file{noformat}

{noformat}curl -vvv https://rwsa01/isam/ssl_certificates * About to connect() to rwsa01 port 443 (#0) * Trying 10.192.166.103... * Connected to rwsa01 (10.192.166.103) port 443 (#0) * Initializing NSS with certpath: sql:/etc/pki/nssdb * CAfile: /etc/pki/tls/certs/ca-bundle.crt CApath: none * Server certificate: * subject: CN=rwsa01 * start date: Jun 23 22:00:06 2021 GMT * expire date: Sep 26 22:00:06 2023 GMT * common name: rwsa01 * issuer: CN=rwsa01 * NSS error -8156 (SEC_ERROR_CA_CERT_INVALID) * Issuer certificate is invalid. * Closing connection 0 curl: (60) Issuer certificate is invalid. More details here: http://curl.haxx.se/docs/sslcerts.html {noformat}","15/Mar/23 10:43 AM;5b15d954b0d76456f36daf33;You don’t need to reboot the entire appliance. From the cli you have the option to restart LMI

Looking at the LMI logs from around 31 Jan, there is nearly nothing meaningful (there is some error about a pdadmin command failing, but that won’t stop LMI from working).

A quick search for PR_END_OF_FILE_ERROR indicates it is a firefox specific client side issue. Not the server/LMI",17/Mar/23 12:16 AM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33] The customer rebooted the applaince on their own initiative. So i tell the customer it might have been a browser issue and admit we cannot find anything else? ,"17/Mar/23 9:18 AM;5b15d954b0d76456f36daf33;[~accountid:614dd566a995ad0073ec0622] based on the data you have presented in this jira, I can’t find any evidence of the problem that is reported. 

It may well be that they really did have an issue that needed further investigation. But we have no information to make an assessment. If the problem were to occur again, before they take any remedial action (restart/reboot), generating a support file might provide clues.",23/Mar/23 8:47 PM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33] Issue happened again. I looked in lmi and system logs and only that ssl error previously documented?,"27/Mar/23 10:41 AM;5b15d954b0d76456f36daf33;If you look at the latest support files, you will notice that even though the LMI logs say it is up and running, there is no evidence of the <management IP>:443 having any established connections.

Also the LMI was running for up to a month (Feb 19 to Mar 17) before this was reported.

The only informational message in the logs is about too many SSL connection failures, but it is neither a warning nor an error. Something that can be ignored according to WebSphere.",27/Mar/23 6:02 PM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33] Would a pcap be the next step?,"28/Mar/23 10:29 AM;5b15d954b0d76456f36daf33;If you can’t get into the LMI, you can’t turn the pcap tracing option on.

They could try connecting to the LMI from the CLI. Eg:

{noformat}appl1>  tools session <appliance IP>:443{noformat}

If successful, it will provide details of the connection including handshake, protocol, cipher etc.

You can do the same from an external machine too using {{openssl s_client <appliance IP>:443}}","28/Mar/23 6:25 PM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33] I tried that on my own machine:



!image-20230328-082527.png|width=837,height=130!

It just hangs?","28/Mar/23 6:49 PM;5b15d954b0d76456f36daf33;Then try openssl s_client. That is what the tools session command uses under the covers.

In any case, get the output from the customer’s environment. I’m not sure what’s up with your local one.",28/Mar/23 7:48 PM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33] Yes that worked from my Debian vm. Will advise customer.,28/Mar/23 9:36 PM;614dd566a995ad0073ec0622;[~accountid:5b15d954b0d76456f36daf33]Sorry; we try this when the lmi is unavailable?Yes?,"29/Mar/23 8:49 AM;5b15d954b0d76456f36daf33;Try first when it is available so you know what to expect. And when it becomes unresponsive, you can rerun to compare. 

There might even be some sort of verbose or debug option on the command to collect additional information ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Single Sign-On to SAP - Documentation available???,ISAMSUP-4846,286225,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,07/Mar/23 4:20 AM,17/Mar/23 4:55 AM,14/Jul/23 2:47 PM,17/Mar/23 4:55 AM,,,,0,,,,"*Customer* : Highrise Technologies Incorporated

Need to know if there is a detailed guide available from IBM that details all the options available from IBM for giving SSO to SAP. They are looking to provide SSO to SAP SSP Portal.

I have checked communities, old cases and JIRAS and haven’t found specific documentation. Just the Single Sign on Solutions we provide [Single Sign-on Solutions - IBM Documentation|https://www.ibm.com/docs/en/sva/10.0.5?topic=configuration-single-sign-solutions]

And some old references but I guess they don’t fit for this use case:

[IBM Security Access Manager SAP Netweaver Java AS Adapter|https://www.ibm.com/support/pages/ibm-security-access-manager-sap-netweaver-java-adapter]

[IBM Security Access Manager for Enterprise Single Sign-On, SAP GUI AccessProfile|https://www.ibm.com/support/pages/ibm-security-access-manager-enterprise-single-sign-sap-gui-accessprofile]



Any guidance is more than appreciated for customer and me, please.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012301050,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,Highrise Technologies Incorporated,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i197hv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-08 02:15:51.26,,,,,"08/Mar/23 12:15 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5ac57757d9a96536d1f0daa9] 

This looks like some of the integration adapters work done previously , do we know if we have an equivalent in ISVA ?

Some reference from RTC - 

[https://rtp-rtc6.tivlab.raleigh.ibm.com:9443/jazz/web/projects/ISAM#action=com.ibm.team.workitem.viewWorkItem&id=53140|https://rtp-rtc6.tivlab.raleigh.ibm.com:9443/jazz/web/projects/ISAM#action=com.ibm.team.workitem.viewWorkItem&id=53140]

Thanks","14/Mar/23 12:31 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

We don't have any document specific to the SAP SSO, all that documentation you have seen on the ISVA documentation is what we publish and support. 

Any specific use case pertaining to a specific requirement - services might be a better place to start.


","17/Mar/23 4:55 AM;60e721f12d49fd00698bb49d;Sure - thank you.

I’ll close this one.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Grants in LMI not working with Fed license if no AAC license,ISAMSUP-4843,285984,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,04/Mar/23 7:08 AM,07/Mar/23 8:47 AM,14/Jul/23 2:47 PM,07/Mar/23 8:47 AM,10.0.6,Support,,0,,,,"Carl Hovi reported: 

LMI function ""Grants"" under ""Federation""->""Manage"" does not work if base + Federation licenses are activated but AAC is not. 

Clicking on ""Grants"" displays a screen with this text: ""Not available 

The specified request cannot be completed as the required offering has not been activated."" 



But the ISVA docs ([https://www.ibm.com/docs/en/sva/10.0.5?topic=configuration-oauth-20-oidc-support|https://www.ibm.com/docs/en/sva/10.0.5?topic=configuration-oauth-20-oidc-support|smart-link] ) say ""The support is provided at both the Advanced Access Control and the Federation licensing levels"". 

Further discussion with input from L2 and ISVA Dev can be found in this slack thread started today in #verify-access: [https://app.slack.com/client/T1V6D3RT7/threads|https://app.slack.com/client/T1V6D3RT7/threads]",,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4847,,,,,,,,,,,,,,,,,,,,,IJ45714,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012336414,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,IBM,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-03-06T12:54:06.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1960b:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-03 23:11:04.402,,,,,04/Mar/23 9:11 AM;5b15d954b0d76456f36daf33;[~accountid:5c87cb8d88f9ec6ae0afb306] are there any other screens that should be accessible beyond grants? Might as well get them all at one shot. Also sounds like an APAR candidate ,"06/Mar/23 11:31 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 81fde589d489836d2431a659f45ef36b74445240
   * description: ISAMSUP-4843 Allow grant management with Fed only activation

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86049400.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4843) which we publish.","06/Mar/23 12:54 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 4aa2fe5d6d4d287ca1944847c00c4a2455a931fe
   * description: ISAMSUP-4843 Allow grant management with Fed only activation (#5722)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86050583.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230306025124-4aa2fe5d.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","07/Mar/23 12:00 AM;5c87cb8d88f9ec6ae0afb306;Hello Bhavan, 

I am not aware of any other pages that are not working. 

I have opened an APAR for this issue: IJ45714",07/Mar/23 12:41 AM;5c87cb8d88f9ec6ae0afb306;I did some more testing.  I was not able to find any other pages that were broken.  ,"07/Mar/23 8:47 AM;5b15d954b0d76456f36daf33;Thanks [~accountid:5c87cb8d88f9ec6ae0afb306] 

The changes are approved and the APAR fix will be available from the next version.

In the meantime if they require a fixpack, it is available in the linked item : [https://cloudidentity.atlassian.net/browse/ISAMSUP-4847|https://cloudidentity.atlassian.net/browse/ISAMSUP-4847|smart-link] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Isam lmi fails to load Certificates and unable to remove rogue Certificate ,ISAMSUP-4824,285690,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,03/Mar/23 3:12 AM,06/Mar/23 1:41 PM,14/Jul/23 2:47 PM,06/Mar/23 1:41 PM,,,,0,,,,"Customer is unable to load certificates in lmi.:'Failed to load data'. Probably linked to:

{noformat}-rw-r-----    1 ivmgr    ivmgr         5088 Mar 13  2020 \\pfantsds01\e$\idsslapd-db2ldap\etc\ldapkey.kdb
-rw-r-----    1 ivmgr    ivmgr          129 Mar 13  2020 \\pfantsds01\e$\idsslapd-db2ldap\etc\ldapkey.sth{noformat}

which cannot be removed. We need fixpack to remove it?





{noformat}/var/pdweb/shared/keytab:
total 248
drwxr-x---    3 ivmgr    ivmgr         4096 Mar 13  2020 .
drwxr-x---   15 ivmgr    ivmgr         4096 Aug 26  2015 ..
-rw-r-----    1 ivmgr    ivmgr           88 Mar 25  2021 ISAM GUI.kdb
-rw-r-----    1 ivmgr    ivmgr          129 Mar 13  2020 ISAM GUI.sth
-rw-r-----    1 ivmgr    ivmgr         5088 Mar 13  2020 \\pfantsds01\e$\idsslapd-db2ldap\etc\ldapkey.kdb
-rw-r-----    1 ivmgr    ivmgr          129 Mar 13  2020 \\pfantsds01\e$\idsslapd-db2ldap\etc\ldapkey.sth
-rw-r-----    1 ivmgr    ivmgr         5088 Mar 13  2020 embedded_ldap_keys.kdb
-rw-r-----    1 ivmgr    ivmgr          129 Mar 13  2020 embedded_ldap_keys.sth
drwxr-x---    2 ivmgr    ivmgr         4096 Mar 13  2020 jks
-rw-r-----    1 ivmgr    ivmgr          575 Dec  1 13:20 kdb.conf
-rw-r-----    1 ivmgr    ivmgr          213 Mar 13  2020 kdb.conf.obf
-rw-r-----    1 ivmgr    ivmgr        10088 Mar 13  2020 ldapkey.kdb
-rw-r-----    1 ivmgr    ivmgr          129 Mar 13  2020 ldapkey.sth
-rw-r-----    1 ivmgr    ivmgr        35088 Sep 12 08:03 lmi_trust_store.kdb
-rw-r-----    1 ivmgr    ivmgr          129 Mar 13  2020 lmi_trust_store.sth
-rw-r-----    1 ivmgr    ivmgr       100080 Jun 30  2021 pdsrv.kdb
-rw-r-----    1 ivmgr    ivmgr          129 Mar 13  2020 pdsrv.sth
-rw-r-----    1 ivmgr    ivmgr        30088 Nov  6  2020 rt_profile_keys.kdb
-rw-r-----    1 ivmgr    ivmgr          129 Mar 13  2020 rt_profile_keys.sth{noformat}",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011342278,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,PFA PENSION EDB-AFDELINGEN,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1947n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-03-03 02:21:00.012,,,,,"03/Mar/23 12:21 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:614dd566a995ad0073ec0622] 

Here is a fixpack to clear the random kdb and sth, generate a support file after you install the fixpack and check if it still persists - 


Fixpack: [https://ibm.box.com/s/mx4e3lqfjzj792uneulya0g18ann8lgd|https://ibm.box.com/s/mx4e3lqfjzj792uneulya0g18ann8lgd|smart-link] 

Checksum:[https://ibm.box.com/s/mxh2hrl62f5wogsrq28047czd3wlbqi1|https://ibm.box.com/s/mxh2hrl62f5wogsrq28047czd3wlbqi1|smart-link] ","06/Mar/23 1:41 PM;5af4ad7d4dd24c579110120b;Case closed, hence closing Jira.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
How do we achieve login-form-response-pattern in IAG?,ISAMSUP-4822,285445,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Keiran Robinson,5ac577587028785d133fbc46,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,02/Mar/23 5:48 PM,20/Mar/23 11:25 AM,14/Jul/23 2:47 PM,20/Mar/23 11:25 AM,,Support,,0,,,,"WebSEAL has following param:

{noformat}#
# An optional pattern which can be used to determine whether the response page
# is the login form or not.  Valid pattern matching characters include '*' and
# '?'.  If the pattern is not contained in the response it will be streamed
# back to the client and won't be treated as a login form.  So, this
# configuration entry can be used to determine whether WebSEAL should process
# the response as a login form or not.  The number of bytes from the response
# which is checked is controlled by the request-body-max-read configuration
# entry within the '[server]' stanza of the WebSEAL configuration file.  Because
# the pattern is checked against the entire cached response it will usually
# start and end with a '*'.
#
login-form-response-pattern ={noformat}

I can not find similar function in the following document:
  [https://docs.verify.ibm.com/gateway/docs/yaml-resource_servers-forms_login|https://docs.verify.ibm.com/gateway/docs/yaml-resource_servers-forms_login|smart-link] 
A customer focus on the following part:

{quote} If the pattern is not contained in the response it will be streamed back to the client and won't be treated as a login form.{quote}

It seems that it is not available at this point:
[https://ibm-security.slack.com/archives/CLBTH7LQ2/p1677710711984869?thread_ts=1677659438.668239&cid=CLBTH7LQ2|https://ibm-security.slack.com/archives/CLBTH7LQ2/p1677710711984869?thread_ts=1677659438.668239&cid=CLBTH7LQ2|smart-link] 

Can this be implement this support channel?
Or, should I ask the customer to open new “Ideas” ?",,Mitsukazu Nakai,,,,,,,,,,,,,,,5bb6a576c39135735a7db132,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012140684,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,YUASA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i192pv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-20 00:08:18.468,,,,,"14/Mar/23 1:08 AM;5b15d9ec6d76184b7d989c83;[~accountid:5ac577587028785d133fbc46] , are there any update on this?
Any comments are really appreciated.",20/Mar/23 10:08 AM;5ac57757d9a96536d1f0daa9;[~accountid:5ac577587028785d133fbc46] can you please confirm if this is something that we can contain in a future release and if so can you please advise what release it might be included in? ,"20/Mar/23 10:31 AM;5ac577587028785d133fbc46;Hi [~accountid:5b15d9ec6d76184b7d989c83], this option isn’t possible to configure at the moment and because of the way FSSO works we cannot use “advanced” like we often can with other WebSEAL features.

Can you guide the client to submit a request via the Ideas portal? (Information about the Ideas portal: [https://docs.verify.ibm.com/gateway/docs/overview-ideas|https://docs.verify.ibm.com/gateway/docs/overview-ideas|smart-link]) This is the formal process for requesting enhancements.

Based on the current scheduling, we should be able to accommodate this in our upcoming Q3 IAG release. If we have an idea created, I can formally commit it to the plan.","20/Mar/23 11:25 AM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5ac577587028785d133fbc46] ,
Thank you very much for the clarification.
I’ll ask the customer to open new Ideas.


[~accountid:5ac57757d9a96536d1f0daa9] , thank you very much for the follow-up.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Does ISVA10 pdjrte support any downlevel versions of OpenJDK,ISAMSUP-4821,285215,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,01/Mar/23 7:47 PM,27/Mar/23 10:17 AM,14/Jul/23 2:47 PM,27/Mar/23 10:17 AM,,,,0,,,,"Customer using in house application called RAM uses pdjrte (PD.jar) to set the account-valid value to either yes/no in order to lock/unlock a user in ISAM in certain circumstances. As part of there bank's resilience program the application has been migrated off WAS ND 8.5.5 and is now running as an openshift (v3.1.1) container instance. 

Currently the code is running against OpenJDK Version 8. 

Does pdjrte 10.0.5.0 support Openjdk version 8?",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012274415,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,CLYDESDALE BANK PLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i191bn:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-01 15:11:20.113,,,,,02/Mar/23 1:11 AM;5b15d94b6256d01ad54eb020;We still recommend  using 10.0.2.0   version of the PD.jar and  IBM Java 8.   We’re still working on some issues to support OpenJDK.,"02/Mar/23 7:39 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d94b6256d01ad54eb020] 

Does this mean that currently pdjrte 10.0.5.0 do not support Openjdk version 8?",02/Mar/23 11:50 PM;5b15d94b6256d01ad54eb020;It means you should not use the 10.0.5.0 version at this time.,27/Mar/23 10:17 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"Can not set non default values in ""Scheduler"" when adding virtual server (Front End Load Balancer)",ISAMSUP-4809,283419,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,22/Feb/23 5:29 PM,15/Mar/23 10:48 AM,14/Jul/23 2:47 PM,15/Mar/23 10:48 AM,10.0.6,Support,,0,,,,"The customer tried to add “Virtual Server” in System:Network Settings → Front End Load Balancer and select “Servers” tab.
When clicking ‘New’ button, we can see three tabs: General, Scheduler, and Advanced Tuning.

In Scheduler tab, we can not choose non default values. Even if you changed the value, it become default value.

To change these values, you need to once save it after setting values in General, 
and then select the server, and click ‘Edit’.

Is this working as expected?
If not, could you please fix the issue to change values when adding Virtual Server?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4869,,,,,,,,,,,,,,,,,IJ45807,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012170273,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,, BENIC SOLUTION CORPORATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-03-13T16:37:25.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18qeb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-22 09:23:30.01,,,,,"22/Feb/23 7:23 PM;5b15d9517dab4c51f61b5190;The problem is that the scheduler tab and advanced tuning tab settings apply to each Real Server

And since there is nowhere in the Add Virtual Server to define a Real Server - there is nothing to apply the scheduler or advanced tuning parameters to when adding a new virtual server

To avoid confusion I think we should remove the  scheduler and advanced tuning tabs from the Add Virtual Server screen

I considered the alternative of adding  Real Server form fields to the add virtual server screen, but I dont think it makes sense ( and I think would be more difficult to do)

What do you think?","24/Feb/23 11:47 AM;5b15d9ec6d76184b7d989c83;{quote}To avoid confusion I think we should remove the scheduler and advanced tuning tabs from the Add Virtual Server screen{quote}

I agree with this part to avoid confusion.
We might also need to revise following document along with the change:
  [https://www.ibm.com/docs/en/sva/10.0.5?topic=balancer-configuring-front-end-load|https://www.ibm.com/docs/en/sva/10.0.5?topic=balancer-configuring-front-end-load]","10/Mar/23 1:13 PM;5b15d9517dab4c51f61b5190;Looking further into this.

I have been looking a the javascript and I may have been wrong with my initial comment

It may be just a javascript issue","10/Mar/23 5:49 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9ec6d76184b7d989c83] 

Apologies - I originally misunderstood the problem and was wrong with my initial assesment

I didnt try it myself and thought it applied to  all inputs in the Scheduler Tab

But now that I have looked further into it I understand the issue is just with the

Scheduler dropdown within the Scheduler Tab

When adding a new virtual server the javascript is forcing the Scheduler dropdown value to either

round-robin (if layer 7 is selected) or source-hash (if layer 4 is selected)

When editing an existing virtual server it lets you select

Please open an APAR “LMI Front End Load Balancer Add Virtual Server Scheduler Value always default”

I can fix the javascript so it will keep the value you select in the Add Virtual Server screen.

it will still force the value to the default when you change the layer4/layer7 value

So you will need to select layer 4/layer 7 before the Scheduler dropdown","13/Mar/23 12:57 PM;5b15d9ec6d76184b7d989c83;Hi. Thanks for the update.
I created IJ45807 for this issue.",13/Mar/23 12:57 PM;5b15d9ec6d76184b7d989c83;Is it possible to provide fixpack on 10.0.5?,13/Mar/23 1:50 PM;5b15d9517dab4c51f61b5190;Will build 10.0.5.0 fixpack,"13/Mar/23 3:02 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ac2579d2855e108b1b5c418fe4107431964d9742
   * description: ISAMSUP-4809 IJ45807 LMI FELB Add Virt Server Scheduler always default

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86534649.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4809) which we publish.","13/Mar/23 4:37 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: fd9ca289b733e403e3d1fd4898d6201a48b7d3b1
   * description: ISAMSUP-4809 IJ45807 LMI FELB Add Virt Server Scheduler always default (#5743)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86537164.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230313063430-fd9ca289.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","13/Mar/23 5:04 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9ec6d76184b7d989c83] 

Fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4869|https://cloudidentity.atlassian.net/browse/ISAMSUP-4869|smart-link] ","13/Mar/23 5:58 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: fd9ca289b733e403e3d1fd4898d6201a48b7d3b1
   * description: ISAMSUP-4809 IJ45807 LMI FELB Add Virt Server Scheduler always default (#5743)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86541188.


This build has not been published as the commit is not currently within a branch (20230313063430-fd9ca289) which we publish.","14/Mar/23 2:55 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: fd9ca289b733e403e3d1fd4898d6201a48b7d3b1
   * description: ISAMSUP-4809 IJ45807 LMI FELB Add Virt Server Scheduler always default (#5743)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86582255.


This build has not been published as the commit is not currently within a branch (ISAMDEV-9898) which we publish.","14/Mar/23 11:46 AM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d9517dab4c51f61b5190] ,
It worked as expected in local environment, so I will share it with the customer.
Thank you very much for providing the fixpack!","14/Mar/23 11:52 AM;5b15d9ec6d76184b7d989c83;Sorry, I have one more question.
Is this fixed in 10.0.5 IF1 (if so, when it scheduled to be released?) or 10.0.6?","14/Mar/23 9:27 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9ec6d76184b7d989c83] 

IJ45807  will be included in 10.0.5.0. IF1 which is scheduled for release at  end of this month",15/Mar/23 10:48 AM;5b15d9ec6d76184b7d989c83;Thanks for the info! I’ll close this ticket.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Vulnerability RHSA-2022:7089/CVE-2022-3515,ISAMSUP-4807,283049,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Seiji Kikuchi,5c2c1788ab1c1d35825c4da1,Seiji Kikuchi,5c2c1788ab1c1d35825c4da1,21/Feb/23 6:38 PM,27/Mar/23 2:31 PM,14/Jul/23 2:47 PM,27/Mar/23 2:31 PM,,,,0,,,,"Hello,

The customer reported the docker image isam-wrp version 10.0.3.0 has been flagged with a high rated vulnerability RHSA-2022:7089 / CVE-2022-3515.
 [https://access.redhat.com/security/cve/CVE-2022-3515|https://access.redhat.com/security/cve/CVE-2022-3515|smart-link] 
 [https://access.redhat.com/errata/RHSA-2022:7089|https://access.redhat.com/errata/RHSA-2022:7089|smart-link] 
And they requested a patch/fixpack for 10.0.3.

Is there a patch/fixpack available for 10.0.3.0 to resolve this issue?

Thanks and regards,",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012213057,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Seiji Kikuchi,5c2c1788ab1c1d35825c4da1,,,,MACQUARIE GROUP SERVICES AUSTRALIA PTY LIMITED,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18o5f:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,,,,,,,,,,,,,2023-02-21 23:39:32.255,,,,,22/Feb/23 9:39 AM;5b15d8fd6e93913e31e279fb;[~accountid:5c2c1788ab1c1d35825c4da1] This vulnerability is in the RedHat UBI layer.  The updates to the RedHat UBI layer is only updated on the current version of the ISVA Container so the customer would need to update to ISVA 10.0.5.0 to get RedHat UBI fixes.  This is consistent with our Support Policy that Security Fixes are delivered on the latest released Mod level of the product.,"27/Mar/23 12:37 PM;5c2c1788ab1c1d35825c4da1;Hello jwade-san,  [~accountid:5b15d8fd6e93913e31e279fb] 
Thank you for your support.

Informed your answer to the customer and no feedback.
So I will close the case at this point.
Please close this jira item.

Thanks and regards,",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
importing single file to management/C is broken,ISAMSUP-4788,281083,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,14/Feb/23 5:40 AM,11/Mar/23 1:04 AM,14/Jul/23 2:47 PM,11/Mar/23 1:04 AM,,,,0,,,,"L2 has reproduced the problem with v10.0.5.

In the LMI, select revese proxy -> Manage -> Management Root (new diaglog window opens)
Expand ""management"" -> select C -> select ""Manage"" drop-down -> select Import
attempt to upload an html file

Notice the following error message appears:
	System Error
	The uploaded file is not of the correct type.

The error is wrong. L2 confirmed the steps above work fine for a single html file and v10.0.4.

This problem may be related to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4223|https://cloudidentity.atlassian.net/browse/ISAMSUP-4223|smart-link] 

Two work-arounds available:

# Rename the file from *.html to *.zip. The upload succeeds. Then ""Rename"" the file to *.html.
# You can also create a new file in the LMI and just copy/paste the contents of the html from your source to the diaglog winodw in the LMI.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ45430,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012137367,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Reagan Knowles,5b15d9e44c4ed14b83af8723,,,,EXPORT IMPORT BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-03-11T00:45:25.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18ccj:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-13 20:05:55.255,,,,,"14/Feb/23 5:46 AM;5b15d9e44c4ed14b83af8723;Problem exists for all items in the dialog window, it’s not just the management/C section.",14/Feb/23 6:05 AM;5b15d94b6256d01ad54eb020;The change made for  4223  that you mentioned should not have affected this but I’ll check on it.  The change for that one was for the root level where only zip are allowed.,16/Feb/23 5:05 AM;5b15d9e44c4ed14b83af8723;Can I create an APAR for this issue?,16/Feb/23 5:07 AM;5b15d94b6256d01ad54eb020;Yes.  That restriction should only be at the top level of each tree.,16/Feb/23 5:18 AM;5b15d9e44c4ed14b83af8723;I created APAR IJ45430 for this issue.,10/Mar/23 2:13 AM;5b15d94b6256d01ad54eb020;Do you need a fix pack for this problem?,"10/Mar/23 2:56 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 92498d85892cbd79a9f7a135d28f3c72841e583a
   * description: Update ManagementRoot.java

ISAMSUP-4788  APAR  IJ45430

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86368277.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4788) which we publish.",10/Mar/23 4:15 AM;5b15d9e44c4ed14b83af8723;I don’t think we need a fixpack. There are several easy work-arounds.,10/Mar/23 4:16 AM;5b15d94b6256d01ad54eb020;Ok thanks,"10/Mar/23 11:34 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e34c495ee0639fd187742a4b055e1d2a76ff1817
   * description: Merge pull request #5737 from ISAM/ISAMSUP-4788

Update ManagementRoot.java

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86405395.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230310013138-e34c495e.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","10/Mar/23 12:52 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e34c495ee0639fd187742a4b055e1d2a76ff1817
   * description: Merge pull request #5737 from ISAM/ISAMSUP-4788

Update ManagementRoot.java

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86407686.


This build has not been published as the commit is not currently within a branch (20230310013138-e34c495e) which we publish.",11/Mar/23 1:04 AM;5b15d94b6256d01ad54eb020;APAR is closed.  Since you don’t need a fix pack I’ll close this Jira too.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Webseal returns a 400 (bad request) on a pre-flight call,ISAMSUP-4785,280734,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,11/Feb/23 2:12 AM,12/May/23 8:31 PM,14/Jul/23 2:47 PM,12/May/23 8:31 PM,,Support,10/Feb/23 12:00 AM,0,cors,,,"Hello Team,

The customer is getting a 400 error when they do a preflight call, The issue occurred when the application starts the authentication with the external IDP in the background. During this process a pre-flight call is made to this resource /swp/webaccess7_6/com.swift.sawa.browse.gwt.Browse/swcall (here below the details of the call). This call is answered with a 400 bad request Method: OPTIONS Host: [swift.acc.kbc-group.com|https://swift.acc.kbc-group.com] Url: /swp/webaccess7_6/com.swift.sawa.browse.gwt.Browse/swcall status_code: 400

Cors configuration

[cors-policy:swift]
request-match = OPTIONS /swp/webaccess7_6/com.swift.sawa.browse.gwt.Browse/swcall HTTP/1.1
handle-pre-flight = true
allow-origin = [https://idp.swiftnet.sipn.swift.com|https://idp.swiftnet.sipn.swift.com]
allow-credentials = true
allow-header = origin
allow-header = x-requested-with
allow-method = POST
allow-method = GET
allow-method = OPTIONS
max-age = 3600
expose-header =


{noformat}/webseald/http/cors/CORSEngine.cpp:401: Adding AC-Allow-Origin: https://idp.swiftnet.sipn.swift.com
2023-02-10-15:20:04.991+00:00I----- thread(235) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:404: [EXIT] addAllowOriginHeader: swift
2023-02-10-15:20:04.991+00:00I----- thread(235) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:247: The Access-Control-Request-Headers header in the request is not permitted.
2023-02-10-15:20:04.991+00:00I----- thread(235) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:253: Adding AC-Allow-Credentials: true
2023-02-10-15:20:04.991+00:00I----- thread(235) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:259: Adding AC-Max-Age: true
2023-02-10-15:20:04.991+00:00I----- thread(235) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:272: Adding AC-Allow-Method: POST, GET, OPTIONS
2023-02-10-15:20:04.991+00:00I----- thread(235) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:286: Adding AC-Allow-Headers: origin, x-requested-with
2023-02-10-15:20:04.991+00:00I----- thread(235) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:297: [EXIT] processPreflight: swift, status: 400{noformat}

They have followed the instructions from the tecnote and they still have the same error,

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-10%2F&filepath=TS010173002%2F2023-02-10%2Fpdweb.http.cors_230210.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-10%2F&filepath=TS010173002%2F2023-02-10%2Fpdweb.http.cors_230210.log]",,Alan Wong,BRIANORO,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,Tushar Prasad,,,,,,,,6092aca0f0db130069d19687,6154906364ff01007106e189,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS010173002,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,KBC GROUP NV,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-10%2F&filepath=TS010173002%2F2023-02-10%2Fpdweb.http.cors_230210.log

https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-10%2F&filepath=TS010173002%2F2023-02-10%2Fpdweb.http.cors_230210.log

https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2022-09-05%2F",,,,,,,,,AIX,Linux 86_64,,,,,,,,,,,,,0|i18a6z:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-02-13 21:10:46.888,,,,,"14/Feb/23 7:10 AM;5b15d9e581c3df12acf53c4a;a) Need some background info?

What version they were before they see the problem?

Was it working before?

It is after the any upgrade they see the issue?

Or was there a change in config that cause this issue?

b)

Please do collect full traces with reproduction of the issue i.e.  set  “pdweb” in the trace configuration and set the log file size to 20MB to capture full trace in a single file.

Let me know the time stamp so that I can find the issue in the trace?

===================

Please do remember to answer the question a) i.e. background context.","14/Feb/23 8:27 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9e581c3df12acf53c4a] 
There is a previous logs and the timestamp for that pdweb.http.cors, I will ask for the other information as you requested
2023-02-10-15:20:04.991+00:00I----- thread(235) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:364: Origin header: [https://idp.swiftnet.sipn.swift.com|https://idp.swiftnet.sipn.swift.com]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-10%2F&filepath=TS010173002%2F2023-02-10%2Fpdweb.http.cors_230210.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-10%2F&filepath=TS010173002%2F2023-02-10%2Fpdweb.http.cors_230210.log]","16/Feb/23 4:03 AM;5b15d9e581c3df12acf53c4a;Also, please do collect the support file

We will definitely need conf file and may be other files so support file will include all these.",16/Feb/23 4:15 AM;5b15d9e581c3df12acf53c4a;What Technote you refer to by saying customer followed the technote?,"16/Feb/23 8:48 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] 
I have shared them these technotes and they have follwed and tried changing it accordingly but still have the 400 error when they do the preflight check

[https://www.ibm.com/docs/en/sva/10.0.1?topic=stanza-allow-method|https://www.ibm.com/docs/en/sva/10.0.1?topic=stanza-allow-method|smart-link] 

[https://www.ibm.com/docs/en/sva/10.0.5?topic=stanza-allow-origin|https://www.ibm.com/docs/en/sva/10.0.5?topic=stanza-allow-origin|smart-link] 

[https://www.ibm.com/docs/en/sva/10.0.3?topic=requests-pre-flight-check|https://www.ibm.com/docs/en/sva/10.0.3?topic=requests-pre-flight-check|smart-link] 

[https://www.ibm.com/docs/en/sva/10.0.3?topic=support-configure-cors-policies|https://www.ibm.com/docs/en/sva/10.0.3?topic=support-configure-cors-policies|smart-link] 

Please let me know if i miss anything?

Thank you ","22/Feb/23 10:31 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9e581c3df12acf53c4a] The timestamp of the issue in pdweb.debug and pdweb.debug.cors, 2023-02-22-10:53:28.856 2023-02-22-10:53:28.855, also have attached the webseal.config file please look at it

{noformat}2023-02-22-10:53:28.856+00:00I----- thread(61) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- Browser <=== PD -----------------
Thread 61; fd 447; local 10.152.52.98:534; remote 10.5.10.149:42034
HTTP/1.1 400
p3p: CP=""NON CUR OTPi OUR NOR UNI""
transfer-encoding: chunked
access-control-allow-origin: https://idp.swiftnet.sipn.swift.com
access-control-allow-methods: POST, GET, OPTIONS
access-control-allow-headers: origin, x-requested-with
access-control-max-age: 3600
access-control-allow-credentials: true
strict-transport-security: max-age=31536000; includeSubDomains; preload

2023-02-22-10:53:28.855+00:00I----- thread(61) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:297: [EXIT] processPreflight: swift, status: 400{noformat}

The client is also requesting for Webex session with you, if possible today or tomorrow please let me know if you are free?

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2Fvar%2Fpdweb%2FCOR%2Fetc%2F&filepath=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2Fvar%2Fpdweb%2FCOR%2Fetc%2Fwebseald-COR.conf|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2Fvar%2Fpdweb%2FCOR%2Fetc%2F&filepath=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2Fvar%2Fpdweb%2FCOR%2Fetc%2Fwebseald-COR.conf]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2F&filepath=TS010173002%2F2023-02-22%2Fpdweb.debug_230322.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2F&filepath=TS010173002%2F2023-02-22%2Fpdweb.debug_230322.log]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2F&filepath=TS010173002%2F2023-02-22%2Fpdweb.http.cors_230322.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2F&filepath=TS010173002%2F2023-02-22%2Fpdweb.http.cors_230322.log]","25/Feb/23 2:16 AM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9e581c3df12acf53c4a] Any update on this issue below, the customer is also requesting for Webex session would you let me know your availability??","25/Feb/23 2:22 AM;5b15d9e581c3df12acf53c4a;By the way, these are not technotes rather regular documentation.

To make any progress, I need the traces/support files that I requested before,  pdweb.http.cors will not capture any errors that customer’s is seeing.



Also, you need to give me the full background info, it is clearly an configuration issue as it is seen now.

In any case, provide all the info that I requested on February 13 comment.","27/Feb/23 6:23 PM;60f541a6d0134900692d91b7;Hello [~accountid:5b15d9e581c3df12acf53c4a] I have attached both the support file traces and webseald-cor.conf files, I don't understand what other traces do you need??

This is a new setup to implement the CORS for this application. The configuration did not work 
Please look into the support file traces and config file also attached

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2Fvar%2Fpdweb%2FCOR%2Fetc%2F&filepath=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2Fvar%2Fpdweb%2FCOR%2Fetc%2Fwebseald-COR.conf|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2Fvar%2Fpdweb%2FCOR%2Fetc%2F&filepath=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2Fvar%2Fpdweb%2FCOR%2Fetc%2Fwebseald-COR.conf]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-02-22%2Fisva_10.0.3.1_20230222-121644_s1s0069k.support_unpack%2F]","01/Mar/23 3:40 AM;5b15d9e581c3df12acf53c4a;You guys are making this simple issue too complicated.

I asked for full trace ie. “pdweb” trace but it contains pdweb.debug and pdweb.http.cors, none of those capture the error itself.



a)

Please collect full trace i.e.  set  “pdweb”

b) 

Only generate the error itself so that trace file is short and not too big

c)

Let me know timestamp and exact request made to generate the error.

==================================================

Having said the above, it seems to me , I cannot be sure without full trace, that customer is executing incomplete request i.el request does not provide full cors related information i.e. some how, in the request, may be cors header is missing specially “origin” header.

You see all the errors in pdweb.http.cors log like:

2023-02-22-11:21:30.155+00:00I----- thread(645) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:114: [ENTRY] CORSEngine::handleRequest
2023-02-22-11:21:30.155+00:00I----- thread(645) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:128: Not a cross-origin request; no Origin header in request.
2023-02-22-11:21:30.155+00:00I----- thread(645) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:129: [EXIT] CORSEngine::handleRequest

………………….

which means “origin” header is missing in the request, now the particular request may not be a CORS request and may be a valid request but that seems some thing is not right…….full trace would have revealed it properly.","02/Mar/23 8:21 PM;6154906364ff01007106e189;[~accountid:60f541a6d0134900692d91b7] is currently OOO. I have updated TS010173002 case today requesting and specifying to the client that correct support data, as in a “+_full pdweb trace_+” is required.","27/Mar/23 10:26 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] [~accountid:5b15d994dda5f94d06b985b2] This client is requesting for Webex session, they have not shared the full pdweb traces and they want a Webex session with L3 team could you join please?

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-24%2F&filepath=TS010173002%2F2023-03-24%2Fpdweb.debug_20230324.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-24%2F&filepath=TS010173002%2F2023-03-24%2Fpdweb.debug_20230324.log]
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-24%2F&filepath=TS010173002%2F2023-03-24%2Fpdweb.http.cors_20230324.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-24%2F&filepath=TS010173002%2F2023-03-24%2Fpdweb.http.cors_20230324.log]
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-24%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-24%2F]

pdweb.debug ---2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- Browser ===> PD -----------------
Thread 467; fd 470; local 10.152.52.98:534; remote 10.5.10.149:29846
OPTIONS /swp/webaccess7_6/com.swift.sawa.browse.gwt.Browse/swcall HTTP/1.1
accept: */*
accept-encoding: gzip, deflate, br
accept-language: en-US,en;q=0.9
connection: keep-alive
host: [swiftfal.acc.kbc-group.com|https://swiftfal.acc.kbc-group.com]
referer: [https://idp.swiftnet.sipn.swift.com/|https://idp.swiftnet.sipn.swift.com/]
user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.41
origin: [https://idp.swiftnet.sipn.swift.com|https://idp.swiftnet.sipn.swift.com]
access-control-request-method: POST
access-control-request-headers: content-type,nr-data
sec-fetch-site: cross-site
sec-fetch-dest: empty
sec-fetch-mode: cors
---------------------------------------------------
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- Browser <=== PD -----------------
Thread 467; fd 470; local 10.152.52.98:534; remote 10.5.10.149:29846
HTTP/1.1 400
p3p: CP=""NON CUR OTPi OUR NOR UNI""
transfer-encoding: chunked
access-control-allow-origin: [https://idp.swiftnet.sipn.swift.com|https://idp.swiftnet.sipn.swift.com]
access-control-allow-methods: POST, GET, OPTIONS
access-control-allow-headers: origin, x-requested-with, Access-Control-Request-Headers
access-control-max-age: 3600
access-control-allow-credentials: true
strict-transport-security: max-age=31536000; includeSubDomains; preload
------------------------------------------------------ pdweb.http.cors ---

2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:114: [ENTRY] CORSEngine::handleRequest
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:153: The request matched the following CORS policy: swift
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:194: [ENTRY] processPreflight: swift
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:355: [ENTRY] validateOriginHeader: swift
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:364: Origin header: [https://idp.swiftnet.sipn.swift.com|https://idp.swiftnet.sipn.swift.com]
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:375: [EXIT] validateOriginHeader: swift
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:387: [ENTRY] addAllowOriginHeader: swift
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:401: Adding AC-Allow-Origin: [https://idp.swiftnet.sipn.swift.com|https://idp.swiftnet.sipn.swift.com]
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:404: [EXIT] addAllowOriginHeader: swift
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:247: The Access-Control-Request-Headers header in the request is not permitted.
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:253: Adding AC-Allow-Credentials: true
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:259: Adding AC-Max-Age: true
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:272: Adding AC-Allow-Method: POST, GET, OPTIONS
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:286: Adding AC-Allow-Headers: origin, x-requested-with, Access-Control-Request-Headers
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:297: [EXIT] processPreflight: swift, status: 400","27/Mar/23 11:00 PM;60f541a6d0134900692d91b7;[~accountid:5b15d9e581c3df12acf53c4a] Also found a similar Jira do you think its same issue and you have provided a fixpack?

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4494|https://cloudidentity.atlassian.net/browse/ISAMSUP-4494|smart-link] ","28/Mar/23 12:04 AM;5b15d9e581c3df12acf53c4a;The issue described in Jira [https://cloudidentity.atlassian.net/browse/ISAMSUP-4494|https://cloudidentity.atlassian.net/browse/ISAMSUP-4494|smart-link] is bit informative that CORS headers were missing from response, this customer’s issue seems to be bit different but it never hurts to try it out in ISVA10.0.4.0 and see how it goes, can customer try same scenario in 10.0.4.0 or up? and see how it goes?



As I mentioned before, without full pdweb trace, I cannot figure out what is going on,  as I suspect there is probably something wrong in the request to begin with, without full trace, I cannot determine that.

No other customer is seeing this issue at all..

So, no point for me to join the webex without knowing the full details of what is going on.

So, here are the options for now:

# Reproduce the issue locally or
# Ask customer try in latter releases to root out other known issues even if they can do for test purposes
# Provide full “pdweb” trace from a clean recreate so that I know what is going on, let me know the request they made and what the end results they are seeing so that we can progress on this issue.","28/Mar/23 12:13 AM;5b15d994dda5f94d06b985b2;I think we need to add the values of *access-control-request-headers*: *content-type,nr-data.* To the allow-headers.

[https://ibm-security.slack.com/archives/G4228V9DK/p1679925728871369|https://ibm-security.slack.com/archives/G4228V9DK/p1679925728871369|smart-link] 

If that doesn’t work then we need to setup a recreate. Should be easy enough. ","28/Mar/23 2:46 AM;5b15d9e581c3df12acf53c4a;It seems like for some reason, client is NOT passing proper values in “request-headers”

…………

----

2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- Browser ===>
 PD -----------------
Thread 467; fd 470; local 10.152.52.98:534; remote 10.5.10.149:29846^M
OPTIONS /swp/webaccess7_6/com.swift.sawa.browse.gwt.Browse/swcall HTTP/1.1^M
accept: /^M
accept-encoding: gzip, deflate, br^M
accept-language: en-US,en;q=0.9^M
connection: keep-alive^M
host: swiftfal.acc.kbc-group.com^M
referer: [https://idp.swiftnet.sipn.swift.com/^M|https://idp.swiftnet.sipn.swift.com/%5EM]
user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.41^M
origin: [https://idp.swiftnet.sipn.swift.com^M|https://idp.swiftnet.sipn.swift.com%5EM]
access-control-request-method: POST^M
access-control-request-headers: content-type,nr-data^M
sec-fetch-site: cross-site^M
sec-fetch-dest: empty^M
sec-fetch-mode: cors^M
^M

2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- Browser <===
 PD -----------------
Thread 467; fd 470; local 10.152.52.98:534; remote 10.5.10.149:29846^M
HTTP/1.1 400 ^M
p3p: CP=""NON CUR OTPi OUR NOR UNI""^M
transfer-encoding: chunked^M
access-control-allow-origin: [https://idp.swiftnet.sipn.swift.com^M|https://idp.swiftnet.sipn.swift.com%5EM]
access-control-allow-methods: POST, GET, OPTIONS^M
access-control-allow-headers: origin, x-requested-with, Access-Control-Request-Headers^M
access-control-max-age: 3600^M
access-control-allow-credentials: true^M
strict-transport-security: max-age=31536000; includeSubDomains; preload^M
^M



2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:387: [ENTRY] addAllowOriginHeader: swift
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:401: Adding AC-Allow-Origin: [https://idp.swiftnet.sipn.swift.com|https://idp.swiftnet.sipn.swift.com]
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:404: [EXIT] addAllowOriginHeader: swift
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:247: The Access-Control-Request-Headers header in the request is not permitted.
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:253: Adding AC-Allow-Credentials: true
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:259: Adding AC-Max-Age: true
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:272: Adding AC-Allow-Method: POST, GET, OPTIONS
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:9 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:286: Adding AC-Allow-Headers: origin, x-requested-with, Access-Control-Request-Headers
2023-03-24-14:22:56.571+00:00I----- thread(467) trace.pdweb.http.cors:6 /build/isam/src/i4w/pdweb/webseald/http/cors/CORSEngine.cpp:297: [EXIT] processPreflight: swift, status: 400","28/Mar/23 2:56 AM;5b15d9e581c3df12acf53c4a;The best is NOT to include request-headers in the options i.e. preFlight request at all

because if you add any request headers in OPTIONS call, those headers must be valid permitted headers.","28/Mar/23 3:26 AM;5b15d9e581c3df12acf53c4a;One easy option to test will NOT to specify that to begin with i.e. 

   allow-header = Access-Control-Request-Headers

from the policy, restart webseal  and try","28/Mar/23 3:43 AM;5b15d9e581c3df12acf53c4a;BTW, for simplicity, you could also add those as “allow-header” i.e.

[cors-policy:swift]
   allow-credentials = true
   allow-header = Access-Control-Request-Headers
   allow-header = origin
   allow-header = x-requested-with

   *_allow-header = content-type_*

  *_allow-header = nr-data_*

…………………….

………………","28/Mar/23 8:41 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9e581c3df12acf53c4a] Thanks, I have requested the client to add the headers they will test it today and let me know the result also they have shared me the full “pdweb” trace of the previous configuration which had the issues

thread(463)
Time: 2023-03-28-09:00:46.477+00:00I 
url: /swp/webaccess7_6/com.swift.sawa.browse.gwt.browse/swcall

{noformat}2023-03-28-09:00:46.477+00:00I----- thread(463) trace.pdweb.snoop.client:1 /build/isam/src/i4w/pdwebrte/webcore/amw_snoop.cpp:190: 
----------------------------------------
Thread 140111554127616; fd 430; local 10.152.52.23:534; remote 10.5.10.149:61131
Sending 13 bytes
0x0000   4854 5450 2f31 2e31 2034 3030 20               HTTP/1.1.400.   
{noformat}

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-28%2F&filepath=TS010173002%2F2023-03-28%2Fpdweb.log.2023-03-28-11-00-49|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-28%2F&filepath=TS010173002%2F2023-03-28%2Fpdweb.log.2023-03-28-11-00-49]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-28%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-28%2F]


Used snooparser to parse the same logs,

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-28%2F&filepath=TS010173002%2F2023-03-28%2Fpdweb.log.2023-03-28-11-00-49|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010173002&path=TS010173002%2F2023-03-28%2F&filepath=TS010173002%2F2023-03-28%2Fpdweb.log.2023-03-28-11-00-49]

Please let me know if you need anything more and will also let you know if the new add headers works","29/Mar/23 12:34 AM;5b15d9e581c3df12acf53c4a;Yes, it seems that, what I stated yesterday, i.e. allow-header or allow-header = Access-Control-Request-Headers is the main reason for failure.

Let us know how it goes.

Also, I will strongly suggest to upgrade so that other known CORS issue is not encountered once they get passed this current issue.","12/May/23 8:31 PM;60f541a6d0134900692d91b7;Hi [~accountid:5b15d9e581c3df12acf53c4a] After the workaround we suggested the customer didn't respond back and am closing the case 

Thank you for the workaround and suggestion !!!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Need to disable TSO/LRO,ISAMSUP-4783,280672,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,10/Feb/23 6:26 PM,25/Apr/23 10:13 AM,14/Jul/23 2:47 PM,25/Apr/23 10:13 AM,,Support,,0,,,,"The customer would like to disable TSO/LRO using ethtool.
He is using ISVA10.0.1 now, and observed network throughput degradation.
When the customer was using ISAM7 on the same ESXi, he disabled TSO/LRO to avoid network throughput degradation like following:

{quote}# ethtool -K ens32 tso off 
# ethtool -K ens32 lro off{quote}

So, the customer would like to have the same solution for ISVA 10.

Here are some documents which describes why he needs to disable TSO/LRO

{quote}Understanding TCP Segmentation Offload (TSO) and Large Receive Offload (LRO) in a VMware environment (2055140)
[https://kb.vmware.com/s/article/2055140|https://kb.vmware.com/s/article/2055140]
Poor TCP performance might occur in Linux virtual machines with LRO enabled (1027511)
[https://kb.vmware.com/s/article/1027511|https://kb.vmware.com/s/article/1027511]
Linux virtual machines using VMXNET3 driver experience network throughput degradation when connected to Traffic Shaping enabled Distributed vSwitch (2030927)
[https://kb.vmware.com/s/article/2030927|https://kb.vmware.com/s/article/2030927]{quote}

Is it possible to provide any solution like fix pack to disable TSO/LRO?",,Dave Bachmann,William Hannon Jr,,,,,,,,,,,,,,5af0531368ebd52c36627c3b,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011977410,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,"HONDA MOTOR CO., LTD.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i189tf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-02-14 21:48:00.287,,,,,"15/Feb/23 7:48 AM;5b17571b91981f4fdde632c1;* [https://kb.vmware.com/s/article/2030927|https://kb.vmware.com/s/article/2030927]
** [https://kb.vmware.com/s/article/2030927|https://kb.vmware.com/s/article/2030927|smart-link] 
*** *Note*: This issue does not apply to releases other than vSphere 4.1.
**** {color:#bf2600}What vSphere is the customer running?{color}","15/Feb/23 10:49 AM;5b15d9ec6d76184b7d989c83;The customer is using ESXi 6.5 EP 17(6.5.0, 14990892).


And he updated the list of related documents for the version:
  Understanding TCP Segmentation Offload (TSO) and Large Receive Offload (LRO) in a VMware environment (2055140)
  [https://kb.vmware.com/s/article/2055140|https://kb.vmware.com/s/article/2055140]

  Poor TCP performance might occur in Linux virtual machines with LRO enabled (1027511)
  [https://kb.vmware.com/s/article/1027511|https://kb.vmware.com/s/article/1027511]","17/Feb/23 3:40 AM;5b17571b91981f4fdde632c1;* [https://kb.vmware.com/s/article/2055140|https://kb.vmware.com/s/article/2055140|smart-link] 
** Best explanation of TSO
*** NIC hardware vs CPU
** {noformat}Using TSO and LRO on physical and virtual machine NICs improves
the performance of ESX/ESXi hosts by reducing the CPU overhead
for TCP/IP network operations. The host uses more CPU cycles to
run applications.


If TSO is enabled on the transmission path, the NIC divides
larger data chunks into TCP segments. If TSO is disabled, the CPU
performs segmentation for TCP/IP.{noformat}
** 
** ",22/Feb/23 1:51 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] any additional information to share with L2 on this one or should this be assigned to L2 in the Response Due field? ,"22/Feb/23 1:59 AM;5b17571b91981f4fdde632c1;For ISVA L3 Support only:

Eliminate one pointer invalid.  More research for other 2 of 3,  plus anything else.

Customer pointing to non-VMWare history why they want this, now on VMWare.

The impact to VMWare (and VMWare guests … including ISVA) is documented.  This requires a lot of research.

This one may require an Enhancement Request.



","01/Mar/23 6:23 AM;5b17571b91981f4fdde632c1;* For IBM Support only
** Before I investigate any further
*** Discussed with [~accountid:5b232b2fd85e5b59b066f57f] 
**** Waiting for status
*** Will discuss with [~accountid:5ac57757d9a96536d1f0daa9]","08/Mar/23 5:12 AM;5b17571b91981f4fdde632c1;* Same status
** Jira not updated with discussion status
*** [~accountid:5b232b2fd85e5b59b066f57f] 
** Have not had meeting with Tony to discuss
*** [~accountid:5ac57757d9a96536d1f0daa9] ","09/Mar/23 1:38 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b17571b91981f4fdde632c1] 

I understand and agree with you regarding the concerns this will have re: performance in a virtual environment. I have discussed this with Tony. 

In order to move this forward, could we not produce a version independent fix-pack to toggle tso / lro on / off and provide to the customer on the understanding that: 

# this will not be put into the product - i.e. the only way to do this going forward will be to use the fix-pack provided
# the customer is responsible for the performance outcomes of doing this and will need to test / verify the results in their environment","09/Mar/23 2:04 PM;5b17571b91981f4fdde632c1;* For ISVA L3 support only:

[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5ac57757d9a96536d1f0daa9] 

First: Let’s compare what they did on TAME 7 vs ISVA * on VMWare

On TAME 7 they changed the physical network adapter 

On ISVA * on VMWare the physical adapter is on VMWare host not VMWare guest.  I believe VMWare host can change that physical network adapter, but they would have to contact VMWare support for VMWare Support instructions and warnings.

VMWare support would also know/be able to answer if VMWare host disables setting does that prevent the VMWare guest from utilizing in VMXnet driver making the VMWare guest change moot.

So there is no need to discuss the guest VMXNet3 adapter ability to change.

Second:  ISVA will not be able debug or have the tools to debug the VMXNet3 adapter or below when any performance problems are found … if this is changed.   This will be an extreme risk.

Third: It would extremely high risk to believe if Performance team tested performance impact, that they would be able to produce/drive VMWare worst case scenario.

Fourth: This customer most likely will refuse to back off to prove any performance problem, forcing us to prove it. 

Fifth: What is the impact when VMWare host CPU is extremely high (which some customers run this way),  then performance will be even WORSE since this requires MORE CPU.  Therefore worse network performance.

These are just a few concerns, for this dangerous VMXNet3 adapter default behavior.

If this enhancement is allowed by legal definition it falls under normal Support.   It is either supported or not supported.

If we support and then IF escalated to the highest levels of IBM for any problems we cannot identify/resolve … do we really want to risk that.

A better choice would be for docker environments if possible, then it would be under their control and responsibility.","09/Mar/23 2:30 PM;5b15d9ec6d76184b7d989c83;Just to make sure that the customer is using TAM7 which is working on a linux vm on the same VMWare which is hosted on the same/identical hardware.
I think we can say to the customer that since we are not able to reproduce this network issue, we can just provide a fixpack to change them as is, and the customer need to test carefully in their own environment. We do not need to ensure anything.
I discussed with the customer about ‘fifth’ topic before, and he did not care about it since the change is working in current environment. I had requested more details for this issue, but he refused since the change is working at this point. He just wanted us to provide any way to change the params…
So providing fix pack to change the value is reasonable for this customer, I think.","11/Mar/23 8:23 AM;5b17571b91981f4fdde632c1;* {color:#bf2600}*For IBM ISVA L3 Support only*{color}
** Discussing with Performance STSM",16/Mar/23 4:41 AM;5b17571b91981f4fdde632c1;* Does the E1000 driver provide better performance than the VMXnet3?,"27/Mar/23 6:22 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b17571b91981f4fdde632c1] ,
The customer is currently using VMXNET3, and he can not try it on their production environment.
He said, he is using RHEL7 on the same ESXi 6.5, and the RHEL does not support E1000.
Does ISVA support E1000?
Does it mean E1000 can resolve this issue?
Why do you want them to try E1000?
Please answer above three questions from the customer.","04/Apr/23 12:19 AM;5b15d9ec6d76184b7d989c83;[~accountid:5b17571b91981f4fdde632c1] ,
Are there any update on this?
Any comments are really appreciated.","04/Apr/23 7:10 AM;5b17571b91981f4fdde632c1;* [https://kb.vmware.com/s/article/2077393|https://kb.vmware.com/s/article/2077393|smart-link] 
** This issue does not impact E1000 virtual adapters, because the E1000 driver does not support LRO.","05/Apr/23 10:14 AM;5b15d9ec6d76184b7d989c83;[~accountid:5b17571b91981f4fdde632c1] 
The customer does not use E1000. Please provide solution for when using VMXNET3. ","05/Apr/23 12:45 PM;5b17571b91981f4fdde632c1;* For IBM L3 Support Only
** VMWare has documented  E1000 is a suggested solution instead of VMXNET for this problem
** ISVA supports E1000 driver
*** If customer refuses to test VMWare’s suggested solution
**** Then this may require an Enhancement Request
***** Which may require extensive or unknown kernel requirements for identifying new performance problems with this configuration
****** [~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5ac577587028785d133fbc46] 
******  [~accountid:5af0531368ebd52c36627c3b] This is the problem we discussed regarding kernel performance requirements to debug any future problems","05/Apr/23 5:36 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b17571b91981f4fdde632c1] ,
From the knowledge base ([https://kb.vmware.com/s/article/2077393|https://kb.vmware.com/s/article/2077393|smart-link] ), 

{quote}When a Linux guest is configured to route IPv4 packets using the net.ipv4.ip_forwarding sysctl kernel value, you experience these symptoms:{quote}

the degradation observed when ip_forwarding is enabled, but I think it is 0 in ISVA appliance.","11/Apr/23 11:21 AM;5b15d9ec6d76184b7d989c83;[~accountid:5b17571b91981f4fdde632c1] ,
Are there any update on this issue?
Any comments are really appreciated.","11/Apr/23 11:22 AM;5b17571b91981f4fdde632c1;* Turn off ip_forwarding if on
** If off then has no bearing to this conversation.","11/Apr/23 11:49 AM;5b15d9ec6d76184b7d989c83;[~accountid:5b17571b91981f4fdde632c1] ,

As David suggested in previous comment:

{quote}In order to move this forward, could we not produce a version independent fix-pack to toggle tso / lro on / off and provide to the customer on the understanding that: 

1 . this will not be put into the product - i.e. the only way to do this going forward will be to use the fix-pack provided

2 . the customer is responsible for the performance outcomes of doing this and will need to test / verify the results in their environment{quote}

The customer just need to test it in their environment. We can say the fix pack is not solution but for investigation.
Since there’s no way to change the setting at this point, they are not able to verify if it works on their environment.
If it does not work as they expected, then we can move forward to investigate the issue in their environment.","11/Apr/23 12:05 PM;5b17571b91981f4fdde632c1;The STSM for Performance and I both disagree.  When I mentioned to Tony why, he said he agreed.

There is no way to support or debug any future problems for that configuration.

This is most likely heading toward enhancement request.

The E1000 driver is a real easy test.",11/Apr/23 12:08 PM;5af0531368ebd52c36627c3b;I don’t see how you’re going to get the customer to accept responsibility for any performance impact that they incur.,"11/Apr/23 12:16 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b17571b91981f4fdde632c1] ,

{quote}The STSM for Performance and I both disagree. When I mentioned to Tony why, he said he agreed.
There is no way to support or debug any future problems for that configuration.
This is most likely heading toward enhancement request.
The E1000 driver is a real easy test.{quote}

Thanks for the prompt response and the clear statement. Now, I can try to persuade the customer.",11/Apr/23 12:22 PM;5b17571b91981f4fdde632c1;Any ISVA with physical access to the full complement of Linux commands and debugging tools should be able to debug the kernel performance.,"25/Apr/23 10:13 AM;5b15d9ec6d76184b7d989c83;The customer agreed to close the case.
Thanks!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Please add information of ISVD 10 to ISVA 10.0.5 in Software Product Compatibility Reports site.,ISAMSUP-4779,279972,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwijono,5b15dbfa4d941a51f0da44dd,Seiji Kikuchi,5c2c1788ab1c1d35825c4da1,Seiji Kikuchi,5c2c1788ab1c1d35825c4da1,08/Feb/23 4:05 PM,16/Feb/23 7:04 AM,14/Jul/23 2:47 PM,16/Feb/23 7:04 AM,,,,0,,,,"Hello,

Checking the ISVA 10.0.5 license, the following are listed as Supporting Programs and ISVD 10 is available.

Supporting Programs:
IBM DB2 Standard Edition 11.5.7
IBM Security Directory Server 6.4
IBM QRadar Log Manager Software 7.5
IBM QRadar Event Capacity 7.5
IBM Security Directory Suite v8.0.1 Limited Edition
IBM Security Directory Integrator 7.2
IBM Security Verify Directory 10.0

Also download information of ISVA 10.0.5 shows ISVD 10 package infomation.
Download IBM Security Verify Access v10.0.5
[https://www.ibm.com/support/pages/node/6826739|https://www.ibm.com/support/pages/node/6826739|smart-link] 

But Software Product Compatibility Reports ([http://ow.ly/cWfHz)|http://ow.ly/cWfHz)|smart-link]  does not show ISVD 10 for ISVA 10.0.5.

If ISVD 10 is bundled by ISVA 10.0.5, would you please add information to Software Product Compatibility Reports?

Thanks and regards,",,Asha Shivalingaiah,,,,,,,,,,,,,,,5af4ad7d4dd24c579110120b,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,09/Feb/23 2:18 PM;seiji;Related_software_output.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182626,09/Feb/23 1:46 PM;candyyi;image-20230209-034550.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182623,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012080916,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Seiji Kikuchi,5c2c1788ab1c1d35825c4da1,,,,BENIC SOLUTION CORPORATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i185hn:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-09 03:46:05.65,,,,,"09/Feb/23 1:46 PM;5a150c74cba5b30325a6f0f0;It has shown up in the SPCR -

!image-20230209-034550.png|width=1222,height=820!","09/Feb/23 2:18 PM;5c2c1788ab1c1d35825c4da1;Hello Candy-san, [~accountid:5a150c74cba5b30325a6f0f0] 

There is SDS 6.4 and 8.0.1. But there is no ISVD 10 information in ""Related software"" output.
Would you please check it?

!Related_software_output.png|width=1334,height=939!

Thanks and regards,",09/Feb/23 6:24 PM;5a150c74cba5b30325a6f0f0;Packaging list is the right place for Supporting Programs.,"09/Feb/23 7:23 PM;5c2c1788ab1c1d35825c4da1;Hello Candy-san,  [~accountid:5a150c74cba5b30325a6f0f0] 

I understand Packaging list is the right place.

Is it possible to add ISVD 10 information on ""Related software"" like other Supporting Programs?
This is because ""Related software"" also has information such as Prerequisite minimums, which is useful for customers to confirm supported environments.
The addition of this information would be of help to us.

Thanks and regards,",10/Feb/23 11:00 AM;5a150c74cba5b30325a6f0f0;Hi [~accountid:5c2c1788ab1c1d35825c4da1] This is Product Manager/Release Manager’s call. [~accountid:5b20891f1d2d6643d2c84c65] [~accountid:5ac57757d9a96536d1f0daa9] ,"10/Feb/23 11:13 AM;5b20891f1d2d6643d2c84c65;I believe this should definitely be in the Pre-Req Tab too - all the other SDS’s are there. 
","10/Feb/23 11:52 AM;5a150c74cba5b30325a6f0f0;OK, added in 10.0.5 and 10.0.6 CH records. Should show up in SPCR later today.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"create junction with REST API and ""case_sensitive_url"":""no"" is wrong",ISAMSUP-4778,279907,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,08/Feb/23 7:34 AM,14/Feb/23 10:42 AM,14/Jul/23 2:47 PM,14/Feb/23 10:42 AM,10.0.6,,,0,,,,"L2 has reproduced the problem that was reported by the customer.

I sent the following REST API command to create a junction. Notice *""case_sensitive_url"":""no""*

curl -v -k -u admin:admin -X POST '[https://sword.toffee.lab/wga/reverseproxy/default/junctions'|https://sword.toffee.lab/wga/reverseproxy/default/junctions'] -H ""Accept: Application/json"" -H ""ontent-Type: Application/json"" -d  '{""silent"":true,""junction_point"":""/coconut"",""server_hostname"":""10.10.10.10"",""priority"":"""",""local_ip"":"""",*""case_sensitive_url"":""no""*,""authz_rules"":""no"",""windows_style_url"":""no"",""server_port"":""80"",""stateful_junction"":""no"",""http2_junction"":""no"",""http2_proxy"":""no"",""remote_http_header"":[],""cookie_include_path"":""no"",""scripting_support"":""no"",""insert_session_cookies"":""no"",""preserve_cookie"":""no"",""client_ip_http"":""no"",""junction_hard_limit"":null,""junction_soft_limit"":null,""insert_ltpa_cookies"":""no"",""tfim_sso"":""no"",""fsso_config_file"":"""",""transparent_path_junction"":""no"",""junction_type"":""tcp"",""query_contents"":"""",""server_list"":""""}'

Junction is created successfully but the pdadmin server task show output shows the opposite of what we expect. The REST API uses “case_sensitive” while the junction output uses “case *in*sensitive”. I think there is a mix-up between sensitive/*in*sensitive in the code.

pdadmin sec_master> server task default-webseald-sword.toffee.lab show /coconut
    Junction point: /coconut
    Type: TCP
    Junction hard limit: 0 - using global value
    Junction soft limit: 0 - using global value
    Active worker threads: 0
    Basic authentication mode: filter
    Forms based SSO: disabled
    TFIM junction SSO: no
    Authentication HTTP header: do not insert
    Remote Address HTTP header: do not insert
    Stateful junction: no
    Boolean Rule Header: no
    Scripting support: no
    Preserve cookie names: no
    Cookie names include path: no
    Transparent Path junction: no
    Delegation support: no
    Mutually authenticated: no
    Insert WebSphere LTPA cookies: no
    Insert WebSEAL session cookies: no
    Request Encoding: UTF-8, URI Encoded
    Server 1:
        ID: dd5979ae-a72d-11ed-b920-00155d16a83b
        Server State: unknown
        Operational State: Online
        Hostname: 10.10.10.10
        Port: 80
        Virtual hostname: 10.10.10.10
        Priority: 9
        Server DN:
        Server CN or SAN:
        local IP address:
        Query_contents URL: /cgi-bin/query_contents
        Query-contents: unknown
        *Case insensitive URLs: no*
        Allow Windows-style URLs: no
        Current requests : 1
        Total requests : 1

Also, checking the LMI shows the same mix-up. We expect the LMI to show the box is checked, indicating case insensitive URLs are enabled.

!image-20230207-213149.png|width=1061,height=631!",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,08/Feb/23 7:34 AM;rmknowle;image-20230207-213149.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182183,10/Feb/23 12:07 AM;rmknowle;image-20230209-140707.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/182782,,,,,,,,,,,,,,IJ45283,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012064667,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Reagan Knowles,5b15d9e44c4ed14b83af8723,,,,TRUIST FINANCIAL CORPORATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-02-10T09:35:53.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1854z:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-08 00:19:20.028,,,,,08/Feb/23 10:19 AM;5b15d954b0d76456f36daf33;[~accountid:5b15d9e44c4ed14b83af8723] that sounds like an APAR for sure,"08/Feb/23 2:55 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 4e73fbddcc87b9f5be25134a5dd5ee182ce7fbcf
   * description: ISAMSUP-4778 Match RAPI parameter name with LMI

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84291812.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4778) which we publish.","08/Feb/23 3:19 PM;5b15d954b0d76456f36daf33;[~accountid:5b15d9e44c4ed14b83af8723] I’ve corrected the RAPI parameter name from sensitive -> insensitive so that it matches what the LMI says. Unfortunately there isn’t much we can do at the present versions. Just have to use it to mean the opposite when using it in a RAPI call.

Let me know when the APAR is created.","08/Feb/23 4:44 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a3baff0a2e65cd951fc166f850416a28766de3e8
   * description: ISAMSUP-4778 Match RAPI parameter name with LMI (#5680)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84295533.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230208064115-a3baff0a2.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","08/Feb/23 6:06 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a3baff0a2e65cd951fc166f850416a28766de3e8
   * description: ISAMSUP-4778 Match RAPI parameter name with LMI (#5680)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84299995.


This build has not been published as the commit is not currently within a branch (20230208064115-a3baff0a2) which we publish.",09/Feb/23 12:40 AM;5b15d9e44c4ed14b83af8723;I created APAR IJ45283 for this issue.{color:#ffffff}IJ45283{color} {color:#ffffff}IJ45283IJ45283for{color},"09/Feb/23 1:05 AM;5b15d9e44c4ed14b83af8723;I doubt that we need a fixpack for this issue. Once you understand what is happening, just switch the value in the JSON body.","10/Feb/23 12:07 AM;5b15d9e44c4ed14b83af8723;Just thought of something… Do we need to update the REST API documentation to match the change you made? 


!image-20230209-140707.png|width=1239,height=562!",10/Feb/23 8:12 AM;5b15d954b0d76456f36daf33;I have changed all those RAPI doc references as part of this APAR fix. But you can grab a nightly build and check.,"10/Feb/23 9:35 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a3baff0a2e65cd951fc166f850416a28766de3e8
   * description: ISAMSUP-4778 Match RAPI parameter name with LMI (#5680)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84295533.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230209233304-a3baff0a2.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","10/Feb/23 10:52 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a3baff0a2e65cd951fc166f850416a28766de3e8
   * description: ISAMSUP-4778 Match RAPI parameter name with LMI (#5680)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84462947.


This build has not been published as the commit is not currently within a branch (20230209233304-a3baff0a2) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unavailable appliance via LMI (LMI did not work),ISAMSUP-4758,278723,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,01/Feb/23 12:21 AM,20/Feb/23 9:02 AM,14/Jul/23 2:47 PM,20/Feb/23 9:02 AM,,Support,,0,,,,"The customer said: “

During the night one of our Appliance was unavailable via LMI. We could reach it via CLI, but did not see any errors in LMI logs. LMI restart did not solve the issue from CLI, just a whole reboot of the Appliance. Before we restarted it, we could create a support file.”

Java dump is uploaded in the case. ",,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011951098 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,Volkswagen AG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17xyb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-31 22:49:23.829,,,,,"01/Feb/23 8:49 AM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] it is not clear to me what is being asked of L3.

An RCA of why LMI did not start at that one time? 

What have you discovered so far and what specific information do you need?","02/Feb/23 1:38 AM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] So far I found that the disk space is not full and they do have specific ciphers for the LMI.

The customer said:” There was not any change on that appliance. We got messages from our monitoring system that the appliance was not available.”

I found this in the log:

Jan 26 00:00:04 mesa_config[19041]: Creating certificate database /opt/IBM/wlp/usr/servers/default/certs/lmi.p12
Jan 26 00:00:05 mesa_config[19041]: Creating default lmi certificate for vaf201p008.wob.vw.vwg
Jan 26 00:00:07 mesa_config[19041]: Starting App Server

It looks like the LMI cert is renewing. Is it correct? 

It may trigger the monitoring system to send the msg. ","04/Feb/23 12:37 AM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] I explained to the customer what happened (LMI cert renew). 

Could you confirm is it normal after the LMI cert auto renew then LMI cannot be started.

It need to reboot?","06/Feb/23 1:50 PM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] I don’t think renewing a cert by itself is a reason for the LMI failing to start.

Do we have a data time stamp of when the customer experienced this problem? Looking into the LMI logs (including any rolled over files) corresponding to that time period, and correlating those with the system log might provide additional clues.","11/Feb/23 1:54 AM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] The customer uploaded the LMI (within the support file). 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011951098&path=TS011951098%2F2023-01-31%2Fisva_10.0.5.0_20230131-130153_vaf201p008.wob.vw.vwg.support_unpack%2Ftmp%2Fliberty_dump.zip_unpack%2Flogs%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011951098&path=TS011951098%2F2023-01-31%2Fisva_10.0.5.0_20230131-130153_vaf201p008.wob.vw.vwg.support_unpack%2Ftmp%2Fliberty_dump.zip_unpack%2Flogs%2F]

They said “the appliance was unavailable around 2023.01.26 0:43 am in German time.”","13/Feb/23 10:57 AM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] I can’t find any reference to that time in the LMI logs from any of the support files.

The only entries in the system log are these. As you can see there isn’t much to go on there.

{noformat}Jan 26 00:43:31 mesa_config[12793]: GLGSY0020I:: GLG_events:: |user=w5pn04z|
Jan 26 00:43:31 mesa_config[12793]: GLGSY0103I:: GLG_events:: |user=w5pn04z,host=10.186.52.154|
Jan 26 00:43:33 su: + none root:www-data
Jan 26 00:43:33 mesa_config[12847]: WGAWA0311I   The server is available.
Jan 26 00:43:34 mesa_config[12939]: GLGSY0020I:: GLG_events:: |user=w5pn04z|
Jan 26 00:43:34 mesa_config[12939]: GLGSY0103I:: GLG_events:: |user=w5pn04z,host=10.186.52.154|
Jan 26 00:43:36 mesa_config[12981]: GLGSY0020I:: GLG_events:: |user=w5pn04z|
Jan 26 00:43:36 mesa_config[12981]: GLGSY0103I:: GLG_events:: |user=w5pn04z,host=10.186.52.154|
Jan 26 00:43:37 mesa_config[13027]: GLGSY0020I:: GLG_events:: |user=w5pn04z|
Jan 26 00:43:37 mesa_config[13027]: GLGSY0103I:: GLG_events:: |user=w5pn04z,host=10.186.52.154|
Jan 26 00:43:38 mesa_config[13073]: GLGSY0020I:: GLG_events:: |user=w5pn04z|
Jan 26 00:43:38 mesa_config[13073]: GLGSY0103I:: GLG_events:: |user=w5pn04z,host=10.186.52.154|{noformat}","13/Feb/23 6:17 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Thanks for checking it. I will explain it to the customer.

Thanks 🙂 ","13/Feb/23 6:37 PM;6092aca0f0db130069d19687;Could you advise IF the customer wants to find out the root cause? What do they need to do to gather the trace we need?

Please advise","13/Feb/23 7:43 PM;5b15d954b0d76456f36daf33;Like I said in my first comment, it wasn’t clear what is the issue to be investigated or what is it you were seeking from L3",13/Feb/23 8:25 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] The issue is : the customer received a system alarm saying LMI is not available. When they try to check it LMI will not load. They did try restarting LMI in CLI without success. So they have to reboot the appliance and LMI will then load. The customer would like to know how to prevent this from happening again. I worked with Carlos. We went through the support file. The appliance is not disk full and no cipher changed. We found the time stamp of the LMI cert renewed automatically same as the system alarm is sent to the customer.,14/Feb/23 6:39 PM;5b15d954b0d76456f36daf33;Given we have no LMI logs pertaining to the time they said the issue happened. There isn’t much we can deduce as to what caused it. Or recommend how to prevent it.,"14/Feb/23 7:07 PM;6092aca0f0db130069d19687;Yes I understand. Could you advise is there a way in CLI to collect the LMI trace, please? So I can advise the customer if it happens again. Will normal support file be suitbale for you to trouble shoot?  ","14/Feb/23 7:24 PM;5b15d954b0d76456f36daf33;You can monitor the logs from cli using {{isam logs monitor}} command and choosing the appropriate service.

Yes, a support file collection during or just after such an occurence should contain relevant information for troubleshooting.",14/Feb/23 7:41 PM;6092aca0f0db130069d19687;Thanks Bhavan. I will let the customer know it. I hope they agree to close the case. ,20/Feb/23 9:02 AM;5b15d954b0d76456f36daf33;Case marked for closure.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
High memory utilization on ISVA appliance running WebSEAL,ISAMSUP-4757,278717,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Peter Horner,5b15d9517dab4c51f61b5190,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,31/Jan/23 11:22 PM,03/Jul/23 9:29 AM,14/Jul/23 2:47 PM,,,Support,,0,Growth,,,"Web reverse proxy (WebSEAL) instances on our production servers stopped by themselves. Before WebSEALS stopped high memory utilization 95%+ had been observed on all machines.

They are not using WAF.

The environment itself is old, dating back many years - and was upgraded to version 10.0.4 IF1 December 1st 2022

Daniel is helping me:

He found that the steps in the graph (provided by customer in the case) seem to correspond to the webseal reqest log file rollover. This is creating log files up to about 2GB in size.

He suggested to change as below:

logcfg = http.clf:file path=/var/pdweb/webseal2p/log/webseal2p_request.log,log_id=clf,queue_size=96,buffer_size=16384,flush_interval=20,rollover_size=300000000 ,max_rollover_files=40 

The customer had changed the request log as we suggested.  They reported back it is still not freeing memory.",,BRIANORO,Daniel Comeau,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,6154906364ff01007106e189,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,ISAMSUP-4460,,,,,,,13/Feb/23 7:21 PM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;image-20230213-092148.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/183446,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011794922 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,NORDEA BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17xxj:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-02 19:32:55.41,,,,,03/Feb/23 5:32 AM;5b17571b91981f4fdde632c1;* Where is your memory analysis?,03/Feb/23 6:09 PM;6092aca0f0db130069d19687;The screenshot is here: [https://ecurep.mainz.de.ibm.com/rest/download/TS011794922/2023-01-31/20230131-production-memory_utilization_after_enabling_log_rolover.jpg?fileSize=65961&clientId=ae5|https://ecurep.mainz.de.ibm.com/rest/download/TS011794922/2023-01-31/20230131-production-memory_utilization_after_enabling_log_rolover.jpg?fileSize=65961&clientId=ae5],"13/Feb/23 7:21 PM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] 

!image-20230213-092148.png|width=1186,height=487!

You can see the memory uasge shot  up steadily untill it reach almost 100% then the customer reboot it then it come back down then shot up again.","14/Feb/23 12:09 AM;5b17571b91981f4fdde632c1;* Critical this answer be accurate
** Does this occur on all similar business instances
*** Is there non-similar business instances that this problem does not occur
** Do we have failing core file(s)?",14/Feb/23 12:11 AM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] Thanks for your reply. I will get the answer and come back to you shortly.,"14/Feb/23 12:21 AM;5b17571b91981f4fdde632c1;If my question(s) are not clear, then ask question(s).","15/Feb/23 6:37 PM;6092aca0f0db130069d19687;Hello William,

The customer replied as below: 

Issue with WebSEAL instances stopping by themselves reoccurred on our production yesterday. I will be attaching additional support files and screenshot showing memory utilization.

Answering to you questions:

* _Does this(high memory utilization) occur on all similar business instances?_

Yes

* _Are there non-similar business instances that this problem((high memory utilization) does not occur_

Yes. We are running WebSEAL on 6 machines and AAC/Policy Server/FED on 4 on our production. Machines and AAC/Policy Server/FED are not affected.

* If so is it possible to have the failing core file(s), please?

I'll add support files to this ticket. I'll need instruction how and when to generate core files that you requested if this files are not included in support file.

Can you propose next course of action?

PS. We add additional 16 GB of RAM to WebSEAL appliances on production makin it 32 GB. It should be done next week. On the other hand (as mentioned before) I do not see adding more memory as solution of problem.”

*My question:*

*The failing core file(s)? Do you mean java core file? Please advise*

*CLI - diagnostics → core_dumps → generate* 

*How do we know which PID is failing?* ",20/Feb/23 6:03 AM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] Is there any update? ,21/Feb/23 2:31 AM;5b17571b91981f4fdde632c1;* Reviewing 2023-02-15 ecurep data,"21/Feb/23 4:26 AM;5b17571b91981f4fdde632c1;{quote}*My question:*

*The failing core file(s)? Do you mean java core file? Please advise*

*CLI - diagnostics → core_dumps → generate*

*How do we know which PID is failing?*{quote}

* CLI diagnostics → ps
** Which provides this data
***   PID  PPID USER     STAT   VSZ {color:#bf2600}*%VSZ*{color} CPU %CPU COMMAND
**** *NOTE: There may be NO space between VSZ and %VSZ data*
***** 12364     1 www-data S    {color:#bf2600}3291m339.4{color}   3  0.0 …
****** So be careful  parsing ","21/Feb/23 4:46 AM;5b17571b91981f4fdde632c1;* Please review
** TS011794922/2023-01-10/isva_10.0.4.0_20230110-161209_ap-ninaa-prod-webseal4p.support_unpack/core_file_stack_trace/core_webseald.6819.stack
*** What do you notice?","21/Feb/23 4:53 AM;5b17571b91981f4fdde632c1;* /config_data__
** What do you notice?

{noformat}webseal1p/log/config_data__webseal1p-webseald-ap-ninaa-prod-webseal1p-adm1.oneadr.net.log:Sat Jan 28 22:42:26 2023

webseal3p/log/config_data__webseal3p-webseald-ap-ninaa-prod-webseal3p-adm1.oneadr.net.log:Sat Jan 28 23:19:57 2023

webseal4p/log/config_data__webseal4p-webseald-ap-ninaa-prod-webseal4p-adm1.oneadr.net.log:Sat Jan 28 23:27:43 2023

-- 

webseal2p/log/config_data__webseal2p-webseald-ap-ninaa-prod-webseal2p-adm1.oneadr.net.log:Sat Jan 28 22:52:06 2023
-
webseal2p/log/config_data__webseal2p-webseald-ap-ninaa-prod-webseal2p-adm1.oneadr.net.log:Tue Feb 14 15:55:43 2023
webseal2p/log/config_data__webseal2p-webseald-ap-ninaa-prod-webseal2p-adm1.oneadr.net.log:Tue Feb 14 15:58:53 2023

webseal5p/log/config_data__webseal5p-webseald-ap-ninaa-prod-webseal5p-adm1.oneadr.net.log:Sat Jan 28 23:32:57 2023
-
webseal5p/log/config_data__webseal5p-webseald-ap-ninaa-prod-webseal5p-adm1.oneadr.net.log:Tue Feb 14 16:24:03 2023
webseal5p/log/config_data__webseal5p-webseald-ap-ninaa-prod-webseal5p-adm1.oneadr.net.log:Tue Feb 14 16:26:21 2023

webseal6p/log/config_data__webseal6p-webseald-ap-ninaa-prod-webseal6p-adm1.oneadr.net.log:Sat Jan 28 23:34:07 2023
-
webseal6p/log/config_data__webseal6p-webseald-ap-ninaa-prod-webseal6p-adm1.oneadr.net.log:Tue Feb 14 13:36:39 2023
webseal6p/log/config_data__webseal6p-webseald-ap-ninaa-prod-webseal6p-adm1.oneadr.net.log:Tue Feb 14 13:39:34 2023{noformat}","21/Feb/23 5:05 AM;5b17571b91981f4fdde632c1;* For the failing WebSEALs from below
** Any failing messages in WebSEAL logs around those times?
** Any failing messages in dmesg.txt near the bottom?
** Any failing  webseal messages /var/log/messages* around those times?","25/Feb/23 8:05 AM;614dd52af1c1740068534813;Alan Is out of the office and I am assisting on this case



* *TS011794922/2023-01-10/isva_10.0.4.0_20230110-161209_ap-ninaa-prod-webseal4p.support_unpack/core_file_stack_trace/core_webseald.6819.stack*
** *What do you notice?*

Multiple:

Thread 3279 (LWP 9055):
#0  0x00007f3001bf6a22 in ?? ()
No symbol table info available.
#1  0x0000000000000000 in ?? ()
No symbol table info available.

No idea what it means, searched old cases, JIRAS, Watson but no joy



*config_data__*

* *What do you notice?*

ie. isva_10.0.4.0_20230214-162344_ap-ninaa-prod-webseal4p.support_unpack/var/pdweb/webseal4p/log/config_data__webseal4p-webseald-ap-ninaa-prod-webseal4p-adm1.oneadr.net.log

I noticed the setting for the stanzas. Is there anything specific I should look for?



* *Any failing messages in dmesg.txt near the bottom?*

ie. 2023-02-09/isva_10.0.2.0_20230208-215346_isva1.support_unpack/tmp/dmesg.txt

{noformat}0.323200] pci 0000:00:10.0: BAR 6: assigned [mem 0xc0008000-0xc000bfff pref]
[    0.323203] pci 0000:00:15.3: BAR 13: no space for [io  size 0x1000]
[    0.323204] pci 0000:00:15.3: BAR 13: failed to assign [io  size 0x1000]
[    0.323206] pci 0000:00:15.4: BAR 13: no space for [io  size 0x1000]
[    0.323207] pci 0000:00:15.4: BAR 13: failed to assign [io  size 0x1000]
[    0.323209] pci 0000:00:15.5: BAR 13: no space for [io  size 0x1000]
[    0.323210] pci 0000:00:15.5: BAR 13: failed to assign [io  size 0x1000]
[    0.323212] pci 0000:00:15.6: BAR 13: no space for [io  size 0x1000]
[    0.323213] pci 0000:00:15.6: BAR 13: failed to assign [io  size 0x1000]
[    0.323214] pci 0000:00:15.7: BAR 13: no space for [io  size 0x1000]
[    0.323215] pci 0000:00:15.7: BAR 13: failed to assign [io  size 0x1000]
{noformat}

The failing message I have found but no idea what it means




* *Any failing webseal messages /var/log/messages* around those times?*

I noticed multiple _DPWWA1120E The POST body of the client request contains misformatted or invalid data_ And _DPWAD0411E The TCP/IP host information could not be determined from the server hostname_

So I asked the customer:

Multiple *_DPWWA1120E The POST body of the client request contains misformated or invalid data_* error messages each minute, I think this message could be related to load balancer health check, is there any load balancer? if so, is it doing a POST to WebSEAL for the health check?

*_DPWAD0411E The TCP/IP host information could not be determined from the server hostname_* in multiple times. WebSEAL seems to be unable to resolve the DNS name, is there any kind of problem with the DNS? or any network issue that could prevent ISAM from reaching the DNS? , is there any firewall or any reason why the ISAM will not be able to contact the DNS ?","08/Mar/23 8:34 AM;5b17571b91981f4fdde632c1;* No symbol table info available.
** Enable environment variable
*** MALLOC_CHECK_=3

{quote}*_DPWAD0411E The TCP/IP host information could not be determined from the server hostname_* in multiple times. WebSEAL seems to be unable to resolve the DNS name, is there any kind of problem with the DNS? or any network issue that could prevent ISAM from reaching the DNS? , is there any firewall or any reason why the ISAM will not be able to contact the DNS ?{quote}

* IP traces would confirm
** However why the DNS server is not responding would the customer’s responsibility



{quote}config_data__{quote}

* Notice the restart times which one of the useful data pieces from config_data__
** Did they all fail near the same times
*** -or-
** Were they restarted for different reason","08/Mar/23 8:46 AM;5b17571b91981f4fdde632c1;{quote}dmesg.txt{quote}

* Try checking all dmesg.txt again
** for FILE in {{find . -type f -print | grep '/dmesg.txt$'}}; do echo "">> FILE""; tail -5 $FILE; done
*** One command quickly changes the view
**** 5 lines is *not* always safe
***** But safe for what I wanted
* Now what do you see that was missed
** Why was it missed before?
*** The question above is for yourself

{noformat}>>	2023-02-15/isva_10.0.4.0_20230214-161756_ap-ninaa-prod-webseal1p.support_unpack/tmp/dmesg.txt
[12761.841266] ICMPv6: process `sysctl' is using deprecated sysctl (syscall) net.ipv6.neigh.default.base_reachable_time - use net.ipv6.neigh.default.base_reachable_time_ms instead




>>	2023-01-10/isva_10.0.4.0_20230110-153945_ap-ninaa-prod-webseal2p.support_unpack/tmp/dmesg.txt
[1005546.042389]  start_secondary+0x19b/0x1e0
[1005546.042393]  secondary_startup_64_no_verify+0xc2/0xcb
[1005546.042396] ---[ end trace 1c2f7b5f5d5eb211 ]---
[1005546.042415] e1000 0000:02:02.0 eth2: Reset adapter
[1005546.088651] e1000: eth2 NIC Link is Up 1000 Mbps Full Duplex, Flow Control: None




>>	2023-02-15/isva_10.0.4.0_20230214-163521_ap-ninaa-prod-webseal2p.support_unpack/tmp/dmesg.txt
[6526916.849998] sh[10324]: segfault at 0 ip 00000000004b6183 sp 00007ffe4b932200 error 4 in busybox.static[400000+2b2000]
[6526916.850004] Code: 89 d3 48 81 ec 28 04 00 00 64 48 8b 04 25 28 00 00 00 48 89 84 24 18 04 00 00 31 c0 48 8d 05 e9 22 1c 00 48 89 c2 85 ff 75 52 <80> 7d 00 00 48 8d 0d d7 22 1c 00 4c 8d 05 c9 25 1c 00 4c 0f 44 c1




>>	2023-01-10/isva_10.0.4.0_20230110-155850_ap-ninaa-prod-webseal3p.support_unpack/tmp/dmesg.txt
[883583.779500] traps: webseald[29662] general protection fault ip:7f327c1bfbe0 sp:7f31d7b86db8 error:0 in libamaudutl.so[7f327c17b000+5b000]




>>	2023-02-15/isva_10.0.4.0_20230214-162111_ap-ninaa-prod-webseal3p.support_unpack/tmp/dmesg.txt
[2597102.022090] ICMPv6: process `sysctl' is using deprecated sysctl (syscall) net.ipv6.neigh.default.base_reachable_time - use net.ipv6.neigh.default.base_reachable_time_ms instead
[2853002.116148] hrtimer: interrupt took 6889387 ns




>>	2023-01-10/isva_10.0.4.0_20230110-161209_ap-ninaa-prod-webseal4p.support_unpack/tmp/dmesg.txt
[    8.184582] e1000: eth5 NIC Link is Up 1000 Mbps Full Duplex, Flow Control: None
[    8.185614] IPv6: ADDRCONF(NETDEV_CHANGE): eth5: link becomes ready
[    8.448943] fuse: init (API version 7.33)
[    8.992063] IPv6: ADDRCONF(NETDEV_CHANGE): eth3: link becomes ready
[   30.796108] NET: Registered protocol family 40




>>	2023-02-15/isva_10.0.4.0_20230214-162344_ap-ninaa-prod-webseal4p.support_unpack/tmp/dmesg.txt
[6452818.620984]  start_kernel+0x51d/0x53d
[6452818.620990]  secondary_startup_64_no_verify+0xc2/0xcb
[6452818.620993] ---[ end trace 9fc9426e0aa2b600 ]---
[6452818.621009] e1000 0000:02:00.0 eth0: Reset adapter
[6452818.667331] e1000: eth0 NIC Link is Up 1000 Mbps Full Duplex, Flow Control: None




>>	2023-01-10/isva_10.0.4.0_20230110-162409_ap-ninaa-prod-webseal5p.support_unpack/tmp/dmesg.txt
[2585814.089506] [   2423]     0  2423   106120      574   376832     2422             0 wga_watchdogd
[2585814.089507] [   2431]  5001  2431  4813116  3852070 37523456   471867             0 webseald
[2585814.089509] oom-kill:constraint=CONSTRAINT_NONE,nodemask=(null),cpuset=/,mems_allowed=0,global_oom,task_memcg=/,task=webseald,pid=2431,uid=5001
[2585814.096055] Out of memory: Killed process 2431 (webseald) total-vm:19252464kB, anon-rss:15408280kB, file-rss:0kB, shmem-rss:0kB, UID:5001 pgtables:36644kB oom_score_adj:0
[2585815.489751] oom_reaper: reaped process 2431 (webseald), now anon-rss:0kB, file-rss:0kB, shmem-rss:0kB




>>	2023-02-15/isva_10.0.4.0_20230214-163700_ap-ninaa-prod-webseal5p.support_unpack/tmp/dmesg.txt
[5618002.551398] [  20696]  5001 20696  4795771  3826380 37306368   461759             0 webseald
[5618002.551400] [   4929]     0  4929    10288       49   106496        0             0 chronyc
[5618002.551402] oom-kill:constraint=CONSTRAINT_NONE,nodemask=(null),cpuset=/,mems_allowed=0,global_oom,task_memcg=/,task=webseald,pid=20696,uid=5001
[5618002.554490] Out of memory: Killed process 20696 (webseald) total-vm:19183084kB, anon-rss:15305520kB, file-rss:0kB, shmem-rss:0kB, UID:5001 pgtables:36432kB oom_score_adj:0
[5618003.607751] oom_reaper: reaped process 20696 (webseald), now anon-rss:0kB, file-rss:0kB, shmem-rss:0kB




>>	2023-01-10/isva_10.0.4.0_20230110-161247_ap-ninaa-prod-webseal6p.support_unpack/tmp/dmesg.txt
[    8.307811] e1000: eth5 NIC Link is Up 1000 Mbps Full Duplex, Flow Control: None
[    8.308791] IPv6: ADDRCONF(NETDEV_CHANGE): eth5: link becomes ready
[    8.583775] fuse: init (API version 7.33)
[    9.120085] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready
[   31.012024] NET: Registered protocol family 40




>>	2023-02-15/isva_10.0.4.0_20230214-134313_ap-ninaa-prod-webseal6p.support_unpack/tmp/dmesg.txt
[6516315.975056] [   2696]     0  2696      776       11    36864        0             0 sh
[6516315.975057] oom-kill:constraint=CONSTRAINT_NONE,nodemask=(null),cpuset=/,mems_allowed=0,global_oom,task_memcg=/,task=webseald,pid=20995,uid=5001
[6516315.979420] Out of memory: Killed process 20995 (webseald) total-vm:19228428kB, anon-rss:15122280kB, file-rss:0kB, shmem-rss:0kB, UID:5001 pgtables:36388kB oom_score_adj:0
[6516317.550962] oom_reaper: reaped process 20995 (webseald), now anon-rss:0kB, file-rss:0kB, shmem-rss:0kB
[6517794.760312] traps: webseald[10280] general protection fault ip:7f1063865be0 sp:7f0fd224fdb8 error:0 in libamaudutl.so[7f1063821000+5b000]{noformat}","08/Mar/23 8:52 AM;5b17571b91981f4fdde632c1;* TS011794922/2023-02-15/*/var/log/messages
** Are not WebSEAL messages
*** Please redo","08/Mar/23 8:53 AM;5b17571b91981f4fdde632c1;* TS011794922/2023-01-10/isva_10.0.4.0_20230110-161209_ap-ninaa-prod-webseal4p.support_unpack/core_file_stack_trace/core_webseald.6819.stack
** Will wait for other analysis to be completed.","10/Mar/23 1:27 AM;5b15d9a0dda5f94d06b985b3;Hi Bill,

Alan asked me for help with this.    I just want to make sure we’re all on the same page.    The case was opened up to debug a webseal memory consumption issue.   From your updates (looking for messages in the log file when the instance was restarted, looking at the core_webseald.6819.stack, etc, it feels more like you’re thinking that this is a crash issue and not a memory issue.    I just wanted to make sure we’re all on the same page.

And as for analyzing the core file, we really don’t know what you’re looking for.   About the only thing we see is this



{noformat}Core was generated by `/opt/pdweb/bin/webseald -config etc/webseald-webseal4p.conf -foreground -noenv'.
Program terminated with signal SIGABRT, Aborted.
#0  0x00007f3001041517 in ?? ()
[Current thread is 1 (LWP 11181)]{noformat}


which will point to this


{noformat}Thread 1 (LWP 11181):
#0  0x00007f3001041517 in ?? ()
No symbol table info available.
#1  0x00007f3001042c08 in ?? ()
No symbol table info available.
#2  0x0000000000000020 in ?? ()
No symbol table info available.
#3  0x0000000000000000 in ?? ()
No symbol table info available.{noformat}


But I really don’t know what this is supposed to tell us as far as why the webseal memory usage keeps growing and growing.




",13/Mar/23 10:15 PM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] Is there any update? The customer is seeking update.,"16/Mar/23 6:10 AM;5b17571b91981f4fdde632c1;* Very long conference call with L2 Daniel Comeau
** Went over what was missed by L2
** Next steps
*** Daniel could you summarize next steps here
**** I will review and comment if anything missing or else","16/Mar/23 7:07 AM;5b15d9a0dda5f94d06b985b3;As Bill mentioned we had a long discussion on this.

As far as action plan, there are a few key things we need to focus on.

First, we need to clarify a few things with the customer..

* is this impacting a single instance on a single appliance, the same instance across all appliances, all instances on a single appliance, all instances on all appliances, etc.
* is this reproducible in a non-prod environment to make the debugging easier?   or only prod?

Next, the recommendation is to set webseal environment variable MALLOC_CHECK=3 in as many instances as the customer is comfortable setting it.    This does some sanity checking of the memory operations.   If webseal tries to do something “bad” with the memory, it can cause webseal to crash and generate a stack dump which can then give us information to help debug that issue.

Along with that, to debug the memory usage we need to understand how the memory is used or allocated.    Do do this, we need core dumps of the webseal process over a period of time as the memory grows,, without letting the process crash due to out of memory.    If we do this on one of the systems where memory grows the fastest, then we can get this faster than a slower growing instance.    The plan would be as follows.

I believe the customer has already setup a process to re-start webseal off hours before it crashes due to out of memory…..ie a controlled restart.   We would want generate the core file of the one webseald process we will be focusing on (ideally the worst one) and then generate the support file containing “System” at the following times…

1)  a few hours after the instance as been restarted
2)  right before you re-start the instance to prevent it from crashing
3) 2 more times approximately evenly spaced between 1 and 2

So for example if you are re-starting the instance every 12 days to prevent it from crashing from the out of memory issues, you could generate core files something like 
- a few hours after restart
- day 4 or 5 
- day 9 or 10
- day 14 before you restart the instance

As you get the support files, they can be uploaded to us for investigation.    If an instance crashes, then that also needs a support file.

The customer should be aware that when the core is generated, it will use up close to the amount of disk space that the process was using in memory at the time of the core.    So as you progress, the core files will get bigger and bigger, so they need to ensure they have disk space enough to generate the core and the suppport file.    Once the support .file is generated it will delete the core from the appliance so there should be no need to clean it up manually.","16/Mar/23 10:15 AM;5b17571b91981f4fdde632c1;* *Very thourough*
* Few corrections
** [https://man7.org/linux/man-pages/man3/mallopt.3.html|https://man7.org/linux/man-pages/man3/mallopt.3.html|smart-link] 
*** MALLOC_CHECK_=3
**** Has trailing underbar
*** “which can then give us information to help debug that issue.”
**** “which may give us more information”
***** Not a guarantee
*** “I believe the customer has already setup a process to re-start webseal off hours before it crashes due to out of memory…..ie a controlled restart.”
**** Should be temporarily suspended on system we are collecting cores from
***** Restarted after fully completed
*** Assuming ~12 days (shortest mean-time-to-failure)
**** I would suggest finishing on day 10-11 to be finished by day 12
**** So the gcores would be 0, 3, 6, 10
***** What happens any of these days are during weekend?",29/Mar/23 2:24 AM;5b17571b91981f4fdde632c1;* What is status?,29/Mar/23 3:11 AM;5b15d901fa615349cb01778b;Waiting on the customer to provide data,25/Apr/23 2:11 AM;5b17571b91981f4fdde632c1;* What is status?,"25/Apr/23 2:16 AM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] The cutomer said “ yes, we are still planning to follow up on instructions, most probably between 17-30 Apr (during next sprint).”","08/May/23 8:14 PM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] the customer produced the core files here:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011794922&path=TS011794922%2F2023-05-08%2Fisva_10.0.5.0_20230508-095319_ap-ninaa-aite-webseal2t.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011794922&path=TS011794922%2F2023-05-08%2Fisva_10.0.5.0_20230508-095319_ap-ninaa-aite-webseal2t.support_unpack%2F]

They said “After reducing memory to 4GB we was able to make the reverse proxy crash with MALLOC_CHECK_=3 set.”","09/May/23 8:13 AM;5b17571b91981f4fdde632c1;* crashmap with matching core

{noformat}-rw-rw-r--. 1 whannon sftpusers 40666 May  1 23:20 isva_10.0.5.0_20230508-095319_ap-ninaa-aite-webseal2t.support_unpack/var/support/crashmap_webseald-webseal2t.2152
isva_10.0.5.0_20230508-095319_ap-ninaa-aite-webseal2t.support_unpack/core_file_stack_trace/core_webseald.2152.stack
Core was generated by `/opt/pdweb/bin/webseald -config etc/webseald-webseal2t.conf -foreground -noenv'.
Program terminated with signal SIGABRT, Aborted.
#0  0x00007f749f534a9f in raise () from /lib64/libc.so.6

Thread 4204 (Thread 0x7f7459412700 (LWP 3940)):
#0  0x00007f749f56b09b in rename () from /lib64/libc.so.6
#1  0x00007f74a31821f9 in crashHandler(int, siginfo_t*, void*) () from /usr/lib64/libwsdaemon.so
#2  <signal handler called>
#3  0x00007f749f534a9f in raise () from /lib64/libc.so.6
#4  0x00007f749f507e05 in abort () from /lib64/libc.so.6
#5  0x00007f749fed509b in __gnu_cxx::__verbose_terminate_handler() [clone .cold.1] () from /usr/lib64/libstdc++.so.6
#6  0x00007f749fedb53c in __cxxabiv1::__terminate(void (*)()) () from /usr/lib64/libstdc++.so.6
#7  0x00007f749fedb597 in std::terminate() () from /usr/lib64/libstdc++.so.6
#8  0x00007f749fedb7f8 in __cxa_throw () from /usr/lib64/libstdc++.so.6
#9  0x00007f749fedbdb4 in operator new(unsigned long) () from /usr/lib64/libstdc++.so.6

Thread 1 (Thread 0x7f74595d9700 (LWP 3933)):
#0  0x00007f749f534a9f in raise () from /lib64/libc.so.6
#1  0x00007f749f507e05 in abort () from /lib64/libc.so.6
#2  0x00007f749fedd7ba in __gnu_cxx::__verbose_terminate_handler() () from /usr/lib64/libstdc++.so.6
#3  0x00007f749fedb53c in __cxxabiv1::__terminate(void (*)()) () from /usr/lib64/libstdc++.so.6
#4  0x00007f749fedb597 in std::terminate() () from /usr/lib64/libstdc++.so.6
#5  0x00007f749fedb7f8 in __cxa_throw () from /usr/lib64/libstdc++.so.6
#6  0x00007f749fedbdb4 in operator new(unsigned long) () from /usr/lib64/libstdc++.so.6{noformat}




For ISVA L3 Support only:

* [~accountid:5b15d9517dab4c51f61b5190] Not the same as the memory free (growth) … have you seen this before?

{noformat}-rw-rw-r--. 1 whannon sftpusers 40666 Apr 29 07:08 isva_10.0.5.0_20230508-095319_ap-ninaa-aite-webseal2t.support_unpack/var/support/crashmap_webseald-webseal2t.22153
isva_10.0.5.0_20230508-095319_ap-ninaa-aite-webseal2t.support_unpack/core_file_stack_trace/core_webseald.22153.stack
Thread 1 (Thread 0x7fc4c63f0700 (LWP 25515)):
#0  0x00007fc52fb94a9f in raise () from /lib64/libc.so.6
#1  0x00007fc52fb67e05 in abort () from /lib64/libc.so.6
#2  0x00007fc53053509b in __gnu_cxx::__verbose_terminate_handler() [clone .cold.1] () from /usr/lib64/libstdc++.so.6
#3  0x00007fc53053b53c in __cxxabiv1::__terminate(void (*)()) () from /usr/lib64/libstdc++.so.6
#4  0x00007fc53053b597 in std::terminate() () from /usr/lib64/libstdc++.so.6
#5  0x00007fc53053b84d in __cxa_rethrow () from /usr/lib64/libstdc++.so.6
#6  0x00007fc531b3d69a in tivsec_xml4c_6_0::SAX2XMLReaderImpl::parse(tivsec_xml4c_6_0::InputSource const&) () from /usr/lib64/libtivsec_xml4c.so
#7  0x00007fc532133a57 in tivsec_xslt4c_1_12::XalanSourceTreeParserLiaison::parseXMLStream(tivsec_xml4c_6_0::InputSource const&, tivsec_xslt4c_1_12::XalanDOMString const&) () from /usr/lib64/libtivsec_xslt4c.so.112
#8  0x00007fc5322453e9 in tivsec_xslt4c_1_12::XalanDefaultParsedSource::XalanDefaultParsedSource(tivsec_xml4c_6_0::InputSource const&, bool, tivsec_xml4c_6_0::ErrorHandler*, tivsec_xml4c_6_0::EntityResolver*, unsigned short const*, unsigned short const*, bool, tivsec_xml4c_6_0::MemoryManager&) () from /usr/lib64/libtivsec_xslt4c.so.112
#9  0x00007fc5322454ef in tivsec_xslt4c_1_12::XalanDefaultParsedSource::create(tivsec_xml4c_6_0::MemoryManager&, tivsec_xml4c_6_0::InputSource const&, bool, tivsec_xml4c_6_0::ErrorHandler*, tivsec_xml4c_6_0::EntityResolver*, unsigned short const*, unsigned short const*, bool) () from /usr/lib64/libtivsec_xslt4c.so.112
#10 0x00007fc532239d84 in tivsec_xslt4c_1_12::XalanTransformer::parseSource(tivsec_xslt4c_1_12::XSLTInputSource const&, tivsec_xslt4c_1_12::XalanParsedSource const*&, bool) () from /usr/lib64/libtivsec_xslt4c.so.112
#11 0x00007fc53223d2aa in tivsec_xslt4c_1_12::XalanTransformer::transform(tivsec_xslt4c_1_12::XSLTInputSource const&, tivsec_xslt4c_1_12::XalanCompiledStylesheet const*, tivsec_xslt4c_1_12::XSLTResultTarget const&) () from /usr/lib64/libtivsec_xslt4c.so.112
#12 0x00007fc5337892df in HTTPXSLTTransformationRule::processResponse(char const*, HTTPResponse*, HTTPRequest*, h_s_t*) () from /usr/lib64/libwsdaemon.so
#13 0x00007fc53378ae81 in HTTPTransformationEngine::processResponseByResource(char*, HTTPResponse*, HTTPRequest*, h_s_t*) () from /usr/lib64/libwsdaemon.so
#14 0x00007fc53378b0ec in HTTPTransformationEngine::processByPath(HTTPTransformationRule::stage_e, h_s_t*, HTTPRequest*, HTTPResponse*) () from /usr/lib64/libwsdaemon.so
#15 0x00007fc5337aa330 in requestDispatch(h_s_t*, Junction*, HTTPRequest*, ClientOutputInfo&, HTTPResponse&, unsigned long*) () from /usr/lib64/libwsdaemon.so
#16 0x00007fc5337a126f in zprocess_and_convert(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
#17 0x00007fc5337a14db in process_junction(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
#18 0x00007fc5336b6bac in authAndProcess(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
#19 0x00007fc53373f45f in handleCallInternal(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned long*, unsigned int*) () from /usr/lib64/libwsdaemon.so
#20 0x00007fc5337411c1 in handle_call(h_s_t*, HTTPRequest*, HTTPResponse*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
#21 0x00007fc53373e169 in call_start () from /usr/lib64/libwsdaemon.so
#22 0x00007fc5337442ac in WsWorker::work() () from /usr/lib64/libwsdaemon.so
#23 0x00007fc533744e32 in WsWorkerThread () from /usr/lib64/libwsdaemon.so
#24 0x00007fc5308421cf in start_thread () from /lib64/libpthread.so.0
#25 0x00007fc52fb7fdd3 in clone () from /lib64/libc.so.6{noformat}



{noformat}-rw-rw-r--. 1 whannon sftpusers 40666 Apr 28 19:24 isva_10.0.5.0_20230508-095319_ap-ninaa-aite-webseal2t.support_unpack/var/support/crashmap_webseald-webseal2t.21743
isva_10.0.5.0_20230508-095319_ap-ninaa-aite-webseal2t.support_unpack/core_file_stack_trace/core_webseald.21743.stack

Not useful ... most likely killed due to OOM{noformat}","09/May/23 8:41 AM;5b17571b91981f4fdde632c1;* The reduced memory core was not helpful/useful
** WebSEAL died because it could not allocate memory
*** Not freeing the memory","09/May/23 9:51 AM;5b15d9517dab4c51f61b5190;[~accountid:5b17571b91981f4fdde632c1] 

Havent seen the crash in transformation before","30/May/23 3:17 AM;5b17571b91981f4fdde632c1;* All memory leaks must be watching [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link] for common instruction
* From [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]
** 2023-04-24 L3 instruction for each {color:#bf2600}*Critical and Required* {color}section
*** Please provide current and complete status","31/May/23 11:21 PM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] I provided the updated instruction to the customer and ask the to capture the data for us. 

I also chatted with their account manager and ask them to help them to get te data we need.","31/May/23 11:32 PM;5b17571b91981f4fdde632c1;For ISVA support only:

Including MALLOC_CHECK_ instructions?

Still waiting for someone to collect MALLOC_CHECK_=3  with pdweb.snoop then crashing 

Freeing memory that is not allocated can break us in so many ways.

After that (unless different stack captured which may require more), switching to MALLOC_CHECK_=5 to keep protection in place and not crash.



",31/May/23 11:40 PM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] yes I did. I will tell the customer to change MALLOC_CHECK_=3 to MALLOC_CHECK_=5.,"31/May/23 11:44 PM;5b17571b91981f4fdde632c1;Only after you collect 

MALLOC_CHECK_=3  with CORE  … AND pdweb.snoop confirm matching failing stack failing malloc check ( better yet wait for L3 to review stack)

If other stack(s) found  with failing malloc check then more are required

Only after after ALL that then and only then MALLOC_CHECK=5



I would suggest re-reading the instructions previously provided for this area and ask any question you may have regarding the instructions which would help clarify.",01/Jun/23 12:13 AM;6092aca0f0db130069d19687;I will study the support file with Gabriel. ,"05/Jun/23 8:12 PM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] the customer provided us the latestdump file. 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011794922&path=TS011794922%2F2023-06-05%2F&filepath=TS011794922%2F2023-06-05%2Fisva_10.0.5.0_20230605-111105_ap-ninaa-aite-webseal1t.support-initial-dump|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011794922&path=TS011794922%2F2023-06-05%2F&filepath=TS011794922%2F2023-06-05%2Fisva_10.0.5.0_20230605-111105_ap-ninaa-aite-webseal1t.support-initial-dump]","06/Jun/23 2:45 AM;5b17571b91981f4fdde632c1;* ECUREP data
** TS011794922/2023-06-05/isva_10.0.5.0_20230605-104837_ap-ninaa-aite-webseal2t.support-initial-dump
** TS011794922/2023-06-05/isva_10.0.5.0_20230605-111105_ap-ninaa-aite-webseal1t.support-initial-dump
* {color:#bf2600}*PLEASE re-read* {color}[https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]{color:#bf2600} *INSTRUCTIONS*{color}
** *Then please tell me what is missing with coredump(s)?*
*** Was the other data captured … if so where is it?

[~accountid:5b15d9e6dda5f94d06b985b4] ","06/Jun/23 6:22 PM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] The first core dump file 

$ readelf -l core_webseald |grep LOAD | wc -l 8851  isva_10.0.5.0_20230605-104837_ap-ninaa-aite-webseal2t.support-initial-dump

$ readelf -l core_webseald |grep LOAD | wc -l 9025 isva_10.0.5.0_20230605-111105_ap-ninaa-aite-webseal1t.support-initial-dump

The customer just loaded the second core dump files. The customer said “ Just uploaded second dump. At time of cure dump/support file creation webseal2t had 181 MB available memory.”

[2023-06-06/isva_10.0.5.0_20230606-092745_ap-ninaa-aite-webseal1t.support-second-dump|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011794922&path=TS011794922/2023-06-06/&filepath=TS011794922/2023-06-06/isva_10.0.5.0_20230606-092745_ap-ninaa-aite-webseal1t.support-second-dump]

----

[2023-06-06/isva_10.0.5.0_20230606-092343_ap-ninaa-aite-webseal2t.support-second-dump|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011794922&path=TS011794922/2023-06-06/&filepath=TS011794922/2023-06-06/isva_10.0.5.0_20230606-092343_ap-ninaa-aite-webseal2t.support-second-dump]","06/Jun/23 6:35 PM;5b17571b91981f4fdde632c1;L3 request not done.

The *LATEST* L3 instructions in ISAMSUP-4460  DO NOT have readelf commands.  

Suggest rereading latest to earlier order 

What else is required with the core dump?

----

* {color:#bf2600}*PLEASE re-read* {color}[https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]{color:#bf2600} *INSTRUCTIONS*{color}
** *Then please tell me what is missing with coredump(s)?*
*** Was the other data captured … if so where is it?

[~accountid:5b15d9e6dda5f94d06b985b4]

",12/Jun/23 9:06 PM;6092aca0f0db130069d19687;[~accountid:5b17571b91981f4fdde632c1] It missing the daily statistics files(CLI Diagnostics pidstat). I will ask the customer to redo it.,"13/Jun/23 11:08 AM;5b17571b91981f4fdde632c1;* For IBM Support only:
** ssl-max-entries

{noformat}      1 [ssl]	ssl-max-entries 1048576
      1 [ssl]	ssl-max-entries 4096{noformat}

* 
** max-entries

{noformat}      1 [session]	max-entries 4096{noformat}",03/Jul/23 8:58 AM;5ac57757d9a96536d1f0daa9;Reassigning Jira item to [~accountid:5b15d9517dab4c51f61b5190] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Is APAR IJ43866 in 10.0.5.0,ISAMSUP-4749,278244,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,27/Jan/23 8:00 AM,30/Jan/23 3:46 PM,14/Jul/23 2:47 PM,30/Jan/23 3:46 PM,,,30/Jan/23 12:00 AM,0,,,,"Hello, 

As per [https://www.ibm.com/support/pages/node/6843969|https://www.ibm.com/support/pages/node/6843969|smart-link] , APAR IJ43866 is included in 10.0.5.0.

The client is reporting an issue after upgrading from 10.0.3.1 to 10.0.5.0.  

ISVA is now sending the incorrect KID value

 { ""alg"": ""RS256"", ""kid"": ""2pecK8Ec8YbApSbAyMeGepQQchOnuaF8qHHtJDN6Px0"" } 



For Reference here is what it looks like in INTG { ""alg"": ""RS256"", ""kid"": ""[isam-voya.intg.apptoapp.org|https://isam-voya.intg.apptoapp.org]"" }

This looks like it could be the same issue as investigated / resolved in: 
[https://cloudidentity.atlassian.net/browse/ISAMSUP-4367?jql=text%20~%20%22IJ43866%22|https://cloudidentity.atlassian.net/browse/ISAMSUP-4367?jql=text%20~%20%22IJ43866%22|smart-link] 



Before getting too deep into the investigation, I want to confirm that merged code made it into 10.0.5.0.

There is a fixpack for 10.0.4.0 and 10.0.4.1

jwt_kidname_fix_10040

jwt_kidname_fix_10040_v2


Thanks, 
Gary",,Asha Shivalingaiah,Carlos Rosales,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,5af4ad7d4dd24c579110120b,5bb2c13f59e46d7be31a9e54,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS011959711, TS011678275",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,Voya,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17v27:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-01-26 22:48:28.12,,,,,"27/Jan/23 8:48 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c87cb8d88f9ec6ae0afb306] 

Yes this code for IJ43866 is in 10.0.5.0",28/Jan/23 12:41 AM;5bb2c13f59e46d7be31a9e54;Hi [~accountid:5af4ad7d4dd24c579110120b] customer at TS011678275 seems to be having the same issue,"28/Jan/23 1:23 AM;5c87cb8d88f9ec6ae0afb306;I will get data and open a new JIRA, if needed.  This Jira was just to confirm that the code for IJ43866 is in 10.0.5.0.  

For the case carlos mentioned, they upgraded from 10.0.4.0 (Which was working) to 10.0.5.0, where it stopped working.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Pending changes are visible by a different LMI user,ISAMSUP-4740,278034,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,25/Jan/23 5:34 AM,14/Jul/23 12:39 AM,14/Jul/23 2:47 PM,,,,,0,,,,"L2 has reproduced the problem reported by the customer. I used a v10.0.5 system. As far as I can tell, the problem appears with changes under the Federation heading of the LMI. I didn’t see the same behavior when making changes to a WebSEAL config file.

Steps to Reproduce:

Login as UserA
	create a Security Token Service Template
	Notice the Pending Changes message appears
	Don't deploy the change, Log out

Login as UserB
	Notice there is no Pending Changes message (this is good)
	Check the STS Templates, notice that the new undeployed template from UserA appears (this is bad)
	Create a Security Token Service Template
	Notice the Pending Changes message appears, Deploy the changes
	Log out

Login as UserA
	Check the STS Templates, notice that UserA now sees the template created by UserB (this is bad)
	Roll back the pending changes
	Check the STS Templates, notice that both of the newly created templates are present (this is bad, because UserA's template should have been rolled back)

Our documentation states: “Pending changes are managed on a per user identity basis. This means that changes made by one user identity will not be visible to another user identity until the changes are deployed.”
[https://www.ibm.com/docs/en/sva/10.0.5?topic=appliance-configuration-changes-commit-process|https://www.ibm.com/docs/en/sva/10.0.5?topic=appliance-configuration-changes-commit-process|smart-link] ",,David Hayes,George Benavides,khansen,Nick Lloyd,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d99182e05b22cc7d5947,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ45495,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011918670,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,State of Michigan,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=25, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":25,""lastUpdated"":""2023-07-13T23:11:04.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":25,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17trz:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-31 14:45:01.791,,,,,01/Feb/23 12:43 AM;5b15d9e44c4ed14b83af8723;[~accountid:5b17571b91981f4fdde632c1] This problem is easy to reproduce. Can I open an APAR?,01/Feb/23 12:45 AM;5b17571b91981f4fdde632c1;What traces do we have?,01/Feb/23 12:53 AM;5b15d9e44c4ed14b83af8723;[~accountid:5b17571b91981f4fdde632c1] Recreate steps have been provided so L3 can generate their own traces. Let me if you have questions about the recreate steps and the APAR question.,"07/Feb/23 9:51 AM;5b15d99182e05b22cc7d5947;Hello Reagan,

Will work on a recreate this week and work with Bill on possible solution.

Thanks!","09/Feb/23 2:19 AM;5b17571b91981f4fdde632c1;* Still require support file from customer after this scenario
** Looking for error message(s)
*** That would be required to ensure identical recreate scenario
**** Since there may potentially several scenarios","09/Feb/23 3:02 AM;5b15d9e44c4ed14b83af8723;In my experience, LMI traces are notoriously difficult to get right. Are there any specific traces you want?","09/Feb/23 3:07 AM;5b15d9e44c4ed14b83af8723;[~accountid:5b17571b91981f4fdde632c1] [~accountid:5b15d99182e05b22cc7d5947] The recreate steps have been provided. Have you recreated this issue yet? With two LMI users, it literally takes less than two minutes.","09/Feb/23 4:52 AM;5b15d99182e05b22cc7d5947;Hello Reagan,

Is customer using any groups for the users?

Also were userA and userB  both created under LMI ‘Account Management’ ? 

Or is one of the users the standard ‘admin’ that created when installing.

Thanks!",09/Feb/23 4:55 AM;5b15d9e44c4ed14b83af8723;Groups are not required. UserA and UserB were both created under ‘Account Management’. I did not test with ‘admin’.,14/Feb/23 8:12 AM;5b15d9e44c4ed14b83af8723;[~accountid:5b15d99182e05b22cc7d5947] Customer is asking for an update. Can I create an APAR for this issue?,21/Feb/23 2:23 AM;5b15d9e44c4ed14b83af8723;I created APAR IJ45495 for this issue,14/Mar/23 5:12 AM;5b15d9e44c4ed14b83af8723;Is there an update for this issue? Customer is asking for a fixpack. ,22/Mar/23 11:12 PM;5b15d9e44c4ed14b83af8723;[~accountid:5b15d99182e05b22cc7d5947] Is there an update for this issue? Customer is asking for a fixpack.,"27/Mar/23 11:27 PM;5b15d99182e05b22cc7d5947;<L2 and L3 only>

Hello Reagan,

Able to recreate issue as outlined in description. However seems any change to federation exhibits this behavior. Therefore seems issue is not specific to sts template management. Even creating a federation, idp or sp, exhibits same behavior.

At this time will need to check 9.x behavior to see if this is a regression or this has been behavior even in 9.x. 

Also pinging others on this issue for input.

In regards to customer update we are continuing to look into issue to narrow down affected code areas.

Thanks!

</L2 and L3 only>",04/Apr/23 9:44 PM;5b232b2fd85e5b59b066f57f;@gbe - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,10/Apr/23 11:31 PM;5b15d9e44c4ed14b83af8723;Is there any update on this issue?,14/Apr/23 11:01 PM;5b15d99b4c20165700edecad;Once this one is figured out they will want a fixpack. ,18/Apr/23 11:14 PM;5b232b2fd85e5b59b066f57f;@gbe - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"25/Apr/23 1:04 AM;5b15d9e44c4ed14b83af8723;[~accountid:5b232b2fd85e5b59b066f57f] Can we get an update on this issue? We reproduced this issue back in January and customer wants a fixpack. I know you just took ownership a few days ago, let me know if you have any questions about reproducing.",27/Apr/23 1:54 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:5b15d9e44c4ed14b83af8723] - I’ve been working through a backlog of re-assigned items and haven’t got to this one yet - I’ll try and give an update in the next few days. ,28/Apr/23 1:54 PM;5b232b2fd85e5b59b066f57f;For my reference - ./i4m/rba/com.ibm.security.access.management.rest/src/com/ibm/security/access/management/STSReqData.java,05/May/23 12:44 AM;5b15d9e44c4ed14b83af8723;Customer states they have a planned release in July. They consider this issue a blocker for their release.,"17/May/23 12:38 AM;5b15d901fa615349cb01778b;[~accountid:5ac57757d9a96536d1f0daa9] - can we please get an update, customer needs this fixpack","25/May/23 11:18 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9e44c4ed14b83af8723] / [~accountid:5b15d901fa615349cb01778b] 


I’m still working on this. 

I can understand why pending changes have been designed / implemented in this manner for FED / STS configuration. The entirety of the FED and STS configuration is stored within single data objects (rows) in the DB. If non deployed changes are not visible across users, there is a likely risk that entire configurations could be unwittingly undone by another user. This risk holds true for any other config in the Appliance - however given that the entirety of FED and STS config is stored in single rows in the DB; an entire non deployed FED / STS configuration could be undone by one unrelated change in an unrelated FED / STS once it is deployed by another user. This is why the view is “synced” across all users. 

This is not a simple defect / fix as the core of it relates to the design of the FED / STS configuration storage and its integration with the pending changes framework.  

For SUPPORT reference: 

A few possible ways forward: 

# Make change so that pending changes for FED / STS works the same as all other pending changes (i.e. can only see those “owned” by current user). The risk here is that entire non deployed FED / STS config could be undone by another user (see above). 
# Make change so that a warning message appears for users when another user has a non deployed FED / STS change but do not show non deployed changes from other users. The risk here is as per option 1 but should be somewhat mitigated.
# Make change so that a warning message appears for users when another user has a non deployed FED / STS change and show non deployed changes from other users. The issue with this is that it isn’t possible to tell what is deployed and what isn’t (may not be such an issue?). 
# Lock FED / STS editing if any user has pending changes relating to FED / STS (most likely would also need an alert on screen). The issue with this is that introducing another mechanism increases the risk that something could go wrong in the UI flow. 
# Automatically deploy FED / STS changes (i.e. no “pending” state). The issue here is that the configuration will be in an inconsistent / incomplete state until all changes are made. 
# Change storage model of FED / STS configuration. This would be a large change to multiple layers of the Appliance including DB schemas. Not recommended. 
# Do nothing. The issue here is that pending changes for STS / FED configuration is inconsistent with other config changes in the Appliance and it isn’t clear to users what state the configuration is currently in. 



For my reference: - 

i4m/rba/com.ibm.security.access.management.rest/src/com/ibm/security/access/management/FederationReqData.java:172 not using username

i4m/rba/com.ibm.security.access.management.rest/src/com/ibm/security/access/management/STSReqData.java:265 not using username.","29/May/23 2:21 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: d35e32fc3bec2f648f73714f90f39a69457278cb
   * description: ISAMSUP-4740_test

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/777881.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test) which we publish.","29/May/23 2:27 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: d35e32fc3bec2f648f73714f90f39a69457278cb
   * description: ISAMSUP-4740_test

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/777887.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230529042405-d35e32fc-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","29/May/23 3:44 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: d35e32fc3bec2f648f73714f90f39a69457278cb
   * description: ISAMSUP-4740_test

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/778295.


This build has not been published as the commit is not currently within a branch (20230529042405-d35e32fc-support) which we publish.","05/Jun/23 3:54 PM;5b232b2fd85e5b59b066f57f;For my reference - issue looks to be at (STS example - similar for FED): 

STSReqData.java:initialize(…):265 (userName not passed) → … → SecurityTokenManager.java:getInstance(…):113/121 - Map is keyed off hard coded session ID rather than unique ID including userName - hence only one instance for all users.","06/Jun/23 2:48 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: fff4dac4739d52fe6ffbec2478e6a3c356e18c84
   * description: ISAMSUP-4740_test

Make Security Token Manager instance per user

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1021185.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test) which we publish.","06/Jun/23 2:50 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has failed for the following commit: 
   * id: fff4dac4739d52fe6ffbec2478e6a3c356e18c84
   * description: ISAMSUP-4740_test

Make Security Token Manager instance per user

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1021212.

","06/Jun/23 3:35 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 04e8465fcf680e60e6dee81ca4b2189b5a68807e
   * description: ISAMSUP-4740_test

Fix build break

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1021955.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test) which we publish.","06/Jun/23 4:36 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: b997957bda734204add011c51baffb06cee55c34
   * description: ISAMSUP-4740_test

Fix build break

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1023441.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test) which we publish.","07/Jun/23 1:08 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 83b7c13c785acb3f71b5f0649bfcf9f5e52d22bb
   * description: ISAMSUP-4740_test

Fix build break.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1039119.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test) which we publish.","07/Jun/23 2:33 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 83b7c13c785acb3f71b5f0649bfcf9f5e52d22bb
   * description: ISAMSUP-4740_test

Fix build break.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1043866.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230606163021-83b7c13c-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","07/Jun/23 3:56 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 83b7c13c785acb3f71b5f0649bfcf9f5e52d22bb
   * description: ISAMSUP-4740_test

Fix build break.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1048606.


This build has not been published as the commit is not currently within a branch (20230606163021-83b7c13c-support) which we publish.","07/Jun/23 12:21 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5b35e373fcfc462ad24c8a4e9119cb6f8ed4de8c
   * description: ISAMSUP-4740_test

Fix removal of expired stm instances.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1066432.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test) which we publish.","07/Jun/23 12:23 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has failed for the following commit: 
   * id: 5b35e373fcfc462ad24c8a4e9119cb6f8ed4de8c
   * description: ISAMSUP-4740_test

Fix removal of expired stm instances.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1066470.

","07/Jun/23 2:01 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f100cbb458208d6bb0ac2e34fb3bd46452abd607
   * description: ISAMSUP-4740_test

Fix build break.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1067404.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test) which we publish.","07/Jun/23 2:07 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f100cbb458208d6bb0ac2e34fb3bd46452abd607
   * description: ISAMSUP-4740_test

Fix build break.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1067426.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230607040425-f100cbb4-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","07/Jun/23 3:25 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f100cbb458208d6bb0ac2e34fb3bd46452abd607
   * description: ISAMSUP-4740_test

Fix build break.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1068937.


This build has not been published as the commit is not currently within a branch (20230607040425-f100cbb4-support) which we publish.","07/Jun/23 6:27 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 59851bc5757376fdb3e34f6a64432e3dd796b0a3
   * description: ISAMSUP-4740_test

Fix runtime issue

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1073340.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test) which we publish.","07/Jun/23 6:31 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 59851bc5757376fdb3e34f6a64432e3dd796b0a3
   * description: ISAMSUP-4740_test

Fix runtime issue

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1073391.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230607082853-59851bc5-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","07/Jun/23 7:53 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 59851bc5757376fdb3e34f6a64432e3dd796b0a3
   * description: ISAMSUP-4740_test

Fix runtime issue

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1075551.


This build has not been published as the commit is not currently within a branch (20230607082853-59851bc5-support) which we publish.","08/Jun/23 1:38 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 6a57ab0e6eafc866c74db70aa5ce4f377d739e6a
   * description: ISAMSUP-4740_test

Fix runtime issue

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1115052.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test) which we publish.","08/Jun/23 1:44 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 6a57ab0e6eafc866c74db70aa5ce4f377d739e6a
   * description: ISAMSUP-4740_test

Fix runtime issue

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1115086.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230608034147-6a57ab0e-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","08/Jun/23 3:02 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 6a57ab0e6eafc866c74db70aa5ce4f377d739e6a
   * description: ISAMSUP-4740_test

Fix runtime issue

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1116319.


This build has not been published as the commit is not currently within a branch (20230608034147-6a57ab0e-support) which we publish.","09/Jun/23 2:31 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: bde5bc7503f6f3c5ffc69c01c6efab48002e2db9
   * description: ISAMSUP-4740_test2

Use unique session Id for each user when manging sts data.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1159736.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740_test2) which we publish.","09/Jun/23 2:34 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: bde5bc7503f6f3c5ffc69c01c6efab48002e2db9
   * description: ISAMSUP-4740_test2

Use unique session Id for each user when manging sts data.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1159761.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230609043120-bde5bc75-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","09/Jun/23 3:53 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: bde5bc7503f6f3c5ffc69c01c6efab48002e2db9
   * description: ISAMSUP-4740_test2

Use unique session Id for each user when manging sts data.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1160850.


This build has not been published as the commit is not currently within a branch (20230609043120-bde5bc75-support) which we publish.","12/Jun/23 1:55 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9e44c4ed14b83af8723] - I’ve been playing around with this to see if there is a good way forward - but I keep coming back to the points listed in my update from 25MAY. The crux of the issue is basically that the entire STS / FED configuration is stored within single records in the DB with pending changes stored in memory. Out of the 7 options (ignoring option #6) in my update from 25MAY - based on your understanding of customer usage of the product, what do you think would be the best option for user experience (not necessarily just for this customer, but customers in general)? ","14/Jun/23 12:27 AM;5b15d9e44c4ed14b83af8723;I discussed with Nick and options 3, 4, and 7 seem viable (with an update to the documentation).

I mentioned a warning message to the customer and they seemed open to the idea. If a warning message is implemented, they want it to display detailed information for the affected federation, partner, mapping rule, etc. They also want some sort of warning message or extra step for deploying FED changes via REST API.","11/Jul/23 3:07 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 961acd05d9fe71ab55f58b2b86bae0fbcdd278d5
   * description: ISAMSUP-4740

Make pending changes to STS & Federations pending changes for all users

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2442548.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740) which we publish.","11/Jul/23 3:12 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 961acd05d9fe71ab55f58b2b86bae0fbcdd278d5
   * description: ISAMSUP-4740

Make pending changes to STS & Federations pending changes for all users

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2442582.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230711050926-961acd05d-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","11/Jul/23 4:34 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 961acd05d9fe71ab55f58b2b86bae0fbcdd278d5
   * description: ISAMSUP-4740

Make pending changes to STS & Federations pending changes for all users

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2444849.


This build has not been published as the commit is not currently within a branch (20230711050926-961acd05d-support) which we publish.","12/Jul/23 1:06 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f1d6bded70bd65fc4c7224b2c80c6ddaabf73fef
   * description: ISAMSUP-4740

Make synched changes visible and allow all users to commit / roll-back

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2516370.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740) which we publish.","12/Jul/23 1:07 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has failed for the following commit: 
   * id: f1d6bded70bd65fc4c7224b2c80c6ddaabf73fef
   * description: ISAMSUP-4740

Make synched changes visible and allow all users to commit / roll-back

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2516382.

","12/Jul/23 1:56 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 3958518705f0e9dcb9b6a839d7a1e20eea2f9202
   * description: ISAMSUP-4740

Fix build break

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2517224.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740) which we publish.","12/Jul/23 1:59 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has failed for the following commit: 
   * id: 3958518705f0e9dcb9b6a839d7a1e20eea2f9202
   * description: ISAMSUP-4740

Fix build break

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2517246.

","12/Jul/23 4:42 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e1d1707c71f32dbf255eb836f2fc8659483fadd4
   * description: ISAMSUP-4740

Fix build break

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2520574.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740) which we publish.","12/Jul/23 4:47 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e1d1707c71f32dbf255eb836f2fc8659483fadd4
   * description: ISAMSUP-4740

Fix build break

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2520598.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230712064432-e1d1707c7-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","12/Jul/23 6:14 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e1d1707c71f32dbf255eb836f2fc8659483fadd4
   * description: ISAMSUP-4740

Fix build break

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2524532.


This build has not been published as the commit is not currently within a branch (20230712064432-e1d1707c7-support) which we publish.","13/Jul/23 11:00 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: d2b1de080fe0e7d9625283cbcab6ec58dd4ef627
   * description: ISAMSUP-4740

Make pending changes to STS & Federations pending changes for all users

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2614719.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4740) which we publish.","13/Jul/23 11:11 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: d2b1de080fe0e7d9625283cbcab6ec58dd4ef627
   * description: ISAMSUP-4740

Make pending changes to STS & Federations pending changes for all users

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2614825.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230713130713-d2b1de080-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","14/Jul/23 12:39 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: d2b1de080fe0e7d9625283cbcab6ec58dd4ef627
   * description: ISAMSUP-4740

Make pending changes to STS & Federations pending changes for all users

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2620063.


This build has not been published as the commit is not currently within a branch (20230713130713-d2b1de080-support) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Error while generating Snapshot or support file on ISVA appliance,ISAMSUP-4738,277940,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,24/Jan/23 11:36 AM,04/May/23 2:08 AM,14/Jul/23 2:47 PM,04/May/23 2:07 AM,,Support,,0,,,,"Customer is getting error while generating support files and snapshots. After few minutes the file comes up in the appliance, but the issue is they are using ISAM API to create snapshot. 

It just says System error. I have attached the error screenshot for the support file use case.

!image-20230124-013053.png|width=704,height=229!

They have 16Gb RAM and 200GB+ storage on the appliances. Asking for a fixpack if necessary for this issue as they are taking regular backup using ISAM API's as a backup strategy.

For the snapshot use case : The error shown is ""System error"" as well.

I have uploaded the support file post enabling the logging.

The time customer generated the snapshot was 3:15AM EST.

S:\sf\TS011\670\TS011670845\2023-01-19\

Is this a known issue? It’s weird that they are getting that pop up error - but minutes later the snapshot or support file are visibles on their appliance. Is this normal when having huge data to process in a snapshot or support file? if known issue… any fixpack available?",,Brandon Garay,Daniel Comeau,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,,,60e721f12d49fd00698bb49d,5b15d9a0dda5f94d06b985b3,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,24/Jan/23 11:36 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230124-013053.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/179869,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011670845,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,THE GUARDIAN LIFE INSURANCE CO OF AMERICA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,S:\sf\TS011\670\TS011670845\2023-01-19\,,,,,,,,,,,,,,,,,,,,,,,0|i17t73:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-01-27 00:42:53.323,,,,,"27/Jan/23 10:42 AM;5b15d954b0d76456f36daf33;10.0.2.0 is an oldish version so it is possible this is a known issue that might have been subsequently addressed.

Is this a lower environment that they are in a position to upgrade? And see if we are dealing with a new issue?","02/Feb/23 1:48 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5b15d954b0d76456f36daf33] 

They upgraded the version last year only. Customer said they are not in a position to upgrade this version.  Moreover, this issue is not coming in lower environment. Its only PROD which is showing the error.

They are wanting L3 to provide a fix pack for the current version only based on their situation.","03/Feb/23 10:07 AM;5b15d954b0d76456f36daf33;Since this is specific to only one environment, have you checked what the differences are with an environment not having this problem?

I suspect volume of data would be one factor since it is prod, but are there any others?

This is not a case of simply backporting something from a newer release. We don’t know what is the root cause of the issue to be able to write any fixpack yet.","11/Feb/23 4:17 AM;60e721f12d49fd00698bb49d;Hey [~accountid:5b15d954b0d76456f36daf33] 

Checking … will provide you an update as soon as I can.","15/Feb/23 2:52 AM;60e721f12d49fd00698bb49d;I have checked some resources basic stuff comparing environment with the problem vs not with problem. Can’t identify any obvious indicator of why this could be happening to be honest.

Working Environment:

{noformat}Filesystem                Size      Used Available Use% Mounted on
/dev/sda6               244.0G      3.4G    228.1G   1% /
proc                         0         0         0   0% /proc
sysfs                        0         0         0   0% /sys
mdev                      7.8G      4.0K      7.8G   0% /dev
devpts                       0         0         0   0% /dev/pts
tmpfs                     7.8G    172.0K      7.8G   0% /dev/shm
tmpfs                     7.8G    172.0K      7.8G   0% /var/run
/dev/sda1               189.7M    140.3M     35.4M  80% /boot{noformat}

Non working Environment:

{noformat}Filesystem                Size      Used Available Use% Mounted on
/dev/sda6               244.9G     42.6G    189.9G  18% /
proc                         0         0         0   0% /proc
sysfs                        0         0         0   0% /sys
mdev                      7.8G      4.0K      7.8G   0% /dev
devpts                       0         0         0   0% /dev/pts
tmpfs                     7.8G    172.0K      7.8G   0% /dev/shm
tmpfs                     7.8G    172.0K      7.8G   0% /var/run
/dev/sda1               191.7M    122.7M     54.9M  69% /boot{noformat}

As you said , the /dev/sda6 directory and the volume of data stored seems to be the only difference in Prod.

*Working environment : S:\sf\TS011\670\TS011670845\2023-02-06\*","18/Feb/23 12:43 PM;60e721f12d49fd00698bb49d;Hi [~accountid:5b15d954b0d76456f36daf33] 

Let me know if any updates in this next week. I’ll be out of the office, then you can tag Nick or my manager Kathy.",21/Feb/23 8:32 PM;5b232b2fd85e5b59b066f57f;@bkumar - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"22/Feb/23 9:15 AM;5b15d954b0d76456f36daf33;[~accountid:60e721f12d49fd00698bb49d] that should be fine. I have a couple of other issues to attend to first, but will get to this item later in the week.",23/Feb/23 3:45 AM;5b15d9a0dda5f94d06b985b3;[~accountid:5b15d954b0d76456f36daf33] Just FYI customer updated the case asking for an update.    Thx,23/Feb/23 4:19 PM;5b15d954b0d76456f36daf33;I’ll have a look and get them something by tomorrow ,23/Feb/23 10:47 PM;5b15d9a0dda5f94d06b985b3;Ok thanks.   As a test we tried setting wga.cmd.timeout=1000 but they said it still fails within 3-4 mins.,"01/Mar/23 4:21 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5b15d954b0d76456f36daf33] I’m back from vacations.

Do you have any update on this WI?","01/Mar/23 5:45 PM;5b15d954b0d76456f36daf33;[~accountid:60e721f12d49fd00698bb49d] apologies, was caught up in a couple of other higher priority items, so couldn’t work this. But will do so now.","08/Mar/23 12:03 PM;60e721f12d49fd00698bb49d;Thank You Bhavan.

Customer asked me if there’s any ETA for this. So just asking you the same on this case 🙂 ","08/Mar/23 7:25 PM;5b15d954b0d76456f36daf33;[~accountid:60e721f12d49fd00698bb49d] they have supplied support files from two appliances. {{vmpovtamapp1p}} and  {{vmnovtamapp1q}}

In neither of those the LMI logs were captured in the support file. So I’m unable to see data around the failure error message. But they should be able to download the message log directly from LMI. Can they provide those for both appliances?

Also is my understanding correct that the support/snapshot file itself is being correctly generated but they still see this error? 

In other words, given they were able to supply support files to us, is this an intermittent issue? Or always fails when creating via LMI but works when creating via RAPI","15/Mar/23 12:58 AM;5b15d9a0dda5f94d06b985b3;Hi [~accountid:5b15d954b0d76456f36daf33]  the customer uploaded LMI logs in 
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011670845&path=TS011670845%2F2023-03-14%2Fmanagement_ui.zip_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011670845&path=TS011670845%2F2023-03-14%2Fmanagement_ui.zip_unpack%2F]

I hope this helps.
","22/Mar/23 4:11 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5b15d954b0d76456f36daf33] 

Any update on this? Thanks.","27/Mar/23 8:20 PM;5b15d954b0d76456f36daf33;I had another look at both the earlier support files and the last supplied LMI logs. There isn’t much to go on in either. There aren’t any unexpected entries or any obvious causes of the problem described.

We have seen a couple of similar issues in the past at 10.0.2.0 as snapshot creation had a bug with an expired cert. There was also a case of support file creation hanging due to a bug in pstack generation.

In both cases, upgrading a newer version fixed the problem. Given this customer has no plans to upgrade, I’ll continue investigating. But their best bet is to plan for upgrade.",28/Mar/23 3:31 AM;60e721f12d49fd00698bb49d;Thanks. I had given the same advice to customer earlier. ,"30/Mar/23 12:50 AM;60e721f12d49fd00698bb49d;Hey [~accountid:5b15d954b0d76456f36daf33] 

Got some new information from customer.

The files get generated but the files generated are not correct. Customer have seen that in many cases when they upload the support file or snapshot the IBM support person complains about the missing files and then I have to explicitly give the files to them. I asked them if the files missing are always the same or randomly. They said random files. This had happened to them multiple times.

So if even they generate the snapshot and it comes on the appliance after the failure, they are not sure if the snapshot created contains all the details or not required for a future restore if needed.","30/Mar/23 4:30 AM;5b15d9a0dda5f94d06b985b3;I haven’t looked at the docs but this could sound like [https://cloudidentity.atlassian.net/browse/ISAMSUP-3354|https://cloudidentity.atlassian.net/browse/ISAMSUP-3354]

Perhaps in their case /proc is too big and choking the process.   

[~accountid:5b15d954b0d76456f36daf33] I think the latest fixpack for that apar is [https://ibm.ent.box.com/folder/161119644969|https://ibm.ent.box.com/folder/161119644969]

Is that suitable for the customer’s system and do you think it’s worth a try?

They are on 10.0.2 and 

+ /usr/sbin/mesa_control fixpack_get_history

Monday, June 27, 2022 at 11:17:57 AM|10.0.2.0_IF1|10.0.2.0_IF1|Yes|Installed|This fixpack contains security fixes and APAR fixes for IBM Security Verify Access version 10.0.2.0.|1656343077

Monday, June 27, 2022 at 11:21:39 AM|REMOVE_ROLLEDOVER_PS_LOGS|Remove_Rolledover_Policy_Sever_Logs|Yes|Installed|This fixpack removes rolled over policy server log files to reclaim disk space.|1656343299

Saturday, July 9, 2022 at 10:23:59 PM|REMOVE_AUTHZN_DB_TMP_FILE|Remove_Authzn_DB_Tmp_File_001|Yes|Installed|This fix-pack will remove all master_authzn.db.tmp files from the /var/PolicyDirector/db/snapshot directory.|1657419839

Saturday, July 9, 2022 at 10:35:08 PM|REMOVE_AUTHZN_DB_TMP_FILE|Remove_Authzn_DB_Tmp_File_001|Yes|Installed|This fix-pack will remove all master_authzn.db.tmp files from the /var/PolicyDirector/db/snapshot directory.|1657420508","31/Mar/23 5:04 PM;5b15d954b0d76456f36daf33;[~accountid:5b15d9a0dda5f94d06b985b3] I couldn’t see any entries for proc in their support files. If you can validate the fixpack is good for their version, no harm in trying. But actually having proc entries to look at might help us in this case.

Even if we assume they are running into the problem described in the other item, it doesn’t explain the behaviour with snapshots.

[~accountid:60e721f12d49fd00698bb49d] how is this appliance in terms of resources? Do they have enough CPU, memory etc?","01/Apr/23 3:14 AM;5b15d9a0dda5f94d06b985b3;[~accountid:5b15d954b0d76456f36daf33] Thanks.   You’re right, the /proc issue I wouldn’t think should affect snapshots, I just thought I’d mention it since the support file symptoms sounded similar.    

The fixpack seems to be version independent, so hopefully it shouldn’t break anything.

[~accountid:60e721f12d49fd00698bb49d] perhaps it’s worth a try to see if this fixpack allows the support file creation to complete at least (perhaps snapshot is a different issue) ","05/Apr/23 2:08 AM;60e721f12d49fd00698bb49d;Thanks Daniel for your help and input here.

I can tell the customer for sure he can try the fixpack for the support file creation.

These are details for resources of the appliance.

*RAM - 16 GB*

*Storage - Total - 200GB Free- 150 GB*

*CPU - 8 core CPU*

FYI [~accountid:5b15d954b0d76456f36daf33] ","07/Apr/23 12:08 PM;60e721f12d49fd00698bb49d;Hi [~accountid:5b15d954b0d76456f36daf33] 

I was notified by customer that Fixpack didn’t solve their issue with the support files. 

So , seems to be different issue impacting Snapshots and support files. Weird.","10/Apr/23 9:50 PM;5b15d9a0dda5f94d06b985b3;Ok thanks, was worth a shot.","11/Apr/23 8:32 AM;5b15d954b0d76456f36daf33;[~accountid:60e721f12d49fd00698bb49d] not surprised with the result to be honest.

Do you think it will help if we get on a call with them to try and understand what is going on? If yes, can you arrange a meeting? Any time that suits the customer is fine.","14/Apr/23 1:05 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5b15d954b0d76456f36daf33] 

Customer is available all the next week from 12am to 9am EST. That should be like 2pm to 9pm Australia time.

I’ll arrange a meeting for next Monday at 4.00pm *YOUR* time. Probably won’t be on the call due to my shift hours, but will coordinate internally with another L2 colleague.","17/Apr/23 6:03 PM;5b15d954b0d76456f36daf33;On the call we discovered that the customer has a large number of rolled over policy server log files (more than 250 and on average 180 MB in size).

Both snapshot and support (when Verify Access Runtime is checked) operations are attempting to gather all these files resulting in the large response times.

Plan of action is for the customer to get approval to delete the roller over files and any others:

{noformat}appl> isam logs delete
appl> isam logs delete_trace
appl> support purge{noformat}

After this they will repeat the same operations to see if there is any improvement.","04/May/23 2:08 AM;60e721f12d49fd00698bb49d;Hey [~accountid:5b15d954b0d76456f36daf33] 

Customer performed suggested actions and they are good now.

Closing case, thanks for support.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Make DSC Trace level persistent,ISAMSUP-4730,276762,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,20/Jan/23 8:18 AM,18/Apr/23 3:19 PM,14/Jul/23 2:47 PM,18/Apr/23 2:59 PM,,Support,,0,,,,"This is a follow on item from [https://cloudidentity.atlassian.net/browse/ISAMSUP-4568|https://cloudidentity.atlassian.net/browse/ISAMSUP-4568|smart-link] 

DSC trace level is reset to 0 after reboot

Should be persistent",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4568,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17r8n:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-04-04 11:44:40.705,,,,,04/Apr/23 9:44 PM;5b232b2fd85e5b59b066f57f;@phorner - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"18/Apr/23 2:59 PM;5b15d9517dab4c51f61b5190;[~accountid:5bac25a37de8532e315430c5] 

I have finally got back to this follow on item.

I cannot reproduce the case where the trace level is reset to 0 on reboot

I have tried

A 10.0.4.0 cluster with the fixpack from [https://cloudidentity.atlassian.net/browse/ISAMSUP-4568|https://cloudidentity.atlassian.net/browse/ISAMSUP-4568|smart-link] 

A 10.0.5.0 cluster

A 10.0.5.0 stand alone appliance

In each case I have set the DSC trace level to 1 and rebooted - and it is still set to 1 after reboot

So I am going to close the item

Please reopen if you can reproduce the trace level reset issue and provide me with the recreate steps",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Updating secPwdLastUsed for /pkmsoidc flow,ISAMSUP-4729,276761,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,gvacek,5c87cb8d88f9ec6ae0afb306,gvacek,5c87cb8d88f9ec6ae0afb306,20/Jan/23 7:57 AM,24/Feb/23 9:39 AM,14/Jul/23 2:47 PM,24/Feb/23 9:39 AM,,,,0,,,,"The client is using an OIDC flow (without AAC) and expected the secPwdLastUsed attribute to be updated when the user was authenticated. 

I understand that this may be working-as-designed. 

I noticed an RFE ([https://ibmsecurity.ideas.ibm.com/ideas/ISAM-I-800|https://ibmsecurity.ideas.ibm.com/ideas/ISAM-I-800|smart-link] ) that is marked delivered.  The topic of that RFE is: 
_Update secPwdLastUsed attribute in all cases Only shown to the idea creator and internal users

secPwdLastUsed is an attribute on secUser object. It provides indication of active account (used for governance and risk).

It is updated by WebSEAL built-in authentication mechanisms but it is NOT updated when authentication performed by AAC username/password authentication mechanism. This also affects ROPC OAuth flows.

The attribute should be updated in all cases where password authentication is used for a SAM user. This should be built into AAC mechanism and/or UserLookup helper modified to allow manual update (currently not allowed)._

This is specifically for AAC username/password authentication mechanisms.


The client updated the case with the following: 
_So it looks like this is not supported out of the box at the moment. However, since this type of information (Last Logon time) is a key for dormant account management and audit purpose, do you have and suggestions for eventual solution and/or is this being reviewed as potential enhancement in webseal already?_


Has this been delivered?  
Does it include the /pkmsoidc landing page?
What are the suggestions for updating the secPwdLastUsed attribute when using /pkmsoidc. ",,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011875152,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,gvacek,5c87cb8d88f9ec6ae0afb306,,,,The Depository Trust and Clearing Corporation,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17r8f:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-01-30 23:22:24.801,,,,,"31/Jan/23 9:22 AM;5af4ad7d4dd24c579110120b;<Notes>

Checking these changes:

[https://github.ibm.com/ISAM/isam/pull/3047/files|https://github.ibm.com/ISAM/isam/pull/3047/files] 

[https://github.ibm.com/ISAM/isam/pull/3051/files|https://github.ibm.com/ISAM/isam/pull/3051/files]","31/Jan/23 9:24 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c87cb8d88f9ec6ae0afb306] 

The changes made in this RFE ([https://ibmsecurity.ideas.ibm.com/ideas/ISAM-I-800|https://ibmsecurity.ideas.ibm.com/ideas/ISAM-I-800] ) are specific to Username auth mechanism. This will not change the behaviour of /pkmsoidc","01/Feb/23 1:03 AM;5c87cb8d88f9ec6ae0afb306;Yes, I noticed that upon further reading. 

Do we have any suggestions for how this can be accomplished when using ","01/Feb/23 2:18 PM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}219       TS:2023-02-01T13:03:23 C:10.166.1.14 I:10.160.101.32 U:unauthenticated AL:- SI:- T:0 M:GET ST:302 B:1650 F:4811 URL:/pkmsoidc?iss=implicit
220       TS:2023-02-01T13:03:23 C:10.166.1.14 I:10.160.101.32 U:unauthenticated AL:- SI:- T:0 M:POST ST:200 B:13359 F:2273 URL:/pkmsoidc
221       TS:2023-02-01T13:03:34 C:10.166.1.14 I:10.160.101.32 U:unauthenticated AL:- SI:03f4f666-a1dd-11ed-8641-fa163e997016 T:1 M:GET ST:302 B:0 F:2593450 URL:/isam/sps/oidc/rp/oidcrp/kickoff/ISAMOPAzncode?Target=/pkmsoidc
222       TS:2023-02-01T13:03:37 C:10.166.1.14 I:10.160.101.32 U:https://www.myidp.ibm.com/testuser AL:- SI:03f4f666-a1dd-11ed-8641-fa163e997016 T:2 M:GET ST:302 B:1407 F:1285769 URL:/isam/sps/oidc/rp/oidcrp/redirect/ISAMOPAzncode?state=OdOHU4TqBU&code=Vgl9hT7dHxBdz1WqpdrWHOkMB3ijuI
223       TS:2023-02-01T13:03:38 C:10.166.1.14 I:10.160.101.32 U:https://www.myidp.ibm.com/testuser AL:- SI:03f4f666-a1dd-11ed-8641-fa163e997016 T:3 M:GET ST:200 B:1608 F:917 URL:/pkmsoidc
224       TS:2023-02-01T13:03:38 C:10.166.1.14 I:10.160.101.32 U:https://www.myidp.ibm.com/testuser AL:- SI:03f4f666-a1dd-11ed-8641-fa163e997016 T:4 M:GET ST:200 B:4631 F:704 URL:/pkmspublic/default.css
225       TS:2023-02-01T13:03:38 C:10.166.1.14 I:10.160.101.32 U:https://www.myidp.ibm.com/testuser AL:- SI:03f4f666-a1dd-11ed-8641-fa163e997016 T:5 M:GET ST:200 B:467 F:800 URL:/pkmspublic/show_message.js
226       TS:2023-02-01T13:03:38 C:10.166.1.14 I:10.160.101.32 U:https://www.myidp.ibm.com/testuser AL:- SI:03f4f666-a1dd-11ed-8641-fa163e997016 T:6 M:GET ST:200 B:593 F:316 URL:/pkmspublic/update_clock.js
227       TS:2023-02-01T13:03:38 C:10.166.1.14 I:10.160.101.32 U:https://www.myidp.ibm.com/testuser AL:- SI:03f4f666-a1dd-11ed-8641-fa163e997016 T:7 M:GET ST:200 B:2144 F:387 URL:/pkmspublic/background.png{noformat}

enable-last-login is set to yes in webseal and 

enable-last-login is set to yes and provide-last-login is set to yes ivmgrd conf 





<testenv>

SP - [https://10.160.100.50/isam/wpm#|https://10.160.100.50/isam/wpm#]

IDP - [https://10.160.100.51/isam/wpm#|https://10.160.100.50/isam/wpm#]

test url - [https://www.mysp.ibm.com/pkmsoidc|https://www.mysp.ibm.com/pkmsoidc] 
testuseronsp1 /Passw0rd  in dc=iwsga

testuseronsp2 /Passw0rd in secAuthority=Default 


So far looks like an RFE , checking if there are tweaks that we can do to update.","06/Feb/23 10:27 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c87cb8d88f9ec6ae0afb306] 

I can see that /pkmsoidc  doesn't update the last login.

Please create an RFE for this, currently not supported.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"Creation of http 2.0 virtual host junction on 10.0.4 machine causes WGAWA0034E   The process, /opt/pdweb/bin/webseald, was terminated by the signal, 6",ISAMSUP-4726,276697,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,19/Jan/23 10:19 PM,12/Jun/23 11:49 AM,14/Jul/23 2:47 PM,04/Apr/23 6:20 PM,10.0.6,,,0,,,,"Creation of http 2.0 virtual host junction on 10.0.4 machine causes WGAWA0034E   The process, /opt/pdweb/bin/webseald, was terminated by the signal, 6. further investigation below shows the webseal is crashing.



virtualhost junction (ezlog.testeportal.skoda.vwg:443). This VHJ is bound to the WebSEAL interface interface-ezlog.testeportal.skoda.vwg. Customer modified the interface configuration as follows: 

{noformat}[interfaces] interface-ezlog.testeportal.skoda.vwg = network-interface=10.217.183.13;certificate-label=ezlog.testeportal.skoda.vwg; https-port=4024; http-port=3024; enable-http2=yes; http2-max-connections=200; http2-header-table-size=4096; http2-max-concurrent-streams=100; http2-initial-window-size=65535; http2-max-frame-size=16384; http2-max-header-list-size=32768; accept-client-certs=prompt_as_needed{noformat}

 

{noformat}/usr/lib64/libamwebrte.so(amw_backtrace+0x28) [0x7fc0f38618e8] -- from WSPamMgr::handleException(void*) -- from /lib64/libpthread.so.0(+0x12c20) [0x7fc0f121fc20] -- from HTTPMessage::moveFrom(HTTPMessage*) -- from HTTPResponse::moveFrom(HTTPResponse*) -- from MuxStream::doRead(HTTPResponse*, HTTPParser*) -- from HTTPParser::doParseResponse(HTTPResponse*, unsigned char) -- from HTTPParser::parseResponse(InByteStream*, HTTPResponse*, unsigned char) -- from ThirdPartyServer::doDispatchRequest(h_s_t*, HTTPRequest*, HTTPResponse*) -- from JunctionServer::dispatchRequest(h_s_t*, HTTPRequest*, HTTPResponse*) -- from RemoteJunction::doHandleRequest(h_s_t*, ResourceInfo*, wand_client_ident_s_t const*, HTTPRequest*, HTTPResponse*) -- from Junction::handleRequest(h_s_t*, ResourceInfo*, wand_client_ident_s_t const*, HTTPRequest*, HTTPResponse*) -- from requestDispatch(h_s_t*, Junction*, HTTPRequest*, ClientOutputInfo&, HTTPResponse&, unsigned long*) -- from /usr/lib64/libwsdaemon.so(+0x21846f) [0x7fc0f416f46f] -- from process_junction(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, nvlist_s_t*, unsigned long*) -- from authAndProcess(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, unsigned long*) -- from /usr/lib64/libwsdaemon.so(+0x1b6c1f) [0x7fc0f410dc1f] -- from handle_call(h_s_t*, HTTPRequest*, HTTPResponse*, unsigned int*, unsigned long*) -- from /usr/lib64/libwsdaemon.so(call_start+0x139) [0x7fc0f410c929] -- from WsWorker::work() 2023-01-02-14:11:06.938+01:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 657 0x7f5f5e7d1700 -- WGAWA0034E The process, /opt/pdweb/bin/webseald, was terminated by the signal, 6. The process will be automatically restarted. -- IBM Security Verify Access WebSEAL Version 10.0.4.0 (Build 20220608_0037) -- Copyright (C) IBM Corporation 1994-2022. All Rights Reserved.{noformat}

From /var/log/messages:

{noformat}Jan  9 10:09:49 kernel: webseald[16295]: segfault at 0 ip 0000000000000000 sp 00007f51f1186c08 error 14 in webseald[400000+4000]{noformat}

:/ecurep/sf/TS011/694/TS011694834/2023-01-09/isva_10.0.5.0_20230109-150159_smbmtr001.fw.skoda.vwg.support_unpack/core_file_stack_trace $

 ls -ltr

total 10496

-rwxrwxr-x 1 ecuunpck swsupt 896261 Jan 09 14:02 core_webseald.10093.stack

-rwxrwxr-x 1 ecuunpck swsupt 871823 Jan 09 14:02 core_webseald.1213.stack

-rwxrwxr-x 1 ecuunpck swsupt 874833 Jan 09 14:02 core_webseald.22459.stack",,Dermot Daly,Edvan Ponciano,khansen,Nick Lloyd,Reagan Knowles,,,,,,,,,,,6092ac9ff6c0960069d47a67,614dd52af1c1740068534813,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4911,,15/Mar/23 2:56 PM;phorner;http2_trace_10050.fixpack;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190232,,,,,,,,,,,,,,,IJ45033,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011694834,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,SKODA AUTO A.S.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=10, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":10,""lastUpdated"":""2023-03-23T12:06:12.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":10,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17qvb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-19 23:34:26.612,,,,,"20/Jan/23 9:34 AM;5b15d9517dab4c51f61b5190;[~accountid:614dd566a995ad0073ec0622] 

Please open an APAR “Webseal crash when send request to HTTP 2.0 Virtual Host Junction“

Please include the following stack trace with the APAR

{noformat}Thread 1 (Thread 0x7f9173cb2700 (LWP 11241)):
#0  0x00007f91d18ffa9f in raise () from /lib64/libc.so.6
No symbol table info available.
#1  0x00007f91d18d2e05 in abort () from /lib64/libc.so.6
No symbol table info available.
#2  0x00007f91cf0b460f in WSPamMgr::handleException(void*) () from /opt/pdweb/lib/libwswaf.so
No symbol table info available.
#3  <signal handler called>
No symbol table info available.
#4  0x00007f91d5493b0b in HTTPMessage::moveFrom(HTTPMessage*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#5  0x00007f91d5493be1 in HTTPResponse::moveFrom(HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#6  0x00007f91d54cf7de in MuxStream::doRead(HTTPResponse*, HTTPParser*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#7  0x00007f91d54985ff in HTTPParser::doParseResponse(HTTPResponse*, unsigned char) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#8  0x00007f91d54987a4 in HTTPParser::parseResponse(InByteStream*, HTTPResponse*, unsigned char) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#9  0x00007f91d552cd65 in ThirdPartyServer::doDispatchRequest(h_s_t*, HTTPRequest*, HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#10 0x00007f91d55239bd in JunctionServer::dispatchRequest(h_s_t*, HTTPRequest*, HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#11 0x00007f91d552716e in RemoteJunction::doHandleRequest(h_s_t*, ResourceInfo*, wand_client_ident_s_t const*, HTTPRequest*, HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#12 0x00007f91d550fe9b in Junction::handleRequest(h_s_t*, ResourceInfo*, wand_client_ident_s_t const*, HTTPRequest*, HTTPResponse*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#13 0x00007f91d5514ede in requestDispatch(h_s_t*, Junction*, HTTPRequest*, ClientOutputInfo&, HTTPResponse&, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#14 0x00007f91d550bcbf in zprocess_and_convert(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#15 0x00007f91d550bf2b in process_junction(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#16 0x00007f91d542188c in authAndProcess(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#17 0x00007f91d54aa12f in handleCallInternal(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned long*, unsigned int*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#18 0x00007f91d54abe31 in handle_call(h_s_t*, HTTPRequest*, HTTPResponse*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#19 0x00007f91d54a8e39 in call_start () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#20 0x00007f91d54aef0c in WsWorker::work() () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#21 0x00007f91d54afa92 in WsWorkerThread () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#22 0x00007f91d25ad1cf in start_thread () from /lib64/libpthread.so.0
No symbol table info available.
#23 0x00007f91d18eadd3 in clone () from /lib64/libc.so.6
No symbol table info available.
{noformat}

The stack traces are identical across all 6 cores on ecurep (3 from 10.0.4.0 and 3 from 10.0.5.0)

It is crashing in processing the response",20/Jan/23 9:11 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9517dab4c51f61b5190]  IJ45033 created.,"24/Jan/23 6:44 PM;614dd52af1c1740068534813;Hi [~accountid:5b15d9517dab4c51f61b5190] , Any Update? Please let me know if you need any more info. Thanks!","24/Jan/23 7:03 PM;5b15d9517dab4c51f61b5190;Not an obvious cause - still working on it

Can see that its crashing processing a response from the Http 2 junction

Customer has only one http 2 junction  - the virtual host junction  ezlog.testeportal.skoda.vwg:443

WebSEAL crashed when requests were made to the junction

The requests were not logged - but I can see them in the core

From one of the cores - it crashed following these requests

{noformat}ezlog.testeportal.skoda.vwg 10.217.183.198 - unauthenticated [09/Jan/2023:14:32:21.320 +0100] ezlog.testeportal.skoda.vwg:443 ""GET / HTTP/2"" 401 - 14411bytes 1 1564
ezlog.testeportal.skoda.vwg 10.217.183.198 - D515323 [09/Jan/2023:14:32:21.377 +0100] ezlog.testeportal.skoda.vwg:443 ""GET / HTTP/1.1"" 200 200 3520bytes 1 777067{noformat}

So I suspect the next request to {{ezlog.testeportal.skoda.vwg}}

There were some unrelated requests that completed after those but unsure if related to crash

They have the D515323 username in the path of the url

{noformat}testesb01.skoda.vwg 10.217.183.198 - SA6V87K [09/Jan/2023:14:32:21.691 +0100] /LdapWs11 ""GET /LdapWs11/srv/user/D515323/app/EZLog?type=json HTTP/1.1"" 200 200 2bytes 1 163324
testesb01.skoda.vwg 10.217.183.198 - SA6V87K [09/Jan/2023:14:32:21.925 +0100] /LdapWs11 ""GET /LdapWs11/srv/user/D515323?type=json HTTP/1.1"" 200 200 233bytes 1 135954{noformat}","02/Feb/23 6:35 AM;614dd52af1c1740068534813;Hi [~accountid:5b15d9517dab4c51f61b5190]  . Any progress?



A bit more information.  I asked the customer if they are using F5 as I have another Jira regarding HTTP2 issues, and for that one, it’s an issue from F5 side

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4253|https://cloudidentity.atlassian.net/browse/ISAMSUP-4253|smart-link] 



Yesh They are using F5 but,  they said:

*_We use F5 as load balancer, so the communication chain is client browser -> F5 LB -> ISVA WebSEAL -> backend application. F5 LB do not terminate SSL connection (balancing on layer 4)._*
","02/Feb/23 7:32 AM;5b15d9517dab4c51f61b5190;I don’t think this issue is related to F5

The stack trace identifies the crash is between webseal and the junction - processing the response from the junction",08/Feb/23 3:10 AM;614dd52af1c1740068534813;Hi [~accountid:5b15d9517dab4c51f61b5190] . Any luck? Please let me know if you need something from L2/customer. Thanks in advance ,"15/Feb/23 12:46 PM;5b15d9517dab4c51f61b5190;No luck yet

But I found the same stack trace has been seen before - in [https://cloudidentity.atlassian.net/browse/ISAMSUP-2706|https://cloudidentity.atlassian.net/browse/ISAMSUP-2706|smart-link] but was never resolved (same customer)",21/Feb/23 3:44 AM;614dd52af1c1740068534813;Hi [~accountid:5b15d9517dab4c51f61b5190] any news? ,"22/Feb/23 3:25 PM;5b15d9517dab4c51f61b5190;I have not been able to reproduce the crash.

I have been able to produce a very similar crash by making a code change to use a NULL pointer instead of the received response.

So I suspect there is some condition (possibly a race) that I have not found yet that causes {{HTTPResponse::moveFrom}} to be called with a null pointer

Can you enable  pdweb.http2 level 9 with 1 second flush interval trace and reproduce the crash","23/Feb/23 8:46 PM;614dd52af1c1740068534813;Hi [~accountid:5b15d9517dab4c51f61b5190] . The customer has sent the traces you requested
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011694834&path=TS011694834%2F2023-02-23%2Fisva_10.0.5.0_20230223-111254_smbmtr001.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fintranet%2Ftrace%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011694834&path=TS011694834%2F2023-02-23%2Fisva_10.0.5.0_20230223-111254_smbmtr001.fw.skoda.vwg.support_unpack%2Fvar%2Fpdweb%2Fintranet%2Ftrace%2F]","01/Mar/23 7:40 PM;614dd52af1c1740068534813;Hi [~accountid:5b15d9517dab4c51f61b5190] , any update?","03/Mar/23 3:08 PM;5b15d9517dab4c51f61b5190;[~accountid:614dd52af1c1740068534813] 

The last support file with trace helped but I still cannot reproduce the crash.

I have identified a piece of code that could possibly be the issue.

So I intend to build a diagnostic 10.0.5.0 fixpack with a change that could possibly fix the crash

If I have identified the issue then the fix will prevent it from crashing - and log a trace message if it would previously have crashed.

If the code I have identified is not the cause - it will still crash

Is this a production system?

Is the customer willing to try a fixpack that may not fix the issue?

FYI 

the latest support file showed it gets the requested page - but crashes when getting 1 of the resources referenced in the html

The url it is crashing on is [Content/kendo/kendo-ui-bundle?v=Kz4maRncbvxlyMhngPhvxRu3w02oJ2PTVa1ohUqaoUc1|http://10.150.26.175:8080/http2/ihs/Content/kendo/kendo-ui-bundle?v=Kz4maRncbvxlyMhngPhvxRu3w02oJ2PTVa1ohUqaoUc1]","03/Mar/23 3:34 PM;5b15d9517dab4c51f61b5190;[~accountid:614dd52af1c1740068534813]

The other possibility is that it is pam related

Can the customer set the webseal config setting 

[PAM]

pam-enabled = false

restart webseal and try to reproduce the crash 

If it still crashes - the issue is unrelated to pam","07/Mar/23 10:22 PM;614dd52af1c1740068534813;[~accountid:5b15d9517dab4c51f61b5190] The customer set the PaM, but no joy


{noformat}#
# The PAM stanza is used to house the configuration data which
# is required for the PAM integration. The PAM functionality
# is used to provide deep content packet inspection on selected
# requests, checking for potential security vulnerabilities.
#

[PAM]

#
# Whether PAM analysis is enabled.
#
pam-enabled = false
{noformat}

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011694834&path=TS011694834%2F2023-03-07%2F&filepath=TS011694834%2F2023-03-07%2Fisva_10.0.5.0_20230307-125306_smbmtr001.fw.skoda.vwg.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011694834&path=TS011694834%2F2023-03-07%2F&filepath=TS011694834%2F2023-03-07%2Fisva_10.0.5.0_20230307-125306_smbmtr001.fw.skoda.vwg.support]","15/Mar/23 3:05 PM;5b15d9517dab4c51f61b5190;[~accountid:614dd52af1c1740068534813] 

I have attached the http2_trace_10050.fixpack to this item

I still have not been able to reproduce the crash

I have identified a piece of code that could possibly be the issue.

If I have correctly identified the cause then the fixpack will prevent webseal from crashing - and log a trace message if it would previously have crashed.

If the code I have identified is not the cause - it will still crash

After applying the fixpack please enable pdweb.http2 level 9 with 1 second flush interval trace and try to reproduce the crash

Regardless of whether it still crashes please create a support file that includes the trace.

The fixpack will restart all webseals

So customer should install at a time that will cause minimum disruption","16/Mar/23 1:39 AM;614dd52af1c1740068534813;Hi [~accountid:5b15d9517dab4c51f61b5190] 
The customer installed the fix pack and ran the test. Unfortunately the result is still the same -  uploaded a new support file with the http2 trace
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011694834&path=TS011694834%2F2023-03-15%2Fisva_10.0.5.0_20230315-144230_smbmtr001.fw.skoda.vwg.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011694834&path=TS011694834%2F2023-03-15%2Fisva_10.0.5.0_20230315-144230_smbmtr001.fw.skoda.vwg.support_unpack%2F]","16/Mar/23 2:59 PM;5b15d9517dab4c51f61b5190;[~accountid:614dd52af1c1740068534813] 

The trace in the core file shows the cause of the crash (This line is the trace just before the crash that hadn’t been flushed to the trace file yet)

{noformat}2023-03-15-14:40:18.685+01:00I----- thread(10) trace.pdweb.http2.jct:4 MuxConnection.cpp:861: [10.217.183.198] S:354:1: MuxStream::doRead: Received Notification of response 0x {noformat}

Response shouldn't be 0 - Crashes when receives 0

I expected to see a corresponding “{{Notifying Reader response}}"" message as in the first request which worked

{noformat}2023-03-15-14:40:18.652+01:00I----- thread(9) trace.pdweb.http2.jct:4 MuxConnection.cpp:641: [] S:354: MuxConnection::handleHeadersFrame(): Notifying Reader response 0x7f74c01e0690
2023-03-15-14:40:18.652+01:00I----- thread(9) trace.pdweb.http2.jct:4 MuxConnection.cpp:658: [] S:354: <= MuxConnection::handleHeadersFrame(): 0
2023-03-15-14:40:18.652+01:00I----- thread(9) trace.pdweb.http2.jct:4 Http2.cpp:1621: [] S:354: <= Http2Connection::readAndProcessFrame(): 0
2023-03-15-14:40:18.652+01:00I----- thread(9) trace.pdweb.http2.jct:4 Http2.cpp:1492: [] S:354: => Http2Connection::readAndProcessFrame(10)
2023-03-15-14:40:18.652+01:00I----- thread(9) trace.pdweb.http2.jct:4 Http2.cpp:780: [] S:354: => Http2Connection::readFrameHeader(10)
2023-03-15-14:40:18.652+01:00I----- thread(9) trace.pdweb.http2.jct:4 MuxConnection.cpp:428: [] S:354: => MuxConnection::readBytes(9) Http2.cpp:787
2023-03-15-14:40:18.652+01:00I----- thread(7) trace.pdweb.http2.jct:4 MuxConnection.cpp:861: [10.217.183.198] S:354:1: MuxStream::doRead: Received Notification of response 0x7f74c01e0690
{noformat}

 So need to work out how code is getting triggered without being notified","16/Mar/23 9:07 PM;5b15d9517dab4c51f61b5190;[~accountid:614dd52af1c1740068534813] 

I have finally recreated the crash

The crash is related to persistent connections to http2 junctions

So the work around until I get a fix for the issue is to disable persistent connections for the http2 junction

This customer currently has 

[junction:ezlog.testeportal.skoda.vwg:443]
http2-max-concurrent-streams = 100

The work around is to add the line 

persistent-con-timeout = 0

to the [junction:ezlog.testeportal.skoda.vwg:443] stanza

This is a temporary solution until I have a fixpack","16/Mar/23 9:15 PM;614dd52af1c1740068534813;Great [~accountid:5b15d9517dab4c51f61b5190] I will tell the customer regarding the workaround till you build the  fixpack for him.

Thanks for the very good work on this issue!","17/Mar/23 9:05 AM;5b15d9517dab4c51f61b5190;FYI

The crash issue will happen on any http2 junction with persistent connection. Its  not specific to virtual host junctions ","17/Mar/23 10:28 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 90a04a36e74d89bed619cd55bc9377303c94a95c
   * description: ISAMSUP-4726 IJ45033 HTTP 2 Junction crash when persistent connection

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86888697.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4726) which we publish.","20/Mar/23 2:57 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 8530e634cd883b31e3f4b1454265a246673f12ee
   * description: ISAMSUP-4726 IJ45033 HTTP 2 Junction crash when persistent connection (#5757)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86991175.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230320045429-8530e634.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","20/Mar/23 4:11 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 8530e634cd883b31e3f4b1454265a246673f12ee
   * description: ISAMSUP-4726 IJ45033 HTTP 2 Junction crash when persistent connection (#5757)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86992661.


This build has not been published as the commit is not currently within a branch (20230320045429-8530e634) which we publish.","21/Mar/23 10:43 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 8530e634cd883b31e3f4b1454265a246673f12ee
   * description: ISAMSUP-4726 IJ45033 HTTP 2 Junction crash when persistent connection (#5757)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86992661.


This build has not been published as the commit is not currently within a branch (20230320045429-8530e634) which we publish.","21/Mar/23 9:50 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 2b96566178506d3a0cd35a1f2570c1da09b3b461
   * description: ISAMSUP-4726 IJ45033 fix cause of http2 junction crash

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87094720.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4726) which we publish.","22/Mar/23 12:02 PM;5b15d9517dab4c51f61b5190;[~accountid:614dd52af1c1740068534813] 

The issue was the http2 junctions are supposed to ignore the junction persistent connection settings - as http2 only makes 1 connection to the junction server and sends all the requests over the single connection

So the fix will behave identically to  the work around

There is no need for a fixpack if the customer is happy with leaving the
persistent-con-timeout = 0 setting in place for the ezlog.testeportal.skoda.vwg:443 junction 

Regarding the customers question about the browser responding with http 1.1 request following the http2 401 response in the case

This must be a browser issue

I configured ba auth (to force a 401 response) and  chrome (on my Mac and on windows) and safari on my Mac all continue to use http 2.0","23/Mar/23 12:06 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: eab5225b3cb7bb3aeb7a51a595d121727f3257c3
   * description: Merge pull request #5770 from ISAM/ISAMSUP-4726

ISAMSUP-4726 IJ45033 fix cause of http2 junction crash

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87244613.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230323020308-eab5225b.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",23/Mar/23 3:36 PM;5b15d9517dab4c51f61b5190;The fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4911|https://cloudidentity.atlassian.net/browse/ISAMSUP-4911|smart-link] ,"04/Apr/23 6:20 PM;614dd52af1c1740068534813;fixpack worked, hence closing the JIRA. Thanks [~accountid:5b15d9517dab4c51f61b5190] for the excellent work, as always!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
HttpClientV2 setTimeout.,ISAMSUP-4715,276327,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Nick Lloyd,5b15d9e6dda5f94d06b985b4,Nick Lloyd,5b15d9e6dda5f94d06b985b4,18/Jan/23 6:22 AM,21/Feb/23 10:45 AM,14/Jul/23 2:47 PM,21/Feb/23 10:45 AM,10.0.6,Support,,0,,,,"We use the new HttpClientV2 on AAC for calling APIs through DataPower and APIC. The HttpClientV2 methods can take RequestParameters object.

In RequestParameters, it can set timeout by its method setTimeout(value). We have tested this does not work, instead the value from Advanced Configuration property ""util.httpClientv2.connectTimeout"" (default of 5 seconds) is always used so we cannot set the timeout value by connection. 
",,gvacek,khansen,tonyferg,Tushar Prasad,,,,,,,,,,,,5c87cb8d88f9ec6ae0afb306,5b15d901fa615349cb01778b,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4737,,,,,,28/Jan/23 3:42 AM;gvacek;httpclientv2test.js;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/180566,04/Feb/23 12:54 AM;gvacek;newertrace.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181623,01/Feb/23 11:50 PM;gvacek;newtrace.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181316,31/Jan/23 1:52 AM;gvacek;trace.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/180815,28/Jan/23 3:42 AM;gvacek;traces.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/180565,,,,,,,,,,,IJ45402,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011835324,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nick Lloyd,5b15d9e6dda5f94d06b985b4,,,,BANK OF MONTREAL,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=8, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":8,""lastUpdated"":""2023-02-16T10:52:37.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":8,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17on3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-01-18 03:44:07.008,,,,,"18/Jan/23 1:44 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9e6dda5f94d06b985b4] 

Which call are they using - Is it this -

{noformat}httpGet(RequestParameters params) {
        
         httpGet(params.getUrlString(),
                params.getHeaders(),
                params.getTrustStore(),
                params.getBasicAuthUsername(),
                params.getBasicAuthPassword(),
                params.getClientKeyStore(),
                params.getClientKeyAlias(),
                params.getProtocol(),
                params.isThrowExec(),
                params.getTimeout(),
                params.getProxyServer());
    }{noformat}

Set the value for the connection timeout in seconds.

* A value of 0 will result in no connection timeout.
* If not set or set to a value less than 0 the timeout will be set as the advanced configuration property util.httpClientv2.connectTimeout.

If yes - Let me know I can add some trace to the httpGet call and see if the values are being passed properly.

Can we get support file to show some trace on these calls? 

Do they have any fixpacks in place if we would like to send a fixpack to add some denim on these parameters passed in for the calls.","24/Jan/23 1:40 AM;5c87cb8d88f9ec6ae0afb306;Hello Asha, 
Nick is out today.

This issue was initially reported in case TS011833001, about using the wrong certificate in the httpClientv2 call.  ([https://cloudidentity.atlassian.net/browse/ISAMSUP-4711|https://cloudidentity.atlassian.net/browse/ISAMSUP-4711|smart-link] )  [~accountid:5b15d9e581c3df12acf53c4a] is working on that issue.  If you are planning on adding some tracing, it might be worth capturing both issues in a trace.

In /ecurep/sf/TS011/833/TS011833001/2023-01-13, we have a support file and the mapping rule the client is using.

The client is at 10.0.3.1 and has the following fixes: 
aznserverlist_lmi_view_fix_10030
POP_ATTACHMENT_CHECK_TUNING_PARAM_10031_001
IJ38991_VALIDATE_CERT_PATH_10031_FIX

The mapping rule is: /ecurep/sf/TS011/833/TS011833001/2023-01-13/testHttpClientV2mappingrule.js.txt

In there, they are using: 
  case ""POST"":^M
        logDebug([arguments.callee.name|http://arguments.callee.name], ""Calling  HttpClientV2.httpPost(reqParams)"");^M
        reply = HttpClientV2.httpPost(reqParams);^M
        logDebug([arguments.callee.name|http://arguments.callee.name], ""Calling  HttpClientV2.httpPost(...)"");^M
        reply = HttpClientV2.httpPost?(serverConnection.url, headers, params, serverConnection.keystore, null, null, serverConnection.keystore, serverConnection.label);^M
        break;^M


The trace file is: /ecurep/sf/TS011/833/TS011833001/2023-01-13/bmo_trace_-_2023-01-13T150222.633.log 

[1/13/23, 14:59:42:070 EST] 00000032 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils 2 traceString (uuidacb76bcc-0185-10a5-973c-cb919b7575b5)[TestHttpClientV2:httpClientCallV103] Calling  HttpClientV2.httpPost(reqParams)



Regards, 
Gary","25/Jan/23 1:09 PM;5af4ad7d4dd24c579110120b;Fixpack with debug trace updated: [https://cloudidentity.atlassian.net/browse/ISAMSUP-4737|https://cloudidentity.atlassian.net/browse/ISAMSUP-4737|smart-link] 

Trace for com.ibm.security.*=ALL ","28/Jan/23 3:45 AM;5c87cb8d88f9ec6ae0afb306;Hello Asha, 

I got help from [~accountid:5b15d950d9936c61022057fe] (She created an infomap) and was able to gather the data that you requested.  

Here is a grep of the debug entries: 

{noformat}
[1/27/23, 11:36:22:916 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > Debug000httpPost ENTRY com.ibm.security.access.httpclient.RequestParameters@1d09994
[1/27/23, 11:36:22:917 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() CN=test1   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[1/27/23, 11:36:22:953 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In HTTPPost Before dorequest params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() CN=test1   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[1/27/23, 11:36:22:954 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest  params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() CN=test1   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[1/27/23, 11:36:23:739 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient connectTimeout 5000
[1/27/23, 11:36:23:739 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient socketTimeout 5000
[1/27/23, 11:36:23:740 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient httpsTrustStore rt_profile_keys
[1/27/23, 11:36:23:740 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient clientKeyStore rt_profile_keys
[1/27/23, 11:36:23:740 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient clientKeyAlias CN=test1
[1/27/23, 11:36:24:819 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In HTTPPost Before dorequest params.getTimeout() -1   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() CN=test1   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[1/27/23, 11:36:24:819 CST] 00000048 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest  params.getTimeout() -1   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() CN=test1   params.getProtocol() null   params.getTrustStore() rt_profile_keys   {noformat}



I have attached the entire trace (please note that I have extra specs as I’m also working on collecting data for the certificate issue.)  I also included the infomap that I used. 

Gary","30/Jan/23 3:32 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c87cb8d88f9ec6ae0afb306] 

I have updated the fixpack with a slight change in the way it sets the client timeout and also have added a couple more debug lines after it sets the timeout.

Can we run the test against this new fixpack and get trace please.

Thanks",31/Jan/23 1:53 AM;5c87cb8d88f9ec6ae0afb306;I have uploaded a new trace.log.  It appears to capture the data from the new fixpack. ,"31/Jan/23 9:45 AM;5af4ad7d4dd24c579110120b;

Hi [~accountid:5c87cb8d88f9ec6ae0afb306] 

This is from the trace you added - I think the last line shows that the value s being retained to 120000 now - so did the connection timeout change from 5000 to 120000 after this version of the fixpack? 

{noformat}
17863:[1/30/23, 9:41:41:316 CST] 0000002e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > Debug000httpPost ENTRY com.ibm.security.access.httpclient.RequestParameters@4513d166
17864:[1/30/23, 9:41:41:318 CST] 0000002e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
17870:[1/30/23, 9:41:41:363 CST] 0000002e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In HTTPPost Before dorequest params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
17872:[1/30/23, 9:41:41:364 CST] 0000002e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest  params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
17930:[1/30/23, 9:41:42:430 CST] 0000002e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient connectTimeout 5000
17931:[1/30/23, 9:41:42:430 CST] 0000002e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient socketTimeout 5000
17932:[1/30/23, 9:41:42:430 CST] 0000002e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient httpsTrustStore rt_profile_keys
17933:[1/30/23, 9:41:42:431 CST] 0000002e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient clientKeyStore rt_profile_keys
17934:[1/30/23, 9:41:42:431 CST] 0000002e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient clientKeyAlias server
19610:[1/30/23, 9:43:02:703 CST] 0000004a id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > Debug000httpPost ENTRY com.ibm.security.access.httpclient.RequestParameters@e9832ad0
19611:[1/30/23, 9:43:02:703 CST] 0000004a id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
19617:[1/30/23, 9:43:02:712 CST] 0000004a id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In HTTPPost Before dorequest params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
19619:[1/30/23, 9:43:02:712 CST] 0000004a id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest  params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   {noformat}","01/Feb/23 12:03 AM;5c87cb8d88f9ec6ae0afb306;Hello Asha, 

I cannot verify if the timeout is correct or not. 

*Without* the new fixpack, I see entries in the logs like: 

[1/31/23, 7:47:28:872 CST] 00000035 id=00000000 org.apache.http.conn.ssl.SSLConnectionSocketFactory          1 connectSocket Connecting socket to /192.168.122.211:443 with timeout 5000

[1/31/23, 7:47:29:095 CST] 00000035 id=00000000 org.apache.http.conn.ssl.SSLConnectionSocketFactory          1 connectSocket Connecting socket to /192.168.122.211:443 with timeout 5000



When I apply the new fixpack, It seems to break the infomap, so I don’t know if the settings are actually working.  

trace(1).log:[1/31/23, 7:50:46:083 CST] 0000002b id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY (uuid8180567-0186-1377-bb6f-bb688a58d14b) GFMWVzjulc :  MEEPING ERROR: java.lang.UnsupportedOperationException: null

I do not see any “connectSocket” calls. 

You can see this difference between the initial traces.log (With the first version of the debug patch) and trace.log (with the new debug patch), you can see the error is introduced. 

You can see the code in the httpclientv2test.js infomap that is attached.

Gary
","01/Feb/23 10:17 AM;5af4ad7d4dd24c579110120b;[~accountid:5c87cb8d88f9ec6ae0afb306] 

In your infomap posted here what is {{test_WebSEAL}} Is this a LDAP/Webservice connection? 
What properties have you used? 

{noformat}var serverConnection = ServerConnectionFactory.getWebConnectionByName('test_WebSEAL');{noformat}","01/Feb/23 2:37 PM;5af4ad7d4dd24c579110120b;<Testenv>
10.160.100.128
admin/admin 
[https://10.160.101.128/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1|https://10.160.101.128/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1] 

Totry:
change clientContext.setAttribute(""http.conn-manager.timeout"", timeout); 
to clientContext.setAttribute(""http.connection-manager.timeout"", timeout);

get params of client and validate and then use setparams instead of setting in context/

{noformat}        // Set the individual request params
        HttpClientContext clientContext = HttpClientContext.create();
        if(timeout > -1) {
            clientContext.setAttribute(""http.conn-manager.timeout"", timeout); // Timeout for individual requests
            clientContext.setAttribute(""http.connnection-manager.timeout"", timeout);
        }

        RequestConfig config = RequestConfig.copy(clientContext.getRequestConfig()).setConnectTimeout(timeout).setSocketTimeout(timeout).build();
        clientContext.setRequestConfig(config);
        {noformat}","01/Feb/23 8:39 PM;5af4ad7d4dd24c579110120b;[~accountid:5c87cb8d88f9ec6ae0afb306] 

I have updated the fixpack to fix the java.lang.UnsupportedOperationException.
See how you go with this fixpack if the connection timeout is updated.","01/Feb/23 11:50 PM;5c87cb8d88f9ec6ae0afb306;[~accountid:5af4ad7d4dd24c579110120b] 
Thanks!  That looks better.

I’ve uploaded a “newtrace.log” file.

I see: 


{noformat}[2/1/23, 7:43:45:136 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > Debug000httpPost ENTRY com.ibm.security.access.httpclient.RequestParameters@39fc634f
[2/1/23, 7:43:45:136 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/1/23, 7:43:45:173 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In HTTPPost Before dorequest params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/1/23, 7:43:45:174 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest  params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/1/23, 7:43:45:828 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient connectTimeout default value (ignore this will be changed later) 5000
[2/1/23, 7:43:45:828 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient socketTimeout default value (ignore this will be changed later) 5000
[2/1/23, 7:43:45:828 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient httpsTrustStore rt_profile_keys
[2/1/23, 7:43:45:829 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient clientKeyStore rt_profile_keys
[2/1/23, 7:43:45:829 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient clientKeyAlias server
[2/1/23, 7:43:46:400 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest clientcontext timeout clientContext.getAttribute 120000
[2/1/23, 7:43:46:760 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In HTTPPost Before dorequest params.getTimeout() -1   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/1/23, 7:43:46:760 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest  params.getTimeout() -1   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/1/23, 7:43:46:761 CST] 0000004e id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest clientcontext timeout clientContext.getAttribute null
gvacek@Garys-MacBook-Pro Downloads % {noformat}

AND, more importantly: 
[2/1/23, 7:43:46:525 CST] 0000004e id=00000000 org.apache.http.conn.ssl.SSLConnectionSocketFactory          1 connectSocket Connecting socket to /192.168.122.211:443 with timeout 120000","02/Feb/23 2:43 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c87cb8d88f9ec6ae0afb306] 

I made another minor update, let me know if this honours the connection timeout.
Updated version at the same fixpack link.

","04/Feb/23 12:54 AM;5c87cb8d88f9ec6ae0afb306;Here are the debug entries from the trace: 

{noformat}[2/3/23, 8:51:06:194 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              > Debug000httpPost ENTRY com.ibm.security.access.httpclient.RequestParameters@c36885c2
[2/3/23, 8:51:06:195 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/3/23, 8:51:06:233 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In HTTPPost Before dorequest params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/3/23, 8:51:06:233 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest  params.getTimeout() 120000   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/3/23, 8:51:07:008 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient connectTimeout default value (ignore this will be changed later) 5000
[2/3/23, 8:51:07:008 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient socketTimeout default value (ignore this will be changed later) 5000
[2/3/23, 8:51:07:009 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient httpsTrustStore rt_profile_keys
[2/3/23, 8:51:07:009 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient clientKeyStore rt_profile_keys
[2/3/23, 8:51:07:009 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In buildNewClient clientKeyAlias server
[2/3/23, 8:51:07:615 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest clientcontext timeout clientContext.getAttribute 120000
[2/3/23, 8:51:07:951 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In HTTPPost Before dorequest params.getTimeout() -1   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/3/23, 8:51:07:951 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest  params.getTimeout() -1   params.getClientKeyStore() rt_profile_keys   params.getClientKeyAlias() server   params.getProtocol() null   params.getTrustStore() rt_profile_keys   
[2/3/23, 8:51:07:952 CST] 00000047 id=00000000 com.ibm.security.access.httpclient.HttpClientV2              3 Debug000httpPost In doRequest clientcontext timeout clientContext.getAttribute null{noformat}

The connection looks to me honoring the timeout value: 
[2/3/23, 8:51:07:748 CST] 00000047 id=00000000 org.apache.http.conn.ssl.SSLConnectionSocketFactory          1 connectSocket Connecting socket to /192.168.122.211:443 with timeout 120000



I will attach the full trace as “newertrace.log”","06/Feb/23 10:18 AM;5af4ad7d4dd24c579110120b;[~accountid:5c87cb8d88f9ec6ae0afb306] 

So if that's working then can I push this changes into the main stream?
Or are you waiting for any confirmation from the client environment?","07/Feb/23 2:08 AM;5c87cb8d88f9ec6ae0afb306;I have not asked the customer to verify this.  

Do you want to generate a fixpack (without the debug messages) to provide to the customer?  Or should we just let them use the one with the debug strings?

","07/Feb/23 11:11 AM;5af4ad7d4dd24c579110120b;[~accountid:5c87cb8d88f9ec6ae0afb306] 

I have updated the fix pack at the same location without any debug statements. 

Thanks","13/Feb/23 4:16 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 937d513bef027787fdc7acc8fe313e55873f3017
   * description: ISAMSUP-4715 settimeout is in milli seconds

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84589480.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4715) which we publish.",14/Feb/23 8:38 AM;5b15d9e6dda5f94d06b985b4;[~accountid:5af4ad7d4dd24c579110120b] Do we need an APAR?,14/Feb/23 9:39 AM;5af4ad7d4dd24c579110120b;Yes please log an APAR.,"14/Feb/23 11:02 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 1c121fa78cd4489cb4fadb789b826848cebaf00b
   * description: Merge pull request #5682 from ISAM/ISAMSUP-4715

Isamsup 4715

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84672719.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230214010004-1c121fa78.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","14/Feb/23 12:22 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 1c121fa78cd4489cb4fadb789b826848cebaf00b
   * description: Merge pull request #5682 from ISAM/ISAMSUP-4715

Isamsup 4715

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84675189.


This build has not been published as the commit is not currently within a branch (20230214010004-1c121fa78) which we publish.","15/Feb/23 10:31 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9e6dda5f94d06b985b4] 

I’ve merged the fix to mainstream should be in 10060.
Can we close this Jira? ","15/Feb/23 3:47 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f2f1c309df007c646b184e2845d89b1aee88f623
   * description: ISAMSUP-4715 Add conversion to milli seconds

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84779198.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4715) which we publish.","15/Feb/23 4:02 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f2f1c309df007c646b184e2845d89b1aee88f623
   * description: ISAMSUP-4715 Add conversion to milli seconds

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84779623.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230215055936-f2f1c309d-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","15/Feb/23 5:24 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f2f1c309df007c646b184e2845d89b1aee88f623
   * description: ISAMSUP-4715 Add conversion to milli seconds

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84783400.


This build has not been published as the commit is not currently within a branch (20230215055936-f2f1c309d-support) which we publish.","16/Feb/23 2:25 AM;5b15d9e6dda5f94d06b985b4;Yes, this can be closed.","16/Feb/23 10:52 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ef3d2e506a7f09e9caf569b8cb275509e7950474
   * description: Merge pull request #5692 from ISAM/ISAMSUP-4715

ISAMSUP-4715 Add conversion to milli seconds

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/84860878.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230216004947-ef3d2e506.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Customer looking for backport of high severity CVEs from latest bulletin,ISAMSUP-4713,276025,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,14/Jan/23 8:30 AM,01/Mar/23 4:33 AM,14/Jul/23 2:47 PM,01/Mar/23 4:33 AM,,Support,,0,,,,"RBC has 30 days to mitigate high severity CVEs as per their organization.

The following CVEs have to be resolved on their appliances targeted at 30days for resolution:

{noformat}CVSS Score  CVE_ID        Priority
========================
8.8	CVE-2022-2526	High
8.1	CVE-2022-24903	High
8.1	CVE-2022-28733	High
7	CVE-2022-28734	High
4.3	CVE-2022-32206	Medium
3.5	CVE-2022-32208	Low
8.2	CVE-2022-1012	High
7.3	CVE-2022-25314	High
6.5	CVE-2022-34903	Medium
7.5	CVE-2018-25032	High
7.5	CVE-2022-22576	High
7.5	CVE-2022-27774	High
7.5	CVE-2022-27776	High
6.3	CVE-2022-1292	Medium
7.3	CVE-2022-2068	High
5.3	CVE-2022-2097	Medium{noformat}

The customer wants to know whether 10.0.4.0 IF1 is vulnerable, to which I already answered yes and then their second question was whether the above can be backported to 10.0.4.0 IF1.",,BRIANORO,David Hayes,jcyarbor,jwade,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,6154906364ff01007106e189,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d8fd6e93913e31e279fb,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4781,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011835050,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,Royal Bank (of Canada),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17mun:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-19 17:53:59.263,,,,,"20/Jan/23 3:52 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d8fd6e93913e31e279fb] ,

Will this request be able to be accommodated?

The customer has asked for an update.","20/Jan/23 3:53 AM;5b15d8fd6e93913e31e279fb;This is not possible. The OS deliveries are based on a full rebase twice a year. I will try to give an example of this using the AIX OS.

Consider the following.

AIX Released the following versions. 7.1, 7.2, 7.3. Packages delivering fixes in AIX 7.3 cannot be run on AIX 7.1. This is similar to the versions of the OS that is delivered for the ISVA Appliance. Another thing to consider is that packages are moved to newer levels in the rebases. A package like rsync may be updated in the rebase from versoin 1.x to 2.x and the vulnerability may only affect the 2.x version of the package.

This is part of why the ISVA Support Policy provides that security fixes are supplied on the most recent modification level.

[https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|smart-link]","24/Jan/23 10:00 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d8fd6e93913e31e279fb] [~accountid:5bac25aaabfcbf73d13e733b] as there has been a discussion via email there is an agreement to assess and back point any PSIRT deliveries for RBC for n-1 versions. This agreement was drive by the product management team to ensure that we can support our customer moving forwards. I am currently reviewing the 10.0.5 PSIRT commitments that the customer has submitted a request for to confirm which can be provide or not. 

[~accountid:5b232b2fd85e5b59b066f57f] and I will be providing an update before the end of our days. 

[~accountid:5b15d8fd6e93913e31e279fb] the specific PSIRTs that the customer is hoping to obtain are outlined in the following URL - 

[https://www.ibm.com/support/pages/node/6855297?myns=swgimgmt&mynp=OCSSRGTL&mync=E&cm_sp=swgimgmt-_-OCSSRGTL-_-E|https://www.ibm.com/support/pages/node/6855297?myns=swgimgmt&mynp=OCSSRGTL&mync=E&cm_sp=swgimgmt-_-OCSSRGTL-_-E|smart-link] ",25/Jan/23 2:35 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] I was included in the email discussion yesterday by [~accountid:5bac25aaabfcbf73d13e733b] and in that email I described in detail where how and why it is not feasible to easily back port these CVEs.  In some cases the CVEs may not even apply to ISVA 10.0.4.0.,"01/Feb/23 2:55 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b15d8fd6e93913e31e279fb] [~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] ,

Wanted to follow up with this issue. Where do we stand?",03/Feb/23 12:22 PM;5b232b2fd85e5b59b066f57f;Tony had a call with the customer last night. I’m providing them with a detailed analysis of each vulnerability and the feasibility of back-porting. ,"10/Feb/23 5:41 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b232b2fd85e5b59b066f57f] ,

Following up with this again.

Is there any further update that I can relay to the customer?",10/Feb/23 7:10 AM;5b15d8fd6e93913e31e279fb;Assigning this to [~accountid:5b232b2fd85e5b59b066f57f] since he and [~accountid:5ac57757d9a96536d1f0daa9] are working with this customer for this issue.,"21/Feb/23 7:36 AM;5bac25aaabfcbf73d13e733b;Hello [~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5ac57757d9a96536d1f0daa9] ,

What became of this?

Is there anything to deliver or did RBC accept that they need to upgrade firmware?","21/Feb/23 9:14 AM;5b232b2fd85e5b59b066f57f;[~accountid:5bac25aaabfcbf73d13e733b] - fixpack has been built → [https://cloudidentity.atlassian.net/browse/ISAMSUP-4781|https://cloudidentity.atlassian.net/browse/ISAMSUP-4781|smart-link] but it hasn’t been provided to the customer yet as we are waiting to hear back on whether they really want it or are just going to upgrade to 10.0.5. Latest response via email was on 16FEB from Service Delivery Exec (Jane) after I let her know the fix-pack was available if they wanted it:

_“Thank you both of you. I will share this information with them. I know they are working on upgrading and they really wanted to move that along. I haven’t heard of another issue so that is probably a good thing. I will send a follow up note asking where they are at. Appreciate your dedication to our account.”_

So still waiting to hear back basically. ","28/Feb/23 9:59 AM;5b232b2fd85e5b59b066f57f;[~accountid:5bac25aaabfcbf73d13e733b]  - latest update from RBC:

_”Hello,_

 

_We are moving forward to 10.0.5 upgrade (not patching 10.0.4)._

_!0.0.5.0 upgrade status: IST (pre-production) was upgraded more than a week ago. We are collecting consumer applications signoffs._

_Production upgrade to be completed by March 10 (tentative).”_

 

i.e. it sounds like they don’t want / need the fix-pack. [~accountid:5bac25aaabfcbf73d13e733b] - if you want to confirm through the case, we may be able to close this one out. ","01/Mar/23 4:33 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b232b2fd85e5b59b066f57f] ,

They are going to upgrade to 10.0.5.0 instead and have closed the case.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
WebSEAL is sending '%20' space characters list of iv-groups to back-end,ISAMSUP-4710,276019,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,14/Jan/23 5:45 AM,03/Feb/23 7:27 AM,14/Jul/23 2:47 PM,03/Feb/23 7:27 AM,10.0.6,,,0,,,,"Problem: When WebSEAL sends a list of iv-groups to the back-end, it is including space characters as %20. The ‘%20’ space characters should not be sent.

Work-around: Disable group entries in the LDAP cache. If you set cache-group-expire-time to 0, then the problem no longer appears.

L2 has reproduced this problem on v10.0.5.

Steps to recreate:

# Use EAI auth and use eai-ext-user-id-header
{{ eai-auth = https}}
{{ eai-ext-user-id-header = am-eai-user-id}}
{{ eai-ext-user-groups-header = fim.groups}}
# Configure the EAI to send a list of groups back to WebSEAL.
# Configure WebSEAL to send the list of groups to the junctioned back-end in the iv-groups header.
# Confirm the LDAP cache group is enabled. I used 20 seconds for my recreate.
{{ cache-group-expire-time = 20}}",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4718,,,,,,,,,,,,,,,,,IJ44983,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS010713896,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Reagan Knowles,5b15d9e44c4ed14b83af8723,,,,Voya,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-01-18T11:09:03.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17mtb:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-13 22:54:22.72,,,,,"14/Jan/23 5:48 AM;5b15d9e44c4ed14b83af8723;Here’s an example of my EAI sending authentication headers back to WebSEAL. Notice the fim.groups list.

{{2023-01-13-13:31:41.524-06:00I----- thread(18) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- PD <=== BackEnd -----------------}}
{{Thread 18; fd 258; local 10.2.1.25:27616; remote 10.2.1.7:443}}
{{HTTP/1.1 200 OK}}
{{connection: close}}
{{content-length: 23}}
{{content-type: text/html}}
{{date: Fri, 13 Jan 2023 19:31:41 GMT}}
{{server: Microsoft-IIS/10.0}}
{{access-control-allow-origin: https://www.avocado.lab}}
{{access-control-allow-credentials: true}}
{{access-control-expose-headers: avocado}}
{{fim.groups: group1, group2}}
{{am-eai-user-id: testuser}}
{{reagan: backend}}



Subsequent requests from WebSEAL to a regular junctioned server the ‘%20’ in the iv-groups:

{{2023-01-13-13:31:41.544-06:00I----- thread(19) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- PD ===> BackEnd -----------------}}
{{Thread 19; fd 258; local 10.2.1.25:50940; remote 10.2.1.25:443}}
{{GET / HTTP/1.1}}
{{accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/;q=0.8}}
{{accept-language: en-US,en;q=0.5}}
{{connection: close}}
{{content-length: 0}}
{{host: sword.toffee.lab}}
{{iv-creds: Version=1, BAKs3DCCBikMADC........1NWQxNmE4M2IEAA==}}
{{iv-groups: ""group1"",""%20group2""}}
{{iv-user: testuser}}
{{user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0}}
{{via: HTTP/1.1 sword.toffee.lab:443}}
{{iv-user-l: cn=testuser,cn=ExternalUser}}
{{upgrade-insecure-requests: 1}}
{{sec-fetch-site: none}}
{{iv_server_name: default-webseald-sword.toffee.lab}}
{{sec-fetch-dest: document}}
{{dnt: 1}}
{{sec-fetch-user: ?1}}
{{sec-fetch-mode: navigate}}
{{Cookie: WASReqURL=https:///; JSESSIONID=00007gFi903pU9UzMTLVZ37zsRG:bf21e6f3-d1ee-4e39-b90f-37f58e36d1cc}}","14/Jan/23 8:54 AM;5b15d94b6256d01ad54eb020;This has been in the code for a long time.  If this is an issue, I have a couple of  questions:

# Why can’t your EAI app trim the spaces before sending it if is causing a problem?
#  The %20 encoding is a standard encoding for a space so why is this a problem? Most apps can handle that.  ",14/Jan/23 9:11 AM;5b15d9e6dda5f94d06b985b4;Why does setting “cache-group-expire-time = 0” not send the %20?,"16/Jan/23 10:11 AM;5b15d9517dab4c51f61b5190;It seems related to the group cache

I have reproduced on 10.0.5.0 for myself

When I have the cache enabled - it doesn't happen the first time I login

But if I login again within the cache timeout period - I see the issue

So only seems to happen on a group cache hit - which would explain why not seen when the group cache is disabled

This agrees with what is in the customers pdweb.debug trace

{noformat}First login
2022-09-23-11:30:54.657-04:00I----- thread(4) trace.pdweb.debug:2 /build/isva10031/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285
...
fim.groups: G-ISAM-VPC-ITSUPPORT-EXT, G-ISAM-VPC-OPERATIONS-EXT, G-ISAM-VPC-SUPERUSER-EXT
No issue  - groups correct
iv-groups: ""G-ISAM-VPC-ITSUPPORT-EXT"",""G-ISAM-VPC-OPERATIONS-EXT"",""G-ISAM-VPC-SUPERUSER-EXT""

Subsequent login
2022-09-23-11:33:14.878-04:00I----- thread(25) trace.pdweb.debug:2 /build/isva10031/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- PD <=== BackEnd -----------------
Thread 25; fd 260; local 10.205.45.19:41302; remote 10.205.42.16:8443
HTTP/1.1 200 OK
...
fim.groups: G-ISAM-VPC-ITSUPPORT-EXT, G-ISAM-VPC-OPERATIONS-EXT, G-ISAM-VPC-SUPERUSER-EXT

%20 in groups
iv-groups: ""G-ISAM-VPC-ITSUPPORT-EXT"",""%20G-ISAM-VPC-OPERATIONS-EXT"",""%20G-ISAM-VPC-SUPERUSER-EXT""{noformat}

Please open an APAR 

What version is the customer using  - as there are no support files on ecurep ","17/Jan/23 2:07 PM;5b15d9517dab4c51f61b5190;It seems that when it finds cache entries it uses the groups as supplied by the EAI

I have tried adding multiple spaces after the , separator of the groups and get iv_groups header like ""group1"",""%20%20%20%20group2""

I think the issue may be we need to process the groups header supplied to remove the spaces between  group names","17/Jan/23 3:14 PM;5b15d9517dab4c51f61b5190;Still not sure of the relationship to the cache - but normalising the header value before processing worked

By normalising I mean removing leading and trailing spaces around the group names

So I wont bother investigating cache

With my test code I used

am-eai-ext-user-groups: group1,         spacey group   ,group2,

and got iv_groups header ""group1"",""spacey%20group"",""group2""

I checked this is the same string as when I added the same groups to an ISVA user and login using forms login (/pkmslogin)","18/Jan/23 12:52 AM;5b15d9e44c4ed14b83af8723;I created APAR IJ44983 for this problem.

Customer reported the problem with v10.0.3.1 and confirmed they are still running v10.0.3.1.","18/Jan/23 1:23 AM;5b15d9e44c4ed14b83af8723;Just adding some context, over the years we've had multiple customers report this problem. This is not a complete list, there may be more.

TS000047249 - AT&T
TS001454804 - AT&T
TS003110918 - State of Michigan
TS010713896 - Voya (current case)
TS004712674 - AT&T and APAR IJ30162","18/Jan/23 10:00 AM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9e44c4ed14b83af8723] 

Change has been approved.

I will build fixpack for 10.0.3.1

There is no support file - so I can’t see if customer has any existing fixpacks (Should have asked for this - sorry)

The fixpack will  update libwsdaemon.so - if they have any existing webseal fixpacks it will likely conflict (undo previous fix(es) as most webseal changes update the same library","18/Jan/23 11:09 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 96d670fc13f5143b629ee1c4d5d715378f755202
   * description: ISAMSUP-4710 IJ44983 iv_groups incorrect when EAI_EXT_USER_GROUPS has spaces (#5653)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82962736.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230118010604-96d670fc1.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",18/Jan/23 3:03 PM;5b15d9517dab4c51f61b5190;The fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4718|https://cloudidentity.atlassian.net/browse/ISAMSUP-4718|smart-link] ,19/Jan/23 5:57 AM;5b15d9e44c4ed14b83af8723;Thanks. I have sent the fixpack to the customer. I’m waiting on the customer’s response.,03/Feb/23 1:22 AM;5b15d9e44c4ed14b83af8723;No response from the customer. I’m flipping this back to L3 to close when ready.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Customer enquiring wrt to ISVA 10.0.2.0 fixpack for recent Jan 2023 CVE Alerts,ISAMSUP-4708,275999,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,14/Jan/23 1:56 AM,08/Feb/23 1:08 PM,14/Jul/23 2:47 PM,08/Feb/23 1:08 PM,,Support,16/Jan/23 12:00 AM,0,,,,"As per recent Jan 2023 Security Bulletin: IBM Security Verify Access Appliance includes components with known vulnerabilities 

[https://www.ibm.com/support/pages/node/6855297|https://www.ibm.com/support/pages/node/6855297|smart-link] 

The advice given is to upgrade to ISVA 10.0.5.0.
Customer/partner is asking for a fixpack for ISVA 10.0.2.0 IF1 on these known vulnerabilities.",,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011829635,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,COLRUYT GROUP SERVICES NV,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,https://www.ibm.com/support/pages/node/6855297,,,,,,,,,,,,,,,,,,,,,,,0|i17mpb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-01-18 16:10:30.401,,,,,"19/Jan/23 2:10 AM;5b15d8fd6e93913e31e279fb;This is not possible.  The OS deliveries are based on a full rebase twice a year.  I will try to give an example of this using the AIX OS.

Consider the following.  

AIX Released the following versions. 7.1, 7.2, 7.3.  Packages delivering fixes in AIX 7.3 cannot be run on AIX 7.1.  This is similar to the versions of the OS that is delivered for the ISVA Appliance.  Another thing to consider is that packages are moved to newer levels in the rebases.  A package like rsync may be updated in the rebase from versoin 1.x to 2.x and the vulnerability may only affect the 2.x version of the package.

This is part of why the ISVA Support Policy provides that security fixes are supplied on the most recent modification level.

[https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|smart-link] ",08/Feb/23 1:08 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Possible bug in dbupdate9 scripts for v10.0.5.0 firmware update,ISAMSUP-4707,275886,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Cesar Mendoza,62fd292b88b05653fa7d4647,Cesar Mendoza,62fd292b88b05653fa7d4647,13/Jan/23 3:36 AM,04/May/23 12:10 PM,14/Jul/23 2:47 PM,17/Jan/23 10:09 AM,10.0.6,Support,,0,,,,"When running the firmware update process from v10.0.4.0 to v10.0.5.0 we noticed the following error in the output from the config db update process on our DB2 server...

CONSTRAINT IAH_CK4 CHECK (IS_JSON IN ('Y', 'N'))

DB20000I The SQL command completed successfully.

REORG TABLE DB2INST1.ISAM_AUDIT_HANDLERS

SQL2211N The specified table does not exist.

UPDATE ISAM_AUDIT_HANDLERS SET IS_JSON = JSON_VAR

DB21034E The command was processed as an SQL statement because it was not a

valid Command Line Processor command. During SQL processing it returned:

SQL0668N Operation not allowed for reason code ""7"" on table

""HVDBDEV.ISAM_AUDIT_HANDLERS"". SQLSTATE=57016

It looks like the set of statements in this SQL file within the zip are what processes that set of commands.

config/db2/cluster_config_db2_update_202210191.sql

I do notice that the default instance name (DB2INST1) is listed in the reorg command in that file which is likely what that command failed.

Not sure why the UPDATE statement failed...I have one of our internal DBAs looking into that currently.

Just logging this as a potential bug and if so what are the recommendations for a fix.



Resolution:

FYI...after discussing with our internal DBA we removed the DB2INST1 schema name from the reorg command and manually re-ran that single script successfully to correct the issue...

The dbupdate package should be repackaged with the fix...not sure if that needs to be a fixpack or just added to the known issues log for the firmware update.

[hvdbdev@dev-vismdb211 dbupdate_10.0.5.0]$ db2 -tvmf /home/hvdbdev/dbupdate_10.0.5.0/config/db2/cluster_config_db2_update_202210191.sql

CREATE OR REPLACE VARIABLE JSON_VAR CHAR(1)

DB20000I The SQL command completed successfully.

SET JSON_VAR = (SELECT ISAM_AUDIT_HANDLERS.IS_JSON FROM ISAM_AUDIT_HANDLERS)

DB20000I The SQL command completed successfully.

ALTER TABLE ISAM_AUDIT_HANDLERS DROP CONSTRAINT IAH_CK4

DB20000I The SQL command completed successfully.

ALTER TABLE ISAM_AUDIT_HANDLERS DROP COLUMN IS_JSON

DB20000I The SQL command completed successfully.

ALTER TABLE ISAM_AUDIT_HANDLERS ADD IS_JSON CHAR(1) DEFAULT 'N' NOT NULL

DB20000I The SQL command completed successfully.

ALTER TABLE ISAM_AUDIT_HANDLERS ADD CONSTRAINT IAH_CK4 CHECK (IS_JSON IN ('Y', 'N'))

DB20000I The SQL command completed successfully.

REORG TABLE ISAM_AUDIT_HANDLERS

DB20000I The REORG command completed successfully.

UPDATE ISAM_AUDIT_HANDLERS SET IS_JSON = JSON_VAR

 Number of rows affected : 1

DB20000I The SQL command completed successfully.

DROP VARIABLE JSON_VAR

DB20000I The SQL command completed successfully.

COMMIT WORK

DB20000I The SQL command completed successfully.",,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ44973,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011821159,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,TRUIST FINANCIAL CORPORATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=OPEN, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-05-04T14:49:05.000+1000"",""stateCount"":1,""state"":""OPEN"",""dataType"":""pullrequest"",""open"":true},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17m0f:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-13 01:23:33.039,,,,,"13/Jan/23 11:23 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 957d249335b72ecb5aa123931aa445fa5c205a34
   * description: ISAMSUP-4707 Update REORG statement

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82716258.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4707) which we publish.",13/Jan/23 11:31 AM;5af4ad7d4dd24c579110120b;Please log an APAR.,"13/Jan/23 12:53 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c1200462ec65863693d8378ff9772e7ea55c7eaa
   * description: Merge pull request #5649 from ISAM/ISAMSUP-4707

ISAMSUP-4707 Update REORG statement

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82718786.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230113025028-c1200462e.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","13/Jan/23 2:15 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c1200462ec65863693d8378ff9772e7ea55c7eaa
   * description: Merge pull request #5649 from ISAM/ISAMSUP-4707

ISAMSUP-4707 Update REORG statement

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82721230.


This build has not been published as the commit is not currently within a branch (20230113025028-c1200462e) which we publish.","16/Jan/23 11:07 AM;5af4ad7d4dd24c579110120b;[~accountid:62fd292b88b05653fa7d4647] 

Please log an APAR.","17/Jan/23 6:40 AM;62fd292b88b05653fa7d4647;[~accountid:5af4ad7d4dd24c579110120b] I created the APAR 

Success to create the APAR in RETAIN.

APAR created successfully with number: IJ44973",17/Jan/23 10:09 AM;5af4ad7d4dd24c579110120b;Fixed and merged. Hence closing Jira.,"04/May/23 12:10 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 765e88d3c0568cce4041c1dab59d411116c6f2cd
   * description: ISAMSUP-4707 Update cluster config update file

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/273258.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4707_v2) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Delete object from objectspace,ISAMSUP-4701,275574,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Joyce.Fernandes,627a85950e2c490069032c59,Joyce.Fernandes,627a85950e2c490069032c59,11/Jan/23 8:49 PM,01/Feb/23 2:09 AM,14/Jul/23 2:47 PM,01/Feb/23 2:09 AM,,,,0,,,,"Customer wants to  delete an object no more used in his  objectspace tree, but when we try to delete it, we get this error: ""HPDMG0611E This operation is not supported for the objects in this object space. (0x14c01263)"". The object we want to delete is not linked to a junction, but it is an endpoint created automatically by ISVA after the configuration of a federation on a WebSEAL. We have removed that federation and we want to clean the objectspace removing also the objects related to that federation (they have remained there, even if the federation is no longer configured on the WebSEAL).

 Command used 
{{pdadmin sec_master> object delete /WebSEAL/intranet/isam/sps/saml20idp-ValueProcess/saml20/auth Could not perform the administration request Error: HPDMG0611E This operation is not supported for the objects in this object space. (status 0x14c01263) }}

want to delete only the object ""/auth"".

 

# What is the object in question that you are attempting to delete?
## *It's an object that has been created after the deploy of a federation on a WebSEAL. (see* *_objects.png_**)*
# What user are you authenticated as?
## *I'm authenticated as sec_master on the policy admin.*
# Does said object show up in the object space under /WebSEAL; when you look via Policy Administration?
## *Yes, the object shows up under /WebSEAL.*
# Do you have a clustered environment ?
## *Yes, we do.*


Reproduced the issue , with same results 

I attempted to remove that object twice. After first attempt i removed the federation and then the junction but no difference nor could i remove the upper objects. I have seen this before in my labs where objects don't get removed automatically as i believe they should. But i recall it been raised before.



{{pdadmin> login -a sec_master Enter Password: pdadmin sec_master> object delete /WebSEAL/intranet/isam/sps/test1/saml20/auth Could not perform the administration request Error: HPDAC0458E The protected object name specified was not found in the authorization policy database. (status 0x1005b1ca) pdadmin sec_master> object delete /WebSEAL/Isva10.0.4-rp1/isam/sps/test1/saml20/auth Could not perform the administration request Error: HPDMG0611E This operation is not supported for the objects in this object space. (status 0x14c01263) pdadmin sec_master> object delete /WebSEAL/Isva10.0.4-rp1/isam/sps/test1/saml20/auth Could not perform the administration request Error: HPDMG0611E This operation is not supported for the objects in this object space. (status 0x14c01263) pdadmin sec_master> object delete /WebSEAL/Isva10.0.4-rp1/isam/sps/test1/saml20/ Could not perform the administration request Error: HPDMG0611E This operation is not supported for the objects in this object space. (status 0x14c01263) pdadmin sec_master> object delete /WebSEAL/Isva10.0.4-rp1/isam/sps/test1/ Could not perform the administration request Error: HPDMG0611E This operation is not supported for the objects in this object space. (status 0x14c01263) pdadmin sec_master> object delete /WebSEAL/Isva10.0.4-rp1/isam/sps/test1 Could not perform the administration request Error: HPDMG0611E This operation is not supported for the objects in this object space. (status 0x14c01263) pdadmin sec_master> object delete /WebSEAL/Isva10.0.4-rp1/isam/sps Could not perform the administration request Error: HPDMG0611E This operation is not supported for the objects in this object space. (status 0x14c01263) pdadmin sec_master> object delete /WebSEAL/Isva10.0.4-rp1/isam Could not perform the administration request Error: HPDMG0611E This operation is not supported for the objects in this object space. (status 0x14c01263) pdadmin sec_master> }}
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011474775,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Joyce.Fernandes,627a85950e2c490069032c59,,,,Matteo Pappadà,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17ka7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-01-12 22:58:18.193,,,,,"13/Jan/23 8:58 AM;5b15d94b6256d01ad54eb020;We’re going to need a support file that includes the webseal instance and the policy server.  

What you are seeing is not a defect with the Policy Server.  The error is because the object is handled by a different service that is part of FIM.  I’d have to look  into how to clean up that object. It should be doable. Send in a support file and we look into it more.",24/Jan/23 10:26 PM;627a85950e2c490069032c59;[~accountid:5b15d94b6256d01ad54eb020]  Please find the link of the support file [https://ecurep.mainz.de.ibm.com/ae5/#id=TS011474775&path=TS011474775%2F2023-01-24%2F&filepath=TS011474775%2F2023-01-24%2Fisva_10.0.3.1_20230124-123151_shq-prx-203.fiditalia.it.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011474775&path=TS011474775%2F2023-01-24%2F&filepath=TS011474775%2F2023-01-24%2Fisva_10.0.3.1_20230124-123151_shq-prx-203.fiditalia.it.support],"25/Jan/23 2:25 AM;5b15d94b6256d01ad54eb020;I was looking for:

 /WebSEAL/intranet/isam/sps/saml20idp-ValueProcess/saml20/auth

There are two references with that name in the object db:

{noformat}First:

START OBJECT
Object type: 1282
Object size: 211
Object name: /auth/acl-map/isam_saml20idp-ValueProcess_isam_anyauth
Object seqnum: 0
ACL to Protected object map:
    ACL is attached at:
        /WebSEAL/extranet/isam/sps/wssoi
        /WebSEAL/extranet/isam/sps/auth
        /WebSEAL/intranet/isam/sps/saml20idp-ValueProcess/saml20/auth
        /WebSEAL/intranet/isam/sps/wssoi
        /WebSEAL/intranet/isam/sps/auth
END OBJECT

Second:

START OBJECT
Object type: 1281
Object size: 54
Object name: /auth/pobject-map/WebSEAL/intranet/isam/sps/saml20idp-ValueProcess/saml20/auth
Object seqnum: 0
Protected object to ACL map:
    Attached ACLs:
        isam_saml20idp-ValueProcess_isam_anyauth
END OBJECT

{noformat}



In that list of pdadmin commands, they attempted to delete several other objects.  Why, if they only want to delete the one.  They need to be careful when doing this.   They also need to be sure they have a backup in case of problems, like deleting the wrong object.

run these two commands and send in the output.

padmind>  acl show isam_saml20idp-ValueProcess_isam_anyauth

pdadmin>   object  show    /WebSEAL/intranet/isam/sps/saml20idp-ValueProcess/saml20/auth



The next thing we want to try since this is an acl that is attached, is to see if we can detach it.

padmin>  acl detach /WebSEAL/intranet/isam/sps/saml20idp-ValueProcess/saml20/auth

Then try the delete again.   

pdadmin>  object  show    /WebSEAL/intranet/isam/sps/saml20idp-ValueProcess/saml20/auth",01/Feb/23 2:09 AM;627a85950e2c490069032c59;[~accountid:5b15d94b6256d01ad54eb020]  It worked  thank you,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
fixpack request for IJ39024 on 10.0.2,ISAMSUP-4697,275336,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,10/Jan/23 2:54 PM,19/Jan/23 4:53 PM,14/Jul/23 2:47 PM,19/Jan/23 4:53 PM,,Support,,0,,,,"The customer would like us to provide fixpack for IJ39024 of 10.0.2.

The customer had applied following two fixpacks:
update_jp_lang_10020
IJ34139_10020

{quote}+ /usr/sbin/mesa_control fixpack_get_history
2022年2月24日木曜日 14:22:04|UPDATE_JP_SJIS_10020|update_jp_sjis_10020|Yes|Installed|This updates the japanes sjis lang files.|1645680124
2022年2月24日木曜日 14:24:02|IJ34139_10020|IJ34139_10020|Yes|Installed|IJ34139 fixes issue where reverse proxy edit replaces / with &#x2F; in various items|1645680242{quote}


I have requested the customer to upgrade to the latest, but the customer does not seem to have much time to evaluate new versions.
This issue was fixed in [https://cloudidentity.atlassian.net/browse/ISAMSUP-3666|https://cloudidentity.atlassian.net/browse/ISAMSUP-3666] .",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4721,,,,,,,,,,,,,,,,,IJ39024,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011734072,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,"TSUKUBA BANK, LTD.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17itz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-01-18 01:01:32.321,,,,,"16/Jan/23 1:21 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b232b2fd85e5b59b066f57f] ,
Is it possible to provide this fixpack? ","18/Jan/23 11:01 AM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9ec6d76184b7d989c83] 

Dave is on leave so taking over this item

I will build the fixpack","19/Jan/23 11:21 AM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9ec6d76184b7d989c83] 

The fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4721|https://cloudidentity.atlassian.net/browse/ISAMSUP-4721|smart-link] 

There were no changes to the felb code in 10.0.2.0 IF1 - so the fixpack can be applied before or after IF1",19/Jan/23 4:53 PM;5b15d9ec6d76184b7d989c83;Thanks! ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Case formatting issue in prometheus /metrics endpoint,ISAMSUP-4695,275166,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,10/Jan/23 1:40 AM,07/Mar/23 3:37 PM,14/Jul/23 2:47 PM,07/Mar/23 3:37 PM,,Support,,0,,,,"Client are trying to set up a monitoring of our appliances with datadog using the /metrics prometheus endpoint.

They are not able to retrieve the data on the datadog end because of an issue related to snake_case vs camelCase, this is the error message given by datadog :

base_classloader_loadedClasses_count metric names should be written in 'snake_case' not 'camelCase'

base_classloader_loadedClasses_count non-histogram and non-summary metrics should not have ""_count"" suffix

base_classloader_loadedClasses_total metric names should be written in 'snake_case' not 'camelCase'

And datadog is not able to scrape the data. Is there a way to force the formatting to snake_case on ISVA side ? 

exposed metrics labels are not compliant with Prometheus naming convention(see [https://prometheus.io/docs/practices/naming/|https://prometheus.io/docs/practices/naming/|smart-link]).

Client is looking for a fix to the ""_count"" suffix issue ?",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS011769129, TS012146651",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,BPIFRANCE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17hrz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-01-11 07:10:46.398,,,,,"11/Jan/23 5:10 PM;5b15d954b0d76456f36daf33;_>> exposed metrics labels are not compliant with Prometheus naming convention … Is there a way to force the formatting to snake_case on ISVA side ?_

The metrics are part of the native MicroProfile feature over which ISAM/ISVA has no control. It is part of the WebSphere Liberty/OpenLiberty. You can see here : [https://openliberty.io/docs/latest/metrics-list.html|https://openliberty.io/docs/latest/metrics-list.html|smart-link]

[~accountid:61409dc154762c006932ffc7] you might want to open a skills case with WebSphere team to ask them if any of these are customizable.","11/Jan/23 7:55 PM;61409dc154762c006932ffc7;[~accountid:5b15d954b0d76456f36daf33]  WebSphere team shared the following documentation:

WebSphere should be at version 9.0.5.9.

[https://www.ibm.com/docs/en/was/9.0.5?topic=mosh-displaying-pmi-metrics-in-prometheus-format-metrics-app|https://www.ibm.com/docs/en/was/9.0.5?topic=mosh-displaying-pmi-metrics-in-prometheus-format-metrics-app|smart-link] ","12/Jan/23 1:38 PM;5b15d954b0d76456f36daf33;We are using Liberty within our appliance. Not the full WebSphere Application Server. Check if any minimum version numbers apply to that too. We are using 22.0.0.9 in our latest version of the appliance.

In any case, we don’t have the ability to map those metrics as of now without deploying this additional application. That’s what you want to tell the customer. ","13/Jan/23 8:51 PM;61409dc154762c006932ffc7;[~accountid:5b15d954b0d76456f36daf33] i dont understand exactly is it not possible to provide fix as we don't have ability to map these metrics?



the client is pushing for a fix or a previsional ETA.",17/Jan/23 7:06 PM;61409dc154762c006932ffc7;[~accountid:5b15d954b0d76456f36daf33]  could you please answer my query below?,"23/Jan/23 9:48 AM;5b15d954b0d76456f36daf33;[~accountid:61409dc154762c006932ffc7] how do we obtain the metrics.app? Is it a third party application or part of WebSphere Liberty?

Have you tried to deploy it in a local environment and test to see if it provides what the customer is asking for?","25/Jan/23 7:02 PM;61409dc154762c006932ffc7;[~accountid:5b15d954b0d76456f36daf33] i did not get the chance to test it as you mentioned previously  we don’t have the ability to map those metrics as of now without deploying this additional application.

So customer is asking if we have any workaround as they are using liberty within  appliance not the full WebSphere Application Server","27/Jan/23 9:42 AM;5b15d954b0d76456f36daf33;The customer will not be able to do anything directly. We will need to give them a fixpack if this metrics.app approach works.

That is what I was asking you to confirm/validate",27/Jan/23 6:12 PM;61409dc154762c006932ffc7;Ok will try and confirm,"15/Feb/23 11:46 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d954b0d76456f36daf33] 

Same client opens case with identical subject
They want  to modify the format of metrics labels provided by the /metrics prometheus endpoint in ISVA. Currently the metrics are in snake_case mixed with camelCase format :

base_classloader_loadedClasses_count

base_classloader_loadedClasses_total

Is there a way to force the formatting to only snake_case on ISVA side ?

For example, the result we expect is : base_classloader_loaded_classes_count

Customer has v10.0.4.0","16/Feb/23 12:30 PM;5b15d954b0d76456f36daf33;[~accountid:627a7fb30d1e73006f7c21cf] if you can work with [~accountid:61409dc154762c006932ffc7] and confirm that either of the things the customer wants are feasible, I can evaluate if it is possible to give it to the customer ","21/Feb/23 10:24 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d954b0d76456f36daf33] 
I am unsure if advanced tuning parameters should be used to set the mapping for what customer is looking for.

Do we need to find out additional information about the customer's wants in this case?","22/Feb/23 9:13 AM;5b15d954b0d76456f36daf33;What you need to do is ask the WebSphere team if what the customer wants can be done. If yes, how is it deployed on a Liberty profile.

Depending on their response, I’ll know what we can do for our product.",07/Mar/23 3:37 PM;5b15d954b0d76456f36daf33;Both cases closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Clarification for implementation of a different kerberos principal per junction,ISAMSUP-4694,275159,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,10/Jan/23 12:24 AM,24/Feb/23 2:30 AM,14/Jul/23 2:47 PM,24/Feb/23 2:18 AM,,,,0,,,,"Hello,



Customer believes that one set up a prinicpal user for each each junction in a reverse proxy according to the following link:

[https://www.ibm.com/docs/en/sva/10.0.4?topic=stanza-kerberos-principal-name|https://www.ibm.com/docs/en/sva/10.0.4?topic=stanza-kerberos-principal-name|smart-link]



Plus this link reinforces that:

[https://www.ibm.com/docs/en/sva/10.0.3?topic=delegation-configuring-webseal-enable-kerberos-single-sign|https://www.ibm.com/docs/en/sva/10.0.3?topic=delegation-configuring-webseal-enable-kerberos-single-sign|smart-link]

I have consulted with L2 and some maintain that it cannot be done? Can you clarify whether such a configuration is possible?",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,BNP PARIBAS PARTNERS FOR INNOVAT,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17hqv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-10 16:45:37.906,,,,,11/Jan/23 2:45 AM;5b15d9e581c3df12acf53c4a;Will update once I check the code…..,"11/Jan/23 4:23 AM;5b15d9e581c3df12acf53c4a;Yes, it is correct, kerberos-principal-name can be configured junction specific as described in the above document link as well as as it is stated in Reverse Proxy Configuration file.",11/Jan/23 7:49 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] So each junction in a reverse proxy can have its own principal name defind in a active directory?,14/Jan/23 12:51 AM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] This isn’t working for the customer. Let me review their settings. I might have to build a lab to move this case forward.,14/Jan/23 3:41 AM;5b15d9e581c3df12acf53c4a;It should work per junction basis and they can provide different principal name as long as kerberos is configured correctly with that principal name.,"18/Jan/23 11:45 PM;614dd566a995ad0073ec0622;[~accountid:5b15d9e581c3df12acf53c4a] 

The customer is using {{kerberos-user-identity}} in each junction stanza which I understand it to be overriding the webseal user in AD? For cross domain purposes? If correct, is this configuration correct? Second question: They have combined all the imported keytabs into a single keytab; any challenges with this?



{noformat}[junction:/IGTLJ03] kerberos-principal-name = HTTP/SVCONED002SEPL150D@ONED.NET.INTRA always-send-kerberos-tokens = true kerberos-service-name = HTTP/i-net2546.dev.resq.be.echonet.net.intra@WARQ.NET.INTRA kerberos-sso-enable = true kerberos-user-identity = attr:iv-user-refog@ONED.NET.INTRA ....

 [junction:/SPCTJ01] kerberos-principal-name = HTTP/SEPL150X@RESNP.SYSNP.SHARED.FORTIS always-send-kerberos-tokens = true kerberos-service-name = HTTP/i-net255-dev.be.fortis.bank@RESNP.SYSNP.SHARED.FORTIS kerberos-sso-enable = true kerberos-user-identity = attr:iv-user-flid@INTNP.SYSNP.SHARED.FORTIS{noformat}","19/Jan/23 2:27 AM;5b15d9e581c3df12acf53c4a;{{kerberos-user-identity}} can be junction specific and since keytabs are not junction specific so it can be combined into a single keytab .

So as far as the Kerberos configuration in AD is good and all should be good from webseal side",24/Feb/23 2:30 AM;614dd566a995ad0073ec0622;PMR closed.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
IdP discovery protocol,ISAMSUP-4682,274443,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Edvan Ponciano,614dd52af1c1740068534813,Edvan Ponciano,614dd52af1c1740068534813,02/Jan/23 2:36 PM,16/Jan/23 11:10 AM,14/Jul/23 2:47 PM,16/Jan/23 11:10 AM,,,,0,,,,"I don't know if we support IdP discovery protocol? I hope I can have some assistance from L3



Below is the customer query


{noformat}Does ISVA support 

<md:Extensions><idpdisc:DiscoveryResponse xmlns:idpdisc=""urn:oasis:names:tc:SAML:profiles:SSO:idp-discovery-protocol"" Binding=""urn:oasis:names:tc:SAML:profiles:SSO:idp-discovery-protocol"" Location=""<location>"" index=""0"" isDefault=""true""></idpdisc:DiscoveryResponse></md:Extensions> 

when working as SP in an idp initiated flow?{noformat}


",,Dermot Daly,khansen,Nick Lloyd,,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011660257,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Edvan Ponciano,614dd52af1c1740068534813,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17dk7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-01-10 02:14:07.395,,,,,07/Jan/23 12:58 AM;614dd52af1c1740068534813;Hi [~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5af4ad7d4dd24c579110120b] . We have this JIRA that has been unassigned for a week. Thanks,"10/Jan/23 12:14 PM;5af4ad7d4dd24c579110120b;[~accountid:614dd52af1c1740068534813] 

ISVA currently does not supported IDP Discovery Protocol.","16/Jan/23 11:10 AM;5af4ad7d4dd24c579110120b;Case closed, hence closing jira.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Vulnerability scan: no access to ISVA OS,ISAMSUP-5205,310289,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,05/Jul/23 12:31 AM,12/Jul/23 8:51 PM,14/Jul/23 2:47 PM,12/Jul/23 8:51 PM,,,,0,,,,"Customer mentioned that their security team would like to get a confirmation as they can’t get access to the OS of ISVA, in scope of vulnerability scans.

They want the documentation or evidence on why they can't access to the OS in any way?

They would like to get a written confirmation from the us that OS access is denied by design or would like to get at least a written confirmation from IBM (an email could be enough, in such case).",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013495806,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,BNP PARIBAS PARTNERS FOR INNOVAT,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1dbj3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-07-04 22:33:55.076,,,,,05/Jul/23 8:33 AM;5ac57757d9a96536d1f0daa9;[~accountid:627a7fb30d1e73006f7c21cf] this is as design. The virtual appliance has always been a locked down deployment. Please feel free to author any email outlining this. ,12/Jul/23 8:51 PM;5ac57757d9a96536d1f0daa9;Case is closed. Setting this Jira item to Done to reflect this status.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unconfigured state after applying 10.0.5.0_IF1.,ISAMSUP-5184,308860,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Motiur Rahman,5b15d9e581c3df12acf53c4a,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,27/Jun/23 5:33 PM,06/Jul/23 7:29 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"The customer has 7 (or more) appliances, and recently applied 10.0.5.0_IF.

Three appliances become unconfigured state.
He was able to restore the env like below:

{quote}We have manually added the interfaces and the default gateway ips. Restored to earlier snapshot that was taken before start of our change and also removed that appliance from cluster and readded. With few troubleshooting steps, we were able to get back the appliance online. It had the IF1 snapshot when the server came online.{quote}

He would like to know why this issue happened before going to later versions.

According to the var/log/messages from support file, I found following error after successfully applied 10.0.5.0_IF1:

{quote}ddvwga01
  Jun 13 22:08:57 mesa_control[20742]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
  Jun 13 22:09:32 mesa_install_fixpack: 10.0.5.0_IF1 install successful
  Jun 13 22:09:32 mesa_control[20742]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful
…
  Jun 13 22:12:11 mesa_control[652]: *Error: Bootstrap from settings failed*{quote}

I can see this message in var/log/messages of all three failed appliance.
But unfortunately, I was not able to find detailed reason for this failure.

Support files are extracted in /ecurep/sf/TS013/328/TS013328091/2023-06-19/k/sup .

{quote}Failed appliance:
ddvwga01
dtvwgr02
dzvwgr0x

No issues:
dtvwgr01
dzvwgr01
dzvwgr04

Maybe faced another issue(so please ignore at this point):
dzvwgr02{quote}


Here is the timestamp when the customer apply IF1 to each appliance:

{quote}--- ddvwga01 ---
  Jun 13 22:08:57 mesa_control[20742]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
  Jun 13 22:09:32 mesa_install_fixpack: 10.0.5.0_IF1 install successful
  Jun 13 22:09:32 mesa_control[20742]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful
--- dtvwgr01 ---
  Jun 13 08:43:44 mesa_control[1397]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
  Jun 13 08:43:56 mesa_install_fixpack: 10.0.5.0_IF1 install successful
  Jun 13 08:43:56 mesa_control[1397]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful
--- dtvwgr02 ---
  Jun 13 22:47:24 mesa_control[28357]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
  Jun 13 22:47:32 mesa_install_fixpack: 10.0.5.0_IF1 install successful
  Jun 13 22:47:32 mesa_control[28357]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful
--- dzvwgr01 ---
  Jun 13 23:36:59 mesa_control[13562]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
  Jun 13 23:37:07 mesa_install_fixpack: 10.0.5.0_IF1 install successful
  Jun 13 23:37:07 mesa_control[13562]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful
--- dzvwgr02 ---
  Jun 16 03:38:06 mesa_control[20808]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
  Jun 16 03:38:14 mesa_install_fixpack: 10.0.5.0_IF1 install successful
  Jun 16 03:38:15 mesa_control[20808]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful
--- dzvwgr03 ---
  Jun 13 23:51:14 mesa_control[1300]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
  Jun 13 23:51:23 mesa_install_fixpack: 10.0.5.0_IF1 install successful
  Jun 13 23:51:23 mesa_control[1300]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful
--- dzvwgr04 ---
  Jun 14 00:17:21 mesa_control[18717]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack
  Jun 14 00:17:32 mesa_install_fixpack: 10.0.5.0_IF1 install successful
  Jun 14 00:17:32 mesa_control[18717]: Fixpack /tmp/fixpacktmpdir/10.0.5.0_IF1.fixpack: install successful{quote}


How can we investigate this issue?
If you need any other information, please let me know.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013328091,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,BENDIGO AND ADELAIDE BANK LTD,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1d2s7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-07-05 21:29:32.546,,,,,"06/Jul/23 7:29 AM;5b15d9e581c3df12acf53c4a;We were working on this issue for a while, L2 and L3 were not able to reproduce the issue at all.

Unfortunately, the area where it is failing, that area of the code does not have any meaningful existing trace points so we were not able to investigate the issue further.

Under the Jira :  [https://cloudidentity.atlassian.net/browse/ISAMSUP-4034|https://cloudidentity.atlassian.net/browse/ISAMSUP-4034|smart-link]

we provided the debug fixpack. ( No code fix but we added bunch of  extra trace points ) so that once installed, if the appliance fails then it will capture more traces which, would lead us to the root cause.

Unfortunately, either Customer did not install or it did not fail with the debug fixpack installed.

In the meantime, we did work with development and have them done the following:

[https://cloudidentity.atlassian.net/browse/ISAMDEV-9588|https://cloudidentity.atlassian.net/browse/ISAMDEV-9588|smart-link] 

i.e. the above Jira item added those missing trace points around the area of the code where possible failure is occurring.

This item is in ISVA 10.0.6.0

Now, if the same issue happens in ISVA 10.0.6.0, hopefully , we will get better messages in /var/log/messages by default ( i.e. without debug.level=2 )

Now, those traces points are not meant to pinpoint the issue but it will take us closure to identifying the root cause and hopefully will lead to the exact solution.



Unfortunately,  backporting the fix is not simple,  hopefully, once of the customer will install ISVA 10.0.6.0 where this issue occurs and we will get some better traces.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Documentation still references 'cgi-bin' which is not usable on the appliance,ISAMSUP-5136,306436,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Motiur Rahman,5b15d9e581c3df12acf53c4a,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,14/Jun/23 4:42 AM,16/Jun/23 7:27 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"The following documentation still exists:

[https://www.ibm.com/docs/en/sva/10.0.5?topic=integration-cgi-programming-support|https://www.ibm.com/docs/en/sva/10.0.5?topic=integration-cgi-programming-support|smart-link] 

We should instead replace it with documentation that states that we no longer support CGI on our appliance since it’s impossible to change file permissions to give a script the 'x' bit needed for CGI to run as expected.",,David Hayes,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013309538,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,IMMIXTECHNOLOGY INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1co1z:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-15 11:37:01.27,,,,,15/Jun/23 9:37 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] hoping that you can take a look at this item and make a quick DOC update as part of our 10.0.7 deliver if its needed. ,"16/Jun/23 7:27 AM;5b15d9e581c3df12acf53c4a;[~accountid:5ac57757d9a96536d1f0daa9] OK, will investigate.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA Compatibility - Windows Server 2022,ISAMSUP-5094,301892,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,25/May/23 1:57 AM,09/Jun/23 1:22 PM,14/Jul/23 2:47 PM,09/Jun/23 1:22 PM,,,,0,,,,"Greetings, We have an ISVA environment currently configured to access an Active Directory instance through a federated directory. This AD is functioning under a Windows Server 2016 service. Our client wants to upgrade Windows Server 2016 to 2022 version. We wanted to know if there's any compatibility issues between ISVA 10.0.4 and Windows Server 2022. Is it going to affect any of our current implementations? 




The compatibility tool won't show compatibility with Windows 2022

!image-20230524-154406.png|width=965,height=261!

[https://www.ibm.com/software/reports/compatibility/clarity-reports/report/html/prereqsForProduct|https://www.ibm.com/software/reports/compatibility/clarity-reports/report/html/prereqsForProduct|smart-link] 

since we just use AD as a ldap server I think it would most likely be fine. 



has any certification work been done yet on Windows 2022?

has L3 any concerns with us telling a customer that we will support them if they try it and have any issues?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25/May/23 1:57 AM;62e437a72fe585febb3c92a5;image-20230524-154406.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202327,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013115919 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,,,,TELEFONICA MOVILES DEL URUGUAY S.A.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Windows Server 20xx,,,,,,,,,,,,,,0|i1bvkn:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-25 12:04:18.731,,,,,25/May/23 10:04 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] can you please take a look at this item and confirm if there are any specific support statements when configuring ISVA to use AD as a  federated directory.,"27/May/23 8:46 AM;5b15d9e581c3df12acf53c4a;OK, will investigate.","31/May/23 12:51 AM;5b15d9e581c3df12acf53c4a;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] 

On the first look, it seems that there will not be a problem and unless otherwise stated, it should work.

Having said above, it need to be certified.

There always could be the fact that Windows 2022 may have introduce a new feature which may or may not require any tweaking in ISVA’s part, so it is always suggested to certify it first from ISVA side.

We need to engage our ISVA Certification Team to certify this configuration.","01/Jun/23 4:53 AM;62e437a72fe585febb3c92a5;Customer update: Since we have this issue on a productive environment we should wait for the tests you mention to be sure it won't cause any negative effect on ISVA.

We don't have an exact ETA but the client asked us to have this on high priority so it would be very nice to maybe have an answer on Friday. 



Thanks again!

[~accountid:5b15d9e581c3df12acf53c4a] Do you think it would be possible to have an update by Friday?","01/Jun/23 5:58 AM;5b15d9e581c3df12acf53c4a;This Certification testing need to be scheduled from ISVA side , I am working on to get it into the Certification schedule.

[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] 

What is the Certification process/procedure now a days? What is that we have to do to get this Windows 2022 on ISVA Certification Schedule.",01/Jun/23 11:21 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] if we need the development team to review this please have an IBM idea created to allow the senior product leadership team to review this. ,"02/Jun/23 4:07 AM;5b15d9e581c3df12acf53c4a;[~accountid:5ac57757d9a96536d1f0daa9] 

Tony, at this point, I think it is more of a certification issue, because, if it is working in Windows 2016, it should work in Windows 2022 also, we just need certification via test team or certification team.","08/Jun/23 12:46 AM;5b15d9e581c3df12acf53c4a;Hi L2

As it turns out, the process of getting issues like this to be certified got changed a bit.

Please go to this link:

[https://ideas.ibm.com/|https://ideas.ibm.com/|smart-link] 

and open a request for “Windows Server 2022” to be certified for usage as a Federated directory for ISVA.

Either L2 or Customer can open/create a ticket.

========================================

Once you login:

Select “Add new idea”

For: Customer

Visible only to IBM

Find Your Product: 
I could not find “ISVA” but “IBM Application Gateway” is their and you can select it

Category: ISVA Integration

Rest is: what exactly needed i.e. describe the issue ….","08/Jun/23 1:12 AM;62e437a72fe585febb3c92a5;The customer just submitted the idea, now is just wait or we have to perform another task? [~accountid:5b15d9e581c3df12acf53c4a] ",09/Jun/23 1:22 PM;5ac57757d9a96536d1f0daa9;[~accountid:62e437a72fe585febb3c92a5] as this is moved to an idea I am closing out this support item. This idea will now be assessed by the ISVA leadership team and confirmed as some that we should consider in a future release or not. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Translation issue french version of IBM Verify,ISAMSUP-5093,301862,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Carsten Hagemann,5af4ad7f39d04955d9e20da6,Surya Prakash,60f541a6d0134900692d91b7,Surya Prakash,60f541a6d0134900692d91b7,24/May/23 10:50 PM,27/Jun/23 4:22 PM,14/Jul/23 2:47 PM,,,Support,02/Jun/23 12:00 AM,0,,,,"Hi Team, The client finds that there is a translation issue in the French version of IBM Verify(mobile App): 
After authentication it is mentionned ""Demande vérifié"" instead of ""Demande vérifiée"" Could you please correct the missing ""e"" ?

Attaching the screenshot for your reference


!Screenshot 2023-05-24 at 13.44.37.png|width=41.66666666666667%!

!Screenshot 2023-05-24 at 13.46.16.png|width=41.66666666666667%!",,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Surya Prakash,,,,,,,,,,,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,60f541a6d0134900692d91b7,,,,,,,,,,,,,,,,,,,,,,,,,CI-121261,CI-121262,,,24/May/23 10:50 PM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-05-24 at 13.44.37.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202298,24/May/23 10:50 PM;ug:1a9a52ac-9fe3-480c-a9fb-ad33fa5531bb;Screenshot 2023-05-24 at 13.46.16.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202297,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013090129,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Surya Prakash,60f541a6d0134900692d91b7,,,,BPIFRANCE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013090129&path=TS013090129%2F2023-05-24%2F&filepath=TS013090129%2F2023-05-24%2FScreenshot_20230524_115257_IBM_Verify_french.jpg,,,,,,,,,,,,,,,,,,,,,,,0|i1bvdr:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-25 12:00:30.777,,,,,"25/May/23 8:51 PM;60f541a6d0134900692d91b7;Mobile Application version is 2.5.11

ISVA is 10.0.4","25/May/23 10:00 PM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7f39d04955d9e20da6] can you please review this item and confirm if you agree that this needs to be fixed. 

[~accountid:60f541a6d0134900692d91b7] can you please confirm if this is reported against the iOS or Android versions of the Verify App?",25/May/23 11:43 PM;5af4ad7f39d04955d9e20da6;[~accountid:5ac57757d9a96536d1f0daa9] I confirm this is an issue in Android and iOS version.,26/May/23 1:26 AM;60f541a6d0134900692d91b7;[~accountid:5ac57757d9a96536d1f0daa9] Yes it is an issue in Android and iOS version,05/Jun/23 8:11 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7f39d04955d9e20da6] do you need any assistance regarding getting this resolved in both the iOS and Andriod IBM Verify apps? ,"05/Jun/23 9:46 AM;5af4ad7f39d04955d9e20da6;[~accountid:5ac57757d9a96536d1f0daa9] The issue is already fixed on both platforms and will be released with the next update,but  there is no ETA for that yet. Given the severity of this item, we are not planning to create release just for this issue.",06/Jun/23 8:35 PM;60f541a6d0134900692d91b7;[~accountid:5af4ad7f39d04955d9e20da6] So I can let the client know it will be fixed in the next update??,06/Jun/23 8:37 PM;5af4ad7f39d04955d9e20da6;[~accountid:60f541a6d0134900692d91b7] Yes.,"06/Jun/23 8:38 PM;60f541a6d0134900692d91b7;[~accountid:5af4ad7f39d04955d9e20da6] thank you for the work, I will update to the client and let you know if we need any other information","06/Jun/23 10:18 PM;60f541a6d0134900692d91b7;[~accountid:5af4ad7f39d04955d9e20da6] The client just asks when we can expect the update, or can we keep the case open until the release?","07/Jun/23 8:36 AM;5af4ad7f39d04955d9e20da6;[~accountid:60f541a6d0134900692d91b7] No ETA at this stage. We just did a release 2 weeks ago and don’t have anything in the queue except this item. Of course, you can keep this open until it’s resolved.",21/Jun/23 12:54 AM;60f541a6d0134900692d91b7;Hi [~accountid:5af4ad7f39d04955d9e20da6] Just wanted to know was this update was released with the new version v10.0.6 ??,22/Jun/23 10:12 AM;5af4ad7f39d04955d9e20da6;[~accountid:60f541a6d0134900692d91b7] This is not a server issue. It has to be fixed in the IBM Security Verify mobile apps.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
EOTP set to four digits with otpHint disabled,ISAMSUP-5082,300421,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,18/May/23 4:37 AM,22/May/23 1:04 PM,14/Jul/23 2:47 PM,22/May/23 1:04 PM,,,,0,,,,"The customer has modified the otpDeliver js to ignore otpHint and they believe to reduce the otp sent to client to four digits in the below script. I have advised that they have only removed the otp hint.  This link: [https://www.ibm.com/docs/en/sva/10.0.4?topic=authentication-configuring-mac-one-time-password-mechanism|https://www.ibm.com/docs/en/sva/10.0.4?topic=authentication-configuring-mac-one-time-password-mechanism|smart-link]  only modifies the otp to 6,7,8 or 9. I believe what they are asking cannot be done at least not without a rfe as the otp is fixed in the script at least to the class in question?



{noformat}// OTPDeliver mapping rule.

importClass(Packages.com.tivoli.am.fim.trustserver.sts.uuser.Attribute);

// Get the STS Universal User context attributes.

var stsuuCtxAttrs = stsuu.getContextAttributesAttributeContainer();

// Get the OTP type selected by the user.

var otpType = stsuuCtxAttrs.getAttributeValueByNameAndType(""otp.sts.otp-method.otp-type"", ""otp.sts.type"");

// If the OTP type is mac_otp, then generate the OTP hint and the formatted OTP. Other OTP types, such as hotp_otp, hotp_otp,
// and rsa_otp, do not deliver the OTP to the user.

if (otpType.equals(""mac_otp"")) {
    // Get the OTP generated by the OTP Provider plug-in.

    var otp = stsuuCtxAttrs.getAttributeValueByNameAndType(""otp.sts.otp"", ""otp.sts.type"");

    // Generate the OTP hint. OTP hint is data used to inform the user the OTP that the user must submit. OTP hint is sent to
    // the user together with the OTP as formatted OTP. OTP hint is displayed in OTP Login page.

    // var otpHint = Math.floor(1000 + (99 * 9));
var otpHint = (1000 + 99 * 9);

    // Generate the formatted OTP. Formatted OTP is sent to the user.

    var otpFormatted = otp;

    // Set the OTP hint into STS Universal User context attributes.

    var ctxOTPHint = new Attribute(""otp.sts.otp-hint"", ""otp.sts.type"", otpHint);
    stsuuCtxAttrs.setAttribute(ctxOTPHint);

    // Set the formatted OTP into STS Universal User context attributes.

    var ctxOTPFormatted = new Attribute(""otp.sts.otp-formatted"", ""otp.sts.type"", otpFormatted);
    stsuuCtxAttrs.setAttribute(ctxOTPFormatted);
} {noformat}",,David Flynn,Dermot Daly,khansen,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,,,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012763339,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,INFORMATION & EGOVERNMENT AUTHORITY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bmn3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-18 16:32:28.357,,,,,"19/May/23 2:32 AM;5b15d94b6256d01ad54eb020;As you mentioned in the description,  the properties form only allows a length of 6,7,8 or 9.  That’s why you are getting a 6 digit password.   

I don’t believe this is a defect so you would probably need an rfe to change that.",19/May/23 2:32 AM;5b15d94b6256d01ad54eb020;Changing severity to 4  to  match case.,19/May/23 7:35 PM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] Could you confirm explicitly that it is a rfe and we can proceed to closure.,19/May/23 11:56 PM;5b15d94b6256d01ad54eb020;[~accountid:614dd566a995ad0073ec0622] yes this is an RFE.     Remember that an RFE is not guaranteed to be approved . You should set customer expectations  appropriately.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA - rconfig package CVE-2019-16662,ISAMSUP-4974,294499,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,14/Apr/23 12:48 AM,09/May/23 9:49 PM,14/Jul/23 2:47 PM,09/May/23 9:49 PM,,,,0,,,,"Hello Team,

The customer said they have incident which stated the webseal servers were attacked and webseal captured logs - get request to exploit CVE-2019-16662. 

Just see the vulnerability ID. It is year 2019 item. After I checked it in NIST. It said ""An attacker can directly execute system commands by sending a GET request to ajaxServerSettingsChk.php because the rootUname parameter is passed to the exec function without filtering, which can lead to command execution."" 

Does our newer version tools contain the *ajaxServerSettingsChk.php*? 

Do we use/installed *rconfig* on the appliance?

Please advise",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012723035,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,Tata Consultancy Service,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1amov:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-13 20:27:44.35,,,,,14/Apr/23 6:27 AM;5b15d94b6256d01ad54eb020;No we don’t have either of those on the appliance and I don’t think we ever did.  It sounds like somebody tried to find out.,15/Apr/23 2:20 AM;5b15d8fd6e93913e31e279fb;I have searched the code and we do not ship the rConfig package with our product and have also searched for any calls to ajaxServerSettingsChk.php and there are none in our code or in any of the binaries that we ship or build with.  ,"15/Apr/23 7:29 AM;6092aca0f0db130069d19687;Thanks [~accountid:5b15d8fd6e93913e31e279fb] and  [~accountid:5b15d94b6256d01ad54eb020] 👍  

I will let the customer know it.",09/May/23 9:49 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
The customer collected materials for ISAMSUP-4447,ISAMSUP-4962,292750,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Kenji Seta,5b209ff1a56d9112a2a6f638,Kenji Seta,5b209ff1a56d9112a2a6f638,07/Apr/23 6:16 PM,27/Apr/23 9:09 AM,14/Jul/23 2:47 PM,27/Apr/23 9:07 AM,,,,0,,,,"Hi team,

The customer finally collected requested materials for [https://cloudidentity.atlassian.net/browse/ISAMSUP-4447|https://cloudidentity.atlassian.net/browse/ISAMSUP-4447|smart-link].

They installed pdweb.snoop fixpack 10-0-1-0-GA_IJ41346_IJ43704.fixpack and recreated the issue.

WebSEAL sent close_notify 4 times. Following are packet no. in pcapng file 

{noformat}34482	20:46:14.076 (port 26614)	GET /pics/hondalogo.gif
34529	20:46:14.163	close_notify

39661	20:46:24.700 (port 26625)	GET /pics/hondalogo.gif
39824	20:46:25.001	close_notify

61003	20:47:05.147 (port 26677)  	GET /183
61593	20:47:06.152 	HTTP/1.1
61614	20:47:06.189 	GET /185
61681	20:47:06.323	close_notify

60320	20:47:03.707 (port 26678)	GET /181
61661	20:47:06.296 	HTTP/1.1
61665	20:47:06.309 	GET /186
61771	20:47:06.501	close_notify{noformat}



Unfortunately, 10-0-1-0-GA_IJ41346_IJ43704.fixpack has a webseal crash bug ([https://cloudidentity.atlassian.net/browse/ISAMSUP-4776|https://cloudidentity.atlassian.net/browse/ISAMSUP-4776|smart-link] ).

The customer’s webseald was crashed at 20:47:24.

*In msg__webseald-default.log*

2023-03-28-20:47:26.298+09:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 654 0x7fdc9252e700 -- WGAWA0034E   ???? /opt/pdweb/bin/webseald ????? 11 ????????????  ????????????????? -- IBM Security Verify Access WebSEAL Version 10.0.1.0 (Build 20201125_1048) -- Copyright (C) IBM Corporation 1994-2020.  All Rights Reserved.

*In /var/log/messages*

Mar 28 20:47:24 mesa_crashd[897]: Error: CRASH: program=webseald-default pid=22165 reason=""address not mapped to object"" signal=11 code=1 addr=(nil) stack='0x7f19ff7d495c 0x7f19fced40a0 0x7f19ff747579 0x7f19ff7478fd 0x7f19fceccd65 0x7f19fc3dc2cd ' regs='0x2a22da0 0x1 0x6e6f4373577e3a3a 0x206 0x0 0x7f19ffab1340 0x0 0x7f19ffab18e0 0x7f19bfded910 0x1 0x0 0x5262650 0x8 0x9 0x2a22990 0x7f19bfded8a0 0x7f19ff747579 0x10202 0x33 0x4 0xe 0x5007 0x0 '

*In core_webseald.22164.stack*
Core was generated by `/opt/pdweb/bin/webseald -config etc/webseald-default.conf -foreground -noenv'.
Program terminated with signal 11, Segmentation fault.
#0  0x00007f19ff747579 in WsWorker::waitOnConnections() () from /usr/lib64/libwsdaemon.so

…skip…

Thread 1 (Thread 0x7f19bfdef700 (LWP 22300)):
#0  0x00007f19ff747579 in WsWorker::waitOnConnections() () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#1  0x00007f19ff7478fd in WsPersistentPoolThread () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#2  0x00007f19fceccd65 in start_thread () from /lib64/libpthread.so.0
No symbol table info available.
#3  0x00007f19fc3dc2cd in clone () from /lib64/libc.so.6
No symbol table info available.",,khansen,Nick Lloyd,prashant_kamat,Tushar Prasad,William Hannon Jr,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,5b17571b91981f4fdde632c1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012490971,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Kenji Seta,5b209ff1a56d9112a2a6f638,,,,"HONDA MOTOR CO., LTD.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,/ecurep/sf/TS012/490/TS012490971/2023-03-28/Case1_20230328.zip,,,,,,,,,,,,,,,,,,,,,,,0|i1abwv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-04-07 14:37:51.702,,,,,"07/Apr/23 6:20 PM;5b209ff1a56d9112a2a6f638;We had provided 2 solutions to the customer. But, the one has side problem [https://cloudidentity.atlassian.net/browse/ISAMSUP-4931|https://cloudidentity.atlassian.net/browse/ISAMSUP-4931|smart-link] ","08/Apr/23 12:37 AM;5b17571b91981f4fdde632c1;Please note there are valid reasons why WebSEAL cannot allow the socket to persist, which cannot be changed.

Did you set [server] max-idle-persistent-connections = 0?

Once you turn that on that configuration HTTP-Response will send HTTP Connection: Close header which the client must honor, then close the connection … the Close_notify will still appear but the client should not reuse the connection.  The Close_notify must be ignored then.

If the client pipeline another request before response they should redrive.","10/Apr/23 6:32 PM;5b209ff1a56d9112a2a6f638;Hi Bill,

In my memory, you had requested customer’s trace to check if L2’s recreation was same issue as customer’s one. 

We already provided two solutions. (Unfortunately, one of solutions - close_notify with warning alert - has side problem) So, i think we need not provide other solutions until customer will complete verification test and both solutions fail.

It will be great help for customer’s understanding if we can explain why GSKit sends close_notify before timeout only on TLSv1.3. ","11/Apr/23 4:00 AM;5b17571b91981f4fdde632c1;{quote}It will be great help for customer’s understanding if we can explain why GSKit sends close_notify before timeout only on TLSv1.3.{quote}

Answered before: Suggest searching all JIRA’s for strict-ssl-sessions","11/Apr/23 4:36 PM;5b209ff1a56d9112a2a6f638;I found one your update which points strict-ssl-sessions parameter.

* This is the *root cause* L2 recreate why ISVA was closing the socket
** TLS1.3 changes the behavior where we start using GSKit’s Session Cache
** The session in GSKit Session cache was removed which was detected
** With [ssl] strict-ssl-sessions = true, the removal of GSKit Session ID cache ISVA closes the socket (close notify)
** With [ssl] strict-ssl-sessions = false, the test is not done and the WebSEAL front-end socket remains persistent (no close notify)

Do you mean strict-ssl-sessions=true (default) should not be set with TLSv1.3?

Even though browser redrives request, the unexpected session close makes duplicated network transaction. It is not good behavior.","11/Apr/23 8:09 PM;5b17571b91981f4fdde632c1;{quote}Do you mean strict-ssl-sessions=true (default) should not be set with TLSv1.3?{quote}

It is a configuration setting, so the customer can choose.

The default when the user logs out is to destroy the session id and close the connection to prevent reuse for better security. 

{quote}Even though browser redrives request, the unexpected session close makes duplicated network transaction. It is not good behavior.{quote}

Please review all historical HTTP RFC standards for asynchronous closure, this behavior is allowed and expected per the HTTP RFC standards.

Your belief does not match the HTTP RFC standards.

----",25/Apr/23 2:12 AM;5b17571b91981f4fdde632c1;* What is the status?,"25/Apr/23 5:03 PM;5b209ff1a56d9112a2a6f638;Hi Bill, could you please close this ticket?

I reported customer that there is no additional issues on collected trace and need to set strict-ssl-sessions=false on TLSv1.3 and Edge/Chronium browser combination. 

Customer faced other issue on the test with strict-ssl-sessions=false. But, that should be handled by other Jira ticket. (I am still investigating the issue)","27/Apr/23 9:09 AM;5b17571b91981f4fdde632c1;* If the problem another variation of WebSEAL front-end persistent closure
** PLEASE remember HTTP standard allows connections to be closed and then the client should handle",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Infomap context incorrect attribute value returned for auth svc credential,ISAMSUP-4955,292473,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,06/Apr/23 1:52 AM,12/Apr/23 6:15 PM,14/Jul/23 2:47 PM,12/Apr/23 6:15 PM,,,,0,,,,"Customer reported a bug in the Infomap context attribute for ""Authentication Service credential"" attribute type.

As per documentation ([https://www.ibm.com/docs/en/sva/10.0.4?topic=policies-authentication-policy-parameters-credentials#authpolicyprops|https://www.ibm.com/docs/en/sva/10.0.4?topic=policies-authentication-policy-parameters-credentials#authpolicyprops|smart-link] )
it states the following:

Namespace:

* urn:ibm:security:asf:response:token:attribute (1)
--> Retrieves the first value.
* urn:ibm:security:asf:response:token:attributes (2)
--> Retrieves all the values.



In practice, the two namespaces are inverted, meaning that the singular namespace (1) returns a Java Array, instead of a Java String, while plural namespace (2) returns a single Java String instead of an Array.

The documentation on this regard is correct, and is aligned with the logic of all the other attribute types. But it seems that the the logic between the two namespaces are inverted in the underlying java library.

Looking at our internal code history and implementation, I can confidently confirm that this bug was already there in ISAM 9 version, probably going even older than that. So it's not a problem specific on our side and fixpacks.

Infomap snippet:

let operation = String(context.get(Scope.REQUEST, ""urn:ibm:security:asf:request:parameter"",
""operation"")).toLowerCase();

if (operation === 'create'){context.set(Scope.SESSION, ""urn:ibm:security:asf:response:token:attributes"", ""customAttr"", ""value"");
success.setValue(true);
} else if (operation === 'get'){
 // With Singular
let single = context.get(Scope.SESSION, 'urn:ibm:security:asf:response:token:attribute', 'customAttr');
IDMappingExtUtils.traceString('Single: ' + single, [java.util.logging.Level.INFO|https://java.util.logging.level.info/]); // Prints:[Ljava.lang.String;@f4c67e5f
IDMappingExtUtils.traceString('Single[0]: ' + single[0], [java.util.logging.Level.INFO|https://java.util.logging.level.info/]); // Prints: value

 // With Plural
let plu = context.get(Scope.SESSION, 'urn:ibm:security:asf:response:token:attributes', 'customAttr');
IDMappingExtUtils.traceString('Plu: ' + plu, [java.util.logging.Level.INFO|https://java.util.logging.level.info/]); // Prints: value
}


Reproduction:

# Invoke the above infomap with GET {infomap}?operation=create - It will create the session with custom
attribute
# Invoke again with created session: GET {infomap}?operation=get

Below are the logs produced by the ""get"" call which highlight the problem,

Trace log:
[3/23/23, 10:12:38:305 CET] 0000233b id=00000000
om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY INFO

[3/23/23, 10:12:38:305 CET] 0000233b id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils I traceString Single: [Ljava.lang.String;@4c47e274

[3/23/23, 10:12:38:305 CET] 0000233b id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils < traceString RETURN

[3/23/23, 10:12:38:305 CET] 0000233b id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY INFO

[3/23/23, 10:12:38:305 CET] 0000233b id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils I traceString Single[0]: value

[3/23/23, 10:12:38:305 CET] 0000233b id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils < traceString RETURN

[3/23/23, 10:12:38:305 CET] 0000233b id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY INFO

[3/23/23, 10:12:38:305 CET] 0000233b id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils I traceString Plu: value

[3/23/23, 10:12:38:305 CET] 0000233b id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils < traceString RETURN",,Alan Wong,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,6092aca0f0db130069d19687,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012525306,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,Account BNP PARIBAS PARTNERS FOR INNOVAT,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1aa73:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-06 04:55:57.692,,,,,"06/Apr/23 2:55 PM;5af4ad7d4dd24c579110120b;<Notes>


Infomap -

{noformat}
context.set(Scope.SESSION, ""urn:ibm:security:asf:response:token:attributes"", ""customAttr"", ""value"");
let single = context.get(Scope.SESSION, 'urn:ibm:security:asf:response:token:attribute', 'customAttr');
let plural = context.get(Scope.SESSION, 'urn:ibm:security:asf:response:token:attributes', 'customAttr');{noformat}

{noformat}IDMappingExtUtils.traceString('ASHA00 Single: ' + single); ---> ASHA00 Single: [Ljava.lang.String;@765b2bd7
IDMappingExtUtils.traceString('ASHA00 Single[0]: ' + single[0]); --> ASHA00 Single[0]: value
IDMappingExtUtils.traceString('ASHA00 plural: ' + plural); -->  ASHA00 plural: value{noformat}

{noformat}urn:ibm:security:asf:response:token:attribute --> returns a String Array
urn:ibm:security:asf:response:token:attributes --> returns a String{noformat}


Classes to look in-
ResponseTokenAttributesContextStore 
ResponseTokenAttributeContextStore

AuthSvcClientContext
AuthSvcDelegateContext

Etc..","07/Apr/23 6:26 PM;627a7fb30d1e73006f7c21cf;[~accountid:5af4ad7d4dd24c579110120b] 

Customer shared additional details:

Customer found some information on the online documentation for 10.0.5 in section:
Critical changes in this release

----

Response token attributes in InfoMap

When response token attributes are used in an InfoMap by way of context variables, the plural namespace urn:ibm:security:asf:response:token:attributes incorrectly returns and updates a singular value. The singular namespace urn:ibm:security:asf:response:token:attribute incorrectly returns and updates a string array. The set function now accepts a string or a string array for either namespace, and correctly updates the value based on the object that was passed in. However, to prevent compatibility issues with earlier versions, the get function was not modified.","11/Apr/23 8:40 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:627a7fb30d1e73006f7c21cf] 

Yes as rightly identified it is a known limitation and documented.
The reason also mentions that due to backward compatibility issues decision has been made not to change the way they behave currently.

So are we good to close this? ",12/Apr/23 6:15 PM;5af4ad7d4dd24c579110120b;case closed.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Runtime SMTP server connection in LMI shows tuning fields that are not used.,ISAMSUP-4920,290136,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,25/Mar/23 1:40 AM,19/Apr/23 7:53 AM,14/Jul/23 2:47 PM,19/Apr/23 7:53 AM,10.0.6,,,0,,,,"When accessing /mga/server_connections and adding a new connection of type SMTP the tuning tab shows three options:

|Connection timeout (seconds):| |
|Max idle time (seconds):| |
|Max pool size:| |



However only the connection timeout is retained.   Any value set for Max idle time or pool size is not show if you edit or list the connection again. 

src/appliance/app-core/jmi/mga/src/com/ibm/isam/mga/server_connections/ServerConnections.java

Only defines 

 Tuple((Class)SmtpConnectionManagerProperties.class,

              Array(""connectTimeout"")),



Also the RAPI documentation for runtimeServerConnectionManagerSMTPProperties

only lists connectTimeout



If the idle and pool are used please fix the code to store and retrieve the properties, if not please remove them from the LMI.



Please let me know if I have permission to open an APAR for this. 

[~accountid:5ac577577331be74a80d5ab4] 



I’ve tested this in 10.0.5 but the customer reported it in 10.0.1.0



[https://community.ibm.com/community/user/security/discussion/smtp-server-connection-tunings|https://community.ibm.com/community/user/security/discussion/smtp-server-connection-tunings|smart-link] ",,Annelise Quap,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,5b15d950d9936c61022057fe,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ46211,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012540430,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,INTACT CORPORATION FINANCERE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-04-19T02:21:33.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19vzr:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,ISVA 10.0.2.0,ISVA 10.0.3.0,ISVA 10.0.3.1,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,2023-03-27 17:48:24.917,,,,,"28/Mar/23 3:48 AM;5b15d9e581c3df12acf53c4a;I will investigate to see what went missing here, seems like LMI and coding is not in sync,…..",29/Mar/23 9:11 AM;5ac577577331be74a80d5ab4;[~accountid:5b15d950d9936c61022057fe] I have validated that this is an issue and was able to reproduce in my environment.  Please create an APAR so that a fix for the issue can be made.  Thanks.,30/Mar/23 4:04 AM;5b15d950d9936c61022057fe;Created APAR IJ46211,"11/Apr/23 6:01 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 4f6396e69f38b5bf67907bda5451b71005224dd4
   * description: ISAMSUP-4920 Add missing idleTimeOut and maxPoolSize field for ServerConnection

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85978.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4920) which we publish.","15/Apr/23 3:35 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a5d9bbc32045badfd4383c86fb214a287190d3f9
   * description: ISAMSUP-4920 Remove idleTimeout and poolMasSize addtributes for SMTP Connections

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/100829.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4920) which we publish.","15/Apr/23 3:48 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a5d9bbc32045badfd4383c86fb214a287190d3f9
   * description: ISAMSUP-4920 Remove idleTimeout and poolMasSize addtributes for SMTP Connections

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/100829.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4920) which we publish.","19/Apr/23 2:21 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 28d89869aeac34942919a7bb18f128268f16eb56
   * description: Merge pull request #5818 from ISAM/ISAMSUP-4920

ISAMSUP-4920 Add missing idleTimeOut and maxPoolSize field for SMTP Server…

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/114260.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230418161812-28d89869.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","19/Apr/23 3:29 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 28d89869aeac34942919a7bb18f128268f16eb56
   * description: Merge pull request #5818 from ISAM/ISAMSUP-4920

ISAMSUP-4920 Add missing idleTimeOut and maxPoolSize field for SMTP Server…

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/114799.


This build has not been published as the commit is not currently within a branch (20230418161812-28d89869) which we publish.","19/Apr/23 7:53 AM;5b15d9e581c3df12acf53c4a;APAR will be included in ISVA 10.0.6.0

After consulting with Dev, These two extra unneeded attribute i.e. maxPoolSize and idleTimeout are removed, so in 10.0.6.0, LMI will ONLY ask for connection Timeout.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
SLO problem between ISV and ISVA,ISAMSUP-4915,289789,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Motiur Rahman,5b15d9e581c3df12acf53c4a,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,23/Mar/23 9:25 PM,31/May/23 11:43 PM,14/Jul/23 2:47 PM,,,,,0,,,,"ISV tenant is [finsadev.ice.ibmcloud.com|https://finsadev.ice.ibmcloud.com/] and ISVA version is 10.0.4. Hy, i've been working on the implementation of slo between ISVA and ISV. Apparently its everithing okay, but wen i call the slo url, in this case [https://finsadev.ice.ibmcloud.com/saml/sps/saml20sp/saml20/sloinitial|https://finsadev.ice.ibmcloud.com/saml/sps/saml20sp/saml20/sloinitial]. I have a confirmation logout of both systems, ISV and ISVA, but i still loged on. The problem is with the PD-S-SESSION-ID, if i remove it manually i have my session closed. Noticed that in our ISVA enviorement we use PD-H-SESSION-ID. I checked de DSC on ISVA and it works properly. I'm testing on a PHP application using an IAG gateway connected with our ISV envoirment. 
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012526086,Development,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,,,,,,Other,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19tv3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,TS012526086,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-23 11:28:14.06,,,,,"23/Mar/23 9:28 PM;5ad60ece34f1e62b1ac926c2;*INTERNAL*

It sounds like they are saying the ISVA session is not being revoked. I think this needs to be routed to the ISVA team.","23/Mar/23 11:01 PM;617a5f2cf485cd0068cb98af;Customer upload the .HAR file 

/ecurep/sf/TS012/526/TS012526086/2023-03-23/dxilodim.finsa.com.har

Not able to see any error on the isamdev.finsa.com","24/Mar/23 12:51 AM;5af99299ae1b5f08256340f1;based on [~accountid:5ad60ece34f1e62b1ac926c2] update, I moved this Jira to ISAMSUP- project

If it turns out that it’s ISV, ISVA L3 can move it back to ISVCASE- project or they can contact me.

Also slacking [~accountid:5b15d94b6256d01ad54eb020] to make sure this ticket gets handled","24/Mar/23 12:56 AM;5b15d94b6256d01ad54eb020;[~accountid:5af99299ae1b5f08256340f1] what is the severity and priority on this?

[~accountid:617a5f2cf485cd0068cb98af]  same question?","24/Mar/23 12:59 AM;5af0530f9abb77267ba6b21c;*INTERNAL*

From the HAR, cookie {{""PD-S-SESSION-ID""}} was generated after accessing ISVA ep below, the ep URL looks not a SAML login ep, this should be routed to ISVA support team.

{noformat}""url"": ""https://dxilodim.finsa.com/pkmsoidc?code=DEko34agb4o0dZLGY5DpavhzI2VnyW&grant_id=3eadc130-b4fa-48c3-845f-b427595ff722&state=917485c5-e144-55d1-8066-3d97e811da0a"",
{noformat}

{noformat}          ""cookies"": [
            {
              ""name"": ""PD-S-SESSION-ID"",
              ""value"": ""1_2_1_kfn4374VW36ciRU5mhfgCDFoXT--C54w2QBulJxcXrTE+Oor"",
              ""path"": ""/"",
              ""domain"": ""dxilodim.finsa.com"",
              ""expires"": null,
              ""httpOnly"": true,
              ""secure"": true
            }
          ],{noformat}","24/Mar/23 1:40 AM;5b15d94b6256d01ad54eb020;We need more information on this issue.    Can you give us a short description of the flow?   Why are you expecting the session to be revoked?   Which webseal instances are involved?

 ","24/Mar/23 1:49 AM;5b15d94b6256d01ad54eb020;Case viewer says this is a sev 4.  We probably won’t do much on that today,",24/Mar/23 3:40 AM;5af99299ae1b5f08256340f1;sorry.  I went to find out what the SF ticket sev was… you beat me to it.  Sev 4… hmmm..,"28/Mar/23 3:45 AM;5b15d9e581c3df12acf53c4a;Yup, it will be little low priority, but do provide as much information as you can as requested before.","12/Apr/23 12:30 AM;5b15d901fa615349cb01778b;[~accountid:617a5f2cf485cd0068cb98af] - Syed, this is no case number in this jira.  What is the status of this issue and please provide all the needed information.   Thanks",12/Apr/23 12:33 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d901fa615349cb01778b] My apologies I put the case number. Thx ,"12/Apr/23 2:37 AM;5b15d9e581c3df12acf53c4a;Please answer the question asked on March 23 i.e.



We need more information on this issue. Can you give us a short description of the flow? Why are you expecting the session to be revoked? Which webseal instances are involved?","19/Apr/23 1:48 AM;5b15d9e581c3df12acf53c4a;Two things we will need to move the issue forward:

a) Described the issue in details so that we can understand what is going on and what is the customer’s expectation is and flow of the issue i.e. what exactly they are doing, what they are executing.

b) Provide full traces, not just component traces but full. “pdweb” traces.

By LMI, select the webseal instance and set tracing for “pdweb” , this will capture full trace, provide trace file size to be like 20MB so that everything can be collected in on single file.

c) Provide the action performed to recreate and timestamp so that we can trace the trace file.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Runtime Audit on Sources of RSyslog forwarder,ISAMSUP-4912,289700,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Kenji Seta,5b209ff1a56d9112a2a6f638,Kenji Seta,5b209ff1a56d9112a2a6f638,23/Mar/23 4:27 PM,28/Apr/23 2:07 PM,14/Jul/23 2:47 PM,11/Apr/23 8:24 AM,10.0.6,,,0,,,,"On 10.0.5, there is “Runtime Audit” in the Name dropdown listbox on Sources page of Remote Syslog Forwarder configuration.

What file will be forwarded with this?

When I added this as source, following entry is generated in /var/rsyslog.forwarder/server_1/rsyslog.conf.

{noformat}#### Monitoring Rule: 7 ####
input (type=""imfile""
File=""/opt/ibm/wlp/usr/servers/runtime/logs/audit.log""
Tag=""rau""
Facility=""local0""
Severity=""info""
deleteStateOnFileDelete=""on""
reopenOnTruncate=""on""
readMode=""0""
PersistStateInterval=""0""{noformat}

However, I have not seen {{/opt/ibm/wlp/usr/servers/runtime/logs/audit.log}}.

How can I enable this file?



The similar audit log - AAC/Federation Audit Log configured on Monitor > Audit Configuration page is generated under following location.

      /var/mga/audit/audit.log

and symbolic linked to

      /var/application.logs/{access_control|federation}/auditting/audit.log",,khansen,Nick Lloyd,prashant_kamat,Tushar Prasad,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5032,,,,,,,,,,,,,,,,,,,,,IJ46190,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012523331,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Kenji Seta,5b209ff1a56d9112a2a6f638,,,,"SECOM TRUST SYSTEMS CO., LTD.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=2}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":2,""lastUpdated"":""2023-04-06T10:48:11.000+1000"",""stateCount"":2,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":2,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19tbb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-27 01:24:46.871,,,,,"27/Mar/23 11:24 AM;5b15d954b0d76456f36daf33;[~accountid:5b209ff1a56d9112a2a6f638] you are right. The audit log location is {{/var/mga/audit}} rather than {{/opt/ibm/wlp/usr/servers/runtime/logs}}

We should fix it in the Rsyslog Forwarder to represent the correct path. Can you please open an APAR?","29/Mar/23 12:16 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: da788c6c4a4804b1ffacaa0bbbd3e4c4b1b3cfd6
   * description: ISAMSUP-4912 Runtime audit log path for rsyslog

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87675893.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4912) which we publish.","29/Mar/23 1:22 PM;5b209ff1a56d9112a2a6f638;Thank you for your quick analysis. I created an APAR IJ46190 with following title.

* Runtime Audit on Sources of Remote Syslog forwarder is not working

Best regards,

Kenji","03/Apr/23 10:44 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a9dea32f8f3d26108d5ab0adb33a54217e135c92
   * description: ISAMSUP-4912 Runtime audit log path for rsyslog (#5785)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/73365.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230403004123-a9dea32f.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","03/Apr/23 4:51 PM;5b15d954b0d76456f36daf33;[~accountid:5b209ff1a56d9112a2a6f638] is the customer looking for a personal fix? 

The changes are approved and will be available from the next release.","03/Apr/23 5:04 PM;5b209ff1a56d9112a2a6f638;Hi Bhavan, thank you for your update. I am asking to the customer.","10/Apr/23 10:17 AM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b15d954b0d76456f36daf33] I have not got response from the customer. I think customer does not need personal fixpack. Please close this ticket.

Thank you for your help.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Missing documentation for '[server] rate-limiting-max-buckets' entry,ISAMSUP-4709,276017,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwijono,5b15dbfa4d941a51f0da44dd,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,14/Jan/23 5:26 AM,04/Apr/23 9:49 PM,14/Jul/23 2:47 PM,28/Mar/23 10:56 AM,,Support,,0,,,,"The following rate limiting documentation references the ‘max-rate-limiting-buckets’ entry in the ‘[server]’ stanza but it’s not included in the ‘server’ stanza documentation.

Rate limiting doc: [https://www.ibm.com/docs/en/sva/10.0.5?topic=limiting-rate-policy-files|https://www.ibm.com/docs/en/sva/10.0.5?topic=limiting-rate-policy-files|smart-link] 

Server stanza: [https://www.ibm.com/docs/en/sva/10.0.5?topic=reference-server-stanza|https://www.ibm.com/docs/en/sva/10.0.5?topic=reference-server-stanza|smart-link] 

This page is necessary to describe that entry.",,David Hayes,jcyarbor,Joseph Fitterer,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5af054597dd1e556227c18c8,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ45532,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011720342,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,ISVA L2 Support Team,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17msv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.0,ISVA 10.0.3.1,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,2023-02-21 10:33:08.961,,,,,"14/Jan/23 5:30 AM;5bac25aaabfcbf73d13e733b;I had to send what was in the configuration file:

{noformat}# Ratelimiting: The number of unique request buckets to hold on to. When a
# request is tokenized, it gets a bucket assigned. If this limit is reached,
# rate limiting information about the oldest requests will be ejected. This
# effectively resets the rate limiting counters for this client/s.
#
# This number needs to be higher than the number of requests being rate limited
# across a refresh interval.
max-ratelimiting-buckets = 16384{noformat}

This doesn’t define a maximum value or describe the effect on Reverse Proxy memory usage.",21/Feb/23 8:33 PM;5b232b2fd85e5b59b066f57f;@jwijono - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,22/Feb/23 4:41 AM;5b15dbfa4d941a51f0da44dd;[~accountid:5bac25aaabfcbf73d13e733b] Please open doc apar,22/Feb/23 4:56 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15dbfa4d941a51f0da44dd] APAR IJ45532 has been created for this issue.,"24/Feb/23 7:48 AM;5b15dbfa4d941a51f0da44dd;[~accountid:5af054597dd1e556227c18c8] We need to create a new page here:

[https://ibmdocs-test.dcs.ibm.com/docs/en/sva/10.0.6?topic=reference-server-stanza|https://ibmdocs-test.dcs.ibm.com/docs/en/sva/10.0.6?topic=reference-server-stanza]

for {{max-ratelimiting-buckets}}

very similar page to this one:

[https://ibmdocs-test.dcs.ibm.com/docs/en/sva/10.0.6?topic=stanza-max-idle-persistent-connections|https://ibmdocs-test.dcs.ibm.com/docs/en/sva/10.0.6?topic=stanza-max-idle-persistent-connections]

On the training with Scott said that we need to contact you if it is a new page (topic) since need to update dita map file

(it can not be updated using oxygen xml editor).

Once the page is created and built you can let me know or you can enter the information as in sample page that I mention, need to put the max number is 16384 and description as Jack Yarbor put in the ticket.",25/Feb/23 3:33 AM;5af054597dd1e556227c18c8;Contact either Scott Exton or Ben Straubinger to create the page for you. I do not have access the 10.0.6 source files.,"28/Mar/23 10:24 AM;5b15dbfa4d941a51f0da44dd;update to the documentation has been approved, it will be included in 10.0.6.0",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISAM Appliance in not responding correctly.LMI does not ask for deploying changes.,ISAMSUP-5103,302717,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,adarsh.nair,605c0c04b18de50071046740,adarsh.nair,605c0c04b18de50071046740,29/May/23 8:23 PM,13/Jun/23 12:24 PM,14/Jul/23 2:47 PM,31/May/23 7:53 AM,,Support,,0,#escalated,,,"Customer has ISAM appliance on AWS instance.
Primary master is in kind of hung state..any changes performed via LMI does not ask for deployment..It does not get reflected.
They have Policy Server, Reverse proxy and AAC/Fed runtime configured on this system.
They rebuild appliance and applied the snapshot.
The LMI and AAC runtime are not able to connect to external config and hvdb although the test connection works.

no traces can be enabled..the LMI just keeps loading the page.",,BRIANORO,Daniel Comeau,David Flynn,Dermot Daly,khansen,Nick Lloyd,prashant_kamat,Reagan Knowles,Tushar Prasad,Virag Patel,,,,,,6154906364ff01007106e189,5b15d9a0dda5f94d06b985b3,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013148617,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,adarsh.nair,605c0c04b18de50071046740,,,,INFORMATION & EGOVERNMENT AUTHORITY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013148617&path=TS013148617%2F2023-05-29%2Fisva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1c0lb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,Moderate,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-05-29 10:59:52.375,,,,,"29/May/23 8:28 PM;605c0c04b18de50071046740;LMI logs error.

{noformat}[5/29/23, 12:39:34:079 AST] 0000002e com.ibm.ws.logging.internal.impl.IncidentImpl                I FFDC1015I: An FFDC Incident has been created: ""org.postgresql.util.PSQLException: The connection attempt failed. com.ibm.ws.rsadapter.impl.PostgreSQLHelper 1298"" at ffdc_23.05.29_12.39.34.0.log
[5/29/23, 12:39:34:160 AST] 0000002e com.ibm.ws.logging.internal.impl.IncidentImpl                I FFDC1015I: An FFDC Incident has been created: ""com.ibm.ws.rsadapter.exceptions.DataStoreAdapterException: DSRA8100E: Unable to get a PooledConnection from the DataSource. with SQL State : 08001 SQL Code : 0 com.ibm.ejs.j2c.poolmanager.FreePool.createManagedConnectionWithMCWrapper 199"" at ffdc_23.05.29_12.39.34.1.log
[5/29/23, 12:39:34:167 AST] 0000002e com.ibm.ws.logging.internal.impl.IncidentImpl                I FFDC1015I: An FFDC Incident has been created: ""javax.resource.spi.ResourceAllocationException: DSRA8100E: Unable to get a PooledConnection from the DataSource. with SQL State : 08001 SQL Code : 0 com.ibm.ws.rsadapter.jdbc.WSJdbcDataSource.getConnection 299"" at ffdc_23.05.29_12.39.34.2.log
[5/29/23, 12:39:38:169 AST] 00000031 com.ibm.isam.scim.config.ScimConfig                          E initialiseConfiguration : Caught Exception : java.sql.SQLException: The connection attempt failed. DSRA0010E: SQL State = 08001, Error Code = 0{noformat}

No changes are applied.


 ","29/May/23 8:59 PM;6092ac9ff6c0960069d47a67;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b232b2fd85e5b59b066f57f] Sev 1 case, escalated ","29/May/23 10:40 PM;5ac57757d9a96536d1f0daa9;[~accountid:6092ac9ff6c0960069d47a67] this seems to be indicating that there is a connection issue for this one. Can you please confirm how this connection is being established, what security protocols are being used during the connection and validate that all of the required configures are in place eg certificates. Simple ping will only validate that the systems can reach each  other not validate that the connection can be established. Appreciate the additional review and confirmation of the customers deployment.",29/May/23 10:42 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b17571b91981f4fdde632c1] once L2 has completed the additional assessment can you please review their findings. To me this one could be missing something to allow the connection to be successfully established. Appreciate the support on this one.,29/May/23 10:46 PM;614dd566a995ad0073ec0622;[~accountid:5ac57757d9a96536d1f0daa9] I am willing to that assessment in parallel. AP team and Virag have already been working on this and have had at least one or two webexes. So we can assume that has already been done. ,29/May/23 11:23 PM;614dd566a995ad0073ec0622;[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b17571b91981f4fdde632c1] Just had webex with customer. They are using non ssl connections. Previous pcap taken should no response from database(According to customer. I cannot verify AP team analysis ). Cluster has two nodes. Issue on both nodes in this Prod cluster. They have the same issue in the staging environment which does use a different database. There is also a test environment which uses a different schema in the same database as stage but a different schema which is working ok.  Postgres on aws is the db in use. They already tried to create a new schema in prod but they simply recopied the data on the db end to create it? Maybe a new schema in the Prod db but the data should be imported from a proper export of the master config db in the cluster? Looking at current support file and pcap. The snapshot they have tried reapplying over the last two days is about two months old.,"30/May/23 12:04 AM;614dd566a995ad0073ec0622;h1. Interface configuration

{noformat}{noformat}

gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.label     = 1.1
gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.name      =
gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.enabled   = true
gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.type      = physical
gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.mtu       = 1500
gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.bonding_mode = none

gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.link_mode = Auto
    # Ipv4 configuration
gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.dhcp4.enabled       = true
gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.dhcp4.mgmt          = true
gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.dhcp4.default_route = true
gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.dhcp4.route_metric  =
    # end Ipv4 configuration

{noformat}# Ipv6 configuration{noformat}

gw_net.if.b702f799-c305-4439-8835-4e51c9b6d16b.dhcp6.enabled = false
    # end Ipv6 configuration

h1. end Interface configuration

h1. Interface configuration

gw_net.if.6cd40fab-3163-4593-8a88-6ca35079051b.label     = loopback
gw_net.if.6cd40fab-3163-4593-8a88-6ca35079051b.name      =
gw_net.if.6cd40fab-3163-4593-8a88-6ca35079051b.enabled   = true
gw_net.if.6cd40fab-3163-4593-8a88-6ca35079051b.type      = loopback
gw_net.if.6cd40fab-3163-4593-8a88-6ca35079051b.mtu       = 1500
gw_net.if.6cd40fab-3163-4593-8a88-6ca35079051b.bonding_mode = none

{noformat}# Ipv4 configuration{noformat}

gw_net.if.6cd40fab-3163-4593-8a88-6ca35079051b.dhcp4.enabled = false
    # end Ipv4 configuration

{noformat}# Ipv6 configuration{noformat}

gw_net.if.6cd40fab-3163-4593-8a88-6ca35079051b.dhcp6.enabled = false
    # end Ipv6 configuration

h1. end Interface configuration

h1. end Gateway Network",30/May/23 12:05 AM;614dd566a995ad0073ec0622;I see no ip addresses? [~accountid:5b17571b91981f4fdde632c1] ,30/May/23 12:45 AM;614dd566a995ad0073ec0622;[~accountid:5ac57757d9a96536d1f0daa9] Considering it is Memorial day. Whom from L3 is actually working?,"30/May/23 1:44 AM;614dd566a995ad0073ec0622;Customer responded: ""Its on AWS and when we launch an EC2 instance with ISVA preloaded image, we assign an IPV4 address directly to the server which will be used to access ISAM. Within ISAM we did not choose management IP since day 1 and the env is up and running for more than 6 months.""",30/May/23 2:30 AM;614dd566a995ad0073ec0622;The pcap was generated at 1900 GMT Sunday. The JIRA opened  a few hours does not mention the pcap? However the pcap did indicate that db was not responding to ISVA but AP team obviously moved on from that synopsis when the direction was taken to open a Jira. Unfortunately I cannot substantiate AP Team’s reasoning for this approach. ,"30/May/23 2:54 AM;5b17571b91981f4fdde632c1;* ThreadInfoIntrospector.txt ignoring all WAITING threads
** Clearly shows connected
** Clearly shows read
*** So the writes were successful
** No active writes","30/May/23 3:01 AM;5b17571b91981f4fdde632c1;* L2 please example
** Cluster configuration
*** {noformat}2023-05-28/isva_10.0.4.0_20230528-181550_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:3:[mgr]...isPrimary = yes
2023-05-28/isva_10.0.4.0_20230528-181550_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:4:[mgr]...isLocal = no
2023-05-28/isva_10.0.4.0_20230528-181550_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:6:[mgr]...primary = crms-prd-isam1
2023-05-28/isva_10.0.4.0_20230528-181550_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:7:[mgr]...primary_seq_num = 1
2023-05-28/isva_10.0.4.0_20230528-181550_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:8:[mgr]...secondary =
2023-05-28/isva_10.0.4.0_20230528-181550_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:9:[mgr]...tertiary =
2023-05-28/isva_10.0.4.0_20230528-181550_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:10:[mgr]...quaternary =
2023-05-28/isva_10.0.4.0_20230528-181550_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:16:[cfgdb]...isLocal = no
2023-05-28/isva_10.0.4.0_20230528-181550_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:19:[hvdb]...isLocal = no

--------------------------------------------------------------------------------

2023-05-29/isva_10.0.4.0_20230529-115037_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:3:[mgr]...isPrimary = yes
2023-05-29/isva_10.0.4.0_20230529-115037_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:4:[mgr]...isLocal = no
2023-05-29/isva_10.0.4.0_20230529-115037_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:6:[mgr]...primary = crms-prd-isam1
2023-05-29/isva_10.0.4.0_20230529-115037_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:7:[mgr]...primary_seq_num = 1
2023-05-29/isva_10.0.4.0_20230529-115037_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:8:[mgr]...secondary =
2023-05-29/isva_10.0.4.0_20230529-115037_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:9:[mgr]...tertiary =
2023-05-29/isva_10.0.4.0_20230529-115037_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:10:[mgr]...quaternary =
2023-05-29/isva_10.0.4.0_20230529-115037_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:16:[cfgdb]...isLocal = no
2023-05-29/isva_10.0.4.0_20230529-115037_crms-prd-isam1.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:19:[hvdb]...isLocal = no

--------------------------------------------------------------------------------

2023-05-29/isva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:3:[mgr]...isPrimary = yes
2023-05-29/isva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:4:[mgr]...isLocal = no
2023-05-29/isva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:6:[mgr]...primary = crms-prd-isam1
2023-05-29/isva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:7:[mgr]...primary_seq_num = 1
2023-05-29/isva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:8:[mgr]...secondary =
2023-05-29/isva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:9:[mgr]...tertiary =
2023-05-29/isva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:10:[mgr]...quaternary =
2023-05-29/isva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:16:[cfgdb]...isLocal = no
2023-05-29/isva_10.0.4.0_20230529-130006_crms-prd-isam1-latest.support_unpack/var/isam/clustermgr/etc/clustermgr.conf:19:[hvdb]...isLocal = no{noformat}
** Snapshot
*** {noformat}# find 2023-05-29/isva_10.0.4.0_20230308-115018.972469_crms-prd-isam1.snapshot_unpack/var/isam/cluster -type f -print
2023-05-29/isva_10.0.4.0_20230308-115018.972469_crms-prd-isam1.snapshot_unpack/var/isam/cluster/replicate/keyfile
2023-05-29/isva_10.0.4.0_20230308-115018.972469_crms-prd-isam1.snapshot_unpack/var/isam/cluster/replicate/isam.runtime{noformat}",30/May/23 3:35 AM;5b15d9a0dda5f94d06b985b3;Initiated the L3 callout process at 1:13pm eastern….. waiting for response,"30/May/23 3:56 AM;5b15d9a0dda5f94d06b985b3;Hi Bill,

I don’t know what “please example” means…. can you clarify?      He said they can’t make any changes at all that require anything to be deployed, even stuiff that doesn’t need the database (like changing webseal config file, changing hosts file, etc).","30/May/23 4:01 AM;5b15d9a0dda5f94d06b985b3;And just FYI, the customer keeps saying they were told L3 would contact them.    I don’t know what was discussed previously between L2 and the customer and what was or wasn’t said.    I did explain to the customer that usually L3 works with L2 and not customers, so just giving you a heads up that this is what they were asking for even though I’m trying to steer them away from that expectation….. unless you decide you want to work with them directly",30/May/23 5:13 AM;5b15d9a0dda5f94d06b985b3;Is there any way we can tell if a snapshot was generated from an appliance with or without FIPS being enabled?,"30/May/23 7:21 AM;5b17571b91981f4fdde632c1;{quote}Cluster has two nodes{quote}



* {{primary_seq_num = 1}}
* {{secondary =}}
* {{tertiary =}}
* {{quaternary =}}
* Snapshot did not contain all cluster files","30/May/23 7:37 AM;5b17571b91981f4fdde632c1;* The fact that ThreadInfoIntrospector.txt and pcap (per this work item)
** connection was succeeding
** written
** Waiting on reading
* What was the server recording/showing","30/May/23 10:25 AM;5b17571b91981f4fdde632c1;* 10.255.21.106	 5432
** 10.255.21.106	 5432 HVDB/CONFIG: SSL	client 8 bytes then client closes {3 total}
*** Unknown
**** Incomplete transaction 
** 10.255.21.106	 5432 HVDB/CONFIG: [SYN], [SYN, ACk], Client [FIN]
*** *Not seeing any Client SSL/TLS handshake*
**** {noformat}1 thread
	at java.base@.0.14.1/java.net.SocketInputStream.socketRead0(Native Method)
	at java.base@.0.14.1/java.net.SocketInputStream.socketRead(Unknown Source)
	at java.base@.0.14.1/java.net.SocketInputStream.read(Unknown Source)
	at java.base@.0.14.1/java.net.SocketInputStream.read(Unknown Source)
	at org.postgresql.core.VisibleBufferedInputStream.readMore(VisibleBufferedInputStream.java:161)
	at org.postgresql.core.VisibleBufferedInputStream.ensureBytes(VisibleBufferedInputStream.java:128)
	at org.postgresql.core.VisibleBufferedInputStream.ensureBytes(VisibleBufferedInputStream.java:113)
	at org.postgresql.core.VisibleBufferedInputStream.read(VisibleBufferedInputStream.java:73)
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:443)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:505)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:149)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:213)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:51)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:225)
	at org.postgresql.Driver.makeConnection(Driver.java:465)
	at org.postgresql.Driver.connect(Driver.java:264)
	at java.sql.DriverManager.getConnection(Unknown Source)
	at java.sql.DriverManager.getConnection(Unknown Source)

59 thread
	at java.base@11.0.14.1/java.net.SocketInputStream.socketRead0(Native Method)
	at java.base@11.0.14.1/java.net.SocketInputStream.socketRead(Unknown Source)
	at java.base@11.0.14.1/java.net.SocketInputStream.read(Unknown Source)
	at java.base@11.0.14.1/java.net.SocketInputStream.read(Unknown Source)
	at org.postgresql.core.VisibleBufferedInputStream.readMore(VisibleBufferedInputStream.java:161)
	at org.postgresql.core.VisibleBufferedInputStream.ensureBytes(VisibleBufferedInputStream.java:128)
	at org.postgresql.core.VisibleBufferedInputStream.ensureBytes(VisibleBufferedInputStream.java:113)
	at org.postgresql.core.VisibleBufferedInputStream.read(VisibleBufferedInputStream.java:73)
	at org.postgresql.core.PGStream.receiveChar(PGStream.java:443)
	at org.postgresql.core.v3.ConnectionFactoryImpl.enableSSL(ConnectionFactoryImpl.java:505)
	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:149)
	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:213)
	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:51)
	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:225)
	at org.postgresql.Driver.makeConnection(Driver.java:465)
	at org.postgresql.Driver.connect(Driver.java:264){noformat}
* 10.248.35.43	443
** See working connection
*** Client Application Data <=> Server Application data
** See errors
*** *Client [SYN] immediate server [RST]*
*** Client Application Data, No Server Application data … Server [FIN]
*** Client Application Data, Server, Server [FIN],  Client Encrypted Alert, Server [RST]
* 10.248.35.43	  444
** See working connection
*** Client Application Data <=> Server Application data
** See errors
*** Server Application Data, Server [FIN], Client Send Encrypted Alert from Application Data read, Server [RST]","30/May/23 10:51 AM;5b17571b91981f4fdde632c1;* TS013148617/2023-05-29/isva_10.0.4.0_20230308-115018.972469_crms-prd-isam1.snapshot_unpack/Comment
** before ssl CN=DigiCert+ECC+Secure+Server+CA,O=DigiCert+Inc,C=US
*** Did not DigiCert in any snapshot file
* TS013148617/2023-05-29/isva_10.0.4.0_20230308-115018.972469_crms-prd-isam1.snapshot_unpack/Settings
** {noformat}sys.product.version = 10.0.4.0
sys.version.model = appliance{noformat}
* ",30/May/23 12:00 PM;605c0c04b18de50071046740;5432 is their non ssl port on config / hvdb.,"31/May/23 2:28 AM;5b17571b91981f4fdde632c1;{quote}William Hannon Jr  May 29, 2023, 4:37 PM

The fact that ThreadInfoIntrospector.txt and pcap (per this work item)

   connection was succeeding

   Waiting on reading

  What was the server recording/showing{quote}",31/May/23 2:32 AM;614dd566a995ad0073ec0622;[~accountid:5b17571b91981f4fdde632c1] Sorry should have updated some time ago. Dealing with another Sev 1. Issue seems on the way to resolution. FW issue fixed. Appliance working now.,31/May/23 7:53 AM;5ac57757d9a96536d1f0daa9;Setting this items status to Done. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISAM appliance Admin user vaulting with PIM tool,ISAMSUP-5037,297163,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,02/May/23 8:32 PM,22/May/23 12:20 PM,14/Jul/23 2:47 PM,22/May/23 12:20 PM,,Support,,0,,,,"Hi Team,

I have a customer asking the feasibility of the integration of ISVA(admin user) with PIM tool Aaron.

Do we have any document supporting such integration or a list of the PIM tools that are supported with ISVA.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012322422,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,SARASWAT CO-OPERATIVE BANK LTD,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1b2uf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,Moderate,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-05-02 22:27:00.013,,,,,"03/May/23 8:27 AM;5ac57757d9a96536d1f0daa9;[~accountid:62d0e51aec233f24684a5d3a] no existing integration between ISVA and the PIM tool Aaron currently exists. If the customer would like to have this request considered for a future release can you please request that the create a product idea at the following URL - 

[https://www.ibm.com/support/pages/welcome-ibm-ideas-portal|https://www.ibm.com/support/pages/welcome-ibm-ideas-portal]

Please note that this is not a commitment. The idea will be assessed by the ISVA product senior leadership team to confirm if this is something that can be accepted. ","03/May/23 2:01 PM;62d0e51aec233f24684a5d3a;Hi Tony, thanks for the update. I will cascade to the customer.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Query regarding webseal compatbility with vmware services,ISAMSUP-4797,281465,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwijono,5b15dbfa4d941a51f0da44dd,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,15/Feb/23 2:20 PM,09/Mar/23 2:31 PM,14/Jul/23 2:47 PM,22/Feb/23 1:49 AM,,Support Management,,0,,,,"Hi team, we have a customer whose webseal servers are hosted in vmware, and they would like to know if it can support vmware related features suchs vMotion, VMWare HA and Snapshot for ISVA without having issue.

I tried finding more on this and got this note which is old one for ISAM 8 can you please confirm if it still stands true - [https://www.ibm.com/support/pages/isam-8-support-vmware-snapshot|https://www.ibm.com/support/pages/isam-8-support-vmware-snapshot|smart-link] .",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012128980,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,DBS BANK LTD,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18eoz:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,Moderate,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-21 15:49:22.592,,,,,"16/Feb/23 2:06 PM;62d0e51aec233f24684a5d3a;I guess this recent tech note answers it - [https://www.ibm.com/support/pages/ibm-security-verify-access-appliance-backup-supported-methods|https://www.ibm.com/support/pages/ibm-security-verify-access-appliance-backup-supported-methods|smart-link] .

Let me know the insights from your side as well.

Thanks",22/Feb/23 1:49 AM;5ac57757d9a96536d1f0daa9;[~accountid:62d0e51aec233f24684a5d3a] if you believe that the technote you have identified answers this customer question I will set this items status to Done. Please reopen if you need any additional assistance. ,"09/Mar/23 2:31 PM;62d0e51aec233f24684a5d3a;Hey Tony I guess we are set with this, you can close it. Thanks",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Vulnerability due to outdated Bootstrap version,ISAMSUP-4719,276387,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,18/Jan/23 4:31 PM,19/Apr/23 10:48 AM,14/Jul/23 2:47 PM,19/Apr/23 10:48 AM,,Support,,0,,,,"Hi team,

Requesting your assistance for a case where client has found vulnerability in ISAM dashboard due to outdated bootstrap version 4.1.1. You can find the attached screenshot in the case itself.

Does ISAM use bootstrap? If so , is it vulnerable to this vulnerability?

Case no. - TS011814351",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011814351,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,SARASWAT CO-OPERATIVE BANK LTD,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17ozr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,Moderate,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-01-23 21:23:07.275,,,,,24/Jan/23 7:23 AM;5b15d8fd6e93913e31e279fb;The bootstrap.min.css file is a part of the trial_site configuration to show an example of the uses of the product.  This should not be used in a production environment.  The product is scanned weekly by the Mend OpenSource scanning tool and has shown no vulnerabilities due to this level of the code.,24/Jan/23 1:24 PM;62d0e51aec233f24684a5d3a;So what version of bootstrap are we using for the Production grade Environments?? Is the version used in Production Environment different from the trial_site version?,25/Jan/23 2:32 AM;5b15d8fd6e93913e31e279fb;[~accountid:62d0e51aec233f24684a5d3a] Our docker images are run by a bootstrap.sh file which is used to bootstrap each of the individual container images.,25/Jan/23 2:19 PM;62d0e51aec233f24684a5d3a;[~accountid:5b15d8fd6e93913e31e279fb] Are we not using this bootstrap file in Appliance offering??,26/Jan/23 9:23 AM;5b15d8fd6e93913e31e279fb;[~accountid:62d0e51aec233f24684a5d3a] No we are no using this bootstrap file in the appliance or the Docker environments,27/Jan/23 3:30 PM;62d0e51aec233f24684a5d3a;Thanks. Just wondering the bootstrap file in question is bootstrap.min.css but the one you mentioned about is bootstrap.sh…..I think these are two different files…..can you please clarify,30/Jan/23 7:55 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d8fd6e93913e31e279fb] any update on this? Thanks,01/Feb/23 12:14 PM;5b15d8fd6e93913e31e279fb;As stated earlier we are not using that file for bootstrapping our containers which I have verified with the development lead.,"01/Feb/23 7:28 PM;62d0e51aec233f24684a5d3a;Hi , so if we are not using that bootstrap file can we remove it altogether in upcoming releases else it will keep on flagging in further security checks.

Also this customer is not using containers but Appliance, does the appliance offering also not using this bootstrap file??",07/Feb/23 2:21 AM;5b15d8fd6e93913e31e279fb;i will have to bring that up with development for the next ISVA release.,"15/Feb/23 2:11 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d8fd6e93913e31e279fb] customer is asking - If you use for only trial site configuration then update the older version with latest one. If you have any dependency or you won't able to upgrade the version then please update on PMR.

Can you please help with these queries. 

Can I convey that this will be fixed in the next release?","17/Feb/23 2:19 PM;62d0e51aec233f24684a5d3a;Hi Jim , any update on this?",18/Feb/23 2:46 AM;5b15d8fd6e93913e31e279fb;I am asking development about removing the code.,21/Feb/23 3:51 PM;62d0e51aec233f24684a5d3a;So can I communicate to the customer that this will be removed in upcoming version?,22/Feb/23 2:03 AM;5b15d8fd6e93913e31e279fb;[~accountid:62d0e51aec233f24684a5d3a] I am still working on development with this.  [~accountid:5ac577587028785d133fbc46] [~accountid:5ac577577331be74a80d5ab4] I sent an email asking if the trial site code can be removed from all distributions of the product and possible movement of this to a different GitHub repo.  Can you weigh in on this?,"22/Feb/23 11:29 AM;5ac577577331be74a80d5ab4;[~accountid:5b15d8fd6e93913e31e279fb] the code is not present in the product but just happens to live in the source tree. So, it should be trivial to move the code to a new repository in GitHub. Having said this, I am no longer working on the project and so this will really need to wait for Keiran’s return, or if it can’t wait you will need to reach out to tony to see if anyone on the isva team can assist.",22/Feb/23 11:30 AM;5b15d8fd6e93913e31e279fb;[~accountid:5ac577577331be74a80d5ab4] so why is this showing up in the container scans?  See my first comment on this issue.,"03/Mar/23 1:42 PM;62d0e51aec233f24684a5d3a;Hi Team, [~accountid:5b15d8fd6e93913e31e279fb] , 

any update on this?? Customer is looking for closure on this.","06/Mar/23 3:19 PM;62d0e51aec233f24684a5d3a;Hello, [~accountid:5b15d8fd6e93913e31e279fb] do we have an update on this…..customer is pushing for closure.",09/Mar/23 2:32 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d8fd6e93913e31e279fb] Requesting you to please provide an update on this?,13/Mar/23 2:26 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d8fd6e93913e31e279fb] Can you please provide an update on this,19/Apr/23 10:48 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Confirm API for restart appliance.,ISAMSUP-5220,311237,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,carlos.arias,62ed8180432ef494c8cad107,carlos.arias,62ed8180432ef494c8cad107,11/Jul/23 3:14 AM,13/Jul/23 1:01 AM,14/Jul/23 2:47 PM,,,,,0,,,,"I was asked to open to this ticket to confirm that there are no caveats or issues with using the Rest API to restart the appliance; Or if there is a formal procedure that needs to be followed.



Endpoint:

/diagnostics/restart_shutdown/reboot

ISVA 10.0.3",,khansen,Steve Herskowitz,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5af99299ae1b5f08256340f1,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013560180,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,US DEPT OF VETERANS AFFAIRS,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1dh8n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-07-10 21:55:11.195,,,,,11/Jul/23 7:55 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] hopefully this is just a quick confirmation. ,"12/Jul/23 11:48 AM;5b15d954b0d76456f36daf33;[~accountid:62ed8180432ef494c8cad107] have they encountered any issues using that RAPI command?

If not, as long as the necessary headers are supplied to the endpoint, it should work as documented.

Easiest way will be for you to try it on a local appliance. If it works we are good. Else, a doc APAR might be needed.","13/Jul/23 1:01 AM;62ed8180432ef494c8cad107;Customer just wants to confirm if there’re not caveats.

[~accountid:5b15d954b0d76456f36daf33] ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Time logs after update version 10.0.5.1,ISAMSUP-5209,310724,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Peter Horner,5b15d9517dab4c51f61b5190,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,06/Jul/23 7:22 PM,12/Jul/23 5:58 PM,14/Jul/23 2:47 PM,,10.0.7,,,0,,,,"The customer have proceeded to patch from 10.0.1_IF1 to version 10.0.5_IF1 and have noticed that the time recorded in the instance logs is two hours behind the current time.

In the Manage Revserse proxy log files page (LMI → Web → Reverse Proxy → instance → Trouble shooting → Log) The request log and webseal logs are two hours behind.

For example request.log in Manage Revserse proxy log files page show Jul 4, 2023 01:27:24 PM. When we open the request.log it shows 2023-07-04-11:27 2 hours difference.",,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5227,,06/Jul/23 7:24 PM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;pic 1.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/209993,06/Jul/23 7:24 PM;ug:4453b2c5-a4bf-4ea0-a099-143ddfa563dd;pic 2.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/209994,,,,,,,,,,,,,,IJ47522,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013506088,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,"BBVA, S.A CENTRO DE TRATAMIENTO FACTURAS",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-07-12T17:18:07.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1de3r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-07-07 00:37:00.823,,,,,"07/Jul/23 12:03 AM;6092aca0f0db130069d19687;Hi team, The customer provided with PCAP (network packet) trace file. It shows there is communication between the appliance and the time servers. 

The server configured as NTP is: spadm002.igrupobbva,logs01.igrupobbva","07/Jul/23 10:37 AM;5b15d9517dab4c51f61b5190;The times displayed in the browser (pic1.png) are in the timezone of the browser not the timezone of the system being viewed

So I am guessing it is 2 hours different to the appliance 

The request logs all show the correct +02:00 timezone

However the webaeal logs have lost the timezone after the restart

Went from  2023-07-04-09:09:39.012+02:00I to 2023-07-04-07:54:59.742+00:00I (from gps01 instance)

They are still showing the correct time - just in the wrong timezone

I think this is a webseal logging issue

try a stop and start (not restart) of 1 instance to see if it resolves the issue

I am still investigating cause","07/Jul/23 5:53 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] thanks for your quick reply. Yes I will ask the try a stop and start (not restart) of 1 instance.

Thank you very much 👍 ","10/Jul/23 10:33 AM;5b15d9517dab4c51f61b5190;The problem started before they applied IF1

It started when they rebooted before applying IF1

Evidence

They upgraded to 10.0.5.0 On Jun 21

They applied 10.0.5.0 IF1 on Jul 4 at 10:28

But the issue happened before IF1 was applied

Went from 2023-07-04-09:09:39.012+02:00I to 2023-07-04-07:54:59.742+00:00I (from gps01 instance)

So the first bad timestamp is at 2023-07-04-07:54:59.742+00:00I 

In the correct timezone is 2023-07-04-09:54:59.742+02:00I

9:54 is 30 minutes before they applied IF1

This coincides with a reboot before they applied IF1

It is the first reboot since upgraded to 10.0.5.0

So the problem seems unrelated to IF1

One thing I noticed in /var/log/messages

is that the first time chronyd runs is after the the reboot at 9:54

ie prior to first reboot it was still using ntpd","10/Jul/23 1:42 PM;5b15d9517dab4c51f61b5190;It looks like a race at boot time between setting up the timezone and starting the reverse proxies

If you change the timezone after a reverse proxy has started - it does not take effect in the reverse proxy logs until the reverse proxy is restarted.

The nacarfn01 instance was restarted on Jul 4 at Tue Jul  4 11:00:50 2023 well after boot time

But I can see from picture2.png this did not fix the issue","10/Jul/23 3:30 PM;5b15d9517dab4c51f61b5190;My previous statement about a race was incorrect.

I have reproduced the issue

It seems to be specific to some GMT+1 timezones

Please open an APAR “Reverse proxy logs contain incorrect GMT offset”

It is affecting at least the Madrid, Paris,Amsterdam,Brussels timezones

The Berlin,Copenhagen,Malta,Gibraltar,Rome,Stockholm,Zurich timezones are unaffected

The work around is to. use one of the unaffected timezones instead of Madrid

This needs to be done before restarting the reverse proxies

This is a temporary work around until we have a fix","10/Jul/23 5:08 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] Thank you very much for your help. I will raise a APAR and let the customer know the wrok around.

👍 ",10/Jul/23 5:48 PM;6092aca0f0db130069d19687;*APAR IJ47522* created,11/Jul/23 5:30 PM;6092aca0f0db130069d19687;[~accountid:5b15d9517dab4c51f61b5190] The customer is asking if the fix pack for V10.0.5_IF1 available soon. ,"11/Jul/23 10:18 PM;5b15d9517dab4c51f61b5190;[~accountid:6092aca0f0db130069d19687] 

I have only now found the cause of the issue.

I will hopefully have a fix later this week","11/Jul/23 10:21 PM;6092aca0f0db130069d19687;Sorry for rushing you, as you know customers are demanding.

Thank you very very very much for your help.","12/Jul/23 9:24 AM;5b15d9517dab4c51f61b5190;The issue affects Policy Server and Authorization Servers logs as well as Reverse Proxy logs

The issue also affects the timestamps in trace files","12/Jul/23 10:23 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: bf02f9870317c1f7f446fefdc67ea546d66b31c0
   * description: ISAMSUP-5209 IJ47522 Reverse proxy logs contain incorrect GMT offset

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2510710.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5209) which we publish.","12/Jul/23 12:09 PM;5b15d9517dab4c51f61b5190;Full list of Timezones affected by IJ4572 on 10.0.5.0

{noformat}Amsterdam
Aqtobe
Azores
Brussels
Cambridge_Bay
Chisinau
Chita
Goose_Bay
Irkutsk
Istanbul
Istanbul
Kaliningrad
Khandyga
Kiev
Krasnoyarsk
Lisbon
Luxembourg
Madeira
Madrid
Magadan
Minsk
Monaco
Moscow
Omsk
Pangnirtung
Paris
Qyzylorda
Riga
Samara
Simferopol
Srednekolymsk
Tallinn
Tbilisi
Tiraspol
Ulyanovsk
Ust-Nera
Uzhgorod
Vilnius
Vladivostok
Warsaw
Yakutsk
Yekaterinburg
Zaporozhye
{noformat}","12/Jul/23 2:47 PM;5b15d9517dab4c51f61b5190;The fixpack is attached to  [https://cloudidentity.atlassian.net/browse/ISAMSUP-5227|https://cloudidentity.atlassian.net/browse/ISAMSUP-5227|smart-link] 

It restarts Policy Server, Authorization Servers and Reverse Proxies automatically

So needs to be applied on all machines where any of those are running","12/Jul/23 5:18 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 8350d2fb8d5942522ab51ace6cf24081a9518007
   * description: Merge pull request #6027 from ISAM/ISAMSUP-5209

ISAMSUP-5209 IJ47522 Reverse proxy logs contain incorrect GMT offset

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2519600.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230712071453-8350d2fb8.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",12/Jul/23 5:58 PM;6092aca0f0db130069d19687;👍 [~accountid:5b15d9517dab4c51f61b5190] Thank you very very very much 👍 ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
WGAWA0034E / Signal 11 on 2nd June 2023,ISAMSUP-5198,305201,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,carlos.arias,62ed8180432ef494c8cad107,carlos.arias,62ed8180432ef494c8cad107,07/Jun/23 1:52 AM,30/Jun/23 4:16 AM,14/Jul/23 2:47 PM,30/Jun/23 4:16 AM,,,,0,,,,"reviewed the core dumps and seems to have hit a known APAR : [https://www.ibm.com/support/pages/apar/IJ40415|https://www.ibm.com/support/pages/apar/IJ40415]



and similar to the same issue reported by ISV(previously) CI team, over case TS008273754



and the related jira: [https://cloudidentity.atlassian.net/browse/ISAMSUP-3860|https://cloudidentity.atlassian.net/browse/ISAMSUP-3860|smart-link] 



--snippet of crash point occurred now -- and see



Thread 1 (Thread 0x7fc0f4a6c700 (LWP 29449)):
#0  0x00007fc16d05a37f in raise () from /lib64/libc.so.6
No symbol table info available.
#1  0x00007fc16d044db5 in abort () from /lib64/libc.so.6
No symbol table info available.
#2  0x00007fc16d044c89 in __assert_fail_base.cold.0 () from /lib64/libc.so.6
No symbol table info available.
#3  0x00007fc16d052a76 in __assert_fail () from /lib64/libc.so.6
No symbol table info available.
#4  0x00007fc16dd21b61 in pthread_mutex_lock () from /lib64/libpthread.so.0
No symbol table info available.
#5  0x00007fc1701c7978 in AMWOAuthResponseCache::getRSTR(char const*, AMWRefPtr<AMWOAuthRSTR>&) () from /usr/lib64/libamwoauth.so
No symbol table info available.
#6  0x00007fc144fa4191 in AMWOAuthModule::authorize(long, char*, long, int*, long*) () from /opt/pdwebrte/lib/libamwoautheas.so
No symbol table info available.
#7  0x00007fc144fa1b82 in azn_svc_decision_access_allowed_ext () from /opt/pdwebrte/lib/libamwoautheas.so
No symbol table info available.
#8  0x00007fc16c9b1c28 in AznExternAuthznSvc::checkAuthznSvc(long, char*, char*, long, int*, long*) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#9  0x00007fc16c9ac083 in IVAuthznEngine::consultEASCombinator(long, char*, char*, long, long*, IVACLPermset const&, IVPop const*, IVExtAttr const*, ZUTF8String&, ZUTF8String&, unsigned long*) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#10 0x00007fc16c9af54a in IVAuthznEngine::checkAuthorization(long const&, long, daPObjName const&, IVACLPermset const&, char*, long*, int*, unsigned long&) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#11 0x00007fc16c9a7d92 in ReplicatedAuthznService::checkAuthorization(long, char const*, char*, long, unsigned long, int*, long*) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#12 0x00007fc16c9a43cb in internal_azn_decision_access_allowed_ext(long, char*, char*, long, unsigned long, int*, long*) () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#13 0x00007fc16c9a4531 in azn_decision_access_allowed_ext () from /usr/lib64/libpdauthzn.so
No symbol table info available.
#14 0x00007fc16fce22d6 in amw_azn_decision_access_allowed_ext () from /usr/lib64/libamwebrte.so
No symbol table info available.
#15 0x00007fc170520d00 in acl_check_path () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#16 0x00007fc17051f07c in requestAuthorize(h_s_t*, wand_client_ident_s_t*, Junction*, HTTPRequest*, HTTPResponse*, ResourceInfo*, ZUTF8String*, char const*, unsigned int*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#17 0x00007fc1705d3db5 in requestDispatch(h_s_t*, Junction*, HTTPRequest*, ClientOutputInfo&, HTTPResponse&, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#18 0x00007fc1705cae7f in zprocess_and_convert(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#19 0x00007fc1705cb0eb in process_junction(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, nvlist_s_t*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#20 0x00007fc1704efe7c in authAndProcess(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#21 0x00007fc17057763f in handleCallInternal(h_s_t*, HTTPRequest*, HTTPResponse*, ClientOutputInfo*, unsigned long*, unsigned int*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#22 0x00007fc170578e01 in handle_call(h_s_t*, HTTPRequest*, HTTPResponse*, unsigned int*, unsigned long*) () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#23 0x00007fc1705763e9 in call_start () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#24 0x00007fc17057c350 in WsWorker::work() () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#25 0x00007fc17057cda2 in WsWorkerThread () from /usr/lib64/libwsdaemon.so
No symbol table info available.
#26 0x00007fc16dd1f14a in start_thread () from /lib64/libpthread.so.0
No symbol table info available.
#27 0x00007fc16d11fdc3 in clone () from /lib64/libc.so.6
No symbol table info available.",,carlos.arias,Tushar Prasad,,,,,,,,,,,,,,62ed8180432ef494c8cad107,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cgi7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-07 03:18:18.037,,,,,07/Jun/23 4:54 AM;62ed8180432ef494c8cad107;[~accountid:5c53d3ac23f5bf672621c868] Jira created as requested.,07/Jun/23 4:54 AM;62ed8180432ef494c8cad107;Let me know if you need additional information.,07/Jun/23 1:18 PM;5c53d3ac23f5bf672621c868;do cancel it seems opened in a different project I moved it to [https://cloudidentity.atlassian.net/browse/ISAMSUP-5124|https://cloudidentity.atlassian.net/browse/ISAMSUP-5124|smart-link] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"After the migrate/upgaded, exactly one keystore file remained in KDB format.",ISAMSUP-5157,307751,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,21/Jun/23 12:28 AM,22/Jun/23 8:33 PM,14/Jul/23 2:47 PM,22/Jun/23 8:33 PM,,,,0,,,,"Hello Team,

The customer upgrade their appliance (three of them) from V9 to V10.0.3.0. One of the appliance keystore pdsrv_tst.kdb file did not converted from KDB to P12 format. It does not show up in LMI. We got the full support file. We cannot see the P12 file. It seems it did not converted it. We also can see the other keystore files were converted.

They tried to upload the pdsrv_tst.p12, the error message appears:
""The specified resource alraedy exists.""

When trying to delete the file with this name:
""The requested certificate database does not exist.""

The customer provided us with the support file and all the keystores.

We checked pdsrv_tst.kdb there is no on-ASCII characters found.

/ecurep/sf/TS013/342/TS013342055/2023-06-19/isva_10.0.3.0_20230424-132410_dowebs7a.continentale.loc.support_unpack/var/pdweb/shared/keytab/",,Carlos Rosales,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,5bb2c13f59e46d7be31a9e54,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5163,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013342055,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,Continentale Krankenversicherung a.G.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cw2v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-21 05:25:42.471,,,,,"21/Jun/23 3:25 PM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] I’m not entirely sure why that one keystore was not converted. But we know there have been SSL certificate related issues at 10.0.3.0 which is why 10.0.3.1 is the preferred version.

However, with the recently released 10.0.6.0, either of those 10.0.3.x versions are quite old. If the customer is upgrading now, they should consider 10.0.6.0 or at the least 10.0.5.0 (+IF1)

If for whatever reason that is not an option, I’ve attached a fixpack that attempts to convert all existing kdb files to p12 format. Once that is successfully applied, they should be able to see the {{pdsrv_tst}} keystore in the SSL certificates page and work with it.

Have them try it and let me know how it goes.",21/Jun/23 5:25 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Thank you very much for clear information. I will let the customer know the options. Thanks 👍 ,21/Jun/23 5:27 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Fixpack? I cannot see it here.,21/Jun/23 6:17 PM;5b15d954b0d76456f36daf33;Linked item should have the box link to the fixpack,21/Jun/23 9:22 PM;6092aca0f0db130069d19687;Thanks I found it. 👍 ,22/Jun/23 8:33 PM;6092aca0f0db130069d19687;Customer closed the case.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Redis in Google Cloud command request,ISAMSUP-5110,304273,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,Steve Hughes,5bac25acfd82176d11a1334c,Steve Hughes,5bac25acfd82176d11a1334c,01/Jun/23 5:57 AM,11/Jul/23 11:03 AM,14/Jul/23 2:47 PM,11/Jul/23 11:03 AM,,,,0,,,,"Google clouds implementation of Redis does not support ""SET CLIENT NAME""

GCP Redis does not support ""CLIENT"" commands as a security precaution due to possibility of ""CLIENT KILL"" command being executed. Apparently, you cannot get granular on CLIENT command. 

We had a meeting with Google product support and they are willing to allow ""SET CLIENT NAME"" however they need to know if there are other client commands that ISVA is issuing so they can ensure those are also implemented. 

The Google support team is asking for any other ""CLIENT"" commands ISVA is issuing so they can ensure all commands are supported in Google managed Redis.

For documentation this is the error when trying to use GCP Redis.

redis"",""message_id"":""0x38CF0BBB"",""source"":{""file"":""AMWRedisConnection.cpp"",""line"":640}, ""content"":""DPWWA3003E   A Redis command, 'CLIENT SETNAME %s', to 10.92.86.187:6379 failed: ERR unknown command `CLIENT`, with args beginning with: `SETNAME`, `isva-7813702e-dec6-11ed-91bf-d2574ae5cfe7`, .""}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013182090,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Steve Hughes,5bac25acfd82176d11a1334c,,,,IBM,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cauf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-06-01 18:57:59.427,,,,,"02/Jun/23 2:27 AM;5bac25acfd82176d11a1334c;Additional Information on GCP Redis commands that are blocked:
[https://cloud.google.com/memorystore/docs/redis/product-constraints|https://cloud.google.com/memorystore/docs/redis/product-constraints]",02/Jun/23 4:57 AM;5b15d94b6256d01ad54eb020;CLIENT SETNAME  is only one I could find.,"02/Jun/23 12:10 PM;5ac57757d9a96536d1f0daa9;There has been an conversation directly email the ISVA development team regarding this request. Adding the information provided for context - 

+++++

I did an investigation too and came up with a similar list to Scott.

For completeness, I have attempted to capture every command used by WebSEAL and how/when they are used:

These commands are always used when redis is enabled in WebSEAL for session management or rate-limiting:

AUTH (only when authentication is enabled)

ROLE

EVAL

EVALSHA

*CLIENT SETNAME*

These commands used when session management with redis is enabled:

HGET

HMSET

*CLIENT LIST TYPE PUB SUB*

*CLIENT ID*

*CLIENT TRACKING on REDIRECT*

GET

DEL

SET

ROLE

AUTH

SUBSCRIBE

In addition, session management uses the following during snippets which are run by EVAL/EVALSHA on the redis server:



DELEXISTSEXPIREGETHGETHGETALLHMSETSADDSCARDSETSMEMBERSSREMTTLWhen distributed rate-limiting is enabled, the following are used during snippets run by EVAL/EVALSHA:EXISTSINCRBYTTLSET

+++++

Closing out this item as Done as I believe all of the required information has now been provided. ","03/Jun/23 5:37 AM;5bac25acfd82176d11a1334c;From Kieran/ISVA Dev:
I did an investigation too and came up with a similar list to Scott.

For completeness, I have attempted to capture every command used by WebSEAL and how/when they are used:

These commands are always used when redis is enabled in WebSEAL for session management or rate-limiting:

AUTH (only when authentication is enabled)

ROLE

EVAL

EVALSHA

CLIENT SETNAME

These commands used when session management with redis is enabled:

HGET

HMSET

CLIENT LIST TYPE PUB SUB

CLIENT ID

CLIENT TRACKING on REDIRECT

GET

DEL

SET

ROLE

AUTH

SUBSCRIBE

In addition, session management uses the following during snippets which are run by EVAL/EVALSHA on the redis server:

DEL

EXISTS

EXPIRE

GET

HGET

HGETALL

HMSET

SADD

SCARD

SET

SMEMBERS

SREM

TTL

When distributed rate-limiting is enabled, the following are used during snippets run by EVAL/EVALSHA:

EXISTS

INCRBY

TTL

SET","03/Jun/23 5:38 AM;5bac25acfd82176d11a1334c;Bill,

Do you think Kieran’s list is complete or does this need more investigation before we go back to the IBM Services team with a final answer so the of ISVA used commands can be compared to the Google list of commands that are not supported.","28/Jun/23 3:04 AM;5bac25acfd82176d11a1334c;Bill,

Have we come to a conclusion that Kieran’s list is complete and should be related to the customer?",28/Jun/23 1:09 PM;5ac57757d9a96536d1f0daa9;[~accountid:5bac25acfd82176d11a1334c] from our perspective the list is completed. ,11/Jul/23 11:03 AM;5ac57757d9a96536d1f0daa9;[~accountid:5bac25acfd82176d11a1334c] I am setting this item as done as I believe we have provided everything that is needed. Please re-open if any additional support is needed. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"Cert creation rapi requires ""Content-type"" header",ISAMSUP-5081,300413,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,18/May/23 2:49 AM,09/Jun/23 7:28 PM,14/Jul/23 2:47 PM,09/Jun/23 7:28 PM,10.0.7,Support,,0,,,,"The docs for the API to create a new self-signed cert…

[https://ibm-security.github.io/apidocs/verifyaccess/10.0.5.0/ISVA-mgmt-rest-api/Generating_a_self-signed_personal_certificate_in_a_certificate_database.xml|https://ibm-security.github.io/apidocs/verifyaccess/10.0.5.0/ISVA-mgmt-rest-api/Generating_a_self-signed_personal_certificate_in_a_certificate_database.xml]

[https://{appliance_hostname}/isam/ssl_certificates/{kdb_id}/personal_cert|https://{appliance_hostname}/isam/ssl_certificates/{kdb_id}/personal_cert]

do not mention the requirement for the Content-type header to be sent by the client.

However, if it’s not there you get 

{

  ""message"": ""The request parameters do not contain valid new content for the file.""

}

Is this a code apar or a doc apar?    Thx
",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,23/May/23 11:05 PM;dcomeau;update_ldap_cert.sh;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202090,,,,,,,,,,,,,,,IJ46934,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,internal,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,,,,IBM Internal,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-06-08T16:21:42.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bmlb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-22 00:48:34.662,,,,,22/May/23 10:48 AM;5b15d954b0d76456f36daf33;[~accountid:5b15d9a0dda5f94d06b985b3] create it as a doc APAR,"23/May/23 2:47 PM;5b15d954b0d76456f36daf33;Flick it back to me when you have the APAR. 

Did you manage to capture the full RAPI request that eventually worked? Just so I can evaluate what if anything else needs to be documented?",23/May/23 11:05 PM;5b15d9a0dda5f94d06b985b3;I created apar IJ46934 for this.,"23/May/23 11:07 PM;5b15d9a0dda5f94d06b985b3;I also uploaded the script I wrote where I found this issue.   This was written in cygwin, so it may need tweaks based on whatever shell you’re using.    

But basically I needed to make sure the Content-type header is set in 

curl -s -k -u ""$RAPI_USER"" -H 'Accept: application/json' -H 'Content-Type: application/json' -X POST $RAPI_HOST/isam/ssl_certificates/embedded_ldap_keys/personal_cert --data-ascii $json_data |jq





Thanks","05/Jun/23 12:44 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 9b969515d3e11feff6e7f2f9e0a8ea1c48148d00
   * description: ISAMSUP-5081 Update RAPI with required header for generating personal cert

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/975918.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5081) which we publish.","08/Jun/23 4:21 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: b734e6ab097fb096a409a9b2d840040464165ffc
   * description: Merge pull request #5979 from ISAM/ISAMSUP-5081

ISAMSUP-5081 Update RAPI with required header for generating personal…

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1117344.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230608061858-b734e6ab.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","09/Jun/23 2:21 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] I can see that we have merged this code already. Can we please update the fix version to 10.0.7, close out the APAR and then close out this Jira item? ",09/Jun/23 2:25 PM;5b15d954b0d76456f36daf33;[~accountid:5ac57757d9a96536d1f0daa9]  The APAR is already closed. There is no option yet to mark the fix version to 10.0.7. I’ll close it once I can set the field to the right value.,09/Jun/23 7:28 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] 10.0.7 release added I have updated the Fix Version field to reflect this. Setting the Jira items status to Done. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Not able to edit Edit SSL Certificate Database that contains large amount of certificates,ISAMSUP-5053,298625,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Motiur Rahman,5b15d9e581c3df12acf53c4a,Steve Hughes,5bac25acfd82176d11a1334c,Steve Hughes,5bac25acfd82176d11a1334c,10/May/23 2:36 AM,11/Jul/23 5:00 AM,14/Jul/23 2:47 PM,,,,,0,,,,"Customer found when he attempted to edit a federation partner, in LMI, that the partner details took over 3 minutes to load.  Capturing a HAR file found the LMI makes the following request:
GET [https://appliance_hostname/isam/dojo_json_wrapper/all_cert.json?ssl_certificate_id=rt_profile_keys|https://aza01739.deluxe.com/isam/dojo_json_wrapper/all_cert.json?ssl_certificate_id=rt_profile_keys] HTTP/1.1

This request returns all certificates contained in the key file (rt_profile_keys).
Customer has >1600 signer certificates for all of the federation partners.

Adding self-signed personal certificates to rt_profile_kwys to a lab appliance, after 791 new certs (plus the existing 5 signers), the key file is no longer manageable using LMI.  Trying to edit the key database with the LMI results in a “System Error” after loading the certificates times out, the all_cert.json request fails with an HTTP 500 after the response times out.
This is not a problem at ISAM 9.x.

Customer wants to know if there is a fix for this or if there is a new limitation of the number of certificates that can be added to a SSL certificate database.",,Daniel Comeau,,,,,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,11/May/23 4:14 AM;steve.hughes;rt_profile_keys.zip;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200193,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012897135,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,Deluxe Corporation,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bbmf:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-05-10 15:09:00.144,,,,,"11/May/23 1:09 AM;5b15d9e581c3df12acf53c4a;[~accountid:5bac25acfd82176d11a1334c] 

Do you happen to have a kdb or key database file containing that many certificates that causes LMI’s failure to load? We could use that file to recreate the issue and go from there?",11/May/23 4:15 AM;5bac25acfd82176d11a1334c;I exported my rt_profile_keys and attached.,"17/May/23 8:11 AM;5b15d9e581c3df12acf53c4a;This one is bizarre, from ISVA point of view as well as big kdb file point of view also.

The way it is designed:

Use gskit command to get all the list of the certificates and then get the details of them.

All these is being done by gskit command under neath.

So, simply the rt_profile_keys that you shared, is big enough for gskit command outside of LMI.

You can see that  in a command line , outside of ISVA, it takes quite a while to get all the details.

So, I will say it is a design limitation of the ISVA itself.

Also, there is simply, no other ways to accelerate it either.

Now, it is also not exactly an LMI issue either, the command is simply timing out because it is taking too long to get all the results.

Default time out is: 300 seconds which is actually 5 minutes.

I guess, you get around  791 certificates before it’s times out.



There is an ATP option to increase the timeout:



Key: cert.db.command.timeout

Value: Integer value  ( Default it is 300 )

Try this ATP, it might get more certificates to load but, with the current design, there is no way to accelerate it.",22/May/23 1:31 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] can you please review this item as I think we may have seen something like this in the past. ,22/May/23 1:47 PM;5b232b2fd85e5b59b066f57f;The WI you are probably thinking of is [https://cloudidentity.atlassian.net/browse/ISAMSUP-4245|https://cloudidentity.atlassian.net/browse/ISAMSUP-4245|smart-link] which was to do with validation of POPs causing the policy screen to take a long time to load. ,09/Jun/23 7:27 AM;5bac25acfd82176d11a1334c;Customer wants answer as to why the amount of certs in the keyfile is not a problem with 9.0.7 but is a problem at 10.0.5.,"09/Jun/23 8:06 AM;5bac25acfd82176d11a1334c;I asked customer if all 1600+ signer certs in their rt_profile_keys were needed. Customer replied with:

Yes we would need those Certs in DB because there are about 1000 partner in a SP and those certs exists in that DB.

So relation is Service provider --> Partners in that --> to the Cert DB.

Since we are in this topic, is there is an limitations on number of partner a SP can hold with 10.X version i have not see any issue. 

But as you can see in this use case slowness we see when we open a partner in SP, so we need to get clarity on this also.","13/Jun/23 6:50 AM;5b15d9e581c3df12acf53c4a;I will check the differences in the code, in first glance, I did not see any differences but I will need to look closer, I just cannot see how it could be faster in 907, code is getting the details of each certificate in a loop………….in any case, I will update soon.","22/Jun/23 4:37 AM;5b15d9e581c3df12acf53c4a;I did some trial and error today with LMI and the *.p12 file that L2 attached here.

Here is the error I am getting in java trace file:

6/21/23, 12:25:32:005 CDT] 00000084 id=00000000 com.ibm.isam.common.utils.WgaCommand                         1 Using user : admin
[6/21/23, 12:26:32:808 CDT] 000000a8 id=00000000 SystemErr                                                    R com.ibm.isam.common.exceptions.RunCommandException: DPWAP0063E   The keyfile, BIG_rt_profile_keys.p12, could not be opened: 0x9b (GSKKM_ERR_DATABASE_BUSY)
[6/21/23, 12:26:32:819 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.isam.core.servlet.IsamCertServlet.doRestGet(IsamCertServlet.java:254)
[6/21/23, 12:26:32:833 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.mesa.servlet.MesaServlet.routeRestRequest(MesaServlet.java:764)
[6/21/23, 12:26:32:834 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.mesa.servlet.MesaServlet.routeRequest(MesaServlet.java:663)
[6/21/23, 12:26:32:835 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.mesa.servlet.MesaServlet.service(MesaServlet.java:164)
[6/21/23, 12:26:32:836 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.isam.common.servlet.MesaServletWrapper.service(MesaServletWrapper.java:90)
[6/21/23, 12:26:32:836 CDT] 000000a8 id=00000000 SystemErr                                                    R         at javax.servlet.http.HttpServlet.service(HttpServlet.java:791)
[6/21/23, 12:26:32:837 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1258)
[6/21/23, 12:26:32:838 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:746)
[6/21/23, 12:26:32:838 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:443)
[6/21/23, 12:26:32:839 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.ws.webcontainer.filter.WebAppFilterChain.invokeTarget(WebAppFilterChain.java:193)
[6/21/23, 12:26:32:839 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:98)
[6/21/23, 12:26:32:840 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.isam.core.security_filter.SecurityFilter.doFilter(SecurityFilter.java:235)
[6/21/23, 12:26:32:843 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:201)
[6/21/23, 12:26:32:844 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:91)
[……………..

……………[6/21/23, 12:26:32:898 CDT] 000000a8 id=00000000 SystemErr                                                    R         at com.ibm.ws.threading.internal.ExecutorServiceImpl$RunnableWrapper.run(ExecutorServiceImpl.java:245)
[6/21/23, 12:26:32:899 CDT] 000000a8 id=00000000 SystemErr                                                    R         at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
[6/21/23, 12:26:32:900 CDT] 000000a8 id=00000000 SystemErr                                                    R         at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
[6/21/23, 12:26:32:912 CDT] 000000a8 id=00000000 SystemErr                                                    R         at java.base/java.lang.Thread.run(Unknown Source)
[6/21/23, 12:26:32:913 CDT] 000000a8 id=00000000 PersonalCert                                                 < doRestGet(req, resp) RETURN
[6/21/23, 12:26:32:913 CDT] 000000a8 id=00000000                                                              1  GET [https://192.168.87.140/isam/personal_cert|https://192.168.87.140/isam/personal_cert] (001 mins 001 secs 793 msecs 696 usecs)
[6/21/23, 12:26:32:915 CDT] 000000a8 id=00000000 com.ibm.isam.core.security_filter.SecurityFilter             < doFilter RETURN……….





===============

Note the gskit error : GSKKM_ERR_DATABASE_BUSY

Command being executed is:

…./isam/src/com/ibm/isam/core/servlet/IsamCertServlet.java::protected void doRestGet(MesaRequest req, MesaResponse resp) throws IOException

……………

…………

            String[] commandArr = WgaHelper.buildCommand(
                    new String[] {
                        ""mesa_config"",
                        ""wga.kdb"",
                        ""show.certs"",
                        dbName,
                        certType,
                    }, req);

            ArrayList<String> ret = WgaHelper.runCommand(commandArr);

            if(ret.get(0).equals(""0"") && ret.size() == 2) {
                // See if a range has been specified, and if one has been
                // specified we need to work out the start and end
                // points.

                int start = 0;
                int end   = 0;
                int total = 0;

                try {
                    String[] range = req.getHeader(REQ_HDR_RANGE).
                            split(""="")[1].
                            split(""-"");
                            

……………..

………….



===========================

This mesa_config is ultimately calling:

wapikdb.cpp::showCerts()

which is basically calling:

int rc = openKeyFile(dbFile, pwd, FIPS, isLocal, dbh); 

then

GSKKM_GetKeyDbLabelList(dbh, &keys)  to get the list of labels of all certificates

then in a loop,

    for (GSKKM_LabelList* key = keys; key; key = key->next) {

……..

……….

GSKKM_GetKeyItemByLabel(dbh, key->label, &item)

and

GSKKM_ExtractCertItemAttributes(
                                            dbh, key->label, &elems, &numElem);

i.e. getting the details of each label……..

…………………

……….

=============================================



It is failing in the middle……..","23/Jun/23 4:28 AM;5b15d9e581c3df12acf53c4a;LMI/Java, internally, runs the mesa_config command to get the list of all certs details in json format,

I ran the mesa_config command directly i.e.

“mesa_config wga.kdb show.certs BIG_rt_profile_keys”

It took around 9+ minutes to finish………

So, underlining functions does works, it seems that in Java, stuff getting messed up…….

Still investigating Java/LMI point of view…..will update with my findings….","27/Jun/23 6:45 AM;5b15d9e581c3df12acf53c4a;As it turns out, the ATP that I identified before i.e.

Key: cert.db.command.timeout

is NOT used in the method that LMI uses to get the details of all the certificate, so it is using default timeout which is 30 sec ( needless to say is very very small when it needs almost 12/15 minutes )….

Please do open an APAR: LMI time’s out when editing key database containing large number of certificates","08/Jul/23 1:42 AM;5b15d9a0dda5f94d06b985b3;Hi [~accountid:5b15d9e581c3df12acf53c4a] ,

Steve is out and the customer is asking for an udpate on this issue.   My concern from your last update is that if I read it correctly you seem to be looking to extend the timeout to allow it to wait longer before timing out.    However from the customer’s perspective they are saying that in version 9 this same operation took less than 5 seconds.    So they are looking to improve the response time, not extend the timeout so that they wait even longer.



Thanks","08/Jul/23 3:23 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b15d9a0dda5f94d06b985b3] 

It is impossible to load 800+ cert details in 5 or so seconds.

I do not have a ISVA 9, if you do, you can try it out,  the certificate db with 800 or so certs is attached here by Steve.

Can you try it out?

I checked the code and there are no differences in the code.

And even outside of  ISVA or LMI, you can try it out in any OS where GSKit is installed and measure it…………

I believe either this customer had a different db or with much less certs were in there….","08/Jul/23 3:28 AM;5b15d9a0dda5f94d06b985b3;[~accountid:5b15d9e581c3df12acf53c4a]  I don’t have any version 9 environment either since I upgraded to widows 11 and it won’t run on windows 11 Hyper-V.

Also, L2 doesn’t have an environment like you guys where we can download customer configs or data (like the keystores) to so even the few version 9 environments people on the team have couldn’t be used to test with the customer’s keystores.   



I can ask if the customer still has a version 9 environment they can collect data from if you want, otherwise all we know is what they are saying.

Daniel","08/Jul/23 3:40 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b15d9a0dda5f94d06b985b3] 

What I meant by DB …is not from customer, Steve created one himself with 800 or so certs in it, then imported to ISVA via LMI . Then he tried to edit, at that point LMI tries to load all these certs in GUI for editing purposes, that’s how he reproduced it.

In any case, I found that ISVA, ultimately uses GSKit API to open the db, get the list of all certs label and then goes in a loop to get the details of each label, that’s where all times got spend….

So I based my investigation on that reproduction scenario.

Only way it will be different is a scenario where it just load the key db but does not show the details of each certificate……

To investigate that scenario, I will need the following traces if not already taken:

LMI:

*com.ibm.isam.**_=ALL:com.ibm.mesa._**=ALL*

And ATP: Good old

debug.level=2

=====================================

I checked the code in 9072 and they are same as 10.0.5

I will look for earlier version like 90.x and see whether any difference………..","08/Jul/23 5:40 AM;5b15d9a0dda5f94d06b985b3;Ok thanks.   Looks like Steve is out  few more days next week, so I’ll try to see if I can find someone with a 907 system I can test with.","08/Jul/23 5:58 AM;5b15d9e581c3df12acf53c4a;So, I looked at the code for 905 and the area of the code that RAPI like this:

GET [https://appliance_hostname/isam/dojo_json_wrapper/all_cert.json?ssl_certificate_id=rt_profile_keys|https://aza01739.deluxe.com/isam/dojo_json_wrapper/all_cert.json?ssl_certificate_id=rt_profile_keys] HTTP/1.1

is traversing is same i.e. it is asking for list of certs and in lower layer, it is

loading the keyDB

then getting all the labels first

then getting the details of each cert label and converting the details in json form so we get a

big big json string with details of each cert label.

Underlying API call is basically gskit  call, so in a Linux box, if you have the key db file, you can do this:

Use GSKit command to get the list of all certs ( i.e. labels ) say test1, test2…………..test999

You can get details of all the labels in a shell loop like

for l in {{cat listOfLabels}}`

do

  gskit……..get details of a label

done

I tried, it takes around 8/9 minutes

So, only way it will be few seconds of it does not get details of each cert and only get list of all labels.

===================

So what ever customer was doing in 9XX,  probably that required only the list of certs labels or the key db did not contain lots of certs.",10/Jul/23 11:23 PM;5b15d9a0dda5f94d06b985b3;Hi [~accountid:5b15d9e581c3df12acf53c4a] Just thinking out loud…..could the performance change be related to kdb (905) vs p12 (10.0.5) ?    I have asked the customer if they still have a version 9 env kicking out that we can test with.,"11/Jul/23 1:34 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b15d9a0dda5f94d06b985b3] Oh my God, Your thinking out load nailed it, I did a quick and dirty test with kdb and p12 version of same keyDB file and my quick/dirty test results:

p12: 3.5 minutes

kdb: 5 sec

Yup, that’s the culprit.

Programmatically, it is same so I did not realize p12/kdb can make that much difference



Let me do some more digging and also I need to contact GSKit and will update as soon as I find something.","11/Jul/23 2:15 AM;5b15d9e581c3df12acf53c4a;I just sent a note to GSKit L3 mentioning the same test results i.e. 

p12  taking 3.5 min and KDB needs just 5 sec and asking for some explanation and guidance.

Will update if I hear anything.",11/Jul/23 4:13 AM;5b15d9a0dda5f94d06b985b3;Great news.   Thanks [~accountid:5b15d9e581c3df12acf53c4a] !,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Chronyd service in appliance listens on port 123,ISAMSUP-5039,297355,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,Motiur Rahman,5b15d9e581c3df12acf53c4a,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,03/May/23 1:30 PM,23/May/23 11:05 AM,14/Jul/23 2:47 PM,,,,,0,,,,"appliance chronyd service should act as client but it seems to be listening on udp port 123

 netstat -an |grep -i 123
udp        0      0 0.0.0.0:123             0.0.0.0:*
udp        0      0 :::123                  :::*





current configuration 

can we use cmdport 0

----

{noformat}# generated by mesa_config
server time.google.com iburst
# Record the rate at which the system clock gains/losses time.
driftfile /var/lib/chrony/drift

# Allow the system clock to be stepped in the first three updates
# if its offset is larger than 1 second.
makestep 1.0 3

# Enable kernel synchronization of the real-time clock (RTC).
rtcsync

# Allow NTP client access.
allow 0.0.0.0/0
allow 127.0.0.1
allow ::/0
allow ::1

# Specify the name of the file which contains the process ID.
pidfile /var/run/chronyd.pid

# Specify file containing keys for NTP authentication.
keyfile /etc/ntp.keys

# Get TAI-UTC offset and leap seconds from the system tz database.
leapsectz right/UTC

# Specify directory for log files.
logdir /var/log/chrony{noformat}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012850065,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,MONETARY AUTHORITY OF SINGAPORE (ITD),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1b40f:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,2023-05-05 20:58:42.713,,,,,"06/May/23 6:58 AM;5b15d9e581c3df12acf53c4a;This is NTP and you guys should know that it is working as per designed, it has nothing to do with ISVA appliance at all.","07/May/23 12:49 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9e581c3df12acf53c4a] 

its very clear that chronyd is NTP service.

chronyD can be configured in client mode (wherein it will connect to a remote NTP server)

also chronyd can act as NTP server.



The point I am highlighting is from Customer’s perspective

They have ISVA appliance and they have configured ISVA to sync with a remote NTP server . and for this purpose chronyd no need to listen on port123 on all interfaces

chronyd can use random port to connect to remote NTP server.



What I am requesting is to address customer’s concern about not exposing UDP port 123 on ISVA appliance.

refer here

[https://www.redhat.com/sysadmin/chrony-time-services-linux|https://www.redhat.com/sysadmin/chrony-time-services-linux|smart-link] 

and related chronyd configuration option.","09/May/23 10:11 AM;5b15d9e581c3df12acf53c4a;From:
[https://www.rfc-editor.org/rfc/rfc5905|https://www.rfc-editor.org/rfc/rfc5905#page-32]

The following configuration variables are normally initialized when
   the association is mobilized, either from a configuration file or
   upon the arrival of the first packet for an unknown association.

   srcaddr: IP address of the remote server or reference clock.  This
   becomes the destination IP address in packets sent from this
   association.

   srcport: UDP port number of the server or reference clock.  This
   becomes the destination port number in packets sent from this
   association.  *_When operating in symmetric modes (1 and 2), this field
   must contain the NTP port number PORT (123) assigned by the IANA.  In
   other modes, it can contain any number consistent with local policy._*

   dstaddr: IP address of the client.  This becomes the source IP
   address in packets sent from this association.

   dstport: *_UDP port number of the client, ordinarily the NTP port
   number PORT (123) assigned by the IANA.  This becomes the source port
   number in packets sent from this association._*

   keyid: Symmetric key ID for the 128-bit MD5 key used to generate and
   verify the MAC.  The client and server or peer can use different
   values, but they must map to the same key.

…………………..



Explanation:

In addition to ""client/server"", NTP also has a ""symmetric"" (peer-to-peer) mode. Somewhat unusually, older NTP versions use port numbers to determine which mode is being used – clients talking to servers use an ephemeral source port, but peers in symmetric mode use 123 as the source port – so inbound replies will likewise have 123 as the destination port.

It seems that some of the reasoning is more of a historical reason i.e. allowing chronyd to run as server as well as client.",22/May/23 1:26 PM;5ac57757d9a96536d1f0daa9;[~accountid:5c53d3ac23f5bf672621c868] I can see that the case has not been updated since the 4th of May though Motiur has provided an update since then. Can you please confirm if you need any additional information to move this item forwards. ,"23/May/23 11:05 AM;5c53d3ac23f5bf672621c868;HI Tony

I am working on the response from motiur to determine where in port 123 is absolutely needed on the appliance to be in listen on an external ip. 

I will update the Jira.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Webseal Instance keeps crashing (signal 11),ISAMSUP-5036,297074,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,02/May/23 7:19 PM,28/Jun/23 9:10 PM,14/Jul/23 2:47 PM,28/Jun/23 9:10 PM,10.0.6,Support,,0,,,,The webseal instance prd.mapz.zoll keeps crashing even after we installed the fix provided in the TS011288679. ,,Alan Wong,BRIANORO,David Flynn,Dermot Daly,Nick Lloyd,Prabhjeet.Multani,Surya Prakash,Syed Hasan Jafar,,,,,,,,6092aca0f0db130069d19687,6154906364ff01007106e189,614dd566a995ad0073ec0622,6092ac9ff6c0960069d47a67,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,60f541a6d0134900692d91b7,617a5f2cf485cd0068cb98af,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5056,,,,,,,,,,,,,,,,,IJ46635,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012811533,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,Informationstechnikzentrum Bund (ITZBund),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2023-05-09T15:00:27.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":5,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012811533&path=TS012811533/2023-04-21/&filepath=TS012811533/2023-04-21/isva_10.0.4.0_20230421-095653_alp62308.support,,,,,,,,,,,,,,,,,,,,,,,0|i1b2b3:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-05-03 03:56:55.814,,,,,02/May/23 7:22 PM;61409dc154762c006932ffc7;Hi [~accountid:5b15d9517dab4c51f61b5190] new apar IJ46635 raised please provide a fix soon as customer is looking for an update,"03/May/23 1:56 PM;5b15d9517dab4c51f61b5190;This is a follow on item from [https://cloudidentity.atlassian.net/browse/ISAMSUP-4647|https://cloudidentity.atlassian.net/browse/ISAMSUP-4647|smart-link] 

The IJ44960 change did not fix the issue

I have talked to gskit and am waiting their advice on another code change

The GSKIT change for ticket G3362 from the original item was shipped in gskit 8.0.55.31",05/May/23 10:54 PM;61409dc154762c006932ffc7;[~accountid:5b15d9517dab4c51f61b5190] any updates on this?,"08/May/23 5:12 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 04d8cecd9f9eb81ff596ba5c9772d0fc7f09d1ea
   * description: ISAMSUP-5036 IJ46635 Reverse proxy still crashes in Websockets shutdown

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/326144.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5036) which we publish.","09/May/23 3:00 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 14a0b7b2cd5b9e108465507197acc52b5865b53c
   * description: Merge pull request #5937 from ISAM/ISAMSUP-5036

ISAMSUP-5036 IJ46635 Reverse proxy still crashes in Websockets shutdown

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/343738.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230509045723-14a0b7b2.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","09/May/23 4:17 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 14a0b7b2cd5b9e108465507197acc52b5865b53c
   * description: Merge pull request #5937 from ISAM/ISAMSUP-5036

ISAMSUP-5036 IJ46635 Reverse proxy still crashes in Websockets shutdown

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/344515.


This build has not been published as the commit is not currently within a branch (20230509045723-14a0b7b2) which we publish.",09/May/23 7:20 PM;61409dc154762c006932ffc7;[~accountid:5b15d9517dab4c51f61b5190] client is pushing for an update do we have an expected release date?,"09/May/23 7:29 PM;5b15d9517dab4c51f61b5190;Code change was approved today

Will have a fix tomorrow",10/May/23 11:27 AM;5b15d9517dab4c51f61b5190;The fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-5056|https://cloudidentity.atlassian.net/browse/ISAMSUP-5056|smart-link] ,22/May/23 12:24 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] can you please confirm the status of this fix and if it is part of the 10.0.6 delivery? If this can we please close out the APAR and Jira item.,23/May/23 2:59 PM;5b232b2fd85e5b59b066f57f;This will be delivered in 10.0.6. APAR is closed. Closing WI. ,"09/Jun/23 9:16 PM;61409dc154762c006932ffc7;[~accountid:5b232b2fd85e5b59b066f57f]  the fix have not worked for client.even with the fixpack installed the webseal instance prd.mapz.zoll still keeps crashing with error message signal 11:

2023-06-08-11:59:57.732+02:00I----- 0x38A70022 WebSEAL-Mgmt-API ERROR wga Common AMWAChildProcessMgr.cpp 657 0x7f07f4b62700 -- WGAWA0034E The process, /opt/pdweb/bin/webseald, was terminated by the signal, 11. The process will be automatically restarted. -- IBM Security Verify Access WebSEAL Version 10.0.4.0 (Build 20220608_0037) -- Copyright (C) IBM Corporation 1994-2022. All Rights Reserved.



[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012811533&path=TS012811533/2023-06-08/&filepath=TS012811533/2023-06-08/isva_10.0.4.0_20230608-174830_alp62308.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012811533&path=TS012811533/2023-06-08/&filepath=TS012811533/2023-06-08/isva_10.0.4.0_20230608-174830_alp62308.support]",27/Jun/23 4:06 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] I think that this one needs to be reviewed as it seems that the fix may not have resolved our customers problem. Reassigning the response due field to L3. ,28/Jun/23 1:04 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9517dab4c51f61b5190] reassigning this item back to you. Can you please review [~accountid:61409dc154762c006932ffc7] comments indicating that the provided fix did not seem to resolve the customer problem. ,"28/Jun/23 9:09 PM;5b15d9517dab4c51f61b5190;We have gone back to the original Jira item for this issue

Further updates will be in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4647|https://cloudidentity.atlassian.net/browse/ISAMSUP-4647|smart-link] 

Closing this item to avoid confusion",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
JARM support.,ISAMSUP-4988,295311,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,carlos.arias,62ed8180432ef494c8cad107,carlos.arias,62ed8180432ef494c8cad107,19/Apr/23 4:13 AM,03/May/23 2:09 AM,14/Jul/23 2:47 PM,03/May/23 2:09 AM,,,,0,,,,"Customer is making call to AAC with URL: /sps/oauth/oauth20/authorize?xxx. Normally it will return either 302 or 200 self-posted form response, containing the authorization code in the URL or response payload. Is it possible to customize the response of the /authorize to send back the JARM containing the authorization code?
Do we support JARM?
[https://openid.net/specs/openid-financial-api-jarm.html|https://openid.net/specs/openid-financial-api-jarm.html|smart-link] ",,Nick Lloyd,Steve Herskowitz,Tushar Prasad,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,5af99299ae1b5f08256340f1,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012780486,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,Bank of Montreal,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1aron:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-04-18 22:39:55.202,,,,,19/Apr/23 8:39 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d954b0d76456f36daf33] can you please work with [~accountid:5af05450e6f95a2c1c89193d] to confirm this support statement for our customer. ,"19/Apr/23 9:32 AM;5b15d954b0d76456f36daf33;– Internal only --

According to [https://cloudidentity.atlassian.net/browse/ISAMDEV-9289|https://cloudidentity.atlassian.net/browse/ISAMDEV-9289|smart-link] support for JARM has been added to the OIDC OP container release version 22.12

I don’t know what our strategic direction is for the adoption of this vs implementing the same feature in ISVA. [~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5af05450e6f95a2c1c89193d] ","19/Apr/23 10:21 AM;5af05450e6f95a2c1c89193d;– Internal only --
[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5b15d954b0d76456f36daf33] Yes that is correct, the the OIDC OP supports JARM and has passed conformance. As for ISVA OAuth/OIDC we do not support JARM at this point. There may be a possibility of doing it via mapping rules/infomap/lua but that needs to be explored.","19/Apr/23 10:51 AM;5b15d954b0d76456f36daf33;Thanks [~accountid:5af05450e6f95a2c1c89193d] 

Would such possibility/exploration need to be handled as a defect by support or does it need to be dealt with as a new feature by management/development.","19/Apr/23 4:19 PM;5b15d954b0d76456f36daf33;[~accountid:62ed8180432ef494c8cad107] as you might have noticed from the discussion below:

The functionality requested  (JARM support) is available in OIDC OP container since version 22.12 : [https://docs.verify.ibm.com/ibm-security-verify-access/docs/containers#openid-connect-provider|https://docs.verify.ibm.com/ibm-security-verify-access/docs/containers#openid-connect-provider|smart-link] 

But it is +not+  available in IBM Security Verify Access and there is currently no known workaround to support this. 

So if the customer is wanting this, they might be better off creating an RFE.

----

*Please understand that the following is* +*not*+ *an official recommendation from us.* 

A similar question was asked and answered in one of the slack channels here : [https://ibm-security.slack.com/archives/C307GJRN1/p1656510613940939|https://ibm-security.slack.com/archives/C307GJRN1/p1656510613940939|smart-link] 

This is the Q & A:

{noformat}Q: Has anyone looked at implement JARM in an ISVA PostToken mapping rule?  
It feels like it should be straight-forward - are there any gaps I should be aware of?

A:
Seems doable to me. I have not done it myself, but in my opinion this should work:
- First read the response_mode, if it doesn't contain the word ""jwt"", don't do anything.
- Otherwise, create a JWT based on all context attributes of type ""urn:ibm:names:ITFIM:oauth:response:attribute"".
- After the JWT is successfully created, remove all context attributes of type ""urn:ibm:names:ITFIM:oauth:response:attribute""
- Add a context attribute name 'response', with type ""urn:ibm:names:ITFIM:oauth:response:attribute"" and value is the JWT.
- Now, the code after this only understand three response_mode: query, fragment and form_post.
  It will auto select the appropriate mode (between query vs fragment, usually) based on spec.
  Typically, if ""access_token"" or ""id_token"" attribute exists, it will output in fragment.
  But now since we removed them, we need to be explicit.
- So, we have to replace the response_mode from 'jwt', 'query.jwt', 'fragment.jwt', 'form_post.jwt' as defined in JARM spec, 
  into 'query', 'fragment' and 'form_post'. I think there is rule to follow in JARM spec of what can or cannot be done.{noformat}",19/Apr/23 11:05 PM;62ed8180432ef494c8cad107;Thanks for clarification [~accountid:5b15d954b0d76456f36daf33] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
high memory use on reverse proxies following upgrade to v10.0.4,ISAMSUP-4921,290152,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Reagan Knowles,5b15d9e44c4ed14b83af8723,Reagan Knowles,5b15d9e44c4ed14b83af8723,25/Mar/23 4:28 AM,27/Jun/23 12:00 AM,14/Jul/23 2:47 PM,27/Jun/23 12:00 AM,,,,0,Growth,,,"Customer upgraded to v10.0.4 and memory use has substantially increased on some of the reverse proxies. Customer is concerned about a memory leak. We captured two support files, both from v10.0.4, a few days apart.

March 17
{{Mem total:8151128 anon:5664644 map:121676 free:139016 slab:340272 buf:75488 cache:631660 dirty:5524 write:0 Swap total:2057212 free:1726720}}
{{  PID   VSZ VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND}}
{{ 8320 4860m  756m  397m  5956  353m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar (LMI)}}
{{28953 4456m 3573m 2144m 41960 2103m     0   124 /opt/pdweb/bin/webseald -config etc/webseald-externaltp.conf -foreground -noenv}}
{{28786 4016m 2929m 1935m 42620 1890m     0   124 /opt/pdweb/bin/webseald -config etc/webseald-externalworker.conf -foreground -noenv}}
{{ 1181 4009m 2023m  344m 27372  317m     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf}}
{{31859 3579m 1454m  444m 41280  403m     0   132 /opt/pdweb/bin/webseald -config etc/webseald-miloginapi.conf -foreground -noenv}}
{{11628 2690m  451m  189m 41136  148m     0   128 /opt/pdweb/bin/webseald -config etc/webseald-isdtp.conf -foreground -noenv}}
{{13076 2685m  420m  164m 41300  124m     0   128 /opt/pdweb/bin/webseald -config etc/webseald-isdtpuat.conf -foreground -noenv}}
{{31378 2619m  311m  109m 40544 71568     0   128 /opt/pdweb/bin/webseald -config etc/webseald-ibmverify.conf -foreground -noenv}}

March 20
{{  PID   VSZ VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND}}
{{28953 5105m 3906m 2367m 19276 2348m     0   124 /opt/pdweb/bin/webseald -config etc/webseald-externaltp.conf -foreground -noenv}}
{{ 8320 4862m  784m  403m  2080  371m     0   124 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar ...}}
{{28786 4016m 2942m 1626m 18876 1569m     0   124 /opt/pdweb/bin/webseald -config etc/webseald-externalworker.conf -foreground -noenv}}
{{ 1181 4010m 2053m  350m  7712  342m     0   132 /opt/dsc/bin/dscd -f -c /var/dsc/etc/dsc.conf}}
{{31859 3590m 1567m  535m 16844  518m     0   132 /opt/pdweb/bin/webseald -config etc/webseald-miloginapi.conf -foreground -noenv}}
{{11628 2698m  491m  189m 19752  169m     0   128 /opt/pdweb/bin/webseald -config etc/webseald-isdtp.conf -foreground -noenv}}
{{13076 2693m  460m  163m 16080  147m     0   128 /opt/pdweb/bin/webseald -config etc/webseald-isdtpuat.conf -foreground -noenv}}
{{31378 2635m  352m 99.5m 14084 87444     0   128 /opt/pdweb/bin/webseald -config etc/webseald-ibmverify.conf -foreground -noenv}}

Compared to last week, we see three reverse proxies are using substantially more memory. Deltas for the RSS column:

LMI -17m
*webseald-externaltp +352 MB*
dsc -21 MB
*webseald-externalworker +234 MB*
*webseald-miloginapi +170 MB*
webseald-isdtp -4 MB
webseald-isdtpuat +4 MB
webseald-ibmverify -9 MB

As a troubleshooting step, we disabled websockets and let the appliance run for a few days. That didn't have any noticeable effect, the memory still climbed on the reverse proxies with disabled websockets.

Customer generated a core file from the CLI and it's included in the support file:

/ecurep/sf/TS012/447/TS012447418/2023-03-24/isva_10.0.4.0_20230323-213918_hcv171eiamtwa03.support_unpack/var/support/core_webseald",,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4460,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012447418,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,State of Michigan,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19w33:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-03-30 06:19:13.679,,,,,30/Mar/23 4:22 AM;5b15d9e44c4ed14b83af8723;Customer is asking if there is an update.,"30/Mar/23 4:19 PM;5b15d9517dab4c51f61b5190;I am not convinced there is a leak

The numbers stated for the growth of  RSS  don’t match the raw numbers above them

eg {{externalworker}} goes from {{1935m}} to {{1626m}} or -309m

Having said that - I looked at the core files and they both seem to have larger counts of the string AZN_CRED_PRINCIPAL_NAME

than I would have expected - and out of line with all other AZN_CRED_ strings

So I am trying to see if there really is a leak

So concentrating on the {{externaltp}} instance

Can we get a few hours of pdweb.debug 9 trace - exercising the various authentication/stepup flows

Can we get some load run on the externaltp instance so any leak will be more pronounced - at which point generate another core file

Also since memory is tight

Regarding webseal settings

Some webseals are using the setting 

max-entries = 4096000

This is way too large and if large numbers of sessions were created it would use too much memory

On a machine with only 8GB of ram and multiple webseal instances I think a number like 4096 would be more appropriate

(but I know nothing regarding the expected user load)

Also since 10.0.3.0 ssl session cleanup has been improved so can reduce ssl cache size

So ssl-max-entries = 4096000 could be reduced say to  ssl-max-entries = 409600

Also - for every 1000 worker threads you have - you add about 256M to the process size

eg 4300 worker threads 

{noformat}~ # top -b -n1 -m | grep -e RSS -e rp1
  PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
 9149 2197m 1319m  163m 46476  115m     0   128 /opt/pdweb/bin/webseald -config etc/webseald-rp1.conf -foreground -noenv
~ {noformat}

300 worker threads

{noformat}# top -b -n1 -m | grep -e RSS -e rp1
  PID^^^VSZ^VSZRW   RSS (SHR) DIRTY (SHR) STACK COMMAND
15391 1179m  307m  108m 46252 62212     0   128 /opt/pdweb/bin/webseald -config etc/webseald-rp1.conf -foreground -noenv{noformat}

externaltp has

worker-threads = 6000

externalworker has

worker-threads = 4000","11/Apr/23 2:55 AM;5b15d9e44c4ed14b83af8723;We made suggested changes to the reverse proxies that were using the most memory. The reverse proxies ran for a week with no interruption and the problem persists.

* Screenshots of recent memory growth and support file are here:
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012447418&path=TS012447418%2F2023-04-07%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012447418&path=TS012447418%2F2023-04-07%2F]
* The customer lowered entries and threads for the reverse proxies that were previously using the most memory:

externaltp reverse proxy
max-entries = 409600 (4,096,000 previously)
ssl-max-entries = 2048000 (4,096,000 previously)
worker-threads = 2000 (6000 previously)

externalworker reverse proxy
max-entries = 40960 (4,096,000 previously)
ssl-max-entries = 2048000 (4,096,000 previously)
worker-threads - 1500 (4000 previously)

* There is a pdweb.debug trace for the externaltp reverse proxy in the March 30 support file. The pdweb.debug trace ran for a little over two hours.
* One curious item... the customer states that memory usage dropped significantly when he created the April 7 support file. Not sure if this is relevant or not. See the screenshot: [https://ecurep.mainz.de.ibm.com/ae5/#id=TS012447418&path=TS012447418%2F2023-04-07%2F&filepath=TS012447418%2F2023-04-07%2F2023-04-07_12_30_54-IBM_Security_Verify_Access_Memory_after_support_file.png|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012447418&path=TS012447418%2F2023-04-07%2F&filepath=TS012447418%2F2023-04-07%2F2023-04-07_12_30_54-IBM_Security_Verify_Access_Memory_after_support_file.png]
* Comparing the March 30 and April 7 support files, I calculated the following deltas for MB in memory.

{{Delta in MB:}}
{{ 436 -  338 =   +98m LMI}}
{{1081 - 2268 = -1187m webseald-externaltp}}
{{ 190 -  229 =   -39m DSC}}
{{1339 - 1392 =   -53m webseald-externalworker}}
{{ 401 -  560 =  +159m webseald-miloginapi}}
{{ 223 -  183 =    +71 webseald-isdtp}}
{{ 207 -  152 =    +55 webseald-isdtpuat}}
{{ 145 -  102 =    +43 webseald-ibmverify}}",11/Apr/23 2:59 AM;5b15d9e44c4ed14b83af8723;I’m asking the customer to generate a new core file for the externaltp instance when it is under the highest load of the day.,"11/Apr/23 5:32 AM;5b15d9e44c4ed14b83af8723;L3 also asked, “Can we get some load run on the externaltp instance so any leak will be more pronounced - at which point generate another core file”

Customer replied that they only get 70-100 users a day for that instance. Do you still want a core file during the busy part of the day? Even if it’s just a small number of users?","12/Apr/23 1:39 AM;5b15d9e44c4ed14b83af8723;For what it is worth, customers are discussing the issue on the Community Forum: [https://community.ibm.com/community/user/security/discussion/memory-leak-issue-in-isva-10040-if1#bm41cb38d2-b0b4-4607-be63-c6b81e97c52c|https://community.ibm.com/community/user/security/discussion/memory-leak-issue-in-isva-10040-if1#bm41cb38d2-b0b4-4607-be63-c6b81e97c52c|smart-link] ",18/Apr/23 11:13 PM;5b232b2fd85e5b59b066f57f;@phorner - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,09/May/23 9:35 PM;5b232b2fd85e5b59b066f57f;@phorner - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,12/May/23 11:49 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] can you please take a look at this one while Peter is on leave for the next few weeks. Please let [~accountid:5b232b2fd85e5b59b066f57f] and I know if we can support in anyway. ,"18/May/23 1:26 AM;5b15d9e581c3df12acf53c4a;There are also other Jira items where Customers are seeing  WebSEAL memory growth in ISVA 10.0.4.0

Bill Hannon is dealing with quite a few of these and suggesting/providing trace/log/data information instruction in  [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]

Currently, he is suspecting the issue is deep in to libc’s memory allocation mechanism, specially thread related memory allocation mechanism. 

The issue is still being investigated…..more information will come.","30/May/23 3:15 AM;5b17571b91981f4fdde632c1;* All memory leaks must be watching [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link] for common instruction
* From [https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|https://cloudidentity.atlassian.net/browse/ISAMSUP-4460|smart-link]
** 2023-04-24 L3 instruction for each {color:#bf2600}*Critical and Required* {color}section
*** Please provide current and complete status","13/Jun/23 11:16 AM;5b17571b91981f4fdde632c1;* For IBM Support only
** ssl-max-entries

{noformat}      5 [ssl]	ssl-max-entries 4096000
      5 [ssl]	ssl-max-entries 2048000
      1 [ssl]	ssl-max-entries 16000
      2 [ssl]	ssl-max-entries 4096{noformat}

* 
** max-entries

{noformat}      4 [session]	max-entries 4096000
      2 [session]	max-entries 409600
      2 [session]	max-entries 40960
      1 [session]	max-entries 16000
      4 [session]	max-entries 4096
      1 [session]	max-entries 0{noformat}

* 
** 
*** max-entries already lowered

{noformat}[session]	max-entries	0		hcv171eiamtwa03	externaltp	20200909_164658***
[session]	max-entries	4096000		hcv171eiamtwa03	externaltp	20220111_120326*
[session]	max-entries	409600		hcv171eiamtwa03	externaltp	20230331_150800

[session]	max-entries	4096 [default]		hcv171eiamtwa03	externalworker	20200909_164658***
[session]	max-entries	4096000		hcv171eiamtwa03	externalworker	20220128_171259*
[session]	max-entries	40960		hcv171eiamtwa03	externalworker	20230331_150652

[session]	max-entries	4096 [default]		hcv171eiamtwa03	ibmverify	20200909_164657***

[session]	max-entries	4096 [default]		hcv171eiamtwa03	isdtp	20200909_164657***
[session]	max-entries	4096000		hcv171eiamtwa03	isdtp	20220128_171235*
[session]	max-entries	409600		hcv171eiamtwa03	isdtp	20230331_150820

[session]	max-entries	4096 [default]		hcv171eiamtwa03	isdtpuat	20200909_164658***
[session]	max-entries	4096000		hcv171eiamtwa03	isdtpuat	20220128_171315*
[session]	max-entries	40960		hcv171eiamtwa03	isdtpuat	20230331_150712

[session]	max-entries	16000		hcv171eiamtwa03	miloginapi	20200909_164657***{noformat}","27/Jun/23 12:00 AM;5b15d9e44c4ed14b83af8723;State of Michigan added more memory to their appliances, ran a performance test and noticed no significant memory growth. They are aware that other customers reported memory leaks. State of Michigan is content to just wait it out and restart the reverse proxies if necessary. They closed the Salesforce case, so I am also closing this Jira.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unable to upgrade from 10.0.4.0 to 10.0.5.0 using APIs,ISAMSUP-4909,289639,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,carlos.arias,62ed8180432ef494c8cad107,carlos.arias,62ed8180432ef494c8cad107,23/Mar/23 4:36 AM,23/May/23 1:25 AM,14/Jul/23 2:47 PM,07/Apr/23 6:07 AM,,,,0,,,,"Customer is trying to upgrade ISVA from 10.0.4.0 to 10.0.5.0 using APIs, but he’s having the following error:

{""result"":""Required parameters are missing.""}



Customer is using the following command:

curl -k -X POST -H ""accept:application/json"" -u 'admin@local:pswd!' -d '{""updates"":[{""type"":""firmware"",""version"":""10.0.5.0""}]}' [https://host/updates/available/install|https://host/updates/available/install]



As per the documentation should be like:

[https://www.ibm.com/docs/api/v1/content/SSPREK_10.0.4/com.ibm.isva.doc/develop/rapi/Install_an_update_package.xml|https://www.ibm.com/docs/api/v1/content/SSPREK_10.0.4/com.ibm.isva.doc/develop/rapi/Install_an_update_package.xml]

Refer to Manage: System Settings> Updates and Licensing> Available Updates> Install an update package

curl -k -X POST  -H ""accept:application/json"" -u admin:admin -d {""updates"":[{""type"":""firmware"",""version"":""10.0.5.0""}]} [https://172.26.205.158/updates/available/install|https://172.26.205.158/updates/available/install]



I tested in my environment:

C:\Users\004994659>curl -k -X POST  -H ""accept:application/json"" -u admin:admin -d {""updates"":[{""type"":""firmware"",""version"":""10.0.5.0""}]} [https://172.26.205.158/updates/available/install|https://172.26.205.158/updates/available/install] -v
Note: Unnecessary use of -X or --request, POST is already inferred.

* Trying 172.26.205.158:443...
* Connected to 172.26.205.158 (172.26.205.158) port 443 (#0)
* schannel: disabled automatic use of client certificate
* schannel: using IP address, SNI is not supported by OS.
* ALPN: offers http/1.1
* ALPN: server did not agree on a protocol. Uses default.
* Server auth using Basic with user 'admin'

{quote}POST /updates/available/install HTTP/1.1
Host: 172.26.205.158
Authorization: Basic YWRtaW46YWRtaW4=
User-Agent: curl/7.83.1
accept:application/json
Content-Length: 44
Content-Type: application/x-www-form-urlencoded{quote}

* schannel: server closed the connection
* Mark bundle as not supporting multiuse
< HTTP/1.1 400 Bad Request
< X-FRAME-OPTIONS: SAMEORIGIN
< Cache-Control: no-cache, no-store
< Content-Security-Policy: default-src 'self' 'unsafe-inline' 'unsafe-eval'
< X-Content-Type-Options: nosniff
< X-XSS-Protection: 1; mode=block
< Pragma: no-cache
< Content-Type: application/json
< Content-Language: en-US
< Strict-Transport-Security: max-age=31536000; includeSubDomains
< Set-Cookie: LtpaToken2=8LRPEeDf2kgXJ1iJInxN0s4oz7aCJLr+QuKPc0ukd0CLZp0IQJ3AqCeq47m3JZWw2CBLPFx3hg6b9whEa/Vi7xOfdck5r0uSdNLbk6gCWINKtKy1GdF9HGte4gFAGPM9KSGmAHH3vnHcpktDvBH7VUDL3z8ipskhq3tNBjKS6ZEuaMHdYIZTx+Vh6BF4ko6sVBZxxhps/OqdnFeet9Cn5CRQpfdsod41L9RJH1UM4ih1WQUnaLJ4bjTfCtW4CcWnXjJ19jZmVv/pxUFs5rXwYe/qivKW3D0BGPqTkL2+m/zFVpLoFcvn4PZ+chTl7pqy; Path=/; Secure; HttpOnly; SameSite=Strict
< Set-Cookie: JSESSIONID=0000Yxa2Gcu9F-fYcax5w4YTnv7:ae19d8ba-b5bf-493d-aed7-15bf8bbe42c0; Path=/; Secure; HttpOnly; SameSite=Strict
< Transfer-Encoding: chunked
< Connection: Close
< Date: Wed, 22 Mar 2023 14:01:59 GMT
< Expires: Thu, 01 Dec 1994 16:00:00 GMT
<
{""result"":""Required parameters are missing.""}* Closing connection 0
* schannel: shutting down SSL/TLS connection with 172.26.205.158 port 443



I previously confirmed that pkg file is available:

C:\Users\004994659> curl -k -X GET  -H ""accept:application/json"" -u  admin:admin [https://172.26.205.158/updates/available|https://172.26.205.158/updates/available]
[{""id"":0,""name"":""isva"",""type"":""firmware"",""state"":""idle"",""schedule_date"":null,""iso_scheduled_date"":null,""release_date"":""2022-11-29-1716"",""version"":""10.0.5.0"",""expired_install"":false}]



Also, ATP for update from10.0.4.0 to 10.0.5.0 is set to “true” 

From logs there’s not relevant information.

Upgrade is not working as per documentation.",,carlos.arias,khansen,Nick Lloyd,Steve Herskowitz,Tushar Prasad,,,,,,,,,,,62ed8180432ef494c8cad107,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5af99299ae1b5f08256340f1,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,23/Mar/23 4:39 AM;62ed8180432ef494c8cad107;curl -k -X POST  -H acceptapplicati.txt;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191930,23/Mar/23 4:37 AM;62ed8180432ef494c8cad107;image-20230322-183738.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191929,23/Mar/23 10:40 PM;62ed8180432ef494c8cad107;image-20230323-123915.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/192140,24/Mar/23 6:08 AM;62ed8180432ef494c8cad107;image-20230323-200827.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/192247,25/Mar/23 1:25 AM;62ed8180432ef494c8cad107;image-20230324-152510.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/192521,25/Mar/23 1:23 AM;62ed8180432ef494c8cad107;messages.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/192519,25/Mar/23 1:25 AM;62ed8180432ef494c8cad107;trace.log;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/192522,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS012482759,TS013003057",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,US DEPT OF HOMELAND SECURITY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19sxj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-22 20:35:12.152,,,,,"23/Mar/23 4:37 AM;62ed8180432ef494c8cad107;!image-20230322-183738.png|width=824,height=472!","23/Mar/23 4:39 AM;62ed8180432ef494c8cad107;[^curl -k -X POST  -H acceptapplicati.txt]

I’m attaching different tests I have done with different commands in my test environment.","23/Mar/23 6:35 AM;5b15d94b6256d01ad54eb020;It’s looking for the release_date

If you’re not sure what that should be:

curl -k -u admin:pwd -H ""Accept: application/json"" -X GET [https://myhost/updates/available|https://192.168.124.93/updates/available]

You will get a response something like:

[{""id"":0,""name"":""isva"",""type"":""firmware"",""filename"":""isva_10.0.5.0_20221129-1716.pkg"",""release_date"":""2022-11-29-1716"",""version"":""10.0.5.0""}]","23/Mar/23 7:24 AM;5b15d94b6256d01ad54eb020;There is an additional field you need and that’s ‘name’     

You should include:   name,  type, version and release_date

curl -k -X POST -H ""accept:application/json"" -u 'admin@local:pswd!' -d '{""updates"":[{“name”:”isva”,""type"":""firmware"",""version"":""10.0.5.0"",""release_date"":""2022-11-29-1716""}]}' [https://host/updates/available/install|https://host/updates/available/install] ","23/Mar/23 10:40 PM;62ed8180432ef494c8cad107;!image-20230323-123915.png|width=758,height=201!

I run a couple of tests, but it doesn’t work","24/Mar/23 12:40 AM;62ed8180432ef494c8cad107;My last test:

C:\Users\004994659>curl -k -X GET  -H ""accept:application/json"" -u  admin:admin [https://172.18.216.211/updates/available|https://172.18.216.211/updates/available]
[{""id"":0,""name"":""isva"",""type"":""firmware"",""state"":""idle"",""schedule_date"":null,""iso_scheduled_date"":null,""release_date"":""2022-11-29-1716"",""version"":""10.0.5.0"",""expired_install"":false}]
C:\Users\004994659>curl -k -X POST -H ""accept:application/json"" -u  admin:admin -d '{""updates"":[{“name”:”isva”,""type"":""firmware"",""version"":""10.0.5.0"",""release_date"":""2022-11-29-1716""}]}' [https://172.18.216.211/updates/available/install|https://172.18.216.211/updates/available/install] -v
Note: Unnecessary use of -X or --request, POST is already inferred.

* Trying 172.18.216.211:443...
* Connected to 172.18.216.211 (172.18.216.211) port 443 (#0)
* schannel: disabled automatic use of client certificate
* schannel: using IP address, SNI is not supported by OS.
* ALPN: offers http/1.1
* ALPN: server did not agree on a protocol. Uses default.
* Server auth using Basic with user 'admin'

{quote}POST /updates/available/install HTTP/1.1
Host: 172.18.216.211
Authorization: Basic YWRtaW46YWRtaW4=
User-Agent: curl/7.83.1
accept:application/json
Content-Length: 89
Content-Type: application/x-www-form-urlencoded{quote}

* Mark bundle as not supporting multiuse
< HTTP/1.1 400 Bad Request
< X-FRAME-OPTIONS: SAMEORIGIN
< Cache-Control: no-cache, no-store
< Content-Security-Policy: default-src 'self' 'unsafe-inline' 'unsafe-eval'
< X-Content-Type-Options: nosniff
< X-XSS-Protection: 1; mode=block
< Pragma: no-cache
< Content-Type: application/json
< Content-Language: en-US
< Strict-Transport-Security: max-age=31536000; includeSubDomains
< Set-Cookie: LtpaToken2=B1tlRYKgs82xjD06vttSr2cf9T3XutqlX43D7dSEZQ+anTDS1nhdBY4HtDQWMHng2P0Vksm26Hxt/P9dezdtJMEMKr3W39SdloIAO14QAMdKSjkl3tK7bpoyJo5WJnIsHS5pDYvJaeRtDWBUKh5hwZQZlEAghNt4hCYfR9WEhoc/m+XVWAK+HvehtnaWbJ+EUtbFzoJigV0Y5gnE62pBT8hSXrDDcyx6IXfWUoRQIOLjIvbqFGREmJ6PiZBs7Ks1d0p9g7ABxgqIDI77CcePHm5MztDWt74rILixIpmoeDiZ2pPX4vdDBRG2LIxtMKaU; Path=/; Secure; HttpOnly; SameSite=Strict
< Set-Cookie: JSESSIONID=0000zTLWxMo6UnmHI1bDH85fum4:b0c309ad-eedb-48dc-94c4-6b092776477e; Path=/; Secure; HttpOnly; SameSite=Strict
< Transfer-Encoding: chunked
< Connection: Close
< Date: Thu, 23 Mar 2023 14:33:41 GMT
< Expires: Thu, 01 Dec 1994 16:00:00 GMT
<
[""Name: invalid JSON""]* schannel: server closed the connection
* Closing connection 0
* schannel: shutting down SSL/TLS connection with 172.18.216.211 port 443



Logs from ISAM:

Mar 23 08:29:07 mesa_config[28316]: GLGSY0020I:: GLG_events:: |user=admin|
Mar 23 08:29:07 mesa_config[28316]: GLGSY0103I:: GLG_events:: |user=admin,host=172.18.208.1|
Mar 23 08:29:07 mesa_config[28409]: Error: WGAWA0050E   The requested configuration data was not found.
Mar 23 08:33:40 mesa_config[29603]: Error: WGAWA0050E   The requested configuration data was not found.
Mar 23 08:33:41 mesa_config[29656]: Last message repeated 5 times
Mar 23 08:34:13 mesa_config[29785]: Warning: Ignoring invalid tuning parameter at line 291
Mar 23 08:34:16 mesa_config[29811]: Last message repeated 3 times
Mar 23 08:34:21 mesa_config[29878]: Displaying list of support categories
Mar 23 08:34:21 mesa_config[29896]: Displaying instances for category: wrp
Mar 23 08:34:21 mesa_config[29914]: Displaying instances for category: aac_federation_artifacts
Mar 23 08:34:24 mesa_config[29935]: Creating support info: /tmp/tmp.sLtavZ
Mar 23 08:34:24 su: + none root:www-data
Mar 23 08:34:37 mesa_config[29935]: Error: create_support_info: No instance exists for category: wrp","24/Mar/23 4:40 AM;5b15d94b6256d01ad54eb020;One reason for the “Required parameters are missing”  was the wrong quotes were being used on some of the parameters.  

“name”:”isva”  vs   ""name"":""isva""

That was hard to see. Fixing that eliminated the error for me.

This is the exact command I used except for the passwd and ip address and it works.

curl -k -X POST -H ""accept:application/json"" -u  admin:pwd -d '{""updates"":[{""name"":""isva"",""type"":""firmware"",""version"":""10.0.5.0"",""release_date"":""2022-11-29-1716""}]}' [https://<myhost>/updates/available/install|https://192.168.124.93/updates/available/install]



So there is nothing wrong with the REST API. It is used internally as well .","24/Mar/23 6:08 AM;62ed8180432ef494c8cad107;I just changed the password and IP address, but it didn’t work. I’ll check the logs.

!image-20230323-200827.png|width=1887,height=138!","24/Mar/23 11:53 PM;62ed8180432ef494c8cad107;I tried today again and here’re the errors:
Mar 24 06:55:45 iss-lum[1443]: GLGTC0003E:: GLG_events:: |protocol=TLS,entity=Update Server,[host=ibmxpu.flexnetoperations.com|http://host=ibmxpu.flexnetoperations.com],reason=Connection failed|
Mar 24 06:55:45 iss-lum[1443]: GLGUP1012E:: GLG_events:: ||
Mar 24 06:55:45 iss-lum[1443]: id=update time=""2023-03-24 06:55:45"" fw=ISVA2.0 pri=3 op=discover issueid=7000003 name=Update_Error msg=""Unable to download the primary update catalog file. Reason: Unknown error 2001 [ID=2001]""
Mar 24 06:55:45 iss-lum[1443]: GLGUP1013E:: GLG_events:: |file=/var/spool/updates/isva_10.0.5.0_20221129-1716.pkg|
Mar 24 07:28:07 kernel: hv_balloon: Balloon request will be partially fulfilled. Balloon floor reached.
Mar 24 07:44:06 mesa_config[13145]: GLGSY0020I:: GLG_events:: |user=admin|
Mar 24 07:44:06 mesa_config[13145]: GLGSY0103I:: GLG_events:: |user=admin,host=172.18.208.1|
Mar 24 07:44:06 mesa_config[13238]: Error: WGAWA0050E   The requested configuration data was not found.
Mar 24 07:44:07 mesa_config[13292]: Last message repeated 5 times
Mar 24 07:44:14 mesa_config[13318]: GLGSY0020I:: GLG_events:: |user=admin|
Mar 24 07:44:14 mesa_config[13318]: GLGSY0103I:: GLG_events:: |user=admin,host=172.18.208.1|
Mar 24 07:44:15 mesa_config[13340]: Warning: Ignoring invalid tuning parameter at line 291
Mar 24 07:44:15 mesa_config[13340]: Last message repeated 1 times
Mar 24 07:44:22 www-data: GLGSI1003I:: GLG_events:: |file=isva_10.0.4.0_20230323-071006_ISVA2.0.support,interface=LMI,user=admin|
Mar 24 07:44:22 www-data: GLGSI1003I:: GLG_events:: |file=isva_10.0.4.0_20230323-083424_ISVA2.0.support,interface=LMI,user=admin|
Mar 24 07:44:22 mesa_config[13520]: Warning: Ignoring invalid tuning parameter at line 291
Mar 24 07:44:28 mesa_config[13568]: Last message repeated 3 times
Mar 24 07:44:28 mesa_config[13757]: Error: WGAWA0050E   The requested configuration data was not found.
Mar 24 07:45:02 mesa_config[13987]: Discovering local updates
Mar 24 07:45:02 mesa_config[13987]: Warning: Discover local updates status unknown
Mar 24 07:45:02 mesa_config[14003]: Discovering local updates
Mar 24 07:45:02 mesa_config[14003]: Warning: Discover local updates status unknown
Mar 24 07:45:02 mesa_config[13997]: Warning: Ignoring invalid tuning parameter at line 291
Mar 24 07:45:02 mesa_config[13997]: Last message repeated 1 times
Mar 24 07:45:02 mesa_config[14030]: Error: WGAWA0050E   The requested configuration data was not found.
Mar 24 07:46:45 mesa_config[14918]: Last message repeated 21 times
Mar 24 07:47:03 mesa_config[14996]: Warning: Ignoring invalid tuning parameter at line 291
Mar 24 07:47:03 mesa_config[14996]: Last message repeated 1 times
Mar 24 07:47:04 mesa_config[15044]: Displaying list of support categories
Mar 24 07:47:04 mesa_config[15062]: Displaying instances for category: wrp
Mar 24 07:47:05 mesa_config[15080]: Displaying instances for category: aac_federation_artifacts
Mar 24 07:47:07 mesa_config[15101]: Creating support info: /tmp/tmp.IJY3Ri
Mar 24 07:47:07 su: + none root:www-data
Mar 24 07:47:22 mesa_config[15101]: Error: create_support_info: No instance exists for category: wrp



Not sure what the following mean:

Mar 24 07:44:28 mesa_config[13757]: Error: WGAWA0050E   The requested configuration data was not found.
Mar 24 07:45:02 mesa_config[13987]: Discovering local updates
Mar 24 07:45:02 mesa_config[13987]: Warning: Discover local updates status unknown



I just copied the command and changed the password and IP address, no more changes and still having this problem.","25/Mar/23 12:40 AM;5b15d94b6256d01ad54eb020;

Like yesterday first  run:  curl -k -X GET  -H ""accept:application/json"" -u  admin:admin [https://172.18.216.211/updates/available|https://172.18.216.211/updates/available]

That way you can be sure the update is found.

Then run:

curl -k -X POST -H ""accept:application/json"" -u  admin:pwd -d '{""updates"":[{""name"":""isva"",""type"":""firmware"",""version"":""10.0.5.0"",""release_date"":""2022-11-29-1716""}]}' <[https://<myhost>/updates/available/install>|https://<myhost>/updates/available/install>]



You need to also check the  LMI logs  

“Application log files”->management_ui->messages.log   and /or trace.log","25/Mar/23 12:42 AM;62ed8180432ef494c8cad107;Refer to the image provided, I did that. You should be able to see both commands in the same screenshot","25/Mar/23 1:06 AM;5b15d94b6256d01ad54eb020;Can you copy/paste the text rather screen shots?   If it’s invalid json then it’s either a quoting problem or an unmatched brace. I can’t really tell from the screen shot.

Check the messages/trace file  or send it in.","25/Mar/23 1:18 AM;62ed8180432ef494c8cad107;To validate upgrade is available:

C:\Users\004994659>curl -k -X GET  -H ""accept:application/json"" -u  admin:admin [https://172.18.216.211/updates/available|https://172.18.216.211/updates/available]
[{""id"":0,""name"":""isva"",""type"":""firmware"",""state"":""idle"",""schedule_date"":null,""iso_scheduled_date"":null,""release_date"":""2022-11-29-1716"",""version"":""10.0.5.0"",""expired_install"":false}]



Upgrade:
C:\Users\004994659>curl -k -X POST -H ""accept:application/json"" -u  admin:admin -d '{""updates"":[{""name"":""isva"",""type"":""firmware"",""version"":""10.0.5.0"",""release_date"":""2022-11-29-1716""}]}' [https://172.18.216.211/updates/available/install|https://172.18.216.211/updates/available/install]
[""Name: invalid JSON""]","25/Mar/23 1:23 AM;62ed8180432ef494c8cad107;Error from test today in message logs:

478       [3/24/23, 7:46:45:225 CST] 000003b4 com.ibm.mesa.json.Json                                       E Could not parse JSON Syntax error
479       [3/24/23, 7:46:45:229 CST] 000003b4 com.ibm.mesa.json.Json                                       E com.google.gson.JsonSyntaxException: java.lang.IllegalStateException: Expected BEGIN_OBJECT but was STRING at line 1 column 2 path $
480       com.google.gson.JsonSyntaxException: java.lang.IllegalStateException: Expected BEGIN_OBJECT but was STRING at line 1 column 2 path $
481       	at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:225)
482       	at com.google.gson.Gson.fromJson(Gson.java:991)
483       	at com.google.gson.Gson.fromJson(Gson.java:956)
484       	at com.google.gson.Gson.fromJson(Gson.java:905)
485       	at com.google.gson.Gson.fromJson(Gson.java:876)
486       	at com.ibm.mesa.json.Json.fromJson(Json.java:156)
487       	at com.ibm.mesa.feature.available_updates.AvailableUpdates.doRestPost(AvailableUpdates.java:425)
488       	at com.ibm.mesa.servlet.MesaServlet.routeRestRequest(MesaServlet.java:802)
489       	at com.ibm.mesa.servlet.MesaServlet.routeRequest(MesaServlet.java:663)
490       	at com.ibm.mesa.servlet.MesaServlet.service(MesaServlet.java:164)
491       	at javax.servlet.http.HttpServlet.service(HttpServlet.java:791)
492       	at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1258)
493       	at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:746)
494       	at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:443)
495       	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.invokeTarget(WebAppFilterChain.java:183)
496       	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:94)
497       	at com.ibm.isam.core.security_filter.SecurityFilter.doFilter(SecurityFilter.java:235)
498       	at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:201)
499       	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:91)
500       	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:1002)
501       	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1140)
502       	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1011)
503       	at com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.dispatch(WebAppRequestDispatcher.java:1411)
504       	at com.ibm.ws.webcontainer.webapp.WebAppRequestDispatcher.forward(WebAppRequestDispatcher.java:172)
505       	at com.ibm.isam.wga.fwd.WgaRedirect.service(WgaRedirect.java:165)
506       	at javax.servlet.http.HttpServlet.service(HttpServlet.java:791)
507       	at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1258)
508       	at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:746)
509       	at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:443)
510       	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.invokeTarget(WebAppFilterChain.java:183)
511       	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:94)
512       	at com.ibm.isam.core.security_filter.SecurityFilter.doFilter(SecurityFilter.java:235)
513       	at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:201)
514       	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:91)
515       	at com.ibm.isam.core.tenant_filter.TenantFilter.doFilter(TenantFilter.java:262)
516       	at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:201)
517       	at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:91)
518       	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:1002)
519       	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1140)
520       	at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1011)
521       	at com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleRequest(CacheServletWrapper.java:75)
522       	at com.ibm.ws.webcontainer40.servlet.CacheServletWrapper40.handleRequest(CacheServletWrapper40.java:85)
523       	at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:938)
524       	at com.ibm.ws.webcontainer.osgi.DynamicVirtualHost$2.run(DynamicVirtualHost.java:279)
525       	at com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink$TaskWrapper.run(HttpDispatcherLink.java:1159)
526       	at com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink.wrapHandlerAndExecute(HttpDispatcherLink.java:428)
527       	at com.ibm.ws.http.dispatcher.internal.channel.HttpDispatcherLink.ready(HttpDispatcherLink.java:387)
528       	at com.ibm.ws.http.channel.internal.inbound.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:566)
529       	at com.ibm.ws.http.channel.internal.inbound.HttpInboundLink.handleNewRequest(HttpInboundLink.java:500)
530       	at com.ibm.ws.http.channel.internal.inbound.HttpInboundLink.processRequest(HttpInboundLink.java:360)
531       	at com.ibm.ws.http.channel.internal.inbound.HttpInboundLink.ready(HttpInboundLink.java:327)
532       	at com.ibm.ws.channel.ssl.internal.SSLConnectionLink.determineNextChannel(SSLConnectionLink.java:1100)
533       	at com.ibm.ws.channel.ssl.internal.SSLConnectionLink$MyReadCompletedCallback.complete(SSLConnectionLink.java:675)
534       	at com.ibm.ws.channel.ssl.internal.SSLReadServiceContext$SSLReadCompletedCallback.complete(SSLReadServiceContext.java:1824)
535       	at com.ibm.ws.tcpchannel.internal.WorkQueueManager.requestComplete(WorkQueueManager.java:504)
536       	at com.ibm.ws.tcpchannel.internal.WorkQueueManager.attemptIO(WorkQueueManager.java:574)
537       	at com.ibm.ws.tcpchannel.internal.WorkQueueManager.workerRun(WorkQueueManager.java:958)
538       	at com.ibm.ws.tcpchannel.internal.WorkQueueManager$Worker.run(WorkQueueManager.java:1047)
539       	at com.ibm.ws.threading.internal.ExecutorServiceImpl$RunnableWrapper.run(ExecutorServiceImpl.java:238)
540       	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
541       	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
542       	at java.base/java.lang.Thread.run(Unknown Source)
543       Caused by: java.lang.IllegalStateException: Expected BEGIN_OBJECT but was STRING at line 1 column 2 path $
544       	at com.google.gson.stream.JsonReader.beginObject(JsonReader.java:385)
545       	at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:214)
546       	... 61 more
547       
548       [3/24/23, 7:46:45:230 CST] 000003b4 com.ibm.mesa.feature.available_updates.AvailableUpdates      E com.ibm.mesa.validators.ValidationException: errors:[Name: invalid JSON]
549       [3/24/23, 9:18:23:831 CST] 000003b0 com.ibm.ws.webcontainer.servlet                              I SRVE0242I: [isam] [/isam] [ApplicationLogs]: Initialization successful.","25/Mar/23 1:25 AM;62ed8180432ef494c8cad107;!image-20230324-152510.png|width=1462,height=572!

Same in trace logs. attaching as well.",25/Mar/23 1:31 AM;5b15d94b6256d01ad54eb020;The json looks correct.  I wonder if windows is messing it up somehow.  Can you try the rest call from Linux?,"25/Mar/23 4:35 AM;62ed8180432ef494c8cad107;Following commands worked for customer.



Please try the following command to validate that version is available:

curl -k -X GET -H ""accept:application/json"" -u admin:admin [https://<host>/updates/available|https://%3Chost%3E/updates/available]



Then run the upgrade command using the values from previous one:

curl -k -X POST -H ""accept:application/json"" -u admin:admin -d '{""updates"":[{""name"":""isva"",""type"":""firmware"",""version"":""10.0.5.0"",""release_date"":""2022-11-29-1716""}]}' [https://<host>/updates/available/install|https://%3Chost%3E/updates/available/install]



Closing jira","25/Mar/23 4:44 AM;5bac25aaabfcbf73d13e733b;This seems to be a documentation APAR [~accountid:5b15d94b6256d01ad54eb020] ,

The documented API is here:
[https://www.ibm.com/docs/api/v1/content/SSPREK_10.0.4/com.ibm.isva.doc/develop/rapi/Install_an_update_package.xml|https://www.ibm.com/docs/api/v1/content/SSPREK_10.0.4/com.ibm.isva.doc/develop/rapi/Install_an_update_package.xml]

The example payload and the structure don’t indicate that you need to include the ‘name’ parameter.

Not sure when that changed but the documentation almost looks like it used to work but the API itself changed.","25/Mar/23 4:57 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25aaabfcbf73d13e733b] Jack, I agree.   The docs only list two of the 4 required parameters.

Please open a doc APAR",07/Apr/23 6:07 AM;5b15d94b6256d01ad54eb020;The case is closed.  Closing Jira.,23/May/23 1:25 AM;614dd566a995ad0073ec0622;[~accountid:5b15d94b6256d01ad54eb020] [~accountid:62ed8180432ef494c8cad107] Any apar opened for this?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Memory access after free during reverse proxy shutdown,ISAMSUP-4897,288198,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,Peter Horner,5b15d9517dab4c51f61b5190,20/Mar/23 1:19 PM,22/Mar/23 8:59 AM,14/Jul/23 2:47 PM,22/Mar/23 8:59 AM,10.0.6,Support,,0,,,,"Internal  - found during testing

RateLimiting code tries to trace shutdown

But trace system has already been shutdown

Valgrind shows following

{noformat}==30642== Invalid read of size 4
==30642==    at 0x50C5640: RateLimitTrace::trace(unsigned int, char const*, unsigned int, char const*, ...) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x50CB931: rate_limiting_config_thread (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x7EFA179: start_thread (in /lib64/libpthread-2.28.so)
==30642==    by 0x8B3DDF2: clone (in /lib64/libc-2.28.so)
==30642==  Address 0x15d63998 is 8 bytes inside a block of size 888 free'd
==30642==    at 0x4C39021: operator delete(void*) (vg_replace_malloc.c:923)
==30642==    by 0x5FEFC12: ZArrayList::removeAll() (in /opt/PolicyDirector/lib/libpdz.so)
==30642==    by 0x5FEFC70: ZArrayList::~ZArrayList() (in /opt/PolicyDirector/lib/libpdz.so)
==30642==    by 0x5FEFC98: ZArrayList::~ZArrayList() (in /opt/PolicyDirector/lib/libpdz.so)
==30642==    by 0xC08123E: PDTraceComponent::~PDTraceComponent() (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC0812E8: PDTraceComponent::~PDTraceComponent() (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC07FB75: pd_trace_unregister_component (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0x8E1188B: ws_stats_http_cleanup (in /opt/pdweb/lib/libwsstats.so)
==30642==    by 0x8E12BC2: ws_stats_cleanup (in /opt/pdweb/lib/libwsstats.so)
==30642==    by 0x509B81D: WebSEALMgr::doCleanup(unsigned long&) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x4F45E7E: PDWIVServer::cleanup(unsigned long&) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x4024B7: main (in /opt/pdweb/bin/vgwebseald)
==30642==  Block was alloc'd at
==30642==    at 0x4C368C3: operator new(unsigned long) (vg_replace_malloc.c:422)
==30642==    by 0xC081880: PDTraceComponent::clone() const (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0x5FEF756: ZArrayList::add(ZObject const*) (in /opt/PolicyDirector/lib/libpdz.so)
==30642==    by 0xC082835: PDTraceComponentTree::addComponent(ZStringTokenizer&, pd_trace_component_public**, PDTraceComponent*, unsigned int) (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC0827D6: PDTraceComponentTree::addComponent(ZStringTokenizer&, pd_trace_component_public**, PDTraceComponent*, unsigned int) (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC0831B2: PDTraceComponentTree::addComponent(char const*, pd_trace_component_public**, unsigned int) (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC07F828: pd_trace_register_component (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0x50C2477: RateLimit::initialize(unsigned long, char const*, bool, char*, int) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x4FC6F24: read_config(char const*) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x4FC90F3: config_setup (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x509C2D7: WebSEALMgr::loadConfig(unsigned long&) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x509E3EF: WebSEALMgr::doInit(unsigned long&) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==
{noformat}

{noformat}==30642== Invalid read of size 4
==30642==    at 0x50C5640: RateLimitTrace::trace(unsigned int, char const*, unsigned int, char const*, ...) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x50C2BF3: RateLimit::~RateLimit() (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x8A7B036: __cxa_finalize (in /lib64/libc-2.28.so)
==30642==    by 0x4F451B6: ??? (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x400FC95: _dl_fini (in /lib64/ld-2.28.so)
==30642==    by 0x8A7AB0B: __run_exit_handlers (in /lib64/libc-2.28.so)
==30642==    by 0x8A7AC3F: exit (in /lib64/libc-2.28.so)
==30642==    by 0x8A64499: (below main) (in /lib64/libc-2.28.so)
==30642==  Address 0x15d63998 is 8 bytes inside a block of size 888 free'd
==30642==    at 0x4C39021: operator delete(void*) (vg_replace_malloc.c:923)
==30642==    by 0x5FEFC12: ZArrayList::removeAll() (in /opt/PolicyDirector/lib/libpdz.so)
==30642==    by 0x5FEFC70: ZArrayList::~ZArrayList() (in /opt/PolicyDirector/lib/libpdz.so)
==30642==    by 0x5FEFC98: ZArrayList::~ZArrayList() (in /opt/PolicyDirector/lib/libpdz.so)
==30642==    by 0xC08123E: PDTraceComponent::~PDTraceComponent() (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC0812E8: PDTraceComponent::~PDTraceComponent() (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC07FB75: pd_trace_unregister_component (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0x8E1188B: ws_stats_http_cleanup (in /opt/pdweb/lib/libwsstats.so)
==30642==    by 0x8E12BC2: ws_stats_cleanup (in /opt/pdweb/lib/libwsstats.so)
==30642==    by 0x509B81D: WebSEALMgr::doCleanup(unsigned long&) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x4F45E7E: PDWIVServer::cleanup(unsigned long&) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x4024B7: main (in /opt/pdweb/bin/vgwebseald)
==30642==  Block was alloc'd at
==30642==    at 0x4C368C3: operator new(unsigned long) (vg_replace_malloc.c:422)
==30642==    by 0xC081880: PDTraceComponent::clone() const (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0x5FEF756: ZArrayList::add(ZObject const*) (in /opt/PolicyDirector/lib/libpdz.so)
==30642==    by 0xC082835: PDTraceComponentTree::addComponent(ZStringTokenizer&, pd_trace_component_public**, PDTraceComponent*, unsigned int) (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC0827D6: PDTraceComponentTree::addComponent(ZStringTokenizer&, pd_trace_component_public**, PDTraceComponent*, unsigned int) (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC0831B2: PDTraceComponentTree::addComponent(char const*, pd_trace_component_public**, unsigned int) (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0xC07F828: pd_trace_register_component (in /opt/PolicyDirector/lib/libamaudutl.so)
==30642==    by 0x50C2477: RateLimit::initialize(unsigned long, char const*, bool, char*, int) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x4FC6F24: read_config(char const*) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x4FC90F3: config_setup (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x509C2D7: WebSEALMgr::loadConfig(unsigned long&) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==    by 0x509E3EF: WebSEALMgr::doInit(unsigned long&) (in /opt/pdweb/lib/libwsdaemon.so)
==30642==
{noformat}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,None,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-03-22T08:58:06.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19jf3:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-20 04:53:23.812,,,,,"20/Mar/23 2:53 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f40b14f43046f723a046c0066d5863be2c91bca4
   * description: ISAMSUP-4897 Memory access after free during reverse proxy shutdown

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86991097.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4897) which we publish.","21/Mar/23 3:23 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a4a892d7e74bd3db0a68a384620a85e2f56305c9
   * description: Merge pull request #5768 from ISAM/ISAMSUP-4897

ISAMSUP-4897 Memory access after free during reverse proxy shutdown

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87075215.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230321052046-a4a892d7.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","21/Mar/23 4:45 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a4a892d7e74bd3db0a68a384620a85e2f56305c9
   * description: Merge pull request #5768 from ISAM/ISAMSUP-4897

ISAMSUP-4897 Memory access after free during reverse proxy shutdown

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87077730.


This build has not been published as the commit is not currently within a branch (20230321052046-a4a892d7) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Vulnerabilities Identified in ISVA,ISAMSUP-4890,287934,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,16/Mar/23 8:51 PM,09/May/23 9:52 PM,14/Jul/23 2:47 PM,09/May/23 9:52 PM,10.0.3,,,0,,,,"Customer has deployed ISVA version 10.0.3 in the production environment. Following vulnerabilities has been identified by the client.



Index   Service Port  Vulnerability ID

# 22{{ }}ssh-weak-message-authentication-code-algorithms
# 22{{ }}sssd-unauthorized-ssh-login
# 443{{ }}http-cookie-http-only-flag
# 443{{ }}http-cookie-secure-flag
# 443{{ }}spider-unauthenticated-form-csrf-vuln



After asking them for the CVE and they replied their scanner is not generating CVE IDs against these vulnerabilities.",,Dermot Daly,khansen,Nick Lloyd,Prabhjeet.Multani,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,627a7fb30d1e73006f7c21cf,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,22/Mar/23 2:49 AM;jwade;image-20220110-173627.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/191621,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012456573,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Prabhjeet.Multani,627a7fb30d1e73006f7c21cf,,,,Highrise Technologies,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19huf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-21 16:49:17.366,,,,,"22/Mar/23 1:28 AM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] 

Any update on this case? ","22/Mar/23 2:49 AM;5b15d8fd6e93913e31e279fb;[~accountid:627a7fb30d1e73006f7c21cf] 

#  The algorithms can be set to the customers desired usage by setting the ATP values for this.
!image-20220110-173627.png|width=1767,height=119,alt=""blob:https://cloudidentity.atlassian.net/b8e668c6-5fd4-4598-a073-23ff3309f0e4#media-blob-url=true&id=39eb8c01-b685-4e8f-a61d-9793b52466ef&collection=&contextId=213458&mimeType=image%2Fpng&name=image-20220110-173627.png&size=17338&width=1767&height=119""!

# I need more information about this.  Where is it reported?  What scan was used to discover this?  Can we get the scan report issues for this item?
# The cookie issues should be fixed in ISVA 10.0.5.0.
# The cookie issues should be fixed in ISVA 10.0.5.0.
# I need more information about this.  Where is it reported?  What scan was used to discover this?  Can we get the scan report issues for this item?
","23/Mar/23 7:42 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb]  Customers updated on your queries and also shared the report:

Where is it reported? *It is reported in customer environment.*

What scan was used to discover this? *Nexpose scanner was used.*

Can we get the scan report issues for this item? *Scan report is attached.*

Report is in below ecurep link

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012456573&path=TS012456573%2F2023-03-23%2F&filepath=TS012456573%2F2023-03-23%2FSAM_Vulnerabilities_Report.pdf|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012456573&path=TS012456573%2F2023-03-23%2F&filepath=TS012456573%2F2023-03-23%2FSAM_Vulnerabilities_Report.pdf]",04/Apr/23 9:07 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] any update on this case?,"05/Apr/23 9:40 AM;5b15d8fd6e93913e31e279fb;[~accountid:5b1757156d76184b7d98a0c3] I looked at the customer report and it is not complete.  For instance the http-cookie-secure-flag report does not show the URL where this was found.  This is the same for the other issues also.

This information is important to verify if this was fixed in ISVA 10.0.5.0.

Can the customer rerun the scan against ISVA 10.0.5.0 or provide more information about where these findings were reported.","05/Apr/23 8:08 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] 

After requesting more details about the vulnerabilities, Customer come up with :

----


Mentioned vulnerabilities have been identified on ISVA LMI IP address. The associated ports have already been specified in the report.

As mentioned in the case customer is using Version 10.0.3 not 10.0.5. We kindly request a prompt response accordingly. We would greatly appreciate it if this matter could be resolved in a timely manner, as it has been pending for an extended period of time.","12/Apr/23 9:03 AM;5b15d8fd6e93913e31e279fb;[~accountid:627a7fb30d1e73006f7c21cf] According to the ISAM/ISVA support policy security all vulnerabilities are fixed on the latest Mod level which is ISVA 10.0.5.0.  

[https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|https://www.ibm.com/common/ssi/cgi-bin/ssialias?infotype=AN&subtype=CA&htmlfid=877/ENUSZP20-0094&appname=USN|smart-link] 

This is why I requested the test to be verified on ISVA 10.0.5.0 before we can make any progress.  There have been several PEN Tests run where development has fixed issues discovered in 10.0.4.0 and 10.0.5.0.","17/Apr/23 6:34 PM;627a7fb30d1e73006f7c21cf;[~accountid:5b15d8fd6e93913e31e279fb] 

The information you shared, is it for the customer?",18/Apr/23 1:07 AM;5b15d8fd6e93913e31e279fb;[~accountid:627a7fb30d1e73006f7c21cf] Yes the Support Policy is published for the public and can be shared with the customer.,09/May/23 9:52 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
MMFA configuration fails on openshift with length exceeding table length,ISAMSUP-4889,287917,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Tushar Prasad,5c53d3ac23f5bf672621c868,Tushar Prasad,5c53d3ac23f5bf672621c868,16/Mar/23 5:35 PM,12/Jun/23 1:13 PM,14/Jul/23 2:47 PM,04/Apr/23 12:50 PM,10.0.6,,,0,,,,"with openshift,the route lenght of reverse proxy is exceeding the length in the table



due to this , not able to do mmfa configuration



since configdb is internal , not able to find a way to manually increase the table column width 



could you give  a patch to increase the column width so that mmfa configuration could be done successfully



here is the url



screenshot



!image-20230316-073507.png|width=395,height=227!

endpoint prefix



[https://verifyaccessconfig1050-rprelyingparty-pr-tusharp.apps.l2nilesh.cp.fyre.ibm.com/mga|https://verifyaccessconfig1050-rprelyingparty-pr-tusharp.apps.l2nilesh.cp.fyre.ibm.com/mga]",,Nick Lloyd,,,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,16/Mar/23 5:35 PM;tushar.prasad;image-20230316-073507.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190509,,,,,,,,,,,,,,,IJ47172,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,internal,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Tushar Prasad,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-03-23T15:40:47.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i19hqv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-17 00:07:02.172,,,,,"17/Mar/23 10:07 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5c53d3ac23f5bf672621c868] 

Here is a fixpack : [https://ibm.box.com/s/9hrj2uai19be8bilsujzxynsqjbwofos|https://ibm.box.com/s/9hrj2uai19be8bilsujzxynsqjbwofos|smart-link]  
Let me know if this helps you get past that error. 

Thanks","22/Mar/23 10:24 PM;5c53d3ac23f5bf672621c868;thanks [~accountid:5af4ad7d4dd24c579110120b] 

I will not be able to validate due to two reasons



1.the fixpack is failing 



{noformat}2023-03-22T12:12:55+00:00: WGAWA0989I Bootstrapping.
2
2023-03-22T17:43:04+05:30: WGAWA0971I Applying the configuration snapshot: 5be6617b7281474370a1a0159d12624c3b3dcb165a91c4c9e5ff5b4f6d290d01
3
2023-03-22T17:43:05+05:30: WGAWA0967I Applying the fixpack: mmfa_endpoint_length_openshift_fix_10050.fixpack.
4
mmfa_endpoint_length_openshift_fix_10050: Signature verified
5
mmfa_endpoint_length_openshift_fix_10050: Fix pack is not in the correct format
6
umount: /tmp/mesa_install_fixpack605.WQUTW8: must be superuser to unmount.
7
mmfa_endpoint_length_openshift_fix_10050 install failed
8
mmfa_endpoint_length_openshift_fix_10050 install failed
9
2023-03-22T17:43:05+05:30: WGAWA0968E Failed to apply the fixpack: mmfa_endpoint_length_openshift_fix_10050.fixpack.
10
2023-03-22T17:43:34+05:30: WGAWA0990I Running.
11
2023-03-22T17:43:34+05:30: WGAWA0987I Log file: /var/application.logs.local/lmi/messages.log
12
********************************************************************************
13
product = WebSphere Application Server 22.0.0.9 (wlp-1.0.68.cl220920220815-1900)
14
wlp.install.dir = /opt/ibm/wlp/
15
server.config.dir = /opt/IBM/wlp/usr/servers/default/
16
java.home = /opt/java/jre
17
java.version = 11.0.16.1
18
java.runtime = IBM Semeru Runtime Open Edition (11.0.16.1+1)
19
os = Linux (4.18.0-305.49.1.el8_4.x86_64; amd64) (en_US)
20
process = 776@10.254.13.22
21
Classpath = /opt/IBM/wlp/bin/tools/ws-server.jar:/opt/IBM/wlp/bin/tools/ws-javaagent.jar
22
Java Library path = /opt/java/jre/lib/default:/opt/java/jre/lib:/usr/lib64:/usr/lib
23
*****************************************************{noformat}



2.

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4853|https://cloudidentity.atlassian.net/browse/ISAMSUP-4853|smart-link] 



for now, I reduced the route length.



but will be needed an APAR so that it doesn’t cause any future issues.","23/Mar/23 11:07 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a6ff9511616676b0c71056ce204aedbd4169a8e8
   * description: ISAMSUP-4889 Update allowed url length for mmfa config endpoint

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87242962.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4889) which we publish.",23/Mar/23 2:22 PM;5af4ad7d4dd24c579110120b;ok please log an APAR. ,"23/Mar/23 3:40 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: bdefab9e8e8b8e4409bffa3176d43bbb469aec95
   * description: Merge pull request #5771 from ISAM/ISAMSUP-4889

ISAMSUP-4889 Update allowed url length for mmfa config endpoint

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87252645.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230323053742-bdefab9e8.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","23/Mar/23 5:02 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: bdefab9e8e8b8e4409bffa3176d43bbb469aec95
   * description: Merge pull request #5771 from ISAM/ISAMSUP-4889

ISAMSUP-4889 Update allowed url length for mmfa config endpoint

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87256947.


This build has not been published as the commit is not currently within a branch (20230323053742-bdefab9e8) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Many advanced config options missing from documentation.,ISAMSUP-4825,285712,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,,David Hayes,5b232b2fd85e5b59b066f57f,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,03/Mar/23 4:16 AM,28/Jun/23 1:01 PM,14/Jul/23 2:47 PM,,,,,0,,,,"The two pages are missing options exposed by the [https://LMI/iam/access/v8/override-configs/|https://LMI/iam/access/v8/override-configs/] 
[https://www.ibm.com/docs/en/sva/10.0.5?topic=ac-advanced-configuration-properties|https://www.ibm.com/docs/en/sva/10.0.5?topic=ac-advanced-configuration-properties|smart-link] (Federation configuration section)

[https://www.ibm.com/docs/en/sva/10.0.5?topic=configuration-advanced-properties|https://www.ibm.com/docs/en/sva/10.0.5?topic=configuration-advanced-properties|smart-link] (AAC docs configuration section)



For example the following are shown in in the LMI but are not documented in 10.0.5



attributeCollection.hashedAuthenticationContextAttributes
basicLdapUser.ldap.maxBinds
basicLdapUser.ldap.minBinds
consentDeviceRegistration.authLevelHeaderEnabled
consentDeviceRegistration.authLevelHeaderValue
fido2.u2fMigration.autoMigrate
httpSession.disableSerialization
infomap.email.smtpStartTls
infomap.email.smtpTlsProtocol
js.version
jwks.signing.keystore
mmfa.completionResponse.legacyBehaviour
mmfa.devicePrompt.validateChosen
oauth20.backwardCompatibilityEnabled
oauth20.cleanupThread.batchSize
oauth20.clientCacheLifetime
oauth20.deviceFlow.slowDownThreshhold
oauth20.introspectEndpointEnabled
oauth20.tokenCache.allowDBConnectExceptionEnable
oauth20.tokenCache.cleanupOnlyOnPrimaryMaster
poc.webseal.poc.sms.enabled
postgresdb.fetchsize
riskEngine.useRoundingMethod
sps.authService.reCAPTCHA.serviceLocation
sps.page.jsCompileFileExtensions
sts.requestTypeMapper.lru.size
username.legacyBehavior



If these options are not intended for use they should either be hidden or documented that it is not used/deprecated.",,Annelise Quap,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,5b15d950d9936c61022057fe,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i194c3:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-28 22:38:51.923,,,,,29/Mar/23 8:38 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af05450e6f95a2c1c89193d] [~accountid:5b15d9f03993e9196502f607] can you please review the above list and confirm which items fall within your product ownership. Can you also please confirm if you agree that all of these items need to be documented? ,"29/Mar/23 9:31 AM;5af05450e6f95a2c1c89193d;FED:



These need to be documented.

oauth20.backwardCompatibilityEnabled
oauth20.cleanupThread.batchSize
oauth20.clientCacheLifetime
oauth20.deviceFlow.slowDownThreshhold
oauth20.introspectEndpointEnabled
oauth20.tokenCache.allowDBConnectExceptionEnable
oauth20.tokenCache.cleanupOnlyOnPrimaryMaster
-jwks.signing.keystore-(It is documented)
postgresdb.fetchsize (Both)

sts.requestTypeMapper.lru.size","29/Mar/23 11:04 AM;5b15d9f03993e9196502f607;I think that there should be an effort to get all of these documented. I have done some initial analysis and this is where the properties are used and I have added the Jira workitem (or pull request) for when some if them were added:



attributeCollection.hashedAuthenticationContextAttributes — RBA (RuntimeProperties)
basicLdapUser.ldap.maxBinds — FIM (BasicLDAPUserProperties)
basicLdapUser.ldap.minBinds — FIM (BasicLDAPUserProperties)
consentDeviceRegistration.authLevelHeaderEnabled — RBA (ConsentDeviceRegistrationWorker)
consentDeviceRegistration.authLevelHeaderValue — RBA (ConsentDeviceRegistrationWorker)
fido2.u2fMigration.autoMigrate — FIM (FIDOConfig + U2FManager) (ISAMDEV-1865)
httpSession.disableSerialization — FIM (WebsphereDistributedMapFactory + CustomParameterNames + BrowserAdaptor + SOAPAdaptor) (ISAM-1901)
infomap.email.smtpStartTls — FIM (EmailSender) (ISAMDEV-1497)
infomap.email.smtpTlsProtocol — FIM (EmailSender) (ISAMDEV-1497)
js.version — FIM (JSCode) (Rhino Controls)
jwks.signing.keystore — FIM (JwksDelegate)
mmfa.completionResponse.legacyBehaviour — AAC (ISAM-460)
mmfa.devicePrompt.validateChosen — AAC (ISAM-1458)
oauth20.backwardCompatibilityEnabled — FIM (OAuthAuthorizationDelegate + AuthSvcDelegate + RestAuthSvcDelegate)
oauth20.cleanupThread.batchSize — FIM (StartTokenCleanupThreadCmd)
oauth20.clientCacheLifetime — FIM (ClientInstanceDAOJdbcCacheImpl + DynamicClientDAOJdbcCacheImpl)
oauth20.deviceFlow.slowDownThreshhold — FIM (OAuth20GrantTypeDeviceImpl)
oauth20.introspectEndpointEnabled — FIM (CustomParameterNames)
oauth20.tokenCache.allowDBConnectExceptionEnable — FIM (TokenCacheDAOSecureStorageJdbcImpl) (ISAMSUP-1998)
oauth20.tokenCache.cleanupOnlyOnPrimaryMaster — FIM (TransactionCleanupHelper + StartTokenCleanupThreadCmd)
poc.webseal.poc.sms.enabled — FIM (WebsealPocSignOutCallback) (ISAMSUP-3107)
postgresdb.fetchsize — FIM (JdbcStatementUtils) (ISAMDEV-4560)
riskEngine.useRoundingMethod — RBA (RuntimeProperties)
sps.authService.reCAPTCHA.serviceLocation — FIM (ReCAPTCHAAuthenticator)
sps.page.jsCompileFileExtensions — FIM (PageImpl) (ISAMSUP-1637)
sts.requestTypeMapper.lru.size — FIM (CustomParameterNames) (ISAM-297)
username.legacyBehavior — RBA (DisableUsernameLegacyBehavior)",11/May/23 1:08 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9f03993e9196502f607] [~accountid:5af05450e6f95a2c1c89193d] just wanted to check =if this documentation effort might be able to be contained as part of our 10.0.6 hardening efforts for the group? ,"31/May/23 11:38 AM;5b15d9f03993e9196502f607;I have added the descriptions into 10.0.6 IDD for:

consentDeviceRegistration.authLevelHeaderEnabled
consentDeviceRegistration.authLevelHeaderValue
mmfa.completionResponse.legacyBehaviour
mmfa.devicePrompt.validateChosen
basicLdapUser.ldap.maxBinds
basicLdapUser.ldap.minBinds
fido2.u2fMigration.autoMigrate
httpSession.disableSerialization
infomap.email.smtpStartTls
infomap.email.smtpTlsProtocol
js.optimizationLevel
js.version
jwks.encryption.enabled
kess.validateCertPath
poc.webseal.poc.sms.enabled
riskEngine.useRoundingMethod
sps.authService.reCAPTCHA.serviceLocation
sts.uuser.attributes.donottrim.list
username.legacyBehavior
util.httpClientv2.proxyPassword
util.httpClientv2.proxyUsername

[~accountid:5af05450e6f95a2c1c89193d] If you can add the other FED descriptions I think this is done.",14/Jun/23 3:53 AM;5b15d950d9936c61022057fe;[~accountid:5b15d9f03993e9196502f607] Is there a preview link to the 10.0.6 docs?,14/Jun/23 2:01 PM;5b15d9f03993e9196502f607;[~accountid:5b15d950d9936c61022057fe] Not sure of the access but try: [https://ibmdocs-test.dcs.ibm.com/docs/en/sva/10.0.6?topic=ac-advanced-configuration-properties|https://ibmdocs-test.dcs.ibm.com/docs/en/sva/10.0.6?topic=ac-advanced-configuration-properties],"15/Jun/23 2:52 AM;5b15d950d9936c61022057fe;[~accountid:5af05450e6f95a2c1c89193d] will you be adding the other items to the documentation in time for the release?


I did not see the following still in 10.0.6 docs:
attributeCollection.hashedAuthenticationContextAttributes
oauth20.backwardCompatibilityEnabled
oauth20.cleanupThread.batchSize
oauth20.clientCacheLifetime
oauth20.deviceFlow.slowDownThreshhold
oauth20.introspectEndpointEnabled
oauth20.tokenCache.allowDBConnectExceptionEnable
oauth20.tokenCache.cleanupOnlyOnPrimaryMaster
postgresdb.fetchsize
sps.page.jsCompileFileExtensions
sts.requestTypeMapper.lru.size",27/Jun/23 4:17 PM;5ac57757d9a96536d1f0daa9;[~accountid:5af05450e6f95a2c1c89193d] can you please confirm if the items that [~accountid:5b15d950d9936c61022057fe] identified made it into the 10.0.6 release or not? ,"27/Jun/23 5:34 PM;5af05450e6f95a2c1c89193d;[~accountid:5ac57757d9a96536d1f0daa9] I have documented most of them, there are a few that I am unsure of , which I have not documented.",28/Jun/23 1:01 PM;5ac57757d9a96536d1f0daa9;[~accountid:5af05450e6f95a2c1c89193d] can you please confirm which ones where not documented. I want to validate if these are required or not. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Format of URL String sent by Federated WebSEAL to Backend,ISAMSUP-4823,285679,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,carlos.arias,62ed8180432ef494c8cad107,carlos.arias,62ed8180432ef494c8cad107,03/Mar/23 2:04 AM,15/Mar/23 1:56 PM,14/Jul/23 2:47 PM,15/Mar/23 1:56 PM,,,,0,,,,"We need to help our application developers by providing an example of the URL string containing tag values from a SAML 2.0 federation with an external vendor. Our federation isn't complete yet but we must provide this information. What does the WebSEAL send and how is it formatted?

Product Version : V.10.0.4",,khansen,Nick Lloyd,Steve Herskowitz,Tushar Prasad,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5af99299ae1b5f08256340f1,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012321132,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,WISCONSIN PHYSICIANS SERVICE INSURANCE CORP,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1945f:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-03-03 00:01:45.546,,,,,"03/Mar/23 10:01 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:62ed8180432ef494c8cad107] 

Here are the URL’s that SAML2.0 use:

[https://www.ibm.com/docs/en/sva/10.0.5?topic=urls-endpoint-url-specifications|https://www.ibm.com/docs/en/sva/10.0.5?topic=urls-endpoint-url-specifications|smart-link]  

Example of IDP initiated URL:

[https://www.myidp.ibm.com/isam/sps/saml20idp/saml20/logininitial?RequestBinding=HTTPPost&PartnerId=https%3A%2F%2Fwww.mysp.ibm.com%2Fisam%2Fsps%2Fsaml20sp%2Fsaml20&NameIdFormat=Email&Target=https://www.mysp.ibm.com/isam/mobile-demo/diag/|https://www.myidp.ibm.com/isam/sps/saml20idp/saml20/logininitial?RequestBinding=HTTPPost&PartnerId=https%3A%2F%2Fwww.mysp.ibm.com%2Fisam%2Fsps%2Fsaml20sp%2Fsaml20&NameIdFormat=Email&Target=https://www.mysp.ibm.com/isam/mobile-demo/diag/]

[https://www.myidp.ibm.com/isam/sps/saml20idp/saml20/sloinitial?RequestBinding=HTTPRedirect|https://www.myidp.ibm.com/isam/sps/saml20idp/saml20/sloinitial?RequestBinding=HTTPRedirect]

Example of SP initiated URL:

[https://www.mysp.ibm.com/isam/sps/saml20sp/saml20/logininitial?RequestBinding=HTTPRedirect&ResponseBinding=HTTPPost&PartnerId=https://www.myidp.ibm.com/isam/sps/saml20idp/saml20&NameIdFormat=Email&Target=https://www.mysp.ibm.com/isam/mobile-demo/diag/|https://www.mysp.ibm.com/isam/sps/saml20sp/saml20/logininitial?RequestBinding=HTTPRedirect&ResponseBinding=HTTPPost&PartnerId=https://www.myidp.ibm.com/isam/sps/saml20idp/saml20&NameIdFormat=Email&Target=https://www.mysp.ibm.com/isam/mobile-demo/diag/]

[https://www.mysp.ibm.com/isam/sps/saml20sp/saml20/sloinitial?RequestBinding=HTTPPost|https://www.mysp.ibm.com/isam/sps/saml20sp/saml20/sloinitial?RequestBinding=HTTPPost]



If you need additional information there is a Federation cook book that you can refer to-

[https://www.ibm.com/support/pages/ibm-security-access-manager-federation-cookbook|https://www.ibm.com/support/pages/ibm-security-access-manager-federation-cookbook|smart-link]  ","04/Mar/23 2:32 AM;62ed8180432ef494c8cad107;Thanks for the information [~accountid:5af4ad7d4dd24c579110120b] , I’ll share it with customer.",15/Mar/23 1:56 PM;5af4ad7d4dd24c579110120b;Case closed.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Instana monitor feature not enabled,ISAMSUP-4812,283865,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Steve Hughes,5bac25acfd82176d11a1334c,Steve Hughes,5bac25acfd82176d11a1334c,23/Feb/23 7:39 AM,03/Mar/23 12:30 PM,14/Jul/23 2:47 PM,03/Mar/23 12:30 PM,,,,0,,,,"Instana tenant reports the following message about the ISVA runtime:
”It seems that monitor feature is not enabled. Please add monitor-1.0 feature in server.xml”


See screenshot at:
[https://ecurep.mainz.de.ibm.com/rest/download/TS012234439/2023-02-22/Screenshot_2023-02-22_at_1.06.35_PM.png|https://ecurep.mainz.de.ibm.com/rest/download/TS012234439/2023-02-22/Screenshot_2023-02-22_at_1.06.35_PM.png?fileSize=86811&clientId=ae5]

/ecurep/sf/TS012/234/TS012234439/2023-02-22/Screenshot_2023-02-22_at_1.06.35_PM.png

From Instana doc, the runtime server.xml needs to be updated:
[https://www.ibm.com/docs/en/instana-observability/current?topic=technologies-monitoring-websphere-liberty|https://www.ibm.com/docs/en/instana-observability/current?topic=technologies-monitoring-websphere-liberty]

Support File:
/ecurep/sf/TS012/234/TS012234439/2023-02-22/isva_10.0.5.0_20230222-134909_platform-isam-fj001-dal12p2.dev.bpmoncloud.local.support_unpack/",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4813,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012234439,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Steve Hughes,5bac25acfd82176d11a1334c,,,,IBM,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18t57:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-23 01:36:18.66,,,,,"23/Feb/23 11:36 AM;5af4ad7d4dd24c579110120b;[~accountid:5bac25acfd82176d11a1334c] 

I have a fixpack  here to update the relevant feature in feature manager of server .xml

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4813|https://cloudidentity.atlassian.net/browse/ISAMSUP-4813|smart-link] 

Install fixpack 
Restart LMI 

Generate support file and check that the server.xml has the entry updated.

Let me know if this resolves","25/Feb/23 3:27 AM;5bac25acfd82176d11a1334c;Feedback from customer:
So, we no longer see the error messages but I do have a few more questions now.

We can see 2 processes in the stack - default and runtime.

/opt/IBM/wlp/bin/tools/ws-server.jar default --clean 

> Could you please confirm if this is responsible for the management interface / LMI? We can see the information getting populated correctly here.

/opt/IBM/wlp/bin/tools/ws-server.jar runtime --clean

> I will assume this is the one that handles the non-management interface-related work? This ISVA is configured as a webseal instance, so it has a public interface and should receive a lot of external requests, but nothing is showing up in this view. Do you know if the same change has been made to the runtime component as well via the fixpack provided? 

----

Got Support File with LMI and Runtime App Server.  Found that the LMI app server server.xml was updated with <feature>monitor-1.0</feature> but the AAC/Fed runtime app server was not updated.  Can we have a fixpack that updates both app servers?","26/Feb/23 8:40 AM;5af4ad7d4dd24c579110120b;[~accountid:5bac25acfd82176d11a1334c] 

Updated fixpack to include the entry in runtime server xml.

Uninstall the previous fixpack before installing this version.","01/Mar/23 11:03 AM;5bac25acfd82176d11a1334c;[~accountid:5af4ad7d4dd24c579110120b] Thank you for the second fixpack.  Customer has confirmed that monitoring data is showing up for both the LMI and Runtime server now.

Customer has last question if the extension is only for the WAS JVMs or if they should expect data from other servers like WebSEAL.  The Overview of the extension is not very descriptive of what it does:
[https://exchange.xforce.ibmcloud.com/hub/extension/ef74220a9391394ca9c0b04a8c38dc87|https://exchange.xforce.ibmcloud.com/hub/extension/ef74220a9391394ca9c0b04a8c38dc87]","01/Mar/23 11:34 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bac25acfd82176d11a1334c] 

This is specific to the LMI and Runtime , I do not see any configuration to webseal from the extension side since this exports. This statistic data is only for the WAS JVMs.
 ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Not able to login to policy administration (/opt/java/jre/PolicyDirector/PD.properties (Permission denied)),ISAMSUP-4805,282897,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,oscar.jimen,6333216f748d1bfcb85982ca,oscar.jimen,6333216f748d1bfcb85982ca,21/Feb/23 8:35 AM,20/Mar/23 11:14 PM,14/Jul/23 2:47 PM,20/Mar/23 11:14 PM,,,,0,,,,"Some of our users are locked out and i cant login to the policy administration to enable the users, when i try to login as sec_master with the password, it gives me this error (/opt/java/jre/PolicyDirector/PD.properties (Permission denied))

The issue is presented over LMI

CLI works fine.

I have a customer with the following error >> {{Not able to login to policy administration (/opt/java/jre/PolicyDirector/PD.properties (Permission denied))}} As far as I understand, there is a fix pack (Version independent) (rebuild_pd_properties.fixpack) for this. I Told the customer to apply the fix pack; however, the appliance, displayed this message>> *The system failed to install the fix pack.* The customer is on version 10.0.0.5. The customer sent the logs from the support file, and I found the following errors:


{{February 17 09:45:40 mesa_control[13878]: Installing fixpack from file /tmp/fixpacktmpdir/rebuild_pd_properties.fixpack}}
{{Feb 17 09:45:40 mesa_install_fixpack: rebuild_pd_properties: Failed to verify signature}}
{{Feb 17 09:45:40 mesa_control[13878]: Error: Fixpack /tmp/fixpacktmpdir/rebuild_pd_properties.fixpack: Failed to verify signature}}

*We think that all the ""version independent"" need to be resigned for the method used in 10.0.0.5 

[^rebuild_pd_properties.fixpack]


Platform Version : VMWare
Product2nd : Security Verify Access
Product Component : Webseal (Reverse Proxy)
Product Version : V.10.0.5",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4887,,21/Feb/23 8:35 AM;6333216f748d1bfcb85982ca;rebuild_pd_properties.fixpack;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/185168,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012167778,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,oscar.jimen,6333216f748d1bfcb85982ca,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18n7n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,LMI,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-23 23:55:40.065,,,,,"24/Feb/23 9:55 AM;5b232b2fd85e5b59b066f57f;[~accountid:6333216f748d1bfcb85982ca] - I believe you are referring to this fix-pack?: [https://cloudidentity.atlassian.net/browse/ISAMSUP-4601|https://cloudidentity.atlassian.net/browse/ISAMSUP-4601|smart-link] 

As per the fix-pack details, it is only applicable to ISVA 10.0.3, 10.0.3.1, 10.0.4; it will need to be rebuilt for 10.0.5. ",25/Feb/23 1:32 AM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] Thanks. So in this case means that Dev team has to build a new Fix Pack for 10.0.5.?,27/Feb/23 12:24 PM;5b232b2fd85e5b59b066f57f;[~accountid:6333216f748d1bfcb85982ca] - I will rebuild it. I need to set up a new build environment for 10.0.5 - I’ll let you know once the fix-pack is available. ,11/Mar/23 1:11 AM;6333216f748d1bfcb85982ca;Hi [~accountid:5b232b2fd85e5b59b066f57f] Do you have an update or estimated ETA for this? Thanks,16/Mar/23 11:54 AM;5b232b2fd85e5b59b066f57f;[~accountid:6333216f748d1bfcb85982ca] fix-pack for 10.0.5 is available here: [https://cloudidentity.atlassian.net/browse/ISAMSUP-4887|https://cloudidentity.atlassian.net/browse/ISAMSUP-4887|smart-link]. Please provide to customer and let me know how it goes. Thanks. ,20/Mar/23 11:14 PM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] According to the customer the fix pack works. Customer closed the case.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Doubt about possible vulnerability in ISVA 10.0.4,ISAMSUP-4803,282620,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwade,5b15d8fd6e93913e31e279fb,Aaron.Richie.Dias,6194c472fe9f300068e5252f,Aaron.Richie.Dias,6194c472fe9f300068e5252f,20/Feb/23 8:02 PM,27/Mar/23 10:18 AM,14/Jul/23 2:47 PM,27/Mar/23 10:18 AM,,,,0,,,,"The customer wants to know if version 10.0.4 are affected by these vulnerabilities related to jQuerry:

{noformat}            {
                ""id"": ""CVE-2020-11022"",
                ""cve"": ""CVE-2020-11022"",
                ""cvss"": 6.1,
                ""description"": ""In jQuery versions greater than or equal to 1.2 and before 3.5.0, passing HTML from untrusted sources - even after sanitizing it - to one of jQuery's DOM manipulation methods (i.e. .html(), .append(), and others) may execute untrusted code. This problem is patched in jQuery 3.5.0.""
            },
            {
                ""id"": ""CVE-2020-11023"",
                ""cve"": ""CVE-2020-11023"",
                ""cvss"": 6.1,
                ""description"": ""In jQuery versions greater than or equal to 1.0.3 and before 3.5.0, passing HTML containing <option> elements from untrusted sources - even after sanitizing it - to one of jQuery's DOM manipulation methods (i.e. .html(), .append(), and others) may execute untrusted code. This problem is patched in jQuery 3.5.0.""
            },
            {
                ""id"": ""CVE-2019-11358"",
                ""cve"": ""CVE-2019-11358"",
                ""cvss"": 6.1,
                ""description"": ""jQuery before 3.4.0, as used in Drupal, Backdrop CMS, and other products, mishandles jQuery.extend(true, {}, ...) because of Object.prototype pollution. If an unsanitized source object contained an enumerable __proto__ property, it could extend the native Object.prototype.""
            }{noformat}



I found these vulnerabilities mentioned in  X-force exchange:

[https://exchange.xforce.ibmcloud.com/vulnerabilities/159633|https://exchange.xforce.ibmcloud.com/vulnerabilities/159633|smart-link] 

[https://exchange.xforce.ibmcloud.com/vulnerabilities/181349|https://exchange.xforce.ibmcloud.com/vulnerabilities/181349|smart-link] 

[https://exchange.xforce.ibmcloud.com/vulnerabilities/181350|https://exchange.xforce.ibmcloud.com/vulnerabilities/181350|smart-link] 



But nothing was mentioned regarding ISVA in [https://www.ibm.com/support/pages/bulletin/|https://www.ibm.com/support/pages/bulletin/|smart-link] 



Could you please confirm if the product ISVA 10.0.4 has a vulnerable version of jQuery? If so, with what fix could we mitigate the vulnerability? ",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012184803,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Aaron.Richie.Dias,6194c472fe9f300068e5252f,,,,SEAT S.A.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18lib:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-27 14:48:20.746,,,,,28/Feb/23 12:09 AM;6194c472fe9f300068e5252f;[~accountid:5b15d8fd6e93913e31e279fb] any update on this that I can pass on to the customer? ,"28/Feb/23 12:48 AM;5c53d3ac23f5bf672621c868;[~accountid:6194c472fe9f300068e5252f] 



The product 10.0.4.0 ships with jquery version 3.5.1 hence is not affected by above vulnerability.

do note, there is one gotcha ,then customer needs to make sure they manually change the jquery version which comes in file download section .

for example: if customer goes to LMI → AAC → template files → c-> mmfa->user->mgmt->mmfa->usc->static->js->vendor->jquery.js



Then customer might see an older version of jquery( because an upgrade will not replace an existing jquery .js because it may cause loss of any customization in jquery.js)



As part of upgrade the latest jquery.js is placed at 

File downloads → aac controle → pages c-> mmfa->user->mgmt->mmfa->usc->static->js->vendor->jquery.js



so customer needs to use latest jquery available at file download section and replace the existing one.

if they havent done any customization then they can just replace it , otherwise they need to modify the latest one. this is how they can take care of jquery vulnerabilty.","28/Feb/23 8:26 PM;6194c472fe9f300068e5252f;Thanks for the update, Tushar. I will let the customer know. ",27/Mar/23 10:18 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Postgres as HA runtime database failover not happens,ISAMSUP-4799,281772,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,16/Feb/23 8:05 PM,11/Apr/23 3:28 PM,14/Jul/23 2:47 PM,11/Apr/23 1:35 PM,10.0.6,,,0,,,,"Customer have configured an external HVDB (Postgres, not clustered) with a ""High availability"" option on in ISVA. When we safe the configuration it all looks good. When we test the configuration we see that ISVA noticed the de 1st HVDB is down but it is not going to the failover servers.

10.10.7.90(appliance) ->10.10.7.52 [*grprdap10216.isz.prd.duo.nl*|https://grprdap10216.isz.prd.duo.nl/] (primary DB server)

10.10.7.90(appliance) ->10.10.7.54 [*grprdap10220.isz.prd.duo.nl*|https://grprdap10216.isz.prd.duo.nl/] (secondary DB server)

In the message log we can see the error I com.tivoli.am.rba.exception.RBADBException:

""*Connection to* [*grprdap10216.isz.prd.duo.nl*|https://grprdap10216.isz.prd.duo.nl/]*:5432* refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections."" 

We checked through the log we cannot see any switch over between two HVDB servers.

In the PCAP we can see the 10.10.7.52 [*grprdap10216.isz.prd.duo.nl*|https://grprdap10216.isz.prd.duo.nl/] reset the connection.",,BRIANORO,Dermot Daly,Gabe,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,6154906364ff01007106e189,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ45579,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011302299 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,DIENST UITVOERING ON,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=7, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":7,""lastUpdated"":""2023-04-11T14:13:23.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":7,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18gkz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-17 07:17:34.983,,,,,"17/Feb/23 5:17 PM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] what version of ISVA are they on?

The messages about {{10216}} refusing connections are all as expected, especially if they have turned it off to test the failover to {{10220}}

Have you made any attempt to recreate the problem locally?

_>> We checked through the log we cannot see any switch over between two HVDB servers._

Can you reference those logs and entries so I know what to investigate?","17/Feb/23 10:35 PM;6092aca0f0db130069d19687;what version of ISVA are they on? *V10.0.4*

The messages about {{10216}} refusing connections are all as expected, especially if they have turned it off to test the failover to {{10220}}

Have you made any attempt to recreate the problem locally? *No , I don’t. I need to set it up on my VMs. It could take some time.*

_>> We checked through the log we cannot see any switch over between two HVDB servers._

Can you reference those logs and entries so I know what to investigate? 

*Here is the message.log shows the DB connection refused then I cannot see it switch to another DB server.*

*S:\sf\TS011\302\TS011302299\2023-02-14\isva_10.0.4.0_20230214-111343_grnpx009.support_unpack\tmp\liberty_runtime_dump.zip_unpack\logs\allMSG.txt*","23/Feb/23 3:16 PM;5b15d954b0d76456f36daf33;I think there is a problem with the way we are saving the failover information which is causing this issue.

Please create an APAR","24/Feb/23 3:17 AM;6154906364ff01007106e189;[~accountid:5b15d954b0d76456f36daf33] APAR created successfully with number: IJ45579
""Issue with PostgreSQL high availability failover servers setting in ISVA. Not working as expected.""
Apologies for the brevity, as previous owners are OOO.

Related threads in #verify-access regarding same issue i.e.
[https://ibm-security.slack.com/archives/C307GJRN1/p1661155791688189|https://ibm-security.slack.com/archives/C307GJRN1/p1661155791688189|smart-link] 
[https://ibm-security.slack.com/archives/C307GJRN1/p1662452940283119|https://ibm-security.slack.com/archives/C307GJRN1/p1662452940283119|smart-link] ",13/Mar/23 9:06 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] Is there any update for the fix?,15/Mar/23 10:45 AM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] yes I’ve made the necessary changes to address this issue. Currently testing.,24/Mar/23 6:45 PM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] thanks for the update. I will let the customer know it. 👍 ,"27/Mar/23 12:52 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 9fb89db1d782703051179c0d2d5c082b1935325a
   * description: ISAMSUP-4799 CLuster config only

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/87488153.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4799) which we publish.",05/Apr/23 12:34 AM;6092aca0f0db130069d19687;[~accountid:5b15d954b0d76456f36daf33] is there any update of the build? ,05/Apr/23 6:32 PM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] is the customer looking for a personal fix?,05/Apr/23 7:13 PM;6092aca0f0db130069d19687;no. I told the customer we are working on the fix.,"06/Apr/23 8:56 PM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] I tested this against the recently released 10.0.5.0_IF1 fixpack.

The failover is now working as expected. Can you ask if the customer would like to confirm one way or the other in their environment?",07/Apr/23 1:13 AM;6092aca0f0db130069d19687;The customer replied: “We are running 10.0.4 at the moment. We are going to move Production ISVA from hardware to virtual and after that we hope to have some time to update to 10.0.5... but I can't make any promises”,"11/Apr/23 12:28 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 0b7565ca996ff6187966e5e7118f7fa30b8d33f4
   * description: ISAMSUP-4799 Failover for postgres dbs

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86656.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4799) which we publish.",11/Apr/23 1:35 PM;5b15d954b0d76456f36daf33;[~accountid:6092aca0f0db130069d19687] I’m closing this as the changes are approved and merged into the next release (10.0.6),"11/Apr/23 2:13 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c04069a277163e4363122f311ce5bfb1fec0a243
   * description: ISAMSUP-4799 Failover for postgres dbs (#5819)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86788.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230411041023-c04069a2.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","11/Apr/23 3:28 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c04069a277163e4363122f311ce5bfb1fec0a243
   * description: ISAMSUP-4799 Failover for postgres dbs (#5819)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86882.


This build has not been published as the commit is not currently within a branch (20230411041023-c04069a2) which we publish.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
SSO Login Issues -Blank screen,ISAMSUP-4784,280710,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,10/Feb/23 9:46 PM,27/Jun/23 8:57 AM,14/Jul/23 2:47 PM,27/Jun/23 8:57 AM,,Support,,0,escalated,Escalation,,"Enable it on step 3

[https://www.ibm.com/support/pages/collecting-data-isam-web-gateway-appliance-aac-issues|https://www.ibm.com/support/pages/collecting-data-isam-web-gateway-appliance-aac-issues|smart-link] 



Please make sure you have the following trace specification enable:

com.ibm.sec.authz.*=ALL:com.ibm.tscc.rtss.*=ALL:com.tivoli.am.fim.*=ALL:com.tivoli.am.rba.*=ALL:com.tivoli.am.fim.saml20.*=ALL



SAML logs will be captured in trace.log and it will show the error, timestamp and other finding relevant to the case

for example:

support_files\tmp\liberty_dump.zip_unpack\logs\trace.log

Customer upload the below.

[TS012074480 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012074480&path=TS012074480%2F2023-02-10%2Fisam_9.0.7.2_20230207-124653_glopvmasau01.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F]

SAML trace is there in it",,cholt@us.ibm.com,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b15d994dda5f94d06b985b2,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS012074480, TS011916855",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Syed Hasan Jafar,617a5f2cf485cd0068cb98af,,,,BARCLAYS BANK PLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18a1v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.2,,,,,,,,,,,,,2023-02-16 17:02:14.567,,,,,"10/Feb/23 9:56 PM;617a5f2cf485cd0068cb98af;Similar case with same customer the trace is uploaded at

[TS011916855 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011916855&path=TS011916855%2F2023-02-10%2Fisam_9.0.7.2_20230207-124653_glopvmasau01.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F&filepath=TS011916855%2F2023-02-10%2Fisam_9.0.7.2_20230207-124653_glopvmasau01.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2Ftrace.log] ",16/Feb/23 8:53 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] Customer looking for an update please and there is a management escalation on it.,"17/Feb/23 3:02 AM;5b15d99182e05b22cc7d5947;Hello Syed,

Will take a look at customer data.

What timestamps is the blank login page showing?

Thanks!","17/Feb/23 6:20 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] Customer reply is below.

Can you please make yourself/L3 available to come into a call where we can demo/recreate the issue to you. This will be much productive to understand what is going on in the env and also capture any further traces/data that might be required.","17/Feb/23 11:19 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] Customer have uploaded debug and snoop logs for the issue . Please check the logs around 12:50BST - 12:56

[TS012074480 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012074480&path=TS012074480%2F2023-02-17%2F&filepath=TS012074480%2F2023-02-17%2Feai-a-bcard.zip]","18/Feb/23 1:46 AM;5b15d99182e05b22cc7d5947;Helllo Syed,

Will take a look at data.

Thanks!","18/Feb/23 1:56 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] This is the second case from same customer for the SSO login issue also. Customer last upload of data was on 10/02/2023 you can check both data may be you will find something in this data 

[TS011916855 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011916855&path=TS011916855%2F2023-02-10%2F]","20/Feb/23 2:03 PM;5b15d99182e05b22cc7d5947;Hello Syed,

Base on TS012074480 pdweb.snoop data and the GCRP-Image.docx screenshot the URL showing in browser (as a blank page) is a redirect to ‘[https://eai-a-bcard.rfs.barclays.co.uk/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unaut….’|https://eai-a-bcard.rfs.barclays.co.uk/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unaut….’]

Looking at the provided ‘eai-a-bcard.zip’ seems the request is to 'GET /favicon.ico' that generates the blank 302.

{noformat}(308) 2023-02-14-13:00:53.214 Client (22.126.67.65:52962) to WebSEAL (10.115.43.129:51001) sending 581 bytes
GET /favicon.ico HTTP/1.1^M
Host: eai-a-bcard.rfs.barclays.co.uk^M
Connection: keep-alive^M
sec-ch-ua: ""Not?A_Brand"";v=""8"", ""Chromium"";v=""108"", ""Microsoft Edge"";v=""108""^M
DNT: 1^M
sec-ch-ua-mobile: ?0^M
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36 Edg/108.0.1462.76^M
sec-ch-ua-platform: ""Windows""^M
Accept: image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8^M
Sec-Fetch-Site: cross-site^M
Sec-Fetch-Mode: no-cors^M
Sec-Fetch-Dest: image^M
Accept-Encoding: gzip, deflate, br^M
Accept-Language: en-US,en;q=0.9^M
^M

(308) 2023-02-14-13:00:53.215 WebSEAL (10.115.43.129:51001) to Client (22.126.67.65:52962) sending 2545 bytes
HTTP/1.1 302 Moved Temporarily^M
content-length: 1711^M
content-type: text/html; charset=UTF-8^M
date: Tue, 14 Feb 2023 13:00:53 GMT^M
location: https://eai-a-bcard.rfs.barclays.co.uk/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&METHOD=GET&URL=%2Ff\
avicon.ico&REFERER=&HOSTNAME=eai-a-bcard.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=^M
p3p: CP=""NON CUR OTPi OUR NOR UNI""^M
x-frame-options: DENY^M
x-content-type-options: nosniff^M
cache-control: no-store^M
x-xss-protection: 1^M
content-security-policy: frame-ancestors 'none'^M
strict-transport-security: max-age=31536000; includeSubDomains^M
pragma: no-cache^M
Set-Cookie: PD-S-SESSION-ID=1_2_0_emFYhh4+VSmX3Doz6WSXRVffTOVyfrsoGIf19pYnIYAc9C3H; Path=/; Secure; HttpOnly^M
^M
<!DOCTYPE HTML PUBLIC ""-//IETF//DTD HTML//EN"">
<!-- Copyright (C) 2000 Tivoli Systems, Inc. -->
<!-- Copyright (C) 1999 IBM Corporation -->
<!-- Copyright (C) 1998 Dascom, Inc. -->
<!-- All Rights Reserved. -->
<!--
     This is a WebSEAL error message template file.  It is used
     by the WebSEAL server to build a response when a particular
     error occurs.  This file can be modified as appropriate.

     Error details:

     * Code: 0x00000000
     * Text: HPDBA0521I   Successful completion

-->
<html>

{noformat}

This seems flow looks to go into a loop which as an example looks to be seen in provided 'isam_9.0.7.2_20230207-124653_glopvmasau01.support_unpack/var/pdweb/eai-b-retail/log/PDWeb_http.log.2023-01-30-03-17-03' file.

{noformat}35.49.28.194 - unauthenticated 27/Jan/2023:14:25:07 +0000 ""GET /eai-jn/favicon.ico HTTP/1.1"" 302 2555
35.49.28.194 - unauthenticated 27/Jan/2023:14:25:07 +0000 ""GET /eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I   Successful completion&METHOD=GET&U\
RL=/eai-jn/favicon.ico&REFERER=https://eai-b-retail.rfs.barclays.co.uk/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completi\
on&METHOD=GET&URL=%2Fteamworks%2FfauxRedirect.lsw%3FzWorkflowState%3D1%26zTaskId%3D2078.34455864&REFERER=&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=&HOSTNAME=eai\
-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION= HTTP/1.1"" 302 3422
35.49.28.194 - unauthenticated 27/Jan/2023:14:25:07 +0000 ""GET /eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I   Successful completion&METHOD=GET&U\
RL=/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&METHOD=GET&URL=%2Feai-jn%2Ffavicon.ico&REFERER=https%3A%2F%2Feai\
-b-retail.rfs.barclays.co.uk%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST%3FTAM_OP%3Dlogin%26USERNAME%3Dunauthenticated%26ERROR_CODE%3D0x00000000%26ERROR_TEXT%3DHPDBA0521I%2520%2520%2520Successful%2520completion%26METHO\
D%3DGET%26URL%3D%252Fteamworks%252FfauxRedirect.lsw%253FzWorkflowState%253D1%2526zTaskId%253D2078.34455864%26REFERER%3D%26HOSTNAME%3Deai-b-retail.rfs.barclays.co.uk%26AUTHNLEVEL%3D%26FAILREASON%3D%26PROTOCOL%3D\
https%26OLDSESSION%3D&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=&REFERER=https://eai-b-retail.rfs.barclays.co.uk/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAM\
E=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&METHOD=GET&URL=%2Fteamworks%2FfauxRedirect.lsw%3FzWorkflowState%3D1%26zTaskId%3D2078.34455864&REFERER=&HOSTNAME=eai-\
b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION= HTTP/1.1"" 302 4435
35.49.28.194 - unauthenticated 27/Jan/2023:14:25:07 +0000 ""GET /eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I   Successful completion&METHOD=GET&U\
RL=/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&METHOD=GET&URL=%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST%3FTAM_OP%3Dl\
ogin%26USERNAME%3Dunauthenticated%26ERROR_CODE%3D0x00000000%26ERROR_TEXT%3DHPDBA0521I%2520%2520%2520Successful%2520completion%26METHOD%3DGET%26URL%3D%252Feai-jn%252Ffavicon.ico%26REFERER%3Dhttps%253A%252F%252Fe\
ai-b-retail.rfs.barclays.co.uk%252Feai-jn%252FBEST-EAS%252Fsecure%252FBEST%253FTAM_OP%253Dlogin%2526USERNAME%253Dunauthenticated%2526ERROR_CODE%253D0x00000000%2526ERROR_TEXT%253DHPDBA0521I%252520%252520%252520S\
uccessful%252520completion%2526METHOD%253DGET%2526URL%253D%25252Fteamworks%25252FfauxRedirect.lsw%25253FzWorkflowState%25253D1%252526zTaskId%25253D2078.34455864%2526REFERER%253D%2526HOSTNAME%253Deai-b-retail.rf\
s.barclays.co.uk%2526AUTHNLEVEL%253D%2526FAILREASON%253D%2526PROTOCOL%253Dhttps%2526OLDSESSION%253D%26HOSTNAME%3Deai-b-retail.rfs.barclays.co.uk%26AUTHNLEVEL%3D%26FAILREASON%3D%26PROTOCOL%3Dhttps%26OLDSESSION%3\
D&REFERER=https%3A%2F%2Feai-b-retail.rfs.barclays.co.uk%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST%3FTAM_OP%3Dlogin%26USERNAME%3Dunauthenticated%26ERROR_CODE%3D0x00000000%26ERROR_TEXT%3DHPDBA0521I%2520%2520%2520Succes\
sful%2520completion%26METHOD%3DGET%26URL%3D%252Fteamworks%252FfauxRedirect.lsw%253FzWorkflowState%253D1%2526zTaskId%253D2078.34455864%26REFERER%3D%26HOSTNAME%3Deai-b-retail.rfs.barclays.co.uk%26AUTHNLEVEL%3D%26\
FAILREASON%3D%26PROTOCOL%3Dhttps%26OLDSESSION%3D&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=&REFERER=https://eai-b-retail.rfs.barclays.co.uk/eai-jn/BEST-EAS/secur\
e/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&METHOD=GET&URL=%2Fteamworks%2FfauxRedirect.lsw%3FzWorkflowState%3D1%26zTaskId%3D2078.3445\
5864&REFERER=&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION= HTTP/1.1"" 30\
2 5594
35.49.28.194 - unauthenticated 27/Jan/2023:14:25:07 +0000 ""GET /eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I   Successful completion&METHOD=GET&U\
RL=/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&METHOD=GET&URL=%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST%3FTAM_OP%3Dl\
ogin%26USERNAME%3Dunauthenticated%26ERROR_CODE%3D0x00000000%26ERROR_TEXT%3DHPDBA0521I%2520%2520%2520Successful%2520completion%26METHOD%3DGET%26URL%3D%252Feai-jn%252FBEST-EAS%252Fsecure%252FBEST%253FTAM_OP%253Dl\
ogin%2526USERNAME%253Dunauthenticated%2526ERROR_CODE%253D0x00000000%2526ERROR_TEXT%253DHPDBA0521I%252520%252520%252520Successful%252520completion%2526METHOD%253DGET%2526URL%253D%25252Feai-jn%25252Ffavicon.ico%2\
526REFERER%253Dhttps%25253A%25252F%25252Feai-b-retail.rfs.barclays.co.uk%25252Feai-jn%25252FBEST-EAS%25252Fsecure%25252FBEST%25253FTAM_OP%25253Dlogin%252526USERNAME%25253Dunauthenticated%252526ERROR_CODE%25253D\
0x00000000%252526ERROR_TEXT%25253DHPDBA0521I%25252520%25252520%25252520Successful%25252520completion%252526METHOD%25253DGET%252526URL%25253D%2525252Fteamworks%2525252FfauxRedirect.lsw%2525253FzWorkflowState%252\
5253D1%25252526zTaskId%2525253D2078.34455864%252526REFERER%25253D%252526HOSTNAME%25253Deai-b-retail.rfs.barclays.co.uk%252526AUTHNLEVEL%25253D%252526FAILREASON%25253D%252526PROTOCOL%25253Dhttps%252526OLDSESSION\
%25253D%2526HOSTNAME%253Deai-b-retail.rfs.barclays.co.uk%2526AUTHNLEVEL%253D%2526FAILREASON%253D%2526PROTOCOL%253Dhttps%2526OLDSESSION%253D%26REFERER%3Dhttps%253A%252F%252Feai-b-retail.rfs.barclays.co.uk%252Fea\
i-jn%252FBEST-EAS%252Fsecure%252FBEST%253FTAM_OP%253Dlogin%2526USERNAME%253Dunauthenticated%2526ERROR_CODE%253D0x00000000%2526ERROR_TEXT%253DHPDBA0521I%252520%252520%252520Successful%252520completion%2526METHOD\
%253DGET%2526URL%253D%25252Fteamworks%25252FfauxRedirect.lsw%25253FzWorkflowState%25253D1%252526zTaskId%25253D2078.34455864%2526REFERER%253D%2526HOSTNAME%253Deai-b-retail.rfs.barclays.co.uk%2526AUTHNLEVEL%253D%\
2526FAILREASON%253D%2526PROTOCOL%253Dhttps%2526OLDSESSION%253D%26HOSTNAME%3Deai-b-retail.rfs.barclays.co.uk%26AUTHNLEVEL%3D%26FAILREASON%3D%26PROTOCOL%3Dhttps%26OLDSESSION%3D&REFERER=https%3A%2F%2Feai-b-retail.\
rfs.barclays.co.uk%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST%3FTAM_OP%3Dlogin%26USERNAME%3Dunauthenticated%26ERROR_CODE%3D0x00000000%26ERROR_TEXT%3DHPDBA0521I%2520%2520%2520Successful%2520completion%26METHOD%3DGET%26\
URL%3D%252Fteamworks%252FfauxRedirect.lsw%253FzWorkflowState%253D1%2526zTaskId%253D2078.34455864%26REFERER%3D%26HOSTNAME%3Deai-b-retail.rfs.barclays.co.uk%26AUTHNLEVEL%3D%26FAILREASON%3D%26PROTOCOL%3Dhttps%26OL\
DSESSION%3D&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=&REFERER=https://eai-b-retail.rfs.barclays.co.uk/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthen\
ticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&METHOD=GET&URL=%2Fteamworks%2FfauxRedirect.lsw%3FzWorkflowState%3D1%26zTaskId%3D2078.34455864&REFERER=&HOSTNAME=eai-b-retail.r\
fs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION= HTTP/1.1"" 302 6899
35.49.28.194 - unauthenticated 27/Jan/2023:14:25:08 +0000 ""GET /eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I   Successful completion&METHOD=GET&U\
RL=/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&METHOD=GET&URL=%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST%3FTAM_OP%3Dl\
ogin%26USERNAME%3Dunauthenticated%26ERROR_CODE%3D0x00000000%26ERROR_TEXT%3DHPDBA0521I%2520%2520%2520Successful%2520completion%26METHOD%3DGET%26URL%3D%252Feai-jn%252FBEST-EAS%252Fsecure%252FBEST%253FTAM_OP%253Dl\
ogin%2526USERNAME%253Dunauthenticated%2526ERROR_CODE%253D0x00000000%2526ERROR_TEXT%253DHPDBA0521I%252520%252520%252520Successful%252520completion%2526METHOD%253DGET%2526URL%253D%25252Feai-jn%25252FBEST-EAS%2525\
2Fsecure%25252FBEST%25253FTAM_OP%25253Dlogin%252526USERNAME%25253Dunauthenticated%252526ERROR_CODE%25253D0x00000000%252526ERROR_TEXT%25253DHPDBA0521I%25252520%25252520%25252520Successful%25252520completion%2525\
26METHOD%25253DGET%252526URL%25253D%2525252Feai-jn%2525252Ffavicon.ico%252526REFERER%25253Dhttps%2525253A%2525252F%2525252Feai-b-retail.rfs.barclays.co.uk%2525252Feai-jn%2525252FBEST-EAS%2525252Fsecure%2525252F\
BEST%2525253FTAM_OP%2525253Dlogin%25252526USERNAME%2525253Dunauthenticated%25252526ERROR_CODE%2525253D0x00000000%25252526ERROR_TEXT%2525253DHPDBA0521I%2525252520%2525252520%2525252520Successful%2525252520comple\
tion%25252526METHOD%2525253DGET%25252526URL%2525253D%252525252Fteamworks%252525252FfauxRedirect.lsw%252525253FzWorkflowState%252525253D1%2525252526zTaskId%252525253D2078.34455864%25252526REFERER%2525253D%252525\
26HOSTNAME%2525253Deai-b-retail.rfs.barclays.co.uk%25252526AUTHNLEVEL%2525253D%25252526FAILREASON%2525253D%25252526PROTOCOL%2525253Dhttps%25252526OLDSESSION%2525253D%252526HOSTNAME%25253Deai-b-retail.rfs.barcla\
ys.co.uk%252526AUTHNLEVEL%25253D%252526FAILREASON%25253D%252526PROTOCOL%25253Dhttps%252526OLDSESSION%25253D%2526REFERER%253Dhttps%25253A%25252F%25252Feai-b-retail.rfs.barclays.co.uk%25252Feai-jn%25252FBEST-EAS%\
25252Fsecure%25252FBEST%25253FTAM_OP%25253Dlogin%252526USERNAME%25253Dunauthenticated%252526ERROR_CODE%25253D0x00000000%252526ERROR_TEXT%25253DHPDBA0521I%25252520%25252520%25252520Successful%25252520completion%\
252526METHOD%25253DGET%252526URL%25253D%2525252Fteamworks%2525252FfauxRedirect.lsw%2525253FzWorkflowState%2525253D1%25252526zTaskId%2525253D2078.34455864%252526REFERER%25253D%252526HOSTNAME%25253Deai-b-retail.r\
fs.barclays.co.uk%252526AUTHNLEVEL%25253D%252526FAILREASON%25253D%252526PROTOCOL%25253Dhttps%252526OLDSESSION%25253D%2526HOSTNAME%253Deai-b-retail.rfs.barclays.co.uk%2526AUTHNLEVEL%253D%2526FAILREASON%253D%2526\
PROTOCOL%253Dhttps%2526OLDSESSION%253D%26REFERER%3Dhttps%253A%252F%252Feai-b-retail.rfs.barclays.co.uk%252Feai-jn%252FBEST-EAS%252Fsecure%252FBEST%253FTAM_OP%253Dlogin%2526USERNAME%253Dunauthenticated%2526ERROR\
_CODE%253D0x00000000%2526ERROR_TEXT%253DHPDBA0521I%252520%252520%252520Successful%252520completion%2526METHOD%253DGET%2526URL%253D%25252Fteamworks%25252FfauxRedirect.lsw%25253FzWorkflowState%25253D1%252526zTask\
Id%25253D2078.34455864%2526REFERER%253D%2526HOSTNAME%253Deai-b-retail.rfs.barclays.co.uk%2526AUTHNLEVEL%253D%2526FAILREASON%253D%2526PROTOCOL%253Dhttps%2526OLDSESSION%253D%26HOSTNAME%3Deai-b-retail.rfs.barclays\
.co.uk%26AUTHNLEVEL%3D%26FAILREASON%3D%26PROTOCOL%3Dhttps%26OLDSESSION%3D&REFERER=https%3A%2F%2Feai-b-retail.rfs.barclays.co.uk%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST%3FTAM_OP%3Dlogin%26USERNAME%3Dunauthenticated%\
26ERROR_CODE%3D0x00000000%26ERROR_TEXT%3DHPDBA0521I%2520%2520%2520Successful%2520completion%26METHOD%3DGET%26URL%3D%252Fteamworks%252FfauxRedirect.lsw%253FzWorkflowState%253D1%2526zTaskId%253D2078.34455864%26RE\
FERER%3D%26HOSTNAME%3Deai-b-retail.rfs.barclays.co.uk%26AUTHNLEVEL%3D%26FAILREASON%3D%26PROTOCOL%3Dhttps%26OLDSESSION%3D&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSIO\
N=&REFERER=https://eai-b-retail.rfs.barclays.co.uk/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login&USERNAME=unauthenticated&ERROR_CODE=0x00000000&ERROR_TEXT=HPDBA0521I%20%20%20Successful%20completion&METHOD=GET&URL=%2\
Fteamworks%2FfauxRedirect.lsw%3FzWorkflowState%3D1%26zTaskId%3D2078.34455864&REFERER=&HOSTNAME=eai-b-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION=&HOSTNAME=eai-b-retail.rfs.barcla\
ys.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION= HTTP/1.1"" 302 8350
{noformat}

Can you check with customer whether the favicon pop and favicon acl are attached to the favicon.ico within the webseal root objectspace ? I do see the ‘favicon.ico’ file within junction-root directory in provided support file, which is correct. So we should check to make sure acl and pop for ‘favicon.ico’ are also set.

i’ll look at other cases data. It may be the same type of problem as this issue, but will verify.

Thanks!",20/Feb/23 6:06 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] I had ask the customer your queries. I also ask the same from the customer on TS011916855. Can you please check the data of TS011916855 and also confirm. All these cases are escalated and we have  meeting for it today at 11:00 AM GMT.,"21/Feb/23 12:44 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] 

Please find the acl and pop for the favicon . please let us know if anything needed.



acl show favicon

ACL Name: favicon

Description: acl to allow favicon.ico file

Entries:

User G01217901 TcmdbsvaBl

Any-other Tr

Unauthenticated Tr





acl find favicon

/WebSEAL/glopvmasau05-eai-a-bcard/favicon.ico

/WebSEAL/slopvmasau04-eai-a-bcard/favicon.ico

/WebSEAL/slopvmasau05-eai-a-bcard/favicon.ico

/WebSEAL/glopvmasau04-eai-a-bcard/favicon.ico



pop show favicon

Protected object policy: favicon

Description:

Warning: No

Audit level: none

Quality of protection: none

Time of day access: sun, mon, tue, wed, thu, fri, sat, :anytime:local

IP Endpoint Authentication Method Policy

Auth Level: 0 Network: Any Other Network





pdadmin G01264274> pop find favicon

/WebSEAL/glopvmasau04-ba-a-bcard/favicon.ico

/WebSEAL/glopvmasau05-ba-a-bcard/favicon.ico

/WebSEAL/slopvmasau04-ba-a-bcard/favicon.ico

/WebSEAL/slopvmasau05-ba-a-bcard/favicon.ico

/WebSEAL/glopvmasau05-eai-a-bcard/favicon.ico

/WebSEAL/slopvmasau04-eai-a-bcard/favicon.ico

/WebSEAL/slopvmasau05-eai-a-bcard/favicon.ico

/WebSEAL/glopvmasau04-eai-a-bcard/favicon.ico





pdadmin G01264274> o s /WebSEAL/eai-a-bcard/gcrp-jn

Name: /WebSEAL/eai-a-bcard/gcrp-jn

Description: Object from host [ldnpsr000002674.intranet.barcapint.com|http://ldnpsr000002674.intranet.barcapint.com].

Type: 16 (Management Object)

Is Policy Attachable: Yes

Extended Attributes:

Attached ACL: gcrp_acl

Attached POP:

Attached AuthzRule:



Effective Extended Attributes:

Effective ACL: gcrp_acl

Effective POP: audit_pop

Effective AuthzRule:","21/Feb/23 3:33 AM;5b15d99182e05b22cc7d5947;Hello Syed,

favicon pop and acl should be attached to all webseal instances favicon object. Base on provided output of both pop and acl find commands both outputs should match. The outputs do not look to match.

Thanks!","21/Feb/23 3:35 AM;5b15d99182e05b22cc7d5947;Hello Syed,

In addition these same commands should be executed for TS011916855 webseal instances.

Thanks!","21/Feb/23 8:27 AM;5b15d99182e05b22cc7d5947;Hello Syed,

For TS011916855 seems the issue is different and do not observe same loop as TS012074480. 

In TS011916855 do see where a SAMLResponse is being created by, I believe a  partner using Ping identity, please confirm.

Do see the following in customers snoop file glop01-pdweb.snoop.log.zip:

{noformat}(275) 2023-02-03-09:49:49.460 Client (35.49.28.194:63964) to WebSEAL (10.109.131.173:51005) sending 1140 bytes
GET /eai-jn/BEST-EAS/secure/BEST?TAM_OP=login_success&USERNAME=G01099864&ERROR_CODE=0x38cf05e7&ERROR_TEXT=DPWWA1511I%20%20%20Login%20successful&METHOD=POST&URL=%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST\
&REFERER=https%3A%2F%2Ffederation.client.barclayscorp.com%2F&HOSTNAME=eai-c-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION= HTTP/1.1^M
Host: eai-c-retail.rfs.barclays.co.uk^M
Connection: keep-alive^M
Cache-Control: max-age=0^M
Upgrade-Insecure-Requests: 1^M
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36^M
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9^M
Sec-Fetch-Site: cross-site^M
Sec-Fetch-Mode: navigate^M
Sec-Fetch-Dest: iframe^M
sec-ch-ua: ""Not?A_Brand"";v=""8"", ""Chromium"";v=""108"", ""Google Chrome"";v=""108""^M
sec-ch-ua-mobile: ?0^M
sec-ch-ua-platform: ""Windows""^M
Referer: https://federation.client.barclayscorp.com/^M
Accept-Encoding: gzip, deflate, br^M
Accept-Language: en-US,en;q=0.9^M
Cookie: s_vi=[CS]v1|31B9A5B98151FABE-40000E6F71A6BC3A[CE]^M
^M

(275) 2023-02-03-09:49:49.465 WebSEAL (10.109.131.203:57674) to BackEnd (10.120.41.88:443) Socket opened.

(275) 2023-02-03-09:49:49.482 WebSEAL (10.109.131.203:57674) to BackEnd (10.120.41.88:443) sending 1214 bytes
GET /BEST-EAS/secure/BEST?TAM_OP=login_success&USERNAME=G01099864&ERROR_CODE=0x38cf05e7&ERROR_TEXT=DPWWA1511I%20%20%20Login%20successful&METHOD=POST&URL=%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST&REFERE\
R=https%3A%2F%2Ffederation.client.barclayscorp.com%2F&HOSTNAME=eai-c-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION= HTTP/1.0^M
accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9^M
accept-language: en-US,en;q=0.9^M
connection: close^M
host: best-eai.barcapint.com^M
iv-user: Unauthenticated^M
referer: https://federation.client.barclayscorp.com/^M
user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36^M
via: HTTP/1.1 eai-c-retail.rfs.barclays.co.uk:51005^M
sec-ch-ua-mobile: ?0^M
cache-control: max-age=0^M
upgrade-insecure-requests: 1^M
sec-fetch-site: cross-site^M
iv_server_name: eai-c-retail-webseald-glopvmasau01^M
sec-fetch-dest: iframe^M
sec-ch-ua-platform: ""Windows""^M
sec-fetch-mode: navigate^M
sec-ch-ua: ""Not?A_Brand"";v=""8"", ""Chromium"";v=""108"", ""Google Chrome"";v=""108""^M
Cookie: s_vi=[CS]v1|31B9A5B98151FABE-40000E6F71A6BC3A[CE]^M
^M

(275) 2023-02-03-09:49:49.488 BackEnd (10.120.41.88:443) to WebSEAL (10.109.131.203:57674) sending 438 bytes
HTTP/1.1 302 Moved Temporarily^M
Pragma: No-cache^M
Cache-Control: no-cache^M
Expires: Thu, 01 Jan 1970 01:00:00 GMT^M
Set-Cookie: JSESSIONID=C14AF1694856FE9CB965D4ABE8B964B6.best_eai_ldnpsr000000378; Path=/BEST-EAS; Secure; HttpOnly^M
Location: https://federation.client.barclayscorp.com/idp/startSSO.ping?PartnerSpId=eai-c-retail-webseald-glopvmasau01^M
Content-Length: 0^M
Date: Fri, 03 Feb 2023 09:49:49 GMT^M
Connection: close^M
Server:  ^M
^M

(275) 2023-02-03-09:49:49.488 WebSEAL (10.109.131.173:51005) to Client (35.49.28.194:63964) sending 595 bytes
HTTP/1.1 302 Moved Temporarily^M
content-length: 0^M
date: Fri, 03 Feb 2023 09:49:49 GMT^M
location: https://federation.client.barclayscorp.com/idp/startSSO.ping?PartnerSpId=eai-c-retail-webseald-glopvmasau01^M
p3p: CP=""NON CUR OTPi OUR NOR UNI""^M
cache-control: no-cache^M
expires: Thu, 01 Jan 1970 01:00:00 GMT^M
strict-transport-security: max-age=31536000; includeSubDomains^M
pragma: No-cache^M
Set-Cookie: JSESSIONID=C14AF1694856FE9CB965D4ABE8B964B6.best_eai_ldnpsr000000378; Path=/eai-jn/BEST-EAS; Secure; HttpOnly^M
Set-Cookie: PD_STATEFUL_eee85e06-de42-11e2-9085-005056a90014=%2Feai-jn; Path=/^M
^M

(275) 2023-02-03-09:49:49.488 WebSEAL (10.109.131.203:57674) to BackEnd (10.120.41.88:443) Shutting down read.

(275) 2023-02-03-09:49:49.488 WebSEAL (10.109.131.203:57674) to BackEnd (10.120.41.88:443) Closing socket.


.
.
.
{noformat}","21/Feb/23 8:30 AM;5b15d99182e05b22cc7d5947;{noformat}(317) 2023-02-03-09:49:49.651 Client (35.49.28.194:63964) to WebSEAL (10.109.131.173:51005) sending 948 bytes
POST /eai-jn/BEST-EAS/secure/BEST HTTP/1.1^M
Host: eai-c-retail.rfs.barclays.co.uk^M
Connection: keep-alive^M
Content-Length: 3481^M
Cache-Control: max-age=0^M
sec-ch-ua: ""Not?A_Brand"";v=""8"", ""Chromium"";v=""108"", ""Google Chrome"";v=""108""^M
sec-ch-ua-mobile: ?0^M
sec-ch-ua-platform: ""Windows""^M
Upgrade-Insecure-Requests: 1^M
Origin: https://federation.client.barclayscorp.com^M
Content-Type: application/x-www-form-urlencoded^M
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36^M
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9^M
Sec-Fetch-Site: cross-site^M
Sec-Fetch-Mode: navigate^M
Sec-Fetch-Dest: iframe^M
Referer: https://federation.client.barclayscorp.com/^M
Accept-Encoding: gzip, deflate, br^M
Accept-Language: en-US,en;q=0.9^M
Cookie: s_vi=[CS]v1|31B9A5B98151FABE-40000E6F71A6BC3A[CE]^M
^M

(317) 2023-02-03-09:49:49.653 Client (35.49.28.194:63964) to WebSEAL (10.109.131.173:51005) sending 3481 bytes
SAMLResponse=PHNhbWxwOlJlc3BvbnNlIFZlcnNpb249IjIuMCIgSUQ9Ikd4Ni1heFNHSW1RSFdoYWliV2xFVW5pWTBkYSIgSXNzdWVJbnN0YW50PSIyMDIzLTAyLTAzVDA5OjQ5OjQ5LjUzNloiIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0F\
NTDoyLjA6cHJvdG9jb2wiPjxzYW1sOklzc3VlciB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5odHRwOi8vZmVkZXJhdGlvbi5iYXJjYXBpbnQuY29tL2ZlZC9pZHA8L3NhbWw6SXNzdWVyPjxzYW1scDpTdGF0dXM\
%2BPHNhbWxwOlN0YXR1c0NvZGUgVmFsdWU9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2VzcyIvPjwvc2FtbHA6U3RhdHVzPjxzYW1sOkFzc2VydGlvbiBJRD0iUlFjdC5NNG9pVUdoSkxrRzJMMTVvN1ZZdkFhIiBJc3N1ZUluc3Rhb\
nQ9IjIwMjMtMDItMDNUMDk6NDk6NDkuNTQ3WiIgVmVyc2lvbj0iMi4wIiB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj48c2FtbDpJc3N1ZXI%2BaHR0cDovL2ZlZGVyYXRpb24uYmFyY2FwaW50LmNvbS9mZWQvaWR\
wPC9zYW1sOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj4KPGRzOlNpZ25lZEluZm8%2BCjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vc\
mcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8%2BCjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ii8%2BCjxkczpSZWZlcmVuY2UgVVJJPSIjUlFjdC5NNG9pVUdoS\
kxrRzJMMTVvN1ZZdkFhIj4KPGRzOlRyYW5zZm9ybXM%2BCjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIvPgo8ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDo\
vL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8%2BCjwvZHM6VHJhbnNmb3Jtcz4KPGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIvPgo8ZHM6RGlnZXN0VmFsdWU%2BdHJ\
nalMrWENpWG5hZW8zRGl1Y2lGUndRZGUzQ2ZacTMyQnpJbWZWL0oxST08L2RzOkRpZ2VzdFZhbHVlPgo8L2RzOlJlZmVyZW5jZT4KPC9kczpTaWduZWRJbmZvPgo8ZHM6U2lnbmF0dXJlVmFsdWU%2BCmFmSGJRdW1ZbjdCUEdWOGgyVHg2Zk0ydnR5QWExTDBGd\
081VU9DNlhUUzRFK2ErYjMvQlR5NHdOc3J2bVNReHp6M241VlhuZWNJQVAKak1XQ0dDOHo5WkI4U0F0bWNDQTBGbEhZNk9MNUorbUsrOC9CbS9tYk4yeDFLTXJBc2FZckcrd0xhN25MdVBaUjhSQ0QrNmIzd0QrRwppNnIyQVpUcXpVQmUxZXlrZGRlcms3aEtCK\
1NQdFRxSDR2WEhSOGFWMHBURjZPZ2ZHTkZDVGdrYmoxdTFvUTJBdEZCblBvNWUyRmxzCjc5S0w3SG82amd2bG54M2JieC9zUWRWNzRyT3lVOEtUUERqc3JsOTJ3R0VZOUdiVmljQVp0cDNpNisvRW5zVnZ6c09hd2JaWVFvMW8KR1RUTjdqVDhMejhaSTFQU0t3W\
mZyYUM1T0lheDBnL0JFMVJGb3c9PQo8L2RzOlNpZ25hdHVyZVZhbHVlPgo8L2RzOlNpZ25hdHVyZT48c2FtbDpTdWJqZWN0PjxzYW1sOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0Olg1MDlTdWJqZWN0T\
mFtZSI%2BRzAxMDk5ODY0PC9zYW1sOk5hbWVJRD48c2FtbDpTdWJqZWN0Q29uZmlybWF0aW9uIE1ldGhvZD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmNtOmJlYXJlciI%2BPHNhbWw6U3ViamVjdENvbmZpcm1hdGlvbkRhdGEgUmVjaXBpZW50PSJod\
HRwczovL2VhaS1jLXJldGFpbC5yZnMuYmFyY2xheXMuY28udWsvZWFpLWpuL0JFU1QtRUFTL3NlY3VyZS9CRVNUIiBOb3RPbk9yQWZ0ZXI9IjIwMjMtMDItMDNUMDk6NTQ6NDkuNTQ3WiIvPjwvc2FtbDpTdWJqZWN0Q29uZmlybWF0aW9uPjwvc2FtbDpTdWJqZ\
WN0PjxzYW1sOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDIzLTAyLTAzVDA5OjQ0OjQ5LjU0N1oiIE5vdE9uT3JBZnRlcj0iMjAyMy0wMi0wM1QwOTo1NDo0OS41NDdaIj48c2FtbDpBdWRpZW5jZVJlc3RyaWN0aW9uPjxzYW1sOkF1ZGllbmNlPmVhaS1jLXJld\
GFpbC13ZWJzZWFsZC1nbG9wdm1hc2F1MDE8L3NhbWw6QXVkaWVuY2U%2BPC9zYW1sOkF1ZGllbmNlUmVzdHJpY3Rpb24%2BPC9zYW1sOkNvbmRpdGlvbnM%2BPHNhbWw6QXV0aG5TdGF0ZW1lbnQgU2Vzc2lvbkluZGV4PSJSUWN0Lk00b2lVR2hKTGtHMkwxNW8\
3Vll2QWEiIEF1dGhuSW5zdGFudD0iMjAyMy0wMi0wM1QwOTo0OTo0OS41NDZaIj48c2FtbDpBdXRobkNvbnRleHQ%2BPHNhbWw6QXV0aG5Db250ZXh0Q2xhc3NSZWY%2BdXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6dW5zcGVjaWZpZWQ\
8L3NhbWw6QXV0aG5Db250ZXh0Q2xhc3NSZWY%2BPC9zYW1sOkF1dGhuQ29udGV4dD48L3NhbWw6QXV0aG5TdGF0ZW1lbnQ%2BPC9zYW1sOkFzc2VydGlvbj48L3NhbWxwOlJlc3BvbnNlPg%3D%3D
(317) 2023-02-03-09:49:49.658 WebSEAL (10.109.131.203:39806) to BackEnd (22.126.66.150:443) Socket opened.

(317) 2023-02-03-09:49:49.675 WebSEAL (10.109.131.203:39806) to BackEnd (22.126.66.150:443) sending 4096 bytes
POST /BEST-EAS/secure/BEST HTTP/1.0^M
accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9^M
accept-language: en-US,en;q=0.9^M
connection: close^M
content-length: 3481^M
content-type: application/x-www-form-urlencoded^M
host: best-eai-dr.barcapint.com^M
iv-user: Unauthenticated^M
referer: https://federation.client.barclayscorp.com/^M
user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36^M
via: HTTP/1.1 eai-c-retail.rfs.barclays.co.uk:51005^M
origin: https://federation.client.barclayscorp.com^M
sec-ch-ua-mobile: ?0^M
cache-control: max-age=0^M
upgrade-insecure-requests: 1^M
sec-fetch-site: cross-site^M
iv_server_name: eai-c-retail-webseald-glopvmasau01^M
sec-fetch-dest: iframe^M
sec-ch-ua-platform: ""Windows""^M
sec-ch-ua: ""Not?A_Brand"";v=""8"", ""Chromium"";v=""108"", ""Google Chrome"";v=""108""^M
sec-fetch-mode: navigate^M
Cookie: s_vi=[CS]v1|31B9A5B98151FABE-40000E6F71A6BC3A[CE]^M
^M
SAMLResponse=PHNhbWxwOlJlc3BvbnNlIFZlcnNpb249IjIuMCIgSUQ9Ikd4Ni1heFNHSW1RSFdoYWliV2xFVW5pWTBkYSIgSXNzdWVJbnN0YW50PSIyMDIzLTAyLTAzVDA5OjQ5OjQ5LjUzNloiIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0F\
NTDoyLjA6cHJvdG9jb2wiPjxzYW1sOklzc3VlciB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5odHRwOi8vZmVkZXJhdGlvbi5iYXJjYXBpbnQuY29tL2ZlZC9pZHA8L3NhbWw6SXNzdWVyPjxzYW1scDpTdGF0dXM\
%2BPHNhbWxwOlN0YXR1c0NvZGUgVmFsdWU9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2VzcyIvPjwvc2FtbHA6U3RhdHVzPjxzYW1sOkFzc2VydGlvbiBJRD0iUlFjdC5NNG9pVUdoSkxrRzJMMTVvN1ZZdkFhIiBJc3N1ZUluc3Rhb\
nQ9IjIwMjMtMDItMDNUMDk6NDk6NDkuNTQ3WiIgVmVyc2lvbj0iMi4wIiB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj48c2FtbDpJc3N1ZXI%2BaHR0cDovL2ZlZGVyYXRpb24uYmFyY2FwaW50LmNvbS9mZWQvaWR\
wPC9zYW1sOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj4KPGRzOlNpZ25lZEluZm8%2BCjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vc\
mcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8%2BCjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ii8%2BCjxkczpSZWZlcmVuY2UgVVJJPSIjUlFjdC5NNG9pVUdoS\
kxrRzJMMTVvN1ZZdkFhIj4KPGRzOlRyYW5zZm9ybXM%2BCjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIvPgo8ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDo\
vL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8%2BCjwvZHM6VHJhbnNmb3Jtcz4KPGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIvPgo8ZHM6RGlnZXN0VmFsdWU%2BdHJ\
nalMrWENpWG5hZW8zRGl1Y2lGUndRZGUzQ2ZacTMyQnpJbWZWL0oxST08L2RzOkRpZ2VzdFZhbHVlPgo8L2RzOlJlZmVyZW5jZT4KPC9kczpTaWduZWRJbmZvPgo8ZHM6U2lnbmF0dXJlVmFsdWU%2BCmFmSGJRdW1ZbjdCUEdWOGgyVHg2Zk0ydnR5QWExTDBGd\
081VU9DNlhUUzRFK2ErYjMvQlR5NHdOc3J2bVNReHp6M241VlhuZWNJQVAKak1XQ0dDOHo5WkI4U0F0bWNDQTBGbEhZNk9MNUorbUsrOC9CbS9tYk4yeDFLTXJBc2FZckcrd0xhN25MdVBaUjhSQ0QrNmIzd0QrRwppNnIyQVpUcXpVQmUxZXlrZGRlcms3aEtCK\
1NQdFRxSDR2WEhSOGFWMHBURjZPZ2ZHTkZDVGdrYmoxdTFvUTJBdEZCblBvNWUyRmxzCjc5S0w3SG82amd2bG54M2JieC9zUWRWNzRyT3lVOEtUUERqc3JsOTJ3R0VZOUdiVmljQVp0cDNpNisvRW5zVnZ6c09hd2JaWVFvMW8KR1RUTjdqVDhMejhaSTFQU0t3W\
mZyYUM1T0lheDBnL0JFMVJGb3c9PQo8L2RzOlNpZ25hdHVyZVZhbHVlPgo8L2RzOlNpZ25hdHVyZT48c2FtbDpTdWJqZWN0PjxzYW1sOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0Olg1MDlTdWJqZWN0T\
mFtZSI%2BRzAxMDk5ODY0PC9zYW1sOk5hbWVJRD48c2FtbDpTdWJqZWN0Q29uZmlybWF0aW9uIE1ldGhvZD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmNtOmJlYXJlciI%2BPHNhbWw6U3ViamVjdENvbmZpcm1hdGlvbkRhdGEgUmVjaXBpZW50PSJod\
HRwczovL2VhaS1jLXJldGFpbC5yZnMuYmFyY2xheXMuY28udWsvZWFpLWpuL0JFU1QtRUFTL3NlY3VyZS9CRVNUIiBOb3RPbk9yQWZ0ZXI9IjIwMjMtMDItMDNUMDk6NTQ6NDkuNTQ3WiIvPjwvc2FtbDpTdWJqZWN0Q29uZmlybWF0aW9uPjwvc2FtbDpTdWJqZ\
WN0PjxzYW1sOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDIzLTAyLTAzVDA5OjQ0OjQ5LjU0N1oiIE5vdE9uT3JBZnRlcj0iMjAyMy0wMi0wM1QwOTo1NDo0OS41NDdaIj48c2FtbDpBdWRpZW5jZVJlc3RyaWN0aW9uPjxzYW1sOkF1ZGllbmNlPmVhaS1jLXJld\
GFpbC13ZWJzZWFsZC1nbG9wdm1hc2F1MDE8L3NhbWw6QXVkaWVuY2U%2BPC9zYW1sOkF1ZGllbmNlUmVzdHJpY3Rpb24%2BPC9zYW1sOkNvbmRpdGlvbnM%2BPHNhbWw6QX
(317) 2023-02-03-09:49:49.675 WebSEAL (10.109.131.203:39806) to BackEnd (22.126.66.150:443) sending 410 bytes
V0aG5TdGF0ZW1lbnQgU2Vzc2lvbkluZGV4PSJSUWN0Lk00b2lVR2hKTGtHMkwxNW83Vll2QWEiIEF1dGhuSW5zdGFudD0iMjAyMy0wMi0wM1QwOTo0OTo0OS41NDZaIj48c2FtbDpBdXRobkNvbnRleHQ%2BPHNhbWw6QXV0aG5Db250ZXh0Q2xhc3NSZWY%2BdX\
JuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6dW5zcGVjaWZpZWQ8L3NhbWw6QXV0aG5Db250ZXh0Q2xhc3NSZWY%2BPC9zYW1sOkF1dGhuQ29udGV4dD48L3NhbWw6QXV0aG5TdGF0ZW1lbnQ%2BPC9zYW1sOkFzc2VydGlvbj48L3NhbWxwOl\
Jlc3BvbnNlPg%3D%3D

(317) 2023-02-03-09:49:49.826 BackEnd (22.126.66.150:443) to WebSEAL (10.109.131.203:39806) sending 359 bytes
HTTP/1.1 302 Moved Temporarily^M
Set-Cookie: JSESSIONID=D8150E2558CD5787ADBD480083C4BA1C.best_eai_gbrpsr000000343; Path=/BEST-EAS; Secure; HttpOnly^M
am-eai-user-id: G01099864^M
am-eai-auth-level: 1^M
Location: https://best-eai-dr.barcapint.com/BEST-EAS/secure/postauth.jsp^M
Content-Length: 0^M
Date: Fri, 03 Feb 2023 09:49:49 GMT^M
Connection: close^M
Server:  ^M
^M

(317) 2023-02-03-09:49:49.826 WebSEAL (10.109.131.203:39806) to BackEnd (22.126.66.150:443) Shutting down read.

(317) 2023-02-03-09:49:49.826 WebSEAL (10.109.131.203:39806) to BackEnd (22.126.66.150:443) Closing socket.
{noformat}","21/Feb/23 8:36 AM;5b15d99182e05b22cc7d5947;{noformat}(317) 2023-02-03-09:49:49.834 WebSEAL (10.109.131.173:51005) to Client (35.49.28.194:63964) sending 4096 bytes
HTTP/1.1 302 Moved Temporarily^M
content-length: 1821^M
content-type: text/html; charset=UTF-8^M
date: Fri, 03 Feb 2023 09:49:49 GMT^M
location: https://eai-c-retail.rfs.barclays.co.uk/eai-jn/BEST-EAS/secure/BEST?TAM_OP=login_success&USERNAME=G01099864&ERROR_CODE=0x38cf05e7&ERROR_TEXT=DPWWA1511I%20%20%20Login%20successful&METHOD=\
POST&URL=%2Feai-jn%2FBEST-EAS%2Fsecure%2FBEST&REFERER=https%3A%2F%2Ffederation.client.barclayscorp.com%2F&HOSTNAME=eai-c-retail.rfs.barclays.co.uk&AUTHNLEVEL=&FAILREASON=&PROTOCOL=https&OLDSESSION\
=^M
p3p: CP=""NON CUR OTPi OUR NOR UNI""^M
x-frame-options: DENY^M
x-content-type-options: nosniff^M
cache-control: no-store^M
x-xss-protection: 1^M
content-security-policy: frame-ancestors 'none'^M
strict-transport-security: max-age=31536000; includeSubDomains^M
pragma: no-cache^M
Set-Cookie: JSESSIONID=D8150E2558CD5787ADBD480083C4BA1C.best_eai_gbrpsr000000343; Path=/eai-jn/BEST-EAS; Secure; HttpOnly^M
Set-Cookie: PD_STATEFUL_3ba7c4f2-de43-11e2-ae49-005056a90014=%2Feai-jn; Path=/^M
Set-Cookie: PD-S-SESSION-ID=1_2_1_i5iQTzdT0sss3Yx3n9CbwS+ZG2Pi2c9pH3G0UubWSGJOYLTL; Path=/; Secure; HttpOnly^M
Set-Cookie: PD-ID=-wx-4Z6ih6MGUmUD+9jzLcU13NUAN+qQaXgRTMfP1SRZc4EIj3MJ1cjG7kZFRtZdr4MhzMtg68GPxhebK+df8qBzKjJHHNkmFJg-rFX0VurRDc3T+donP0rxUyJ-Gmz8qJ6lB1ekorXULDXwilfT8+cBggENeCbvgIE7XtaeHD7-IOJY5G\
Rdne4CLz2oKV7z7Fcur7M9R2BLKRw3qRZY0+HQ-1mNkaPWZx2GDmBywdd5RcBjLwvuqJKIHC+rA7UuPn5JsThlOZ8IxpfvyvXeIyDvnYXVw1OrXFDpMUpklpq558sHiPmPzXOtXvXzLbiSaLkKVO0osPTnP9R0R6Xl1K4kEh5w4GEMQTRejEpJ3tXgxpnV6Uv60G\
McISFi8W0y0A8oCPgueDxAcVWDmr0xrWu4-w6bTl4mOO8ocOOVTL1t7q2HKYzf9qW7hNuTH78ReRwmX1ELmCZLwuEy5-Bs2Ykp+wWaTYG73S1CsY0ebqJPGksgp9UPZ7Yy5a6IpminyMnAccmxCiiSlczJK0edJRmhvPXBxUcWCCGI9nROGAdX800u+uWRJXKOG3\
NEzI-AyfVRB27Z1SlXtJ7ZCXaVHnhGKLA3gnqg05LdTOPyFSv+HZ+xRwgae-DzcTx3Hf3P5BUbgIrqNwdKMQKzoRWYugvtAiKmkVYGTpUSnc7HmVbn5caXSyX2AlSPR6zEwjevnPVvOGL9DiEJN0PpuS9WNV4NdopIYusOq32tP5XkvsBYN5OnxPC8UIZjoeJbQo\
yrPkKyMRWKTE5h58IoTjaW5D56q0rSUDWB0pJORyABxFAuRrFA6Vqj6dRMIxY11sB7pMlwH+oDnwBe2nOxNv-6I1OhJB42UhrVNz+duLqd-AcW7iJkGfYBMtKjCVBh8Jb-FzepH2Ter1KBIYWeuoYZ-6RvJ1KYVJKhDIMCVa-P0QGjeCdHJFKSVCcLAtv5KhAlE2\
90+bQPCV+iv9dxVBrPaaBxV+Lrc3iNbzaKpbEUG3fbjwG3-NNcxr-MAPjzEyZgh8fXlEOROROJhymHctDWOy7GT72K+1jeBNvOLFTj+MQCtEDfk3KNgmw9oUF741H5vdYJqdyWKQ+lxWy6Z936sfsvHfxzmJNAcq9TB5el4P3zD0VUd7tmWi21-qoap+qtNkWwV3\
6AmWxzzl4oKpCEufDYg2Mu1HEQWSHh0iYEYiMJVHo-AoK-WFQ+Uj3EyOpboyc0pdZhS0qgCnSkRo209k56oQX5aXyPm1jAiPZWGXCFcfuMSeZyzWfJHellmHdPyhhJ7VQWVeLNJ8EpmmOjTLbmQMoURTSa3X2WjvLstF+0MnqCQBu7-Xx8FnJtIv2xPXpz9LI1N8\
wKYPMjoMf6Y4z4CNLqRQplxulxkydNcfZUGrvvcrjExzZuQHWp1gWblgoggQOofqAzPl7K31DXOYeY8ZExSeO8Xn3AzvWgaxFfUDO33xDG7UBhL66nXmHj-0oAcsqpg1ucIJWk9ssdIxdghAUrOJr90vu9NG6lcJPQ07NG79XtWszKBrbXA+VBNMpj5H4wPivyG6\
f13CvYKP+kW6nEbD8xQI7halVlGQNom3Z+qCr9YD8+jw-+r5J5CCJB7duJmVCMO0IzSHzvg6n9Qae8CLehI+vam+O6sLI=; Domain=.rfs.barclays.co.uk; Path=/; Secure; HttpOnly^M
^M
{noformat}

Does this flow for this case TS011916855 is the cause of TS011916855 issue. Need L2 and customer to confirm.



Thanks!",22/Feb/23 2:03 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d99182e05b22cc7d5947] Just a quick heads up that [~accountid:5b232b2fd85e5b59b066f57f] had a call with Barclays bank tonight and they have advised that this item is their most important to have resolved as soon as we can. I can see that you are already engaged on this and appreciate if we can keep the momentum going to ensure that we can assist our customer meet their upgrade deadline. ,"22/Feb/23 11:58 AM;5b15d99182e05b22cc7d5947;Hello Syed,

Looking further into TS011916855 seems the SAMLResponse is not for ISVA federation to consume but rather an a different product? Will need confirmation on this. 

Reason is normally ISVA federation URL paths begin with ‘sps’. In customers case the samlresponse is directed to ‘{{POST /BEST-EAS/secure/BEST}}' for consumption. In customer’s webseal for EAI triggering do see the following one URL:

{noformat}# EAI TRIGGER URLS                                                                                       
[eai-trigger-urls]

# If eai-auth is not 'none', then WebSEAL will examine the URLs of incoming                              
# requests to determine if they match one of the entries in this list.                                   
# If they do, then WebSEAL will examine the corresponding server response to                             
# determine if it contains authentication data.                                                          
#                                                                                                        
# NOTE: If eai-auth is not 'none', there must be at least one entry in this list                         
#                                                                                                        
# The URL string patterns are case-insensitive wild card patterns.                                       
#                                                                                                        
# Format for regular WebSEAL junctions is:                                                               
#   trigger = <URL pattern of EAI server response>                                                       
#                                                                                                        
# Format for Virtual Host junctions is:                                                                  
#   trigger = HTTP[S]://virtual-host-name[:port]/<URL pattern of EAI server response>                    
#                                                                                                        
# For Virtual Host junctions to match a trigger they must also have the same                             
# protocol (HTTP[S] = TCP/SSL) and have the same virtual-host-name & port as                             
# the trigger.  The virtual-host-name match is case-insensitive.                                         
#                                                                                                        
# Regular WebSEAL junction triggers are not used by Virtual Host junctions.                              
# Virtual Host junction triggers are not used by regular WebSEAL junctions.                              
# Parameters for eai-trigger-urls stanza derives from wrapper cookbook eai_trigger_url_param.erb templat\
e                                                                                                        
trigger = /eai-jn/BEST-EAS/secure/BEST
{noformat}

and also see LRR configured

{noformat}[local-response-redirect]

# URL to which management page requests are redirected. All management                                   
# requests will be redirected to this URL with a query string indicating                                 
# the operation requested, along with any macros (as configured in the                                   
# [local-response-macros] stanza). See the WebSEAL Admin Guide for the                                   
# specific format of the query string, and how the receiving handler should                              
# treat the requests.                                                                                    
#                                                                                                        
# The URL may be absolute or server-relative. Only use an absolute URL if                                
# the destination server is not accessed via WebSEAL.                                                    
#                                                                                                        
# Valid formats are:                                                                                     
#  http[s]://<server>/<path>                                                                             
#  /<path>                                                                                               
#                                                                                                        
# This configuration item may be customized for a particular junction                                    
# by adding the adjusted configuration item to a                                                         
# [local-response-redirect:{jct_id}] stanza, where '{jct-id}' refers to                                  
# the junction point for a standard junction (include the leading '/'),                                  
# or the virtual host label for a virtual host junction.                                                 
local-response-redirect-uri = /eai-jn/BEST-EAS/secure/BEST

#local-response-redirect-uri = /jct/redirect/handler                                                     
{noformat}

Since {{local-response-redirect-uri = /eai-jn/BEST-EAS/secure/BEST}} and {{trigger = /eai-jn/BEST-EAS/secure/BEST}} are the same this may be causing this loop.

Suggest L2 and customer discuss these configuration and understand flow customer is trying to achieve. After SAMLresponse is consume by backend do see the 302 response with {{Location: https://best-eai-dr.barcapint.com/BEST-EAS/secure/postauth.jsp}} which looks to be a correct landing page . However this redirect looks to be rewritten by webseal by LRR when sending response back to client.



Thanks!","23/Feb/23 5:52 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] For TS011916855 : We are not using the ISVA federation . Currently we are using ISAM 9.0.7.2 product. We are using EAI (External Authentication Interface) authentication which is out sourcing the authentication to the third party federation server which is doing the authentication and it will redirect the junction for authorization with ISAM 9.0.7.2 and provides the access to the users.

In addition this customer have seen the difference for both ISAM9 and ISAM7 config setup of [eai] stanza

The below values are extra on ISAM9 and these are not present on ISAM7

eai-redir-url-priority = false

eai-create-multi-valued-attributes = no

eai-replace-cred-attributes = no

Does these extra values makes any issue ?","25/Feb/23 12:50 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] Customer upload the new set of data on below.

[TS011916855 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011916855&path=TS011916855%2F2023-02-24%2F&filepath=TS011916855%2F2023-02-24%2Fglopvmasau01_09022023.zip]","25/Feb/23 2:39 AM;5b15d99182e05b22cc7d5947;Hello Syed,

What is new data capturing?

Also what is status TS012074480?

Thanks!","25/Feb/23 3:13 AM;5b15d99182e05b22cc7d5947;Hello Syed,

In regards to the eai settings posted, those do not look to cause the looping after successful SAMLresponse and 302 redirect.

Thanks!","27/Feb/23 5:54 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] Hi George, 

Also what is status TS012074480? Expert lab had advise and they are testing it the solution works or not.

The customer load new data for EAI settings.","01/Mar/23 11:04 AM;5b15d99182e05b22cc7d5947;Hello Syed,

As updated earlier the TS011916855 issue looks to be due to same URI used for both EAI and LRR configuration. 

For 907x we do document same URI for both EAI and LRR should not be used which is documented in third bullet:

[https://www.ibm.com/docs/en/sva/9.0.7?topic=redirection-technical-notes-local-response|https://www.ibm.com/docs/en/sva/9.0.7?topic=redirection-technical-notes-local-response|smart-link] 

Customer should look into moving either LRR or EAI do different URIs.



Thanks!","11/Mar/23 1:14 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947]  Customer upload new set of files 

Am uploading logs now , you might receive which are related to SSO issue for the below webseal URL.



[+https://eai-c-retail.rfs.barclays.co.uk/ldglive3/ProcessPortal/login.jsp+|https://eai-c-retail.rfs.barclays.co.uk/ldglive3/ProcessPortal/login.jsp]

User ID : – G01214123

Time of issue - Thu, 02 Mar 2023 10:46 GMT

[TS011916855 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011916855&path=TS011916855%2F2023-03-10%2F&filepath=TS011916855%2F2023-03-10%2FEAI-C-RETAIL_Pdweb.Snoop_Logs_ldglive3.zip]

Customer is asking for Anton to look at it.","13/Mar/23 10:36 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] A new set of logs.

[TS011916855 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011916855&path=TS011916855%2F2023-03-13%2F&filepath=TS011916855%2F2023-03-13%2FEAI-C-RETAIl_WebSEAL_URL_User_Details_HAR_DATA.zip]","14/Mar/23 10:28 AM;5b15d99182e05b22cc7d5947;Hello Syed,

What is different in new logs? Have they made new changes to webseal config?

Thanks!","14/Mar/23 6:49 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] No changes made at reverse proxy side.



Here we are tracking 3 issues so to avoid any confusion on logs just collected fresh logs with date and time when issue occurred and created separate folders on each issue so that can makes clear idea on logs.","17/Mar/23 8:27 AM;5b15d99182e05b22cc7d5947;Hello Syed,

New case needs requires a new JIRA. This JIRA is only for remaining TS011916855.

Thanks!","20/Mar/23 6:19 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] The customer upload the new logs in ecurep of TS011916855. There is no need for a new JIRA. It was escalated twice customer is in panic.

[+TS011916855 - Archive Explorer 5.0 (ibm.com)+|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011916855&path=TS011916855%2F2023-03-13%2F&filepath=TS011916855%2F2023-03-13%2FEAI-C-RETAIl_WebSEAL_URL_User_Details_HAR_DATA.zip]","21/Mar/23 1:34 AM;5b15d99182e05b22cc7d5947;Hello Syed,

Do not understand. Already provided solution earlier for TS011916855 here  [https://cloudidentity.atlassian.net/browse/ISAMSUP-4784?focusedCommentId=612011|https://cloudidentity.atlassian.net/browse/ISAMSUP-4784?focusedCommentId=612011|smart-link] .

Thanks!","21/Mar/23 1:43 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] It is for TS012074480. The TS011916855 is for SSO login issue. 

There is a mail from Fergus on this case 

Just following up internally for status on these Barclays cases. All cases are currently pending customer.

 

*TS011916855*

From L3 the feedback is:

_Issue looks to be due to same URL used for both EAI and LRR configuration. For 907x we do document same URI for both EAI and LRR should not be used which is documented in third bullet:_

[https://www.ibm.com/docs/en/sva/9.0.7?topic=redirection-technical-notes-local-response|https://www.ibm.com/docs/en/sva/9.0.7?topic=redirection-technical-notes-local-response|smart-link] 

_Customer should look into moving either LRR or EAI do different URIs._

 

Anton, you also replied to customer with some feedback on this issue:

_There are a bunch of looping request that are definitely /ldglive3; this looks similar to the accumulating loop we saw for TS011228757 with TAM7 style behaviour._

_There are also high frequency requests, which may be a loop that I cannot attribute to a specific junction as I do not have debug logs._

_I also see high frequency requests which could be a loop for /onetallymanlive-jn; however it is not accumulating as for the /ldglive3._

 

I just want to make sure we are consistent with any recommendations for this issue.

Anton - Would it help to have an internal discussion on this with George?","21/Mar/23 2:35 AM;5b15d99182e05b22cc7d5947;Hello Syed,

Recommendation has not changed. Has customer tried the recommendation?

Thanks!",21/Mar/23 2:37 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] Yes they had tried the recommendation but still it is same. ,"21/Mar/23 2:50 AM;5b15d99182e05b22cc7d5947;Hello Syed,

What are the new LRR and EAI customer is using?



Thanks!","31/Mar/23 6:58 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d99182e05b22cc7d5947] Customer reply 

This is certificate based authentication.

enable-local-response-redirect = no","01/Apr/23 3:58 AM;5b15d99182e05b22cc7d5947;Hello Syed,

what does certificate authentication has to do with this jira? This Jira is for SSO Login. 

Already provided recommendation. What is status of the provided recommendation?

Thanks!",20/Apr/23 1:10 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020]  assigning this item to you to assist in the future.  If you need support can you please work work with [~accountid:5b15d99182e05b22cc7d5947]  on this.,"04/May/23 11:14 PM;617a5f2cf485cd0068cb98af;[~accountid:5ac57757d9a96536d1f0daa9] Customer update is below.

EAI has been updated to handle scenario where auth request goes into infinite loop.

However, the issue persists whereby initial Load Balanced URL which is accessed changes to the URL of the junctioned backend server.","05/May/23 12:04 AM;5b15d94b6256d01ad54eb020;[~accountid:617a5f2cf485cd0068cb98af] This Jira item was reassigned to me.  I need to look over the history and the logs to familiarize myself with the issue.

Have they provided new support files after the changes?",05/May/23 12:08 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d94b6256d01ad54eb020] Ask the customer now the support file.,"10/May/23 12:02 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d94b6256d01ad54eb020] Customer upload the support  files after making the changes

[TS011916855 - Archive Explorer 5.0 (ibm.com)|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011916855&path=TS011916855%2F2023-05-09%2F&filepath=TS011916855%2F2023-05-09%2Fisam_9.0.7.2_20230509-132447_glopvmasau03.support]","10/May/23 4:26 AM;5b15d94b6256d01ad54eb020;What is the difference between the support files?  They uploaded 6 of them?

What were the exact changes they made?",10/May/23 4:40 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d94b6256d01ad54eb020] Support files for all 6 appliances are uploaded where they have the issue.,11/May/23 12:22 AM;5b15d94b6256d01ad54eb020;[~accountid:617a5f2cf485cd0068cb98af]I’ll review the logs and see what I can figure out but  you missed one of my questions.  What was the exact change made?,"11/May/23 1:15 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d94b6256d01ad54eb020] Customer reply is below.

The 6 support files are from 6 appliances where eai-c-retail reverse proxy is configured.

The issue still persists and they are provided as per your request to continue troubleshooting the issue.","11/May/23 1:19 AM;5b15d94b6256d01ad54eb020;[~accountid:617a5f2cf485cd0068cb98af] I know asked for them.   

You said:  “EAI has been updated to handle scenario where auth request goes into infinite loop.”

What was that exact change?","11/May/23 1:44 AM;617a5f2cf485cd0068cb98af;[~accountid:5b15d94b6256d01ad54eb020] Customer reply is below.

Update on the case previously had mentioned LRR setting:



""Issue looks to be due to same URL used for both EAI and LRR configuration. For 907x we do document same URI for both EAI and LRR should not be used which is documented in third bullet:

Customer should look into moving either LRR or EAI do different URIs.

Technical notes for local response redirection - IBM Documentation""



This is what has been addressed in terms of EAI update.



However, even after the EAI config update, the issue persists whereby user hits LB URL i.e.:

[https://eai-c-retail.rfs.barclays.co.uk/ldglive3/ProcessPortal/login.jsp|https://eai-c-retail.rfs.barclays.co.uk/ldglive3/ProcessPortal/login.jsp]



However, we see that URL changes to that of backend server configured in the junction.

This effectively seems to by pass reverse proxy.



So this issue still persists. If this update is confusing or that you would like further clarification, please make yourself/L3 available for WebEx call where we can demonstrate this issue to you.","11/May/23 8:12 AM;5b15d94b6256d01ad54eb020;*Internal Comment:*

[~accountid:617a5f2cf485cd0068cb98af]  you should not have had to ask the customer about the changes.  I wanted to know what you  asked them to change. George mentioned it several times.   You should have done a basic analysis on the new support files to  at least determine  if the correct data was provided.   I ran a diff on three of the  support files to compare webseald-eai-c-retail.conf  against  earlier support files and they are identical.   It doesn’t look like anything was changed.  I could only compare three because the other three were new host names.

George mentioned several times regarding his recommendation which was:  

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4784#:~:text=Do%20not%20understand,IN%20PROGRESS|https://cloudidentity.atlassian.net/browse/ISAMSUP-4784#:~:text=Do%20not%20understand,IN%20PROGRESS|smart-link] 

In every webseald-eai-c-retail.conf  file  from  05-09-2023  it contains these two settings:

local-response-redirect-uri = /eai-jn/BEST-EAS/secure/BEST

trigger = /eai-jn/BEST-EAS/secure/BEST

They should be different but they are not.

*– end Internal comment*



You mentioned previously:

“Customer update is below.

EAI has been updated to handle scenario where auth request goes into infinite loop.  

However, the issue persists whereby initial Load Balanced URL which is accessed changes to the URL of the junctioned backend server. “



Do we have support file(s) from that test? 

Was that test using different URLs  for   local-response-redirect-uri   and  the  trigger   as recommended ?

The support files we have now don’t reflect it if they were from the test.",11/May/23 6:03 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d94b6256d01ad54eb020] I will note and will not ask again from customer about changes. Thanks for this. I did not know what analysis you are doing on support files please let  me know or show me one time I will do it again. Thanks for checking and let me know there is no changes were made shall I let the customer know this please.,12/May/23 8:34 PM;617a5f2cf485cd0068cb98af;[~accountid:5b15d94b6256d01ad54eb020] Please have 2 min call via slack to discuss this case in order to progress this case as this case is having a management escalation. Please ping me when you are online on slack. Thanks very much.,"13/May/23 12:47 AM;5b15d94b6256d01ad54eb020;[~accountid:617a5f2cf485cd0068cb98af] for my internal comment i was only trying to get the history on this since I haven’t been involved with this for very long. 

To summarize our call,  you said you were going to get with the customer and review changes.

This issue looks familiar to me so I think we need to get more eyes on it to see if anybody remembers.  I did a few Jira searches but didn’t find what I was looking for.

[~accountid:5b15d9e6dda5f94d06b985b4]  [~accountid:5bac25aaabfcbf73d13e733b]  [~accountid:5b15d99b4c20165700edecad]   do any of you remember seeing this before?  I’m wondering if you agree with George’s recommendation?  It made sense to me but since this is escalated I think it is worth getting some more opinions to speed it up.",27/Jun/23 8:57 AM;5ac57757d9a96536d1f0daa9;Both cases are closed. Updating this Jira items stats to Done to reflect this. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
http 500 error when uploading image with a junction ,ISAMSUP-4773,279384,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Aaron.Richie.Dias,6194c472fe9f300068e5252f,Aaron.Richie.Dias,6194c472fe9f300068e5252f,04/Feb/23 3:49 AM,22/Feb/23 2:29 AM,14/Jul/23 2:47 PM,21/Feb/23 11:37 PM,,,,0,,,,"The customer has a setup of a junction with IBM MAXIMO. When uploading a new image on an asset they  get a HTTP 500 server error. The customer mentioned if they try to upload the image to another asset it works. 

Reviewed the pdweb.debug and pdweb.snoop files and found the errors the customer mentioned:

pdwebdebug

{noformat}2023-02-02-18:29:44.042+01:00I----- thread(117) trace.pdweb.debug:3 /build/isam/src/i4w/pdweb/webseald/junctions/remote/framework/ThirdPartyJunction.cpp:4406: Processing time of the junction request: 189863 usec
2023-02-02-18:29:44.053+01:00I----- thread(117) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- Browser <=== PD -----------------
Thread 117; fd 260; local 172.20.30.44:443; remote 172.20.112.104:58372
HTTP/1.1 500 Internal Server Error
content-length: 1754
content-type: text/html
date: Thu, 02 Feb 2023 17:29:43 GMT
p3p: CP=""NON CUR OTPi OUR NOR UNI""
server: WebSEAL/10.0.4.0
x-frame-options: DENY
cache-control: no-store
x-xss-protection: 1
content-security-policy: frame-ancestors 'none'
pragma: no-cache
Set-Cookie: PD-H-SESSION-ID_dmztst=xnL7bo0Z0j4=:1_4_1_u2rC0HBaAt3M+GwAJlyGNtcIqiRrDauZdD0LqcmJSb1am3Ti|; Path=/; HttpOnly{noformat}

pdweb.snoop

{noformat}(117) 2023-02-02-18:29:44.054 WebSEAL (172.20.30.44:443) to Client (172.20.112.104:58372) sending 2197 bytes
HTTP/1.1 500 Internal Server Error
content-length: 1754
content-type: text/html
date: Thu, 02 Feb 2023 17:29:43 GMT
p3p: CP=""NON CUR OTPi OUR NOR UNI""
server: WebSEAL/10.0.4.0
x-frame-options: DENY
cache-control: no-store
x-xss-protection: 1
content-security-policy: frame-ancestors 'none'
pragma: no-cache
Set-Cookie: PD-H-SESSION-ID_dmztst=xnL7bo0Z0j4=:1_4_1_u2rC0HBaAt3M+GwAJlyGNtcIqiRrDauZdD0LqcmJSb1am3Ti|; Path=/; HttpOnly

<!DOCTYPE HTML PUBLIC ""-//IETF//DTD HTML//EN"">
<!-- Copyright (C) 2000 Tivoli Systems, Inc. -->
<!-- Copyright (C) 1999 IBM Corporation -->
<!-- Copyright (C) 1998 Dascom, Inc. -->
<!-- All Rights Reserved. -->
<!--
     This is a WebSEAL error message template file.  It is used
     by the WebSEAL server to build a response when a particular
     error occurs.  This file can be modified as appropriate.

     Error details:     

     * Code: 0x38cf04c1
     * Text: DPWWA1217E   An error occurred when writing a request to a junction.  WebSEAL was unable to dispatch the request to another junction server.
     {noformat}



reviewed the trace file {{trace_webseald-dmztst.log}} for the timestamp with the error on the pdweb.snoop we do see that error message for that thread around that time



{noformat}2023-02-02-18:29:44.053+01:00I----- webseald DEBUG8 wns templates /build/isam/src/i4w/pdweb/webseald/templates/MacroList.cpp 287 0x7f508573e700
[172.20.112.104] MacroList::get(4) -> DPWWA1217E   An error occurred when writing a request to a junction.  WebSEAL was unable to dispatch the request to another junction server.{noformat}



the thread id i found in the pdweb.snoop 

{noformat}2023-02-02-18:29:44.054+01:00I----- thread(117) trace.pdweb.snoop.client:1 /build/isam/src/i4w/pdwebrte/webcore/amw_snoop.cpp:192: 
----------------------------------------
Thread 139983813076736; fd 260; local 172.20.30.44:443; remote 172.20.112.104:58372{noformat}

and converting {{139983813076736}} to hex is {{7F508573E700}} which matches with the error in the trace file above ",,Daniel Comeau,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,5b15d9a0dda5f94d06b985b3,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,04/Feb/23 3:52 AM;ug:37385841-6582-45a4-a6f1-86bc2ee14421;Screenshot 2023-02-03 at 16.53.31.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181633,07/Feb/23 7:10 AM;dcomeau;image-20230206-210807.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181846,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011853346,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Aaron.Richie.Dias,6194c472fe9f300068e5252f,,,,AUTOSTRADE PER L'ITALIA S DIREZIONE GENERALE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS011853346&path=TS011853346%2F2023-02-02%2F,,,,,,,,,,,,,,,,,,,,,,,0|i181yb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-03 18:02:47.758,,,,,"04/Feb/23 3:52 AM;6194c472fe9f300068e5252f;reviewed the pcap provided by the customer too:

used the filter 

{{tcp.port == 51534 or tcp.port == 58372 or tcp.port == 51532}}

!Screenshot 2023-02-03 at 16.53.31.png|width=1047,height=440!

reviewing packet number 407, we can see the next sequence number is 515705 which is in packet 411 and we immediately send a FIN in the next line","04/Feb/23 4:02 AM;5b15d9a0dda5f94d06b985b3;To clarify what Aaron was saying…..the backend seems to have acked the data we sent it, and we close the connection (which could be alright for non-peristent I guess) but then we seem to give up and return the 500 even though the backend has not sent a FIN or RST or anything that would indicate a problem.   So we are hoping that the mentioned routing trace (trace_webseald-dmztst.log ) can provide you with some insight.","07/Feb/23 2:16 AM;5b17571b91981f4fdde632c1;* Please re-review pdweb.snoop for <IP1>.20.30.40:51534
** Is the ephemeral port
*** Client ↔︎ WebSEAL front-end
*** WebSEAL backend client ↔︎ Backend server
** Show me the first failing line (showing a problem) from pdweb.snoop for this ephemeral port
* Please carefully re-review trace01-DUP0001.pcap for <IP1>.20.30.40:51534
** Which end closed first?
*** Show me
* No need to look at anything past these","07/Feb/23 7:10 AM;5b15d9a0dda5f94d06b985b3;Hi Bill,
Thanks.    Yes I had missed the FIN we got much earlier in the trace, which seems to be a result of (I guess) a 5s inactive timeout at the backend for the persistent connections.



!image-20230206-210807.png|width=1379,height=140!


I have recommended to Aaron that the customer can either disable the persistent connections completely on this junction or they can try just lowering the timeout to less than 5s (or increasing it on the backend).      If they choose to just adjust the timeouts there could be other situations where the backend closes the connection on us, and we may still have issues, but the error could be a lot less often and the benefits of the persistent connections could outweigh the cost of the errors at that point.","07/Feb/23 7:19 AM;5b17571b91981f4fdde632c1;* The RFC HTTP standard calls this an asynchronous closure
** If the next requests was not a POST (for example: GET)
*** Then the majority of the clients will successfully redrive the failing GET
*** There are a bunch of clients that can redrive POST because of the negative business impact
**** Some may require options to enable
* {color:#bf2600}*Making the time shorter is not a viable solution*{color}
** {color:#ff5630}It will just cause the problem to occur more frequently{color}
** Since the customer’s WebSEAL backend is running with port 80 (not encrypted)
*** There would be very little impact disabling this junction’s persistence connections","07/Feb/23 11:32 PM;5b15d9a0dda5f94d06b985b3;[~accountid:5b17571b91981f4fdde632c1] Can you elaborate a bit on why you say decreasing our persistent-con-timeout will make the problem worse?   I don’t get that part.   If we make our timeout even shorter than the backend server’s timeout, we don’t need to deal with this situation anymore.    For example if we set it to 4 seconds then after 4 seconds of idle time we should close our connection and then on the next request coming in we should either use a different persistent connection which is already available in the pool or just open a new one (if we’re below our limit) so that the original request can go through and no redrive should be needed.     At least this is my thought.    Does webseal not work like this?","08/Feb/23 12:38 AM;5b17571b91981f4fdde632c1;Here is a one hop example (one client and one server) to avoid a persistent connection failure the client SHOULD close first … then the server next.

Otherwise the server closing before the client recreates the problem you now have.  REMEMBER the server closed first in this scenario!!!!!!! 

The best way (not a guarantee it might close under other conditions) to try to keep persistent connection to avoid lost of transactions like HTTP POST.

True client is “x” seconds persistent timeout

Server at end of one hop would require (x + TCP_retransmission_time) persistent timeout.

Each additional hop past this one would require the clients timeout plus additional TCP retransmission time (in which it could arrive).

","08/Feb/23 1:13 AM;5b15d9a0dda5f94d06b985b3;Right, I agree.    If they are ok disabling persistent connections to that junction completely, since they’re using http only then this would be good.   But as you say the client on the connection should timeout first.   In this case we are the client, which was why I was suggesting one option may be to set our timeout for the persistent connection on that junction to be less than the backend server.   Even better would be to increase the backend timeout, or if they want to disable them completely for that junction then that should also fix the problem.    



Thx",15/Feb/23 7:37 AM;5b17571b91981f4fdde632c1;* What is status?,"22/Feb/23 2:29 AM;6194c472fe9f300068e5252f;customer set 

[junction:/AMI_EDU]

max-cached-persistent-connections = 0

And that resolved the issue. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
FBTOAU211E The [authorization_grant] received of type [authorization_code] does not exist neccessiating reboot of appliance,ISAMSUP-4771,279348,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,David Hayes,5b232b2fd85e5b59b066f57f,David Flynn,614dd566a995ad0073ec0622,David Flynn,614dd566a995ad0073ec0622,03/Feb/23 11:31 PM,24/Feb/23 12:22 PM,14/Jul/23 2:47 PM,24/Feb/23 9:49 AM,,,,0,,,,"A cluster of three runtime nodes. This error: 

{noformat}FBTOAU211E The [authorization_grant] received of type [authorization_code] does not exist{noformat}

appeared on one node and eventually the appliance stopped working. Reboot rectified issue. It happened again and I believe it has been stable since. Hvdb tunings were checked:

{noformat}isam_cluster.hvdb.connectionManager.agedTimeout = 3600s isam_cluster.hvdb.connectionManager.connectionTimeout = 20s isam_cluster.hvdb.connectionManager.maxIdleTime = 300s isam_cluster.hvdb.connectionManager.maxPoolSize = 500 isam_cluster.hvdb.connectionManager.minPoolSize = 10 isam_cluster.hvdb.connectionManager.reapTime = 180s isam_cluster.hvdb.connectionManager.purgePolicy = FailingConnectionOnly{noformat}



 Further investigation did not reveal much; however it was noticed that Dsc was not turned on for AAc. So we recommended:

AAC-> Global Settings --> Advanced configuration



{noformat}distributedSessionCache.enabled - True

distributedSessionCache.externalServers - I would leave this unset.

distributedSessionCache.localCacheEnabled - True

distributedSessionCache.localCacheSize - 4096{noformat}

Customer came back and proposed this configuration:



{noformat}""distributedSessionCache.enabled"": {""value"": ""true"",""sensitive"": false},

""distributedSessionCache.localCacheEnabled"": {""value"": ""true"",""sensitive"": false},

""distributedSessionCache.localCacheSize"": {""value"": ""400000"",""sensitive"": false},

""authsvc.stateMgmt.HVDB.cleanupOnlyOnPrimaryMaster"": {""value"": ""true"",""sensitive"": false},

""authsvc.stateMgmt.HVDB.cleanupThread.batchSize"": {""value"": ""1500"",""sensitive"": false},

""authsvc.stateMgmt.HVDB.cleanupWait"": {""value"": ""120"",""sensitive"": false},

""authsvc.stateMgmt.HVDB.maxSessions"": {""value"": ""500000"",""sensitive"": false},

""authsvc.stateMgmt.cookieless"": {""value"": ""true"",""sensitive"": false},

""authsvc.stateMgmt.store"": {""value"": ""HVDB"",""sensitive"": false},{noformat}

using this source:

[https://www.ibm.com/docs/fr/sva/9.0.7?topic=authentication-configuring-access-module-cookieless-operation|https://www.ibm.com/docs/fr/sva/9.0.7?topic=authentication-configuring-access-module-cookieless-operation|smart-link] 

So this leads me to my first question. I believe only the following is needed; especially when only dealing with oauth tokens:

{noformat}""distributedSessionCache.enabled"": {""value"": ""true"",""sensitive"": false},""distributedSessionCache.localCacheEnabled"": {""value"": ""true"",""sensitive"": false},""distributedSessionCache.localCacheSize"": {""value"": ""400000"",""sensitive"": false}{noformat}

My second question is how i advise on this cookieless operation for AAC that they are discussing? Should we advise they go to services for that question? I have asked are they using those Runtimes for any other authentication such as saml etc. Or do not get involved in this cookie-less operation question and stick to dsc plain and simple? Be advised no FIM traces were collected to properly investigate this issue.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011706032,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,David Flynn,614dd566a995ad0073ec0622,,,,CREDITO EMILIANO S.P.A.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i181qr:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-02-08 01:07:19.923,,,,,"08/Feb/23 11:07 AM;5b232b2fd85e5b59b066f57f;[~accountid:614dd566a995ad0073ec0622] - do we know why they are wanting to turn on cookieless operation? What are they trying to achieve? My understanding is it will only effect calls to /sps/authsvc and /spsapiauthsvc endpoints so may not be relevant for their use-case. 

Is there a services team engaged with this customer? ",08/Feb/23 7:14 PM;614dd566a995ad0073ec0622;[~accountid:5b232b2fd85e5b59b066f57f] Good questions. I asked them an idirect question of what else they are using their runtimes for or are they using saml federation on their machines. No reply. So by end of week i will receommend those three dsc keys for the issue the pmr was opened. I will ask them directly why they want cookieless operation and if they are engaging services also.,"16/Feb/23 9:14 PM;614dd566a995ad0073ec0622;[~accountid:5b232b2fd85e5b59b066f57f]  The customer stated that   a AAC session store is not relevant to that error message since token refresh is unauthenticated? However if I recall correctly it is relevant since a session store is needed across all three runtimes if the token was issued in one runtime and refresh lands at another? I have advised customer we have no FIM traces to properly investigate this issue overall.. Nick mentioned the max pool parameter. Customer advised in PMR that IBM advised them to not have Dsc turned on AAC. They are obviously worried about such a big change. The will proceed to test with Dsc in AAc turned on in a non prod environment I believe. They wanted clarification on refresh and auth code at token endpoint; I gave below link.





[https://www.ibm.com/docs/en/sva/10.0.0?topic=SSPREK_10.0.0/com.ibm.isva.doc/config/concept/con_oauth20_workflow.htm#con_oauth20_workflow|https://www.ibm.com/docs/en/sva/10.0.0?topic=SSPREK_10.0.0/com.ibm.isva.doc/config/concept/con_oauth20_workflow.htm#con_oauth20_workflow|smart-link] ",21/Feb/23 8:32 PM;5b232b2fd85e5b59b066f57f;@djhayes - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,21/Feb/23 8:58 PM;614dd566a995ad0073ec0622;[~accountid:5b232b2fd85e5b59b066f57f] It turned out the customer was already using hvdb as a session store. Without a good trace we could not investigate further so customer has closed case and will reopen again if issue reoccurs and a runtime trace is provided.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
GSK_ERROR_CRYPTO WebSEAL not accepting client connections,ISAMSUP-4764,279122,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,William Hannon Jr,5b17571b91981f4fdde632c1,Steve Hughes,5bac25acfd82176d11a1334c,Steve Hughes,5bac25acfd82176d11a1334c,02/Feb/23 6:24 AM,12/Apr/23 12:34 AM,14/Jul/23 2:47 PM,12/Apr/23 12:34 AM,,,,0,,,,"Customer started receiving reports that users could not connect to WebSEAL.  Customer’s ISVA admin found he could not list junctions in LMI (DPWAP0011E The administration command, listremote, failed HPDBA0234E The SSL communications could not be completed. The socket was closed.).

Found the following sequence of errors in message log:
2022-12-23-12:39:48.572-05:00I----- 0x38AD54CC webseald WARNING wiv ssl SSLConnection.cpp 2488 0x7f86bc1ca700 -- DPWIV1228W   WebSEAL could not establish a secure connection to the server, [rbcinsight-lp.fg.rbc.com|http://rbcinsight-lp.fg.rbc.com], for the /services/dashboard junction (Function call: gsk_secure_soc_init; failed error: 0x9 GSK_ERROR_CRYPTO).

2022-12-23-12:39:48.572-05:00I----- 0x38CF07E9 webseald WARNING wwa jct RemoteJunction.cpp 2203 0x7f86bc1ca700 -- DPWWA2025W   IBM Security Verify Access WebSEAL has lost contact with junction (/services/dashboard) server: [rbcinsight-lp.fg.rbc.com|http://rbcinsight-lp.fg.rbc.com]

2022-12-23-12:39:48.572-05:00I----- 0x38AD5425 webseald ERROR wiv socket WsSslListener.cpp 1979 0x7f86bc1ca700 -- DPWIV1061E   Could not write to socket (9)

2022-12-23-12:39:48.599-05:00I----- 0x38AD5424 webseald ERROR wiv socket WsSslListener.cpp 2078 0x7f8715fae700 -- DPWIV1060E   Could not read from socket (9)

2022-12-23-12:39:48.624-05:00I----- 0x38AD5424 webseald ERROR wiv socket WsSslListener.cpp 2078 0x7f86bdefd700 -- DPWIV1060E   Could not read from socket (9)

2022-12-23-12:39:49.118-05:00I----- 0x38AD5425 webseald ERROR wiv socket WsSslListener.cpp 1979 0x7f869dc73700 -- DPWIV1061E   Could not write to socket (9)

2022-12-23-12:39:50.195-05:00I----- 0x38AD54CB webseald WARNING wiv ssl WsSslListener.cpp 1414 0x7f86bfe79700 -- DPWIV1227W   WebSEAL could not establish a secure connection with an incoming client. If client certificate authentication is not enabled check the WebSEAL server certificate (Function call: gsk_secure_soc_init; failed error: 0x4 GSK_INSUFFICIENT_STORAGE;142.245.100.4;-).

----

The GSK_ERROR_CRYPTO error lead me to [https://cloudidentity.atlassian.net/browse/ISAMSUP-3660|https://cloudidentity.atlassian.net/browse/ISAMSUP-3660]

I informed customer that ISVA Dev has investigated the GSK_ERROR_CRYPTO error and found that once the error occurs the encryption engine shuts down and the WebSEAL server needs to be restarted.  Customer will implement monitoring for the error and restart their servers BUT

# customer states the problem had never occurred until they upgraded to 10.0.4.0
# customer believes having to monitor and restart their own servers is a product defect that should be fixed by IBM
# customer has HW appliances not VMWare virtual appliances which [https://cloudidentity.atlassian.net/browse/ISAMSUP-3660|https://cloudidentity.atlassian.net/browse/ISAMSUP-3660|smart-link] findings say the problem only occurs with virtual appliances",,Asha Shivalingaiah,,,,,,,,,,,,,,,5af4ad7d4dd24c579110120b,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011922342,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Steve Hughes,5bac25acfd82176d11a1334c,,,,RBC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i180dv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-02 16:25:47.566,,,,,"03/Feb/23 2:25 AM;5b17571b91981f4fdde632c1;* Please provided the version of ISVA in pinned field
** From what level did they upgrade from?","03/Feb/23 2:38 AM;5b15d9e6dda5f94d06b985b4;* /usr/sbin/mesa_control fixpack_get_history
Saturday, December 10, 2022 at 7:01:48 AM|IJ38857_10040|IJ38857_10040|Yes|Installed|IJ38857 upgrades gskit to 8.0.55.28|1670673708
Saturday, December 10, 2022 at 7:07:58 AM|10.0.4.0_IF1|10.0.4.0_IF1|Yes|Installed|This fixpack contains security and defect fixes for IBM Security Verify Access. Applying it will restart the appliance automatically.|1670674078
* Update history is at [https://ecurep.mainz.de.ibm.com/ae5/#id=TS011922342&path=TS011922342%2F2023-01-24%2Fisva_10.0.4.0_20230123-194006_bbxsywwp02.support_unpack%2Fetc%2Flum%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011922342&path=TS011922342%2F2023-01-24%2Fisva_10.0.4.0_20230123-194006_bbxsywwp02.support_unpack%2Fetc%2Flum%2F]","03/Feb/23 6:38 AM;5bac25acfd82176d11a1334c;Customer upgraded to 10.0.4.0_IF1 from 10.0.2.0_IF1

messages.3:Nov 20 01:52:27 iss-lum[25685]: id=update time=""2021-11-20 01:52:27"" fw=bbxsywwp02 pri=6 op=install issueid=7000001 name=Update_Installation pkgid=XPU_WGA_FIRM_10_0_2_0 msg=""The update was successfully installed. The install log file is '/var/spool/updates/lo

gs/XPU_WGA_FIRM_10_0_2_0_install_result_20211120-015227.log'""

messages.3:Nov 20 02:18:16 mesa_control[4787]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.2.0_IF1.fixpack

messages.3:Nov 20 02:20:24 mesa_install_fixpack: 10.0.2.0_IF1 install successful

messages.3:Nov 20 02:20:24 mesa_control[4787]: Fixpack /tmp/fixpacktmpdir/10.0.2.0_IF1.fixpack: install successful

messages.2:Mar 11 20:37:58 mesa_control[18229]: Installing fixpack from file /tmp/fixpacktmpdir/Support_10.0.2.0_IF1_Cumulative_20210203.fixpack

messages:Dec 10 06:28:56 iss-lum[27964]: id=update time=""2022-12-10 06:28:56"" fw=bbxsywwp02 pri=6 op=install issueid=7000001 name=Update_Installation pkgid=XPU_WGA_FIRM_10_0_4_0 msg=""The update was successfully installed. The install log file is '/var/spool/updates/logs/XPU_WGA_FIRM_10_0_4_0_install_result_20221210-062856.log'""

messages:Dec 10 07:07:38 mesa_control[25189]: Installing fixpack from file /tmp/fixpacktmpdir/10.0.4.0_IF1.fixpack

messages:Dec 10 07:07:58 mesa_install_fixpack: 10.0.4.0_IF1 install successful

messages:Dec 10 07:07:58 mesa_control[25189]: Fixpack /tmp/fixpacktmpdir/10.0.4.0_IF1.fixpack: install successful","04/Feb/23 1:15 AM;5b17571b91981f4fdde632c1;* Waiting for customer to perform steps



* Removed prior content and updated content with added GSKit Performance improvement statement

{noformat}GSK_ERROR_CRYPTO  (220203)

NIST certification requires GSKit
  To periodically stop all new random number generator
  GSKit must run random number generator
  GSKit must run the periodically and strigently pass a specified test the accuracy of the random number generator

  If failing ratio and required number of failing iterations is below NIST requirements
    NIST requires GSKit to COMPLETELY SHUTDOWN since the integrity of SSL/TLS becomes easier to predict through periodical random number generator tests to id putting the customer at risk


1) Ensure unnecessary SSL handshakes are avoided
    a) Significantly increase ssl-max-entries
        i.  If the WebSEAL front-end load balancer are not stateful this will not be enough, from Tuning spreadsheet add additional request.log fields
        ii. The request.log across all the WebSEALs can be used to check statefulness if the SSL Session IDs move within “small” timeframes

    b)  Is the customer running any load balancers on the WebSEAL backend SSL junctions … without terminating the connection?


2)  Ensure proper GSKit level
    a)  Apply GSKit 8.0.55.22 or higher
          ISVA Support pointer out to GSKit a bottleneck that has always been in their code.
            GSKit 8.0.55.22 reduced lock contention for gsk_secure_soc_open, gsk_secure_soc_init and gsk_secure_soc_close
              GSKit 8.0.55.22 performance improved by 25% allowing more concurrent work

    b)  Updates GSKit and GSKit ICC levels
          1.  New ICC_FATAL messages for the various GSK_ERROR_CRYPTO scenarios
                a) There is no GSKit ICC performance impact only a message to stdout or stderr

    c)  Remove configuration GSK_ICC_NOLOAD_C
          [ssl]
          gsk-attr-name = enum:4007:1
          jct-gsk-attr-name = enum:4007:1

    d)  Add system environment variables configuration
          [system-environment-variables]
          ICC_IGNORE_FIPS=1
          ICC_FATAL=stderr
          *** PLEASE NOTE ***
            GSKit ICC may append their message to existing message with following format
            – – – <ICC message>: <FILE>,<LINE> –
            Report ICC Message

          !!!                                                                                                 !!!
          !!! GSKit will require this message to identify the specific failing type of GSK_ERROR_CRYPTO error !!!
          !!!                                                                                                 !!!

    e)  Enable WebSEAL backend junction with Extended Master Secret extension (RFC7627)
          # Only GSKit 8.0.50.64 (and above)
          #
          # GSK_SSL_EXTN_EXTENDEDMASTERSECRET_CLIENT_ENABLE
          #  Enables the client to use the Extended Master Secret extension (RFC7627)
          #   This will also disable SSLV2, SSLV3 and disable sending SSLV2 client hellos.
          #
          #  GSK_TRUE (1) -        : Enable  client Extended Master Secret extension (RFC7627)
          #  GSK_FALSE(0) - Default: Disable client Extended Master Secret extension (RFC7627)
          #
          #[ssl]
          #gsk-attr-name     = enum:4003:1
          jct-gsk-attr-name = enum:4003:1

    f)  Restart WebSEALs

    g)  The added configuration can be left permanently since there is zero impact

    h)  GSKit Dynamic tracing is no longer required due to the new GSKit ICC message


3)  If VMWare system used
    a)  VMWare has a potential solution which was 100 times faster
          i.    However it is very hardware chipset dependent
                All hardware chipset(s) or potential migration VMWare systems must have the required chipsets

          ii.   If hardware is not proper hardware chipset the performance will be worse
                Which is why ISAM L3 has not realease the information

          iii.  VMWare Support must confirm their hardware chipset levels
                Then ISAM L3 can release the VMWare information{noformat}",15/Feb/23 7:37 AM;5b17571b91981f4fdde632c1;* What is status?,08/Mar/23 8:16 AM;5b17571b91981f4fdde632c1;* What is status?,29/Mar/23 2:23 AM;5b17571b91981f4fdde632c1;* What is status?,12/Apr/23 12:34 AM;5b15d901fa615349cb01778b;closing for now,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
WebSEAL - unexpected changes of location,ISAMSUP-4752,278536,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,George Benavides,5b15d99182e05b22cc7d5947,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,30/Jan/23 10:29 PM,24/Feb/23 10:13 AM,14/Jul/23 2:47 PM,24/Feb/23 10:13 AM,,,,0,,,," 

when upgrading ISVA appliances from version 10.0.4.0 to version 10.0.5.0 we encountered the same problem, but on different servers. The upgrade of all four members of the production WebSEAL server cluster for internal users was successful. Three of these servers are working correctly, but the server smbmpr002 adds to the URL unexpected junction /bods42ssl and the user gets an incorrect URL and subsequently a 404 error:

2023-01-19-14:01:18.583+01:00I----- thread(7) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- PD <=== BackEnd -----------------

Thread 7; fd 281; local 10.217.116.136:49158; remote 10.217.180.158:9444

HTTP/1.1 302 

content-length: 0

date: Thu, 19 Jan 2023 13:01:17 GMT

location: [https://eportal.skoda.vwg/skodaspace/c/portal/login?redirect=%2Fskodaspace%2Fgroup%2Fb2eportal%2Fhome-page&refererPlid=1210586&p_l_id=60733011|https://eportal.skoda.vwg/skodaspace/c/portal/login?redirect=%2Fskodaspace%2Fgroup%2Fb2eportal%2Fhome-page&refererPlid=1210586&p_l_id=60733011]

server: Apache

vary: User-Agent

x-frame-options: SAMEORIGIN

x-content-type-options: nosniff

cache-control: private, no-cache, no-store, must-revalidate

x-oneagent-js-injection: true

expires: Thu, 01 Jan 1970 00:00:00 GMT

x-xss-protection: 1

pragma: no-cache

server-timing: dtRpid;desc=""-178656144"", dtSInfo;desc=""0""

Set-Cookie: dtCookie=v_4_srv_9_sn_6421DD4D79C8C12F198686D1AD7F6B12_perc_100000_ol_0_mul_1_app-3A4e3f0bf00ee36a26_1; Domain=.skoda.vwg; Path=/

Set-Cookie: JSESSIONID_SKODASPACE=1CC576CBBE0D40AD3EBFE121CDE4AA5A.LIFERAY_PP22_CL01; Path=/skodaspace; Secure; HttpOnly

---------------------------------------------------

2023-01-19-14:01:18.583+01:00I----- thread(7) trace.pdweb.debug:3 /build/isam/src/i4w/pdweb/webseald/junctions/remote/framework/ThirdPartyJunction.cpp:4411: Processing time of the junction request: 5104 usec

2023-01-19-14:01:18.584+01:00I----- thread(7) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- Browser <=== PD -----------------

Thread 7; fd 313; local 10.217.116.136:4000; remote 10.217.116.185:56352

HTTP/1.1 302 

content-length: 0

date: Thu, 19 Jan 2023 13:01:17 GMT

location: [https://eportal.skoda.vwg/bods42ssl/skodaspace/c/portal/login?redirect=%2Fskodaspace%2Fgroup%2Fb2eportal%2Fhome-page&refererPlid=1210586&p_l_id=60733011|https://eportal.skoda.vwg/bods42ssl/skodaspace/c/portal/login?redirect=%2Fskodaspace%2Fgroup%2Fb2eportal%2Fhome-page&refererPlid=1210586&p_l_id=60733011]

p3p: CP=""NON CUR OTPi OUR NOR UNI""

server: Apache

vary: User-Agent

x-frame-options: SAMEORIGIN

x-content-type-options: nosniff

cache-control: private, no-cache, no-store, must-revalidate

x-oneagent-js-injection: true

expires: Thu, 01 Jan 1970 00:00:00 GMT

x-xss-protection: 1

strict-transport-security: max-age=31536000; includeSubDomains

pragma: no-cache

server-timing: dtRpid;desc=""-178656144"", dtSInfo;desc=""0""

Set-Cookie: dtCookie=v_4_srv_9_sn_6421DD4D79C8C12F198686D1AD7F6B12_perc_100000_ol_0_mul_1_app-3A4e3f0bf00ee36a26_1; Path=/

Set-Cookie: JSESSIONID_SKODASPACE=1CC576CBBE0D40AD3EBFE121CDE4AA5A.LIFERAY_PP22_CL01; Path=/skodaspace; Secure; HttpOnly

I found that the problem is in the ""-v eportal.skoda.vwg"" parameter in the configuration of junction /bods42ssl. If I regenerate the junction without this parameter, the problem disappears. Unfortunately the backend system behind junction /bods42ssl requires this parameter.

I can't explain why it doesn't cause problems on the other three servers. Is there any way to work around this problem? Thank you very much in advance for your help.

Since this is a production system, I had to rollback the smbmpr002 appliance to version 10.0.4.0 where the problem does not occur (I left the other three working servers on version 10.0.5.0).",,Akshatha,Alan Wong,Ayush Singh,BRIANORO,Dermot Daly,Prabhjeet.Multani,Surya Prakash,Syed Hasan Jafar,,,,,,,,61548f169cdb9300722d0c1f,6092aca0f0db130069d19687,61409dc154762c006932ffc7,6154906364ff01007106e189,6092ac9ff6c0960069d47a67,627a7fb30d1e73006f7c21cf,60f541a6d0134900692d91b7,617a5f2cf485cd0068cb98af,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011899175,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,SKODA AUTO A.S.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS011899175&path=TS011899175/2023-01-20/&filepath=TS011899175/2023-01-20/isva_10.0.4.0_20230120-154834_smbmpr002.fw.skoda.vwg.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS011899175&path=TS011899175/2023-01-20/&filepath=TS011899175/2023-01-20/isva_10.0.5.0_20230119-140744_smbmpr002.fw.skoda.vwg.support",,,,,,,,,,,,,,,,,,,,,,,0|i17wu7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-02-10 09:38:55.657,,,,,"10/Feb/23 7:38 PM;6092aca0f0db130069d19687;[~accountid:5b15d99182e05b22cc7d5947] Hello George, Ayush is on leave and I am helping this case. The customer looking for update and said:

“Unfortunately, we could not find the cause of the problem, but we managed to solve the problem by modifying the configuration of junction /bods42ssl - after changing the configuration of the backend application it was possible to remove the virtualhost (-v) and stateful (-s and -u) parameters from the configuration. After this change it was possible to upgrade the appliance to version 10.0.5.0 without any problems.”",24/Feb/23 10:13 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
We looking to customize error condition for /introspect calls.,ISAMSUP-4748,278202,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,carlos.arias,62ed8180432ef494c8cad107,carlos.arias,62ed8180432ef494c8cad107,27/Jan/23 12:06 AM,24/Feb/23 9:39 AM,14/Jul/23 2:47 PM,24/Feb/23 9:39 AM,,,,0,,,,"We looking to customize error condition for /introspect call. Below the scenarios that we would want have customized error responses

If introspect is disabled:

{""error_description"":""The authorization server encountered an unexpected condition which prevented it from fulfilling the request."",""error"":""server_error""}

Unknow client Id:

{""error_description"":""FBTOAU203E The client identifier could not be found."",""error"":""invalid_client""}

Missing required value (clientID, Secret and Token):

{""error_description"":""FBTOAU202E The required parameter: [client_id] was not found in the request."",""error"":""invalid_request""}

Since these error responses are coming for ISVA internal code, we would like to know if there is a way to customize these responses.

Is there a way to customize those responses?",,carlos.arias,khansen,Nick Lloyd,Steve Herskowitz,Tushar Prasad,,,,,,,,,,,62ed8180432ef494c8cad107,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5af99299ae1b5f08256340f1,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011905276,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,AT&T,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17ut3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-01-30 19:57:00.36,,,,,31/Jan/23 3:12 AM;62ed8180432ef494c8cad107;Just following up,"31/Jan/23 5:57 AM;5b15d99182e05b22cc7d5947;Hello Carlos,

Not sure if there is a method to customize internal errors.

Will investigate.

Thanks!","01/Feb/23 2:13 AM;62ed8180432ef494c8cad107;I know it’s a tough request, but just to validate with you guys. Most likely it’s not possible.",14/Feb/23 10:54 PM;62ed8180432ef494c8cad107;Any updates here? Is it good to say that it’s not possible? [~accountid:5b15d99182e05b22cc7d5947] ,16/Feb/23 3:21 AM;62ed8180432ef494c8cad107;Any update? [~accountid:5b15d99182e05b22cc7d5947] ,"17/Feb/23 5:59 AM;62ed8180432ef494c8cad107;As discussed over slack, I’ll ask for a support file to the customer with errors mentioned.",21/Feb/23 8:33 PM;5b232b2fd85e5b59b066f57f;@gbe - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"23/Feb/23 3:51 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:62ed8180432ef494c8cad107] 

There is no option to customise these messages These are out of the box error messages.



I have run these tests for your reference: 

{noformat}curl -k -d ""client_id=testclient1&grant_type=password&username=testuser1&password=Passw0rd&token=YStFB3ijj4abWIVav6EU"" https://10.160.100.37:444/mga/sps/oauth/oauth20/introspect
{""active"":false}
 
curl -k -d ""client_id=testclient1&grant_type=password&username=testuser1&password=Passw0rd&client_secret=estclient1password"" https://10.160.100.37:444/mga/sps/oauth/oauth20/introspect
{""error_description"":""FBTOAU204E An invalid client assertion or client secret was provided for the client identifier."",""error"":""invalid_client""}MacBook-Pro-2:Docker asha$ 

curl -k -d ""client_id=testclient1&grant_type=password&username=testuser1&password=Passw0rd&client_secret=testclient1password"" https://10.160.100.37:444/mga/sps/oauth/oauth20/introspect
{""error_description"":""FBTOAU202E The required parameter: [token] was not found in the request."",""error"":""invalid_request""}MacBook-Pro-2:Docker asha$ {noformat}

Thanks",23/Feb/23 10:54 PM;62ed8180432ef494c8cad107;Thanks for the update.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Rogue files found in Management Root,ISAMSUP-4744,278110,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Aaron.Richie.Dias,6194c472fe9f300068e5252f,Aaron.Richie.Dias,6194c472fe9f300068e5252f,25/Jan/23 9:22 PM,24/Feb/23 9:32 AM,14/Jul/23 2:47 PM,24/Feb/23 9:32 AM,,,,0,,,,"The customer mentioned they have a rogue file in the management root for some of their Webseal instances.
It is possible that this has been migrated across from TAM many years ago.


They had previously had the same issue and L3 provided a fix pack to remove just that one rouge file ([https://cloudidentity.atlassian.net/browse/ISAMSUP-4653|https://cloudidentity.atlassian.net/browse/ISAMSUP-4653|smart-link] )



Customer mentioned On two of the Test WebSEALs in the Default instance I have found acct_locked.html and On one of the Production WebSEALs in the Default instance I have found login.html

The location of all the files are as below and I was able to confirm the files being present in this location:

{{/var/pdweb/Default/server-root/lib:}}

==========================================================================

Test1: isva_10.0.5.0_20230116-143326_TST-ESEC-G101.support.zip_unpack/var/pdweb/Default/server-root/lib $ ls -l
total 140
*_-rwxrwxr-x    1 ecuunpck swsupt         5055 Jan 16 14:33 acct_locked.html_*
drwxrwsr-x   17 ecuunpck swsupt         4096 Jan 16 14:33 errors
drwxrwsr-x    7 ecuunpck swsupt         4096 Jan 16 14:33 junction-root
drwxrwsr-x   17 ecuunpck swsupt         4096 Jan 16 14:33 management
drwxrwsr-x    2 ecuunpck swsupt         4096 Jan 16 14:33 oauth
drwxrwsr-x   16 ecuunpck swsupt         4096 Jan 16 14:33 pkmspublic
drwxrwsr-x    2 ecuunpck swsupt         4096 Jan 16 14:33 snippets

============================================================================

Test2: isva_10.0.5.0_20230116-143412_TST-ESEC-G102.support.zip_unpack/var/pdweb/Default/server-root/lib $ ls -l
total 140
*_-rwxrwxr-x    1 ecuunpck swsupt         5055 Jan 16 14:34 acct_locked.html_*
drwxrwsr-x   17 ecuunpck swsupt         4096 Jan 16 14:34 errors
drwxrwsr-x    7 ecuunpck swsupt         4096 Jan 16 14:34 junction-root
drwxrwsr-x   17 ecuunpck swsupt         4096 Jan 16 14:34 management
drwxrwsr-x    2 ecuunpck swsupt         4096 Jan 16 14:34 oauth
drwxrwsr-x   16 ecuunpck swsupt         4096 Jan 16 14:34 pkmspublic
drwxrwsr-x    2 ecuunpck swsupt         4096 Jan 16 14:34 snippets

==========================================================================

Prod: isva_10.0.5.0_20230116-143916_LVE-ESEC-H102.support.zip_unpack/var/pdweb/Default/server-root/lib/

total 140

drwxrwsr-x   17 ecuunpck swsupt         4096 Jan 16 14:39 errors
drwxrwsr-x    6 ecuunpck swsupt         4096 Jan 16 14:39 junction-root
*_-rwxrwxr-x    1 ecuunpck swsupt        10457 Jan 16 14:39 login.html_*
drwxrwsr-x   17 ecuunpck swsupt         4096 Jan 16 14:39 management
drwxrwsr-x    2 ecuunpck swsupt         4096 Jan 16 14:39 oauth
drwxrwsr-x   16 ecuunpck swsupt         4096 Jan 16 14:39 pkmspublic
drwxrwsr-x    2 ecuunpck swsupt         4096 Jan 16 14:39 snippets

==========================================================================",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4750,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011701368,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Aaron.Richie.Dias,6194c472fe9f300068e5252f,,,,LAND REGISTRY FINANCE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS011701368&path=TS011701368%2F2023-01-20%2F,,,,,,,,,,,,,,,,,,,,,,,0|i17u8v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-26 23:49:39.053,,,,,"27/Jan/23 9:49 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6194c472fe9f300068e5252f] 

Would the customer want a fixpack to remove the files - ?

{{/var/pdweb/Default/server-root/lib}}/*_acct_locked.html_* 

If yes -

Here is a fixpack:

Fixpack: [https://ibm.box.com/s/piwyf8qy3b1dmgzmfiq57wptf45d4ntj|https://ibm.box.com/s/piwyf8qy3b1dmgzmfiq57wptf45d4ntj|smart-link] ","27/Jan/23 11:44 PM;6194c472fe9f300068e5252f;[~accountid:5af4ad7d4dd24c579110120b] thank you for the update. I see the fixpack mentions v10.0.5, customer is on v10.0.4 would it still work? 



Also, would the same fixpack work on all the 3 accounts that the customer has this issue on {{/var/pdweb/Default/server-root/lib}} 2 test accounts with *_acct_locked.html_* and 1 prod account with *_login.html_*","30/Jan/23 8:57 AM;5af4ad7d4dd24c579110120b;This fixpack wil delete *_acct_locked.html_* 

Are they not able to delete login.html as well? 

Since installing this fixpack is irreversible take a backup of the contents of the file incase they need to re-instate.

I have updated the fixpack at the same location with a new version to delete login.html too.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Webseal json url filtering : not working,ISAMSUP-4739,277961,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Alan Wong,6092aca0f0db130069d19687,Alan Wong,6092aca0f0db130069d19687,24/Jan/23 11:51 PM,04/Apr/23 9:40 PM,14/Jul/23 2:47 PM,04/Apr/23 9:40 PM,,,,0,,,,"Customer  trying to implement an application under junction, let's call it /application. This app is using a json file coming from an http response ([https://reverseproxy/application/static/app.json|https://reverseproxy/application/static/app.json]), inside this body response there is a json with some url's that will be used by the app itself. Here an example: 

{ ""allowModels"": true, ""assetsUrl"": """", ""managementServiceUrl"": ""[https://external-server/management|https://external-server/management]"", ""name"": ""TEST"", ""replicateTo"": true, ""schedule"": true, ""upload"": true }, 

Sten is helping:

But since the actual response bodies are identical, we'll ignore the differences in the json_pp output.

{noformat}[stendres@debug71]:trace $ ls -l 97*         
-rw-r--r--    1 stendres swsupt         1604 Jan 18 08:38 97.backend.json
-rw-r--r--    1 stendres swsupt         2163 Jan 18 08:41 97.backend.out
-rw-r--r--    1 stendres swsupt         1604 Jan 18 08:38 97.client.json
-rw-r--r--    1 stendres swsupt         2163 Jan 18 08:41 97.client.out
[stendres@debug71]:trace $ diff 97*json
[stendres@debug71]:trace $ {noformat}

So it would appear that the difference is just the order json_pp output things. We're really only interested in the managementServiceUrl elements

{noformat}[stendres@debug71]:trace $ grep managementServiceUrl 97.backend.out
         ""managementServiceUrl"" : ""https://rlx-svil.gcp.groupamait.groupama.loc/management"",
         ""managementServiceUrl"" : ""https://rlx-coll.gcp.groupamait.groupama.loc/management"",
         ""managementServiceUrl"" : ""https://rlx.gcp.groupamait.groupama.loc/management"",
         ""managementServiceUrl"" : """",
[stendres@debug71]:trace $ grep managementServiceUrl 97.client.out 
         ""managementServiceUrl"" : ""https://rlx-svil.gcp.groupamait.groupama.loc/management"",
         ""managementServiceUrl"" : ""https://rlx-coll.gcp.groupamait.groupama.loc/management"",
         ""managementServiceUrl"" : ""https://rlx.gcp.groupamait.groupama.loc/management"",
         ""managementServiceUrl"" : """",
[stendres@debug71]:trace $ {noformat}

It seems no filtering happens.
There are two standard junctions (and one virtual host junction) referring to rlx-svil.gcp.groupamait.groupama.loc. Possibly a bad thing.

{noformat}[stendres@debug71]:ItaWslTest $ grep -l rlx-svil.gcp.groupamait.groupama.loc server-root/jct/*
server-root/jct/L1NWX0dDUF9SQURBUg==.xml
server-root/jct/L1NWX1JBREFSX1BPUlRBTA==.xml
server-root/jct/cG9ydGFsLXJseC1zdmlsLmdjcC5ncm91cGFtYWl0Lmdyb3VwYW1hLmxvYw==.xml
[stendres@debug71]:ItaWslTest ${noformat}

Better search, not a problem.

{noformat}[stendres@debug71]:ItaWslTest $ grep -l '<VIRTHOSTNM>rlx-svil.gcp.groupamait.groupama.loc</VIRTHOSTNM>' server-root/jct/*
server-root/jct/L1NWX0dDUF9SQURBUg==.xml
[stendres@debug71]:ItaWslTest $ {noformat}

[2:57|https://ibm-security.slack.com/archives/D038AH2BBHD/p1674053833482639]

That is an ssl (https) junction, so it should be possible to filter that URI.",,BRIANORO,Dermot Daly,Gabe,khansen,Motiur Rahman,Nick Lloyd,Reagan Knowles,Tushar Prasad,,,,,,,,6154906364ff01007106e189,6092ac9ff6c0960069d47a67,5b15d99b4c20165700edecad,5b15d901fa615349cb01778b,5b15d9e581c3df12acf53c4a,5b15d9e6dda5f94d06b985b4,5b15d9e44c4ed14b83af8723,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011816786 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Alan Wong,6092aca0f0db130069d19687,,,,CYBERTECH SRL,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17tbr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-01-25 18:12:08.658,,,,,26/Jan/23 4:12 AM;5b15d9e581c3df12acf53c4a;investigating….,"26/Jan/23 5:22 AM;5b15d9e581c3df12acf53c4a;Filtering is the most complex part in WebSEAL code.

Without a very clear and reproducible to issue ,as far as filter goes, it will be extremely difficult to make any changes in the code nor it should be done .

Please provide a reproduction steps as  details as possible.

If we can reproduce it, we will investigate, will try to find any alternate way to achieve, if none possible and if it is a real clear cut defect, then we will identify the code, will engage dev and only then code will be modified.,

so, please, give us a detailed reproduction steps.

It does not have to be exactly what customer is doing, as long as, all it need to do is produce similar results as customer’s.","26/Jan/23 7:02 PM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] yes, I will check it with the customer.","27/Jan/23 1:09 AM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] The customer said :

"" I would like to help you on this but i think that i can't be more clear that i've already been. I shared with you anything that i can, informations, pictures, support files, pdweb.debug part, so if you need something else please ask me for it and i will try to provide it to you.

The only thing that maybe can be helpful and i would like to share is the info related to servers inside json that i configured under junctions, and that's why i'm expecting to see them correctly filtered.

Here the list:

/SV_GCP_RADAR ---> rlx-svil.gcp.groupamait.groupama.loc

/CL_RADAR_LIVE ---> rlx-coll.gcp.groupamait.groupama.loc

You can find in attached two new files:

Content_not_filtered.json (The one that we are actually recieving

Content_expected.json (The one that we expect)

Hope that this helps more”

Do you have any instruction or cookbook that I can follow to set it up?

OR I can ask for the trace you need.","03/Feb/23 6:15 PM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] Is there any trace that helps you?

In this case, Sten is helping me. We went through the trace which was provided by the customer. He agreed there is no filtering happening.","07/Feb/23 2:53 AM;6092aca0f0db130069d19687;@ Motiur Rahman the customer asked:” 

Do we have something new?

Can i ask you if this filtering issue is expected?

Should webseal filter json body responses?

Do we have maybe to change some configurations in order to achieve it?”",07/Feb/23 5:03 AM;5b15d9e581c3df12acf53c4a;I am looking into it now…will update soon.,"07/Feb/23 7:59 AM;5b15d9e581c3df12acf53c4a;So, no reproduction?

As I said, it will be almost impossible to debug unless we have a reproduction …..

Please try the follwoing:

# Do a reproduction and provide the steps so that I can recreate and if I can recreate it I can generate the required traces.
# Get full traces, getting pdweb debug or snoop will not help us in debugging, we need full traces, you turn on full traces via LMI, select the instance,  traces and for component, chose “pdweb”. which basically means all, provide a big like 20mb file size so that all in captured in one file which will be easier to follow, please describe what was do to recreate so that we can easily look for it.","07/Feb/23 9:03 AM;5b15d9e581c3df12acf53c4a;Another thing you can try in your re-create is the following:

[filter-content-types]

#Document content types that the server will filter in responses from

#junctioned servers.  If types besides text/html and text/vnd.wap.wml

#are added to this list then the option [script-filtering]script-filter

#should be set to 'yes'.

#Format is:

#type = <type-name>

type = text/html
type = text/vnd.wap.wml

 *_type = application/json. <============= This option_*","07/Feb/23 7:06 PM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] Thanks for the suggestion. Where can I get the Json to test on my VM? 

Please advise",07/Feb/23 11:31 PM;5b15d99b4c20165700edecad;[~accountid:6092aca0f0db130069d19687] Why not use something similar to the JSON the customer provided? The URL should be modified to match your environment. ,"07/Feb/23 11:33 PM;6092aca0f0db130069d19687;[~accountid:5b15d99b4c20165700edecad] Right, I will try to do it.","08/Feb/23 1:49 AM;5b15d9e581c3df12acf53c4a;When I cut/pasted, there was an inadvertent dot “.” at the end,  i.e. option is 

[filter-content-types]

*_type = application/jso_*n",08/Feb/23 2:01 AM;6092aca0f0db130069d19687;Am I add the customer JSON into [script-filtering] stanza?,"08/Feb/23 2:11 AM;5b15d9e581c3df12acf53c4a;No, you just add the highlighted line, but over all reproduction, other L2 will be in better position to help you.","11/Mar/23 3:57 AM;5b15d9e44c4ed14b83af8723;[~accountid:5b15d9e581c3df12acf53c4a] I’ve got a recreate environment and I see the same issue. Before I dig deeper, are we sure that WebSEAL has the capability to filter a JSON response?","11/Mar/23 4:36 AM;5b15d9e581c3df12acf53c4a;You see the issue even with 

[filter-content-types]

*_type = application/jso_*n

===============================

If so then please do dig deeper.","11/Mar/23 5:18 AM;5b15d9e44c4ed14b83af8723;# You can use json-server to simulate a back-end server that provides a JSON response to WebSEAL. It's very easy to use. Ping me on Slack if you want a demonstration. See this link: [https://github.com/typicode/json-server|https://github.com/typicode/json-server|smart-link] 
# I started with a new WebSEAL instance that uses defaults. I created my junction and then changed the following settings. Notice I did not change the [filter-url] stanza. Because JSON doesn't use tags, I don't know what change to make for [filter-url].
{{ [server]}}
{{ web-host-name = swordapp.toffee.lab}}
{{ filter-nonhtml-as-xhtml = yes}}
{{ [script-filtering]}}
{{ script-filter = yes}}
{{ rewrite-absolute-with-absolute = yes}}
{{ [filter-content-types]}}
{{ type = application/json}}
{{ [content-mime-types]}}
{{ json = application/json}}
# After creating my junction, here's a snippet of the junction show. Notice the ""Virtual hostname"" matches the server:port in the JSON in the next item below.

{{ pdadmin sec_master> server task default-webseald-sword.toffee.lab show /coconut}}
{{ 	Junction point: /coconut}}
{{ 	Type: TCP}}
{{ 	...}}
{{ 	Server 1:}}
{{ 		ID: 07d8f976-bf60-11ed-9b20-00155d16a83b}}
{{ 		Server State: running}}
{{ 		Operational State: Online}}
{{ 		Hostname: windows2019.toffee.lab}}
{{ 		Port: 3000}}
{{ 		Virtual hostname: windows2019.toffee.lab:3000}}

# After authenticating and going through the junction, here's the JSON response that I see in my browser. Notice the URL still refers to my back-end server after we expect WebSEAL to filter and add the junction name /coconut:

 {{managementServiceUrl	""http://windows2019.toffee.lab:3000/test""}}","21/Mar/23 6:24 AM;5b15d9e581c3df12acf53c4a;Can you please provide me with full traces i.e. in LMI ->Troubleshooting->Trace,  select “pdweb”, which will collect all traces.

I need to figure out response coming in as what type and why existing options not catching it.



e.g.

I need to find out the response:

{{managementServiceUrl ""http://windows2019.toffee.lab:3000/test""}}

coming has what? content type of that response?","22/Mar/23 7:35 AM;5b15d9e44c4ed14b83af8723;L2 recreate with pdweb trace is here: /ecurep/sf/TS011/816/TS011816786/support_files/isva_10.0.5.0_20230321-163257_sword.toffee.lab.support

WebSEAL: default
junction: coconut
json returned: {{managementServiceUrl ""http://windows2019.toffee.lab:3000/test""}}","23/Mar/23 3:22 AM;5b15d9e581c3df12acf53c4a;I am investigating further, I need to understand how currently options specified in

{{[filter-content-types]}}

is handled…..","24/Mar/23 3:23 AM;5b15d9e581c3df12acf53c4a;Your initial suspicion turns out to be correct, they way json  document is produced and url is marked, webseal can not filter those urls at all as webseal’s all filtering is based on special tag based which can be specified in [filter-url] stanza if defaults are not enough.

Unfortunately, json  documents are not tagged as regular html or other supported documents.

I had refresh my memories by going through documents and codes.",29/Mar/23 11:59 PM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] thanks for your help. I will let the customer know it.,"30/Mar/23 12:22 AM;5b15d9e581c3df12acf53c4a;[~accountid:6092aca0f0db130069d19687] As I explained in my earlier comment, this kind of json document filtering is not supported. Currently, ISVA is working as designed.",30/Mar/23 1:01 AM;6092aca0f0db130069d19687;[~accountid:5b15d9e581c3df12acf53c4a] 👍 ,04/Apr/23 9:40 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA using RadiantOne LDAP as a user registry,ISAMSUP-4735,277935,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Steve Hughes,5bac25acfd82176d11a1334c,Steve Hughes,5bac25acfd82176d11a1334c,24/Jan/23 8:00 AM,24/Feb/23 9:42 AM,14/Jul/23 2:47 PM,24/Feb/23 9:42 AM,,,,0,,,,"Customer is wanting to switch from ODSEE to VDS Radiant logic HDAP for their ISVA user registry.

[https://www.ibm.com/docs/en/sva/10.0.5?topic=configuration-user-registry-considerations|https://www.ibm.com/docs/en/sva/10.0.5?topic=configuration-user-registry-considerations]

Does not list a Radiant Logic LDAP as a supported user registry for ISVA.

However, the Software Compatibility Report ([https://www.ibm.com/software/reports/compatibility/clarity/prereqsForProduct.html|https://www.ibm.com/software/reports/compatibility/clarity/prereqsForProduct.html]) lists RadiantOne 7.2 under the Identity Management section and does not have the note ""Directory server is only supported via the IBM Security Access Manager Federated Directory functionality."" for RadiantOne 7.2.


Is the ISVA doc on supported user registries correct or should the CR note that RadiantOne is only supported as a federated directory?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011264648,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,AUTO CLUB INSURANCE ASSOCIATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17t5r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-01-23 23:33:08.225,,,,,24/Jan/23 9:33 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please take a quick look at this item. I think that we just need to confirm the support statement for the usage of Radiant Logic 7.2. ,"30/Jan/23 4:16 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bac25acfd82176d11a1334c] 

Radiant Logic LDAP is not supported as user registry for ISVA.

This has been there as a compatible version since about 9.x , it can be used as a federated registry.



","24/Feb/23 9:42 AM;5af4ad7d4dd24c579110120b;Closing this as answered, if you have any questions please feel free to reopen.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
URL macro does not return a server relative URL,ISAMSUP-4733,277776,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Steve Hughes,5bac25acfd82176d11a1334c,Steve Hughes,5bac25acfd82176d11a1334c,21/Jan/23 4:28 AM,21/Jan/23 8:58 AM,14/Jul/23 2:47 PM,21/Jan/23 8:58 AM,,,,0,,,,"Customer upgraded from ISVA 10.0.2 to 10.0.5 and URL_macro_is_not_server_relative_10020IF1.fixpack went away after the upgrade.  Jira for APAR IJ33965 shows that the fix is in 10.0.3.0 but HTTP trace show URL macro return an encoded absolute URL with an LRR response to client.

/ecurep/sf/TS011/893/TS011893312/2023-01-20/isva_10.0.5.0_20230120-104509_nsc-dev-isam-mgt-060.ba.ssa.gov.support

/ecurep/sf/TS011/893/TS011893312/2023-01-20/pdweb.debug.log



2023-01-20-10:41:06.061-05:00I----- thread(6) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:285: ----------------- Browser <=== PD -----------------

Thread 6; fd 256; local 10.61.132.64:443; remote 172.19.228.216:15527

HTTP/1.1 302 Moved Temporarily

location: /acu/opIntra/OPControllerServlet?TAM_OP=login&ERROR_CODE=0x00000000&URL=https%3A%2F%[2Fsecuredev.ba.ssa.gov|http://2Fsecuredev.ba.ssa.gov]%2Fepecs&[HOSTNAME=securedev.ba.ssa.gov|http://HOSTNAME=securedev.ba.ssa.gov]&OLDSESSION=",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011893312,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,US SOCIAL SECURITY ADMINISTRATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17s6v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-20 21:26:12.573,,,,,"21/Jan/23 5:39 AM;5bac25acfd82176d11a1334c;Will probably close this Jira as fix setting was missing from customer’s configuration file.

[https://www.ibm.com/support/pages/apar/IJ41545|https://www.ibm.com/support/pages/apar/IJ41545]","21/Jan/23 7:26 AM;5b15d9e581c3df12acf53c4a;Yea, some where bit latter, a new and different config option was added to strictly and only to address this URL issue:

[server]
allow-url-macro-to-be-relative = yes

As it was hidden option, it was not documented.

It is part of ISVA 10.0.5.0",21/Jan/23 8:41 AM;5bac25acfd82176d11a1334c;Customer has verified adding allow-url-macro-to-be-relative=yes allows for server-relative URLs to be returned by URL macro.,"21/Jan/23 8:58 AM;5bac25acfd82176d11a1334c;Case closed, closing Jira.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
"The locale ""Japanese(ja shift-jis)"" is not working on ISVA 10.0.5 ",ISAMSUP-4717,276353,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Kenji Seta,5b209ff1a56d9112a2a6f638,Kenji Seta,5b209ff1a56d9112a2a6f638,18/Jan/23 1:43 PM,24/Jan/23 10:57 AM,14/Jul/23 2:47 PM,24/Jan/23 10:57 AM,,,,0,,,,"The customer upgraded their ISVA 10.0.4 to 10.0.5. They configures a reverse proxy instance with locale ja_JP.sjis and msg__webseald.log contains Shift-JIS messages. After upgrading, these messages becomes “?” characters.

This issue is similar to [https://cloudidentity.atlassian.net/browse/ISAMSUP-3602|https://cloudidentity.atlassian.net/browse/ISAMSUP-3602|smart-link] 

The output of “locale -a” are same. However, the output of “iconv -l” are significantly different. The iconv on 10.0.5 seems not to recognize JP codepages.

On 10.0.4

{noformat}# grep LANG ../etc/webseald-default.conf | grep -v ^#
LANG = ja_JP.sjis
# grep ""Copyright"" msg__webseald-default.log 
 -- IBM Security Verify Access WebSEAL �o�[�W���� 10.0.4.0 (Build 20220608_0037) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.
# grep ""Copyright"" msg__webseald-default.log | iconv -f SJIS -t UTF-8 
 -- IBM Security Verify Access WebSEAL バージョン 10.0.4.0 (Build 20220608_0037) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.
# locale -a | grep ja
ja_JP.eucjp
ja_JP.sjis
ja_JP.utf8{noformat}

On 10.0.5 (do not restart instance from command line such as mesa_config [wga.web|http://wga.web] …)

{noformat}# grep LANG ../etc/webseald-default.conf | grep -v ^#
LANG = ja_JP.sjis
# grep Copyright msg__webseald-default.log 
 -- IBM Security Verify Access WebSEAL ????? 10.0.5.0 (Build 20221129_1816) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.
# grep Copyright msg__webseald-default.log | iconv -f SJIS -t UTF-8
iconv: failed to start conversion processing: No such file or directory
# locale -a | grep ja
ja_JP.eucjp
ja_JP.sjis
ja_JP.utf8{noformat}

iconv -l on 10.0.5

{noformat}  8859_1, 10646-1:1993, 10646-1:1993/UCS4, ANSI_X3.4-1968, ANSI_X3.4-1986,
  ANSI_X3.4, ANSI_X3.110-1983, ANSI_X3.110, ASCII, CP367, CP819, CP1252,
  CSASCII, CSA_T500-1983, CSA_T500, CSISO99NAPLPS, CSISOLATIN1, CSUCS4,
  CSUNICODE, IBM367, IBM819, ISO-8859-1, ISO-8859-15, ISO-10646-UCS-2,
  ISO-10646, ISO-10646/UCS2, ISO-10646/UCS4, ISO-10646/UTF-8, ISO-10646/UTF8,
  ISO-IR-6, ISO-IR-99, ISO-IR-100, ISO-IR-193, ISO-IR-203, ISO646-US,
  ISO8859-1, ISO8859-15, ISO88591, ISO885915, ISO_646.IRV:1991, ISO_8859-1,
  ISO_8859-1:1987, ISO_8859-15, ISO_8859-15:1998, L1, LATIN-9, LATIN1, LATIN9,
  MS-ANSI, NAPLPS, OSF00010001, OSF00010020, OSF00010100, OSF00010101,
  OSF00010102, OSF00010104, OSF00010105, OSF00010106, OSF05010001, UCS-2,
  UCS-2BE, UCS-2LE, UCS-4, UCS-4BE, UCS-4LE, UCS2, UCS4, UNICODE, UNICODEBIG,
  UNICODELITTLE, US-ASCII, US, UTF-7, UTF-8, UTF-16, UTF-16BE, UTF-16LE,
  UTF-32, UTF-32BE, UTF-32LE, UTF7, UTF8, UTF16, UTF16BE, UTF16LE, UTF32,
  UTF32BE, UTF32LE, WCHAR_T, WINDOWS-1252{noformat}",,khansen,Nick Lloyd,prashant_kamat,Tushar Prasad,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4722,,ISAMDEV-9732,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,"TS011784584, TS011881559",,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Kenji Seta,5b209ff1a56d9112a2a6f638,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17osv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2023-01-19 02:13:15.274,,,,,"19/Jan/23 12:13 PM;5af4ad7d4dd24c579110120b;<Notes>

Before: 

{noformat}13         -- IBM Security Verify Access WebSEAL ????? 10.0.5.0 (Build 20221129_1816) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.
14        2023-01-18-21:11:43.319-05:00I----- 0x38CF0156 webseald WARNING wwa server config.cpp 6243 0x7f93208eee80 -- DPWWA0342W   ?? WebSEAL ??????????????'/var/pdweb/default/log/config_data__default-webseald-unconfigured.appliance.log' ??????????
15        2023-01-18-21:11:43.674-05:00I----- 0x1354A0CD webseald WARNING ivc general azn_maint.cpp 5957 0x7f93208eee80 -- HPDCO0205W   ------------------------------------------------
16        2023-01-18-21:11:43.674-05:00I----- 0x1354A0CC webseald WARNING ivc general azn_maint.cpp 5960 0x7f93208eee80 -- HPDCO0204W   ??????? - ????????????????:  -- subnet=255.255.0.0 -- router=10.160.0.1 -- opt58=0000a8c0 -- OPENJ9_JAVA_COMMAND_LINE=/opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Djava.security.properties=/opt/IBM/wlp/usr/servers/default/java.security -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar {noformat}

Update rpm:

{noformat}rpm -i glibc-gconv-extra-2.28-189.5.el8.ibm.1.x86_64.rpm{noformat}

After: 

{noformat}- IBM Security Verify Access WebSEAL o[W 10.0.5.0 (Build 20221129_1816) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.
2023-01-18-21:15:42.308-05:00I----- 0x38CF0156 webseald WARNING wwa server config.cpp 6243 0x7fda4ce32e80 -- DPWWA0342W   ±Ì WebSEAL CX^XÌ\¬f[^ÍA'/var/pdweb/default/log/config_data__default-webseald-unconfigured.appliance.log' ÉO³êÄ¢Ü·B
2023-01-18-21:15:42.623-05:00I----- 0x1354A0CD webseald WARNING ivc general azn_maint.cpp 5957 0x7fda4ce32e80 -- HPDCO0205W   ------------------------------------------------
2023-01-18-21:15:42.623-05:00I----- 0x1354A0CC webseald WARNING ivc general azn_maint.cpp 5960 0x7fda4ce32e80 -- HPDCO0204W   ÊmbZ[W - ÀsÌvZXÉÎ·éÂ«Ï:  -- subnet=255.255.0.0 -- router=10.160.0.1 -- opt58=0000a8c0 -- OPENJ9_JAVA_COMMAND_LINE=/opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Djava.security.properties=/opt/IBM/wlp/usr/servers/default/java.security -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.authz,com.tivoli.pd.rgy.exception,com.tivoli.pd.rgy.ldap,com.tivoli.pd.rgy.nls,com.tivoli.pd.rgy.util,com.ibm.misc,com.ibm.net.ssl.www2.protocol.https,com.sun.jndi.ldap,org.apache.xml.s{noformat}","19/Jan/23 12:56 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b209ff1a56d9112a2a6f638] 

Fixpack for 10.0.5.0 at [https://cloudidentity.atlassian.net/browse/ISAMSUP-4722|https://cloudidentity.atlassian.net/browse/ISAMSUP-4722|smart-link] ","19/Jan/23 1:23 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5af4ad7d4dd24c579110120b] Thank you for providing fixpack quickly. I verified on my environment and the result is positive.

{noformat}# grep Copyright msg__webseald-default.log | iconv -f SJIS -t UTF-8
 -- IBM Security Verify Access WebSEAL バージョン 10.0.5.0 (Build 20221129_1816) -- Copyright (C) IBM Corporation 1994-2022.  All Rights Reserved.{noformat}

Can I transfer this fixpack to the customer?

One thing, the name of fixpack seems to be misspelled.

* Name: JP_mising_langconv_10050 ","19/Jan/23 1:28 PM;5af4ad7d4dd24c579110120b;[~accountid:5b209ff1a56d9112a2a6f638] 

Yes you can send this to the customer.

Noted on the spell, thnx ",19/Jan/23 3:11 PM;5b209ff1a56d9112a2a6f638;I sent fixpack to the customer. May I open an APAR?,"24/Jan/23 10:49 AM;5b209ff1a56d9112a2a6f638;Customer confirmed their issue is resolved by fixpack. Then, the case is closed.
If an APAR is not required, please close this ticket.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Update SPNEGO documentation to remove IE and instead use Edge,ISAMSUP-4684,274560,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Medium,Done,jwijono,5b15dbfa4d941a51f0da44dd,jcyarbor,5bac25aaabfcbf73d13e733b,jcyarbor,5bac25aaabfcbf73d13e733b,04/Jan/23 7:56 AM,04/Apr/23 9:49 PM,14/Jul/23 2:47 PM,28/Mar/23 10:52 AM,,Support,,0,,,,"IE is dead, the following page specifically mentions internet explorer:
[https://www.ibm.com/docs/en/sva/10.0.5?topic=sign-configure-internet-explorer-client|https://www.ibm.com/docs/en/sva/10.0.5?topic=sign-configure-internet-explorer-client|smart-link]

We need to either update it to mention the deprecation and provide steps for other browser clients, such as Firefox and Chromium, or change the page altogether to remove mention of Internet Explorer.",,David Hayes,jcyarbor,khansen,Nick Lloyd,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ45643,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,ISVA L2 Support Team,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17e9j:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-09 23:16:03.329,,,,,10/Jan/23 9:16 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15dbfa4d941a51f0da44dd] can you please confirm the status of this Jira item? ,"11/Jan/23 12:08 PM;5b15dbfa4d941a51f0da44dd;[~accountid:5bac25aaabfcbf73d13e733b] do you think we need to remove IE or just add Microsoft Edge?

because I believe IE still supported right?

either case please open DOC Apar.

Thanks",21/Feb/23 8:33 PM;5b232b2fd85e5b59b066f57f;@jwijono - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,22/Feb/23 5:22 AM;5b15dbfa4d941a51f0da44dd;[~accountid:5bac25aaabfcbf73d13e733b] Please open doc apar,01/Mar/23 8:43 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15dbfa4d941a51f0da44dd] can you please submit the approval for this update to Keiran. Please remember to remove your changes to the 10.0.5 branch. ,"01/Mar/23 9:06 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15dbfa4d941a51f0da44dd] ,

APAR IJ45643 has been created for this JIRA. I apologize for the delay.","28/Mar/23 6:02 AM;5b15dbfa4d941a51f0da44dd;update to the documentation has been approved, it will be included in 10.0.6.0",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
APARs fixed in 10.0.5.0 IF1 Technote URL not working,ISAMSUP-4983,295189,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Low,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,18/Apr/23 5:37 PM,26/Apr/23 6:51 PM,14/Jul/23 2:47 PM,26/Apr/23 9:31 AM,,,20/Apr/23 12:00 AM,0,,,,"From the ISVA Interim Fixpack 10.0.5-ISS-ISVA-IF0001 README as at
[https://ak-delivery04-mul.dhe.ibm.com/sar/CMA/TIA/0baoe/0/10.0.5-ISS-ISVA-IF0001.README.html|https://ak-delivery04-mul.dhe.ibm.com/sar/CMA/TIA/0baoe/0/10.0.5-ISS-ISVA-IF0001.README.html|smart-link] 

The URL for the "" For a complete list of APARs that are fixed by this Interim Fixpack, see the Technote at APARs fixed in 10.0.5.0 IF1 "" i.e.
[https://www.ibm.com/support/pages/apars-fixed-ibm-security-verify-access-version-10050-if1|https://www.ibm.com/support/pages/apars-fixed-ibm-security-verify-access-version-10050-if1]

does not work, no tech note content is listed - get a "" Oops — that's not right!
The page you requested cannot be displayed. 403: Forbidden “

Client has raised this issue in SF Case TS012767310, see screen grab they provided as at;
[https://ecurep.mainz.de.ibm.com/rest/download/TS012767310/2023-04-17/error_url.jpg?fileSize=50550&clientId=ae5|https://ecurep.mainz.de.ibm.com/rest/download/TS012767310/2023-04-17/error_url.jpg?fileSize=50550&clientId=ae5]",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012767310,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,DIREKTORATET FOR ØKONOMISTYRING,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,https://ecurep.mainz.de.ibm.com/rest/download/TS012767310/2023-04-17/error_url.jpg?fileSize=50550&clientId=ae5,,,,,,,,,,,,,,,,,,,,,,,0|i1aqxj:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-25 23:31:18.209,,,,,"26/Apr/23 9:31 AM;5af4ad7d4dd24c579110120b;[~accountid:6154906364ff01007106e189] 


It should work now.",26/Apr/23 6:51 PM;6154906364ff01007106e189;Thank you [~accountid:5af4ad7d4dd24c579110120b] asking customer to test from their side.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA Helm Charts for use with AWS EKS,ISAMSUP-4975,294524,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Low,Done,David Hayes,5b232b2fd85e5b59b066f57f,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,14/Apr/23 4:07 AM,04/May/23 11:41 PM,14/Jul/23 2:47 PM,04/May/23 11:41 PM,,Support,,0,,,,"Are the Helm Charts described at [https://www.ibm.com/docs/en/sva/10.0.5?topic=orchestration-helm-charts|https://www.ibm.com/docs/en/sva/10.0.5?topic=orchestration-helm-charts|smart-link]  still being maintained? If so, have they been tested with AWS EKS (Elastic Kubernetes Service)?",,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012725141,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1amtz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-14 05:47:19.514,,,,,"14/Apr/23 3:47 PM;5b232b2fd85e5b59b066f57f;Given the project was last updated 3 years ago, either it isn’t being maintained or the belief is that it should still be valid with newer releases. I’ll check with Dev what their understanding is. 

Is the customer experiencing an actual issue? ",15/Apr/23 6:47 AM;5bac25a37de8532e315430c5;They want to know if the charts are supported on AWS EKS. They are investigating deploying in that environment.,18/Apr/23 9:22 AM;5b232b2fd85e5b59b066f57f;The project is no longer maintained and have not been tested with AWS EKS . ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unable to import a gif file on Management Root,ISAMSUP-4961,292727,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Low,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Kenji Seta,5b209ff1a56d9112a2a6f638,Kenji Seta,5b209ff1a56d9112a2a6f638,07/Apr/23 11:34 AM,14/Apr/23 12:09 AM,14/Jul/23 2:47 PM,14/Apr/23 12:09 AM,,,,0,,,,"When I tried to import gif file on template directory, following error was shown.

!image-20230407-012448.png|width=810,height=57!

This issue is observed on 10.0.5 but not observed on 10.0.4.

Able to import a html file.

Able to import a zip file including same gif file by Import Zip menu.



Steps

# Login to LMI and navigate to “Web > Reverse Proxy” page
# Select instance and open menu “Manage > Management Root”
# Select and expand junction-root and open menu “Manage > Import”
# Push Browse button and select a gif file then Import it.
# Error was displayed.",,khansen,Nick Lloyd,prashant_kamat,Tushar Prasad,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,07/Apr/23 11:34 AM;seta;image-20230407-012448.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/194971,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012649049,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Kenji Seta,5b209ff1a56d9112a2a6f638,,,,MITSUBISHI HC CAPITAL INC.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1abrr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-07 13:50:22.379,,,,,07/Apr/23 11:50 PM;5b15d94b6256d01ad54eb020;That’s by design.  Only zip files are allowed at the root level. Individual files can be imported at lower levels.,"10/Apr/23 2:39 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b15d94b6256d01ad54eb020] ,

The target directory is “junction-root” instead of root.

html file can be imported. However, gif file cannot be imported.

On 10.0.4, both html and gif files can be imported.",10/Apr/23 11:32 PM;5b15d94b6256d01ad54eb020;I added a fix for  IJ45430 that will be in 10.0.6 for a similar issue .    Can you wait until 10.0.6.0?,"13/Apr/23 5:29 PM;5b209ff1a56d9112a2a6f638;Hi [~accountid:5b15d94b6256d01ad54eb020] the customer needs not personal fixpack. They can import files using Import Zip command.
Please close this ticket.

Best regards,
Kenji",14/Apr/23 12:09 AM;5b15d94b6256d01ad54eb020;[~accountid:5b209ff1a56d9112a2a6f638] Thanks  for the update.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA and Redis 6.X and 7.X - support clarification,ISAMSUP-4702,275603,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Low,Done,Peter Horner,5b15d9517dab4c51f61b5190,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,12/Jan/23 2:50 AM,17/Jan/23 6:39 PM,14/Jul/23 2:47 PM,17/Jan/23 6:39 PM,,,,0,,,,"As per customer / IBM Expert Security Labs Problem Description:
_We have ISVA 10.0.4.0 IF1 (10.0.5.0 planned for later state)._
_Currently we make use of Redis in a Redis/Sentinel deployment for both WebSEAL and Federation Runtime session storage._

_Redis itself is version 6.0.x (running on RHEL 8.6). To remain at the latest/greatest of RHEL 8 stream, the Redis version will also be upgraded to 6.2.7_
_i.e. part of the OS upgrade_ [https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/8.7_release_notes/index|https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/8.7_release_notes/index|smart-link]

_From the IBM documentation:_
_Clarity (Software Compatibility Reports) indicates - 6.0 and future fix packs_ 

_IBM Docs indicates - IBM does not supply or support the Redis Server itself. The server must be obtained and managed separately. The WebSEAL implementation requires a Redis server running at v6.0 or later._
_With the IBM Docs statement ""... requires a Redis server running at v6.0 or later ..."" I understand it means we will run in a 'supported configuration' with Redis 6.2?_  
_Or does there need to be specific testing/support statement made for these 6.2 (and 7.0 versions)?_

_Do note:_
_we have performed minimal testing ISVA 10.0.4.0 IF1 with Redis 6.2.7 and it seems to run just fine like before - hence this is more a due diligence question._
_And also to understand if maybe from a Support perspective if there have been any issues reported around this product version combination._

_Best regards,_
_Hans_",,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011773656,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,Belastingdienst,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Linux 86_64,,,,,,,,,,,,,,0|i17kgn:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-01-12 03:27:47.421,,,,,"12/Jan/23 2:55 AM;6154906364ff01007106e189;Just to FYI, there appears to be a related [thread|https://ibm-security.slack.com/archives/C30JAJTFG/p1673276169751949] also posted in #iam-verify-access-support back on Jan 9th regarding same query.","12/Jan/23 1:27 PM;5b15d9517dab4c51f61b5190;From the slack thread

The statement

We’re now looking at RHEL 8.7 which comes with Redis v6.2.7.    To me the ‘{{v6.0 or later}}’ reads as: Yes, use that v6.2.7 version and if something is wrong we’ll accept support cases.   Is that a fair statement?

got a 👍 from Scott Exton - the  ISVA Chief Programmer 2 days ago

So Yes that means customer will be running _in a ‘supported configuration' with Redis 6.2’_



I am not aware of any redis version specific issues.",13/Jan/23 12:15 AM;6154906364ff01007106e189;What about Redis 7.X version release? Is this also a supported configuration?,"13/Jan/23 9:49 AM;5b15d9517dab4c51f61b5190;Yes redis 7.x is supported

{{v6.0 or later}} includes v7","17/Jan/23 6:39 PM;6154906364ff01007106e189;TS011773656 is now closed. Please closing this, related Jira work item.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Administrator Settings attribute doc update,ISAMSUP-4692,274921,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Low,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Daniel Comeau,5b15d9a0dda5f94d06b985b3,Daniel Comeau,5b15d9a0dda5f94d06b985b3,07/Jan/23 6:19 AM,10/Jan/23 3:14 PM,14/Jul/23 2:47 PM,10/Jan/23 1:54 PM,10.0.6,Support,,0,,,,"The docs for updating the administrator settings…

[https://www.ibm.com/docs/api/v1/content/SSPREK_10.0.5/com.ibm.isva.doc/develop/rapi/Updating_the_administrator_settings.xml|https://www.ibm.com/docs/api/v1/content/SSPREK_10.0.5/com.ibm.isva.doc/develop/rapi/Updating_the_administrator_settings.xml]

mention “sessionInactiveTimeout” but the attribute is actually “sessionInactivityTimeout”




{noformat}{
  ""consoleLogLevel"": ""OFF"",
  ""enabledTLS"": [
    ""TLSv1"",
    ""TLSv1.1"",
    ""TLSv1.2""
  ],
  ""minThreads"": -1,
  ""maxFileSize"": 20,
  ""acceptClientCerts"": true,
  ""httpsPort"": 443,
  ""lmiMessageTimeout"": 5,
  ""sessionCachePurge"": 120,
  ""sshdPort"": 22,
  ""enabledServerProtocols"": ""TLSv1.2"",
  ""validateClientCertIdentity"": false,
  ""lmiDebuggingEnabled"": false,
  ""validVerifyDomains"": ""ice.ibmcloud.com verify.ibm.com ibmcloudsecurity.com"",
  ""sessionInactivityTimeout"": -1,    <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
  ""baSessionTimeout"": 300,
  ""sessionTimeout"": 720,
  ""sshdClientAliveInterval"": 300,
  ""maxThreads"": -1,
  ""maxPoolSize"": 100,
  ""maxFiles"": 2
}
{noformat}",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ44869,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Daniel Comeau,5b15d9a0dda5f94d06b985b3,,,,n/a,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2023-01-13T11:28:44.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17ga7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,4,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-09 01:10:51.983,,,,,07/Jan/23 6:30 AM;5b15d9a0dda5f94d06b985b3;Doc apar IJ44869 created,"09/Jan/23 11:10 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a26bcfc43ce02dc98ee86e1ff00d025a022319b8
   * description: ISAMSUP-4692 Update response attribute in RAPI

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82385114.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4692) which we publish.","10/Jan/23 12:55 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a26bcfc43ce02dc98ee86e1ff00d025a022319b8
   * description: ISAMSUP-4692 Update response attribute in RAPI

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82465094.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230110025216-a26bcfc43-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","10/Jan/23 1:53 PM;5af4ad7d4dd24c579110120b;Fixed and Merged, hence closing issue.","10/Jan/23 3:14 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: af95b6012b60bfb32543dcd1db3e675ebc15e1a8
   * description: Merge pull request #5645 from ISAM/ISAMSUP-4692

ISAMSUP-4692 Update response attribute in RAPI

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/82468892.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230110051138-af95b6012.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Doc changes from ISAMSUP-3641 are incorrect,ISAMSUP-5076,299685,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Low,,David Hayes,5b232b2fd85e5b59b066f57f,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,16/May/23 7:12 AM,06/Jul/23 4:34 PM,14/Jul/23 2:47 PM,,,,,0,,,,"[~accountid:5b232b2fd85e5b59b066f57f] 

[https://www.ibm.com/docs/en/sva/10.0.5?topic=up-context-based-access-clean|https://www.ibm.com/docs/en/sva/10.0.5?topic=up-context-based-access-clean|smart-link] 

Query 1 

{noformat}
SELECT SESSION_ID as v1
FROM RBA_USER_ATTR_SESSION
WHERE REC_TIME <

       
DELETE FROM (SELECT * FROM AUTH_TXN_OBL_DATA WHERE REC_TIME < '2021-11-30 23:59:59' FETCH FIRST 25000 ROWS ONLY){noformat}



This should not have both an incomplete select and the delete.  Also the delete for query 1 should not be based on value from the {{AUTH_TXN_OBL_DATA}} table

{{DELETE FROM (SELECT * FROM AUTH_TXN_OBL_DATA WHERE REC_TIME < '2021-11-30 23:59:59' FETCH FIRST 25000 ROWS ONLY)}}


This should still have the part with something like:

{{(CURRENT_TIME_MILLIS – (attributeCollection.sessionTimeout* 1000))}}


Perhaps it would be simple to explain this at a high level pseudo examples and not actual queries?

Maybe just have a high level query like:
DELETE FROM RBA_USER_ATTR_SESSION_DATA WHERE SESSION_ID IN (SELECT SESSION_ID FROM RBA_USER_ATTR_SESSION WHERE REC_TIME < ?) 

Explain that the argument is a timestamp for the argument, based off the current timestamp - some period of time and not have the later parts of the page.








Likewise query2 should not have both the select and delete that is not valid SQL.









Customers can get confused by the fact that we have three queries and then at the bottom of the page it says to use the queries in the delete.

for example in query 2 we could have two parts

{noformat}SELECT TXN_ID as v2
FROM AUTH_TXN_OBL_DATA
WHERE REC_TIME <
      (CURRENT_TIME_MILLIS- (attributeCollection.sessionTimeout* 1000)){noformat}

Delete the rows that are selected with the Query 2 string:

{noformat}DELETE FROM AUTH_TXN_OBL_DATA
WHERE TXN_ID = v2{noformat}


Or just one combined statement like:

{{DELETE FROM (SELECT * FROM AUTH_TXN_OBL_DATA WHERE REC_TIME < 'TIMESTAMP' FETCH FIRST 25000 ROWS ONLY)}}



And explain that the ‘TIMESTAMP’ needs to be replaced with a timestamp
",,Annelise Quap,,,,,,,,,,,,,,,5b15d950d9936c61022057fe,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,06/Jul/23 4:34 PM;djhayes;image-20230706-063408.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/209964,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bi4n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,Low,,Internal,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-15 22:28:06.26,,,,,"16/May/23 8:28 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] I am assigning this item to you as you where the original owner of the identified support case - 

[https://cloudidentity.atlassian.net/browse/ISAMSUP-3641|https://cloudidentity.atlassian.net/browse/ISAMSUP-3641|smart-link] 

Can you please take a look at this and confirm if you agree with [~accountid:5b15d950d9936c61022057fe] assessment.",13/Jun/23 12:18 PM;5b232b2fd85e5b59b066f57f;@djhayes - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"06/Jul/23 4:34 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d950d9936c61022057fe] - been fiddling around with this a bit today - this is what I have so far (note this isn’t what it will render like - just gives a representation). I’ve tried to simplify and generallise - but I’m mindful of possibly getting to a point where it becomes a bit meaningless - so I’d value your thoughts.



!image-20230706-063408.png|width=1864,height=611!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Unable to initialize authentication mechanism ,ISAMSUP-4724,276568,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,19/Jan/23 3:18 PM,30/May/23 11:31 PM,14/Jul/23 2:47 PM,30/May/23 11:31 PM,,,,0,,,,"The customer is using ISVA 10.0.3.1 on Kubernetes.

And he is using extensions for AAC which is built by IBM Services.
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010031284&path=TS010031284%2F2022-12-29%2F&filepath=TS010031284%2F2022-12-29%2FGetEntitlement_1.0.0.1.jar|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010031284&path=TS010031284%2F2022-12-29%2F&filepath=TS010031284%2F2022-12-29%2FGetEntitlement_1.0.0.1.jar]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010031284&path=TS010031284/2022-12-29/&filepath=TS010031284/2022-12-29/ISAuthorized_1.0.0.1.jar|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010031284&path=TS010031284/2022-12-29/&filepath=TS010031284/2022-12-29/ISAuthorized_1.0.0.1.jar]

After upgrading to 10.0.4 (from 10.0.3.1), it caused

{quote}Unable to initialize authentication mechanism [urn:ibm:security:authentication:asf:mechanism:isAuthorized]{quote}

I have asked the customer to collect following traces:

{quote}com.ibm.sec.authz.*=ALL:com.ibm.tscc.rtss.*=ALL:com.tivoli.am.fim.*=ALL:com.tivoli.am.rba.*=ALL:com.ibm.security.access.extension.* = ALL{quote}

But no related messages are recorded to ‘kubectl logs’ when he received above error.
He tried this extension 10.0.4.0 and 10.0.5.0, but still no luck.
Are these kind of extensions supported in these versions?
How can we investigate this issue?

Since we are not able to download such extensions from ecurep to local environment,
we(L2) are not able to recreate the issue at this point.
",,khansen,Nick Lloyd,prashant_kamat,tonyferg,Tushar Prasad,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9ef27631840ea300110,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,03/Mar/23 11:32 AM;tushar.prasad;deployment-verifyaccessconfig-config.yaml;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/188066,25/Apr/23 12:49 AM;tushar.prasad;image-20230424-143850.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197576,25/Apr/23 12:49 AM;tushar.prasad;image-20230424-144044.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197577,25/Apr/23 12:49 AM;tushar.prasad;image-20230424-144116.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197579,25/Apr/23 12:49 AM;tushar.prasad;image-20230424-144300.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197578,03/Feb/23 12:16 PM;tushar.prasad;officialOpenShiftSetupV2.pdf;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181552,21/Apr/23 12:39 AM;tushar.prasad;pod-verifyaccessconfig1050-runtime-c7f85cb8b-qmxm9.yaml;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/197087,28/Apr/23 12:09 PM;kanemoto;rba.zip;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/198435,03/Mar/23 11:32 AM;tushar.prasad;statefulset-verifyaccessconfig-runtime.yaml;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/188065,08/May/23 4:18 PM;kanemoto;trace.log.zip;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/199669,10/May/23 5:48 PM;kanemoto;trace2.log.zip;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/200115,,,,,IJ45742,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS010031284,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,INLAND REVENUE AUTHORITY OF SINGAPORE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2023-05-20T01:14:53.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":5,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17q1z:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-01-25 16:44:30.863,,,,,"25/Jan/23 2:14 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d9e581c3df12acf53c4a] ,
Are there any update on this issue? If you need any other info, please also let me know.
Best regards,
Yutaka","26/Jan/23 2:44 AM;5b15d9e581c3df12acf53c4a;I am investigating……

If I can not figure it out, I will ask other L3 as I am not  awfully familiar with kubernetes…..","26/Jan/23 3:03 AM;5b15d9e581c3df12acf53c4a;which support file has traces with the above trace specifications i.e.

com.ibm.sec.authz.*=ALL:com.ibm.tscc.rtss.*=ALL:com.tivoli.am.fim.*=ALL:com.tivoli.am.rba.*=ALL:com.ibm.security.access.extension.* = ALL

I am hoping there will be some log/trace which I can use to back track and see whether I can find some some clues?","26/Jan/23 3:42 AM;5b15d9e581c3df12acf53c4a;[~accountid:5c53d3ac23f5bf672621c868] [~accountid:5b15d9ec6d76184b7d989c83] 

It seems that there was a very similar issue came before:

[https://cloudidentity.atlassian.net/browse/ISAMSUP-3922|https://cloudidentity.atlassian.net/browse/ISAMSUP-3922|smart-link] 

May be Tushar can share his findings about how he resolved that issue which might help this case?","30/Jan/23 6:24 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9e581c3df12acf53c4a] [~accountid:5b15d94b6256d01ad54eb020] 



Last time I mentioned here as cause of the problem



[https://cloudidentity.atlassian.net/browse/ISAMSUP-3922?focusedCommentId=463665|https://cloudidentity.atlassian.net/browse/ISAMSUP-3922?focusedCommentId=463665|smart-link] 



The reason lightweight image not able to load the extension because,  extension jars are not even present at lightweight pods.



In verify access pod. you will find runtime jars here

/var/isam/sdk/impls/ISAuthorized_1.0.0.1.jar
/var/isam/sdk/impls.staging/ISAuthorized_1.0.0.1.jar





In lightweight containers. there is no such jars any where.  hence extensions will not work 



similarly. as expected. Appliance has these jars hence it works in 10.0.4.0 appliance model as well.



The question is 

1.why custom extension jars are not propagating  onto lightweight runtime pods and how to do that?","31/Jan/23 12:49 AM;5b15d94b6256d01ad54eb020;Since I got tagged on this issue, I’ll take a look.  Where is the link to the errors?   Does it work with a full appliance ( not a container)? Containers are lightweight and don’t support everything a regular appliance does.   Off hand I don’t know if that applies to the extensions  but  that is what needs to be researched. ","31/Jan/23 2:48 PM;5c53d3ac23f5bf672621c868;Hi [~accountid:5b15d94b6256d01ad54eb020] 



There are no where mentioned that container has restriction of not running custom extension([https://www.ibm.com/docs/en/sva/10.0.3?topic=support-docker-image-security-verify-access|https://www.ibm.com/docs/en/sva/10.0.3?topic=support-docker-image-security-verify-access|smart-link] )

and customer got it working in a containerised  environment until the lightweight runtime image is mandated.



History 

1.Customer was successfully able to use custom extension in a containerised env so it looks to be supported and these jars need to be pushed to the lightweight containers","31/Jan/23 11:45 PM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868] I don’t know what the official stance is on that.  We need to check and be sure.

Can  you answer the other two questions?",01/Feb/23 3:55 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b15d94b6256d01ad54eb020] Thank you for your help here Bill.,"03/Feb/23 12:16 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] [~accountid:5b15d9e581c3df12acf53c4a] 



1.The custom extension work in appliance

2.customer extensions don’t work in lightweight container runtime

3. we have a local reproduction in an openshift env. I can give you the access

could you follow the document to request an access?

[^officialOpenShiftSetupV2.pdf]

that way you can have an access to env where an example extension is deployed and it cannot be loaded.



You need to have access into openshift env so that you can review the logs","07/Feb/23 8:43 AM;5b15d94b6256d01ad54eb020;I took a look at some of more recent  directories for the case and haven’t found any tracing.  Do you have  the tracing from your recreate?

The error:  Unable to initialize authentication mechanism

is thrown by this class:  ExtensionAuthenticator   If you see that class in the trace, that’s the one we need to look at.

You meationed  “com.ibm.security.access.extension.* = ALL” as part of your trace specs.  That should include it.","09/Feb/23 12:15 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] [~accountid:5b15d9e581c3df12acf53c4a] 



Hope you are able to login to the ssh of the Infra node sent by Yutaka



if yes, then you can access my recreate logs at this location:



/isva/isva1040/pr-tusharp-verifyaccessconfig-runtime-logs-verifyaccessconfig-runtime-0/rtprofile



check trace.log , you will see these entries

[1/30/23, 3:56:07:300 GMT] 00000034 id=00000000 com.ibm.security.access.extension.loader.ExtensionLoader     3 getExtensionObject Unable to find extensions.
[1/30/23, 6:51:45:091 GMT] 00001802 id=00000000 com.ibm.security.access.extension.loader.ExtensionLoader     3 getExtensionObjects Unable to find extensions.
[1/30/23, 6:51:45:093 GMT] 00001802 id=00000000 com.tivoli.am.fim.authsvc.protocol.delegate.AuthSvcDelegate  I processRequest(FederationManagerContext, ProtocolActionChain) java.lang.RuntimeException: Unable to initialize authentication mechanism [urn:ibm:security:authentication:asf:mechanism:isAuthorized].





You can access my config url here:



{{https://verifyaccessconfig-10-0-4-0-pr-tusharp.apps.l2nilesh.cp.fyre.ibm.com}}





admin/object00





incase you need pod level access. just confirm whether your able to access the openshift console. I will add your userid in the openshift namespace so that you can review .





This has become critical for the customer and AVL is chasing after the case. Customer is unable to go to lightweight containers and as a result they are facing different issues. Request your help to expedite it.","14/Feb/23 2:09 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] [~accountid:5b15d9e581c3df12acf53c4a] 

could you let me know whether you are waiting for additional items from L2?

As this is critical for customer because they are not able to move ahead with upgrade","17/Feb/23 3:01 AM;5b15d94b6256d01ad54eb020;I still cannot access your environment.   What are the steps you used to recreate the issue?  I have a minishift env that I might be to use to recreate.  Although for this issue I would think it would apply to any container.

I’m assigning this to myself so I’ll see the updates.","17/Feb/23 10:24 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] 

could you try to login here again 

[https://console-openshift-console.apps.l2nilesh.cp.fyre.ibm.com|https://console-openshift-console.apps.l2nilesh.cp.fyre.ibm.com]



click on L2support and use IBMId at ISVl2 to login","17/Feb/23 10:32 AM;5c53d3ac23f5bf672621c868;additionally, Scott has an idea around it . 

He can give a cue to get the fix ready . I am okay to do a quick test around it.","18/Feb/23 12:28 AM;5b15d94b6256d01ad54eb020;I’m still getting the same error.  This is following the link you provided. I get to the Openshift container platform. I choose  L2Support-Login. Then alternate login to use my w3 id.  Then get the following error:

Your request cannot be processed. CSIAQ0279E Only entitled users can single sign-on to the application. You must request for application access. ","18/Feb/23 3:40 AM;5b15d94b6256d01ad54eb020;I did get AAC  setup so I could install the example  extension .

I did find the jar in the published snapshot after I published the configuration.  I don’t know yet why it didn’t get picked up.","20/Feb/23 11:06 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] 

thanks . it looks there is a progress. ","21/Feb/23 7:05 AM;5b15d94b6256d01ad54eb020;Yes I think aI am making some progress  and  I’m still investigating.  You mentioned  that Scott had an idea on this, but he’s out of the office so I won’t hear anything until he gets back.",22/Feb/23 1:52 AM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868] can you send me the isam config and runtime  yaml files you used for your recreation?,"28/Feb/23 2:34 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] 

here is the list of yaml files

[https://github.ibm.com/Tushar-Prasad/openshiftforl2|https://github.ibm.com/Tushar-Prasad/openshiftforl2]



i followed the document as in OfficialOpenShiftSetupV2.pdf (attached here) for 10.0.4.0","28/Feb/23 2:35 PM;5c53d3ac23f5bf672621c868;I can give you access to my env once you confirm that you can login.

let me ping you on slack to make sure you have the access to my env. ","01/Mar/23 1:16 AM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868] I can trouble shoot this using mini shift locally. So I don’t think I need access to your environment. 

I do want to see the actual yaml files you are using. Not templates.","03/Mar/23 11:32 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] 



I am attaching it.



also now you should have access to openshift . worth a try","04/Mar/23 12:51 AM;5b15d94b6256d01ad54eb020;Thanks, [~accountid:5c53d3ac23f5bf672621c868]  since I’ve recreated it locally I don’t think need access to yours but I’ll let you know if I do.","07/Mar/23 9:51 AM;5b15d94b6256d01ad54eb020;*Internal comment only:*

Quick update:

I think see what the problem is.

In the config  container you can find the jar files:

./var/isam/sdk/impls/ISAuthorized_1.0.0.1.jar
./var/isam/sdk/impls.staging/ISAuthorized_1.0.0.1.jar

In the snapshot the file is also in the same path:

./var/isam/sdk/impls.staging/ISAuthorized_1.0.0.1.jar
./var/isam/sdk/impls/ISAuthorized_1.0.0.1.jar

In the runtime container we don’t have /var/isam/sdk  and the script used to unzip the snapshot doesn’t use that path either so the extension doesn’t get extracted from the snapshot.

I think we’ll need a new container  but  first  I’m trying to figure out if we can work  around that.  ","08/Mar/23 1:24 AM;5b15d94b6256d01ad54eb020;*Internal comment only:*

I did some more testing on this, this morning. In 10.0.3.1  we used an exclude list with the unzip command.  In 10..0.4.0 and  10.0.5.0 we use an include list.  So /var/isam/sdk is not in that list which is why the container doesn’t get the  extension from the snapshot. I’m still investigating how to fix this.   The problem is that  the bootstrap.sh script can’t be patched because it runs first and that is where the snapshots are unpacked.",09/Mar/23 12:00 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ec6d76184b7d989c83]   [~accountid:5c53d3ac23f5bf672621c868]   please open an APAR for this.,09/Mar/23 11:49 AM;5b15d9ec6d76184b7d989c83;Hi. I created IJ45742 for this issue. Thanks!,"10/Mar/23 2:37 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 697f9d5674d5de3e89bc4faf565a1ac92bcf4f15
   * description: Update bootstrap.sh

Updated to include /var/isam for  ISAMSUP-4724

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86366417.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4724) which we publish.","10/Mar/23 3:46 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: a141d55fb764704f4c34f785c732c13c7cdef57e
   * description: Merge pull request #5736 from ISAM/ISAMSUP-4724

Update bootstrap.sh

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86412998.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230310054335-a141d55f.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",11/Mar/23 12:58 AM;5b15d94b6256d01ad54eb020;I got the fix for this checked in.  I can’t provide a fix pack because it will require a new container. So that I’m hoping to get into  10.0.5.0 IF1  which we are working on.,"14/Mar/23 11:17 AM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d94b6256d01ad54eb020] ,
Thank you very much for the good news.
Could you please let me know the current target/scheduled date of IF1 release?
The customer is asking the ETA.",14/Mar/23 11:18 PM;5b15d94b6256d01ad54eb020;I don’t have  an ETA for IF1 at the moment.   We haven’t set one yet.,15/Mar/23 8:13 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ec6d76184b7d989c83] Do you need a new container sooner?,"15/Mar/23 11:15 AM;5b15d9ec6d76184b7d989c83;Hi Bill, 
Thanks for the info.


{quote}Do you need a new container sooner?{quote}

Do you mean, we can provide it to the customer?
(Since I do not have recreation environment, I can not try it in local environment.)","15/Mar/23 10:27 PM;5b15d94b6256d01ad54eb020;Update: I’m getting mixed information on this so do not make  any commitments to the customer. Most likely they will need to wait for IF1 to get a new container. 

I’ll work on it this week and maybe [~accountid:5c53d3ac23f5bf672621c868]  can test it.  Then we can point the customer to where to get it.","20/Mar/23 6:42 PM;5b15d9ec6d76184b7d989c83;Thanks! 
By the way, which version are you going to build image with the fix, 10.0.5? or 10.0.5 IF1?",20/Mar/23 11:36 PM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ec6d76184b7d989c83]  I think it will be included with IF1,29/Mar/23 6:54 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ec6d76184b7d989c83] I don’t think there is anything else I can do on this.   The change should be in 10.0.5.0 IF1.  Do you need anything else or can we close this?,"31/Mar/23 11:32 AM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d94b6256d01ad54eb020] , 10.0.5.0 IF1 was released. So, I have asked the customer to try 10.0.5.0 IF1.
Please wait for the result.","05/Apr/23 6:17 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b15d94b6256d01ad54eb020] ,
According to the customer, the issue still can be observed even if using 10.0.5 IF1:

{quote}<h4>Error details</h4>
<p>Unable to initialize authentication mechanism [urn:ibm:security:authentication:asf:mechanism:isAuthorized].</p>{quote}

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010031284&path=TS010031284%2F2023-04-04%2F&filepath=TS010031284%2F2023-04-04%2F04-April-2023_error.txt|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010031284&path=TS010031284%2F2023-04-04%2F&filepath=TS010031284%2F2023-04-04%2F04-April-2023_error.txt]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS010031284&path=TS010031284%2F2023-04-04%2F&filepa[…]10031284%2F2023-04-04%2F04-April-2023_runtime_logs.txt|https://ecurep.mainz.de.ibm.com/ae5/#id=TS010031284&path=TS010031284%2F2023-04-04%2F&filepa[…]10031284%2F2023-04-04%2F04-April-2023_runtime_logs.txt]

If you need any other info, please let us know.","05/Apr/23 10:50 PM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ec6d76184b7d989c83] or  [~accountid:5c53d3ac23f5bf672621c868] 

Can you recreate it to confirm?","13/Apr/23 4:59 PM;5b15d9ef27631840ea300110;[~accountid:5b15d94b6256d01ad54eb020] On Mar 3 you confirmed that you have local environment already [https://cloudidentity.atlassian.net/browse/ISAMSUP-4724?focusedCommentId=613363|https://cloudidentity.atlassian.net/browse/ISAMSUP-4724?focusedCommentId=613363|smart-link] 

What else you want us to do?",15/Apr/23 6:36 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ef27631840ea300110]  I would you to confirm if it is working or not.,"18/Apr/23 4:45 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] 



I can see jar being placed into lightweight container. but still I get the same error



I see that there is difference in the user who owns the directory and the file in the path



runtime: lightweight (where its giving error)



-rw-r--r--. 1 isam root 7437 Apr 18 09:11 ./var/isam/sdk/impls/ISAuthorized_1.0.0.1.jar

-rw-r--r--. 1 isam root 7437 Apr 18 09:11 ./var/isam/sdk/impls.staging/ISAuthorized_1.0.0.1.jar

[isam@verifyaccessconfig1050-runtime-c7f85cb8b-qmxm9 /]$ 







config container : 



-rw-r--r--. 1 www-data www-data 7437 Apr 18 09:11 ./var/isam/sdk/impls/ISAuthorized_1.0.0.1.jar

-rw-r--r--. 1 www-data www-data 7437 Apr 18 09:11 ./var/isam/sdk/impls.staging/ISAuthorized_1.0.0.1.jar







from appliance: (works fine)



-rw-rw----    1 www-data www-data      7437 Jan 27 16:34 ISAuthorized_1.0.0.1.jar",18/Apr/23 11:45 PM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868] can you send me a support file from your test?  Thanks,"21/Apr/23 12:18 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] 



this is an openshift setup accessible go any ibmer from any where



feel free to access it and get the support file downloaded 

as well as configuration



{{https://verifyaccessconfig1050-10-0-5-0-pr-tusharp.apps.l2nilesh.cp.fyre.ibm.com}}

userid → admin

password → object00





curl to recreate

{noformat}curl --location 'https://rp1050.apps.l2nilesh.cp.fyre.ibm.com/mga/sps/authsvc/policy/ISAuthorized' \
--header 'Content-type: application/json' \
--header 'Authorization: Basic c2VjX21hc3RlcjpvYmplY3QwMA==' \
--data '{""action"": ""INVOKE"",""function"":""Application.PV.PVWeb-PVPropertyLookup-PVPLBlkHouseNoSelection"",""groups"":[""PROD_SUPERUSER""]}'{noformat}





I can provide you more access at log level  let me know incase. you need it","21/Apr/23 12:35 AM;5c53d3ac23f5bf672621c868;putting 10.0.5.0 IF1



{{https://verifyaccessconfig1050-10-0-5-0-pr-tusharp.apps.l2nilesh.cp.fyre.ibm.com}}","21/Apr/23 12:40 AM;5c53d3ac23f5bf672621c868;deployment yml of runtime 

[^pod-verifyaccessconfig1050-runtime-c7f85cb8b-qmxm9.yaml]

","21/Apr/23 1:11 AM;5b15d94b6256d01ad54eb020;This shows that the file is now extracted from the snapshot which wasn’t happening before:

runtime: lightweight (where its giving error)

-rw-r--r--. 1 isam root 7437 Apr 18 09:11 ./var/isam/sdk/impls/ISAuthorized_1.0.0.1.jar

What I need to see  now is log and trace files. ",21/Apr/23 1:37 AM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868]  I am able to get to the console using the link you provided earlier but I don’t see the pods.  Probably because of my user id.  What I want to do is logon to the runtime container after  restarting it. Can you please collect the logs and tracing from that container?,"25/Apr/23 12:49 AM;5c53d3ac23f5bf672621c868;[~accountid:5b15d94b6256d01ad54eb020] 

I may have to trouble you a bit. 

providing All the steps so that you can restart pods and even see the logs( full access to openshift for now and future issues)



# ssh to ssh btyler[@api.l2nilesh.cp.fyre.ibm.com|mailto:root@api.l2nilesh.cp.fyre.ibm.com]
# I have reset your password btyler  to → object00
# sudo oc login
# hit the url [https://oauth-openshift.apps.l2nilesh.cp.fyre.ibm.com/oauth/token/request|https://oauth-openshift.apps.l2nilesh.cp.fyre.ibm.com/oauth/token/request] to get the token ( you will need to login to verify with IBM ID)
# login 
!image-20230424-143850.png|width=1296,height=839!



6.you can login and there is no password storage. it will use ibm id to login and sign in

7.click on display token

!image-20230424-144044.png|width=1214,height=202!



8.

!image-20230424-144116.png|width=1214,height=436!



copy the token part and prefix with sudo

9. {{sudo oc login --token=sha256~0QUbWjQ92X9BAaQ-UPeEXxqP7_Eq9_ofUSwxWEd-6WQ --server=https://api.l2nilesh.cp.fyre.ibm.com:6443}}



10. then you can do sudo oc get pods

you will see set of pods

!image-20230424-144300.png|width=1214,height=436!

11.all the pods having 1050 are the pods related to recreate



fed runtime one is this

verifyaccessconfig1050-runtime-c7f85cb8b-qmxm9



11. you can do changes from config lmi ( which I showed before ) and then publish  can restart the pods using

sudo oc scale --replicas 0 deployment/verifyaccessconfig1050-runtime



12.and then start it using

sudo oc scale --replicas 1 deployment/verifyaccessconfig1050-runtime



13. you can get inside pod like this

sudo oc rsh verifyaccessconfig1050-runtime-c7f85cb8b-866km

14. then trace directory will be in

/var/application.logs.local/rtprofile

15. or directly access the log directory

/isva/isva1040/pr-tusharp-verifyaccessconfig1050-runtime-logs/rtprofile

you will have most of the access to look into the logs. from the pod itself



let me know if this helps ",25/Apr/23 12:54 AM;5b15d94b6256d01ad54eb020;[~accountid:5c53d3ac23f5bf672621c868]  I’ll give that a try.,"25/Apr/23 12:56 AM;5c53d3ac23f5bf672621c868;if you don’t want to get inside pod you can directly access the pod logs at the volume mount



/isva/isva1040/pr-tusharp-verifyaccessconfig1050-runtime-logs/rtprofile","25/Apr/23 8:40 AM;5b15d94b6256d01ad54eb020;Thanks Tushar,   I did look around  on the system and confirmed that the jar was extracted from the snapshot. So that  part is fixed.  I still need to figure out why it isn’t loading.

Internal  comments for reference:

ls -l /var/isam/sdk/impls
total 16
-rw-r--r--. 1 isam root 7455 Apr 18 09:11 GetEntitlement_1.0.0.1.jar
-rw-r--r--. 1 isam root 7437 Apr 18 09:11 ISAuthorized_1.0.0.1.jar

trace_23.04.24_20.17.33.0.log

[4/24/23, 20:17:01:715 IST] 00000023 id=00000000 .security.access.extension.manager.ExtensionManagerActivator I start FBTSDK004I Not starting any extension bundles because no extension files were found.

/var/isam/sdk/impls  is used by   the  rba  BundleManager



In: the fim   ExtensionManagerActivator.java

""/opt/IBM/wlp/usr/extension/lib/isam/sdk/impls/""

On the pod:

ls /opt/IBM/wlp/usr/extension/lib/isam/sdk/impls/
ls: cannot access '/opt/IBM/wlp/usr/extension/lib/isam/sdk/impls/': No such file or directory

--

I looked in your xml file  at  the  trace specification and you don’t  have rba  specified.   So  can you add that and retest.  The reason is  that your extension is  here:  /var/isam/sdk/impls    which  is used by BundleManager, and that’s part of rba,    but we don’t have tracing for it so see if there are any problems there.","28/Apr/23 12:11 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b15d94b6256d01ad54eb020] 
I have enabled com.tivoli.am.rba.*=ALL and restarted the pod. 
Please check rba.zip.
The restarted pod is still running: verifyaccessconfig1050-runtime-c7f85cb8b-r5zth

If you need any other info, please let us know.","02/May/23 11:58 PM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ec6d76184b7d989c83]  I was out Thursday and Friday so it looks like that pod is gone.

I looked over the rba trace files and don’t  see  what I hoped to see. That was at least an attempt to load the extension.    “com.tivoli.am.rba.*=ALL”  should have shown it if it had been called.  I’m looking  into how that should work so I can try to find out what happened.   I’m reviewing the changes made from 10.0.4 to 10.0.5.  So far I haven’t found any changes that would have affected this.",04/May/23 12:26 AM;5b15d94b6256d01ad54eb020;FYI I did get the issues I had with my local environment worked out and  I did recreate this yesterday  and my logs look similar to yours.   So I  won’t have to access your environment which I hope will save some time.  ,"08/May/23 11:39 AM;5b15d9ec6d76184b7d989c83;[~accountid:5b15d94b6256d01ad54eb020] ,
Thank you very much for the update, and sorry to late to respond.
There were several national holidays in Japan last week.

I will wait for another update from your side.
If you need any other info, please let us know.

Best regards,
Yutaka","08/May/23 4:22 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b15d94b6256d01ad54eb020] ,

I collected trace.log again (please check trace.log.zip).
After I enabled the trace, I issued following command:

{noformat}[admin@api ~]$ curl -k --location 'https://rp1050.apps.l2nilesh.cp.fyre.ibm.com/mga/sps/authsvc/policy/ISAuthorized' --header 'Content-type: application/json' --header 'Authorization: Basic c2VjX21hc3RlcjpvYmplY3QwMA==' --data '{""action"": ""INVOKE"",""function"":""Application.PV.PVWeb-PVPropertyLookup-PVPLBlkHouseNoSelection"",""groups"":[""PROD_SUPERUSER""]}'
<?xml version=""1.0"" encoding=""UTF-8""?>
<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.1//EN"" ""http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"">
<html>
    <head>
        <meta http-equiv=""Content-Type"" content=""text/html; charset=UTF-8""/>
        <title>Server Error</title>
        <link rel=""stylesheet"" type=""text/css"" href=""/mga/sps/static/styles.css"" />
    <SCRIPT type=""text/javascript"">
/*<![CDATA[*/
document.cookie = ""IV_JCT=%2Fmga; path=/;secure"";
/*]]>*/
</SCRIPT>
</head>
    <body>
        <div class=""header"">
            <div class=""brandingLogo""><img src=""/mga/sps/static/ibm-logo.png"" /></div>
        </div>
        <div class=""content"">
            <div class=""contentHeader"">
                <h1 class=""pageTitle error"">Server Error</h1>
                <div class=""instructions""></div>
            </div>
            <div class=""pageContent"">
                <div id=""infoDiv"">
                    <p><em>/sps/authsvc/policy/ISAuthorized</em></p>
                    <p><em>2023-05-08T06:10:19Z</em></p>
                </div>
                <br />
                <div id=""detailDiv"">
                    <h4>Error details</h4>
                    <p>Unable to initialize authentication mechanism [urn:ibm:security:authentication:asf:mechanism:isAuthorized].</p>
                </div>
                <br />
                <div id=""stackDiv"">
                    <h4>Stack trace</h4>
                    <pre></pre>
                </div>
            </div>
        </div>
    </body>
</html>{noformat}

You can see following exception in the trace.log:

{quote}[5/8/23, 11:40:19:700 IST] 00000d24 id=00000000 com.tivoli.am.fim.fedmgr2.page.PageImpl                      3 replaceTokensInString input tokenmaping before: [ {@TIMESTAMP@=2023-05-08T06:10:19Z, @JUN
CTION@=, @EXCEPTION_STACK@=java.lang.RuntimeException: Unable to initialize authentication mechanism [urn:ibm:security:authentication:asf:mechanism:isAuthorized].
…{quote}


The current name of the runtime pod is verifyaccessconfig1050-runtime-c7f85cb8b-j85vc .
(I forgot to issue above curl command when I sent you the previous trace. I’m really sorry for this inconvenience.)",09/May/23 12:32 AM;5b15d94b6256d01ad54eb020;Thanks [~accountid:5b15d9ec6d76184b7d989c83]  that new trace helps a lot.  I need to dig into this more but I have a pretty good idea why it isn’t working. The directory where the extension is extracted from the snapshot is only used by rba and the fim extension loader is one being called.,"09/May/23 5:54 AM;5b15d94b6256d01ad54eb020;I think I see the problem.  On a regular appliance  we have a link like this:

/opt/IBM/wlp/usr/extension/lib/isam/sdk/impls -> /var/isam/sdk/impls

That doesn’t exist on the docker appliance. At least not in 10.0.5.0 and the fim extension  manager is looking for that path.","10/May/23 3:58 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ec6d76184b7d989c83] since this issue is triggered when you make the curl call, can you try adding that link and see if it works?  I think that is the main problem now. If it does we might be able to fix it using a fixpack.","10/May/23 5:48 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d94b6256d01ad54eb020] ,

sh-4.4$ ln -s /var/isam/sdk/impls /opt/IBM/wlp/usr/extension/lib/isam/sdk
sh-4.4$ ls -l /opt/IBM/wlp/usr/extension/lib/isam/sdk
total 0
drwxrwxr-x. 2 isam root 116 Mar 29 07:25 defs
lrwxrwxrwx. 1 isam root  19 May 10 13:11 impls -> /var/isam/sdk/impls
sh-4.4$

Then error seems to change as following:


{noformat}[admin@api ~]$ curl -k --location 'https://rp1050.apps.l2nilesh.cp.fyre.ibm.com/mga/sps/authsvc/policy/ISAuthorized' --header 'Content-type: application/json' --header 'Authorization: Basic c2VjX21hc3RlcjpvYmplY3QwMA==' --data '{""action"": ""INVOKE"",""function"":""Application.PV.PVWeb-PVPropertyLookup-PVPLBlkHouseNoSelection"",""groups"":[""PROD_SUPERUSER""]}'
<?xml version=""1.0"" encoding=""UTF-8""?>
<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.1//EN"" ""http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"">
<html>
    <head>
        <meta http-equiv=""Content-Type"" content=""text/html; charset=UTF-8""/>
        <title>Server Error</title>
        <link rel=""stylesheet"" type=""text/css"" href=""/mga/sps/static/styles.css"" />
    <SCRIPT type=""text/javascript"">
/*<![CDATA[*/
document.cookie = ""IV_JCT=%2Fmga; path=/;secure"";
/*]]>*/
</SCRIPT>
</head>
    <body>
        <div class=""header"">
            <div class=""brandingLogo""><img src=""/mga/sps/static/ibm-logo.png"" /></div>
        </div>
        <div class=""content"">
            <div class=""contentHeader"">
                <h1 class=""pageTitle error"">Server Error</h1>
                <div class=""instructions""></div>
            </div>
            <div class=""pageContent"">
                <div id=""infoDiv"">
                    <p><em>/sps/authsvc/policy/ISAuthorized</em></p>
                    <p><em>2023-05-10T07:42:34Z</em></p>
                </div>
                <br />
                <div id=""detailDiv"">
                    <h4>Error details</h4>
                    <p>com.tivoli.am.fim.fedmgr2.page.PageNotFoundException: /authsvc/authenticator/index.html</p>
                </div>
                <br />
                <div id=""stackDiv"">
                    <h4>Stack trace</h4>
                    <pre></pre>
                </div>
            </div>
        </div>
    </body>
</html>{noformat}



I have attached the trace.log as trace2.log.zip.","10/May/23 5:53 PM;5c53d3ac23f5bf672621c868;[~accountid:5b15d9ec6d76184b7d989c83] 



it means the mechanism got initiated successfully. 

that’s an index page I used","10/May/23 11:47 PM;5b15d94b6256d01ad54eb020;Thanks [~accountid:5c53d3ac23f5bf672621c868] and [~accountid:5b15d9ec6d76184b7d989c83] 

Would a fix pack to create the link be helpful?","11/May/23 4:03 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d94b6256d01ad54eb020] ,
I discussed with Tushar.
Could you please provide fixpack which can be used for their container environment?
Can I create additional APAR for this issue?",11/May/23 10:36 PM;5b15d94b6256d01ad54eb020;I think we can update the existing APAR.,"16/May/23 7:44 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b15d94b6256d01ad54eb020] 
The customer would like to know the ETA for the fix pack.
Could you please let me know the current status?","18/May/23 1:12 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b15d94b6256d01ad54eb020] ,
I have received case escalation (Escalation Reason: Time to resolve issue).
Could you please provide current status to share with the customer?

FYI: [~accountid:5ac57757d9a96536d1f0daa9] , this is the case that Rahul Vernekar sent you email directly.","19/May/23 12:12 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ec6d76184b7d989c83] I was out sick some this week so I was delayed on working on that.  I don’t think it will take me long to build the fix pack.  

Update:   FYI  I did add this to our development stream so I think this latest fix will be in 10.0.6.0","19/May/23 12:58 AM;5b15d94b6256d01ad54eb020;[~accountid:5b15d9ec6d76184b7d989c83] [~accountid:5c53d3ac23f5bf672621c868] 

Here’s the fix pack. Please test before distributing.

[https://ibm.ent.box.com/folder/208218497586|https://ibm.ent.box.com/folder/208218497586|smart-link] ","19/May/23 4:20 PM;5b15d9ec6d76184b7d989c83;Welcome back, and thanks!
It worked as expected (the missing symbolic was created in our local openshift environment).
I will forward it to the customer.",19/May/23 11:54 PM;5b15d94b6256d01ad54eb020;Thanks [~accountid:5b15d9ec6d76184b7d989c83] ,"20/May/23 1:14 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 58a82f4bc77423edb7766a4d68963095bbe4c5e6
   * description: Merge pull request #5968 from ISAM/ISAMSUP-4724

Update install_isva.sh

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/571171.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230519151123-58a82f4b.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","20/May/23 2:35 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 58a82f4bc77423edb7766a4d68963095bbe4c5e6
   * description: Merge pull request #5968 from ISAM/ISAMSUP-4724

Update install_isva.sh

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/573893.


This build has not been published as the commit is not currently within a branch (20230519151123-58a82f4b) which we publish.","20/May/23 8:51 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build error occurred while generating the build for the following commit: 
   * id: 58a82f4bc77423edb7766a4d68963095bbe4c5e6
   * description: Merge pull request #5968 from ISAM/ISAMSUP-4724

Update install_isva.sh

Failed to publish a build artifact!

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/584717.

","20/May/23 8:51 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build error occurred while generating the build for the following commit: 
   * id: 58a82f4bc77423edb7766a4d68963095bbe4c5e6
   * description: Merge pull request #5968 from ISAM/ISAMSUP-4724

Update install_isva.sh

Failed to publish a build artifact!

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/584717.

","29/May/23 7:48 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b15d94b6256d01ad54eb020] ,
The customer agreed to close the case.

{quote}Thank you so much for you, your team and L3 Team for providing resolution to this issue.

Please extend our gratitude to the personels involved in fixing this case.{quote}

Thank you very much!",30/May/23 11:30 PM;5b15d94b6256d01ad54eb020;That’s great news [~accountid:5b15d9ec6d76184b7d989c83] .  Thanks for the update.,,,,,,,,,,,,,Done
%USERNAME% not expanded correctly for SPNEGO users.,ISAMSUP-5229,311822,Support,To Do,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,,,,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,14/Jul/23 7:27 AM,14/Jul/23 7:32 AM,14/Jul/23 9:38 AM,,,Support,,0,,,,"When expanding the %USERNAME% macro for an SPNEGO user in a response generated from help.html, the user’s DN is used, rather than the user name. 

From the request log, with the correct user name.

{{10.3.122.245 - kishore.dangeti@ed.gov [13/Jul/2023:15:29:46 -0400] ""GET /pkmslogout HTTP/1.1"" Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 200 1798}}

Portions of the parsed request and response, with the DN.

{{(100) 2023-07-13-15:29:46.760 Client (10.3.122.245:10240) to WebSEAL (192.168.123.118:8082) sending 1226 bytes}}
{{GET /pkmslogout HTTP/1.1}}
{{Host: g5ani1piv.dectest.ed.gov}}

{{(100) 2023-07-13-15:29:46.761 WebSEAL (192.168.123.118:8082) to Client (10.3.122.245:10240) sending 2051 bytes}}
{{HTTP/1.1 200 OK}}

{{<TITLE>Help</TITLE>}}

{{} else if (location.hostname.toLowerCase().indexOf(""g5"") != -1){
        window.location = ""<<https://authservice-poc-test.apps.socpegp-nonprod.egp.tenant/g6-logout?userEmail=uid=EIAKISHORE,cn=users,DC=ED,DC=GOV&lgSignOut=true"">> }}

The relevant snippet of help.html.

{{[stendres@debug71]:PIV $ freegrep -A1 'indexOf(""g5"")' server-root/lib/management/C/help.html}}
{{        } else if (location.hostname.toLowerCase().indexOf(""g5"") != -1){}}
{{                window.location = ""https://authservice-poc-test.apps.socpegp-nonprod.egp.tenant/g6-logout?userEmail=%USERNAME%&lgSignOut=true""}}
{{[stendres@debug71]:PIV $}}

May I open an APAR for this issue?",,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013590256,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,IMMIXTECHNOLOGY INC (US Department of Education),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013590256&path=TS013590256%2F2023-07-13%2Fisva_10.0.5.0_20230713-153227_a1g5ws01.dectest.ed.gov.support_unpack%2Fvar%2Fpdweb%2FPIV%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1dksv:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,To Do
Can not connect wrp using TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 ,ISAMSUP-5161,307812,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,David Hayes,5b232b2fd85e5b59b066f57f,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,21/Jun/23 12:03 PM,12/Jul/23 2:07 PM,14/Jul/23 2:47 PM,12/Jul/23 2:07 PM,10.0.7,Support,,0,,,,"We can see following in our document ([https://www.ibm.com/docs/en/sva/10.0.2?topic=stanza-default|https://www.ibm.com/docs/en/sva/10.0.2?topic=stanza-default|smart-link] ):


{noformat}The following aliases are default values prior to version 10.0.0.0:
default = AES-128
default = AES-256

The legacy cipher aliases AES-128 and AES-256 are equivalent to the following default values:
# AES-128
default = TLS_AES_128_CCM_8_SHA256
default = TLS_AES_128_CCM_SHA256
default = TLS_AES_128_GCM_SHA256
default = TLS_RSA_WITH_AES_128_CBC_SHA
default = TLS_RSA_WITH_AES_128_CBC_SHA256
default = TLS_RSA_WITH_AES_128_GCM_SHA256

# AES-256
default = TLS_AES_256_GCM_SHA384
default = TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
default = TLS_RSA_WITH_AES_256_CBC_SHA256
default = TLS_RSA_WITH_AES_256_GCM_SHA384{noformat}



It seems as if AES-256 contains TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384.
But we can not access WebSEAL if there’re only AES-128 and AES-256.
By adding
  default = TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
I can access.
I tried 9.0.6, 10.0.5, and the result was the same

Is this document error? (I mean, I guess the list should not contain TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384). If so, may I open new doc apar?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ47473,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013340089,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,KYNDRYL JAPAN KK MUFG BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-07-06T17:55:09.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cwgf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.6.0,ISVA 10.0.2.0,ISVA 10.0.5.0,,,,,,,,,,,2023-06-21 03:08:30.833,,,,,"21/Jun/23 1:08 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9ec6d76184b7d989c83] - I suspect this is actually a code defect. I’m just in the process of confirming with the Development Team- I’ll let you know. 

for my reference :- i4w/pdweb/webseald/ssl/ssl_qop_mgmt.cpp:457
","28/Jun/23 11:01 AM;5b15d9ec6d76184b7d989c83;Hi. This is just a weekly follow-up to let the customer know the current status. 
Are there any update from dev team?","04/Jul/23 2:21 PM;5b232b2fd85e5b59b066f57f;For my reference - was introduced by commit f8fcc59da1469a32340545ead1b477088eb2c7d0 - [https://github.ibm.com/ISAM/isam/commit/f8fcc59da1469a32340545ead1b477088eb2c7d0|https://github.ibm.com/ISAM/isam/commit/f8fcc59da1469a32340545ead1b477088eb2c7d0] but there is nil context as to why. This change basically removes TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 from the AES_256 cipher group and TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 from the AES_128 cipher group for non-IAG appliances. Note that as you have confirmed, the ciphers aren’t actually disabled as they can be explicitly specified - they are simply not put in the cipher group which doesn’t make a lot of sense. 

I’ve made a suggested code change ([https://github.ibm.com/ISAM/isam/pull/6013|https://github.ibm.com/ISAM/isam/pull/6013]) and submitted for review in order to continue the discussion with the Development team. I’ll let you know the outcome. ","04/Jul/23 3:51 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: f047f5ca928d96fcaa56272edfcfc5e3690c6b03
   * description: ISAMSUP-5161

Modify AES_256 cipher group to include
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 and AES_128 to include
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2121974.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5161) which we publish.","04/Jul/23 6:07 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b232b2fd85e5b59b066f57f] ,
It seems that the code change seems to be accepted.
Can I open the new APAR for this ?",05/Jul/23 10:54 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9ec6d76184b7d989c83] - not at this stage. I still need to have a discussion to confirm that we can enable these ciphers without re-introducing potential vulnerabilities as I believe this is why they were removed from the cipher groups in the first place.  ,06/Jul/23 12:01 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:5b15d9ec6d76184b7d989c83] - please raise an APAR. ,"06/Jul/23 12:38 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b232b2fd85e5b59b066f57f] 
Thanks for the update. I opened IJ47473 for this issue.","06/Jul/23 1:03 PM;5b232b2fd85e5b59b066f57f;Thanks. Code is merged. Closing APAR. 

[~accountid:5b15d9ec6d76184b7d989c83] - anything further required here or can we close this out? ","06/Jul/23 5:55 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 3198adc39377e04e382ba2936ea78acc8a3a19aa
   * description: ISAMSUP-5161 (#6013)

Modify AES_256 cipher group to include
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 and AES_128 to include
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2234202.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230706075207-3198adc39.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","06/Jul/23 6:36 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 3198adc39377e04e382ba2936ea78acc8a3a19aa
   * description: ISAMSUP-5161 (#6013)

Modify AES_256 cipher group to include
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 and AES_128 to include
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2236492.


This build has not been published as the commit is not currently within a branch (20230706071051-272c95137) which we publish.","06/Jul/23 7:17 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 3198adc39377e04e382ba2936ea78acc8a3a19aa
   * description: ISAMSUP-5161 (#6013)

Modify AES_256 cipher group to include
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 and AES_128 to include
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2238327.


This build has not been published as the commit is not currently within a branch (20230706075207-3198adc39) which we publish.","12/Jul/23 2:07 PM;5b15d9ec6d76184b7d989c83;[~accountid:5b232b2fd85e5b59b066f57f] ,

The customer agreed to close the case. So, I will change the status to ‘DONE’.
Thank you very much for the help!
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Session Timeout (seconds) for SAML and DSC's maximum session lifetime.,ISAMSUP-5125,305256,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,07/Jun/23 12:24 PM,08/Jun/23 6:04 PM,14/Jul/23 2:47 PM,08/Jun/23 6:04 PM,,Support,,0,,,,"Currently, the customer is using 24h (43200 sec)  for  Session Timeout (seconds) in SAML Message Settings tab of Edit screen for Federation definition.
(not ""assertionValidAfter"" and ""assertionValidBefore"", but “sessionTimeout”)
He is planning to use saml20.sessionStore: DSC.
DSC has ‘Maximum session lifetime’ which default value is 3600.

In this case, if the customer would like to keep SAML session for 43200 seconds, 
should he set 43200 to DSC’s Maximum session lifetime?
I mean, Session Timeout in SAML Message Settings tab will be ignored if saml20.sessionStore: DSC?

",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,07/Jun/23 5:58 PM;ashashiv;image-20230607-075646.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204357,07/Jun/23 5:58 PM;ashashiv;image-20230607-075743.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204358,07/Jun/23 5:58 PM;ashashiv;image-20230607-075839.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204359,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013043812,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,"HITACHI SYSTEMS, LTD.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cgu7:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-07 07:55:45.25,,,,,"07/Jun/23 5:55 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9ec6d76184b7d989c83] 

This is my test here - 

session store set to DSC 

!image-20230607-075839.png|width=806,height=45!



sessionTimeout is set to 720 

!image-20230607-075743.png|width=230,height=87!



dsc max session lifetime is set to 360 

!image-20230607-075646.png|width=230,height=87!



Created at - {{2023-06-07-17:40:47.581}} 

Deleted at - {{2023-06-07-17:52:50.000}} 

time to live is taken as 720 seconds.

dsc.log for this session- 

{noformat}2023-06-07-17:40:47.581+10:00I----- /opt/dsc/bin/dscd DEBUG9 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSSession.cpp 614 0x7fa55b091700
[] Session: time-to-live (720)

2023-06-07-17:40:47.581+10:00I----- /opt/dsc/bin/dscd DEBUG9 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSSession.cpp 89 0x7fa55b091700
[] Session: new data1(rs='FIM_DSC_SAML20_REPLICA_SET', s='itfim/di', u='')

2023-06-07-17:41:23.000+10:00I----- /opt/dsc/bin/dscd DEBUG8 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSReplicator.cpp 207 0x7fa559d83700
[] Node 0: total=1 received=0 ignored=0 addDeleted=0 addNew=0 idleTOIgnored=0

2023-06-07-17:52:50.000+10:00I----- /opt/dsc/bin/dscd DEBUG9 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSSessionCache.cpp 1198 0x7fa557cfd700
[] ExpiryTimer expired session FIM_DSC_SAML20_REPLICA_SET:itfim/di: permanently deleted

2023-06-07-17:52:50.000+10:00I----- /opt/dsc/bin/dscd DEBUG9 wds server /build/isam/src/i4w/pdwebrte/dsess/server/interface/AMWSMSSession.cpp 144 0x7fa557cfd700
[] Session: delete(rs='FIM_DSC_SAML20_REPLICA_SET', s='itfim/di', u=''){noformat}

Let me know if this answers your question.","08/Jun/23 6:04 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,
Thank you very much for letting me know how to verify the behavior.
I think I can persuade the customer.
Thank you very much for the help!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
need fix_keyfile_pwd_entries for 10.0.5,ISAMSUP-5101,302547,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,29/May/23 11:55 AM,30/May/23 8:00 PM,14/Jul/23 2:47 PM,30/May/23 8:00 PM,,Support,,0,,,,"The customer is trying to import WebSEAL which is exported from ISAM7 to 10.0.5.

After importing, WebSEAL can not get started due to following error:
  DPWIV1210W   関数呼び出し gsk_environment_init が失敗しました。エラー: 00000198 GSK_ERROR_BAD_KEYFILE_PASSWORD。

And I confirmed that obf file has webseal-cert-keyfile-pwd.
So, I found [https://cloudidentity.atlassian.net/browse/ISAMSUP-4213|https://cloudidentity.atlassian.net/browse/ISAMSUP-4213] and sent it to the customer, 
but it caused

{quote}Event ID ""GLGFP1004E""

Event description \"" Fix pack file fix keyfile pwd entries.fixpack \"" does not have a valid digital signature.{quote}

Could you please build the fix pack for 10.0.5?
Or, am I missing something?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013002142,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,MITSUBISHI HC CAPITAL INC.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bzkv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-29 03:31:43.305,,,,,"29/May/23 1:31 PM;5b15d954b0d76456f36daf33;[~accountid:5b15d9ec6d76184b7d989c83] I think the problem is to do with the signature validation being newer at 10.0.5.0 than when that fixpack was built.

I’ve rebuilt the fixpack using the new signature, but I haven’t had a chance to test this specific use case. Would you be able to verify? And if it works, feel free to pass it on to the customer.

The new fixpack is attached to the item [https://cloudidentity.atlassian.net/browse/ISAMSUP-4213|https://cloudidentity.atlassian.net/browse/ISAMSUP-4213|smart-link] ","29/May/23 2:43 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d954b0d76456f36daf33] ,

It works in local environment as expected.
Thank you very much for the prompt response!
I will pass it to the customer.

","29/May/23 7:23 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d954b0d76456f36daf33] ,

Unfortunately, it was failed to be installed.

I found the cause.
The customer’s instance name is “default-webseald-SECWBP1”.
This caused the failure due to the following code in post_install.sh

{quote}  mesa_config [wga.web|http://wga.web] list | awk '{ print $1 }' | sed 's/webseald-//g' >> $lst_files{quote}

I think it just need to remove only the first occurrence of webseald- to retrieve the instance name.
For example:

{quote}mesa_config [wga.web|http://wga.web] list | awk '{ print $1 }' | sed 's/^webseald-//' >> $lst_files{quote}

Could you please revise the fix pack?
Sorry for this inconvenience.",30/May/23 9:58 AM;5b15d954b0d76456f36daf33;Good catch [~accountid:5b15d9ec6d76184b7d989c83] . I’ve refreshed the fixpack based on your suggestion. Please see if it helps.,"30/May/23 8:00 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d954b0d76456f36daf33] ,
I created an instance with similar name and the new fix pack worked as expected.
Thank you very much for the help!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
With database cleanup disabled deletes are still sent to the database on runtime startup,ISAMSUP-5078,299927,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,,David Hayes,5b232b2fd85e5b59b066f57f,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,17/May/23 6:06 AM,06/Jul/23 12:02 PM,14/Jul/23 2:47 PM,,10.0.7,,,0,,,,"With values set for session.dbCleanupInterval of either -1 or 0 on startup of the runtime database entries are still being deleted.  The customer expects that with this and other values set that there would be no deletes at all.  As the delete caused a outage when multiple runtimes were restarted and there was a DB contention issue. 



LibertyRuntimeThreadServletContextListener.java has code in it that is staring cleanupthreads independent of these settings.   As it calls 
RTSSExtensionDatabaseCleanupManager.getInstance().initializeDbCleanupThread();

Which calls 
                dbCleanupThread.addListener(new DBRuntimeDataCleanup());

                dbCleanupThread.start(); 

Which calls 

isam/src/i4m/rba/com.tivoli.am.rba.fingerprinting/src/com/tivoli/am/rba/fingerprinting/DBRuntimeDataCleanup.java    process method

Which calls 
attrDBHelper.deleteAlreadyExpiredSession();

other methods that can result in a DELETE being sent to the database. 



This appears to only impact
session.dbCleanupInterval to 0





It has the potential to impact  distributedMap.cleanupWait to 0

If the startDbCleanupThread is changed.

This does not appear to impact 

authsvc.stateMgmt.HVDB.cleanupWait to 0
mmfa.authenticator.cleanupWait to 0
mmfa.transactionArchival.cleanupInterval to 0

As these all have checks built in to idle the thread before any SQL is called.







I think that RTSSExtension.initializeDbCleanupThread(); needs to have similar logic in it to get the config setting and not start the thread when session.dbCleanupInterval <= 0  
com.tivoli.am.rba.utils.TimerThread appears to be the runner for DBRuntimeDataCleanup which appears to let it run once before it sets the frequency 


From my 10.0.5 recreate:

{noformat}[5/16/23, 13:30:32:646 CDT] 0000002c id=00000000 com.tivoli.am.rba.utils.TimerThread                          > addListener ENTRY
[5/16/23, 13:30:32:646 CDT] 0000002c id=00000000 com.tivoli.am.rba.utils.TimerThread                          < addListener RETURN
[5/16/23, 13:30:32:667 CDT] 00000048 id=00000000 com.tivoli.am.rba.utils.TimerThread                          > run ENTRY
[5/16/23, 13:30:32:668 CDT] 00000048 id=00000000 com.tivoli.am.rba.utils.TimerThread                          3 run Start processing for com.tivoli.am.rba.fingerprinting.DBRuntimeDataCleanup@d814042f
...
[5/16/23, 13:30:32:668 CDT] 00000048 id=00000000 com.tivoli.am.rba.fingerprinting.DBRuntimeDataCleanup        > process ENTRY
...
[5/16/23, 13:30:32:672 CDT] 00000048 id=00000000 com.tivoli.am.rba.fingerprinting.DBRuntimeDataCleanup        > getAttrSessionDBHelper ENTRY
...
[5/16/23, 13:30:32:818 CDT] 00000048 id=00000000 com.tivoli.am.rba.fingerprinting.DBRuntimeDataCleanup        < getAttrSessionDBHelper RETURN
[5/16/23, 13:30:32:818 CDT] 00000048 id=00000000 voli.am.rba.fingerprinting.impl.AttributeSessionDBHelperImpl > deleteAlreadyExpiredSession ENTRY
...
[5/16/23, 13:30:32:819 CDT] 00000048 id=00000000 voli.am.rba.fingerprinting.impl.AttributeSessionDBHelperImpl > deleteSessionDataExceededRecTime ENTRY
...
[5/16/23, 13:30:32:824 CDT] 00000048 id=00000000 voli.am.rba.fingerprinting.impl.AttributeSessionDBHelperImpl 1 deleteSessionDataExceededRecTime 0 session attributes were deleted due to expiry
...
[5/16/23, 13:30:32:828 CDT] 00000048 id=00000000 voli.am.rba.fingerprinting.impl.AttributeSessionDBHelperImpl < deleteSessionDataExceededRecTime RETURN
...
[5/16/23, 13:30:32:867 CDT] 00000048 id=00000000 com.tivoli.am.rba.fingerprinting.DBRuntimeDataCleanup        < process RETURN
[5/16/23, 13:30:32:867 CDT] 00000048 id=00000000 com.tivoli.am.rba.utils.TimerThread                          > setFrequency ENTRY
[5/16/23, 13:30:32:906 CDT] 00000048 id=00000000 com.tivoli.am.rba.utils.TimerThread                          1 setFrequency TimerThread in idle state
[5/16/23, 13:30:32:906 CDT] 00000048 id=00000000 com.tivoli.am.rba.utils.TimerThread                          < setFrequency RETURN 30
[5/16/23, 13:31:02:907 CDT] 00000048 id=00000000 com.tivoli.am.rba.utils.TimerThread                          > setFrequency ENTRY
[5/16/23, 13:31:02:907 CDT] 00000048 id=00000000 com.tivoli.am.rba.utils.TimerThread                          1 setFrequency TimerThread in idle state
[5/16/23, 13:31:02:907 CDT] 00000048 id=00000000 com.tivoli.am.rba.utils.TimerThread                          < setFrequency RETURN 30{noformat}



As you can see it allows the thread to run that first time before the setFrequency is called that first time which stops future runs of the thread. 



I’m also not sure why the runner is checking the DB every 30 seconds to see if it should restart the thread. Or if there is any impact from not creating the thread and just doing a reload of the config vs a restart. 


The customer reported this in 10.0.3.1 and I recreated it at 10.0.5",,Annelise Quap,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,5b15d950d9936c61022057fe,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5203,,,,,,,,,,,,,,,,,IJ46924,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012115544,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,VOYA SERVICES COMPANY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-07-04T16:06:13.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bjlz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,ISVA 10.0.5.0,,,,,,,,,,,,2023-05-22 01:21:34.58,,,,,19/May/23 7:25 AM;5b15d950d9936c61022057fe;Should I open an APAR for this? The customer is asking for a fix. ,20/May/23 12:08 AM;5b15d950d9936c61022057fe;On these servers are installed the fixpacks JWT_Token_Generation_Issue_10031 and Pop_Attachment_Check_Tuning_Param_10031.,"22/May/23 11:21 AM;5b232b2fd85e5b59b066f57f;For support reference - same fix needed as in [https://cloudidentity.atlassian.net/browse/ISAMSUP-3591|https://cloudidentity.atlassian.net/browse/ISAMSUP-3591|smart-link]  [https://github.ibm.com/ISAM/isam/pull/4338/files|https://github.ibm.com/ISAM/isam/pull/4338/files]

Need to do the same in: 

StartSessionCleanupThreadCmd.java:run()

StartTokenCleanupThreadCmd.java:run()

[~accountid:5b15d950d9936c61022057fe] - please create an APAR. ","23/May/23 12:42 AM;5b15d950d9936c61022057fe;[~accountid:5b232b2fd85e5b59b066f57f]  That Jira you listed shows fix version of 10.0.3, but clearly it was not fixed. as I recreated it in 10.0.5
The methods you list are not the ones that I found that were letting the first run through. 

The Jira you linked points to another cleanup thread.   

So I’m not sure if you meant to say same *type* of fix needed, but not the exact fix. 

Did you mean similar changes need to be made in /src/i4m/rba/com.tivoli.am.rba.common/src/com/tivoli/am/rba/utils/TimerThread.java  



Created APAR IJ46924","23/May/23 12:46 AM;5b15d950d9936c61022057fe;The customer reports they will need a fixpack and conformation that this is in firmware that they would upgrade to.

They reported that they have the following applied on top of 10.0.3.1  JWT_Token_Generation_Issue_10031 and Pop_Attachment_Check_Tuning_Param_10031",26/May/23 1:35 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d950d9936c61022057fe] - it was fixed in 10.0.3 for the DMAP table ( [https://cloudidentity.atlassian.net/browse/ISAMSUP-3591|https://cloudidentity.atlassian.net/browse/ISAMSUP-3591|smart-link]). We need a similar fix for these other instances. ,13/Jun/23 11:59 PM;5b15d950d9936c61022057fe;The customer is asking for an update on this APAR.,16/Jun/23 10:13 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d950d9936c61022057fe] Dave is on leave until Tuesday next week and thus we will need to revisits this with him next week on his return. Appreciate the support on this. ,22/Jun/23 9:34 PM;5b15d901fa615349cb01778b;[~accountid:5b232b2fd85e5b59b066f57f] Any update?,28/Jun/23 1:11 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d901fa615349cb01778b] - I understand the behaviour and know what the required changes are. Once the APAR changes have been made I’ll update. ,"29/Jun/23 3:58 AM;5b15d950d9936c61022057fe;The customer update “Yes, we are eagerly waiting for this fixpack. We want to apply it to keep from the possibility of sev 1s if a restart of the runtime occurs. Other than the fixpacks that I mentioned earlier, we have not applied any other fixpacks to the ISVA environments.”",04/Jul/23 12:06 PM;5b232b2fd85e5b59b066f57f;Code sent for review. ,"04/Jul/23 1:22 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 38d39a01eca49fb1f30dd3b087adb4d7542218d9
   * description: ISAMSUP-5078

Prevent DB cleanup jobs from triggering on runtime start if they have
been turned off.

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2120178.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5078) which we publish.","04/Jul/23 2:37 PM;5b232b2fd85e5b59b066f57f;Code approved and merged. Closing WI. 

Now working on a personal fix-pack for 10.0.3.1 - [https://cloudidentity.atlassian.net/browse/ISAMSUP-5203|https://cloudidentity.atlassian.net/browse/ISAMSUP-5203|smart-link]","04/Jul/23 4:06 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 50ae48f73f13f70ec6c1124aa887326eae6d5987
   * description: Merge pull request #6012 from ISAM/ISAMSUP-5078

ISAMSUP-5078

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2122143.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230704060317-50ae48f73.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","04/Jul/23 5:28 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 50ae48f73f13f70ec6c1124aa887326eae6d5987
   * description: Merge pull request #6012 from ISAM/ISAMSUP-5078

ISAMSUP-5078

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/2124351.


This build has not been published as the commit is not currently within a branch (20230704060317-50ae48f73) which we publish.","05/Jul/23 11:58 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d950d9936c61022057fe] - fix-pack for 10.0.3.1 is available at [https://cloudidentity.atlassian.net/browse/ISAMSUP-5203|https://cloudidentity.atlassian.net/browse/ISAMSUP-5203|smart-link]

Can you please verify that this fixes the issue in your lab environment and if all good - pass on to the customer? 

Let me know how it goes. 

Thanks. ",06/Jul/23 3:22 AM;5b15d950d9936c61022057fe;[~accountid:5b232b2fd85e5b59b066f57f]  The 10.0.3.1 fixpack does it include JWT_Token_Generation_Issue_10031 and Pop_Attachment_Check_Tuning_Param_10031 as requested or is compatible with them?,06/Jul/23 12:02 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d950d9936c61022057fe] - the fix-packs are compatible. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
reverse proxy pd* traces activated unexpectedly,ISAMSUP-4884,287834,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,David Hayes,5b232b2fd85e5b59b066f57f,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,16/Mar/23 6:18 AM,27/Mar/23 10:16 AM,14/Jul/23 2:47 PM,27/Mar/23 10:16 AM,,Support,,0,,,,"When the client uses Ansible to deploy virtual host junctions with JWT, a number of pd* traces are being activated. This is visible both in the LMI and the CLI. 

The JSON in stha9p0j2.iad.ca.inet_pre-reboot.har shows that no traces were active at 13 Mar 2023 03:22:57 GMT. After deployment, stha9p0j2.iad.ca.inet_post-reboot.har shows numerous traces active at 03:26:58 GMT, as does server-task-trace-show_output.txt.

----

pdadmin sec_master@tenantE> server task prod_b2edsso-intactfc-webseald-stha9p0j2 trace show                

pd.ivc.general 9

pd.ivc.file 9

pd.ivc.log 9

pd.ivc.ira 9

pd.idb.general 9

pd.idb.database 9

pd.acl.general 9

pd.acl.acldb 9

pd.acl.client 9

pd.acl.authzn 9

pd.acl.adminsvc 9

pd.acl.remsvc 9

pd.acl.aznapi 9

pd.acl.aznsvc 9

pd.ias.general 9

pd.mgr.general 9

pd.mgr.svrmgmt 9

pd.mgr.objmgmt 9

pd.mgr.ldaprgy 9

pd.mgr.gso 9

pd.mgr.uraf 9

pd.bas.mts 9

pd.bst.general 9

pdweb.bca.general 9

pdweb.bca.user 9

pdweb.bca.group 9

pdweb.bca.policy 9

pdweb.bca.acl 9

pdweb.bca.protobj 9

pdweb.bca.protobjspace 9

pdweb.bca.appsvrcfg 9

pdweb.bca.ssoresource 9

pdweb.bca.ssoresourcegroup 9

pdweb.bca.ssocred 9

pdweb.bca.action 9

pdweb.bca.server 9

pdweb.bca.pop 9

pdweb.bca.domain 9

pdweb.bca.authzrule 9

pdweb.wco.socket 9

pdweb.wco.azn 9

pdweb.wan.general 9

pdweb.wan.server 9

pdweb.wan.http 9

pdweb.wan.ssl 9

pdweb.wan.cache 9

pdweb.wan.ltpa 9

pdweb.wan.fsso 9

pdweb.wan.bool 9

pdweb.wan.spnego 9

pdweb.wan.eai 9

pdweb.wan.azn 9

pdweb.cas.general 9

pdweb.wns.compress 9

pdweb.wns.templates 9

pdweb.wns.authn 9

pdweb.wns.session 9

pdweb.adm.config 9

pdweb.waf 9

pdweb.http2.client 9

pdweb.http2.jct 9


----

I do not see anything in the reverse proxy configuration file, or the policy server audit logs at PS_audit_logs-march12th.csv, to explain the activation of the traces.",,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011920979,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,INTACT CORPORATION FINANCERE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS011920979&path=TS011920979%2F2023-03-15%2F,,,,,,,,,,,,,,,,,,,,,,,0|i19h8v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.1.0,,,,,,,,,,,,,2023-03-16 04:45:17.905,,,,,"16/Mar/23 2:45 PM;5b15d9517dab4c51f61b5190;trace is enabled in the routing file

{noformat}*:*.9:UTF8FILE.10.10000000:/var/pdweb/prod_b2edsso-intactfc/log/trace__b2edsso-intactfc.log:644:ivmgr:ivmgr{noformat}",27/Mar/23 10:16 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Issue setting DHE ciphers in ISVA 10.0.5.0 to work.,ISAMSUP-4818,284853,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,28/Feb/23 4:56 AM,20/Mar/23 11:28 AM,14/Jul/23 2:47 PM,20/Mar/23 11:28 AM,10.0.6,,,0,,,,"Concerns the following DHE ciphers x 2;
TLS_DHE_RSA_WITH_AES_256_GCM_SHA384
TLS_DHE_RSA_WITH_AES_128_GCM_SHA256

Salesforce TS011858407 heading “ _TLS DHE-RSA cipher suites don't work - Webseal_ “

As per customer
”  so far we don't know if it is possible to set these DHE ciphers in ISVA 10.0.5. I have found that in the documentation for previous versions they recommend to [https://www.ibm.com/docs/en/sva/10.0.3?topic=conformance-webseal-configuration|https://www.ibm.com/docs/en/sva/10.0.3?topic=conformance-webseal-configuration|smart-link]  (gsk-attr-name = enum:4009:1) Can it be related ? Why it has been removed from the documentation in the current version? “ 

Seeking L3 help here as [10.0.3|https://www.ibm.com/docs/en/sva/10.0.3?topic=conformance-webseal-configuration] and [10.0.5|https://www.ibm.com/docs/en/sva/10.0.5?topic=conformance-webseal-configuration] documentation are different. 
L2 (i.e. Brian O’R) unable to get same DHE ciphers working.
Client (via IBM Software Project Manager ) also engaged assistance from László Czap, Ph.D. Lead Security Services Specialist in IBM Security Expert Labs i.e. he contributed the following feedback;

“ _I’ve spent some time playing around with the settings and understand the case (and refresh my faded knowledge about ssl/tls handshake). I was able to reproduce what you observed and now I am confident that this is a product defect and DHE-RSA-AES256-GCM-SHA384 does not work at all, while DHE-RSA-AES128-GCM-SHA256 works only with_
{{[ssl]}}
{{gsk-attr-name = enum:4009:1}}

_which is indeed not in 10.0.5 docs._ 

_The confusing part is with tls 1.3 is that openssl client has a separate parameter for v2 ciphers and v3 ciphers. If you specify the v2 cipher only, the v3 cipher list remains the default, so when v3 is enabled and you specify a non-working v2 cipher, it will use a default v3 cipher. That’s why you see the mismatch between the specified cipher and the cipher in use in one of your examples._

_When forcing tls v12 and trying to use either of DHE-RSA-AES256-GCM-SHA384 and DHE-RSA-AES128-GCM-SHA256, we see:_
_without the gsk attribute set, webseal logs an unknown gsk error like this: Function call: gsk_secure_soc_init; failed error: 0xc GSK_ERROR_UNKNOWN_ERROR;_
_with the gsk attribute set, DHE-RSA-AES128-GCM-SHA256 works, while DHE-RSA-AES256-GCM-SHA384 logs a gsk error: Function call: gsk_secure_soc_init; failed error: 0x192 GSK_ERROR_NO_CIPHERS;_
_This should be convincing enough for the support as well._ “

Appreciate L3 assistance with this case / work item.",,Dermot Daly,gvacek,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,6092ac9ff6c0960069d47a67,5c87cb8d88f9ec6ae0afb306,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4844,,,,,,01/Mar/23 11:22 AM;ashashiv;image-20230301-002113.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/187587,07/Mar/23 9:24 PM;ug:0d23f3f4-385c-47fa-b5f8-ecbd0333ad03;image-20230307-112319.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/188652,,,,,,,,,,,,,,IJ45796,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011858407,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,Nordea Bank,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=5, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":5,""lastUpdated"":""2023-03-08T19:12:23.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":5,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS011858407&path=TS011858407%2F2023-01-23%2F,,,,,,,,,Linux 86_64,,,,,,,,,,,,,,0|i18z6j:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-01 01:22:46.249,,,,,"01/Mar/23 11:22 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6154906364ff01007106e189] 

Is your question about who the document was updated/removed enum in 10040/10050? 

If yes - 

The document was removed to add the GSK attribute enum support as a result of this work item - [https://cloudidentity.atlassian.net/browse/ISAMDEV-8289|https://cloudidentity.atlassian.net/browse/ISAMDEV-8289|smart-link]  

If otherwise - 




Was this a working environment previously and it stopped working after upgrade? 

Do you have the gskit trace logs? 

Have you run your tests with these ciphers? 


have you tried the options -

In Advanced tuning parameters - 

Key {{lmi.ssl.ciphers}} 

Value 

TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 TLS_DHE_RSA_WITH_AES_128_CBC_SHA TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 TLS_DHE_RSA_WITH_AES_256_CBC_SHA TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 TLS_RSA_WITH_AES_128_CBC_SHA TLS_RSA_WITH_AES_128_CBC_SHA256 TLS_RSA_WITH_AES_256_CBC_SHA TLS_RSA_WITH_AES_256_CBC_SHA256 *TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 TLS_DHE_RSA_WITH_AES_128_GCM_SHA256*



Changed the TLSv12 options to add TLSv1.1? 

!image-20230301-002113.png|width=1356,height=107!","03/Mar/23 9:07 PM;6154906364ff01007106e189;Hi [~accountid:5af4ad7d4dd24c579110120b] I provided the following information to the customer back on March 1st 

----

_L3 feedback as follows;_ 
_The document reference to add the GSK attribute enum support was removed post 10.0.3 due to unacceptable long startup times for WRP's._
_Hence the amendment in 10.0.4 and 10.0.5 as per_ [https://www.ibm.com/docs/en/sva/10.0.5?topic=conformance-webseal-configuration|https://www.ibm.com/docs/en/sva/10.0.5?topic=conformance-webseal-configuration|smart-link] 
	[_isam.myidp.ibm.com_|http://isam.myidp.ibm.com]_:isam> store_dhe_parameters pdsrv wrp-default 2048_
_And to follow the remaining procedure. L3 are also enquiring asking the following questions;_

# _Was this a working environment previously and it stopped working after upgrade?_ 
# _Do you have the gskit trace logs?_ 
# _Has customer attempted other options i.e._
_3a) have you tried ATP's as per ""How to configure any cipher suite for LMI listen port 443"" as at_ [_https://www.ibm.com/support/pages/node/6373558._|https://www.ibm.com/support/pages/node/6373558.]
_3b) Added, changed TLSv12 ATP options?_ 

----

To which customer replied on March 3rd;
” _we need to know the if L3 was able to make these to cipher working in their lab environment. As so far we haven't receive the answer that these ciphers are working at all in ISVA 10.0.5. If they manage to make it working we need to know if it was enough to just set these ciphers in a config file or additional settings were needed. What settings? Unfortunately, now it looks like trying and guessing_. “ 

I am unable to test, in my own environment, principally because I am very much lost regarding this case scenario. 
I am asking the customer for a Webex, so as to gain a better understanding.

It is very strange why customer is not giving information I am asking for.
","07/Mar/23 11:19 AM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}https://github.ibm.com/ISAM/at-testcases/blob/e336e9259264bfe6f3d0f076863b306d3d488e48/autotest/tests/web/reverse_proxy/ssl/sessions/ssl_session_test.py{noformat}

{noformat} openssl s_client -connect LMI/RP:443  -tls1_2  -cipher DHE-RSA-AES256-GCM-SHA384

 openssl s_client -connect LMI/RP:443  -tls1_2  -cipher DHE-RSA-AES256-SHA256

 openssl s_client -connect LMI/RP:443  -tls1_2  -cipher DHE-RSA-AES128-GCM-SHA256

 openssl s_client -connect LMI/RP:443  -tls1_2  -cipher DHE-RSA-AES128-SHA256
 {noformat}

{noformat}{noformat}","07/Mar/23 11:24 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:6154906364ff01007106e189] 

Here is a fix pack for DHE-RSA-AES256-GCM-SHA384 to work with TLS1.2.


[https://cloudidentity.atlassian.net/browse/ISAMSUP-4844|https://cloudidentity.atlassian.net/browse/ISAMSUP-4844|smart-link]  
DHE-RSA-AES128-GCM-SHA256 already works with webseal. Configuration that you need to check in webseal are - 



{noformat}[ssl]
gsk-attr-name = enum:4009:1 

# Selectively disable SSL version support for browser connections
disable-ssl-v2 = yes
disable-ssl-v3 = yes
disable-tls-v1 = yes
disable-tls-v11 = yes
disable-tls-v12 = no
disable-tls-v13 = yes

[ssl-qop]
ssl-qop-mgmt = yes

[ssl-qop-mgmt-default]

# AES-128
#default = TLS_DHE_RSA_WITH_AES_128_GCM_SHA256
default = TLS_DHE_RSA_WITH_AES_256_GCM_SHA384
default = TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
default = TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
default = TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
default = TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
default = TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
default = TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
default = TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384
default = TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
#default = TLS_AES_128_GCM_SHA256
#default = TLS_AES_256_GCM_SHA384
{noformat}

Note - {{gsk-attr-name = enum:4009:1 }} was removed from documentation since it was causing performance issues with warp containers. So it is not encouraged to use it unless you have to use it.

Tests from my environment:

{noformat}openssl s_client -connect 10.160.101.79:443  

---
SSL handshake has read 1779 bytes and written 607 bytes
Verification error: self signed certificate
---
New, TLSv1.2, Cipher is DHE-RSA-AES256-GCM-SHA384
Server public key is 2048 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
SSL-Session:
    Protocol  : TLSv1.2
    Cipher    : DHE-RSA-AES256-GCM-SHA384
    Session-ID: 71EA4F78B0626F7A99E2E7FF1D0CF6EE7B5E56A25D344D603067CFB2CEE5A74F
    Session-ID-ctx: 
    Master-Key: 093C54C36C5657F74F2062D4967C36ADEE4BA577BCD70BF464E315F8EC0C0562358FE3F83061A0171F44CEA6AAAE00CB
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    Start Time: 1678152098
    Timeout   : 7200 (sec)
    Verify return code: 18 (self signed certificate)
    Extended master secret: yes{noformat}","07/Mar/23 12:47 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 24ab1bc2d80c2702912ba626fcf91069b8ebb20b
   * description: ISAMSUP-4818 DHE GCM 384 ciphers for TLS12 on RP

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86140191.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4818) which we publish.","07/Mar/23 9:24 PM;6154906364ff01007106e189;Thank you [~accountid:5af4ad7d4dd24c579110120b] deployed and tested successfully on my local 10.0.5.0 appliance.

!image-20230307-112319.png|width=798,height=78!

Updating TS011858407 to update same and to provide related fixpack.","08/Mar/23 7:12 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 4ddf6414fc90067922ac355f60510ff11dcbbdc6
   * description: Merge pull request #5727 from ISAM/ISAMSUP-4818

ISAMSUP-4818 DHE GCM 384 ciphers for TLS12 on RP

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86247778.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230308090922-4ddf6414f.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.",10/Mar/23 2:04 PM;5af4ad7d4dd24c579110120b;Could you please log an APAR for this.,10/Mar/23 10:30 PM;6154906364ff01007106e189;APAR created successfully with number: IJ45796,12/Mar/23 6:04 PM;5af4ad7d4dd24c579110120b;So is this Jira ok to be closed? ,"20/Mar/23 11:28 AM;5af4ad7d4dd24c579110120b;Closing this as resolved, if you have any further questions please reopen the item.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Partition Backup Date Timestamp not getting updated,ISAMSUP-4790,281221,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,BRIANORO,6154906364ff01007106e189,BRIANORO,6154906364ff01007106e189,14/Feb/23 6:59 PM,27/Mar/23 1:46 PM,14/Jul/23 2:47 PM,27/Mar/23 1:46 PM,,,05/Feb/23 12:00 AM,0,,,,Client attempted firmware backups on Feb 9th BUT the date and timestamp field are not updated to reflect this. L2 cannot recreate this issue and seeking L3 feedback comment concerning this observation. ,,Dermot Daly,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,17/Feb/23 4:15 AM;ug:0d23f3f4-385c-47fa-b5f8-ecbd0333ad03;image-20230216-181047.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/184474,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012102482,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,BRIANORO,6154906364ff01007106e189,,,,Audi AG,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"Support file
https://ecurep.mainz.de.ibm.com/ae5/#id=TS012102482&path=TS012102482%2F2023-02-09%2Fisva_10.0.4.0_20230209-175545_ivwb2451.app-test.web.audi.vwg.support_unpack%2F 

Data.zip from the get_boot_data.fixpack
https://ecurep.mainz.de.ibm.com/ae5/#id=TS012102482&path=TS012102482%2F2023-02-16%2Fdata.zip_unpack%2F",,,,,,,,,Linux 86_64,,,,,,,,,,,,,,0|i18d6z:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-15 01:08:58.839,,,,,"14/Feb/23 7:08 PM;6154906364ff01007106e189;Seeing no obvious errors in var/log/messages related to the firmware backup task i.e.

{{[4:iei81220@debug71]:/ecurep/sf/TS012/102/TS012102482/2023-02-09/isva_10.0.4.0_20230209-175545_ivwb2451.app-test.web.audi.vwg.support_unpack/var/log $ grep -i ""/etc/rc.shutdown"" messages}}
{{Sep 29 10:39:51 : starting pid 19820, tty '': '/etc/rc.shutdown'}}
{{Nov  4 13:10:37 : starting pid 29907, tty '': '/etc/rc.shutdown'}}
{{Nov  8 13:21:57 : starting pid 24680, tty '': '/etc/rc.shutdown'}}
{{Nov 22 11:13:06 : starting pid 3166, tty '': '/etc/rc.shutdown'}}
{{Feb  9 13:30:53 : starting pid 17056, tty '': '/etc/rc.shutdown'}}
{{Feb  9 14:02:35 : starting pid 10567, tty '': '/etc/rc.shutdown'}}
{{Feb  9 17:39:38 : starting pid 24638, tty '': '/etc/rc.shutdown'}}
{{Feb  9 17:41:42 : starting pid 8444, tty '': '/etc/rc.shutdown'}}
{{[4:iei81220@debug71]:/ecurep/sf/TS012/102/TS012102482/2023-02-09/isva_10.0.4.0_20230209-175545_ivwb2451.app-test.web.audi.vwg.support_unpack/var/log $}}
{{[4:iei81220@debug71]:/ecurep/sf/TS012/102/TS012102482/2023-02-09/isva_10.0.4.0_20230209-175545_ivwb2451.app-test.web.audi.vwg.support_unpack/var/log $ grep -i partition messages}}
{{Nov  4 13:10:31 www-data: GLGBK1001I:: GLG_events:: |partition=3,interface=LMI,user=VT9IS5R|}}
{{Feb  9 13:30:47 www-data: GLGBK1001I:: GLG_events:: |partition=3,interface=LMI,user=admin@local|}}
{{Feb  9 14:02:30 www-data: GLGBK1001I:: GLG_events:: |partition=3,interface=LMI,user=admin@local|}}
{{Feb  9 17:41:37 www-data: GLGBK1001I:: GLG_events:: |partition=3,interface=LMI,user=VT9IS5R|}}
{{[4:iei81220@debug71]:/ecurep/sf/TS012/102/TS012102482/2023-02-09/isva_10.0.4.0_20230209-175545_ivwb2451.app-test.web.audi.vwg.support_unpack/var/log $}}
{{[4:iei81220@debug71]:/ecurep/sf/TS012/102/TS012102482/2023-02-09/isva_10.0.4.0_20230209-175545_ivwb2451.app-test.web.audi.vwg.support_unpack/var/log $ grep -i GLGBK messages}}
{{Nov  4 13:10:31 www-data: GLGBK1001I:: GLG_events:: |partition=3,interface=LMI,user=VT9IS5R|}}
{{Feb  9 13:30:47 www-data: GLGBK1001I:: GLG_events:: |partition=3,interface=LMI,user=admin@local|}}
{{Feb  9 14:02:30 www-data: GLGBK1001I:: GLG_events:: |partition=3,interface=LMI,user=admin@local|}}
{{Feb  9 17:41:37 www-data: GLGBK1001I:: GLG_events:: |partition=3,interface=LMI,user=VT9IS5R|}}
{{[4:iei81220@debug71]:/ecurep/sf/TS012/102/TS012102482/2023-02-09/isva_10.0.4.0_20230209-175545_ivwb2451.app-test.web.audi.vwg.support_unpack/var/log $}}



{{ivwb2451.app-test.web.audi.vwg:firmware> list}}

{{1: isva_10.0.4.0_20220607-2337}}

{{Firmware Version: IBM Security Verify Access 10.0.4.0}}

{{Installation Date: Jul 20, 2022 02:03:32 PM}}

{{Installation Type: Backup}}

{{Backup Date: Nov 4, 2022 01:22:46 PM}}

{{Last Boot: Sep 29, 2022 04:40:25 PM}}

{{Comment:}}

{{2: isva_10.0.4.0_20220607-2337 [ACTIVE]}}

{{Firmware Version: IBM Security Verify Access 10.0.4.0}}

{{Installation Date: Jul 20, 2022 02:03:32 PM}}

{{Installation Type: XPU}}

{{Last Boot: Feb 9, 2023 05:52:52 PM}}

{{Comment:}}","15/Feb/23 11:08 AM;5b15d954b0d76456f36daf33;The {{Backup Date}} information is read from a file that exists in the boot partition. A normal support file does not collect it.

But there is a fixpack called {{get_boot_info}} in [https://cloudidentity.atlassian.net/browse/ISAMSUP-1183|https://cloudidentity.atlassian.net/browse/ISAMSUP-1183|smart-link] . After applying it, you should be able to download a file from the LMI:

Monitor → Application Log Files → verify_access_runtime → data.zip

Have them give us that file and we’ll see what is going on.","16/Feb/23 9:52 PM;6154906364ff01007106e189;Hi [~accountid:5b15d954b0d76456f36daf33] customer has uploaded a “ [data.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012102482&path=TS012102482%2F2023-02-16%2Fdata.zip_unpack%2F] “ from the get_boot_data.fixpack. I am not familiar reading the contents of [data.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012102482&path=TS012102482%2F2023-02-16%2Fdata.zip_unpack%2F]. Seeing  the “info 1” file contents with a {{backup_date = 1667564566}} which is equivalent to {{Friday, November 4, 2022 12:22:46 PM}} as per the firmware list command. Appreciate any feedback, comment you can provide re this.","17/Feb/23 4:15 AM;6154906364ff01007106e189;As per [case viewer|https://w3.ibm.com/tools/caseviewer/case/TS012176808] OR [CSP Case|https://ibmsf.lightning.force.com/lightning/r/Case/5003p00002mUXWdAAO/view], customer updates at 6PM GMT on Feb 16th.
” _Just make sure you get all information we tried also ""firmware backup on CLI""._
_We have got an error during operation and server got in unresponsive mode / state._
_After VM reset the appliance started in ""unconfigured state"". Which is not good ..._
_We had to restore VM from VCenter snapshot in order to get it again in running state._
_After this VM is working again._
_Unfortunately I do see that this Appliance is not capable to do any ISVA upgrade._
_We attached some pictures from VCenter console and also from CLI  and a support file after the VM restore / restart. “_

!image-20230216-181047.png|width=857,height=133!

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012102482&path=TS012102482%2F2023-02-16%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012102482&path=TS012102482%2F2023-02-16%2F]","17/Feb/23 6:39 PM;5b15d954b0d76456f36daf33;[~accountid:6154906364ff01007106e189] was there a support file taken after the backup failed and before they restored it from VM backup?

Otherwise we may not be able to determine why that occurred.

There isn’t a whole lot to go on for the original backup operation not updating the Backup Date. The contents of the data.zip file indicate boot partition and the files are intact.

Unfortunately the actual logging for backup happens during reboot, so won’t be in system log or any others. If there is a console attached, it might be visible there. That is usually easier for hardware appliances than VMs.

I’ll see what else we can do.","17/Feb/23 6:54 PM;6154906364ff01007106e189;Ok, thanks [~accountid:5b15d954b0d76456f36daf33] I will ask customer further questions as well.","21/Feb/23 2:54 AM;6154906364ff01007106e189;Hi [~accountid:5b15d954b0d76456f36daf33] gave customer feedback & comment wrt ISVA unconfigured state, backup and upgrade process. Customer has replied with the following;

"" _We don't need to focus for ""unconfigured state"" situation. We also understand what is the supported backup process. In past multiple times faced we the issue that during upgrade the process failed because the ""inactive "" partition was damaged / failed from some reason. Then appliance got in unresponsive state (no boot was available). Tat is why we always do partition backup before we start any upgrade.  In other word: if we right now start upgrade  on this appliance it will failed (I'm pretty sure on it)._
_And this is why we raised this case. If we can understand why partition backup failed even more somehow fix it. Then we can ensure that upgrade will go without any issue._ ""

Any thoughts wrt next steps to go back to customer, much appreciated. 
Is there a health check that can be done on the inactive partition?
Do I ask customer to retry firmware backup process again with extra debug logging?","23/Feb/23 4:17 PM;5b15d954b0d76456f36daf33;They have made a number of assertions which can’t really be explained. Let me address what I can:

>> _In past multiple times faced we the issue that during upgrade the process failed because the ""inactive "" partition was damaged / failed from some reason_

The reason upgrades fail that we have been able to identify in the past are down to:

    - boot partition missing expected entries 

    - the inactive partition already being mounted before upgrade

    - large number of logs or files that need to be copied over to the inactive partition.

Unless this is a hardware appliance, the chances of disk or a partition on the disk failures are rare.

>> _Tat is why we always do partition backup before we start any upgrade._

One doesn’t need the other. Both operations erase, reformat the inactive partition and copy information from the active partition. Success or failure of one is not an indicator of the other operation.

>> _In other word: if we right now start upgrade  on this appliance it will failed (I'm pretty sure on it)._

Having looked at their support file, I can’t find anything to suggest an upgrade would fail. Especially with reference to the 3 common causes of failure I mentioned before.

>> _If we can understand why partition backup failed even more somehow fix it._ 

Like I mentioned, any logging pertinent to this would possibly be seen on a console attached to the appliance. Which makes it difficult to troubleshoot.

>> _Then we can ensure that upgrade will go without any issue._

Again, even if backup operation succeeds, it doesn’t guarantee an upgrade will behave the same way.

What is their ultimate goal? If it is to upgrade the appliance, we should work on priming the appliance to ensure that succeeds. If they want to have a quick call to discuss options, I’m happy to attend one.","24/Feb/23 12:39 AM;6154906364ff01007106e189;Hi [~accountid:5b15d954b0d76456f36daf33] thank you for your feedback below, I will pass this onto the customer. Wish to ask you about “_If it is to upgrade the appliance, we should work on priming the appliance to ensure that succeeds_” can you advise, expand on this please? i.e. how to plan, prime in advance for the following

1. boot partition missing expected entries? A1 = ? In this case TS012102482 we can tell its good, yes?

2. the inactive partition already being mounted before upgrade? A2 = Shutdown fully and restart appliance before attempted upgrade?

3. large number of logs or files that need to be copied over to the inactive partition? A3 = backup and/or remove logs prior to upgrade?

4. anything else?","24/Feb/23 10:24 AM;5b15d954b0d76456f36daf33;[~accountid:6154906364ff01007106e189] 

_>> boot partition missing expected entries? A1 = ? In this case TS012102482 we can tell its good, yes?_

Yes. From the support file iswga/ls.txt

{noformat}/boot:
drwxr-xr-x    2 root     root          1024 Jul 20  2022 Part1
drwxr-xr-x    2 root     root          1024 Jul 20  2022 Part2
lrwxrwxrwx    1 root     root            11 Jul 20  2022 grub -> /boot/grub2
drwx------    4 root     root          1024 Feb 16 18:22 grub2{noformat}

We should see both {{grub}}and {{grub2}} here (whether as solid directories or links like above). Some of the upgrade scripts rely on it being {{grub}} and could fail if they encounter only {{grub2}}



_>> the inactive partition already being mounted before upgrade? A2 = Shutdown fully and restart appliance before attempted upgrade?_

If necessary. From support file iswga/disk.txt

{noformat}Filesystem                Size      Used Available Use% Mounted on
/dev/sda6                47.9G     15.0G     30.4G  33% /
proc                         0         0         0   0% /proc
sysfs                        0         0         0   0% /sys
mdev                     31.4G      4.0K     31.4G   0% /dev
devpts                       0         0         0   0% /dev/pts
tmpfs                    31.4G    160.0K     31.4G   0% /dev/shm
tmpfs                    31.4G    160.0K     31.4G   0% /var/run
/dev/sda1               193.5M    147.7M     31.6M  82% /boot{noformat}

Before attempting the upgrade, you should only see one of {{/dev/sda5}} or {{/dev/sda6}} listed here. If you see both, then the inactive partition is mounted and will likely cause the upgrade to fail at the erase step.



_>> large number of logs or files that need to be copied over to the inactive partition? A3 = backup and/or remove logs prior to upgrade?_

Yes. You can use these cli options to remove any rolled over log files:

{noformat}appl1> isam logs delete/delete_trace{noformat}

Additionally you can clean up the support dir and system temporary files using:

{noformat}appl1> support purge{noformat}

Let me know if any of that is not clear.",27/Mar/23 1:46 PM;5b15d954b0d76456f36daf33;Case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Is there an advanced tuning parameter to specify multiple Oracle servers in JNDI configuration?,ISAMSUP-4767,279240,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,03/Feb/23 5:54 AM,07/Feb/23 12:10 PM,14/Jul/23 2:47 PM,07/Feb/23 12:10 PM,,Support,,0,,,,"AT&T is wanting to specify multiple Oracle databases for a JNDI Server Connection, similar to how it can be done using advanced tuuning parameters for the HVDB. Is this possible?",,BRIANORO,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,6154906364ff01007106e189,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012030306,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,A T & T SERVICES INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18137:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.2,,,,,,,,,,,,,2023-02-03 03:49:40.688,,,,,"03/Feb/23 1:49 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bac25a37de8532e315430c5] 

Which advanced tuning parameter is the customer using to configure - HVDB with multiple servers?
For JNDI Server connection - Are they looking at supplying more than one IP address in JNDI ServerName in connection properties? 


|JNDI ID:| |
|Server name:| |
|Port:| |",04/Feb/23 3:43 AM;5bac25a37de8532e315430c5;[~accountid:5af4ad7d4dd24c579110120b] They are using the parameters described at [https://www.ibm.com/docs/en/sva/10.0.5?topic=database-oracle-runtime-advanced-connection-methods|https://www.ibm.com/docs/en/sva/10.0.5?topic=database-oracle-runtime-advanced-connection-methods|smart-link]  . But that only applies to the HVDB - is there an equivalent for the JNDI configuration?,"05/Feb/23 6:14 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bac25a37de8532e315430c5] 

No there is no equivalent for JNDI configuration. 
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
JWKS uri failing with key not found,ISAMSUP-4751,278364,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,28/Jan/23 12:41 AM,31/May/23 12:25 AM,14/Jul/23 2:47 PM,31/May/23 12:25 AM,,Support,,0,,,,"The client is attempting to specify a JWKS URI for their OpenID definition. After having the x5c element added to the JKWS, and importing the signer certificate,  fetchJwks is still returning an error.

{noformat}[1/25/23, 9:49:31:219 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 > handleResponse ENTRY
[1/25/23, 9:49:31:219 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 3 handleResponse Getting response code.
[1/25/23, 9:49:31:266 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 3 handleResponse Response code is: 200
[1/25/23, 9:49:31:267 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 < handleResponse RETURN
[1/25/23, 9:49:31:267 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 > disconnect ENTRY
[1/25/23, 9:49:31:267 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       > release ENTRY
[1/25/23, 9:49:31:267 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       3 release Releasing Connection of URL -->sun.net.www.proto
col.https.DelegateHttpsURLConnection:https://storage.googleapis.com/mark-cuban-jwks-bucket/jwks.json
[1/25/23, 9:49:31:267 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       > getMaxCountSemaphore ENTRY
[1/25/23, 9:49:31:267 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       3 getMaxCountSemaphore Get Semaphore for Host and Port-->s
torage.googleapis.com:443: Count-->0
[1/25/23, 9:49:31:267 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       < release RETURN
[1/25/23, 9:49:31:267 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 < disconnect RETURN
[1/25/23, 9:49:31:267 CST] 0013c334 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 < doRequest RETURN
[1/25/23, 9:49:31:268 CST] 0013c334 id=00000000 com.tivoli.am.fim.trustserver.sts.modules.jwt.JwksCache      I fetchJwks org.jose4j.lang.JoseException: The JSON JWKS content does not include the keys member.{noformat}

I was unable to find this error in another case, in a Jira, or in a web search. What needs to be done to identify the issue?

As support file is available on Blue Diamond at H:\sf\TS011\879\TS011879729\2023-01-26 or /standard/sf/TS011/879/TS011879729/2023-01-26 . The JWKS URI is [https://storage.googleapis.com/mark-cuban-jwks-bucket/jwks.json|https://storage.googleapis.com/mark-cuban-jwks-bucket/jwks.json] .",,cholt@us.ibm.com,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,5b15d994dda5f94d06b985b2,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4801,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011879729,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,PRIME THERAPEUTICS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17vsf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-01-30 23:26:59.312,,,,,"31/Jan/23 9:26 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bac25a37de8532e315430c5] 

There was an issue in 10031 and 10040 about the kid name issue. I have a fixpack here for 10031.

This may or may not be the fix but worth a try in their environment.

fixpack: [https://ibm.box.com/s/e2fscqv8q41j9vr073cpjpkx4qst0it7|https://ibm.box.com/s/e2fscqv8q41j9vr073cpjpkx4qst0it7|smart-link] 

checksum: [https://ibm.box.com/s/yi078ldy1ce6xouv0zfycn1d97sxyzza|https://ibm.box.com/s/yi078ldy1ce6xouv0zfycn1d97sxyzza|smart-link] 

See if this makes any difference to the behavior.

 ","01/Feb/23 12:35 AM;5bac25a37de8532e315430c5;The case contact is OOTO until February 6, so I don’t know if it will be tested before then.","18/Feb/23 3:41 AM;5bac25a37de8532e315430c5;[~accountid:5af4ad7d4dd24c579110120b] The federation runtime is still returning the error, after spplying the fixpack. The latest support files are onm Blue Diamond, at H:\sf\TS011\879\TS011879729\2023-02-17 .

The client would also like to know what, specifically, in the JWKS we use to determine the key to use.","20/Feb/23 10:59 AM;5af4ad7d4dd24c579110120b;{noformat}MyNotes:

[2/17/23, 8:12:20:142 CST] 00011974 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 < handleResponse RETURN
[2/17/23, 8:12:20:142 CST] 00011974 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 > disconnect ENTRY
[2/17/23, 8:12:20:142 CST] 00011974 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       > release ENTRY
[2/17/23, 8:12:20:142 CST] 00011974 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       3 release Releasing Connection of URL -->sun.net.www.protocol.https.DelegateHttpsURLConnection:https://storage.googleapis.com/mark-cuban-jwks-bucket/jwks.json
[2/17/23, 8:12:20:142 CST] 00011974 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       > getMaxCountSemaphore ENTRY
[2/17/23, 8:12:20:142 CST] 00011974 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       3 getMaxCountSemaphore Get Semaphore for Host and Port-->storage.googleapis.com:443: Count-->0
[2/17/23, 8:12:20:142 CST] 00011974 id=00000000 com.tivoli.am.fim.soap.client.HttpClientConnectionPool       < release RETURN
[2/17/23, 8:12:20:142 CST] 00011974 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 < disconnect RETURN
[2/17/23, 8:12:20:142 CST] 00011974 id=00000000 com.tivoli.am.fim.soap.client.HttpClientImpl                 < doRequest RETURN
[2/17/23, 8:12:20:143 CST] 00011a48 id=00000000 tivoli.am.fim.trustserver.sts.utilities.OAuthMappingExtUtils < throwSTSUserMessageException RETURN
[2/17/23, 8:12:20:143 CST] 00011974 id=00000000 com.tivoli.am.fim.trustserver.sts.modules.jwt.JwksCache      I fetchJwks org.jose4j.lang.JoseException: The JSON JWKS content does not include the keys member.
	at org.jose4j.jwk.JsonWebKeySet.<init>(JsonWebKeySet.java:43)
	at com.tivoli.am.fim.trustserver.sts.modules.jwt.JwksCache.fetchJwks(JwksCache.java:125)
	at com.tivoli.am.fim.trustserver.sts.modules.jwt.JwksCache.get(JwksCache.java:71)
	at com.tivoli.am.fim.trustserver.sts.modules.jwt.Jwt.getJwk(Jwt.java:364)
	at com.tivoli.am.fim.trustserver.sts.modules.jwt.Jwt.fetchPublicKey(Jwt.java:349)
	at com.tivoli.am.fim.trustserver.sts.modules.jwt.AsymmetricSigningJwt.validateOrDecryptJwt(AsymmetricSigningJwt.java:83)
	at com.tivoli.am.fim.trustserver.sts.modules.jwt.Jwt.fromJwtString(Jwt.java:262)
	at com.tivoli.am.fim.trustserver.sts.modules.JwtSTSModule.validate(JwtSTSModule.java:541)
	at com.tivoli.am.fim.trustserver.sts.modules.JwtSTSModule.invoke(JwtSTSModule.java:130)
	at com.tivoli.am.fim.trustserver.sts.STSModuleChain.invoke(STSModuleChain.java:319)
	at com.tivoli.am.fim.trustserver.sts.STSModuleChainManager.executeChain(STSModuleChainManager.java:1149)
	at com.tivoli.am.fim.trustserver.sts.STSModuleChainManager.processthroughChains(STSModuleChainManager.java:170)
	at com.tivoli.am.fim.trustserver.sts.STSModuleChainManager.process(STSModuleChainManager.java:117)
	at com.tivoli.am.fim.trustserver.sts.STSManager.process(STSManager.java:60)
	at com.tivoli.am.fim.trustserver.service.SecurityTokenProcessor.process(SecurityTokenProcessor.java:63)
	at com.tivoli.am.fim.trustserver.service.SecurityTokenService.requestSecurityToken(SecurityTokenService.java:136)
	at com.tivoli.am.fim.fedmgr2.trust.TokenExchangeCommandImpl.exchange(TokenExchangeCommandImpl.java:163)
	at com.tivoli.am.fim.fedmgr2.trust.util.LocalSTSClient.doRequestInternal(LocalSTSClient.java:130)
	at com.tivoli.am.fim.fedmgr2.trust.util.LocalSTSClient.doRequest(LocalSTSClient.java:94)
	at jdk.internal.reflect.GeneratedMethodAccessor149.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
	at java.base/java.lang.reflect.Method.invoke(Unknown Source)
	at org.mozilla.javascript.MemberBox.invoke(MemberBox.java:126)
	at org.mozilla.javascript.NativeJavaMethod.call(NativeJavaMethod.java:225)
	at org.mozilla.javascript.optimizer.OptRuntime.callN(OptRuntime.java:52)
	at org.mozilla.javascript.gen.assertionGrantValidationTools_335._c_stsValidateJWT_4(assertionGrantValidationTools:98)
	at org.mozilla.javascript.gen.assertionGrantValidationTools_335.call(assertionGrantValidationTools)
	at org.mozilla.javascript.optimizer.OptRuntime.callName(OptRuntime.java:63)
	at org.mozilla.javascript.gen.assertionGrantValidationTools_335._c_validateAssertionGrant_10(assertionGrantValidationTools:186)
	at org.mozilla.javascript.gen.assertionGrantValidationTools_335.call(assertionGrantValidationTools)
	at org.mozilla.javascript.optimizer.OptRuntime.callName(OptRuntime.java:63)
	at org.mozilla.javascript.gen.DigitalAPIPreTokenGeneration_334._c_script_0(DigitalAPIPreTokenGeneration:606)
	at org.mozilla.javascript.gen.DigitalAPIPreTokenGeneration_334.call(DigitalAPIPreTokenGeneration)
	at org.mozilla.javascript.ContextFactory.doTopCall(ContextFactory.java:405)
	at org.mozilla.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:3508)
	at org.mozilla.javascript.gen.DigitalAPIPreTokenGeneration_334.call(DigitalAPIPreTokenGeneration)
	at org.mozilla.javascript.gen.DigitalAPIPreTokenGeneration_334.exec(DigitalAPIPreTokenGeneration)
	at com.ibm.security.access.javascript.JSCode.execute(JSCode.java:123)
	at com.tivoli.am.fim.trustserver.sts.modules.STSMapDefault$JavaScriptRule.execute(STSMapDefault.java:289)
	at com.tivoli.am.fim.trustserver.sts.modules.STSMapDefault.executeMappingRules(STSMapDefault.java:239)
	at com.tivoli.am.fim.trustserver.sts.modules.OAuth20MappingRuleSTSModule.doMap(OAuth20MappingRuleSTSModule.java:317)
	at com.tivoli.am.fim.trustserver.sts.modules.STSMapDefault.invoke(STSMapDefault.java:73)
	at com.tivoli.am.fim.trustserver.sts.STSModuleChain.invoke(STSModuleChain.java:319)
	at com.tivoli.am.fim.trustserver.sts.STSModuleChainManager.executeChain(STSModuleChainManager.java:1149)
	at com.tivoli.am.fim.trustserver.sts.STSModuleChainManager.processthroughChains(STSModuleChainManager.java:170)
	at com.tivoli.am.fim.trustserver.sts.STSModuleChainManager.process(STSModuleChainManager.java:117)
	at com.tivoli.am.fim.trustserver.sts.STSManager.process(STSManager.java:60)
	at com.tivoli.am.fim.trustserver.service.SecurityTokenProcessor.process(SecurityTokenProcessor.java:63)
	at com.tivoli.am.fim.trustserver.service.SecurityTokenService.requestSecurityToken(SecurityTokenService.java:136)
	at com.tivoli.am.fim.fedmgr2.trust.TokenExchangeCommandImpl.exchange(TokenExchangeCommandImpl.java:163)
	at com.tivoli.am.fim.oauth20.protocol.delegates.OAuth20BaseDelegate.exchangeToken(OAuth20BaseDelegate.java:667)
	at com.tivoli.am.fim.oauth20.protocol.delegates.OAuth20BaseDelegate.exchangeToken(OAuth20BaseDelegate.java:603)
	at com.tivoli.{noformat}

{noformat}	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: com.tivoli.am.fim.trustserver.sts.modules.jwt.InvalidJwtException: org.jose4j.lang.InvalidKeyException: The given key (key is null) is not valid for SHA256withRSA
	at com.tivoli.am.fim.trustserver.sts.modules.jwt.AsymmetricSigningJwt.validateOrDecryptJwt(AsymmetricSigningJwt.java:110)
	at com.tivoli.am.fim.trustserver.sts.modules.jwt.Jwt.fromJwtString(Jwt.java:262)
	at com.tivoli.am.fim.trustserver.sts.modules.JwtSTSModule.validate(JwtSTSModule.java:541)
	... 87 more
Caused by: org.jose4j.lang.InvalidKeyException: The given key (key is null) is not valid for SHA256withRSA
	at org.jose4j.jws.BaseSignatureAlgorithm.initForVerify(BaseSignatureAlgorithm.java:123)
	at org.jose4j.jws.BaseSignatureAlgorithm.verifySignature(BaseSignatureAlgorithm.java:57)
	at org.jose4j.jws.JsonWebSignature.verifySignature(JsonWebSignature.java:245)
	at com.tivoli.am.fim.trustserver.sts.modules.jwt.AsymmetricSigningJwt.validateOrDecryptJwt(AsymmetricSigningJwt.java:90)
	... 89 more
Caused by: java.security.InvalidKeyException: Key must not be null
	at java.base/sun.security.rsa.RSAKeyFactory.toRSAKey(Unknown Source)
	at java.base/sun.security.rsa.RSASignature.engineInitVerify(Unknown Source)
	at java.base/java.security.Signature$Delegate.tryOperation(Unknown Source)
	at java.base/java.security.Signature$Delegate.chooseProvider(Unknown Source)
	at java.base/java.security.Signature$Delegate.engineInitVerify(Unknown Source)
	at java.base/java.security.Signature.initVerify(Unknown Source)
	at org.jose4j.jws.BaseSignatureAlgorithm.initForVerify(BaseSignatureAlgorithm.java:119)
	... 92 more{noformat}","20/Feb/23 2:10 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bac25a37de8532e315430c5] 

The exception that I see in trace_23.02.17_08.12.26.0.log -

{{[2/17/23, 8:12:20:145 CST] 00011a46 id=00000000 com.tivoli.am.fim.trustserver.sts.modules.jwt.JwksCache      I fetchJwks org.jose4j.lang.JoseException: The JSON JWKS content does not include the keys member. }}

{{is from the JsonWebKeySet exception where the KEYS was missing from the jws.}}

[https://github.com/RbkGh/Jose4j/blob/master/src/main/java/org/jose4j/jwk/JsonWebKeySet.java|https://github.com/RbkGh/Jose4j/blob/master/src/main/java/org/jose4j/jwk/JsonWebKeySet.java|smart-link]  

I have crated a fixpack to add more debug and trace the requests and responses in fetch and find the key.

Fixpack link - [https://cloudidentity.atlassian.net/browse/ISAMSUP-4801|https://cloudidentity.atlassian.net/browse/ISAMSUP-4801|smart-link] 

I reckon the issue is the response format where a keys set is sent and then from that set it finds the key with kid name match. May be - [https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-key-set-properties|https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-key-set-properties|smart-link]  

 JsonWebKeySet jwkSet = JsonWebKeySet(jwks) from the response and then finds the key from the set using kidname - jwkSet.findJsonWebKey(kid, null, null, null); 

So after you install this fixpack , recreate the issue and generate  support file you should see entries with Debug000 in the aac trace file that should help us narrow down the source of the problem.





Thanks
","02/May/23 5:16 PM;5af4ad7d4dd24c579110120b;[~accountid:5bac25a37de8532e315430c5] 

Any updates on this",06/May/23 4:51 AM;5bac25a37de8532e315430c5;[~accountid:5af4ad7d4dd24c579110120b]  Still waiting on data from the client.,"31/May/23 12:25 AM;5b15d901fa615349cb01778b;customer stopped responding , closing the case and jira",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Why are Access Key and Secret Key required when configuring IBM Security Verify Access Extension for Amazon CloudWatch Agent?,ISAMSUP-4714,276098,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 3,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,16/Jan/23 6:16 PM,03/Feb/23 10:37 AM,14/Jul/23 2:47 PM,03/Feb/23 10:16 AM,,,,0,,,,"My customer is configuring IBM Security Verify Access Extension for Amazon Cloud Watch Agent.

As you can see in the following screen capture:
  [https://ecurep.mainz.de.ibm.com/rest/download/TS011814887/2023-01-12/screenshot1.PNG?fileSize=34685&clientId=ae5|https://ecurep.mainz.de.ibm.com/rest/download/TS011814887/2023-01-12/screenshot1.PNG?fileSize=34685&clientId=ae5]

Access Key and Secret Key are required field.

According to the following page:
  [https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/create-iam-roles-for-cloudwatch-agent-commandline.html|https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/create-iam-roles-for-cloudwatch-agent-commandline.html|smart-link] 
there are two way to prepare for Cloud Watch.
1 . IAM role necessary to run the CloudWatch agent on EC2 instances
2 . IAM user necessary for the CloudWatch agent to run on on-premises servers

The customer’s isva is on EC2. So, it seems you do not need to create IAM user which is related to Access Key and Secret Key (if I understand correctly), but at least they are required field in configuration.

Is IAM User (for access and secret keys) required to use IBM Security Verify Access Extension for Amazon CloudWatch agent like using the agent on on-premises servers?
If so, and if possible, could you please let me know the reason briefly why we need to specify access key and secret key?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24/Jan/23 8:39 PM;ashashiv;image-20230124-103915.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/179920,01/Feb/23 8:55 PM;ashashiv;image-20230201-105049.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181296,01/Feb/23 8:55 PM;ashashiv;image-20230201-105340.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181297,01/Feb/23 8:55 PM;ashashiv;image-20230201-105425.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181298,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011814887,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,TOTO INFOM LTD.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17nan:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,3,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-01-17 01:36:29.936,,,,,"17/Jan/23 11:36 AM;5af4ad7d4dd24c579110120b;[notes]

[https://github.ibm.com/ISAM/isam-extensions/blob/master/amazonCloudWatchAgent|https://github.ibm.com/ISAM/isam-extensions/blob/master/amazonCloudWatchAgent]
Reference: 

{{    cat >> ${auxiliary_files}/aws/credentials <<EOF[AmazonCloudWatchAgent]aws_access_key_id = $2aws_secret_access_key = $3EOF}}

{{start_agent}}
","17/Jan/23 11:36 AM;5af4ad7d4dd24c579110120b;

Hi [~accountid:5b15d9ec6d76184b7d989c83] 

This is a common configuration screen with no knowledge of whether its an EC2 or on premise instance.

I was able to configure by providing just *_unknown_* for Accesskey and SecretKey.
Extension installation was successful however at this point in time I cant test the end end cloud watch log export. So I am assuming it should let you configure with this if the EC2 instance doesn't need an IAM User.

Are we able to confirm from customer env if using unknown in Accesskey and secretkey for ec2 instance? 

Thanks","23/Jan/23 2:33 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

It seems that I misunderstand what is required by the extension.
Even though CloudWatch itself allows IAM Role and IAM USER:
  [https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/create-iam-roles-for-cloudwatch-agent-commandline.html|https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/create-iam-roles-for-cloudwatch-agent-commandline.html|smart-link] 

Following guides by IBM does not mention about IAM User:
  [https://exchange.xforce.ibmcloud.com/hub/extension/7e7da8c3ba8a8d05ab7ffe8baf84ce79|https://exchange.xforce.ibmcloud.com/hub/extension/7e7da8c3ba8a8d05ab7ffe8baf84ce79]
  [https://www.ibm.com/docs/en/sva/10.0.5?topic=activities-configuring-amazon-cloudwatch-support|https://www.ibm.com/docs/en/sva/10.0.5?topic=activities-configuring-amazon-cloudwatch-support]

My confusion was that “IAM User” is required to generate access key and secret key.
But it seems that somehow we can retrieve it from metadata of IAM Role.

Sorry for this confusion.
Do you think my understanding is correct?
Is it possible for you to provide the way how to retrieve access key and secret key of IAM Role?
The customer is wondering if they actually can use IAM User for the extension.

Any comments are really appreciated.
Best regards,
Yutaka","24/Jan/23 9:35 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9ec6d76184b7d989c83] 

Is it possible for you to provide the way how to retrieve access key and secret key of IAM Role?
On my instance I have limited/restricted access and the link takes me to this doc:

[https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html?icmpid=docs_iam_console#Using_CreateAccessKey|https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html?icmpid=docs_iam_console#Using_CreateAccessKey|smart-link] 



* This probably is a question for AWS support but I just googled and I see these links:
[https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html|https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html|smart-link] 
[https://stackoverflow.com/questions/48274044/how-to-generate-access-key-secret-key-for-aws-roles|https://stackoverflow.com/questions/48274044/how-to-generate-access-key-secret-key-for-aws-roles|smart-link] 

* The customer is wondering if they actually can use IAM User for the extension.
I do not see an option to use IAM user in this extension. You can only supply the access key and secret. 
 
","24/Jan/23 5:02 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,

I found the following document: 
  [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html|https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html|smart-link] 

In the above document, there’s an example curl command to retrieve access key id and secret access key.
Could you please try that?","24/Jan/23 8:39 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9ec6d76184b7d989c83] 

I don't get any response when I try the api from that link.


I found the place where you can create an access key.

AWS console-->IAM-->Users-->Security Credentials-->Create Access Key 

!image-20230124-103915.png|width=1734,height=891!","25/Jan/23 10:16 AM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,
Thank you very much for trying.


{quote}I found the place where you can create an access key.
AWS console-->IAM-->Users-->Security Credentials-->Create Access Key{quote}

That menu is the one which made me confusing.
Does it correspond to a specific IAM User?

According to the following document: [https://www.ibm.com/docs/en/sva/10.0.5?topic=activities-configuring-amazon-cloudwatch-support|https://www.ibm.com/docs/en/sva/10.0.5?topic=activities-configuring-amazon-cloudwatch-support|smart-link] 

{quote}The Access Key and Access Secret associated with this *IAM role* must be updated in the aws/credentials file in the Auxiliary Configuration Files.{quote}

It seems that key and secret seem to belong to IAM Role.

Are there any document for testing the extension which describes how to retrieve key and secret?
Or, can we contact to the developer of the extension to ask if ‘IAM role’ in above sentence is correct? ","25/Jan/23 12:25 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b17572378cd734fe39f2e1a] 

[https://www.ibm.com/docs/en/sva/10.0.5?topic=activities-configuring-amazon-cloudwatch-support|https://www.ibm.com/docs/en/sva/10.0.5?topic=activities-configuring-amazon-cloudwatch-support|smart-link]  document states this - 

The Access Key and Access Secret associated with this {color:#ff5630}IAM role {color}must be updated in the aws/credentials file in the [Auxiliary Configuration Files|https://www.ibm.com/docs/en/SSPREK_10.0.5/com.ibm.isva.doc/admin/task/tsk_aux_config_files.html].

But looks like the access key and access secret are associated with the IAM user in that IAM role. Is that ok to update the doc to reflect this - 

The Access Key and Access Secret associated with this {color:#ff5630}IAM user{color} {color:#ff5630}with{color} {color:#ff5630}IAM role {color}must be updated in the aws/credentials file in the [Auxiliary Configuration Files|https://www.ibm.com/docs/en/SSPREK_10.0.5/com.ibm.isva.doc/admin/task/tsk_aux_config_files.html].

Thanks",30/Jan/23 10:01 AM;5af4ad7d4dd24c579110120b;Created a doc update PR:[https://github.ibm.com/isva-idd/SSPREK_10.0.x/pull/173|https://github.ibm.com/isva-idd/SSPREK_10.0.x/pull/173],"30/Jan/23 5:35 PM;5b15d9ec6d76184b7d989c83;[~accountid:5af4ad7d4dd24c579110120b], 
Since I’m not so familiar with AWS, I have some questions to confirm. 

So, it seems that IAM User is needed be created to generate access key and secret key.
Is my understanding correct?
If so, the customer has another question. Can we remove the IAM User after generating and initializing the extension?
Or, are these keys used while the extension is being used?
","31/Jan/23 9:11 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9ec6d76184b7d989c83] 

I am not an AWS expert I can only say by what I see on the environment I have access to - 

So, it seems that IAM User is needed be created to generate access key and secret key.
Is my understanding correct? - 
-- Yes in my environment a user has the option to create access key and secret I am not sure if there are other ways to create one.

Can we remove the IAM User after generating and initializing the extension?
Or, are these keys used while the extension is being used?

– I think the keys are still used for them to talk to in order to send the logs, I don't think they can be deleted.","01/Feb/23 2:46 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5af4ad7d4dd24c579110120b] ,
Thank you very much for the update.

I shared the answer with the customer, and he has additional question.

Now, we understand that we need IAM User to generate access key and secret key.
The customer would like to know if he needs to grant IAM Role to their instance.
According to the following guide, it seems as if we can associate ‘role’ to our instance.

[https://www.ibm.com/docs/en/sva/10.0.5?topic=activities-configuring-amazon-cloudwatch-support|https://www.ibm.com/docs/en/sva/10.0.5?topic=activities-configuring-amazon-cloudwatch-support]

{quote}*If you already have an AWS Identity and Access Management role that is associated with your instance*, ensure that it has permissions to perform the Amazon CloudWatch PutMetricData operation. {quote}


And following statement seems to be not clear, since it does not mention what component(?) we need to associate the role to.

{quote}Otherwise, you must create a new IAM role with permissions to perform CloudWatch operations and *associate that role before you install the extension.* Additional information on the access requirements for CloudWatch can be found at Identity and Access Management for Amazon CloudWatch.{quote}



According to the following guide:
[https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/create-iam-roles-for-cloudwatch-agent-commandline.html|https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/create-iam-roles-for-cloudwatch-agent-commandline.html]
Please check the steps in : To create the IAM user necessary for the CloudWatch agent to run on on-premises servers
It does not mention about IAM Role.

The customer would like to know 
Q1: do they need to associate IAM Role to their instance?
Q2: don’t they need to use IAM Role?

If something is not clear to you, please feel free to let me know.","01/Feb/23 8:55 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9ec6d76184b7d989c83] 

This is what I see in my environment: 
cloudwatchrole is an example role created and associated with that instance.

!image-20230201-105049.png|width=967,height=508!

That CloudWatch role has the following permissions - 

!image-20230201-105340.png|width=1439,height=868!

!image-20230201-105425.png|width=463,height=412!

I am confused about the questions asked - Does this screenshot clarify anything? 



On prem won't have the need to associate any IAM role since this is specific to the EC2 instances. 
",03/Feb/23 10:16 AM;5b15d9ec6d76184b7d989c83;The customer agreed to close the case. Thank you very much for the help!,03/Feb/23 10:37 AM;5af4ad7d4dd24c579110120b;Thanks  [~accountid:5b15d9ec6d76184b7d989c83] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Error HPDMG0769E when trying to setup a new WebSEAL instance using OpenLDAP ,ISAMSUP-5197,309646,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,,Motiur Rahman,5b15d9e581c3df12acf53c4a,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,30/Jun/23 3:08 AM,07/Jul/23 7:02 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"Customer is trying to setup a new WebSEAL instance.

When they are finishing , error HPDMG0769E came up as screenshot below.

!image-20230629-170049.png|width=1370,height=1008!

We had a webex with the client and recreate the issue , while viewing the application log files we can see that indeed seems to be an issue with the ACLs.

!image-20230629-170239.png|width=1238,height=614!

I have provided few commands to check ACL’s (I guess) not sure exactly how OpenLDAP works for command search to be honest and the provided screenshots were uploaded to the case. (Specially the second one)

!image-20230629-170445.png|width=2053,height=1000!

!image-20230629-170507.png|width=1331,height=990!

!image-20230629-170552.png|width=1016,height=554!

Is there something I’m missing to check? Any suggestions , please? Specially for this OpenLDAP check ACL’s.

Customer tried [Applying Security Verify Access ACLs to new LDAP suffixes - IBM Documentation|https://www.ibm.com/docs/en/sva/10.0.3?topic=lst-applying-security-verify-access-acls-new-ldap-suffixes] but not luck.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,30/Jun/23 3:08 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230629-170049.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/209275,30/Jun/23 3:08 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230629-170239.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/209276,30/Jun/23 3:08 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230629-170445.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/209277,30/Jun/23 3:08 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230629-170507.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/209274,30/Jun/23 3:08 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230629-170552.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/209278,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013089753,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,HCL AMERICA INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"Citrix Path --> S:\sf\TS013\089\TS013089753\2023-06-14\isva_10.0.5.0_20230614-061506_fusionsvave.cnx.cwp.pnp-hcl.com.support_unpack\

Windows Path --> S:\ecurep\sf\TS013\089\TS013089753\2023-06-14\isva_10.0.5.0_20230614-061506_fusionsvave.cnx.cwp.pnp-hcl.com.support_unpack\",,,,,,,,,,,,,,,,,,,,,,,0|i1d7mf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-07-03 03:31:46.55,,,,,"03/Jul/23 1:31 PM;5ac57757d9a96536d1f0daa9;[~accountid:60e721f12d49fd00698bb49d] I can see in the ISVA KC the following - 

[https://www.ibm.com/docs/en/sva/10.0.6?topic=configuration-installing-configuring-openldap-server|https://www.ibm.com/docs/en/sva/10.0.6?topic=configuration-installing-configuring-openldap-server|smart-link] 

Can you please confirm that the customer has followed all the steps outline in the above?

Can you also please confirm if the customers is setting up the virtual appliance or a container deployment?",03/Jul/23 1:34 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] assigning this item you to complete the initial assessment for us. ,"06/Jul/23 11:32 PM;60e721f12d49fd00698bb49d;Hi [~accountid:5ac57757d9a96536d1f0daa9] / [~accountid:5b15d9e581c3df12acf53c4a] 

Yes - those were the instructions the customer followed.  I’m really thinking this is something wrong with their ACL’s.

[~accountid:5b15d9e581c3df12acf53c4a] any suggestions please?",07/Jul/23 1:12 AM;5b15d9e581c3df12acf53c4a;I am investigating the issue……..,"07/Jul/23 7:02 AM;5b15d9e581c3df12acf53c4a;It seems like there was some steps got missed or some step did not work properly when they prepared OpenLDAP for ISVA installation otherwise the insufficient acl errors will not be shown.

Best way forward will be for L2 to download the same OpenLDAP version that customer is using and follow the steps carefully as far as 

[https://www.ibm.com/docs/en/sva/10.0.6?topic=configuration-installing-configuring-openldap-server|https://www.ibm.com/docs/en/sva/10.0.6?topic=configuration-installing-configuring-openldap-server|smart-link] 

instructions goes. Do each step carefully.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
WGAWA0409E Error while creating HSM Network kdb,ISAMSUP-5186,309243,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,,David Hayes,5b232b2fd85e5b59b066f57f,Charles David Hooks,5b15d9936d76184b7d989c82,Charles David Hooks,5b15d9936d76184b7d989c82,28/Jun/23 7:57 AM,14/Jul/23 10:41 AM,14/Jul/23 2:47 PM,,,,,0,,,,"SF Case : TS013393730

Env: ISVA 10.0.3.1

Problem: WGAWA0409E Error while creating HSM Network kdb

----

Initially, the customer installed the safenet HSM extension (Jun21st when the case was opened):

/var/extensions:
total 12
drwxr-xr-x    3 www-data www-data      4096 Jun 21 12:39 .
drwxr-xr-x   43 root     root          4096 Jun 20 12:22 ..
drwxr-xr-x    2 www-data www-data      4096 Jun 21 12:39 safenetLunaHSM



and was attempting to create an HSM Ketwork Keystore without any fixpacks applied… during those attempts, nothing related to the attempts was showing up in the system messages logging…

located a case from AT&T from last September, opened by a different contact, where the customer was requesting any necessary fixpacks in front of their upgrade to 10.0.3.1 (this was due to the various ISAM 9.0.7 Luna/HSM related fixpacks they’d had to use at lower levels)… located and had them apply this fixpack:

create_luna_keystore_fix_10031.fixpack

following application of the fixpack, they made an attempt to generate an HSM keystore, and now the attempt throws an WGAWA0409E error…

here’s the sequence in the log of fixpack installation, keystore creation attempt, then reboot just in case, and another keystore creation attempt…



Jun 27 14:40:41 mesa_control[14430]: Installing fixpack from file /tmp/fixpacktmpdir/create_luna_keystore_fix_10031.fixpack
Jun 27 14:40:42 mesa_install_fixpack: create_luna_keystore_fix_10031 install successful
Jun 27 14:40:42 mesa_control[14430]: Fixpack /tmp/fixpacktmpdir/create_luna_keystore_fix_10031.fixpack: install successful

….

Jun 27 14:42:46 mesa_config[15371]: Error: WGAWA0409E   An error occurred when creating the SafeNet key file.

<sytem reboot>

Jun 27 14:45:08 mesa_config[3247]: Error: WGAWA0409E   An error occurred when creating the SafeNet key file.



png and support file from today’s attempts are available at:

/ecurep/sf/TS013/393/TS013393730/2023-06-27/



am I maybe missing some other fixpack requirement?… in the event that we get past the keystore creation issue, I have +luna_client_cert_permissions_fix.fixpack+ ready and waiting in case they need it, but first need to overcome the creation issue… ",,Brandon Garay,David Hayes,khansen,Nick Lloyd,,,,,,,,,,,,60e721f12d49fd00698bb49d,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,14/Jul/23 3:18 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230713-171756.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/211156,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013393730,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Charles David Hooks,5b15d9936d76184b7d989c82,,,,A T & T SERVICES INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,/ecurep/sf/TS013/393/TS013393730/2023-06-27/,,,,,,,,,,,,,,,,,,,,,,,0|i1d553:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-06-30 03:00:49.946,,,,,"28/Jun/23 9:48 AM;5b15d9936d76184b7d989c82;searching case history exclusively for error code WGAWA0409E, there were two other cases, both at 9.0.7.X…

TS008545398 (which ended via webex with L2, L3, and customer)

TS006783111 (which included a list of 5 fixpacks, 4 luna, 1 gskit)","30/Jun/23 1:00 PM;5b232b2fd85e5b59b066f57f;Hi [~accountid:5b15d9936d76184b7d989c82]. 

Has the customer managed to get any ISVA instances to work with this Luna HSM server? 

Looking at the case, I see that the customer is seeing the following in the logs on their Luna server: 

{noformat}2023 Jun 21 16:30:57 bld10105  local5 info  NTLS[5440]: info : 0xc0000711 : Fail to establish a secure channel with client : 144.161.7.23/37316 : RC_SSL_FAILED_HANDSHAKE{noformat}

A side-note on this - the IP address of the support file the customer supplied (144.161.7.25) does not match what is in this message - so I’m not sure that we are looking at consistent data… anyhow - ignoring this for the moment:

As per Luna docs ([https://thalesdocs.com/gphsm/luna/7/docs/network/Content/PDF_Network/Monitoring Guide.pdf|https://thalesdocs.com/gphsm/luna/7/docs/network/Content/PDF_Network/Monitoring%20Guide.pdf]) this message indicates that the server is not accepting the certificate being sent by the client: 


{noformat}Handshake Failed
2012 Feb 29 12:05:01 myLuna local5 info NTLS [1234]: info : 0xc0000711 : Fail to establish a
secure channel with client : 192.168.0.100/40847 : RC_SSL_FAILED_HANDSHAKE
This message indicates that an application attempted to connect with SSL credentials that did not conform to the
algorithms and/or cryptographic strength expected by NTLS. {noformat}

*What algorithms have they got their Luna HSM server set up to accept?* 

One observation - which I’m unsure how they got into this state or what to think of this at the moment - the Chrystoki.conf file is missing from their system, yet it seems the extension is installed: 

{noformat}$ grep Chrystoki.conf isva_10.0.3.1_20230621-173854_zlt13256.enaf.vci.att.com.support_unpack/iswga/ls.txt
$ grep Chrystoki.conf isva_10.0.3.1_20230623-115012_zlt13256.enaf.vci.att.com.support_unpack/iswga/ls.txt
$ grep Chrystoki.conf isva_10.0.3.1_20230627-144649_zlt13256.enaf.vci.att.com.support_unpack/iswga/ls.txt
${noformat}

We may need them to uninstall / re-install the extension - but lets get the questions around HSM server algorithm answered first. 

Thanks. ","11/Jul/23 2:53 AM;5b15d9936d76184b7d989c82;feedback from the customer concerning HSM algorithms:

*>*RSA

*>*DSA

*>*Diffie-Hellman

*>*DES and triple DES

*>*MD2 and MD5

*>*SHA-1, SHA-224, SHA-256, SHA-384, SHA-512

*>*RC2, RC4 and RC5

*>*AES

*>*PBE

*>*ECC

*>*ECIES

*>*ARIA, SEED","11/Jul/23 10:43 AM;5b232b2fd85e5b59b066f57f;Has the customer managed to get any ISVA instances to work with this Luna HSM server?

There doesn’t appear to be any Luna configuration on the Appliance. They will need to re-install the extension. 

Ask the customer to delete any Luna keystores then re-install the extension. At this point, have them generate and provide a new support file. They can then try creating the network keystore again. ","12/Jul/23 7:55 AM;5b15d9936d76184b7d989c82;Per some previous exchanges with the customer, they do not have any 10.0.3.1 appliances working with the target LUNA HSM server as of yet, but I asked the question just to make sure, and also relayed the rest of the update… ","14/Jul/23 3:18 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5b232b2fd85e5b59b066f57f] 

Seems customer reinstalled the extension and now they are able to create KDB’s. However, they are hitting this error.

{noformat}System Error
DPWAP0039E An error occurred in the GSKKM_GetReqKeyItemByLabel(dbh, key-&gt;label, &amp;item) system function: GSKKM_ERR_KEY_GET_BY_LABEL{noformat}

!image-20230713-171756.png|width=1686,height=850!



New support file uploaded to: 

{noformat}S:\sf\TS013\393\TS013393730\2023-07-13\isva_10.0.5.0_20230713-120019_zlt13256.enaf.vci.att.com.support_unpack\{noformat}",14/Jul/23 10:41 AM;5b232b2fd85e5b59b066f57f;[~accountid:60e721f12d49fd00698bb49d] - other than the error appearing - is everything working as expected? We have seen this before in another AT&T Luna case - [https://cloudidentity.atlassian.net/browse/ISAMSUP-3722|https://cloudidentity.atlassian.net/browse/ISAMSUP-3722|smart-link] and it was determined it was cosmetic in the sense it had no negative impact. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
OIDC RP flow issues returning 503 and 500 on random requests,ISAMSUP-5160,307777,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,21/Jun/23 6:31 AM,14/Jul/23 9:49 AM,14/Jul/23 12:58 PM,,,Support,,0,,,,"Customer is seeing multiple HTTP response of 503 and 500 issues in production on /isam junction while users accessing OIDC RP URL’s.

{noformat}unauthenticated 09/Jun/2023:11:33:23 -0400 GET /isam/sps/oidc/rp/brokers-okta/redirect/okta-brokers?code=LwqDh1OVdEgOK8LZ69toe-YYIriIivmVvnZ6FyUGrp4&state=K0XWhbxy5P HTTP/1.1 503 1271 10 426482 /isam
unauthenticated 09/Jun/2023:11:16:02 -0400 GET /isam/sps/oidc/rp/brokers-okta/redirect/okta-brokers?code=4b5Ah-QSUgji8vNVJ5GMksBJyH1xYSbJlVDcZQ7iXuo&state=6tc28bIuK8 HTTP/1.1 500 1516 0 1071474 /isam{noformat}

They have OIDC RP setup between ISAM and OKTA where authentication is delegated to OKTA and upon successful authentication on OKTA, ISAM exchanges session cookie with OKTA access token. Issue is sporadic and not always happening. 

10% of total user requests are ending up with errors. They have 3 RPs, 1 PS (master) and 3 AACs in prod. Issue is happening in production and it might escalate soon to P1 issue.

Some important things:

* New implementation
* All users are impacted, but sporadic.

Error visible to the end users after login is the following:

!image-20230620-202346.png|width=1192,height=409!



They see issue occurred in prod after they enabled traces 2 times, 1st at 7:25:09 PM EST June 9th and 2nd time at 7:28:37 PM EST June 9th, we are attaching screenshot and trace files.

!image-20230620-202632.png|width=1360,height=462!

prd-ifp-bkr-request 549 - - 3.22.10.133 unauthenticated 19/Jun/2023:10:39:48 -0400 GET /isam/sps/oidc/rp/brokers-okta/redirect/okta-brokers?code=aRijnZ95tpaYikQWCZ5iwgmdtneH_KOEtScVj2NAS-U&state=rKmuQWJVRF HTTP/1.1 503 1271 45 533139 /isam

* host = ciaisapp0199
* source = tcp:9997
* sourcetype = isam:request



prd-ifp-bkr-request 549 - - 159.113.200.7 unauthenticated 19/Jun/2023:10:37:47 -0400 GET /isam/sps/oidc/rp/brokers-okta/redirect/okta-brokers?code=jblW93A7xcPP6nFvZvMNFuUeczcuFe-sVSqbuqTAr2Y&state=B0OwnNNxfx HTTP/1.1 500 1516 0 304654 /isam

* host = ciaisapp0199
* source = tcp:9997
* sourcetype = isam:request

prd-ifp-bkr-request 549 - - 159.113.200.7 unauthenticated 19/Jun/2023:10:37:40 -0400 GET /isam/sps/oidc/rp/brokers-okta/redirect/okta-brokers?code=jblW93A7xcPP6nFvZvMNFuUeczcuFe-sVSqbuqTAr2Y&state=B0OwnNNxfx HTTP/1.1 503 1271 78 578630 /isam

* host = ciaisapp0199
* source = tcp:9997
* sourcetype = isam:request



*Support files were uploaded to BlueDiamond.*

isva_10.0.2.0_20230609-193529_ciaisapp0197.sys.cigna.com.support → H:\sf\TS013\278\TS013278256\2023-06-10

isva_10.0.2.0_20230609-193520_ciaisapp0198.sys.cigna.com.support → H:\sf\TS013\278\TS013278256\2023-06-09

isva_10.0.2.0_20230609-193458_ciaisapp0199.sys.cigna.com.support → H:\sf\TS013\278\TS013278256\2023-06-09



I’m not sure what’s happening. From L2 side I didn’t identify the issue. Any suggestions, please?",,Brandon Garay,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,,,,60e721f12d49fd00698bb49d,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5230,,,,,,21/Jun/23 6:31 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230620-202346.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/207415,21/Jun/23 6:31 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230620-202632.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/207416,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013278256,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,CIGNA CORP,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{pullrequest={dataType=pullrequest, state=MERGED, stateCount=1}, json={""cachedValue"":{""errors"":[],""summary"":{""pullrequest"":{""overall"":{""count"":1,""lastUpdated"":""2020-11-09T09:01:36.000+1000"",""stateCount"":1,""state"":""MERGED"",""dataType"":""pullrequest"",""open"":false},""byInstanceType"":{""githube"":{""count"":1,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"BlueDiamond

isva_10.0.2.0_20230609-193529_ciaisapp0197.sys.cigna.com.support → H:\sf\TS013\278\TS013278256\2023-06-10

isva_10.0.2.0_20230609-193520_ciaisapp0198.sys.cigna.com.support → H:\sf\TS013\278\TS013278256\2023-06-09

isva_10.0.2.0_20230609-193458_ciaisapp0199.sys.cigna.com.support → H:\sf\TS013\278\TS013278256\2023-06-09",,,,,,,,,,,,,,,,,,,,,,,0|i1cw8n:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.2.0,,,,,,,,,,,,,2023-06-21 01:28:06.409,,,,,"21/Jun/23 11:28 AM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}current config - 
==================

worker-threads = 100
client-connect-timeout =120 
dsess-enabled = yes
ignore-svc-unavailable = false 

connect-timeout = 30
persistent-con-timeout = 5

max-idle-persistent-connections = 512
max-idle-persistent-connections-threshold - Not set
disable-timeout-reduction - Not set
intra-connection-timeout = 60 


Options to Try - 
Increase worker-threads = 300 
ignore-svc-unavailable = true

Could try - 
https://github.ibm.com/ISAM/isam/pull/5314/files


generic ref-
https://www.ibm.com/support/pages/node/6377942 
https://www.ibm.com/support/pages/effect-load-front-end-persistent-con-timeout-and-other-connection-timeouts{noformat}","21/Jun/23 5:42 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

I’m still working on this but in the mean time I see that the worker-threads are configured to 100, 

Are they able to test with these two options changed-

{{worker-threads = 300 }}

{{ignore-svc-unavailable = true}}","30/Jun/23 1:26 AM;60e721f12d49fd00698bb49d;Customer pushed changes on RPs and they see error rate has decreased drastically and now we are seeing 2% error rate compared to 10% earlier. 

Customer will have the case opened for a few days for monitoring.","30/Jun/23 10:53 AM;5af4ad7d4dd24c579110120b;[~accountid:60e721f12d49fd00698bb49d] 

Ok thanks

I’m just checking a few more config options , I’ll keep you posted with my updates. ","07/Jul/23 4:30 AM;60e721f12d49fd00698bb49d;Hey [~accountid:5af4ad7d4dd24c579110120b] 

Customer reported that errors are backing up to 10% again. Have you found other configuration options that can help as well?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
Pending changes alert appearing after RAPI 500 error,ISAMSUP-5159,307773,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,21/Jun/23 4:47 AM,10/Jul/23 10:56 PM,14/Jul/23 2:47 PM,10/Jul/23 10:56 PM,,,,0,,,,"Hi team, the customer ran the rapi

2023-05-16 11:54:49,994 INFO [AssemblyLine.AssemblyLines/sva-e-WRP] - calling: POST [https://10.190.12.10/wga/reverseproxy|https://10.190.12.10/wga/reverseproxy]

2023-05-16 11:54:49,994 INFO [AssemblyLine.AssemblyLines/sva-e-WRP] - body: '{""admin_id"":""sec_master"",""ip_address"":""10.190.204.10"",""listening_port"":7234,""domain"":""Default"",""http_yn"":""no"",""http_port"":""80"",""inst_name"":""1-forms"",""cert_label"":""SDS-ISAM"",""admin_pwd"":""*<hidden>*"",""https_yn"":""yes"",""key_file"":""CP.kdb"",""ssl_yn"":""yes"",""ssl_port"":""636"",""host"":""asecpsvazog1"",""nw_interface_yn"":""yes"",""https_port"":""443""}'



and got the 500 error

2023-05-16 11:54:51,531 INFO [AssemblyLine.AssemblyLines/sva-e-WRP] - responseCode: 500

2023-05-16 11:54:51,531 INFO [AssemblyLine.AssemblyLines/sva-e-WRP] - {""message"":""Error: DPWAP0011E The administration command, ivadmin_protobj_create(HPDMG0611E This operation is not supported for the objects in this object space.), failed\nDPWCF0479E The specified certificate label 'SDS-ISAM' is invalid.""}

But a pending changes alert appears in the LMI:

May 16 12:12:02 wga_notifications: WGAWA0658W:: WGA_events:: |1=AccessManagerSVC@local,msg=There are pending changes made by AccessManagerSVC@local waiting to be deployed.|



Then we ran the pending changes rapi with user AccessManagerSVC@local and showed no pending changes:

2023-05-16 12:03:09,267 INFO [AssemblyLine.AssemblyLines/sva-e-Setup] - calling: GET [https://10.190.12.10/isam/pending_changes|https://10.190.12.10/isam/pending_changes]

2023-05-16 12:03:09,978 INFO [AssemblyLine.AssemblyLines/sva-e-Setup] - responseCode: 200

2023-05-16 12:03:09,980 INFO [AssemblyLine.AssemblyLines/sva-e-Setup] - AccessManagerSVC@local - No Pending Changes - ({""changes"":[]})

The way to stop the alert was a successful rapi and deploy of pending changes from that account. But I also notice that login with the user that ran the rapi in the cli and ran pending_changes then discard delete it.

I recreate the issue and seems to be a known issue for version 10.0.3.1 ([[ISAMSUP-4167] Deleting multiple Reverse Proxy management root entries via REST API causes a pending change for 'admin@local' - ISV Jira (atlassian.net)|https://cloudidentity.atlassian.net/browse/ISAMSUP-4167]), but the customer is in 10.0.4.1

Recreate steps:

I did the following:

Create an ISVA 10.0.4.1 appliance

Activate the 'Base' module

Configure the Runtime Component

Create a reverse proxy called '2-forms'

Enable management authentication

Confirm I can log in as admin@local

Create a user 'AccessManagerSVC'

Confirm I can log in as 'AccessManagerSVC@local'

Run REST API POST [https://172.16.24.10/wga/reverseproxy|https://10.190.12.10/wga/reverseproxy]

       body: '{""admin_id"":""sec_master"",""ip_address"":""172.16.24.10"",""listening_port"":7234,""domain"":""Default"",""http_yn"":""no"",""http_port"":""80"",""inst_name"":""1-forms"",""cert_label"":""SDS-ISAM"",""admin_pwd"":""_<hidden>_"",""https_yn"":""yes"",""key_file"":""CP.kdb"",""ssl_yn"":""yes"",""ssl_port"":""636"",""host"":""asecpsvazog1"",""nw_interface_yn"":""yes"",""https_port"":""443""}'

Deploy changes and then re ran the rapi to get the 500 error.

2023-06-16 11:54:51,531 INFO [AssemblyLine.AssemblyLines/sva-e-WRP] - responseCode: 500

2023-06-16 11:54:51,531 INFO [AssemblyLine.AssemblyLines/sva-e-WRP] - {""message"":""Error: DPWAP0011E  The administration command, ivadmin_protobj_create(HPDMG0611E  This operation is not supported for the objects in this object space.), failed\nDPWCF0479E  The specified certificate label 'SDS-ISAM' is invalid.""}

Could you confirm if it is a known issue and if the customer needs an RFE for a fix?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013040101 ,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Nicolas.Salinas.Montero,62e437a72fe585febb3c92a5,,,,CANADIAN PACIFIC RAILWAY COMPANY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cw7r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-06-21 03:12:20.213,,,,,21/Jun/23 1:12 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9e581c3df12acf53c4a] - given your work on [https://cloudidentity.atlassian.net/browse/ISAMSUP-4167|https://cloudidentity.atlassian.net/browse/ISAMSUP-4167|smart-link] can you please take a look at this one? Thanks. ,23/Jun/23 4:43 AM;5b15d9e581c3df12acf53c4a;Will investigate and update soon…….,"26/Jun/23 11:37 PM;5b15d9e581c3df12acf53c4a;On the face of it, it does look like [https://cloudidentity.atlassian.net/browse/ISAMSUP-4167|https://cloudidentity.atlassian.net/browse/ISAMSUP-4167|smart-link]

i.e. working as designed.

But I will look more into it to see is there any other differences and will update soon.","05/Jul/23 10:44 PM;5b15d9e581c3df12acf53c4a;Yes, I looked at it and yes, it is similar to the previous issue i.e. [https://cloudidentity.atlassian.net/browse/ISAMSUP-4167|https://cloudidentity.atlassian.net/browse/ISAMSUP-4167|smart-link]

They way ISVA is designed to handle files modification is such that if more than one users try to modify a file, this issue could be observed and it is a limitation.

Best way forward will be to open an RFE.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Can not change admin's password of config container.,ISAMSUP-5132,305771,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,,Motiur Rahman,5b15d9e581c3df12acf53c4a,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,12/Jun/23 4:27 PM,12/Jul/23 3:19 AM,14/Jul/23 2:47 PM,,,Support,,0,,,,"The customer is currently using isva 10.0.5.0 IF1 on docker on Rancher(Kubernetes).

The original env was
  9.0.2.1 appliance → 9.0.7.2 appliance → 10.0.2 appliance → 10.0.5.0 IF1 appliance
then take a snapshot and import it to their 10.0.5.0 IF1 container.

The customer tried following passwords which are complicated enough:
  23Marvel!2023
  password@123
  Passw0rd@123

On LMI screen, he received:

{quote}popup messgae thrown was: ""System Error The password update operation failed. This usually occurs when the supplied password does not meet the minimum password policy requirments""{quote}


In local openshift environment, I was not able to recreate the issue so far. 
I mean, I was able to change password of admin even if I create the env like above.

I have asked the customer to provide the snapshot, yaml file for the config container and support file:
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2F2023-05-30%2F&filepath=TS012851448%2F2023-05-30%2Fisva_10.0.5.0_20230302-150406.928100_NESWS01S_OldVA_.snapshot|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2F2023-05-30%2F&filepath=TS012851448%2F2023-05-30%2Fisva_10.0.5.0_20230302-150406.928100_NESWS01S_OldVA_.snapshot]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2F2023-05-30%2F&filepath=TS012851448%2F2023-05-30%2Fisvaconfig_deploy.yml|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2F2023-05-30%2F&filepath=TS012851448%2F2023-05-30%2Fisvaconfig_deploy.yml]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2F2023-05-30%2F&filepath=TS012851448%2F2023-05-30%2Fisva_10.0.5.0_20230530-144430_isvaconfig-c959884d-g9w49_newKuberbetesNode_.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2F2023-05-30%2F&filepath=TS012851448%2F2023-05-30%2Fisva_10.0.5.0_20230530-144430_isvaconfig-c959884d-g9w49_newKuberbetesNode_.support]


I was not able to find any useful information in /var/log/messages in support file.
How should I investigate this issue?
",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012851448,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Yutaka Kanemoto,5b15d9ec6d76184b7d989c83,,,,INLAND REVENUE AUTHORITY OF SINGAPORE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,IF 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cjz3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-12 13:10:16.037,,,,,12/Jun/23 11:10 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] one for you to take the initial review of. ,"13/Jun/23 3:42 AM;5b15d9e581c3df12acf53c4a;If you have not already, can you gather the following combination of traces 😎 

From LMI:

com.ibm.mesa.*=ALL

and good old ATP i.e.  debig.level=2

The combination of these two together should give us enough clue as to which is having trouble.","29/Jun/23 7:41 PM;5b15d9ec6d76184b7d989c83;Hi [~accountid:5b15d9e581c3df12acf53c4a] ,

I was able to recreate this issue.

The customer was using ‘Management Authentication’ with external LDAP.
Even if you login LMI as admin@local, LDAP search request will be sent to LDAP server (when submitting password change),
and nothing found, then caused password change error.

This can be observed in both appliance and container environment.
In appliance environment, I was able to change the password using CLI (management → set_password),
but this command can not be found in container env.

As a workaround, I suggested the customer to unconfigure Management Authentication before change password for admin.

So, the subject needs to be changed as follows:
Password of admin@local can not be changed if Management Authentication is enabled.

Can this be fixed? Or, is this known limitation?
Any comments are really appreciated.","01/Jul/23 6:37 AM;5b15d9e581c3df12acf53c4a;For L3

==========

When Changing password via CLI i.e. CLI (management → set_password)

it calls: src/appliance/mesa/src/modules/cli_management.cpp::PasswordMain()

CLI_MODE_COMMAND(""management"", ""set_password"", PasswordMain, NULL,
        ""Set the appliance password."",
        ""set_password"", !CLI_IS_WEB_CALLED && !is_docker_container());

which calls PasswordChanger.run(), which calls validatePassword(oldPassword) to validate the old password -which in turns calls MesaAuth() to validate the old password which is:

src/appliance/mesa/src/libauth/src/mesa_auth.c::MesaAuth()

where it is set to call verify_locally() first then calls vaerify_over_radius() then verify_over_ldap()

…………………..

……………….

Once old password is verified, PasswordChanger.run() calls. testPassword and setPassword()

to set the new password

setPassword calls:
    int rc = MesaSpawn(0, ""/usr/sbin/mesa_config"", ""-S"", ""password"",
            ""-a"", auditInfo.c_str(),
            oldPassword.c_str(), newPassword.c_str(), (const char*)0);

=====================================================

If you call set_password  via LMI, it calls:

./mesa/src/com/ibm/mesa/feature/sysaccount/AccountManagementServlet.java::changeSelfPassword()…………..

changeSelfPassword() calls

“mesa_config wga.auth authenticate userName” 

to verify the oldPassword.

mesa_config wag.auth authenticate

uses or checks whether or not appliance is configured for remote user, if it is , then it first check or search for user in remote registry i.e. in this case in ldap…………………","05/Jul/23 11:29 PM;5b15d9e581c3df12acf53c4a;If your system is still configured for remote access, would you please cut/paste/attach the

/etc/auth_server.conf 

file here?","06/Jul/23 3:55 AM;5b15d9e581c3df12acf53c4a;I need to dig little deeper, if you still have the reproduction, can you generate the following traces please:

This trace will help us:

LMI:

com.ibm.isam._=ALL:com.ibm.mesa._=ALL

And ATP: Good old

debug.level=2

and gather support file.

Also, if /etc/auth_server.conf does not get included in the support file, you can attach it here.","07/Jul/23 4:26 PM;5b15d9ec6d76184b7d989c83;Hi Motiur,

I recreated the issue in local environment and collected support file:

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2Fsupport_files%2F&filepath=TS012851448%2Fsupport_files%2Fisva_10.0.5.0_20230707-151126_vaa5.battle.mil.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2Fsupport_files%2F&filepath=TS012851448%2Fsupport_files%2Fisva_10.0.5.0_20230707-151126_vaa5.battle.mil.support]

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2Fsupport_files%2F&filepath=TS012851448%2Fsupport_files%2Fauth_server.conf|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012851448&path=TS012851448%2Fsupport_files%2F&filepath=TS012851448%2Fsupport_files%2Fauth_server.conf]

auth_server.conf contains only 4 lines:

{noformat}# cat auth_server.conf
[AUTH_SERVER local]
AliasName = local
local = true
SERVER_TYPE = 0{noformat}


I tried to change password at around 15:11.
If you need any other info, please let me know.","11/Jul/23 7:36 AM;5b15d9e581c3df12acf53c4a;Thanks, I will analyze and will update soon.","12/Jul/23 3:19 AM;5b15d9e581c3df12acf53c4a;With the following settings in place:

/etc/settings.txt:

authdb.type = remote

and

 /etc/wga_auth.conf:

authdb.type = remote

i.e. ISVA is configured for remote authentication , NOT local.

Only way LMI can identify a user is local  and to use local authentication is to use the suffix @local, 

So, LMI is designed:

if  “authdb.type = remote” and user DOES NOT have “@local” suffix, then user is remote.

============================================

And for CLI (management → set_password)

which uses /etc/auth_server.conf which is always set to “local = true” and set_password acts as if user is local.



This whole sequence seems to be working as designed.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
UserLookupHelper() init with invalid password not working as expected,ISAMSUP-5129,305412,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Charles David Hooks,5b15d9936d76184b7d989c82,Charles David Hooks,5b15d9936d76184b7d989c82,08/Jun/23 11:08 AM,12/Jul/23 2:14 PM,13/Jul/23 9:13 AM,,,,,0,,,,"SF Case : TS013131308

Version: ISVA 10.0.4

Problem abstract: UserLookupHelper() init with invalid password not working as expected

Initial case text:

----

The UserLookupHelper init() function is returning a valid session for user where we are specifying the wrong password. 

ulhAuth.init(hostname, port, foundUserDN, password, keystore, label, ""(objectclass=*)"" ,""fake"", 10, false, adOverrideProperties);

----

consulting with other L2 staffers, we had some exchanges with the customer, and ultimately had them run a recreate with the following trace specs:

*com.tivoli.am.fim.*=ALL:com.ibm.security.access.*=ALL:com.tivoli.pd.*=ALL*

customer uploaded tracing as well as applicable rules file InfoMap_Pega_Login.js (see “location URL” section for links)

recreate particulars (from the customer):

----

Look for user ""sub0015"" with pw of Idontknowthepw at 10:28 .. you might l also see i tried it with different pw earlier but didn't have the packet trace on at that time. the 10:28 has the packet capture events.

----

in the tracing (line 111586), located the following entry:

*[6/7/23, 10:28:16:240 EDT] 0000002a id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY ULH_DEBUG : ulhAuth password: Idontknowthepw*

Jack noted the following:

----

""by searching for the term 'd03d27b' we can see that the same instance of the Registry Direct API connection is used for both searches…. lines 111582 through 111643 are what are relevant….”

----

the customer’s rule file initializes ULH twice to conduct two search operations… it looks like the second search operation is using an existing connection (cached info?) to conduct the second search, which might explain why the invalid pwd is not being used?… ",,Annelise Quap,gvacek,jcyarbor,khansen,Nick Lloyd,Peter Horner,,,,,,,,,,5b15d950d9936c61022057fe,5c87cb8d88f9ec6ae0afb306,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9517dab4c51f61b5190,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5152,ISAMDEV-10359,,,,,08/Jun/23 3:32 PM;ashashiv;infomap_username-5.js;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204722,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013131308,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Charles David Hooks,5b15d9936d76184b7d989c82,,,,CANADIAN PACIFIC RAILWAY COMPANY,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"InfoMap_Pega_Login.js

/ecurep/sf/TS013/131/TS013131308/2023-05-25/isva_10.0.4.0_20230525-162655_asecasvapog1.support.zip_unpack/isva_10.0.4.0_20230525-162655_asecasvapog1.support_unpack/var/itfim/amapp-runtime/mapping-rules/InfoMap_Pega_Login.js

trace file:

/ecurep/sf/TS013/131/TS013131308/2023-06-07/trace_16_.log

pcap:

/ecurep/sf/TS013/131/TS013131308/2023-06-07/trace01_5_.pcap",,,,,,,,,,,,,,,,,,,,,,,0|i1chrb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-06-08 03:08:55.015,,,,,08/Jun/23 1:08 PM;5b232b2fd85e5b59b066f57f;[~accountid:5af4ad7d4dd24c579110120b] - can you take a look at this one please? ,"08/Jun/23 3:32 PM;5af4ad7d4dd24c579110120b;<Notes>

/InfoMap_Pega_Login.js 
There are 2 declarations - 


{noformat}var ulhSearch = new UserLookupHelper();
var ulhAuth = new UserLookupHelper();{noformat}

There are 2 init’s

{noformat}ulhSearch.init(hostname, port, bindDn, bindPwd, keystore, label, ""(objectclass=*)"" ,""fake"", 10, false, adOverrideProperties);
bindDN, bindPwd - is from the LDAP Server connection property


var users = ulhSearch.search(""samaccountname"",username,1);
foundUserDN - is users[0] from the search
username and password are from request params - is supplied by urn:ibm:security:asf:request:parameter

ulhAuth.init(hostname, port, foundUserDN, password, keystore, label, ""(objectclass=*)"" ,""fake"", 10, false, adOverrideProperties);

var usr = ulhAuth.search(""samaccountname"", username, 1);

{noformat}





There are two inits and stored connections - 

{{com.ibm.security.access.user.UserLookupUtil@8dd1fd20}} and {{com.ibm.security.access.user.UserLookupUtil@9bb1851a}}

{noformat}[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelper                1 init storing lookup util in cache
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelperStore           > storeUtil ENTRY -115731272 com.ibm.security.access.user.UserLookupUtil@8dd1fd20
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager                           > get(Class<C>) ENTRY
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             > getObject(Class<C>) ENTRY
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             3 getObject(Class<C>) Class com.ibm.security.access.user.UserLookupHelperStore$UserLookupHelperStoreCache from version 1686201111876.
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             < getObject(Class<C>) RETURN
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager                           < get(Class<C>) RETURN
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelperStore           > storeUtil ENTRY
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelper                < init RETURN com.ibm.security.access.user.UserLookupUtil@8dd1fd20
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY ASHA00 ULH_DEBUG : Initiation was successful
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils < traceString RETURN
[6/8/23, 1:12:35:801 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelper                > search ENTRY uid testuser 1 0


[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupUtil                  < UserLookupUtil() RETURN
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelper                1 init storing lookup util in cache
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelperStore           > storeUtil ENTRY -1052168610 com.ibm.security.access.user.UserLookupUtil@9bb1851a
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager                           > get(Class<C>) ENTRY
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             > getObject(Class<C>) ENTRY
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             3 getObject(Class<C>) Class com.ibm.security.access.user.UserLookupHelperStore$UserLookupHelperStoreCache from version 1686201111876.
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             < getObject(Class<C>) RETURN
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.tivoli.am.fim.om.ObjectManager                           < get(Class<C>) RETURN
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelperStore           > storeUtil ENTRY
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelper                < init RETURN com.ibm.security.access.user.UserLookupUtil@9bb1851a
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY  ASHA00 |PEGA| try to find testuser
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils < traceString RETURN
[6/8/23, 1:12:35:830 EDT] 00000048 id=00000000 com.ibm.security.access.user.UserLookupHelper                > search ENTRY uid testuser 1 0{noformat}

[^infomap_username-5.js]

[https://10.160.21.22/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1|https://10.160.21.22/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1] 





ulhAuth.init is used and search is requested without ulhSearch -

{noformat}
[6/8/23, 17:16:53:356 EDT] 0000069c id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr                      2 setupHandle THROW
com.tivoli.pd.rgy.exception.InvalidCredentialsRgyException: HPDAA0329E   The credentials provided can not be authenticated by the registry.
	at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.jndiToRgyExceptionAndExpireTime(LdapRgyRegistry.java:1104)
	at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.jndiToRgyException(LdapRgyRegistry.java:932)
	at com.tivoli.pd.rgy.ldap.LdapRgyServer.checkBindResult(LdapRgyServer.java:271)
	at com.tivoli.pd.rgy.ldap.LdapRgyServer.getLdapContext(LdapRgyServer.java:494)
	at com.tivoli.pd.rgy.ldap.LdapRgyServer.getLdapContext(LdapRgyServer.java:230)
	at com.tivoli.pd.rgy.ldap.LdapRgyServer.getLdapContext(LdapRgyServer.java:171)
	at com.tivoli.pd.rgy.ldap.LdapRgyServer.getHandle(LdapRgyServer.java:1016)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.setupHandle(LdapRgyHandleMgr.java:744)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.access$500(LdapRgyHandleMgr.java:70)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr$JndiOperation.retryJndiOperation(LdapRgyHandleMgr.java:2442)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.searchAndFetch(LdapRgyHandleMgr.java:1646)
	at com.tivoli.pd.rgy.ldap.LdapRgyServerInfo.determineLdapServerType(LdapRgyServerInfo.java:1033)
	at com.tivoli.pd.rgy.ldap.LdapRgyServerInfo.configure(LdapRgyServerInfo.java:387)
	at com.tivoli.pd.rgy.ldap.LdapRgyFedServerMgr$FedServer.configure(LdapRgyFedServerMgr.java:360)
	at com.tivoli.pd.rgy.ldap.LdapRgyFedServerMgr.configure(LdapRgyFedServerMgr.java:587)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.configure(LdapRgyHandleMgr.java:339)
	at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.configure(LdapRgyRegistry.java:228)
	at com.tivoli.pd.rgy.ldap.LdapRgyRegistryFactory.getLdapRgyRegistryInstance(LdapRgyRegistryFactory.java:54){noformat}

{noformat}[6/8/23, 17:16:53:338 EDT] 0000069c id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyServer                         3 getLdapContext CATCH
javax.naming.AuthenticationException: [LDAP: error code 49 - Invalid Credentials]
	at java.naming/com.sun.jndi.ldap.LdapCtx.mapErrorCode(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapCtx.processReturnCode(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapCtx.processReturnCode(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapCtx.connect(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapCtx.<init>(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapCtxFactory.getLdapCtxFromUrl(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapCtxFactory.getUsingURL(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapCtxFactory.getUsingURLs(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapCtxFactory.getLdapCtxInstance(Unknown Source)
	at java.naming/com.sun.jndi.ldap.LdapCtxFactory.getInitialContext(Unknown Source)
	at org.apache.aries.jndi.ContextHelper.getInitialContextUsingBuilder(ContextHelper.java:199)
	at org.apache.aries.jndi.ContextHelper.getContextProvider(ContextHelper.java:160)
	at org.apache.aries.jndi.ContextHelper.getInitialContext(ContextHelper.java:120)
	at org.apache.aries.jndi.OSGiInitialContextFactoryBuilder.getInitialContext(OSGiInitialContextFactoryBuilder.java:45)
	at java.naming/javax.naming.spi.NamingManager.getInitialContext(Unknown Source)
	at java.naming/javax.naming.InitialContext.getDefaultInitCtx(Unknown Source)
	at java.naming/javax.naming.InitialContext.init(Unknown Source)
	at java.naming/javax.naming.ldap.InitialLdapContext.<init>(Unknown Source)
	at com.tivoli.pd.rgy.ldap.LdapRgyServer.getLdapContext(LdapRgyServer.java:441)
	at com.tivoli.pd.rgy.ldap.LdapRgyServer.getLdapContext(LdapRgyServer.java:230)
	at com.tivoli.pd.rgy.ldap.LdapRgyServer.getLdapContext(LdapRgyServer.java:171)
	at com.tivoli.pd.rgy.ldap.LdapRgyServer.getHandle(LdapRgyServer.java:1016)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.setupHandle(LdapRgyHandleMgr.java:744)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.access$500(LdapRgyHandleMgr.java:70)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr$JndiOperation.retryJndiOperation(LdapRgyHandleMgr.java:2442)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.searchAndFetch(LdapRgyHandleMgr.java:1646)
	at com.tivoli.pd.rgy.ldap.LdapRgyServerInfo.determineLdapServerType(LdapRgyServerInfo.java:1033)
	at com.tivoli.pd.rgy.ldap.LdapRgyServerInfo.configure(LdapRgyServerInfo.java:387)
	at com.tivoli.pd.rgy.ldap.LdapRgyFedServerMgr$FedServer.configure(LdapRgyFedServerMgr.java:360)
	at com.tivoli.pd.rgy.ldap.LdapRgyFedServerMgr.configure(LdapRgyFedServerMgr.java:587)
	at com.tivoli.pd.rgy.ldap.LdapRgyHandleMgr.configure(LdapRgyHandleMgr.java:339)
	at com.tivoli.pd.rgy.ldap.LdapRgyRegistry.configure(LdapRgyRegistry.java:228)
	at com.tivoli.pd.rgy.ldap.LdapRgyRegistryFactory.getLdapRgyRegistryInstance(LdapRgyRegistryFactory.java:54)
	at com.ibm.security.access.user.UserLookupUtil.getRegistry(UserLookupUtil.java:171)
	at com.ibm.security.access.user.UserLookupHelper.search(UserLookupHelper.java:763){noformat}

Can get the error if you run ulhSearch.shutdown before ulhAuth.init calls about invalid crews.
setHandle - has the previous handle that it uses to search ",09/Jun/23 10:00 AM;5bac25aaabfcbf73d13e733b;That was my suggestion as well when discussing with coworkers. I figured that if the first one was shutdown earlier it’d work as expected.,"09/Jun/23 10:02 AM;5bac25aaabfcbf73d13e733b;To be clear though, if shutdown is not called before you attempt to initiate again then the init() call really doesn’t work as expected and update the credentials correct?","09/Jun/23 10:03 AM;5af4ad7d4dd24c579110120b;[~accountid:5bac25aaabfcbf73d13e733b] if shutdown is called before the other init with invalid creds ,  search with that object returns invalid credentials 

I see the behaviour ","09/Jun/23 10:33 PM;5c87cb8d88f9ec6ae0afb306;So, in the pega mapping rule, they do: 

{{ulhSearch.init}}
{{ulhSearch.search}}
{{ulhAuth.init}}
{{ulhAuth.search}}
{{ulhSearch.search}}


So, they would need to do: 
{{ulhSearch.init}}
{{ulhSearch.search}}

ulhSearch.shutdown


{{ulhAuth.init}}
{{ulhAuth.search}}


ulhAuth.shutdown
ulhSearch.init


{{ulhSearch.search}}


ulhSearch.shutdown",10/Jun/23 6:55 AM;5af4ad7d4dd24c579110120b;[~accountid:5c87cb8d88f9ec6ae0afb306] yea,"14/Jun/23 3:02 AM;5b15d9936d76184b7d989c82;[~accountid:5af4ad7d4dd24c579110120b] we provided the suggested mapping rule updates to the customer rep… and did ask the customer rep to test and relay the results… but the customer rep also added this to their response:

----

*Is that a work-around for this issue? Shouldn't the ulhAuth.init be using a refresh set of credentials instead of the cache session's? This worked in 9.0.6 but not 10.0.x*

----

so the customer is looking to confirm whether there was some code change that now requires use of the shutdown calls (and applicable documentation update) or if the requirement for the shutdown calls is maybe an unexpected side-effect of some code changes in the ULH somewhere between 9.0.6 and 10.0.4 (i.e. a defect)","20/Jun/23 1:48 PM;5af4ad7d4dd24c579110120b;<Notes>

Difference in 9060 and 10070 trace - 

{{com.tivoli.pd.rgy.ldap.LdapRgyRegistry                       < LdapRgyRegistry RETURN}}

com.ibm.security.access.user.UserLookupUtil                  I getRegistry com.tivoli.pd.rgy.exception.ConfigurationErrorRgyException: HPDAA0333E   Unable to determine the registry server type.  Error message HPDAA0329E   The credentials provided can not be authenticated by the registry.. 

VS

{{com.ibm.security.access.user.UserLookupUtil                  < getRegistry RETURN com.tivoli.pd.rgy.ldap.LdapRgyRegistry@5ef30c69}}

9060 - 

{noformat}com.ibm.security.access.user.UserLookupHelperStore$UserLookupHelperStoreCache from version 1687144058592.
[6/18/23 23:15:33:505 EDT] 00000385 id=00000000 com.tivoli.am.fim.om.ObjectManager$Configuration             < getObject(Class<C>) RETURN
[6/18/23 23:15:33:505 EDT] 00000385 id=00000000 com.tivoli.am.fim.om.ObjectManager                           < get(Class<C>) RETURN
[6/18/23 23:15:33:505 EDT] 00000385 id=00000000 com.ibm.security.access.user.UserLookupHelperStore           > storeUtil ENTRY
[6/18/23 23:15:33:505 EDT] 00000385 id=00000000 com.ibm.security.access.user.UserLookupHelper                < init RETURN com.ibm.security.access.user.UserLookupUtil@628f3de
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY  ASHA00 |PEGA| try to find testuser
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils < traceString RETURN
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.ibm.security.access.user.UserLookupHelper                > search ENTRY cn testuser 1 0
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.ibm.security.access.user.UserLookupUtil                  > getRegistry ENTRY
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyRegistry                       < LdapRgyRegistry RETURN
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyRegistry                       > configure ENTRY
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo                     > configure ENTRY
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo                     C configure ldap.novell-suffix-search-enabled = false
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo                     C configure ldap.ignore-suffix = 
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo                     C configure ldap.suffix-trigger-count = 10
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo                     C configure ldap.suffix-max-iterations = -1
[6/18/23 23:15:33:506 EDT] 00000385 id=00000000 com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo                     C configure ldap.suffix-ordering = 0{noformat}

10070 - 

{noformat}[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.ibm.security.access.user.UserLookupHelper                < init RETURN com.ibm.security.access.user.UserLookupUtil@f5c4c322
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils > traceString ENTRY  ASHA00 |PEGA| try to find testuser
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 om.tivoli.am.fim.trustserver.sts.utilities.IDMappingExtUtils < traceString RETURN
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.ibm.security.access.user.UserLookupHelper                > search ENTRY cn testuser 1 0
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.ibm.security.access.user.UserLookupUtil                  > getRegistry ENTRY
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.ibm.security.access.user.UserLookupUtil                  < getRegistry RETURN com.tivoli.pd.rgy.ldap.LdapRgyRegistry@5ef30c69
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyRegistry                       > listNativeUsers ENTRY cn testuser 1
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyEntityMgr                      > listNativeEntities ENTRY
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo                     > get ENTRY
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgySuffixInfo                     < get RETURN
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyEntityMgr                      < listNativeEntities RETURN
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyRegistry                       < listNativeUsers RETURN
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyListIterator                   > hasNext ENTRY
[6/18/23, 23:10:42:800 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyListIterator                   > hasNextInternal ENTRY
[6/18/23, 23:10:42:801 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyListIterator                   > getNextSearchEnumeration ENTRY
[6/18/23, 23:10:42:801 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyNativeListIterator             > getFilter ENTRY
[6/18/23, 23:10:42:801 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyUserMgr                        > getNativeEntityFilterPattern ENTRY
[6/18/23, 23:10:42:801 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyUserMgr                        < getNativeEntityFilterPattern RETURN (&(objectclass=*)(cn=testuser))
[6/18/23, 23:10:42:801 EDT] 0000002a id=00000000 com.tivoli.pd.rgy.ldap.LdapRgyNativeListIterator             < getFilter RETURN (&(objectclass=*)(cn=testuser))
[6{noformat}



Todo - 

This change was made as a fix for - APAR  IJ39126 which changes the reg object that the handle gets was changed to static since having multiple reg objects spawn was causing a leak.
[https://cloudidentity.atlassian.net/browse/ISAMSUP-4029|https://cloudidentity.atlassian.net/browse/ISAMSUP-4029|smart-link]  

But there was also another change that was made- if a customer is using the same rgy details, they should be getting the same UserLookupUtil class - 
[+https://github.ibm.com/ISAM/isam/commit/3a7139a88099babb804f044f8b97e394a5464b0d+|https://github.ibm.com/ISAM/isam/commit/3a7139a88099babb804f044f8b97e394a5464b0d]
[https://github.ibm.com/ISAM/isam/commit/8830f00e784a7a5bffa983644708cb83c68efa13|https://github.ibm.com/ISAM/isam/commit/8830f00e784a7a5bffa983644708cb83c68efa13]
ISAMDEV-6935 

Hence I am changing UserLookupUtil.java -  
private static RgyRegistry reg; 
to 
private RgyRegistry reg;

I did reload runtime a few times between 1000 requests and did not see the thread leak.","20/Jun/23 2:41 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9936d76184b7d989c82] 

Does the customer have any IF’s or fix packs installed on 10.0.4.0? 
I did not see that info in the support files on ecurep.

There were a couple of changes made in this space between 10040 and 10050, I’m trying to narrow down my test case. so I need to know if the customer has any IF’s.

Thanks
","21/Jun/23 6:03 AM;5b15d9936d76184b7d989c82;[~accountid:5af4ad7d4dd24c579110120b] I ping’d the customer to ask whether they have any fixpacks installed… the customer responded with:

“We have 10.0.4.0_IF1 installed.”","21/Jun/23 2:33 PM;5af4ad7d4dd24c579110120b;[~accountid:5b15d9936d76184b7d989c82] 

Here is a fix pack for 10040IF1 -

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5152|https://cloudidentity.atlassian.net/browse/ISAMSUP-5152|smart-link] 

This should log this error in the trace for the ulhAuth.search -

{noformat}com.ibm.security.access.user.UserLookupUtil                  I getRegistry com.tivoli.pd.rgy.exception.ConfigurationErrorRgyException: HPDAA0333E   Unable to determine the registry server type.  Error message HPDAA0329E   The credentials provided can not be authenticated by the registry..{noformat}

Let me know if that works.
Also validate if there any performance impacts , threads or memory increase.","22/Jun/23 7:27 AM;5b15d950d9936c61022057fe;[~accountid:5af4ad7d4dd24c579110120b]  I am concerned that this fix appears to undo the entirety changes from [https://cloudidentity.atlassian.net/browse/ISAMSUP-4029|https://cloudidentity.atlassian.net/browse/ISAMSUP-4029|smart-link] 

The commit that you listed [https://github.ibm.com/ISAM/isam/commit/8830f00e784a7a5bffa983644708cb83c68efa13|https://github.ibm.com/ISAM/isam/commit/8830f00e784a7a5bffa983644708cb83c68efa13]  appears to have defects in that it as the if statement has no point since it still has an assignment right below the if. 
I don’t think there should be the second assignments outside of the if statement. 


In the testing that you did with the reload between 1000 requests were you calling a mapping rule that created a new UserLookupHelp and init it and used it?  

If I recall from my testing It had to be a full use in the mapping rule inorder to trigger the buildup of threads in the javacores","22/Jun/23 7:42 AM;5b15d950d9936c61022057fe;Were you also testing with different mgmtdomains?  As it looks like it could still cause an issue as the ulh.init(myLDAPConnection, ""Default""); and ulh.init(myLDAPConnection, ""Users""); appear that they too would cause issues as the userLookupUtil appears to be different for each domain specified. 
The same goes for loginfailuer persistence.   These all seem to require unique instances of the userLookupUtil

Maybe also as a safety measure add some debug logging to UserLookupHelperStore to keep trace of the cached map, which I’m also not sure is thread safe.","22/Jun/23 11:55 AM;5af4ad7d4dd24c579110120b;<Notes>

[https://github.ibm.com/ISAM/isam/commit/8830f00e784a7a5bffa983644708cb83c68efa13|https://github.ibm.com/ISAM/isam/commit/8830f00e784a7a5bffa983644708cb83c68efa13]
Deleted the additional assignment of getId outside of if else. Line 311 - this.lookupKey = connection.getId();

Test1: 

ran with multi domain searches dc=iswga and dc=newibm 

Reload AACfed..  multiple times at every 20 requests 

Cant see any leak.. 
Todo - 
  will rerun tests with ULH store cache debug added.
  userLookupUtil - add debug in rgy api - 
  check rgyAPI store implementation with lookup key - rgyID + (maybe something else unique from property) - get and set with a concurrent hash map - 




Myref - 
With static rgy object 

{noformat}~ # cat /proc/25721/status | grep Thread
Threads:	61
~ # cat /proc/25721/status | grep Thread
Threads:	61
~ # cat /proc/25721/status | grep Thread
Threads:	61{noformat}

Without static rgy object

{noformat} # cat /proc/28308/status | grep Thread
Threads:	59
~ # cat /proc/28308/status | grep Thread
Threads:	81
~ # cat /proc/28308/status | grep Thread
Threads:	85
{noformat}

{noformat}NULL           ------------------------------------------------------------------------
0SECTION       THREADS subcomponent dump routine
NULL           =================================
NULL
1XMPOOLINFO    JVM Thread pool info:
2XMPOOLTOTAL       Current total number of pooled threads: 81
2XMPOOLLIVE        Current total number of live threads: 76
2XMPOOLDAEMON      Current total number of live daemon threads: 72{noformat}","23/Jun/23 2:19 PM;5af4ad7d4dd24c579110120b;{noformat}<>
static rgy - doesnt cause thread leak but uses same rgy so colludes searches.
even if we use the rgyhelper store it wont solve the issue of threads since this will create new
threads for new searches.
LdapRgyRegistry.java might be the source that needs to be investigated and call close somewhere 
in the chain to clean up the thread after search/for the life of UserLookupHelperUtil object.

[6/22/23, 22:35:27:204 EDT] 0000003d id=00000000 com.ibm.security.access.user.UserLookupHelper                > search ENTRY cn testuser 1 0
[6/22/23, 22:35:27:204 EDT] 0000003d id=00000000 com.ibm.security.access.user.UserLookupHelper                1 search ASHA11111 ULHUtil com.ibm.security.access.user.UserLookupUtil@4da365bc
[6/22/23, 22:35:27:204 EDT] 0000003d id=00000000 com.ibm.security.access.user.UserLookupUtil                  > getRegistry ENTRY
[6/22/23, 22:35:27:204 EDT] 0000003d id=00000000 com.ibm.security.access.user.UserLookupUtil                  1 getRegistry ASHA1111 In ELSE getRegistry
[6/22/23, 22:35:27:204 EDT] 0000003d id=00000000 com.ibm.security.access.user.UserLookupUtil                  1 getRegistry ASHA1111 In ELSE rgyProperties {ldap.user-search-filter=(objectclass=*), ldap.login-failures-persistent=false, ldap.svrs=10.160.20.200:389:readwrite:10, ldap.bind-pwd=Idontknowpassword, ldap.ssl-enable=false, ldap.bind-dn=uid=testuser,cn=newibm, mgmt_domain=cn=newibm, ldap.connection-inactivity=10}


[6/22/23, 22:35:27:114 EDT] 0000003d id=00000000 com.ibm.security.access.user.UserLookupHelper                1 search ASHA11111 ULHUtil com.ibm.security.access.user.UserLookupUtil@5a27bbc4
[6/22/23, 22:35:27:114 EDT] 0000003d id=00000000 com.ibm.security.access.user.UserLookupUtil                  > getRegistry ENTRY
[6/22/23, 22:35:27:114 EDT] 0000003d id=00000000 com.ibm.security.access.user.UserLookupUtil                  1 getRegistry ASHA1111 In If getRegistry
[6/22/23, 22:35:27:115 EDT] 0000003d id=00000000 com.ibm.security.access.user.UserLookupUtil                  1 getRegistry ASHA1111 In IFF rgyProperties {ldap.user-search-filter=(objectclass=*), ldap.login-failures-persistent=false, ldap.svrs=10.160.20.200:389:readwrite:10, ldap.bind-pwd=Coastcmuq, ldap.ssl-enable=false, ldap.bind-dn=cn=root, mgmt_domain=cn=newibm, ldap.connection-inactivity=10}{noformat}

{noformat}~ # ps -ef | grep java
 4279 www-data 41:23 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Djava.security.properties=/opt/IBM/wlp/usr/servers/default/java.security -Xbootclasspath/a:/opt/pdjrte/java/export/rgy/com.tivoli.pd.rgy.jar:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar -Dorg.osgi.framework.system.packages.extra=com.tivoli.pd.rgy,com.tivoli.pd.rgy.authz,com.tivoli.pd.rgy.exception,com.tivoli.pd.rgy.ldap,com.tivoli.pd.rgy.nls,com.tivoli.pd.rgy.util,com.ibm.misc,com.ibm.net.ssl.www2.protocol.https,com.sun.jndi.ldap,org.apache.xml.serialize -Dhttps.protocols=TLSv1.2 --add-exports java.base/sun.security.action=ALL-UNNAMED --add-exports java.naming/com.sun.jndi.ldap=ALL-UNNAMED --add-exports java.naming/com.sun.jndi.url.ldap=ALL-UNNAMED --add-exports java.security.jgss/sun.security.krb5.internal=ALL-UNNAMED --add-exports jdk.attach/sun.tools.attach=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMED --add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.util.concurrent=ALL-UNNAMED --add-opens java.base/java.io=ALL-UNNAMED --add-opens java.naming/javax.naming.spi=ALL-UNNAMED --add-opens jdk.naming.rmi/com.sun.jndi.url.rmi=ALL-UNNAMED --add-opens java.naming/javax.naming=ALL-UNNAMED --add-opens java.rmi/java.rmi=ALL-UNNAMED --add-opens java.sql/java.sql=ALL-UNNAMED --add-opens java.management/javax.management=ALL-UNNAMED --add-opens java.base/java.lang.reflect=ALL-UNNAMED --add-opens java.desktop/java.awt.image=ALL-UNNAMED --add-opens java.base/java.security=ALL-UNNAMED --add-opens java.base/java.net=ALL-UNNAMED --add-opens java.base/java.text=ALL-UNNAMED --add-opens java.base/sun.net.www.protocol.https=ALL-UNNAMED --add-exports jdk.management.agent/jdk.internal.agent=ALL-UNNAMED --add-exports java.base/jdk.internal.vm=ALL-UNNAMED -jar /opt/IBM/wlp/bin/tools/ws-server.jar default --clean
13496 root      0:00 grep java
25988 www-data  5h41 /opt/java/jre/bin/java -javaagent:/opt/IBM/wlp/bin/tools/ws-javaagent.jar -Djava.awt.headless=true -Djdk.attach.allowAttachSelf=true -Xms2048m -Xmx2048m -Dcom.sun.security.enableCRLDP=true -Dsun.net.inetaddr.ttl=30 -Dcom.sun.jndi.ldap.object.disableEndpointIdentification=true -Dcom.ibm.security.enableNULLCRLDP=true -Dorg.osgi.framework.system.packages.extra=com.ibm.misc,com.ibm.net.ssl.www2.protocol.https,com.sun.jndi.ldap,org.apache.xml.serialize -Xbootclasspath/a:/opt/ibm/wlp/usr/servers/runtime/lib/global/xercesImpl.jar --add-exports java.base/sun.security.action=ALL-UNNAMED --add-exports java.naming/com.sun.jndi.ldap=ALL-UNNAMED --add-exports java.naming/com.sun.jndi.url.ldap=ALL-UNNAMED --add-exports java.security.jgss/sun.security.krb5.internal=ALL-UNNAMED --add-exports jdk.attach/sun.tools.attach=ALL-UNNAMED --add-opens java.base/java.util=ALL-UNNAMED --add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.util.concurrent=ALL-UNNAMED --add-opens java.base/java.io=ALL-UNNAMED --add-opens java.naming/javax.naming.spi=ALL-UNNAMED --add-opens jdk.naming.rmi/com.sun.jndi.url.rmi=ALL-UNNAMED --add-opens java.naming/javax.naming=ALL-UNNAMED --add-opens java.rmi/java.rmi=ALL-UNNAMED --add-opens java.sql/java.sql=ALL-UNNAMED --add-opens java.management/javax.management=ALL-UNNAMED --add-opens java.base/java.lang.reflect=ALL-UNNAMED --add-opens java.desktop/java.awt.image=ALL-UNNAMED --add-opens java.base/java.security=ALL-UNNAMED --add-opens java.base/java.net=ALL-UNNAMED --add-opens java.base/java.text=ALL-UNNAMED --add-opens java.base/sun.net.www.protocol.https=ALL-UNNAMED --add-exports jdk.management.agent/jdk.internal.agent=ALL-UNNAMED --add-exports java.base/jdk.internal.vm=ALL-UNNAMED -Disam.appliance=true -jar /opt/IBM/wlp/bin/tools/ws-server.jar runtime --clean
~ # cat /proc/25988/status | grep Thread
Threads:	113
~ # date
Mon Jun 26 20:30:17 EDT 2023
<100 infomap requests >
~ # cat /proc/25988/status | grep Thread
Threads:	214{noformat}",27/Jun/23 11:18 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please confirm if you have been able to create a memory leak while investigating this issue. I am just wanting to understanding if this is something that we need to consider for other customers reporting similar issues. ,"27/Jun/23 11:29 AM;5af4ad7d4dd24c579110120b;[~accountid:5ac57757d9a96536d1f0daa9] 

Yes, this result is from my test environment - 
Runtime process id - {{25988}}
{{~ # cat /proc/25988/status | grep Thread }}
{{Threads: 113 }}

{{# date Mon Jun 26 20:30:17 EDT 2023 }}
{{<100 infomap requests > ~ }}

{{# cat /proc/25988/status | grep Thread }}
{{Threads: 214}}
","27/Jun/23 11:53 AM;5af4ad7d4dd24c579110120b;<Notes>

This has 2 mutually exclusive issues here -

# Thread Leak -
src/i4m/fim/com.ibm.security.access.common/src/com/ibm/security/access/user/UserLookupUtil.java 
private RgyRegistry reg; to private static RgyRegistry reg;
resolves thread leak but poses another issue - Issue 2
# Refresh creds between inits -
If there're multiple userlookuphelper inits, if first one has valid creds and the second one doesnt have valid creds, the second user look up helper still uses the reg handler created from previous init to search.

Spoke to jasmine smith and she suggested this is better handled as a defect in dev stream so they can go over the other caching issues. Hence creating a dev defect. 


This has 2 mutually exclusive issues here -
+*Steps to recreate issue with refresh creds -*+ 
Configure runtime
Configure Runtime 
Configure RP
Configure AAC on /mga
Create a Server Connection to remote LDAP Server
Create a new authentication policy infomaptest1 
Update mapping rule to attached infomap_username.js (update remote connection name and creds)
Create user testuser1 
Set trace level to -_=info:com.ibm.security.access._=ALL:com.tivoli.am.fim._=ALL:com.tivoli.pd._=ALL
Access [https://<RP>/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1|https://10.160.21.22/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1] 
Check {{ulhAuth.search}} still works with invalid credentials. 

+*Steps to recreate issue with thread leak -*+ 
Update code to change private static RgyRegistry reg; to private RgyRegistry reg; in UserLookupUtil.java 
Update the jar on the appliance /opt/IBM/wlp/usr/extension/lib/isam/common/com.ibm.security.access.common_8.0.0.jar
Restart RUntime
Check java process id for runtime
Check thread count for java process id 
Send 100 requests of [https://<RP>/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1|https://10.160.21.22/mga/sps/authsvc?PolicyId=urn:ibm:security:authentication:asf:infomaptest1]  
Check thread count increase for java process id 

Defect id- [https://cloudidentity.atlassian.net/browse/ISAMDEV-10359|https://cloudidentity.atlassian.net/browse/ISAMDEV-10359|smart-link] ","12/Jul/23 6:25 AM;5b15d9936d76184b7d989c82;[~accountid:5af4ad7d4dd24c579110120b] ulh_init_refreshcreds_10040IF1.fixpack was provided to the customer rep on June 21st… the rep was out of the office for a period, but has returned…. I have asked the customer to let me know whether they have done testing with the fixpack (and if so, to confirm results)… I am waiting on feedback from them… I will update the Jira with the customer’s results once I have them… 

the customer did ask whether the fix will be included in upcoming (standard) fixpacks for their release… I relayed that code fixes are typically made initially to the latest version, and then back-ported based on need/requests… I did not indicate either way whether the fix will be folded into the code stream for certain… from the Jira updates, I see that there have been additional discussions and testing… ","12/Jul/23 2:14 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5b15d9936d76184b7d989c82] 

This fixpack should address their issue for ULH credentials not initialised inbetween the searches when there are multiple inits. 
But there is also another issue of thread leak when this is fixed.
Option1 - They can use this fixpack to address their issue and monitor that they don't get into the thread leak situation
Option2 - Call shutdown between two ULH inits so they don't get mixed up 

To address the underlying mutually exclusive issue I have reported to dev and this will be reviewed and addressed in the next release as a dev item not APAR.

Let me know if this clarifies.

Thanks",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
After Renewal of hdqamw1m1 cert faced some Errors related to routing tables (Static Routes),ISAMSUP-5122,304970,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,,Bill Tyler,5b15d94b6256d01ad54eb020,oscar.jimen,6333216f748d1bfcb85982ca,oscar.jimen,6333216f748d1bfcb85982ca,06/Jun/23 3:13 AM,13/Jul/23 11:51 PM,14/Jul/23 2:47 PM,,,,,0,,,,"*Problem Description:*
Hi Team, We have a webseal certificate -hdqamw1m1 which is expiring on March 20th [2023.So|https://2023.so/] we have renewed the certificate after giving the commands we seen Error, it was stuck and ended it with Ctrl+C. Even though the certificate has been updated . 

Can you Please check why is the Error getting is there any issue . 

This is the error hdqamw1m1:lmi> reset_lmi_cert Enter 'YES' to confirm: YES 

Error: argument ""8346099c-fff5-11e4-8b17-4b8cff5e0b74 "" is wrong: invalid table ID 

Error: argument ""83460a0a-fff5-11e4-8b17-4b8cff5e0b74 "" is wrong: invalid table ID 

Error: argument ""834608c0-fff5-11e4-8b17-4b8cff5e0b74 "" is wrong: invalid table ID

Error: argument ""834603d4-fff5-11e4-8b17-4b8cff5e0b74 "" is wrong: invalid table ID 

RTNETLINK answers: File exists RTNETLINK answers: File exists RTNETLINK answers: File exists RTNETLINK answers: File exists RTNETLINK answers: File exists ^Chdqamw1m1:lmi> hdqamw1m1:lmi>



From L2 I found the following 

Using LMI, Rest API, and CLI I found the following information regarding this static routes (table routes) information:

These are the Static routes that the customer have:

1.{
  ""staticRoutes"": [{
    ""enabled"": true,
    ""address"": ""default"",
    ""maskOrPrefix"": null,
    ""gateway"": ""10.243.0.1"",
    ""interfaceUUID"": null,
    ""metric"": 0,
    ""table"": ""main"",
    ""uuid"": ""83460456-fff5-11e4-8b17-4b8cff5e0b74"",
    ""objType"": ""staticRoute"",
    ""comment"": null
 2. }, {
    ""enabled"": true,
    ""address"": ""10.0.0.0"",
    ""maskOrPrefix"": ""8"",
    ""gateway"": ""10.243.0.1"",
    ""interfaceUUID"": ""8346029e-fff5-11e4-8b17-4b8cff5e0b74"",
    ""metric"": 0,
    ""table"": ""main"",
    ""uuid"": ""e9c50bd2-080f-474f-8303-1eda846addb6"",
    ""objType"": ""staticRoute"",
    ""comment"": null
  3.}, {
    ""enabled"": true,
    ""address"": ""default"",
    ""maskOrPrefix"": null,
    ""gateway"": ""10.243.0.1"",
    ""interfaceUUID"": ""834608fc-fff5-11e4-8b17-4b8cff5e0b74"",
    ""metric"": 0,
    ""table"": ""8346092e-fff5-11e4-8b17-4b8cff5e0b74"",
    ""uuid"": ""3fc815fd-cb83-4f6e-aa38-a24382e10b1b"",
    ""objType"": ""staticRoute"",
    ""comment"": null

*These are the static routes who has Problem with LMI cert:*

4.}, {
""enabled"": true,
""address"": ""default"",
""maskOrPrefix"": null,
""gateway"": ""10.243.0.1"",
""interfaceUUID"": ""8346096a-fff5-11e4-8b17-4b8cff5e0b74"",
""metric"": 0,
""table"": ""*8346099c-fff5-11e4-8b17-4b8cff5e0b74*"",
""uuid"": ""3d684f94-0abb-418e-b5a0-ae3f269d5c79"",
""objType"": ""staticRoute"",
""comment"": null

5.}, {
""enabled"": true,
""address"": ""default"",
""maskOrPrefix"": null,
""gateway"": ""10.243.0.1"",
""interfaceUUID"": ""834609d8-fff5-11e4-8b17-4b8cff5e0b74"",
""metric"": 0,
""table"": ""*83460a0a-fff5-11e4-8b17-4b8cff5e0b74*"",
""uuid"": ""445538d2-f565-409a-a6ef-77ad8e2e1013"",
""objType"": ""staticRoute"",
""comment"": null
6.}, {
""enabled"": true,
""address"": ""default"",
""maskOrPrefix"": null,
""gateway"": ""10.243.0.1"",
""interfaceUUID"": ""8346087a-fff5-11e4-8b17-4b8cff5e0b74"",
""metric"": 0,
""table"": ""*834608c0-fff5-11e4-8b17-4b8cff5e0b74*"",
""uuid"": ""c512c3a7-e6bc-4acd-b306-7f7a5c289389"",
""objType"": ""staticRoute"",
""comment"": null

7.}, {
""enabled"": true,
""address"": ""default"",
""maskOrPrefix"": null,
""gateway"": ""10.243.0.1"",
""interfaceUUID"": ""8346029e-fff5-11e4-8b17-4b8cff5e0b74"",
""metric"": 0,
""table"": ""*834603d4-fff5-11e4-8b17-4b8cff5e0b74*"",
""uuid"": ""f475d6ef-0571-41a9-99d8-e8fbbf200ce8"",
""objType"": ""staticRoute"",
""comment"": null
}]
}

h1. *Interface configuration*



*4.Routing table*
Error: argument ""*8346099c-fff5-11e4-8b17-4b8cff5e0b74* "" is wrong: invalid table ID 

gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.label     = 1.5
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.name      = P.3
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.enabled   = true
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.type      = physical
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.mtu       = 1500
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.bonding_mode = none

gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.link_mode = Auto
    # Ipv4 configuration
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.dhcp4.enabled = false
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.addr4.*8346099c-fff5-11e4-8b17-4b8cff5e0b74*.addr           = 10.243.0.60
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.addr4.*8346099c-fff5-11e4-8b17-4b8cff5e0b74*.mask_or_prefix = 255.255.254.0
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.addr4.*8346099c-fff5-11e4-8b17-4b8cff5e0b74*.broadcast      =
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.addr4*.8346099c-fff5-11e4-8b17-4b8cff5e0b74*.mgmt           = false
gw_net.if.8346096a-fff5-11e4-8b17-4b8cff5e0b74.addr4.*8346099c-fff5-11e4-8b17-4b8cff5e0b74*.is_primary     = false
    # end Ipv4 configuration

*5.Routing table*
Error: argument ""*83460a0a-fff5-11e4-8b17-4b8cff5e0b74* "" is wrong: invalid table ID 

Interface configuration

gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.label     = 1.6
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.name      = P.4
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.enabled   = true
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.type      = physical
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.mtu       = 1500
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.bonding_mode = none

gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.link_mode = Auto
    # Ipv4 configuration
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.dhcp4.enabled = false
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.addr4.*83460a0a-fff5-11e4-8b17-4b8cff5e0b74*.addr           = 10.243.0.66
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.addr4.*83460a0a-fff5-11e4-8b17-4b8cff5e0b74*.mask_or_prefix = 255.255.254.0
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.addr4.*83460a0a-fff5-11e4-8b17-4b8cff5e0b74*.broadcast      =
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.addr4.*83460a0a-fff5-11e4-8b17-4b8cff5e0b74*.mgmt           = false
gw_net.if.834609d8-fff5-11e4-8b17-4b8cff5e0b74.addr4.*83460a0a-fff5-11e4-8b17-4b8cff5e0b74*.is_primary     = false
    # end Ipv4 configuration



*6.Routing table*
*Error: argument ""834608c0-fff5-11e4-8b17-4b8cff5e0b74 "" is wrong: invalid table ID*

Interface configuration

gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.label     = 1.3
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.name      = P.1
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.enabled   = true
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.type      = physical
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.mtu       = 1500
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.bonding_mode = none

gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.link_mode = Auto
    # Ipv4 configuration
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.dhcp4.enabled = false
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834608c0-fff5-11e4-8b17-4b8cff5e0b74*.addr           = 10.243.0.58
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834608c0-fff5-11e4-8b17-4b8cff5e0b74*.mask_or_prefix = 255.255.254.0
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834608c0-fff5-11e4-8b17-4b8cff5e0b74*.broadcast      =
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834608c0-fff5-11e4-8b17-4b8cff5e0b74*.mgmt           = false
gw_net.if.8346087a-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834608c0-fff5-11e4-8b17-4b8cff5e0b74*.is_primary     = false
    # end Ipv4 configuration

*Routing table*
*Error: argument ""834603d4-fff5-11e4-8b17-4b8cff5e0b74 "" is wrong: invalid table ID* 

Interface configuration

gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.label     = 1.1
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.name      = M.1
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.enabled   = true
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.type      = physical
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.mtu       = 1500
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.bonding_mode = none

gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.link_mode = Auto
    # Ipv4 configuration
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.dhcp4.enabled = false
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834603d4-fff5-11e4-8b17-4b8cff5e0b74*.addr           = 10.243.0.57
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834603d4-fff5-11e4-8b17-4b8cff5e0b74*.mask_or_prefix = 255.255.254.0
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834603d4-fff5-11e4-8b17-4b8cff5e0b74*.broadcast      =
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834603d4-fff5-11e4-8b17-4b8cff5e0b74*.mgmt           = true
gw_net.if.8346029e-fff5-11e4-8b17-4b8cff5e0b74.addr4.*834603d4-fff5-11e4-8b17-4b8cff5e0b74*.is_primary     = false
    # end Ipv4 configuration

How can we modify/change or edit these wrong routing tables from static routes above? Now, if we can change the wrong value of the table ID, from where we can get/have the correct table ID value to change it?

I used the following documentation:

REST API: Creating a static route

[https://www.ibm.com/docs/en/sva/10.0.1?topic=developing-rest-api-documentation|https://www.ibm.com/docs/en/sva/10.0.1?topic=developing-rest-api-documentation|smart-link] 

Command-line interface: The following example shows the options available under the *routes* menu.

[https://www.ibm.com/docs/en/sva/10.0.4?topic=appliance-command-line-interface|https://www.ibm.com/docs/en/sva/10.0.4?topic=appliance-command-line-interface|smart-link] 

!image-20230605-170129.png|width=840,height=930!

!image-20230605-170201.png|width=905,height=775!

!image-20230605-170222.png|width=1858,height=647!

!image-20230605-170237.png|width=1483,height=541!

!image-20230605-170258.png|width=1285,height=527!

!image-20230605-170310.png|width=1339,height=529!

!image-20230605-170328.png|width=1312,height=537!

From the customer:

For the mentioned interfaces (10.243.0.58 , 10.243.0.59 , 10.243.0.60 , 10.243.0.66) we have instances actively connected in our appliance . This the instances connected to interfaces(10.243.0.58 -- eroomint, eroom, eroom1 , tfim , eroomint1 , consumer

10.243.0.59 -- hdnet , qasso, hdnetsapproject , hdnetba

10.243.0.60 -- hdds , Cert-Poc , hdsn ,

10.243.0.66 -- corporate, corphdaccess, corphdbrand, hdviewsso , corporatebrand , corphdsap , corpsapproject ). so it won't be possible to delete/ reset the static routes.",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,06/Jun/23 3:13 AM;6333216f748d1bfcb85982ca;image-20230605-170129.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204010,06/Jun/23 3:13 AM;6333216f748d1bfcb85982ca;image-20230605-170201.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204009,06/Jun/23 3:13 AM;6333216f748d1bfcb85982ca;image-20230605-170222.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204006,06/Jun/23 3:13 AM;6333216f748d1bfcb85982ca;image-20230605-170237.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204012,06/Jun/23 3:13 AM;6333216f748d1bfcb85982ca;image-20230605-170258.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204011,06/Jun/23 3:13 AM;6333216f748d1bfcb85982ca;image-20230605-170310.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204007,06/Jun/23 3:13 AM;6333216f748d1bfcb85982ca;image-20230605-170328.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204008,06/Jun/23 10:48 PM;6333216f748d1bfcb85982ca;image-20230606-124652.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204189,08/Jun/23 11:40 PM;6333216f748d1bfcb85982ca;image-20230608-134022.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/204815,27/Jun/23 1:26 AM;6333216f748d1bfcb85982ca;image-20230626-145632.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208428,27/Jun/23 1:26 AM;6333216f748d1bfcb85982ca;image-20230626-152214.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208429,27/Jun/23 2:06 AM;6333216f748d1bfcb85982ca;image-20230626-160552.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/208443,13/Jul/23 12:02 PM;6333216f748d1bfcb85982ca;image-20230713-020018.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/211008,13/Jul/23 12:02 PM;6333216f748d1bfcb85982ca;image-20230713-020037.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/211007,13/Jul/23 12:02 PM;6333216f748d1bfcb85982ca;image-20230713-020108.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/211009,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012471677,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,,"Harley-Davidson Motor Company, Inc.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1cf1j:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-05 20:56:19.344,,,,,"06/Jun/23 6:56 AM;5b15d94b6256d01ad54eb020;If you had a webseal certificate that was expired or was about to expire why did run:   reset_lmi_cert ?    What that does is reset the the appliance LMI certificate.  When you do that it requires a reboot.  That’s why you are getting errors, the process didn’t complete or wasn’t allowed to complete.

For a websela certificate you need to update the certificate in the webseal key file.   Web->Reverse Proxy-><instance name>Edit-> SSL","06/Jun/23 10:48 PM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] As far as I understand  {{reset_lmi_cert}} command regenerates a new LMI certificate. Reset the server certificate for the local management Interface.

When you do that it requires a reboot.? IDK if that require a reboot as a procedure. but after the customer apply this command  {{reset_lmi_cert}} via CLI the customer get immediately the error >> Error argument “*8346099c-fff5-11e4-8b17-4b8cff5e0b74*“ is wrong: invalid table ID. See the screenshot below:

!image-20230606-124652.png|width=685,height=755!",06/Jun/23 11:28 PM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca]   what certificate was expired or was going to expire?  in The description you said it was a webseal certifictae. rest_lmi_cert will do nothing to help you with that.,"08/Jun/23 11:40 PM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] Comment from the customer: “What certificate was expired or was going to expire?

LMI certificate is expired and we have renewed it.

Certificate name - hdqamw1m1

Attaching the certificate screenshot.”

!image-20230608-134022.png|width=1179,height=869!","09/Jun/23 12:07 AM;5b15d94b6256d01ad54eb020;Internal comment:

[~accountid:6333216f748d1bfcb85982ca]  that wasn’t clear from your description.   You mentioned webseal. There is a big difference.  Please remember to change the response due to L3  after you reply.   It’s easy to miss the notifications.",09/Jun/23 12:10 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] I will keep in mind. thx! Maybe just copy and paste.. I’m only have like 5 meses taking cases so there's some processes I still learning..,"09/Jun/23 12:13 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca] I know there is a lot going on.  Also remember to check with your senior L2 engineers, you’ll learn a lot from them.

I’ll take a look at this again today.",15/Jun/23 11:51 PM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] The customer is asking for an update?,22/Jun/23 12:21 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] Customer is asking for an update? ,"22/Jun/23 12:33 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca]   I was out two days last week so I don’t have a new update.  I’m playing catch up now.

One thing they could do is reset the routing table since they don’t have many entries.  Have you asked senior L2 engineers  to see if they have seen this before like I suggested?",23/Jun/23 8:29 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca]  I was looking this over again today and I think the best way to fix this is to reset the routes and re-enter them since there aren’t very many.   Not sure what caused this issue.  ,"27/Jun/23 1:26 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020]  Days ago. I tried the customer proceeds with reset. at that time the customer wants to have a meeting with me so I can guide him on how to do the reset. If something happens, I will be there to help. In the end, we decided not to continue because of the risk involved (and that's why I prefer to open this Jira to check if there is another way). So if this is the only way, then the customer will require to have the approval of management (as you can see below the network configuration: *""so it won't be possible to delete/ reset the static routes. for 10.243.0.66* ”) to do kind of with ""Maninance windows ""because when you proceed with reset of the interface. The interface gets back to the factory default, which causes the traffic down for that interface:

!image-20230626-145632.png|width=486,height=78!

This operation is very risky... So, In this case, we need to check with the customer if he wants to proceed first and second if the customer agrees to proceed with the reset since he already said NO, for 10.243.0.60; so if they say yes, they probably want to have a meeting to proceed with the reset. So I will need to have [~accountid:5b15d9e6dda5f94d06b985b4]  at the meeting because something comes across with reset. I will need someone with a lot of experience to bring up all network setting for the customer.

*Customer: Harley Davidson . Network configuration:*

“For the mentioned interfaces (10.243.0.58 , 10.243.0.59 , 10.243.0.60 , 10.243.0.66) we have instances actively connected in our appliance . This the instances connected to interfaces(10.243.0.58 -- eroomint, eroom, eroom1 , tfim , eroomint1 , consumer

10.243.0.59 -- hdnet , qasso, hdnetsapproject , hdnetba

10.243.0.60 -- hdds , Cert-Poc , hdsn ,

10.243.0.66 -- corporate, corphdaccess, corphdbrand, hdviewsso , corporatebrand , corphdsap , corpsapproject ). *so it won't be possible to delete/ reset the static routes*.”

!image-20230626-152214.png|width=683,height=447!

Please advise?","27/Jun/23 1:37 AM;5b15d94b6256d01ad54eb020;You want to be sure to have a good backup prior to resetting the routes.  They have very few routes so it seems like a low risk to me if  they have a backup.   The main question have is,  are those routes working despite the  “invalid table ID “ error?   It looked like that was on all of the routes.",27/Jun/23 1:40 AM;5b15d9e6dda5f94d06b985b4;[~accountid:6333216f748d1bfcb85982ca] They do not need to reset the interfaces.  They can use the RAPI to remove individual problem routes.,"27/Jun/23 1:52 AM;5b15d94b6256d01ad54eb020; [~accountid:6333216f748d1bfcb85982ca]   the RAPI call  is worth trying first.  

[~accountid:5b15d9e6dda5f94d06b985b4] Have you seen the bad table ID error before?

My concern was that  since they are getting a bad  table ID error  the  RAPI call may not work.  They only have few routes so I wanted them to have a clean start.","27/Jun/23 2:01 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020]  from my opinion, If you see count routes, yes, they have a few routes. The risk is the traffic the past thought the on those few routes, and that's the risk for the customer, like this route > 10.243.0.66 -- corporate, corphdaccess, corphdbrand, hdviewsso , corporatebrand , corphdsap , corpsapproject ). What happens if this route can’t bring up after the reset…. that’s why why need some with a lot experience in case something come across that person know how to tshoot and then bring the network up.
Now, when you said backup, do you mean create/have a backup route to send the traffic for that ""temporary route"" and then proceed with the reset?
Yes, the routes are working despite the invalid table error. The issue was raised because they couldn't proceed with resetting LMI.



*Error:*

hdqamw1m1:lmi> reset_lmi_cert

Enter 'YES' to confirm: YES

Error: argument ""8346099c-fff5-11e4-8b17-4b8cff5e0b74

"" is wrong: invalid table ID

Error: argument ""83460a0a-fff5-11e4-8b17-4b8cff5e0b74

"" is wrong: invalid table ID

Error: argument ""834608c0-fff5-11e4-8b17-4b8cff5e0b74

"" is wrong: invalid table ID

Error: argument ""834603d4-fff5-11e4-8b17-4b8cff5e0b74

"" is wrong: invalid table ID

RTNETLINK answers: File exists

RTNETLINK answers: File exists

RTNETLINK answers: File exists

RTNETLINK answers: File exists

RTNETLINK answers: File exists



 ","27/Jun/23 2:02 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d9e6dda5f94d06b985b4] from the following document: [https://www.ibm.com/docs/en/sva/10.0.5?topic=developing-rest-api-documentation|https://www.ibm.com/docs/en/sva/10.0.5?topic=developing-rest-api-documentation|smart-link]   I don't see any RAPI that we can use for changing the table ID and the question of a million for me, what is the correct table ID? from where should be checked or take that information? to change the wrong ID table to the valid table ID 

!image-20230626-160552.png|width=1036,height=611!",27/Jun/23 2:05 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca] you can’t change the table id. That is tied to the interface.,"27/Jun/23 2:35 AM;5b15d9e6dda5f94d06b985b4;A route in this state, i.e. “*invalid table ID*”, is what we call an orphaned route.  It is tied to an interface/IP that no longer exists.  There are various ways for this to happen.  As Bill noted there is no way to change.  The solution is to delete/recreate or in some cases just delete if it is technically wrong.","13/Jul/23 12:02 PM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] Today, I had a meeting with the customer. When you are trying to proceed with resetting a specific interface, the command does not have the option to select a specific interface port.
E.g., if I have interfaces 1.3 (P.1), 1.4 (P.2), when I want to reset only interface 1.4, I can not choose that specific interface on the reset command; it seems like only works for resetting all the interfaces at once.

Can you please confirm if the reset command will reset(this operation will reset the network interface configuration back to the factory default) all the interfaces at the same time? Or can the reset command support specify only the interface port we want to reset?

!image-20230713-020018.png|width=991,height=928!

!image-20230713-020037.png|width=776,height=925!

!image-20230713-020108.png|width=976,height=427!



*Network configuration of the customer*

“For the mentioned interfaces (10.243.0.58 , 10.243.0.59 , 10.243.0.60 , 10.243.0.66) we have instances actively connected in our appliance . This the instances connected to interfaces:

1.3 10.243.0.58 -- eroomint, eroom, eroom1 , tfim , eroomint1 , consumer

1.4 10.243.0.59 -- hdnet , qasso, hdnetsapproject , hdnetba

1.5 10.243.0.60 -- hdds , Cert-Poc , hdsn ,

1.6 10.243.0.66 -- corporate, corphdaccess, corphdbrand, hdviewsso , corporatebrand , corphdsap , corpsapproject ). so it won't be possible to delete/ reset the static routes

*View from the LMI*

*Interfaces Name Address*

1.1 M.1 10.243.0.57/255.255.254.0 [Management]

1.2 M.2 (DHCP) [Management]

1.3 P.1 10.243.0.58/255.255.254.0

1.4 P.2 10.243.0.59/255.255.254.0

1.5 P.3 10.243.0.60/255.255.254.0

1.6 P.4 10.243.0.66/255.255.254.0

Loopback

*Static Routes:*

Destination Gateway Interface

default 10.243.0.1 Auto

10.0.0.0/8 10.243.0.1 1.1 (M.1)","13/Jul/23 11:51 PM;5b15d94b6256d01ad54eb020;If you look at the cli it says  “reset                 Reset all the routing tables.”

IN latest  support file we have,  they only have 7  Static Routes.    They should try to delete the problem routes first  and reset  only if that doesn’t work.  

7 routes  doesn’t seem like too much to re-enter.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
"Question about why ""kernel: nf_conntrack: table full, dropping packet"" is outputted in /var/log/messages.",ISAMSUP-5107,304043,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Mitsukazu Nakai,5bb6a576c39135735a7db132,Mitsukazu Nakai,5bb6a576c39135735a7db132,31/May/23 8:22 PM,12/Jul/23 9:08 AM,14/Jul/23 2:47 PM,12/Jul/23 9:08 AM,,,,0,,,,"In the customer's environment, when the number of accesses increases, ""kernel: nf_conntrack: table full, dropping packet"" is output to /var/log/messages and WebSEAL response time increases.
According to general information, ""kernel: nf_conntrack: table full, dropping packet"" seems to be output when nf_conntrack_max is exceeded. (net.nf_conntrack_max value for SAM 9.0.7 is 196608.)
However, customers claim that this message is outputted even when the number of accesses does not seem too high.
(They are currently reviewing the data.)

nf_conntrack_max is an OS configuration, but is there any information that can guide them as product support?
For example, information such as the reason why ""kernel: nf_conntrack: table full, dropping packet"" appears other than access concentration, or information such as the maximum number of accesses assumed as a product.

This issue is positioned as a serious problem for the customer (National Tax Agency), and the report is to be made to the Commissioner of the National Tax Agency.
In light of this situation, I would appreciate it if you could let us know as soon as possible, whatever information you have.",,Yutaka Kanemoto,,,,,,,,,,,,,,,5b15d9ec6d76184b7d989c83,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013037289,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Mitsukazu Nakai,5bb6a576c39135735a7db132,,,,"BSD INFORMATION TECHNOLOGY, LTD.",,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1c9fb:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.2,,,,,,,,,,,,,2023-06-01 01:55:11.912,,,,,01/Jun/23 11:55 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please review this item for us. ,"02/Jun/23 10:30 AM;5af4ad7d4dd24c579110120b;<Notes>

[https://www.pc-freak.net/blog/resolving-nf_conntrack-table-full-dropping-packet-flood-message-in-dmesg-linux-kernel-log/|https://www.pc-freak.net/blog/resolving-nf_conntrack-table-full-dropping-packet-flood-message-in-dmesg-linux-kernel-log/|smart-link] 



Checking the config on 9072 vs 10050

{noformat}/proc/sys/net/netfilter # cat nf_conntrack_max
196608
/proc/sys/net/netfilter # cat  nf_conntrack_tcp_timeout_fin_wait 
120
/proc/sys/net/netfilter # cat nf_conntrack_timestamp
0
/proc/sys/net/netfilter # cat nf_conntrack_tcp_timeout_close_wait
60
/proc/sys/net/netfilter # cat nf_conntrack_tcp_timeout_close
10
/proc/sys/net/netfilter # cat nf_conntrack_generic_timeout
600
/proc/sys/net/netfilter # cat nf_conntrack_tcp_timeout_time_wait
120
/proc/sys/net/netfilter # cat nf_conntrack_tcp_timeout_established
86400
/proc/sys/net/netfilter/nf_log # cat /sys/module/nf_conntrack/parameters/hashsize
24576

net.netfilter.nf_conntrack_dccp_timeout_closereq = 64
net.netfilter.nf_conntrack_dccp_timeout_closing = 64
net.netfilter.nf_conntrack_dccp_timeout_open = 43200
net.netfilter.nf_conntrack_dccp_timeout_partopen = 480
net.netfilter.nf_conntrack_dccp_timeout_request = 240
net.netfilter.nf_conntrack_dccp_timeout_respond = 480
net.netfilter.nf_conntrack_dccp_timeout_timewait = 240
net.netfilter.nf_conntrack_events_retry_timeout = 15
net.netfilter.nf_conntrack_generic_timeout = 600
net.netfilter.nf_conntrack_icmp_timeout = 30
net.netfilter.nf_conntrack_sctp_timeout_closed = 10
net.netfilter.nf_conntrack_sctp_timeout_cookie_echoed = 3
net.netfilter.nf_conntrack_sctp_timeout_cookie_wait = 3
net.netfilter.nf_conntrack_sctp_timeout_established = 432000
net.netfilter.nf_conntrack_sctp_timeout_heartbeat_acked = 210
net.netfilter.nf_conntrack_sctp_timeout_heartbeat_sent = 30
net.netfilter.nf_conntrack_sctp_timeout_shutdown_ack_sent = 3
net.netfilter.nf_conntrack_sctp_timeout_shutdown_recd = 0
net.netfilter.nf_conntrack_sctp_timeout_shutdown_sent = 0
net.netfilter.nf_conntrack_tcp_timeout_close = 10
net.netfilter.nf_conntrack_tcp_timeout_close_wait = 60
net.netfilter.nf_conntrack_tcp_timeout_established = 86400
net.netfilter.nf_conntrack_tcp_timeout_fin_wait = 120
net.netfilter.nf_conntrack_tcp_timeout_last_ack = 30
net.netfilter.nf_conntrack_tcp_timeout_max_retrans = 300
net.netfilter.nf_conntrack_tcp_timeout_syn_recv = 60
net.netfilter.nf_conntrack_tcp_timeout_syn_sent = 120
net.netfilter.nf_conntrack_tcp_timeout_time_wait = 120
net.netfilter.nf_conntrack_tcp_timeout_unacknowledged = 300
net.netfilter.nf_conntrack_udp_timeout = 30
net.netfilter.nf_conntrack_udp_timeout_stream = 180
{noformat}

To check and tune-

{noformat}
tcp_keepalive_intvl
The number of seconds between TCP keep-alive probes. The default value is 75 seconds.
tcp_keepalive_probes
The maximum number of TCP keep-alive probes to send before giving up and killing the connection if no response is obtained from the other end. The default value is 9.
tcp_keepalive_time
The number of seconds a connection needs to be idle before TCP begins sending out keep-alive probes. Keep-alives are only sent when the SO_KEEPALIVE socket option is enabled. The default value is 7200 seconds (2 hours). An idle connection is terminated after approximately an additional 11 minutes (9 probes an interval of 75 seconds apart) when keep-alive is enabled.{noformat}

{noformat}iptables -  the nf_conntrack_errors. 
set the following 'net.ipv4.tcp_max_tw_buckets=1800000'.{noformat}","02/Jun/23 10:36 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bb6a576c39135735a7db132] 

I checked the support logs could not see a complete support file to see any of the config. 
The only error I saw was about the 

{noformat}2023-05-15-16:58:34.492+09:00I----- 0x38AD5425 webseald ERROR wiv socket WsTcpListener.cpp 493 0x7f4a9dc4a700 -- DPWIV1061E   Could not write to socket (104)```{noformat}


Do we have a full support file? 
When did this issue start happening - was there an upgrade/change? 
Is this just the logs /var/log/messages or is this affecting any other functionality like LMI/Reverse proxy/federations etc? 

Are there any advanced tuning config that is in place? 

Can we add this advanced tuning parameter and check the behavior - {{net.ipv4.tcp_max_tw_buckets=1800000}}  

Thanks","02/Jun/23 11:35 AM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for your support.


{quote}Do we have a full support file? {quote}

The customer encountered this issue in a SAM 9.0.6 environment.
However, they don't have a support extension contract for SAM 9.0.6, so they're doing a reproduction on SAM 9.0.7.2 now.
Unfortunately, we only have support files for SAM 9.0.6 at the moment.
The problem occurrence situation in the SAM 9.0.6 environment and the materials collected at that time are as follows…

*Environment:*
SAM 9.0.6
AAAJ01 ... WebSEAL#1
AAAJ02 ... WebSEAL#2
AAAJ03 ... PolicyServer

*How the problem occurred.:*
In the customer's environment, two WebSEALs (VM) are used, but there was a time when one WebSEAL (AAAJ02) was not working properly and the other WebSEAL (AAAJ01) was processing all requests.
Meanwhile, /var/log/messages showed the following output and WebSEAL response times were slower than usual.

/ecurep/sf/TS013/037/TS013037289/2023-05-17/isam_9.0.6.0_20230516-200914_AAAJ01.support_unpack/var/log/messages:
May 16 08:29:19 kernel: nf_conntrack: table full, dropping packet

This message was logged between May 16 08:29:19 and May 16 14:13:40, which coincides with the time when WebSEAL was running alone.
So, this message seems to be output due to concentrated access to one WebSEAL.
However, customers have confirmed in pre-release tests that a single WebSEAL unit can handle more requests than the production environment without any problems.
So, they speculate that the ""nf_conntrack: table full, dropping packet"" output may be for reasons other than access concentration.
(It is difficult to accurately capture the actual production environment situation, and the pre-release tests and production environment conditions may differ, but customers rely on pre-release tests results as a basis for speculation.)

*Materials:*
support files:
/ecurep/sf/TS013/037/TS013037289/2023-05-17/
   isam_9.0.6.0_20230516-200914_AAAJ01.support_unpack
   isam_9.0.6.0_20230516-201335_AAAJ02.support_unpack
   isam_9.0.6.0_20230516-201413_AAAJ03.support_unpack

/ecurep/sf/TS013/037/TS013037289/2023-05-24/AAAJ0111.zip_unpack/AAAJ0111/
   AAAJ0111_request.log ... request.log of AAAJ0111.



{quote}When did this issue start happening - was there an upgrade/change? {quote}

""kernel: nf_conntrack: table full, dropping packet"" started appearing on May 16 08:29:19 at AAAJ01.
They didn't change the configuration, but normally there are two WebSEALs running, but at that time there was only one.



{quote}Is this just the logs /var/log/messages or is this affecting any other functionality like LMI/Reverse proxy/federations etc? {quote}

Reverse Proxy response time seems to have increased.
No other effects have been identified.
(Before the ""kernel: nf_conntrack: table full, dropping packet"" came out at AAAJ01, they had strange LMI behavior in the other VM with WebSEAL configured (AAAJ02), could this be related to the problem?)



{quote}Are there any advanced tuning config that is in place? {quote}

I think they are using the default settings.



{quote}Can we add this advanced tuning parameter and check the behavior - net.ipv4.tcp_max_tw_buckets=1800000  {quote}

Thank you.
I will suggest them.



Regards,
Mitsukazu Nakai","02/Jun/23 7:10 PM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for your support.


{quote}Can we add this advanced tuning parameter and check the behavior - net.ipv4.tcp_max_tw_buckets=1800000{quote}

The customer tried this setting, but the situation did not change...
They have verified in the following settings in the reproduction environment.


*Original settings to reproduce the issue:*
nf_conntrack_max = 4000 ... This value is intentionally small to make it easier to drop packets.
net.ipv4.tcp_max_tw_buckets = 131072 ... This seems to be the default value if they don't set a value.

*Verification settings:*
nf_conntrack_max = 4000
net.ipv4.tcp_max_tw_buckets = 1800000

*Test method:*
Concurrent access with 2000 threads.

*Result:*
In either state, ""kernel: nf_conntrack: table full, dropping packet"" will start to be output at the same timing.

*Customer Comments:*
I imagine that increasing net.ipv4.tcp_max_tw_buckets will increase the number of connections that can be kept in TIME_WAIT state without closing them.
In that case, I would expect the nf_conntrack_max limit to be reached sooner as there are more connections to manage from netfilter's point of view.
Therefore, I thought it would be better to reduce the value of net.ipv4.tcp_max_tw_buckets...



They (and I) don't know much about the settings…
And although there may be problems with the verification method, I would appreciate it if you could comment on this result.
Thank you.

Regards,
Mitsukazu Nakai","05/Jun/23 7:34 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bb6a576c39135735a7db132] 

The test case sounds alright.

This _nf_conntrack_max_ value can be set to a large value to allow large number of connections.

To help lessen the issues with a large number of connections, you may want to consider reducing the amount of time the server waits until it closes/timeouts the connections.
_nf_conntrack_tcp_timeout_close_wait = 60_
_nf_conntrack_tcp_timeout_fin_wait = 60_
_nf_conntrack_tcp_timeout_time_wait = 60_



here is the description for buckets- 

+*net.ip4.tcp_max_tw_buckets:*+
Specifies the maximum number of sockets in the “time-wait” state allowed to exist at any time. If the maximum value is exceeded, sockets in the “time-wait” state are immediately destroyed and a warning is displayed. This setting exists to thwart certain types of “Denial of Service” attacks. Care should be exercised before lowering this value. When changed, its value should be increased, especially when more memory has been added to the system or when the network demands are high and environment is less exposed to external threats.

If you set too large value to tcp_max_tw_buckets, the system may become out of port, file-descripter and memory. If you set too small value, the system may not communicate another host.","06/Jun/23 11:37 AM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for your support.


Thank you for confirming.
I will report your answer to the customer.


Apart from this, the customer needs answers on the following questions.
They need to report these answers to the end user, so I would appreciate it if you could reply by today in Japan time or by tomorrow morning.
The list of questions below is arranged in order of priority for the customer:

Q1. Is there any information that product support can provide to customers about nf_conntrack_max?

Q2. The setting value of nf_conntrack_max is 196608. Is there a basis for setting it?

Q3. Is there a maximum number of accesses assumed by the product?

Q4. Is it possible that ""kernel: nf_conntrack: table full, dropping packet"" is outputted for reasons other than access concentration?

Q5. Is it possible to check the value of net.netfilter.nf_conntrack_count other than the sysctl.txt of support file? (Is there a quicker way to check the support file?)


These may all seem like trivial questions, but they are the information customers need to help organize and report problems end users encountered.
I would appreciate it if you could give me an answer considering the situation.
Of course, if there is no answer/cannot be answered, please tell me as it is.
Thank you.


Regards,
Mitsukazu Nakai","06/Jun/23 4:40 PM;5af4ad7d4dd24c579110120b;Q1. Is there any information that product support can provide to customers about nf_conntrack_max?

* This is generic platform information that has been adapted by mcp our base layer and the descriptions and defaults are the same as any other unix 

Q2. The setting value of nf_conntrack_max is 196608. Is there a basis for setting it?

* This were based on an initial test and recommendation during development.
Refer - [https://rtp-rtc6.tivlab.raleigh.ibm.com:9443/jazz/web/projects/ISAM#action=com.ibm.team.workitem.viewWorkItem&id=34438|https://rtp-rtc6.tivlab.raleigh.ibm.com:9443/jazz/web/projects/ISAM#action=com.ibm.team.workitem.viewWorkItem&id=34438]
net.netfilter.nf_conntrack_max=196608
/sys/module/nf_conntrack/parameters/hashsize = 24576
net.netfilter.nf_conntrack_tcp_timeout_established = 86400


Q3. Is there a maximum number of accesses assumed by the product?

* You mean in addition to net.netfilter.nf_conntrack_max value? 

Q4. Is it possible that ""kernel: nf_conntrack: table full, dropping packet"" is outputted for reasons other than access concentration?

* Generic information on these logs are usually when there is NAT interference/ access concentration.
Tuning the bucket size and timeouts to work out what suits your deployment can help remove or reduce these messages.

Q5. Is it possible to check the value of net.netfilter.nf_conntrack_count other than the sysctl.txt of support file? (Is there a quicker way to check the support file?)

* No","06/Jun/23 5:39 PM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for your prompt response!

{quote}Q3. Is there a maximum number of accesses assumed by the product?
    You mean in addition to net.netfilter.nf_conntrack_max value? {quote}

Sorry for the very vague question.
This question also includes its parameter settings.
They are asking for information about the maximum number of access that can be handled with a standard configuration without custom tuning.
For example, if it is a hair dryer, I think that the specifications for the air volume are clearly stated. ""1.6 m^3/min"" or something.
SAM are much more complicated than hair dryers, but if you have any information to guide them, they would like to know about it.

Regards,
Mitsukazu Nakai","06/Jun/23 7:17 PM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Sorry for the repeated updates...

I received a question from the customer regarding the following your answer:

----

Q4. Is it possible that ""kernel: nf_conntrack: table full, dropping packet"" is outputted for reasons other than access concentration?

* Generic information on these logs are usually when there is NAT interference/ access concentration.
Tuning the bucket size and timeouts to work out what suits your deployment can help remove or reduce these messages.

----

Does the *bucket size* and *timeouts* written in this answer mean the following parameters in the previous answer?
nf_conntrack_tcp_timeout_close_wait
nf_conntrack_tcp_timeout_fin_wait
nf_conntrack_tcp_timeout_time_wait
net.ip4.tcp_max_tw_buckets



They still want a quick response to the remaining questions, so if they request it, would you be able to have a direct conversation with them via webex, etc.?
(I am sorry, I can't speak English, but there are person in the account team who can speak English.)


Regards,
Mitsukazu Nakai","07/Jun/23 10:16 AM;5af4ad7d4dd24c579110120b;[~accountid:5bb6a576c39135735a7db132] 

Does the *bucket size* and *timeouts* written in this answer mean the following parameters in the previous answer?
Yes


. Is there a maximum number of accesses assumed by the product?

* You mean in addition to net.netfilter.nf_conntrack_max value?
There is no set max limit, this should be tuned to suit the environment. 
Refer - [https://www.oreilly.com/library/view/mastering-proxmox/9781788397605/dfc3dd5c-c029-4b3c-b2a4-4e53cc27cd68.xhtml|https://www.oreilly.com/library/view/mastering-proxmox/9781788397605/dfc3dd5c-c029-4b3c-b2a4-4e53cc27cd68.xhtml|smart-link] 
","07/Jun/23 10:49 AM;5bb6a576c39135735a7db132;Hi [~accountid:5af4ad7d4dd24c579110120b] 
Thank you for your support.

I really appreciate your prompt reply.

I don't have any questions left, but would you mind keeping it open for a while longer, as the account team might respond?
Thank you.

Regards,
Mitsukazu Nakai",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Syslog server certificate expiration hangs federation runtime,ISAMSUP-5086,301137,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,20/May/23 12:27 AM,15/Jun/23 6:13 AM,14/Jul/23 2:47 PM,15/Jun/23 6:13 AM,,Support,,0,,,,"The client had the certificate of their syslog server expire. This caused the federation runtime to hang, despite disk failover being checked. Tuning is default values, event queue size 1000, queue full timeout -1, sender threads 1, error retry count 2. Instead, what seems to have occurred is:

Need to audit.
Lookup audit setting (again).
Get a connection.
Something goes wrong.
Connection will wait the default connectionTImeout (3600)

When the certificate was fixed on the syslog server, all of the Postgres threads on the containers cleared, but until then, the runtime opened connections to the config database until there were the max of 50. Diagnostic data is at [https://ecurep.mainz.de.ibm.com/ae5/#id=TS013065126&path=TS013065126%2F2023-05-18%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013065126&path=TS013065126%2F2023-05-18%2F] .

May I open an APAR to address disk failover not functioning.",,Annelise Quap,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,5b15d950d9936c61022057fe,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,24/May/23 12:23 PM;ashashiv;image-20230524-021834.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202188,24/May/23 12:23 PM;ashashiv;image-20230524-021916.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202190,24/May/23 12:23 PM;ashashiv;image-20230524-022136.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/202189,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013065126,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS013065126&path=TS013065126%2F2023-05-18%2F,,,,,,,,,,,,,,,,,,,,,,,0|i1bqzz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-23 14:39:06.389,,,,,24/May/23 12:39 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please confirm Stens findings and advise if you believe this should be an APAR? ,"24/May/23 12:23 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bac25a37de8532e315430c5] 

Audit config-

!image-20230524-021834.png|width=50%!

!image-20230524-022136.png|width=346,height=273!



Certificate expired in 2022 

!image-20230524-021916.png|width=1194,height=192!



I have an API protection policy and Client defined.

I run this command in loop to get tokens - 

{noformat}for i in {1..50}; do  `curl -k -d ""client_id=testclient1&grant_type=password&username=testuser1&password=Passw0rd&client_secret=testclient1password"" https://10.160.21.212/mga/sps/oauth/oauth20/token`; done{noformat}

This seems to work without runtime hang/not many idle threads.



Am I missing any config/steps to recreate the issue?


Where is this timeout set in your env -

{noformat}Connection will wait the default connectionTImeout (3600){noformat}",31/May/23 12:31 AM;5b15d901fa615349cb01778b;[~accountid:5bac25a37de8532e315430c5] . Can you please follow up,"31/May/23 2:18 AM;5bac25a37de8532e315430c5;[~accountid:5af4ad7d4dd24c579110120b] In the client’s environment, the volume used for disk failover filled. In that situation, would the described behavior be expected?","31/May/23 11:35 AM;5af4ad7d4dd24c579110120b;<Notes>

package com.ibm.isam.logging.syslogclient;
public class TLSManager implements Runnable  

public class SyslogHandler extends Handler {

{noformat}if (props.isFailoverToDisk()) {
                pool.execute(new TLSManager(props.getServerHost(), props
                        .getPort(), props.getTLSVersion(), props
                        .getTrustedKeyStore(),
                        props.getTrustStorePasswd(),
                        props.isClientCertAuthRequired(), props.getKeyStore(),
                        props.getKeyStorePasswd(),
                        props.getClientSSLKeyAlias(), queue, props
                                .getNumSenderThread(),
                        props.getRetryInternal(), props.getNumRetry(), props
                                .getDiskCacheDir(), props.getCacheFileName(),
                        props.getMaxCacheFileSize(), props
                                .getMaxNumCacheFiles(), props
                                .isCacheFileAppend(), props
                                .getReconnectInterval()));
            } {noformat}","31/May/23 11:39 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5bac25a37de8532e315430c5] 

I have disk fail over enabled in my test.


So was the client config with or without - Enable Client Certificate authentication - ? 
If they unchecked disk fail over was there still a hang? Just trying to narrow down the config options.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Can't use Uppercase token label while creating HSM keystore in ISVA 10.0.5.0 version,ISAMSUP-5077,299922,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,David Hayes,5b232b2fd85e5b59b066f57f,oscar.jimen,6333216f748d1bfcb85982ca,oscar.jimen,6333216f748d1bfcb85982ca,17/May/23 4:55 AM,06/Jul/23 2:18 AM,14/Jul/23 2:47 PM,06/Jul/23 2:18 AM,10.0.7,,,0,,,,"*Problem Description:*
We tried to delete and re-create one of the HSM keystore as we have issue with one of the HSM server. *We're unable to create HSM keystore with token label CISAMIT in ISVA 10.0.5 version* servers and able to create *in ISVA 10.0.3.1 servers.* Since HSM is already setup with token label as CISAMIT we can not use as cisamit with giving us error. System Error DPWAP0063E The keyfile, HSMIT2.p11, could not be opened: 0x89 (GSKKM_ERR_CRYPTOGRAPHIC_TOKEN_LABEL_NOT_EXIST)

Support files:

[2023-05-16/isva_10.0.5.0_20230502-192729_zlt22485.enaf.vci.att.com.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013009582&path=TS013009582/2023-05-16/&filepath=TS013009582/2023-05-16/isva_10.0.5.0_20230502-192729_zlt22485.enaf.vci.att.com.support]

Uploaded 2 support files one with just system and other with all options.

[2023-05-16/all_options.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013009582&path=TS013009582/2023-05-16/&filepath=TS013009582/2023-05-16/all_options.support]",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5174,,,,,,,,,,,,,,,,,IJ47136,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013009582,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,,,,,, A T & T SERVICES INC (SREEMAN JASTHI),,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-06-27T08:19:39.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bjkv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-05-16 22:23:52.722,,,,,17/May/23 8:23 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] another AT&T HSM issues at 10.0.5. Hoping that this one is low impact and a quick assessment.,"18/May/23 1:33 PM;5b232b2fd85e5b59b066f57f;[~accountid:6333216f748d1bfcb85982ca] - this works fine for me in the lab. Is the customer sure they have registered the client and assigned the partition in Luna? I’d recommend that they delete the client and re-register / assign the partition. If this does not help, can we please ask the customer to provide a support file that includes “sensitive information”? I need this to be able to get a look at their p11 files. Thanks. ","24/May/23 1:31 AM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] Comment from the customer: I tried deleting client in HSM and all 3 hsm keystores in ISVA. Now able to create HSMIT1 keystore with CISAMIT, but not able to create HSMIT2 with same token label name CISAMIT. If I use different token label name like CISAMIT2, I'm able to create HSMIT2 keystore too. But we have to use same token label name for all 3 HSM keystores.



And can we get delete_luna_keystore_fix_9071IF5.fixpack for ISVA 10.0.5 version, I still see deleted hsm keystore values in Chrystoki file in support file.

Attached support file for same.

[2023-05-23/isva_10.0.5.0_20230523-144850_zlt22485.enaf.vci.att.com.support.zip|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013009582&path=TS013009582/2023-05-23/&filepath=TS013009582/2023-05-23/isva_10.0.5.0_20230523-144850_zlt22485.enaf.vci.att.com.support.zip]

[2023-05-23/isva_10.0.5.0_20230523-154317_zlt22485.enaf.vci.att.com.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013009582&path=TS013009582/2023-05-23/&filepath=TS013009582/2023-05-23/isva_10.0.5.0_20230523-154317_zlt22485.enaf.vci.att.com.support]",01/Jun/23 2:41 AM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] *Recent comment from the customer:* “Any update from your backend team? Currently we're blocked to test environment.“,"05/Jun/23 1:17 PM;5b232b2fd85e5b59b066f57f;The inability to create another network keystore with the same token label is a different issue that has been introduced to ISVA 10.0.5 due to [https://cloudidentity.atlassian.net/browse/ISAMDEV-8735|https://cloudidentity.atlassian.net/browse/ISAMDEV-8735|smart-link] - SslCertificate.java:1465


I’m discussing with the dev team member responsible for this development work to understand why it was implemented this way. 

The code change from delete_luna_keystore_fix_9071IF5 is already in 10.0.5 so should not be a factor here. We may need to revisit why Keystores have not been fully removed once the above is better understood.  ","05/Jun/23 1:56 PM;5b232b2fd85e5b59b066f57f;Issue is in SslCertificate.java:isSafenetTokenLabelInUse(…) - should only be checking token label usage within each individual HSM server - not across all.

L2 - please open an APAR. ",08/Jun/23 3:09 AM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f]  APAR created successfully with number: IJ47136. Please double check if the APAR has the correct description. this my first one. thanks!,14/Jun/23 10:39 AM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] the customer is asking the following: “Thanks for the response. Just checking to see if you HAVE any ETA?“ in regards to the APAR.,15/Jun/23 11:57 PM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] The customer is asking for an update? thx,"16/Jun/23 1:16 AM;5b15d98f78cd734fe39f29a1;[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:6333216f748d1bfcb85982ca] [~accountid:5ac57757d9a96536d1f0daa9] David, the customer is escalating as this is holding up a key project for AT&T. Is there an ETA for a fix? ",21/Jun/23 2:38 PM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d98f78cd734fe39f29a1] - I’m hoping to have a test fix-pack available by end of next week (30JUN). ,21/Jun/23 10:32 PM;5b15d98f78cd734fe39f29a1;[~accountid:5b232b2fd85e5b59b066f57f] thanks David.  ,"22/Jun/23 6:27 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 6f00cea7123f37421f4f7dd6ea34353443805c10
   * description: ISAMSUP-5077

Allow multiple Luna hsm keystores to use the same token label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1636761.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5077) which we publish.","22/Jun/23 6:54 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 6f00cea7123f37421f4f7dd6ea34353443805c10
   * description: ISAMSUP-5077

Allow multiple Luna hsm keystores to use the same token label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1637550.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230622085047-6f00cea7-support.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","22/Jun/23 8:18 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 6f00cea7123f37421f4f7dd6ea34353443805c10
   * description: ISAMSUP-5077

Allow multiple Luna hsm keystores to use the same token label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1640295.


This build has not been published as the commit is not currently within a branch (20230622085047-6f00cea7-support) which we publish.","23/Jun/23 1:40 PM;5b232b2fd85e5b59b066f57f;[~accountid:6333216f748d1bfcb85982ca] - I’m about to put together a test fix-pack for the customer. Have they, or are they intending to, apply IF1 or any other personal fix-packs? ",24/Jun/23 2:12 AM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] let me check with the customer.,"24/Jun/23 3:54 AM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] Comment from the customer: “yes Oscar, we have installed IF1 fixpack after version upgrade.“","27/Jun/23 8:19 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 31423060e01a08cce9fabd4ead70fa141b29ff58
   * description: ISAMSUP-5077 (#6001)

Allow multiple Luna hsm keystores to use the same token label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1804292.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230626221641-31423060e.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","27/Jun/23 9:40 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 31423060e01a08cce9fabd4ead70fa141b29ff58
   * description: ISAMSUP-5077 (#6001)

Allow multiple Luna hsm keystores to use the same token label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1807313.


This build has not been published as the commit is not currently within a branch (20230626221440-cd9733743) which we publish.","27/Jun/23 9:40 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 31423060e01a08cce9fabd4ead70fa141b29ff58
   * description: ISAMSUP-5077 (#6001)

Allow multiple Luna hsm keystores to use the same token label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1807348.


This build has not been published as the commit is not currently within a branch (20230626221645-59052e3ee) which we publish.","27/Jun/23 9:41 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 31423060e01a08cce9fabd4ead70fa141b29ff58
   * description: ISAMSUP-5077 (#6001)

Allow multiple Luna hsm keystores to use the same token label

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1807341.


This build has not been published as the commit is not currently within a branch (20230626221641-31423060e) which we publish.",27/Jun/23 9:56 AM;5b232b2fd85e5b59b066f57f;Code merged. Closing APAR. ,27/Jun/23 11:57 AM;5b232b2fd85e5b59b066f57f;Fix-pack available at [https://cloudidentity.atlassian.net/browse/ISAMSUP-5174|https://cloudidentity.atlassian.net/browse/ISAMSUP-5174|smart-link],"29/Jun/23 1:23 AM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] FYI- Comment from the customer: “Able to create keystores now without error after installing fixpack, will keep PM open for few more days until we complete our testing.”

I will wait of follow up the costumer next week.",06/Jul/23 2:17 AM;6333216f748d1bfcb85982ca;[~accountid:5b232b2fd85e5b59b066f57f] the customer confirmed to close the case. thanks!,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Unable to restore snapshot on a new appliance,ISAMSUP-5074,299592,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Varun.Tyagi1,62d0e51aec233f24684a5d3a,Varun.Tyagi1,62d0e51aec233f24684a5d3a,15/May/23 5:27 PM,06/Jun/23 11:33 PM,14/Jul/23 2:47 PM,06/Jun/23 11:33 PM,,,,0,,,,"Hi Team, I have a customer  who wants to increase the disk space of ISAM appliance so they are creating a fresh VM with a larger disk space and trying to restore the snapshot from the older appliance into the newly created VM.

They are unable to apply the snapshot. I checked the /var/log/messages and found the below errors - 

May  8 16:16:28 mesa_config[5192]: Applying snapshot

May  8 16:16:28 mesa_config[5192]: Snapshot file: /var/support/isva_10.0.0.0_20230507-153245.999076_sr660004bi-d01.dev.stcpay.com.sa.snapshot

May  8 16:16:28 mesa_config[5192]: Found version within /tmp/tmp.KbGWYD/Settings: 10.0.0.0

May  8 16:16:28 mesa_config[5192]: Found model within /tmp/tmp.KbGWYD/Settings: appliance

May  8 16:16:28 mesa_config[5192]: Error: MesaSecureFileMgr::signatureIsValid(): acme error:failed:idup_se_singlebuffer_unprotect:*GSS_S_FAILURE:GSS_S_INVALID_PKCS7_MESSAGE*

*May  8 16:16:28 mesa_config[5192]: Error: The snapshot file cannot be applied because it has been modified!*

May  8 16:20:01 mesa_config[9221]: Error: WGAWA0310E   The command is not supported with the current configuration.



May  8 16:25:21 mesa_config[2339]: Error: WGAWA0010E   An internal error has occurred (/workspace/src/appliance/app-core/modules/config_wga_notifications.cpp:453).



*May  8 09:02:07 mesa_config[1031]: Error: DPWAP0072E   The key database, rt_profile_keys, does not exist.*

May  8 09:02:10 kernel: NET: Registered protocol family 10

*May  8 09:02:13 mesa_config[1221]: Error: DPWAP0072E   The key database, lmi_trust_store, does not exist.*

*May  8 09:02:18 mesa_config[1399]: Error: DPWAP0072E   The key database, embedded_ldap_keys, does not exist.*

May  8 09:02:23 init: starting pid 1569, tty '': '/usr/sbin/mesa_config first_boot'

May  8 09:02:23 mesa_config[1569]: Looking for Azure metadata

May  8 09:02:23 mesa_control[1595]: Error: Failed to mount USB device /dev/sdb

May  8 09:02:23 init: starting pid 1620, tty '': '/usr/sbin/mesa_control bootstrap 2>&1 1>/dev/null'

May  8 09:02:23 mesa_control[1620]: Bootstrapping from last known good policies

May  8 09:02:23 mesa_control[1620]: Adapting policy dir=/etc/policies/

May  8 09:02:23 mesa_control[1620]: Adapt policy succeeded



May  8 09:02:24 mesa_config[1637]: Error: Could not open the key database.

May  8 09:02:24 mesa_config[1637]: Error: Invalid entries in configuration file. Restoring previous configuartion

May  8 09:02:42 getty[2568]: tcgetattr: Input/output error

I did some finding and found something on the similar lines here - [https://cloudidentity.atlassian.net/browse/ISAMSUP-4408|https://cloudidentity.atlassian.net/browse/ISAMSUP-4408|smart-link] 

Can you please guide on what needs to be done - 

# Is it fixed in 10.0.3?

2. Does this “clear snapshot keys” fixpack fix this issue ??→ [https://cloudidentity.atlassian.net/browse/ISAMSUP-2555|https://cloudidentity.atlassian.net/browse/ISAMSUP-2555|smart-link] 

3. Has this issue been addressed by IJ24066?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012964976,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Varun.Tyagi1,62d0e51aec233f24684a5d3a,,,,STC Bank,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1bhj3:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.0.0,,,,,,,,,,,,,2023-05-15 22:20:49.74,,,,,16/May/23 8:20 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020] can you please complete the initial assessment for this support case?,"17/May/23 2:01 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d94b6256d01ad54eb020] , Any updates on this?","17/May/23 11:33 PM;5b15d94b6256d01ad54eb020;[~accountid:62d0e51aec233f24684a5d3a] I was out yesterday but will take a look today.  

Please update the severity and priority.","18/May/23 12:17 AM;5b15d94b6256d01ad54eb020;I think this work item discussed what you need to do. Looks like the same issue.

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4580|https://cloudidentity.atlassian.net/browse/ISAMSUP-4580|smart-link] 

Locate the fix pack and install, then create a new snapshot. The new snapshot should be usable with the upgrade.","18/May/23 2:27 PM;62d0e51aec233f24684a5d3a;Hi [~accountid:5b15d94b6256d01ad54eb020] , I tried to locate the fixpack but it seems they were all uploaded on the ECUREP and since the case has been closed so  the files are archived and no longer accessible. I also tried opening the box link for it but that too isn’t working. Can you please reshare that fixpack. I guess it was built by Peter.","18/May/23 11:34 PM;5b15d94b6256d01ad54eb020;[~accountid:62d0e51aec233f24684a5d3a] Look for it here:

[https://ibm.ent.box.com/folder/54078405818?s=j1g32b6hkeqxb3fi6m9pv6k0jd4z9d45|https://ibm.ent.box.com/folder/54078405818?s=j1g32b6hkeqxb3fi6m9pv6k0jd4z9d45]",06/Jun/23 3:06 PM;62d0e51aec233f24684a5d3a;the customer upgraded to 10.0.4 and then applied the snapshot which seem to have worked for them. Thanks for the help.,06/Jun/23 11:33 PM;5b15d94b6256d01ad54eb020;Thanks for the update. Closing this work item.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Swap Enablement on 10.0.3.1 Hardware Appliances,ISAMSUP-5066,299030,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Charles David Hooks,5b15d9936d76184b7d989c82,jcyarbor,5bac25aaabfcbf73d13e733b,11/May/23 11:06 AM,19/May/23 9:17 AM,14/Jul/23 2:47 PM,19/May/23 9:17 AM,10.0.6,Support,,0,,,,"SF Case : TS011795907

Env: ISVA 10.0.3.1

Initial Problem Description:

Allstate is having memory issues that are rendering their appliance unrecoverable.

To help with this we need to enable SWAP on their hardware appliance.",,David Hayes,jcyarbor,khansen,Nick Lloyd,Peter Horner,Rachel Tomas,tonyferg,,,,,,,,,5b232b2fd85e5b59b066f57f,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b15d9517dab4c51f61b5190,70121:0ba4f8fa-8042-4ac9-914a-4a02dabc3187,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,ISAMSUP-4849,,,ISAMSUP-4878,,,,,,,,,,,,,,,,,,,,,IJ46749,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012988582,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,jcyarbor,5bac25aaabfcbf73d13e733b,,,,Allstate Insurance Company,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-05-13T08:53:08.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012969633&path=TS012969633/2023-05-10/&filepath=TS012969633/2023-05-10/isva_10.0.3.1_20230510-125458_vap1019.support,,,,,,,,,,,,,,,,,,,,,,,0|i1be2f:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-05-11 06:05:43.996,,,,,"11/May/23 4:05 PM;5b15d9517dab4c51f61b5190;Have discovered in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4849|https://cloudidentity.atlassian.net/browse/ISAMSUP-4849|smart-link] that swap is disabled after reboot

Need to update /etc/rc.mount to enable swap at boot time","11/May/23 4:16 PM;5b15d9517dab4c51f61b5190;Since the other item already has an APAR

Can you please create an APAR “swap not enabled at boot time on hardware appliance with swap file”

IBM Internal only

We need to update rc.mount to call swapon at the same place we update /etc/fstab to have the swap file line in config_swap.cpp

or make sure rc.mount always has swapon line",11/May/23 9:25 PM;5bac25aaabfcbf73d13e733b;APAR IJ46749 has been created for this issue.,"11/May/23 11:32 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c51e98c4d2a7ca1eef78b2cbe80bbb14e69e2162
   * description: ISAMSUP-5066 IJ46749 Enable swap at boot on hardware appliance

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/397388.


This build has not been published as the commit is not currently within a branch (ISAMSUP-5066) which we publish.",12/May/23 12:22 PM;5b15d9517dab4c51f61b5190;The 10.0.3.1 fixpack is atached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4878|https://cloudidentity.atlassian.net/browse/ISAMSUP-4878|smart-link] ,"12/May/23 5:58 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: db38da85720e6ed3bf77c41b088335f89c7a5801
   * description: Merge pull request #5948 from ISAM/ISAMSUP-5066

ISAMSUP-5066 IJ46749 Enable swap at boot on hardware appliance

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/415601.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230512075505-db38da85.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","12/May/23 7:12 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: db38da85720e6ed3bf77c41b088335f89c7a5801
   * description: Merge pull request #5948 from ISAM/ISAMSUP-5066

ISAMSUP-5066 IJ46749 Enable swap at boot on hardware appliance

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/416563.


This build has not been published as the commit is not currently within a branch (20230512075505-db38da85) which we publish.","13/May/23 8:53 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: db38da85720e6ed3bf77c41b088335f89c7a5801
   * description: Merge pull request #5948 from ISAM/ISAMSUP-5066

ISAMSUP-5066 IJ46749 Enable swap at boot on hardware appliance

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/433366.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230512225001-db38da85.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","19/May/23 1:43 AM;5bac25aaabfcbf73d13e733b;[~accountid:5b15d954b0d76456f36daf33] ,

Allstate confirmed that the fixpack enabled the swap partition as expected and also persists through a reboot.",19/May/23 9:17 AM;5b15d954b0d76456f36daf33;Thanks [~accountid:5bac25aaabfcbf73d13e733b] . Closing this item as there isn’t much else to do.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 ISVA advanced configuration - mmfa transaction cleanup,ISAMSUP-4984,295226,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,David Hayes,5b232b2fd85e5b59b066f57f,Ayush Singh,61409dc154762c006932ffc7,Ayush Singh,61409dc154762c006932ffc7,18/Apr/23 7:36 PM,22/May/23 12:18 PM,14/Jul/23 2:47 PM,22/May/23 12:18 PM,,Support,,0,,,,"doing the tuning in Advanced configuration for MMFA transaction in AAC, in the documentation we found that after activating cleanup (for example mmfa.transactionArchival.maxCompletedPerUser) and after the thread there is the archival to the audit log. Which is the audit log to be verified? Which is the event category to search?

[https://www.ibm.com/docs/en/sva/10.0.4?topic=ac-advanced-configuration-properties#advconfig__d249e3995|https://www.ibm.com/docs/en/sva/10.0.4?topic=ac-advanced-configuration-properties#advconfig__d249e3995]





with this configuration:

AAC>Advanced Configuration>mmfa.transactionArchival.maxCompletedPerUser>50 transaction per User and mmfa.transactionArchival.cleanupInterval>300

there is a cleanup thread of completed transaction if the number exceed 50 each 300 seconds.

In the documentation it's mentioned that after the cleanup thread there is the archival to the audit log. The audit log you mentioned is already activated and if it's the right one, which is the event category to search inside the audit log to identify archived transactions?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012443055,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Ayush Singh,61409dc154762c006932ffc7,,,,BPIFRANCE,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"https://ecurep.mainz.de.ibm.com/ae5/#id=TS012443055&path=TS012443055/2023-03-22/&filepath=TS012443055/2023-03-22/isva_10.0.4.0_20230322-180144_T0V7D.support

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012443055&path=TS012443055/2023-03-23/&filepath=TS012443055/2023-03-23/audit.zip

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012443055&path=TS012443055/2023-04-12/&filepath=TS012443055/2023-04-12/audit.log

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012443055&path=TS012443055/2023-04-12/&filepath=TS012443055/2023-04-12/audit.log.1

https://ecurep.mainz.de.ibm.com/ae5/#id=TS012443055&path=TS012443055/2023-04-12/&filepath=TS012443055/2023-04-12/audit.log.2",,,,,,,,,,,,,,,,,,,,,,,0|i1ar5j:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-18 22:41:02.689,,,,,19/Apr/23 8:41 AM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] I believe you have some knowledge with these settings. ,21/Apr/23 2:28 PM;5b232b2fd85e5b59b066f57f;In the audit log there should be an entries with action of “archiveTransaction”.,22/May/23 12:18 PM;5ac57757d9a96536d1f0daa9;No additional L3 support needed. Setting Jira item status to Done.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA container support for AWS fargate and GCP (Google Cloud Platform) cloudrun,ISAMSUP-4965,293106,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,David Hayes,5b232b2fd85e5b59b066f57f,Charles David Hooks,5b15d9936d76184b7d989c82,Charles David Hooks,5b15d9936d76184b7d989c82,08/Apr/23 7:58 AM,22/May/23 12:15 PM,14/Jul/23 2:47 PM,22/May/23 12:15 PM,,,07/Apr/23 12:00 AM,0,,,,"SF Case : TS011901930

ISVA level : 10.0.4

Customer Question : container support platforms

----

Initially, provided customer with doc links that mentioned various container support variants, for IAG and ISVA:

*for ISV/IAG:*

[https://docs.verify.ibm.com/gateway/docs/deployment|https://docs.verify.ibm.com/gateway/docs/deployment|smart-link] 

*for ISVA:*

(clarity engine and doc pages)

we discussed support for the broader brush arenas:

# Docker 
# Kubernetes (generic)
# Red Hat OpenShift

and the more granular mention of support for AWS and GCP…

that being said, the customer is looking for a statement of support specifically for the following:

AWS Fargate

[https://aws.amazon.com/fargate/|https://aws.amazon.com/fargate/]

GCP cloudrun

[https://cloud.google.com/run/?utm_source=google&utm_medium=cpc&utm_campaign=na-US-all-en-dr-bkws-all-all-trial-e-dr-1605212&utm_content=text-ad-none-any-DEV_c-CRE_623126732147-ADGP_Desktop%20%7C%20BKWS%20-%20EXA%20%7C%20Txt%20_%20General%20_%20Product%20Support-KWID_43700073231538795-kwd-678836618049&utm_term=KW_gcp%20cloud%20run-ST_gcp%20cloud%20run&gclid=Cj0KCQjw_r6hBhDdARIsAMIDhV9S0PHu2IuPLXWMrLqLe6xZ_Tnx4H72-WAPh13LG3SZTwB60uZX-JAaApF_EALw_wcB&gclsrc=aw.ds|https://cloud.google.com/run/?utm_source=google&utm_medium=cpc&utm_campaign=na-US-all-en-dr-bkws-all-all-trial-e-dr-1605212&utm_content=text-ad-none-any-DEV_c-CRE_623126732147-ADGP_Desktop%20%7C%20BKWS%20-%20EXA%20%7C%20Txt%20_%20General%20_%20Product%20Support-KWID_43700073231538795-kwd-678836618049&utm_term=KW_gcp%20cloud%20run-ST_gcp%20cloud%20run&gclid=Cj0KCQjw_r6hBhDdARIsAMIDhV9S0PHu2IuPLXWMrLqLe6xZ_Tnx4H72-WAPh13LG3SZTwB60uZX-JAaApF_EALw_wcB&gclsrc=aw.ds|smart-link] 



using a case history search, I do not find any direct mention for GCP cloudrun, and only one 2021 case mentioning AWS fargate (the case update indicated that “fargate” had not been tested, hence not formally supported… i.e. use at your own risk…

so the ask here is whether either AWS Fargate or GCP Cloudrun is or is not formally supported with the latest releases of ISVA, or if this will require an RFE (Idea) request from the customer… ",,Nick Lloyd,tonyferg,,,,,,,,,,,,,,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011901930,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Charles David Hooks,5b15d9936d76184b7d989c82,,,,State of Michigan,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1ae3r:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-04-11 00:34:20.842,,,,,"11/Apr/23 10:34 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9936d76184b7d989c82] - I’m confirming with the Dev team, but I suspect these are not officially supported and doubt there are any plans of doing so. Doing a bit of a read up on both, I suspect Fargate may work but I doubt Cloudrun would. Will let you know. ","18/Apr/23 8:24 AM;5b232b2fd85e5b59b066f57f;[~accountid:5b15d9936d76184b7d989c82] - as suspected, these platforms are not formally supported and no plans to do so at this stage. ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Remote syslog forwarder (rsyslogd) using TLSv1.0 Client Hello,ISAMSUP-4964,292794,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,08/Apr/23 2:55 AM,09/May/23 9:50 PM,14/Jul/23 2:47 PM,09/May/23 9:50 PM,,,,0,,,,"The Client Hello from the remote syslog forwarder is using TLSv1.0, in the packet trace at H:\sf\TS012\664\TS012664932\2023-04-06\isam_9.0.7.2_20230406-145418_vaisamp101.bcbsnc.com.support (Blue Diamond). The client’s server only accept TLSv1.2 connections. Is there a configuration option to do this?",,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012664932,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,BLUE CROSS AND BLUE SHIELD OF NORTH CAROLINA,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,H:\sf\TS012\664\TS012664932\2023-04-06,,,,,,,,,,,,,,,,,,,,,,,0|i1ac6n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAM 9.0.7.2,,,,,,,,,,,,,2023-04-07 20:56:27.542,,,,,08/Apr/23 6:56 AM;5b15d94b6256d01ad54eb020;I took a look at this and in  907x  we used an older version of rsyslog so I think this might not be possible.  At best it had early implementation of  TLS 1.2.  ,"11/Apr/23 5:37 AM;5bac25a37de8532e315430c5;The client says that rsyslogd starts using TLSv1.2, then after a day or two stops. Given the timeframe, what type of data would be useful for determining what is happening?","11/Apr/23 10:15 PM;5b15d94b6256d01ad54eb020;Off hand, I think an IP trace might help.  ","12/Apr/23 12:30 AM;5bac25a37de8532e315430c5;What version of rsyslogd does ISAM 9.0.7 use? The client is asking if there is a way to use the *gnutlsPriorityString* parameter. [https://www.rsyslog.com/files/temp/doc-indent/configuration/modules/imtcp.html|https://www.rsyslog.com/files/temp/doc-indent/configuration/modules/imtcp.html|smart-link] 

How much of a packet would you need, since the issue may take quite a while to recur? ","12/Apr/23 11:30 AM;5b15d954b0d76456f36daf33;** Internal **

[~accountid:5bac25a37de8532e315430c5] according to your link:

{noformat}gnutlsPriorityString <string>

Available since 8.29.0{noformat}

9.0.7.x is running an older version like Bill said.

{noformat}# rsyslogd -v
rsyslogd 7.4.7, compiled with:
	FEATURE_REGEXP:				Yes
	FEATURE_LARGEFILE:			No
	GSSAPI Kerberos 5 support:		Yes
	FEATURE_DEBUG (debug build, slow code):	No
	32bit Atomic operations supported:	Yes
	64bit Atomic operations supported:	Yes
	Runtime Instrumentation (slow code):	No
	uuid support:				Yes{noformat}

10.0.5.0 has this: 

{noformat}# rsyslogd -v
rsyslogd  8.2102.0-7.el8.1.ibm.1 (aka 2021.02) compiled with:
	PLATFORM:				x86_64-koji-linux{noformat}

which I’m not entirely sure has compatibility with that {{gnutlsPriorityString}}. Even if it did, I don’t know how do we specify that on the appliance.

If you can, give it a try on a local 10.0.5.0 and see if there is an improvement over the default TLSv1.0. Then suggesting a firmware upgrade to the customer might be an option.","15/Apr/23 6:45 AM;5b15d94b6256d01ad54eb020;I don’t think the versions  of rsyslog or gnutls  on  9.0.7.x  that  we have, support gnutlsPriorityString.  I’m pretty sure it’s an early version of tls 1.2.

As Bhavan mentioned, if TLS 1.2 is a requirement they really should upgrade the firmware.

*Internal comment:*

 rsyslogd 7.4.7  dates back to 2013 but that’s what was in mcp.

I have the  source for  rsyslogd 7.4.7  and there is no reference to  gnutlsPriorityString  at all in that src tree.   The same applies  to 

gnutls-3.3.29.",18/Apr/23 5:38 AM;5bac25a83a6aa22dbebb46cf;Customer has uploaded a packet indicating it confirms what she is saying. ,"18/Apr/23 5:50 AM;5b15d94b6256d01ad54eb020;What is the exact version they have installed?   Is it 9.0.7.2 IF3?

( I removed my last update because I realized it doesn’t apply.  )","18/Apr/23 6:05 AM;5b15d94b6256d01ad54eb020;I’m getting errors trying to  connect to BD server.   Were you able to look at it?

Update: I was finally able to get on there and look around before my connection was lost.  Not sure what the problem is.  However, I did bring up wireshark to look at the latest pcap file.  I sorted it by protocol and did not find any TLSv1.0 packets. They were all TLSv1.2.  



I really think it would best if they could upgrade to 10.x so they would be using a newer version of rsyslog.  ",09/May/23 9:50 PM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
 Liberty memory leak fix for ISVA V10.0.5.0,ISAMSUP-4957,292485,Support,In Progress,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,,Bill Tyler,5b15d94b6256d01ad54eb020,oscar.jimen,6333216f748d1bfcb85982ca,oscar.jimen,6333216f748d1bfcb85982ca,06/Apr/23 4:27 AM,11/Jul/23 1:55 AM,14/Jul/23 2:47 PM,,,,,0,Growth,,,"*Problem Description:*
This is a follow-up to *TS010027569* which in turn is a follow-up to *TS004924827*. Dear IBM Support, *After upgrading to V10.0.5.0*, I checked the *Liberty version as advised in TS004924827*. *Liberty in V10.0.5.0 is on V22.0.0.9* *which is newer than 21.0.0.8.* However the problem seems still there. We got an outage yesterday. Would you please confirm if the fix indeed get included in *V10.0.5.0*? if not, *_would you please generate a quick fixpack for us?_* I am also going to upload support file just in case this is a new problem. Thanks in advance! Frank



From L2 support

From the case: *TS010027569*

||Known Issue IdSorted Ascending||Problem Summary Text Display||SortStatus||SortLegacy Defect Number||SortLegacy Defect Type||Action|| ||
| ||[DT105002|https://ibmsf.lightning.force.com/lightning/r/aCI3p000000L8NIGA0/view]|make the memory leak fix into official build| |IJ33186|APAR|Show Actions|
| ||[DT141218|https://ibmsf.lightning.force.com/lightning/r/aCI3p000000XiPjGAK/view]|[https://cloudidentity.atlassian.net/browse/ISAMSUP-4343|https://cloudidentity.atlassian.net/browse/ISAMSUP-4343|smart-link]| |ISAMSUP-4343|JIRA| |

No APART: IJ33186

[APARs fixed by IBM Security Verify Access version 10.0.5|https://www.ibm.com/support/pages/node/6843969]

From the case: *TS004924827*

||Item Number||SortKnown Issue IdSorted Ascending||Problem Summary Text Display||SortStatus||SortLegacy Defect Number||SortLegacy Defect Type||Action||
| ||[DT095514|https://ibmsf.lightning.force.com/lightning/r/aCI3p0000008UtsGAE/view]|[https://cloudidentity.atlassian.net/browse/ISAMSUP-2868|https://cloudidentity.atlassian.net/browse/ISAMSUP-2868|smart-link]| |ISAMSUP-2868|JIRA|Show Actions|
| ||[DT105002|https://ibmsf.lightning.force.com/lightning/r/aCI3p000000L8NIGA0/view]|make the memory leak fix into official build| |IJ33186|APAR| |

No APART: IJ33186

[APARs fixed by IBM Security Verify Access version 10.0.5|https://www.ibm.com/support/pages/node/6843969]

>>We got an outage yesterday. Would you please confirm if the fix indeed get included in V10.0.5.0? if not, *_would you please generate a quick fixpack for us?_*



----

Adding Skill cases here for reference:

TS012804966 LS SDK TEAM
TS012959554 L3 WEB SERVICES (JAX-WS)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4936,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012635520,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,oscar.jimen,6333216f748d1bfcb85982ca,,,,Frank Wang,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i1aab3:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-04-05 20:36:26.34,,,,,06/Apr/23 6:36 AM;5b15d94b6256d01ad54eb020;I think  22.0.0.9  should have the fix in there so we could be looking at a different problem.  I’ll investigate.    ,"06/Apr/23 7:24 AM;5b15d94b6256d01ad54eb020;If they see this again have  them generate a heapdump  and send that in.

Meanwhile I sent a note to Liberty to find out if that fix was in 22.0.0.9  or not and to confirm if the jar file with the fix is compatibile.",08/Apr/23 12:27 AM;5b15d94b6256d01ad54eb020;I’m still waiting on a reply to my email.   I engaged them in slack too since I haven’t heard anything.,08/Apr/23 1:32 AM;5b15d94b6256d01ad54eb020;I’m told that the liberty version included with  10.0.5.0  is very different from the versions we shipped previously.  So  we really need a heapdump in order to trouble shoot this.,12/Apr/23 2:13 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] When you said heapdump you mean this ?>>[Heap dump|https://www.ibm.com/docs/en/sdk-java-technology/8?topic=dumps-heap-dump],"12/Apr/23 3:12 AM;5b15d94b6256d01ad54eb020;I mean to logon to the CLI as ‘admin’

Goto Diagnostics

Then run:   java_dump  runtime heap

It would also be a good idea to run:

java_dump runtime thread

Then collect a support file and send it in.","12/Apr/23 9:47 PM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020]I asked the customer for the diagnostic files, and the customer replied the following:

“Hi Oscar, I guess that means the only thing can be done for now is to wait for it to happen again.

Would you please at least help me get a answer to my initial question?

""Would you please confirm if the fix indeed get included in V10.0.5.0?""“","12/Apr/23 11:32 PM;5b15d94b6256d01ad54eb020;The issue they are seeing is different because the version of liberty is  different. The file we patched does not exist in this version.  

They don’t have to wait  for the memory issue  to become so bad they are having problems.  They can monitor the growth and as they see it increase and not stabilize then collect a heapdump and thread dump.  We can start with that.   Collecting  a few over several days is helpful.

One thing I’m wondering is how fast the memory use is rising? 

How often has the problem occurred with 10.0.5.0 ?","13/Apr/23 10:31 PM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] FYI- comment from the customer: “I have setup crontab to trigger core dumps at one hour interval, will do a heap dump after 3 days, generate support file and send it over after 3 days. Last time it take over 2 weeks to buildup to become user noticeable problem.”","18/Apr/23 8:48 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] The customer attached to the cases, the Support files including coredumps and heapdumps uploaded.

[2023-04-17/isva_10.0.5.0_20230416-233057_citadel2.avnet.com.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012635520&path=TS012635520/2023-04-17/&filepath=TS012635520/2023-04-17/isva_10.0.5.0_20230416-233057_citadel2.avnet.com.support]

----

[2023-04-17/isva_10.0.5.0_20230416-233019_citadel1.avnet.com.support|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012635520&path=TS012635520/2023-04-17/&filepath=TS012635520/2023-04-17/isva_10.0.5.0_20230416-233019_citadel1.avnet.com.support]","18/Apr/23 9:06 AM;5b15d94b6256d01ad54eb020;Thanks,  I’ll take a look at them.","20/Apr/23 7:56 AM;5b15d94b6256d01ad54eb020;

Looking in  one of the heapdumps   ( 23019 )  43.6% of the java heap  was used by  1,783,383 instances of: com/ibm/ws/jaxws/ConduitConfigurer$PidInfo

In the other heapdump ( 233057)

this same class used over 45% of the java heap and  consisted of 1,861,426   instances.

In both  heapdumps that class looks like the largest culprit and in the short time between the heapdumps there was growth.

In the previous version of Liberty the culprit was:

org.apache.cxf.transport.http.osgi.HTTPTransportActivator$PidInfo

so based on the name alone it makes me suspicious that this could be the same problem in the new version.  However, I haven’t found a stack yet that is using that class.

The next step is for L2 to open a case with Liberty and send them the heapdump.  Let me know the case so I can relay it to the contacts I have.   ",21/Apr/23 6:11 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020]  FYI- The skill case was opened with WASSDK team. Case# TS012804966 Case Owner>Piotr Zalewski is checking the support files attached including coredumps and heapdumps.,21/Apr/23 6:12 AM;5b15d94b6256d01ad54eb020;Thanks [~accountid:6333216f748d1bfcb85982ca] ,26/Apr/23 11:33 PM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020]  Are you able to see this case TS012635520? ,26/Apr/23 11:45 PM;5b15d94b6256d01ad54eb020;I don’t know. If there is an update I don’t get updates. Aren’t you monitoring it?,"27/Apr/23 12:14 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] Yes, I'm monitoring the case. This is because there are a couple of back/fourth emails from Liberty and the customer. So I just want to know if you were able to see/check the case. So based on what you are saying. I need to share a recap of these emails with you (I'll do it in a few minutes). ","27/Apr/23 12:15 AM;5b15d94b6256d01ad54eb020;I’ll take a look but you need to let me know when there is an update you want me to see.

It is also best to update  the Jira with any additional information that comes up.","07/May/23 3:34 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] FYI- Just updated Liberty team from our skill case:



*Please check the following information from the customer:*

Can please update the status?

Please can you help check with other team to quickly troubleshoot as this is impacting our prod tier environment with live 90 applications . Thanks.

FYI.

*There are two occasions with same problem and resolved by install another liberty fixpatch.*

*TS004924827 Feb. 2021*

[https://www.ibm.com/mysupport/s/case/5003p00002hu4urAAA/isamsup4343-liberty-memory-leak-fix-for-isva-v10040?language=en_US|https://www.ibm.com/mysupport/s/case/5003p00002hu4urAAA/isamsup4343-liberty-memory-leak-fix-for-isva-v10040?language=en_US]

*Resolution Description:*

Hi Frank,

Unfortunately there is no APAR on the ISVA side as the problem was not on the ISVA software but on the Liberty version that ISVA uses, we got confirmation from the Liberty team that the problem is fixed on Liberty version 21.0.0.8, so you will need to keep track of the Liberty version that ISVA uses.

At this moment ISVA 10.0.3.1 uses Liberty 21.0.0.6 version, to check the version you can go on a browser to the IP address/DNS name and port that AAC/Federation are running and this will show you a screen like the one attached, for example

LMI -> AAC -> Runtime Parameters shows that the interface is using IP address 10.0.2.128 and running on port 444 so I will need to go to [https://10.0.2.128:444|https://10.0.2.128:444/] and that will show me the Liberty version page.

A fixpack was created for this issue on jira [https://cloudidentity.atlassian.net/browse/ISAMSUP-2868|https://cloudidentity.atlassian.net/browse/ISAMSUP-2868|smart-link] 



*TS010027569 July. 2022*

[https://www.ibm.com/mysupport/s/case/5003p00002hu4urAAA/isamsup4343-liberty-memory-leak-fix-for-isva-v10040?language=en_US|https://www.ibm.com/mysupport/s/case/5003p00002hu4urAAA/isamsup4343-liberty-memory-leak-fix-for-isva-v10040?language=en_US]

*Resolution Description:*

L3 provided 10.0.4 version of the FP

I've published a 10.0.4 version of the fix. Don't worry about the support file. This fix is just a liberty jar.","11/May/23 6:52 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca]  The jar file  that contained the fix in previous releases does not exist in the 22.0.0.9 version of Liberty we are now using.  I was looking over the case  TS012635520  and it seems Liberty wants us to update to the latest which isn’t possible.   Have they identified any fixes in the newer version of Liberty that would resolve this?

[~accountid:5ac57757d9a96536d1f0daa9] we’re going to need some help working with Liberty on this.  I don’t think it’s practical to try update to the latest version and see if that helps.","11/May/23 7:26 AM;5b15d94b6256d01ad54eb020;Looking over [https://www.ibm.com/support/pages/node/715557#220010|https://www.ibm.com/support/pages/node/715557#220010]

there are a few leaks fixed but we can’t sure if any of those are the ones we are currently seeing.","11/May/23 9:53 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] Thanks for sharing this information. Just FYI- I have two skill cases open: 1. The first skill case with *WAS SDK team* suggested by you. and another case opened (second skill case with *WAS WIN team*) suggested by WAS SDK team. So in case If want to talk with:

WAS SDK team:  Piotr Zalewski

WAS WIN team: Ravi GADIREDDY",11/May/23 10:10 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca] please make sure we have both skills cases documented here. Pin the comment or add them to  the description so we can find them.  I think you provided one of them but I’m not sure about the other.  Thanks.,"11/May/23 11:22 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] FYI - Skill cases:

TS012804966 LS SDK TEAM
TS012959554 L3 WEB SERVICES (JAX-WS)

Let me know if you need something else!",22/May/23 12:59 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] can you please review this as part of the other memory growth issues.,23/May/23 12:28 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca] do you have any updates on the Skills Cases?  I’m not authorized to view them so I can’t see the updates.,"02/Jun/23 6:16 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] Here is the recap:

Basically, there have been back/forth emails between WAS SDK L2 and WAS WIN L2 (Also WAS WIN L2 with WAS WIN L3). They provided me with steps or procedures to collect logs to start troubleshooting the issue; however, the customer is complaining they can’t provide any logs since they are using a virtual appliance. The customer is asking for a *fixed pack for a Virtual Appliance*.

*Some comment from the customer:*

“In this case , it's mentioned Liberty in V10.0.5.0 is on V22.0.0.9, can you team can release the latest fixpatch for it.  “

“It was already mentioned Avnet is using Virtual Appliance version of ISAM. It's not possible to individually upgrade on our side to the most current level of Liberty level  as a software-based version.  “

Last comment from WAS: L2 SDK

Hello Oscar,

“We are not familiar with this virtual appliance so you or the team(ISVA or ISAM?) that owns the virtual appliance needs to make the changes to capture the data we need.”

Customer is hot… Please advise?","02/Jun/23 6:31 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca]   ​“We are not familiar with this virtual appliance so you or the team(ISVA or ISAM?) that owns the virtual appliance needs to make the changes to capture the data we need.”

What data is WAS  asking for?  They have a heapdump and javacores.

--

They are not the only ones having a problem like this with liberty.   ISVA  Development has been looking into the memory issues with 10.0.5.0.   I think they are making progress but I don’t think we have a fix yet.  

[~accountid:5ac57757d9a96536d1f0daa9] [~accountid:5ac577587028785d133fbc46]  Is there anything we can share with the customer on this yet?   I don’t know if the problem Avnet is having is the same as what others are having but I suspect so.","02/Jun/23 12:52 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d94b6256d01ad54eb020] the fix that we are currently working on is related to OpenJDK.

[~accountid:5b15d954b0d76456f36daf33] can you please take a quick look to confirm if this issue is the same as the one we are investigating?","03/Jun/23 3:07 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] *last comment from WAS WIN L3 team:*

The CXF version in Liberty 22.0.0.9 has been upgraded to a new CXF release which is completely different from the CXF version  in Liberty 22.0.0.7 and earlier versions. The CXF code where a memory leak was fixed for case TS005409994 has been completely re-factored in new CXF version and the same memory leak may not exist in the new CXF version.

Please ask the WASSDK team to provide more details about the memory leak in Liberty 22.0.0.9. Any information on which CXF objects or classes are causing this memory leak will be helpful to debug this issue in new CXF code.

……………………………………………………………………………………………………………………………………………….

*Based on above information the WAS SDk L2 team asked this information to the customer:*

1.Could they please quantify the slowness vs expected (in seconds, minutes, etc)? >> This will help us to determine an appropriate data to collect data. 

If verboseGC was enabled at that time, please upload the full liberty logs for a review and see if it gives us something. If verboseGC was not enabled, then enable it per this link and restart the JVM.

""WebSphere Liberty verbosegc from Startup Recipe"" [https://publib.boulder.ibm.com/httpserv/cookbook/Troubleshooting_Recipes-Troubleshooting_WAS_Liberty_Recipes-WAS_Liberty_verbosegc_from_Startup_Recipe.html|https://publib.boulder.ibm.com/httpserv/cookbook/Troubleshooting_Recipes-Troubleshooting_WAS_Liberty_Recipes-WAS_Liberty_verbosegc_from_Startup_Recipe.html|smart-link] 

If they see the high memory issue, download the linperf script from the below link and run it as root user against the problematic JVM PID while the issue is occurring.
[https://www.ibm.com/support/pages/node/1073532|https://www.ibm.com/support/pages/node/1073532]

Please check the following information form L3 WAS WIN:

Please review the following response from our development team. It is really important to have the new set of docs reviewed by the SDK team and see what else is causing the issue.

……………………………………………………………………………………………………………………………………………………

After we sent this information to the customer, the customer got angry and repeatedly mentioned that they have Virtual Appliance and can’t collect those logs.

*Last comment from customer:* “It's not possible ,did you understand . What you WAS team asked with script ,command can not execute on ISAM appliance which is basically a black box . Did you hear that , that's annoying and disturbing . Except for bugging us , can you do it on your lab to run and show it ....”","03/Jun/23 3:17 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca] I explained early on with this Jira  that the issue fixed previously  didn’t apply to 22.0.0.9.  

Customers don’t have  access to the appliance so they can’t run Liberty with those settings.  To do that will require a fixpack.  Tony asked Bhavan to compare this item with other liberty ones they have been looking into.  If he thinks this is same, I think it probably is, then the fix development is working on will apply. If not then I’ll write a fix pack to get the WAS L3 the logs they need.  We should know which we’ll go early next week.","07/Jun/23 3:19 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] I was contacted by Bill Buchanan (CTP for the Avnet account) on behalf of the customer, asking for an update. thx",09/Jun/23 2:28 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] wondering if we might be able to assist this customer with the latest appliance fix pack. Thoughts? ,09/Jun/23 3:49 PM;5b232b2fd85e5b59b066f57f;[https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|https://cloudidentity.atlassian.net/browse/ISAMSUP-5130|smart-link] addresses an issue where crypto operations can result in a JVM memory leak. It may be worthwhile the customer trying this fix-pack; if nothing else to isolate this as a contributing factor. ,09/Jun/23 11:22 PM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca] Please see David Hayes' update.  ,"13/Jun/23 11:22 PM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] comment from the customer: “I have the fixpack applied in our lower tiers yesterday.

While I see that is just a minor JRE version bump from version 11.0.16.1+1 to version 11.0.19+7. Would you please explain how it is relates to the issue we are facing?“",13/Jun/23 11:57 PM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca]  refer to the comment by David Hayes.,27/Jun/23 12:38 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] [~accountid:5b232b2fd85e5b59b066f57f] Comment from the customer: “There is no change to the CPU utilization pattern. It still keep increasing after each restart.”,27/Jun/23 12:42 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca] thanks for the update.  Did they send in a new support file with a javacore  and heapdump as the problem occurred?,27/Jun/23 11:16 AM;5ac57757d9a96536d1f0daa9;[~accountid:6333216f748d1bfcb85982ca] can you please confirm if the customer means memory when they have stated CPU in the below response? This issue was first opened for memory growth not CPU so I just want to be 100% sure that this is the same issue we are discussing. ,"27/Jun/23 11:58 PM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] No, they dd not send any support file. Do you want to ask for a new support file with a javacore and heapdump as the problem occurred?","28/Jun/23 12:02 AM;5b15d94b6256d01ad54eb020;[~accountid:6333216f748d1bfcb85982ca]  Yes.  That fix pack did help other customers which is why we needed them to try.  They should leave it installed since it does correct a few issues with Liberty. Unfortunately they still have issues.   So to trouble shoot we definitely need a need javacore and heapdump.  

Also, please answer Tony’s  questions.","06/Jul/23 12:48 AM;6333216f748d1bfcb85982ca;[~accountid:5b15d94b6256d01ad54eb020] [~accountid:5ac57757d9a96536d1f0daa9] comment from the customer Frank, and Norton Brainard (IBM): “I have received an email stating that the issue is actually a High CPU and Thread Leak issue according to the client. Please gather the javacore and heapdump per L3's request to continue troubleshooting.“

Based on this comment I will ask the customer to provide javacore and heapdump.",11/Jul/23 1:53 AM;5bac25a83a6aa22dbebb46cf;Customer has provided support files from 2 systems.,11/Jul/23 1:55 AM;5b15d94b6256d01ad54eb020;Thanks I’ll take a look.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,In Progress
ISVA 10.0.3.1 fixpack requested for APAR IJ42276,ISAMSUP-4899,288277,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Peter Horner,5b15d9517dab4c51f61b5190,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,21/Mar/23 2:26 AM,14/Apr/23 10:45 AM,14/Jul/23 2:47 PM,14/Apr/23 10:45 AM,,Support,,0,,,,"The client is now requesting a fixpack for APAR IJ42276, opened for [https://cloudidentity.atlassian.net/browse/ISAMSUP-4424|https://cloudidentity.atlassian.net/browse/ISAMSUP-4424|smart-link]. The following fixpacks are installed on ISVA 10.0.3.1.



{noformat}+ /usr/sbin/mesa_control fixpack_get_history

Monday, July 11, 2022 at 9:45:04 PM|SERVER_STATUS_FIX|Server_Status_Fix|Yes|Installed|This fixpack corrects a problem with Liberty server status command not executing correctly.|1657575904

Monday, July 11, 2022 at 9:46:18 PM|URL_macro_is_not_server_relative_10031|URL_macro_is_not_server_relative_10031|Yes|Installed|URL in macro is not relative in 10.0.3.1|1657575978{noformat}",,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4913,,,,,,,,,,,,,,,,,,,IJ42276,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012464357,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,A T & T SERVICES INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,https://ecurep.mainz.de.ibm.com/ae5/#id=TS012464357&path=TS012464357%2F2023-03-16%2Fisva_10.0.3.1_20230316-191628_tlpv10692.enaf.dadc.sbc.com.support_unpack%2F&filepath=TS012464357%2F2023-03-16%2Fisva_10.0.3.1_20230316-191628_tlpv10692.enaf.dadc.sbc.com.support,,,,,,,,,,,,,,,,,,,,,,,0|i19jwf:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-03-23 06:34:27.424,,,,,"21/Mar/23 2:36 AM;5bac25a37de8532e315430c5;They do not currently have plans to upgrade to 10.0.5.0, as they only upgraded to 10.0.3.1 in January.",23/Mar/23 4:34 PM;5b15d9517dab4c51f61b5190;Fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4913|https://cloudidentity.atlassian.net/browse/ISAMSUP-4913|smart-link] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
DB2 Connection pool creating failing from within custom extension after updating to v10.0.5.0 Firmware,ISAMSUP-4894,288134,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,18/Mar/23 2:13 AM,02/Jun/23 1:14 PM,14/Jul/23 2:47 PM,02/Jun/23 1:14 PM,,Support,,0,,,,"Customer TRUIST FINANCIAL CORPORATION has asked us to open a support case as it appears that a custom extension that they use for biometric authentication mechanisms has stopped functioning properly in their non-production environments after a recent firmware update to v10.0.5.0.

This is the stack trace for the error when the DB2 connection pool utilized by the extension attempts to start.

{noformat}2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:41:045 EDT] 00000202 security.access.controller.BiometricAuthenticationController I Authentication method calling
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:41:061 EDT] 00000202 com.truist.dias.biometrics.processor.BiometricsProcessor I BiometricProcessor: INSIDE THE BIOMETRIC AUTHENICTATION METHO.................
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:41:063 EDT] 00000202 com.truist.dias.biometrics.processor.BiometricsProcessor I BiometricProcessor: INSIDE NOUNCE CHECK.................
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:41:068 EDT] 00000202 com.truist.dias.biometrics.repository.BiometricsRepository I INSIDE BiometricsRepository SETUP DB....
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:41:086 EDT] 00000202 SystemErr R SLF4J: Class path contains multiple SLF4J bindings.
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:41:086 EDT] 00000202 SystemErr R SLF4J: Found binding in [bundleresource://362.fwk1291001101:11/org/slf4j/impl/StaticLoggerBinder.class]
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:41:086 EDT] 00000202 SystemErr R SLF4J: Found binding in [bundleresource://362.fwk1291001101:14/org/slf4j/impl/StaticLoggerBinder.class]
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:41:087 EDT] 00000202 SystemErr R SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings  for an explanation.
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:41:148 EDT] 00000202 SystemErr R 52 [Default Executor-thread-192] INFO com.zaxxer.hikari.HikariDataSource - dias-hikari-live-pool - Starting...
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:954 EDT] 00000202 SystemErr R 1858 [Default Executor-thread-192] ERROR com.zaxxer.hikari.pool.HikariPool - dias-hikari-live-pool - Exception during pool initialization.
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:954 EDT] 00000202 SystemErr R java.security.AccessControlException: com.ibm.db2.jcc.am.jc
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:955 EDT] 00000202 SystemErr R #011at com.ibm.security.access.extension.security.ToggleableSecurityManager.checkPermission(ToggleableSecurityManager.java:293)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:955 EDT] 00000202 SystemErr R #011at java.base/java.lang.SecurityManager.checkWrite(Unknown Source)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:955 EDT] 00000202 SystemErr R #011at java.base/java.io.File.createNewFile(Unknown Source)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:956 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.am.jc.run(jc.java:34)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:956 EDT] 00000202 SystemErr R #011at java.base/java.security.AccessController.doPrivileged(Unknown Source)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:956 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.am.ib.b(ib.java:1840)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:958 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.am.ib.q(ib.java:1076)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:958 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.am.fp.a(fp.java:459)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:959 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.t4.b.d(b.java:6679)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:959 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.t4.a.a(a.java:889)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:959 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.t4.a.L(a.java:822)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:960 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.t4.b.a(b.java:415)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:960 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.t4.b.a(b.java:396)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:960 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.t4.b.<init>(b.java:334)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:961 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:231)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:961 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.DB2SimpleDataSource.getConnection(DB2SimpleDataSource.java:197)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:961 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:472)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:962 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.DB2Driver.connect(DB2Driver.java:113)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:962 EDT] 00000202 SystemErr R #011at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:962 EDT] 00000202 SystemErr R #011at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:354)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:966 EDT] 00000202 SystemErr R #011at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:202)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:967 EDT] 00000202 SystemErr R #011at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:473)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:967 EDT] 00000202 SystemErr R #011at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:554)
2023-03-14T14:57:50-04:00 sif-aismmbl02 sif-aismmbl02_runtime [3/14/23, 14:57:42:971 EDT] 00000202 SystemErr R #011at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:115){noformat}

This seems to possibly be related to some sort of Java security control difference between the firmware versions as this does work in their production environment currently, where they are still using the v10.0.4.0_IF1 version of the firmware. I have checked with them and configuration for non prod (not working) vs prod (working) are really similar. 

This is a custom authentication mechanism developed using the com.ibm.security.access.extension_8.0.0.zip access control runtime SDK downloaded from the appliance and the resulting jar file added to the runtime through the AAC/Extensions menu...I have attached a screenshot of the extension name and the .jar if needed.

!image-20230317-160938.png|width=661,height=307!",,Asha Shivalingaiah,Brandon Garay,jcyarbor,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,5af4ad7d4dd24c579110120b,60e721f12d49fd00698bb49d,5bac25aaabfcbf73d13e733b,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4903,,,,,,18/Mar/23 2:13 AM;ug:275ff04c-c0ea-4352-ba27-038f12b39f96;image-20230317-160938.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190872,20/Mar/23 10:45 AM;ashashiv;image-20230320-004034.png;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/190978,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012446443,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,TRUIST FINANCIAL CORPORATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"Citrix Path Support file: S:\sf\TS012\446\TS012446443\2023-03-15\isva_10.0.5.0_20230315-143500_sif-aismmbl02.bbtdmztst.local.support_unpack\

Citrix Path .JAR File: S:\sf\TS012\446\TS012446443\2023-03-16\com.bbt.security.access.bbtviewmobibiomech.ssah_1.0.0.jar",,,,,,,,,,,,,,,,,,,,,,,0|i19j13:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-17 17:21:08.975,,,,,"18/Mar/23 3:21 AM;5b15d94b6256d01ad54eb020;If you follow that link, it gives you an explanation of the error SLF4J.    Also in that stack it says:  “Class path contains multiple SLF4J bindings.”.  That link describes the the error as a warning so are they really having a problem other than that?

Since I don’t know anything about their extension, it’s hard to say what is going on but  this sounds like an error in the application or with how it is configured.  It could be that  10.0.5 does a better job at  detecting it which might explain the error/warning now. ",20/Mar/23 8:16 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] can you please review this item during your day. I am interested in understanding a little more regarding what this extension they are using. ,"20/Mar/23 10:45 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

Was their production and non production both upgraded from 10040IF1 to 10050? 
Is the issue specific to non production?

Under LMI → Administrator configuration → 

Is there a difference if you set these two configs to include TLSv1.0 and  TLSv1.1 and then test the extension. 

!image-20230320-004034.png|width=1727,height=136!




Based on these errors from the logs - 

{noformat}[3/3/23, 10:21:22:983 EST] 0000002e id=00000000 SystemErr                                               R SLF4J: Failed to load class ""org.slf4j.impl.StaticLoggerBinder"".{noformat}

{noformat}[3/3/23, 10:22:57:290 EST] 00000043 id=00000000 SystemErr                                                    R 88 [Default Executor-thread-5] INFO com.zaxxer.hikari.HikariDataSource - dias-hikari-live-pool - Starting...
[3/3/23, 10:22:58:960 EST] 00000043 id=00000000 SystemErr                                                    R 1759 [Default Executor-thread-5] ERROR com.zaxxer.hikari.pool.HikariPool - dias-hikari-live-pool - Exception during pool initialization.
[3/3/23, 10:22:58:961 EST] 00000043 id=00000000 SystemErr                                                    R java.lang.IllegalArgumentException: Unsupported protocolSSL_TLS{noformat}

{noformat}[3/3/23, 10:22:59:005 EST] 00000043 id=00000000 security.access.controller.BiometricAuthenticationController I MSG:ISAM tcqapr106 BIOMETRIC: Status Desc: Failed to initialize pool: Unsupported protocolSSL_TLS{noformat}

If it is specific to non production - Have they tried removing and redeploying the extension? 
","21/Mar/23 6:50 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5af4ad7d4dd24c579110120b] 

Their *production* environment is still currently at v10.0.4.0_IF1 and the issue does not exist there. The System/SystemSettings/AdministratorSettings values for Enable TLS Protocols and Enabled Server Secure Protocols are both set to TLSv1.2 only in all of their non-prod environments as well as in production/dr. 

Those settings from my understanding only control the allowed incoming/outgoing protocols used for the LMI, not the AAC runtime environment where the extensions code would be executing. It is my understanding that the LMI and AAC runtime execute under separate processIds and separate Liberty runtime instances, so they don't think those settings apply to this situation.

They have imported a new version of the extension jar file several different times in the non-production environment, including exporting the jar from prod and installing in non-prod and the non-prod environment is the only place where this fails.

They did find this support article but are not sure if this is what is actually causing this specific issue or not...The symptoms and environments would be similar they believe...

[https://www.ibm.com/mysupport/s/defect/aCI3p000000XlXvGAK/dt179015?language=en_US|https://www.ibm.com/mysupport/s/defect/aCI3p000000XlXvGAK/dt179015?language=en_US|smart-link] 

If the issue described in the support article is what is causing the problem, I am not sure that we would be able to implement the suggested workaround from the extension jar code since that would cause a different accessViolation issue based on the protected functions listed on this page I believe...

[https://www.ibm.com/docs/en/sva/10.0.5?topic=control-software-development-kit|https://www.ibm.com/docs/en/sva/10.0.5?topic=control-software-development-kit|smart-link] 

The following are the restricted permissions that cause exceptions:

* java.io.FilePermission(""<<ALL FILES>>"", ""read,write""));
* java.net.SocketPermission("""", ""listen""));
* java.lang.RuntimePermission(""setSecurityManager""));

The workaround from the article indicates setting the protocol specifically on the socket connection when the DB2 connection pool is being established, but I am not sure if that falls under the restricted java.net.SocketPermission above or not.

Thank you.","21/Mar/23 6:52 AM;60e721f12d49fd00698bb49d;This is another update from customer they made on Friday.

The slf4j warnings are not the issue that is causing a problem with the extension functionality, although I believe that the developers of the extension should address them to resolve those as well.

The issue we are trying to solve is the DB connection pool that is failing to initialize due to something in the jdbc pool creation triggering an accessControlException...See stack trace below from the logs provided initially when the case was opened.

{noformat}sif-aismmbl02_runtime [3/14/23, 14:57:41:148 EDT] 00000202 SystemErr R 52 [Default Executor-thread-192] INFO com.zaxxer.hikari.HikariDataSource - dias-hikari-live-pool - Starting...
sif-aismmbl02_runtime [3/14/23, 14:57:42:954 EDT] 00000202 SystemErr R 1858 [Default Executor-thread-192] ERROR com.zaxxer.hikari.pool.HikariPool - dias-hikari-live-pool - Exception during pool initialization.
sif-aismmbl02_runtime [3/14/23, 14:57:42:954 EDT] 00000202 SystemErr R java.security.AccessControlException: com.ibm.db2.jcc.am.jc
sif-aismmbl02_runtime [3/14/23, 14:57:42:955 EDT] 00000202 SystemErr R #011at com.ibm.security.access.extension.security.ToggleableSecurityManager.checkPermission(ToggleableSecurityManager.java:293)
sif-aismmbl02_runtime [3/14/23, 14:57:42:955 EDT] 00000202 SystemErr R #011at java.base/java.lang.SecurityManager.checkWrite(Unknown Source)
sif-aismmbl02_runtime [3/14/23, 14:57:42:955 EDT] 00000202 SystemErr R #011at java.base/java.io.File.createNewFile(Unknown Source)
sif-aismmbl02_runtime [3/14/23, 14:57:42:956 EDT] 00000202 SystemErr R #011at com.ibm.db2.jcc.am.jc.run(jc.java:34){noformat}

I did notice in the lib folder of the jar the developers provided that there appear to be multiple versions of the db2 driver files present in the extension as well so it could potentially be loading an older version or conflicting classes possibly that create the access exception combined with the more recent JDK...

The native db2 connection pools that the runtime creates on its own for the externalized hvdb and config db2 databases that we use do not have any issues, it is just the pool that the extension tries to create itself that is running inside of the restricted context for the extension...

I did suggest to the developers that it would likely be better to utilize the server connections feature to create the DB2 connection pool, but they wanted to know if we could test that functionality before they updated any of the code for this particular extension since it had been working properly in the past.","21/Mar/23 12:40 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

In runtime server.xml we see it is 
<ssl id=""defaultSSLSettings"" keyStoreRef=""defaultKeyStore"" trustStoreRef=""defaultTrustStore"" sslProtocol=""TLSv1.2"">

and the db2jar used are-

<!--Start of DB2 JDBC Lib Definition-->
<library id=""DB2JCC4Lib"">
  <fileset dir=""/opt/ibm/db2/java"" includes=""db2jcc4.jar db2jcc_license_cu.jar""/>
</library>



So is that SSL_TLSV2 being set up in their extension jar? (I cant look at the jar contents on ecurep) 



One thing they could try is adding this advance tuning parameter -


{noformat}Key: runtime_profile.jvm_option.1
Value: -Dhttps.protocols=TLSv1.2 {noformat}

Check if this makes a difference to the behaviour.



From your comments can you clarify these -
{{jar the developers provided that there appear to be multiple versions of the db2 driver files present}} - 
Can you point to this in ecurep - ?
Which multiple versions do they have? 



Do they have these calls in their extension for DB connection poll? 

* java.io.FilePermission(""<<ALL FILES>>"", ""read,write""));
* java.net.SocketPermission("""", ""listen""));
* java.lang.RuntimePermission(""setSecurityManager""));","21/Mar/23 4:10 PM;5af4ad7d4dd24c579110120b;<notes>

10.0.4.0

{noformat} java -cp ./db2jcc4.jar com.ibm.db2.jcc.DB2Jcc -version
IBM Data Server Driver for JDBC and SQLJ 4.28.11{noformat}

10.0.5.0 

{noformat}java -cp ./db2jcc4.jar com.ibm.db2.jcc.DB2Jcc -version
IBM Data Server Driver for JDBC and SQLJ 4.32.28{noformat}

{noformat}https://www.ibm.com/support/pages/node/6963247 {noformat}

TODO: Check if newer jar is available for - db2jcc4.jar ","21/Mar/23 8:26 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

If the previous recommendations do not work then here is a fixpack that replaces with an older version of the db2jcc jar.

[https://cloudidentity.atlassian.net/browse/ISAMSUP-4903|https://cloudidentity.atlassian.net/browse/ISAMSUP-4903|smart-link] 

Restart LMI after installing this fix pack.","30/Mar/23 9:16 AM;60e721f12d49fd00698bb49d;Hey [~accountid:5af4ad7d4dd24c579110120b] .

Customer tried to add the ATP’s but not luck.

Customer now has some follow up questions regarding the fixpack , as per some investigations we have done.

They did extract the driver that they were using in the jar that they provided as well to confirm the version on it and it looks like they are still running an older version of the driver...Customer have them updated to the latest db2jcc4.jar from the v11.5.8 fixpack and see if that corrects their issue before we install the fixpack...

This is the output for the db2 driver jar that I pulled from their extension bundle that I downloaded from the non-prod environment.

java -cp ./db2jcc-db2jcc4.jar com.ibm.db2.jcc.DB2Jcc -version

IBM Data Server Driver for JDBC and SQLJ 4.25.13

Still seeing this stack trace with a new build of the extension jar that was provided today. We did confirm that the jdbc driver version contained within the extension jar was the latest 4.32.28 from the db2 v11.5.8 fixpack level. This appears to be some restriction from the protected area of the runtime where the extension code executes possibly...Not sure if the provided fixpack will make any difference in this specific issue based on the error and the functionality described with the fixpack..

This is the driver version that is output when the runtime initializes the connections to their external config and hvdb databases so I don't know if the fixpack will make any difference since this is the same v4.32.28 jdbc driver version...



{noformat}[3/25/23, 22:57:06:097 EDT] 00000053 com.ibm.ws.rsadapter.impl.DatabaseHelper I DSRA8203I: Database product name : DB2/LINUXX8664
[3/25/23, 22:57:06:097 EDT] 00000053 com.ibm.ws.rsadapter.impl.DatabaseHelper I DSRA8204I: Database product version : SQL110147
[3/25/23, 22:57:06:097 EDT] 00000053 com.ibm.ws.rsadapter.impl.DatabaseHelper I DSRA8205I: JDBC driver name : IBM Data Server Driver for JDBC and SQLJ
[3/25/23, 22:57:06:097 EDT] 00000053 com.ibm.ws.rsadapter.impl.DatabaseHelper I DSRA8206I: JDBC driver version : 4.32.28{noformat}

I think this specific line in the stack trace indicates that this is something with the restrictions placed on the higher security area of the runtime where the extension code is allowed to run...

[3/27/23, 15:09:51:272 EDT] 00000e77 SystemErr R +*at com.ibm.security.access.extension.security.*+ToggleableSecurityManager.checkPermission(ToggleableSecurityManager.java:293)","30/Mar/23 9:17 AM;60e721f12d49fd00698bb49d;As an alternative customer suggested to the extension developers that creating a server connection globally for the AAC runtime for this DB2 connection pool may be an option and having the extension code use the JNDI name from that server connection to access the DB data that they need. *That brought up questions about whether the JNDI would be available to the extension code since the extensions do run in a restricted space of the runtime. Can you confirm whether the server connection approach is potentially a viable option?*



If they can't directly connect to the JNDI name for the server connection they could likely create a database backed PIP and modify how the current data is being accessed in the extension code to use that PIP, or a set of PIPs instead potentially.



_I think we have a few different potential options to try and resolve this issue, but we need to determine which one may be the best way to handle it..._



L2 action : We suggested to apply the fixpack before giving other suggestions, but they are asking the following.

Is the version of the jdbc driver in this fixpack newer than the 4.32.28 version associated with the DB2 v11.5.8 fixpack? Or is there something else that the fixpack is modifying in the runtime? The info file just has a vague description of replacing the jdbc jar...Also I assume this fixpack can be rolled back so that if nothing changes we can restore the environment to match the others that we have running...

*FIXPACK_ID=""replace_db2jcc_10050""*

*FIXPACK_NAME=""replace_db2jcc_10050""*

*FIXPACK_DESCRIPTION=""This fixpack replaces an older version of the jar for db2jcc.""*

*FIXPACK_FIRMWARE_VERSION=""10.0.5.0""*

I am trying to determine if dropping this fixpack directly into our SIT environment where we have been testing the custom extension might cause any other impacts to other applications since we cannot test this extension in a sandbox environment right now prior to installing the fixpack in SIT...","30/Mar/23 9:19 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

In 10.0.5.0 Driver version is - 

{{IBM Data Server Driver for JDBC and SQLJ 4.32.28}} 

In 10.0.4.0 it was -

{{IBM Data Server Driver for JDBC and SQLJ 4.28.11}}

So in this fixpack - I put the  older of the driver i.e. {{IBM Data Server Driver for JDBC and SQLJ 4.28.11}} to see if it works, 

based on this - 

[https://www.ibm.com/mysupport/s/defect/aCI3p000000XlXvGAK/dt179015?language=en_US|https://www.ibm.com/mysupport/s/defect/aCI3p000000XlXvGAK/dt179015?language=en_US|smart-link] 

{noformat}Using IBM Semeru jdk version 1.8.0_332 and above, by default, the SSL TLSV2 is not getting set correctly with the correct protocol version name from JCC driver.
""SSL_TLSv2"" is not supported by OpenJDK, hence it is also not supported by IBM Semeru, which uses OpenJDK's JSSE provider. and hence causes Unsupported protocol SSL_TLSv2 to be returned from Semuru runtime.

The value SSL_TLSv2 is not a valid name for protocol version name that can be set via{noformat}

Fixpack is doing 

{{cp <SQLJ 4.28.11>/db2jcc4.jar /opt/ibm/db2/java/db2jcc4.jar}}

It can be rolled back.","18/Apr/23 10:58 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

I have an updated fixpack at the same location, can you give that a try and let me know how you go.","18/Apr/23 6:46 PM;5af4ad7d4dd24c579110120b;<Notes>

{noformat})
[4/18/23, 18:42:24:194 AEST] 00000043 id=00000000 SystemErr                                                    R javax.net.ssl|DEBUG|43|Default Executor-thread-7|2023-04-18 18:42:24.194 AEST|null:-1|Raw write (
  0000: 15 03 03 00 1A 00 00 00   00 00 00 00 07 0E F5 76  ...............v
  0010: 5F 23 7A 61 C0 58 53 E0   80 1B 99 84 65 01 3E     _#za.XS.....e.>
)
[4/18/23, 18:42:24:195 AEST] 00000043 id=00000000 SystemErr                                                    R javax.net.ssl|ALL|43|Default Executor-thread-7|2023-04-18 18:42:24.194 AEST|null:-1|Closing inbound of SSLEngine
[4/18/23, 18:42:24:195 AEST] 00000043 id=00000000 SystemErr                                                    R javax.net.ssl|ERROR|43|Default Executor-thread-7|2023-04-18 18:42:24.195 AEST|null:-1|Fatal (INTERNAL_ERROR): closing inbound before receiving peer's close_notify (
""throwable"" : {
  javax.net.ssl.SSLException: closing inbound before receiving peer's close_notify
        at java.base/sun.security.ssl.Alert.createSSLException(Unknown Source)
        at java.base/sun.security.ssl.Alert.createSSLException(Unknown Source)
        at java.base/sun.security.ssl.TransportContext.fatal(Unknown Source)
        at java.base/sun.security.ssl.TransportContext.fatal(Unknown Source)
        at java.base/sun.security.ssl.TransportContext.fatal(Unknown Source)
{noformat}

{noformat}<=================================>
[4/18/23, 14:39:51:662 AEST] 000002fe id=00000000 com.ibm.ejs.j2c.FreePool                                     E J2CA0046E: Method createManagedConnectionWithMCWrapper caught an exception during creation of the ManagedConnection for resource jdbc/config, throwing ResourceAllocationException. Original exception: <=================================>Exception Message -> Unsupported protocolSSL_TLSv2
java.lang.IllegalArgumentException: Unsupported protocolSSL_TLSv2
	at java.base/sun.security.ssl.ProtocolVersion.namesOf(Unknown Source)
	at java.base/sun.security.ssl.SSLSocketImpl.setEnabledProtocols(Unknown Source)
	at com.ibm.db2.jcc.t4.w.run(w.java:123)
	at java.base/java.security.AccessController.doPrivileged(Unknown Source)
	at com.ibm.db2.jcc.t4.a0.a(a0.java:434)
	at com.ibm.db2.jcc.t4.a0.<init>(a0.java:96)
	at com.ibm.db2.jcc.t4.a.b(a.java:367)
	at com.ibm.db2.jcc.t4.b.newAgent_(b.java:2229)
	at com.ibm.db2.jcc.am.Connection.initConnection(Connection.java:843)
	at com.ibm.db2.jcc.am.Connection.<init>(Connection.java:788)
	at com.ibm.db2.jcc.t4.b.<init>(b.java:352)
	at com.ibm.db2.jcc.DB2PooledConnection.<init>(DB2PooledConnection.java:83)
	at com.ibm.db2.jcc.DB2ConnectionPoolDataSource.getPooledConnectionX(DB2ConnectionPoolDataSource.java:348)
	at com.ibm.db2.jcc.DB2ConnectionPoolDataSource.getPooledConnection(DB2ConnectionPoolDataSource.java:131)
	at com.ibm.ws.rsadapter.impl.DatabaseHelper$1.run(DatabaseHelper.java:1514)
	at com.ibm.ws.rsadapter.impl.DatabaseHelper$1.run(DatabaseHelper.java:1500)
	at java.base/java.security.AccessController.doPrivileged(Unknown Source){noformat}",19/Apr/23 10:58 AM;5af4ad7d4dd24c579110120b;Currently waiting to get update if there is anything in their extension/custom code if setSSLProtocol is using {{SSL_TLSv2}} and if they can manually update to to TLSv1.2.,"20/Apr/23 4:47 AM;60e721f12d49fd00698bb49d;Thanks [~accountid:5af4ad7d4dd24c579110120b] 

I have provided new fix pack to customer. Currently waiting their testing.","20/Apr/23 12:44 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

There is an offband discussion with the dev team to work around this issue.

We see that there are these properties in the extension- Is environment here the DB2 config? 
What kind/format of values are used in this. I understand this is sensitive information we don't need the exact values but need dummy values in the same format as they are been used for these properties.

{{ldapProviderUrl}}
{{securityPrincipal}}
{{securityCredentials}}
{{environment}}


{noformat}      <AuthenticationMechanism
            class=""com.bbt.security.access.controller.BiometricAuthenticationController"">
         <Properties>
            <Property
                  datatype=""String""
                  key=""ldapProviderUrl""
                  required=""true""
                  sensitive=""false"">
            </Property>
            <Property
                  datatype=""String""
                  key=""securityPrincipal""
                  required=""true""
                  sensitive=""false"">
            </Property>
            <Property
                  datatype=""String""
                  key=""securityCredentials""
                  required=""true""
                  sensitive=""false"">
            </Property>
            <Property
                  datatype=""String""
                  key=""environment""
                  required=""true""
                  sensitive=""false"">
            </Property>
          </Properties>
      </AuthenticationMechanism>{noformat}

Thanks","21/Apr/23 3:16 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5af4ad7d4dd24c579110120b] .

Please see customer response below.

{noformat}ldapProviderUrl is our IBM SDS tied to ISVA/ISAM
securityPrincipal is the LDAP Bind UserID for queries
securityCredentials is the LDAP Bind Password for queries
environment is a static string variable used as an environment marker (DEV/SIT/UAT/etc.) to load environment specific properties files{noformat}



This is a masked data output from the related authMech...

{noformat}{

""attributes"": [],

""description"": ""BBTViewMobile - Biometric Authentication"",

""id"": ""126"",

""name"": ""BBTViewMobile-Biometric"",

""predefined"": false,

""properties"": [

{

""key"": ""environment"",

""value"": ""SIT""

},

{

""key"": ""securityCredentials"",

""value"": ""MASKED""

},

{

""key"": ""securityPrincipal"",

""value"": ""uid=MASKED,ou=serviceaccounts,o=sit.bbt.com,c=us""

},

{

""key"": ""ldapProviderUrl"",

""value"": ""ldaps://HOSTNAME:PORT""

}

],

""typeId"": ""115"",

""uri"": ""urn:ibm:security:authentication:asf:mechanism:bbtviewmobilebiometric""

}{noformat}

I think the DB2 connection pool settings are likely contained in one of the properties files specific to each of the environments. My assumption is that the settings for the connection pool setup are the same and the only diffs between the envs are hostnames, possibly database names and DB2 login creds.","26/Apr/23 8:55 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

Are we able to get more info on -


{noformat}environment is a static string variable used as an environment marker (DEV/SIT/UAT/etc.) to load environment specific properties files{noformat}

What do those property files contain? This will help us debug further.
Thanks","29/Apr/23 1:34 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5af4ad7d4dd24c579110120b] 

Customer response:

This is a sanitized list of what would be in one of the environment specific properties files...

{noformat}public static String OTP_ENDPOINT=""<https://test"";>
public static String LDAP_DN_OUOC=""test""; 
public static String LDAP_DN_SECAUTH=""cn=test"";

public static String BIOMETRIC_TRUSTSTORE_PATH = ""certs/test.jks""; 
public static String BIOMETRIC_TRUSTSTORE_PASS = ""jkspwd""; 
public static String BIOMETRIC_DATABASEHOSTNAME= ""testdbhost""; 
public static String BIOMETRIC_DATABASEPORT = ""10000""; 
public static String BIOMETRIC_DATABASENAME = ""testdbname""; 
public static String BIOMETRIC_DATABASEUSERID = ""dbuser"";
public static String BIOMETRIC_DATABASEPASSWORD = ""dbuserpwd"";{noformat}

Also, customer was able to get the fixpack that rolls back the JDBC provider installed and the same AccessControlException appears to have occurred...

*lif-aismmbl01_runtime [4/26/23, 15:19:25:159 EDT] 000000c6 SystemErr R java.security.AccessControlException: com.ibm.db2.jcc.am.jc*

I'm pulling a support file from all the appliances now in their PERF environment that have the AAC Runtime active.  It looks like the attempt that the developers made was contained to the lif-aismmbl01 appliance...They did not want to test the fixpack in SIT so that was tested here as well..

*Link to support files:* 

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS012446443&path=TS012446443%2F2023-04-27%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS012446443&path=TS012446443%2F2023-04-27%2F]","29/Apr/23 1:36 AM;60e721f12d49fd00698bb49d;*_As per customer:_*

The extension code worked with the normal version of the driver (4.32.28) and the fixpack version (4.28.11) when a secure connection to the database was not being used.

Once the extension code was configured to use a secure DB2 connection, the pool failed to create with the AccessControlException with either version of the global driver loaded. The properties that they are setting within the extension jar on the DB connection : 

I did get this update from the extension developers so it looks like the AccessControlException in the stack trace is related to something that the driver is attempting to do only for an SSL connection to the DB. When they pushed a new version of the extension jar that makes a non-secure connection to the DB2 database, the connection pool is established properly...I asked for the differences in the setup of the JDBC connection for secure vs non-secure and the provided the code snippet below...

{noformat}    config = new HikariConfig();

         //config.setJdbcUrl(BiometricConstants.DB2_JDBC + dbData.getHostName() + "":"" + dbData.getPort() + ""/""

                //    + dbData.getName() + BiometricConstants.DB2_SSL_SETUP + dbData.getKeyStorePath()

                //    + BiometricConstants.DB2_SSL_PWD + dbData.getKeyStorePassword() + "";"");



         // New Changes for Non-SSL

         config.setJdbcUrl(BiometricConstants.DB2_JDBC + dbData.getHostName() + "":"" + dbData.getPort() + ""/""

                      + dbData.getName());

         config.setUsername(dbData.getUserId());

         config.setPassword(dbData.getPassword());

         config.setDriverClassName(BiometricConstants.DB2_DRIVER);

         config.setMaximumPoolSize(BiometricConstants.DB2_MAX_POOL_SIZE);

         config.setMinimumIdle(BiometricConstants.DB2_MIN_IDLE);

         config.setPoolName(BiometricConstants.DB2_POOL_NAME);



         dataSource = new HikariDataSource(config);{noformat}

Additional information from the developers about the data used in the SSL connection setup...

{noformat}public static final String DB2_JDBC = ""jdbc:db2://"";

  public static final String DB2_SSL_SETUP = "":sslConnection=true;sslTrustStoreLocation="";

  public static final String DB2_SSL_PWD = "";sslTrustStorePassword="";

  public static final String DB2_DRIVER = ""com.ibm.db2.jcc.DB2Driver"";

  public static final String DB2_CONNECTION_QUERY = ""SELECT 1 FROM sysibm.sysdummy1"";

  public static final String DB2_VALIDATION_QUERY = ""SELECT 1 FROM sysibm.sysdummy1"";

  public static final int DB2_MAX_POOL_SIZE = 50;

  public static final int DB2_MIN_IDLE = 10;

  public static final String DB2_POOL_NAME = ""dias-hikari-live-pool"";{noformat}","02/May/23 10:28 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

Are they able to test this with change in their {{config = new HikariConfig();}} code  for SSL.

{{config.setSslVersion(""TLSv1.2"")}}



My ref - [https://www.ibm.com/support/pages/complete-guide-set-ssl-using-ibm-data-server-driver-jdbc-and-sqlj|https://www.ibm.com/support/pages/complete-guide-set-ssl-using-ibm-data-server-driver-jdbc-and-sqlj]","04/May/23 12:00 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

We are working on this issue in the background and it will help if we could get the trace from their environment on AAC with this trace level set -

{noformat}com.ibm.security.access.extension.*=ALL:com.bbt.security.*=ALL:com.tivoli.am.fim.authsvc.*=ALL{noformat}

This will help us narrow down the source of the issue if this with the db2 jar or if there are other issues that are masked by this error.

Are we all to get this trace please.

Thanks","10/May/23 2:49 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5af4ad7d4dd24c579110120b] 

Customer is waiting on a new version of the extension jar from their developers to include the sslVersion change recommended earlier...Once they supply the new jar customer will update the trace settings with the string below and include logs...",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Swap Enablement on Hardware Appliances,ISAMSUP-4849,286377,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Peter Horner,5b15d9517dab4c51f61b5190,Charles David Hooks,5b15d9936d76184b7d989c82,Charles David Hooks,5b15d9936d76184b7d989c82,07/Mar/23 2:33 PM,02/Jun/23 1:48 PM,14/Jul/23 2:47 PM,02/Jun/23 1:48 PM,10.0.6,,,0,,,,"SF Case : TS011795907

Env: ISVA 10.0.4.0 and ISVA 10.0.5.0

Initial Problem Description:

----

The memory usage on our AAC/WebSEAL servers increases around 4% every day. If we don't do anything, the memory usage will get to 100% and bring down one instance (syw0isso01) on the AAC server. This has been happening since the upgrade (from 10.0.2) to v.10.0.4.0 last Dec.

----

The host systems have both AAC and WebSEAL instances on them… per the customer’s initial statement above, the main growth is associated with instance syw0isso01… from support files over time, the starting footprint for the instance is over 4GB… from what we have seen so far, the memory growth rate for that instance exceeds the 4% mentioned by the customer initially… results over a few days showed avg memory growth of 3GB/day…

discussing with the team, it was noted that there were significant changes between 10.0.2 and 10.0.4, including a new memory manager and new level of glibc) that will tend to incur more memory utilization based on how the memory manager works (and that it is also designed to improve performance)

so, next up, I suggested that they enable swap… which they did on a Test env system first… however, a subsequent support file showed 0 swap use, and nothing from the swapon command at the end of support.txt…

* /usr/sbin/swapon --show
* <blank line - no content>

discussing once again with the team, someone asked if the customer was using virtual machines or hardware… turns out they are on HW appliances:

{{etc/settings.sys:sys.mdns.model = AMP 5200}}

conversation then turned to this Jira (diff topic, but swap and hardware entered the picture along the way):

[https://cloudidentity.atlassian.net/browse/ISAMSUP-2717|https://cloudidentity.atlassian.net/browse/ISAMSUP-2717|smart-link] 

from comments in the jira, it looks like there was a decision at some point to hard code hardware appliances to not allow swap to be enabled… and I would guess that there was a reason… but wanted to confirm (the fstab file gets updated when the customer enabled swap and restarted), but swap is not on… also guessing that there is not a mechanism to allow swap to be enabled on a hardware system, but wanted to confirm that as well (as well as whether that would even be a consideration)… I have level set the customer at this point that their solution is likely going to be that they will need add memory… 

** have not pursued having the customer generate cores to investigate webseal memory growth as of yet, but could… and, they have also just upgraded Prod to 10.0.5… and will be collecting support files periodically so we can see if the target webseal instance’s growth remains the same as it was at 10.0.4",,David Hayes,Nick Lloyd,Peter Horner,,,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d9e6dda5f94d06b985b4,5b15d9517dab4c51f61b5190,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5066,,,,,,,,ISAMSUP-4878,,,,,,,,,,,,,,,,,IJ46112,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011795907,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Charles David Hooks,5b15d9936d76184b7d989c82,,,,Royal Bank of Canada,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-03-14T15:07:10.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"/ecurep/sf/TS011/795/TS011795907/2023-03-04/isva_10.0.5.0_20230304-123649_bbxsywmp02-sc.support_unpack/
",,,,,,,,,,,,,,,,,,,,,,,0|i198ff:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,ISVA 10.0.5.0,,,,,,,,,,,,2023-03-08 10:55:25.384,,,,,"08/Mar/23 8:55 PM;5b15d9517dab4c51f61b5190;On the hardware appliance we don't create the swap partition

But Since we have the mechanism in the LMI for setting a swap file - I think it is intended to work

I think the issue is the code that handles setting the swap file - doesn’t handle the case where there is no swap partition

Please open an APAR “Can't enable swap on hardware appliance”

IBM Internal only

We look in /etc/fstab for the swap partition and replace the swap partition with a file

So on a VM we go from a line like

/dev/sda2     swap    swap    defaults    0 0

to

/swapfile    swap    swap    defaults    0 0

But on a hardware appliance - there is no swap line in the existing file

so we don't replace anything - and issuing a swapon -a does nothing

In this case we need to add the whole line to /etc/fstab","13/Mar/23 6:05 AM;5b15d9936d76184b7d989c82;APAR IV99882 has been opened, with an abstract of: “Can't enable swap on hardware appliance”","13/Mar/23 11:37 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 5af5d6e4c38dc3230b46a20bf14616b03c1bf085
   * description: ISAMSUP-4849 APAR TBA Can't enable swap on hardware appliance

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86529767.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4849) which we publish.","14/Mar/23 3:07 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c7a43b673a762390e475e8b7ca701b3b2deb6c6d
   * description: Merge pull request #5742 from ISAM/ISAMSUP-4849

ISAMSUP-4849 APAR IV99882 Can't enable swap on hardware appliance

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86625493.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230314050416-c7a43b673.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","14/Mar/23 3:20 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c7a43b673a762390e475e8b7ca701b3b2deb6c6d
   * description: Merge pull request #5742 from ISAM/ISAMSUP-4849

ISAMSUP-4849 APAR IV99882 Can't enable swap on hardware appliance

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86626093.


This build has not been published as the commit is not currently within a branch (20230314040101-9a3b7166) which we publish.","14/Mar/23 4:24 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c7a43b673a762390e475e8b7ca701b3b2deb6c6d
   * description: Merge pull request #5742 from ISAM/ISAMSUP-4849

ISAMSUP-4849 APAR IV99882 Can't enable swap on hardware appliance

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86628259.


This build has not been published as the commit is not currently within a branch (20230314050210-53159fd5) which we publish.","14/Mar/23 4:27 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: c7a43b673a762390e475e8b7ca701b3b2deb6c6d
   * description: Merge pull request #5742 from ISAM/ISAMSUP-4849

ISAMSUP-4849 APAR IV99882 Can't enable swap on hardware appliance

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/86628322.


This build has not been published as the commit is not currently within a branch (20230314050416-c7a43b673) which we publish.","14/Mar/23 5:21 PM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9936d76184b7d989c82] 

The fixpack is attached to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4878|https://cloudidentity.atlassian.net/browse/ISAMSUP-4878|smart-link] ","22/Mar/23 10:27 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b15d9936d76184b7d989c82] 

Dave, you opened the APAR against wrong compID , totally wrong compID that even I cannot change it to correct compID but I was able to cancel it.

Please open an APAR again but use compID: 5725V90VA   and release like: A04 or A05 etc.","23/Mar/23 6:27 AM;5b15d9936d76184b7d989c82;[~accountid:5b15d9517dab4c51f61b5190] per request, a new APAR has been opened with the corrected compID / release (5725V90VA / A05) : *IJ46112*

do you want to rename the fixpacks, or just go with the ones you provided?","23/Mar/23 7:35 AM;5b15d9517dab4c51f61b5190;[~accountid:5b15d9936d76184b7d989c82] 

I will rebuild the fixpack to use IJ46112 - because even if renamed it would still record IV99882 in the fixpack history","23/Mar/23 8:31 AM;5b15d9517dab4c51f61b5190;I have updated the fixpack details in [https://cloudidentity.atlassian.net/browse/ISAMSUP-4878|https://cloudidentity.atlassian.net/browse/ISAMSUP-4878|smart-link] 

I have removed the IV99882 fixpack from Box","11/May/23 1:30 PM;5b15d9936d76184b7d989c82;[~accountid:5b15d9517dab4c51f61b5190] The customer applied IF1 to a 10.0.5 hardware system… they decided to go that route as opposed to applying IJ46112_10050.fixpack to the 10.0.5 system (with the understanding that the fix for IJ46112 was included in 10.0.5.0_IF1… *if I have that wrong, let me know*)… they provided 3 support files during the process:

SwapFile: 0 - isva_10.0.5.0_20230505-162551_bbxsywmt01-sc.support (this was taken after applying 10.0.5.0_IF1, with swap being unset before/after IF was applied)

SwapFile: 2048 (deployed)- isva_10.0.5.0_20230505-162942_bbxsywmt01-sc.support (after changing swap from unset to 2048)

SwapFile: 2048 (restarted)- isva_10.0.5.0_20230505-163420_bbxsywmt01-sc.support (with swap still set to 2048)

the listing file for the support files showed the following:



SwapFile 0:

/etc:

-rw-rw-r-- 1 root root *92 Feb 14 12:23 fstab*

-rw-rw-r-- 1 root root 92 Feb 14 12:23 fstab.swap_patition



SwapFile 1:

/etc:

-rw-rw-r-- 1 root root *137 May 5 16:27 fstab*

-rw-rw-r-- 1 root root 92 Feb 14 12:23 fstab.swap_patition



SwapFile 2:

/etc:

-rw-rw-r-- 1 root root *137 May 5 16:27 fstab*

-rw-rw-r-- 1 root root 92 Feb 14 12:23 fstab.swap_patition



so the fstab file size changes (as expected) when swap was changed from unset to a value (2048 in this case), but I believe that was what we saw earlier, and that it was the code simply prevented putting the swap into effect for hardware appliances…

from SwapFile 2, the support.txt file contents indicate that swap is not in effect… contents include:

+ top -b -n1 -m

Mem total:65894776 anon:2775752 map:276252 free:61044132

slab:245304 buf:33172 cache:1436000 dirty:2244 write:0

*Swap total:0 free:0*



+ /usr/sbin/swapon --show *(empty results)*","11/May/23 2:47 PM;5b15d9517dab4c51f61b5190;In the second support file -  after the swap file is created,  swap is enabled 

* /usr/sbin/swapon --show
NAME      TYPE SIZE USED PRIO
/swapfile file   2G   0B   -2

It works because after creating the file and updating fstab we call swapon -a

I suspect that we don't call swapon during boot of hardware appliance

System was rebooted before 3rd support file where swap is once again disabled

May  5 16:32:51 mesa_control[1523]: Bootstrap from settings succeeded
May  5 16:32:51 mesa_control[1523]: GLGSY0015I:: GLG_events:: ||
May  5 16:32:51 mesa_control[1523]: Bootstrap succeeded","11/May/23 3:58 PM;5b15d9517dab4c51f61b5190;I verified  that on a VM swapon is enabled in /etc/rc.mount at boot time

(Commented it out on a VM with a swap file and verified swap was disabled after reboot)

On my VM the size of rc.mount is 73 bytes

-rwxr-xr-x    1 root     root            73 Jan 11 09:49 /etc/rc.mount

I then copied it to /tmp and removed the  swapon line

-rwxr-xr-x    1 root     root            53 May 11 15:44 /tmp/rc.mount

From the customers support file ls.txt, the rc.mount on the hardware appliance matches the size without the swapon line

-rwxrwxr-x    1 root     root            53 Feb 14 12:19 rc.mount

I will create a fixpack that will add the swapon -a line to /etc/rc.mount

Workaround would be to change swap file size after every boot","11/May/23 6:06 PM;5b15d9517dab4c51f61b5190;The fixpack to ensure swap is enabled at boot time has been  added to [https://cloudidentity.atlassian.net/browse/ISAMSUP-4878|https://cloudidentity.atlassian.net/browse/ISAMSUP-4878|smart-link] It is for 10.0.5.0 only and compatible with all other fixpacks including IF1

It will enable swap immediately if swap file present. - so no need to reboot for it to take effect

but swap will then be enabled at boot in the future",22/May/23 1:59 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b232b2fd85e5b59b066f57f] can you please review the APARs closure status and close Jira item once confirmed. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Customer need clarification on inclusion of interim fix pack(IJ38857) in ISVA 10.0.5,ISAMSUP-4841,285955,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,04/Mar/23 4:54 AM,04/Mar/23 5:38 AM,14/Jul/23 2:47 PM,04/Mar/23 5:38 AM,,Support,,0,,,,"Just to give a background - As part of TS010824014, customer have applied interim fix pack(IJ38857_10031_V3) on 10.0.3.1 to fix kdb corruption issue.  

Now they are planning to upgrade ISVA from 10.0.3.1 to 10.0.5. Could you please confirm if interim fix pack on APAR IJ38857 has been included in 10.0.5 and it’s already fixed? 

Thanks.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ38857,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012334830,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,Pontis Research Inc.,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i195tv:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-03-03 19:32:18.2,,,,,04/Mar/23 5:32 AM;5b15d94b6256d01ad54eb020;[https://www.ibm.com/support/pages/apars-fixed-ibm-security-verify-access-version-1005-0|https://www.ibm.com/support/pages/apars-fixed-ibm-security-verify-access-version-1005-0|smart-link] ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
REST API lets duplicate Reverse proxy stanza entrys which break the reverse proxy configuration file,ISAMSUP-4814,284090,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Carlos Rosales,5bb2c13f59e46d7be31a9e54,Carlos Rosales,5bb2c13f59e46d7be31a9e54,24/Feb/23 6:11 AM,10/May/23 10:01 AM,14/Jul/23 2:47 PM,10/May/23 10:01 AM,10.0.6,,,0,,,,"Using the REST API

{{https://{appliance_hostname}/wga/reverseproxy/{reverseproxy_id}/configuration/stanza/{stanza_id}}}

is possible to add a duplicated stanza which causes the reverse proxy to not start and the configuration file to be inaccessible either using the LMI or the REST API, trying to make a change after duplicating the stanza shows the below error, trying to delete the duplicated stanza using the Delete Rest API results on the same error message

{noformat}{
    ""message"": ""/build/isam/src/i4w/pdweb/wapi/api/wapicfg.cpp:3328 - Error: DPWAP0132E   Failed to write to the configuration file.""
}{noformat}



Steps to duplicate:

# Create a stanza named [waf] [https://192.168.58.128/wga/reverseproxy/new_10.0.5.0/configuration/stanza/[waf]|https://192.168.58.128/wga/reverseproxy/new_10.0.5.0/configuration/stanza/[waf]]
# create a second stanza called [[waf] [https://192.168.58.128/wga/reverseproxy/new_10.0.5.0/configuration/stanza/[[waf]|https://192.168.58.128/wga/reverseproxy/new_10.0.5.0/configuration/stanza/[[waf]]
# deploying the changes
# after the changes are deployed webseal instance is stopped and can’t be restarted, trying to access the configuration file results on the error mentioned above.

The REST API should not allow this config to be pushed if it will corrupt the Reverse Proxy",,khansen,Nick Lloyd,Tushar Prasad,,,,,,,,,,,,,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, IJ45587,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS012198691,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Carlos Rosales,5bb2c13f59e46d7be31a9e54,,,,PERSPECTA ENTERPRISE SOLUTIONS LLC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-04-17T16:11:50.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i18uib:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-02-23 22:50:50.034,,,,,"24/Feb/23 8:50 AM;5b15d954b0d76456f36daf33;Is this specific to the RAPI or the same happens via LMI? In any case looks like an APAR, so go ahead and create one.","25/Feb/23 12:58 AM;5bb2c13f59e46d7be31a9e54;Hi Bhavan,

I have created the APAR IJ45587.

Regarding your question, using the LMI I’m not able to add the [waf] and [[waf] stanzas only using the RAPI.

{color:#ffffff}Re for t{color}","27/Feb/23 1:46 PM;5b15d954b0d76456f36daf33;Just so they are aware, we cannot prevent duplicate values from being created. In some cases they are valid/expected (multi-valued attributes for example).

What I’m working on is to see if there is a way to allow them to delete or re-edit the config file via the LMI.","06/Mar/23 11:14 PM;5bb2c13f59e46d7be31a9e54;thanks for the update Bhavan, I have let the customer know that any fix provided will be for let them update/delete the entry.","07/Mar/23 10:54 PM;5bb2c13f59e46d7be31a9e54;Hi Bhavan,

I don’t think is possible to duplicate stanza names, stanza entries I understand but stanza names shouldn’t be duplicated isn’t? shouldn’t be a way to prevent adding a stanza name that has already been defined on the configuration file?","09/Mar/23 5:46 PM;5b15d954b0d76456f36daf33;[~accountid:5bb2c13f59e46d7be31a9e54] there is nothing stopping from creating duplicate stanza entries. That is how it has always been. I’m not sure if there is a 

The problem occurs when you attempt to restart a reverse proxy instance with such a config file with bad/duplicate stanzas. 

We can’t really change that behaviour. Which is why I said the best we can do is give the customer the ability to edit the configuration file again to rectify the erroneous entry.","14/Mar/23 11:11 PM;5bb2c13f59e46d7be31a9e54;Hi Bhavan, 

thanks for the feedback, I understand about the stanza entries, but for example:

If the stanza names [waf] or [junction] are already defined on the configuration file, I shouldn’t be able to create or add the stanza name [waf] or [junction] again, or I’m wrong here?

I understand what you tell me that stanza entries can be duplicated like if I add to the [junction] stanza an entry called entry1 but if that entry is multivalue I can define it again let me have duplicated entries. ",15/Mar/23 10:44 AM;5b15d954b0d76456f36daf33;Even stanzas. We don’t have a mechanism to validate what stanzas are being added or modified while the conf file is being edited. Or even on a save. The only errors you get are when we attempt to start an instance that has bad conf file entries.,"23/Mar/23 1:35 AM;5bb2c13f59e46d7be31a9e54;Hi Bhavan, 

thanks for the feedback, is there an ETA on a possible fix for the customer?","29/Mar/23 1:36 AM;5bb2c13f59e46d7be31a9e54;Hi Bhavan,

just checking if there is any update?","31/Mar/23 4:53 PM;5b15d954b0d76456f36daf33;I went over the existing behaviour to see what might be a workable solution. It looks like the root cause of the problem is the square bracket {{[ ]}} in the name of the stanza. Since it has special meaning for our conf file.

So the remediation will be to reject any RAPI from being saved if it contains that. This is going to be trickier with the advanced configuration editor which loads and saves the entire file.

What is their current state? Have they reverted using a snapshot so the reverse proxy is now in a functional state?","04/Apr/23 2:08 AM;5bb2c13f59e46d7be31a9e54;Hi Bhavan,

yes instances are fine now on the customer side, they used a snapshot to restore.","12/Apr/23 2:36 AM;5bb2c13f59e46d7be31a9e54;Hi [~accountid:5b15d954b0d76456f36daf33] client is looking for an update.

btw if “It looks like the root cause of the problem is the square bracket {{[ ]}} in the name of the stanza. Since it has special meaning for our conf file. So the remediation will be to reject any RAPI from being saved if it contains that.” what will happen when trying to add a junction stanza since they are of the form [junction:{jct_id}]?","12/Apr/23 10:10 AM;5b15d954b0d76456f36daf33;The RAPI url has a predefined structure for working with stanzas (and entries)

{noformat}https://{appliance_hostname}/wga/reverseproxy/{reverseproxy_id}/configuration/stanza/{stanza_id}{noformat}

You don’t need to add {{[]}} to the {{stanza_id}} explicitly. That is what is going to be fixed. ","17/Apr/23 2:40 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: 10becd1351b7e1753716e1c8148fb5b652021c68
   * description: ISAMSUP-4814 Ensure stanza names don't contain reserved [ character

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/106441.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4814) which we publish.",17/Apr/23 3:51 PM;5b15d954b0d76456f36daf33;[~accountid:5bb2c13f59e46d7be31a9e54] the changes are approved for the next release. Is the customer looking for a personal patch? Or are they happy for this to be available from 10.0.6?,"17/Apr/23 4:11 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ad07b51c5213f8394aa7eb0553499cd53a087932
   * description: ISAMSUP-4814 Ensure stanza names don't contain reserved [ character (#5841)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/106655.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230417060854-ad07b51c.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","17/Apr/23 5:28 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: ad07b51c5213f8394aa7eb0553499cd53a087932
   * description: ISAMSUP-4814 Ensure stanza names don't contain reserved [ character (#5841)

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/106843.


This build has not been published as the commit is not currently within a branch (20230417060854-ad07b51c) which we publish.",09/May/23 10:43 PM;5b15d901fa615349cb01778b;Customer is willing to wait for 10.0.6  Thanks Bhavan. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
ISVA 10.0.0.1 lost junction after upgrading to 10.0.4,ISAMSUP-4756,278712,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Joyce.Fernandes,627a85950e2c490069032c59,Joyce.Fernandes,627a85950e2c490069032c59,31/Jan/23 9:01 PM,14/Mar/23 11:47 PM,14/Jul/23 2:47 PM,14/Mar/23 11:47 PM,,,,0,,,,"Customer is trying to upgrade from 10.0.1 version to 10.0.4. in production. After upgrading to 10.0.4, the virtual junction disappeared.

we see the next error in the log:

4344 2022-11-30-20:41:06.379+02:00I----- 0x1005B1C5 webseald ERROR acl acldb daLocalPolicy.cpp 294 0x7f6021531dc0 -- HPDAC0453E Authorization policy database version is incompatible with the server version (4096,4100) and will be automatically replaced.
4345 2022-11-30-20:41:07.302+02:00I----- 0x38AD54C3 webseald ERROR wiv ssl JWTManager.cpp 872 0x7f5fee7fc700 -- DPWIV1219E An SSL toolkit failure occurred while calling d2i_AutoPrivateKey. Error: error:0D0680A8:asn1 encoding routines:asn1_check_tlen:wrong tag.
4346 2022-11-30-20:41:07.316+02:00I----- 0x38CF04CE webseald ERROR wwa jct junctionTable.cpp 352 0x7f5fee7fc700 -- DPWWA1230E Error building junction tevelxxxxxxxxxxxx-ssl from file /var/pdweb/default/server-root/jct/dGV2ZWxwcm9kLmJsbWFpbi5wcm9kLXNzbA==.xml: DPWIV1219E An SSL toolkit failure occurred while calling %s. Error: %s.

The customer has tried upgrading in his test environment and was successfully able to upgrade from 10.0.1 version to 10.0.4.

They have a Clustered environment with two appliances.

We tried looking for the missing junctions in 10.0.4 version via UI, there is no UI error - when you open the junction window, there is no junction seen in it.
Also checked using pdadmin - no junctions were listed.
the customer has rolled back from 10.0.4 to 10.0.1 on production.
we check the support file of 10.0.4 and 10.0.1 to compare the junctions and file permission, I did that and find no difference",,Asha Shivalingaiah,Dermot Daly,khansen,Nick Lloyd,,,,,,,,,,,,5af4ad7d4dd24c579110120b,6092ac9ff6c0960069d47a67,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,31/Jan/23 9:02 PM;ug:0c063553-b8cb-41a0-a631-104c7f5639f8;Compare Junction.xlsx;https://cloudidentity.atlassian.net/rest/api/3/attachment/content/181007,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011400545,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Joyce.Fernandes,627a85950e2c490069032c59,,,,Yossi Ancona,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17xvz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.4.0,,,,,,,,,,,,,2023-02-07 16:14:37.946,,,,,08/Feb/23 2:14 AM;5b15d9e581c3df12acf53c4a;Investigating……….,"08/Feb/23 2:29 AM;5b15d9e581c3df12acf53c4a;Can you explain the issue itself in more details please?

In ecurep, in 10.0.4.0 support file and 10.0.1.0 support file, under the “default” RP instance, I can see two junction xml file.

So, it seems that junction xml file is there but in 10.0.4.0, it cannot load it? is that what you see?

There is one junction which has lots of server added to it? right?

Or there are ton and tons of junction and none is being displayed via either LMI or pdadmin?","08/Feb/23 3:28 AM;5b15d9e581c3df12acf53c4a;1)

After reading all the information that I can gather, it seems to be more of a environmental and setup problem. Since it  does work in Test environment, there must be some differences in the SSL Certificates and Key databases which must be different from what they have in their Test Env.

Please investigate from SSL/Certts point of view.

2)

Also it seems that appliance is having difficulty resolving some host IP addresses, please check those server names in the junction XML file is still reachable or not.   



Are these host reachable?

tevelprod.blmain.prod

{code:none}tvlpqsihs1.blmain.prod
tvlpqsihs2.blmain.prod
tvlpolihs1.blmain.prod
tvlpolihs2.blmain.prod
tvlvpcloud1.blmain.prod
tvlvpcloud2.blmain.prod
tvlvpcloud3.blmain.prod{code}



3)

Please also compare the webseal conf file in test and product environment and see whether or not there is a difference.",14/Mar/23 11:47 PM;5b15d901fa615349cb01778b;case closed,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Using JDK 17 for extension Java plugins,ISAMSUP-4746,278161,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,26/Jan/23 7:34 AM,24/Feb/23 10:15 AM,14/Jul/23 2:47 PM,24/Feb/23 10:15 AM,,Support,,0,,,,"AT&T is using JDK 1.8 to compile extension Java custom plugins. They would like to upgrade to JDK 17, but I do not see anything in the documentation or the Software Product Compatibility Reports regarding this. Is this possible with ISVA 10.0.5.0?",,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011947544,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,A T & T SERVICES INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17uk7:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-31 19:47:00.706,,,,,01/Feb/23 5:44 AM;5bac25a37de8532e315430c5;[~accountid:5b15d94b6256d01ad54eb020] Any information for the client?,"01/Feb/23 5:47 AM;5b15d94b6256d01ad54eb020;I haven’t had a chance to look into this yet.   I’m not aware of  any testing on that version yet.

The appliance uses  jdk-11.0.16.1+1",21/Feb/23 6:53 AM;5b15d94b6256d01ad54eb020;Using that version to compile the extension ought to be okay but you have to be careful not to use any new features (if any) added after  jdk-11.0.16.1+1.,24/Feb/23 10:15 AM;5b232b2fd85e5b59b066f57f;Case closed. Closing WI. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Potential jsonwebtoken vulnerability,ISAMSUP-4732,277756,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,jwade,5b15d8fd6e93913e31e279fb,Joyce.Fernandes,627a85950e2c490069032c59,Joyce.Fernandes,627a85950e2c490069032c59,21/Jan/23 3:07 AM,03/Feb/23 12:27 AM,14/Jul/23 2:47 PM,03/Feb/23 12:27 AM,,,,0,,,,A new potential security vulnerability has been discovered from one common library. Is this utilized in the ISVA: [https://thehackernews.com/2023/01/critical-security-flaw-found-in.html|https://thehackernews.com/2023/01/critical-security-flaw-found-in.html|smart-link],,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011793867,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Joyce.Fernandes,627a85950e2c490069032c59,,,,Henri Turtiainen,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17s2n:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.0.1,,,,,,,,,,,,,2023-01-23 21:26:21.992,,,,,24/Jan/23 7:26 AM;5b15d8fd6e93913e31e279fb;[~accountid:627a85950e2c490069032c59] Can you show where this is found in the ISVA code?  I have done a search of the code and we do not use jsonwebtokens in our product.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Problem with Dynatrace agent deep monitoring for Java Runtime process in 10.0.5,ISAMSUP-4731,276763,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Motiur Rahman,5b15d9e581c3df12acf53c4a,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,20/Jan/23 8:57 AM,04/Apr/23 9:49 PM,14/Jul/23 2:47 PM,16/Mar/23 12:37 AM,,,,0,,,,"Customer is reporting that on upgrading to 10.0.5 the ISVA runtime was failing to start.   The LMI process was running successfully.  On investigation I asked the customer to uninstall the Dynatrace extension and attempt the upgrade again.   This worked successfully.  The customer then installed the extension using the latest 1.0.7 version.  When the customer specified to enable the Runtime deep monitoring the Runtime again failed to start.   Setting this back to not monitor the Runtime the process started.   

The customer is seeing this even with that latest version of the dynatrace installer/agent 1.255.195.20230105-130024, build date: 05.01.2023



It seems that there is something with how Dynatrace is injecting into the Runtime startup that is causing a problem.  It seems odd to me that the LMI process will work but the Runtime will fail to start. 



The Liberty logs are not all that helpful, or I don’t know what would be worth tracing on this.

Here is an example of the log when the Runtime fails to start.
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011834776&path=TS011834776%2F2023-01-19%2Fisva_10.0.5.0_20230119-094523_dif-aismpdm01.bbtdmztst.local.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F&filepath=TS011834776%2F2023-01-19%2Fisva_10.0.5.0_20230119-094523_dif-aismpdm01.bbtdmztst.local.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2Fmessages_23.01.19_09.34.12.0.log|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011834776&path=TS011834776%2F2023-01-19%2Fisva_10.0.5.0_20230119-094523_dif-aismpdm01.bbtdmztst.local.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2F&filepath=TS011834776%2F2023-01-19%2Fisva_10.0.5.0_20230119-094523_dif-aismpdm01.bbtdmztst.local.support_unpack%2Ftmp%2Fliberty_runtime_dump.zip_unpack%2Flogs%2Fmessages_23.01.19_09.34.12.0.log]

This appears to be the corresponding Dynatrace for when it attempted to launch the runtime.
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011834776&path=TS011834776%2F2023-01-19%2Fisva_10.0.5.0_20230119-094523_dif-aismpdm01.bbtdmztst.local.support_unpack%2Fvar%2Flog%2Fdynatrace%2Foneagent%2Fjava%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011834776&path=TS011834776%2F2023-01-19%2Fisva_10.0.5.0_20230119-094523_dif-aismpdm01.bbtdmztst.local.support_unpack%2Fvar%2Flog%2Fdynatrace%2Foneagent%2Fjava%2F]

Every time it fails with the same type of ffdc

java.lang.IllegalStateException com.ibm.ws.kernel.feature.internal.FeatureManager 891



I do not have access to a non trial Dynatrace environment to do any integration testing.   So I have not been able to recreate this locally and was hoping someone in Dev has access to an env for integration testing. ",,Annelise Quap,David Hayes,khansen,Nick Lloyd,Virag Patel,,,,,,,,,,,5b15d950d9936c61022057fe,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5b17571a82e05b22cc7d5d9e,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011834776,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,TRUIST FINANCIAL CORPORATION,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,Yes,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17r8v:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-23 19:57:52.805,,,,,"20/Jan/23 9:15 AM;5b15d950d9936c61022057fe;I have a suspicion that the missing bundles it notes, might be related

io.openliberty.microprofile.config.internal.common/[1.0.0,1.0.200), 

io.openliberty.microprofile.config.internal.serverxml/[1.0.0,1.0.200), 

io.openliberty.transaction.internal.cdi20/[1.0.0,1.0.200)

I see these same errors in my lab 10.0.5:

[1/19/23, 15:22:14:155 CST] 00000027 com.ibm.ws.kernel.feature.internal.FeatureManager            E CWWKF0001E: A feature definition could not be found for io.openliberty.mpCompatible-0.0
[1/19/23, 15:22:14:156 CST] 00000027 com.ibm.ws.kernel.feature.internal.FeatureManager            E CWWKF0001E: A feature definition could not be found for io.openliberty.restHandler1.0.internal.ee-6.0
[1/19/23, 15:22:16:181 CST] 00000027 com.ibm.ws.kernel.feature.internal.Provisioner               E CWWKF0002E: A bundle could not be found for io.openliberty.microprofile.config.internal.common/[1.0.0,1.0.200).
[1/19/23, 15:22:16:181 CST] 00000027 com.ibm.ws.kernel.feature.internal.Provisioner               E CWWKF0002E: A bundle could not be found for io.openliberty.microprofile.config.internal.serverxml/[1.0.0,1.0.200).
[1/19/23, 15:22:19:279 CST] 00000027 com.ibm.ws.kernel.feature.internal.Provisioner               E CWWKF0002E: A bundle could not be found for io.openliberty.transaction.internal.cdi20/[1.0.0,1.0.200).
[1/19/23, 15:22:21:139 CST] 00000027 com.ibm.ws.logging.internal.impl.IncidentImpl                I FFDC1015I: An FFDC Incident has been created: ""java.lang.IllegalArgumentException: Missing bundles: [io.openliberty.microprofile.config.internal.common/[1.0.0,1.0.200), io.openliberty.microprofile.config.internal.serverxml/[1.0.0,1.0.200), io.openliberty.transaction.internal.cdi20/[1.0.0,1.0.200)] com.ibm.ws.kernel.feature.internal.FeatureManager checkInstallStatus"" at ffdc_23.01.19_15.22.19.0.log



In this lab machine I had a clean 10.0.4.0_if1 install that I upgraded to 10.0.5 and set ATP runtime_profile.enable.monitor=true

Even with these errors I’m still able to access the monitor endpoint in the runtime.  But maybe these missing files are enough to cause issues when Dynatrace is involved?",24/Jan/23 5:57 AM;5b15d9e581c3df12acf53c4a;I am doing some investigation……………………,"24/Jan/23 6:58 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b17572378cd734fe39f2e1a] Hi Lachlan, 

Can we get some your inout on this Dynatrace issue in ISVA 10.0.5.0 please

It seems install all OK but for some reason, only AAC i.e. Runtime Liberty profile  stops and failed to start.

We could not figure out any reason and trace/logs do not pointing to any obvious issues:

Here is a log in:

ecurep/sf/TS011/834/TS011834776/2023-01-19/isva_10.0.5.0_20230119-094523_dif-aismpdm01.bbtdmztst.local.support_unpack/tmp/liberty_runtime_dump.zip_unpack/logs/messages_23.01.17_16.04.32.0.log



It seems that Dynatrace’s presence causing some issue for Runtime Liberty Process but none to default Liberty process.

Any idea? or do we need to collect any more traces/logs?","24/Jan/23 11:39 AM;5b17572378cd734fe39f2e1a;[~accountid:5b15d9e581c3df12acf53c4a] it is not possible to use multiple monitoring agents.
If you are setting the {{runtime_profile.enable.monitor}} ATP then you cannot use the DynaTrace agent to monitor the runtime as well. I believe trying to use both will cause errors/invalid configuration in the {{server.xml}} for the runtime Liberty server but I have not confirmed this.

edit: as far as I am aware the dynatrace agent will report everything that the ATP is reporting, just in different formats/metrics",25/Jan/23 2:37 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b17572378cd734fe39f2e1a] Thank you.,"25/Jan/23 2:38 AM;5b15d9e581c3df12acf53c4a;Can you guys try removing 

runtime_profile.enable.monitor = true

from ATP and see how it goes?","28/Jan/23 3:46 AM;5b15d950d9936c61022057fe;My customer was using the ATP true in 10.0.4 and NOT seeing the problem.  So both could work in 10.0.4.   
Again I do not have access to a Dynatrace env that I can reach to actually do the install of the agent on my lab.",21/Feb/23 8:33 PM;5b232b2fd85e5b59b066f57f;@mrahman - This WI was last updated by you over 7 days ago. Please provide an update. Any issues - let me know.,"22/Feb/23 2:18 AM;5b15d9e581c3df12acf53c4a;As Lachlan suggested, for the customer,  does

changing the ATP runtime_profile.enable.monitor=false

resolve their issue?

Or is there a very valid reason for them to keep this ATP to “true”?",25/Feb/23 5:25 AM;5b15d950d9936c61022057fe;I’m still waiting on a response but my concern is why was this ATP not a problem with 10.0.4?   So I’m not sure that is the root cause. ,25/Feb/23 8:18 AM;5b15d950d9936c61022057fe;customer reports initial succcess.  But the question is why is there a conflict and how can this be avoided since the setting runtime_profile.enable.monitor=true works in 10.0.4 with Dynatrace.,"01/Mar/23 9:33 AM;5b15d9e581c3df12acf53c4a;As far as Dynatrace install and what version of Dynatrace get install on ISVA appliance goes, here are the few things we need to be aware:

ISVA Appliance actually does not choose any version of Dynatrace,  it is what ever in the host that you pointed to i.e. “Dynatrace SaaS or Managed address, including environment ID” field.

From there, ISVA downloads a Dynatrace install scripts, this install scripts has the whole Dynatrace Install binary attached to it as 64bit encoded form. This install scripts knows how to separate the 64bit encoded Dynatrace install binary and use it to install Dynatrace.

Basically, as far as ISVA appliance is concern,  it gets whatever is available from the above mentioned host.

So it is possible that the latest Dynatrace binary does not play well with this ATP  flag or it is possible that latest ISVA i.e. 10.0.5.0 does not get well with Dynatrace when this flag on.","01/Mar/23 9:38 AM;5b15d9e581c3df12acf53c4a;[~accountid:5b17572378cd734fe39f2e1a] Hi Lachlan, sorry to bother you again. We are trying to close this issue and trying to figure out the possible cause:

L2 is curious to know that is there a specific reason that  ISVA 10.0.4.0 tolerate 

ATP flag “runtime_profile.enable.monitor=true” with Dynatrace when ISVA 10.0.5.0 cannot?

Is it because of any change in ISVA 10.0.5.0 or there could be something different in Dynatrace itself?

It seems that when customer set it “runtime_profile.enable.monitor=false”, all is OK,  it just that they did not need to do that in 10.0.4.0 and they need to know why.

Any clues you can provide will help us. Thanks.","02/Mar/23 8:53 AM;5b17572378cd734fe39f2e1a;So that ATP attempts to enable some liberty features which are used for monitoring/performance (monitor-1.0 feature) as well as set up some monitoring jars to run with the liberty server. They dynatrace OneAgent tool essentially does the same thing.

When I updated the dynatrace extensions I also enabled these same features, and it appears that when they are both enabled they cause problems for the liberty server. I have not investigated whether this is due to conflicting configuration files or errors at runtime due to the different “monitoring jva applications” (dynatrace and the ATP flag) fighting each other.

With the update to dynatrace extensions it will provide all the same information that ATP used to provide, just in a different format (and would require configuring of dynatrace to collect it)

I suspect that the reason this customer can get both dynatrace and the ATP to work at the same time is they are using an older version of the extension on the 10.0.4 appliance which does not have the JVM integration properly configured.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Need ISAMDEV-7760 back ported to 10.0.3.1,ISAMSUP-4720,276519,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Annelise Quap,5b15d950d9936c61022057fe,Annelise Quap,5b15d950d9936c61022057fe,19/Jan/23 8:26 AM,21/Jan/23 6:47 AM,14/Jul/23 2:47 PM,21/Jan/23 6:47 AM,,,,0,,,,"Motiur requested a separate Jira for this.

Customer needs to be able to install Dynatrace extension.  They have the appliance isolated from the internet but the Dynatrace extension needs to be able to reach a https endpoint to download the latest Dynatrace agent installer.   The extension is unable to use a HTTP proxy to make this download, the proxy settings in the extension are just for use by the Dynatrace agent after it is installed. 

In absence of the ability to specify a proxy to download the agent installer the customer could use a Dynatrace ActiveGate.   The problem is this listens on port 9999.  When you specify a port the extension code that writes the properties file in 10.0.3.1 and lower does not handle the port being specified.    

There is a fix [https://cloudidentity.atlassian.net/browse/ISAMDEV-7760|https://cloudidentity.atlassian.net/browse/ISAMDEV-7760|smart-link]  but this is for 10.0.4 and later.



The customer urgently needs to install the extension and is unable to open the network to all the appliance to make an external connection.   



The customer needs this change backported so that they can specify a :9999 in the URL and have the wget properly handle the value. 



From what I have seen it looks like it should be possible to backport [https://cloudidentity.atlassian.net/browse/ISAMDEV-7760|https://cloudidentity.atlassian.net/browse/ISAMDEV-7760|smart-link] and provide the customer a way to install the extension.



The customer is at 10.0.3.1 in and has two different environments they need to apply the extension.

[https://ecurep.mainz.de.ibm.com/ae5/#id=TS011798781&path=TS011798781/2023-01-11/&filepath=TS011798781/2023-01-11/FIX_Pack_on_DIT3_CWGA.png|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011798781&path=TS011798781/2023-01-11/&filepath=TS011798781/2023-01-11/FIX_Pack_on_DIT3_CWGA.png]

And this for their other appliances.   [https://ecurep.mainz.de.ibm.com/ae5/#id=TS011798781&path=TS011798781/2023-01-11/&filepath=TS011798781/2023-01-11/Fix_Packs_on_most_appliances.png|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011798781&path=TS011798781/2023-01-11/&filepath=TS011798781/2023-01-11/Fix_Packs_on_most_appliances.png]

The customer has been escalating this issue with installing the Dynatrace extension every other day. ",,Annelise Quap,BRIANORO,,,,,,,,,,,,,,5b15d950d9936c61022057fe,6154906364ff01007106e189,,,,,,,,,,,,,,,,,,,,,,,,,,ISAMSUP-4723,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011798781,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Annelise Quap,5b15d950d9936c61022057fe,,,,BANK OF MONTREAL,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17prz:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-01-19 02:07:35.129,,,,,19/Jan/23 12:07 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d9e581c3df12acf53c4a] [~accountid:5b15d950d9936c61022057fe] I asked Asha to review this item for us. As [~accountid:5b17572378cd734fe39f2e1a] was the developer that made the update it might be beneficial to work this during our day. [~accountid:5af4ad7d4dd24c579110120b] thank you for your support regarding this one. It would be great to firstly confirm if this backport is possible and then to have the appliance fix pack pulled together if that is possible. ,"19/Jan/23 1:45 PM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}-rw-r--r--    1 root     root         19921 Nov 15 20:06 SysExtensions.class
/opt/ibm/wlp/usr/servers/default/apps/WEB-INF/classes/com/ibm/mesa/feature/extensions # pwd
/opt/ibm/wlp/usr/servers/default/apps/WEB-INF/classes/com/ibm/mesa/feature/extensions{noformat}



Build environment issue. 
Will build a fix when travis is fixed.",20/Jan/23 2:20 AM;5b15d9e581c3df12acf53c4a;[~accountid:5ac57757d9a96536d1f0daa9] It seems that Asha is waiting on Travis build environment to be fixed and apparently it can be back ported. I will let Asha continue on it.,"20/Jan/23 11:18 AM;5af4ad7d4dd24c579110120b;[~accountid:5b15d950d9936c61022057fe] 

Fixpack built with backported changes at: [https://cloudidentity.atlassian.net/browse/ISAMSUP-4723|https://cloudidentity.atlassian.net/browse/ISAMSUP-4723|smart-link] 

I have only tested the install of the fixpack haven't tested any dynatrace config.",20/Jan/23 2:31 PM;5ac57757d9a96536d1f0daa9;[~accountid:5b15d950d9936c61022057fe] [~accountid:5b15d9e581c3df12acf53c4a] if you can please assist with the validation of this fix pack it would be appreciated. It would be great to have this fix pack provided to the customer before the end of your Friday. ,"21/Jan/23 1:27 AM;5b15d9e581c3df12acf53c4a;[~accountid:5ac57757d9a96536d1f0daa9] Before we validate the fixpack, we need to sort out one more issue, the customer has some existing fixpack already installed, let me find all those fixpack they already have and see whether there will be any sort of conflicts or not, I will update as soon as I find out…..","21/Jan/23 2:53 AM;5b15d950d9936c61022057fe;First sniff test of the fixpack, it does not automatically restart the LMI. 
However, after restarting my test lab I ran a synthetic test, as I don’t have a real Dynatrace env to test, but the value was parsed correctly and wget made a request to a dummy server I had on port 9999.

So that portion works, just need to check compatibility with the customer’s existing fixpacks.","21/Jan/23 3:04 AM;5b15d9e581c3df12acf53c4a;OK,  I looked at all the installed Patches that Customer has and none will have a conflict with this patch that Asha built i.e. this patch is safe to install.

Please give it a sanity check i.e. installed it first on a 10.0.3.1 system even if you do not have a Dynatrace server and sanity check LMI….

You can also attempt to install Dynatrace extension with similar but non existent  host/port combination as the customer which will fail but hopefully log file will give you idea whether or not with real server/port combination will work or not……",21/Jan/23 3:39 AM;5b15d950d9936c61022057fe;[~accountid:5b15d9e581c3df12acf53c4a] please see my previous comment.  I’ll send the patch on to the customer. ,"21/Jan/23 4:32 AM;5b15d9e581c3df12acf53c4a;OK, Thanks, and yes, a manual restart of LMI was needed. Automatic restart was not added  but that’s OK.",21/Jan/23 6:47 AM;5b15d950d9936c61022057fe;Thank you. FixPack sent to customer. They confirmed the FP portion is working but now are having issues that they will follow-up with their Dynatrace team.   I’m going to mark this Jira done. ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Advanced tuning parameters for IJ42740 not documented.,ISAMSUP-4712,276021,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 2,Done,Bill Tyler,5b15d94b6256d01ad54eb020,Sten Drescher,5bac25a37de8532e315430c5,Sten Drescher,5bac25a37de8532e315430c5,14/Jan/23 8:02 AM,22/Mar/23 6:19 AM,14/Jul/23 2:47 PM,22/Mar/23 6:19 AM,,Support,,0,escalated,,,"According to ISAMSUP-4289, the fix for IJ42740 was to add the following advanced tuning parameters:

isam_cluster.db2.aes_encrypt = true
runtime_profile.db2.aes_encrypt = true

This fix does not appear to have been documented. May I open an APAR to have these parameters documented?",,David Hayes,khansen,Nick Lloyd,Sten Drescher,tonyferg,,,,,,,,,,,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5bac25a37de8532e315430c5,5ac57757d9a96536d1f0daa9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IJ42740,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS011835329,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Sten Drescher,5bac25a37de8532e315430c5,,,,ROYAL BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=3, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":3,""lastUpdated"":""2023-02-24T10:16:09.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":3,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,No,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0|i17mtr:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,2,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-01-17 20:32:12.074,,,,,"14/Jan/23 8:53 AM;5bac25a37de8532e315430c5;The issue from [https://cloudidentity.atlassian.net/browse/ISAMSUP-4289|https://cloudidentity.atlassian.net/browse/ISAMSUP-4289|smart-link] exists in the client environment after applying ISVA 10.0.5.0, and the advanced tuning parameters do not resolve the issue. Can we address this in this Jira, rather than documenting the (intended) fix for IJ42740? The support file at [https://ecurep.mainz.de.ibm.com/ae5/#id=TS011835329&path=TS011835329%2F2023-01-13%2Fisva_10.0.5.0_20230113-172248_bbxsywmt05.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011835329&path=TS011835329%2F2023-01-13%2Fisva_10.0.5.0_20230113-172248_bbxsywmt05.support_unpack%2F] has the error in tmp/liberty_runtime_dump.zip_unpack/logs/messages.log after the parameters were added.","18/Jan/23 6:32 AM;5b15d94b6256d01ad54eb020;It’s not documented because the vast majority of users won’t need it.  

The reason it didn’t work is that their  server.xml file is missing the parameters that are created by the new tunings.

<properties.db2.jcc progressiveStreaming=""2"" sslConnection=""false"" password=""*****""/>

It should look more like:

<properties.db2.jcc securityMechanism=""9"" encryptionAlgorithm=""2"" progressiveStreaming=""2"" user=""dbadmin"" password=""*****""/>

securityMechanism=""9"" encryptionAlgorithm=""2""   are added by using those tuning parameters.   I tested just now on 10.0.5 and they did get added.  But I added the tuning parameters first. Then added a connection.   Did they restart the runtime  after adding the parameters?    Did they try to reboot the appliance?  I know that may not be doable.    

I thought restarting the runtime would cause the update to server.xml.   I’m sure  the reboot  would do it. The purpose of the tuning parameters was so that those settings would survive a reboot.  Otherwise the  fixpacks I gave them would have been enough.  If needed I can build another fix pack for 10.0.5 to add those settings to the server.xml file.  Then a reboot wouldn’t be needed.  ","19/Jan/23 7:25 AM;5bac25a37de8532e315430c5;iswga/ls.txt shows that /etc/settings.txt was modified at 17:21 on January 13. It also shows that the server.xml files in /opt/ibm/wlp/usr/servers/default and /opt/ibm/wlp/usr/servers/runtime were modified at the same time. Performing a diff of tmp/liberty_dump.zip_unpack/server.xml and tmp/liberty_dump.zip_unpack/server.xml.bak shows that the DB2 JDBC Lib Definition section was deleted and readded with an additional “<mimeTypes><type>js=application/javascript</type></mimeTypes>” line.

I’ll ask the client if they can reboot the appliance.",21/Jan/23 12:10 AM;5bac25a37de8532e315430c5;[~accountid:5b15d94b6256d01ad54eb020] The client rebooted the appliance at Jan 19 18:26:13. The server.xml files still do not have the required parameters. The latest support file is at [https://ecurep.mainz.de.ibm.com/ae5/#id=TS011835329&path=TS011835329%2F2023-01-19%2Fisva_10.0.5.0_20230119-183422_bbxsywmt05.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011835329&path=TS011835329%2F2023-01-19%2Fisva_10.0.5.0_20230119-183422_bbxsywmt05.support_unpack%2F] .,"21/Jan/23 7:22 AM;5b15d94b6256d01ad54eb020;This is strange.  I rebooted  my  isva 10.0.5.0  and the options were still in my  server.xml  file.  The  customers  mesa_config   file size and date match mine.

I ran some tests and reviewed the code,  it will work if you use:
isam_cluster.isam_cluster.db2.aes_encrypt = true

So the naming isn’t quite right but this will work for now.",28/Jan/23 8:11 AM;5bac25a37de8532e315430c5;[~accountid:5b15d94b6256d01ad54eb020] Should I open an APAR to correct this?,28/Jan/23 8:18 AM;5b15d94b6256d01ad54eb020; I originally wasn’t wanting an APAR   because I wasn’t planning to document this because this customer is the only one using it but I’d fix it with or without an APAR.   Since we hit this issue it would probably help them to know when it was fixed. So go ahead and create one.,28/Jan/23 8:19 AM;5b15d94b6256d01ad54eb020;BTW did they try option with the double  “isam_cluster”  name?,"31/Jan/23 7:43 AM;5bac25a37de8532e315430c5;They have tried it, and it is not working. From [https://ecurep.mainz.de.ibm.com/ae5/#id=TS011835329&path=TS011835329%2F2023-01-27%2Fisva_10.0.5.0_20230127-174557_bbxsywmt05.support_unpack%2F|https://ecurep.mainz.de.ibm.com/ae5/#id=TS011835329&path=TS011835329%2F2023-01-27%2Fisva_10.0.5.0_20230127-174557_bbxsywmt05.support_unpack%2F]

----


[stendres@debug71]:isva_10.0.5.0_20230127-174557_bbxsywmt05.support_unpack $ grep db2.aes_encrypt etc/settings.txt

isam_cluster.db2.aes_encrypt = true

runtime_profile.db2.aes_encrypt = true

isam_cluster.isam_cluster.db2.aes_encrypt = true

[stendres@debug71]:isva_10.0.5.0_20230127-174557_bbxsywmt05.support_unpack $ 

----


Am I having them set it in the wrong place? Can you be available for a meeting with them tomorrow?","31/Jan/23 8:07 AM;5b15d94b6256d01ad54eb020;Theirs looks like mine.  From my   10.0.5.0 settings.txt file :

isam_cluster.db2.aes_encrypt  = true
runtime_profile.db2.aes_encrypt = true
isam_cluster.isam_cluster.db2.aes_encrypt = true

Did they restart the  runtime?   (I thought it would do that for you when you deploy. )","31/Jan/23 8:31 AM;5b15d94b6256d01ad54eb020;Also  to edit the  xml,   the original    updt_server_xml_jdbc_v1  fix pack can be used. Then they can restart the runtime.   The tuning parameters were meant so those settings would  survive a reboot.","01/Feb/23 4:20 AM;5bac25a37de8532e315430c5;The runtime was restarted at 17:44 on January 27.

----

[stendres@debug71]:isva_10.0.5.0_20230127-174557_bbxsywmt05.support_unpack $ grep CWWKE0001I tmp/liberty_runtime_dump.zip_unpack/logs/messages*

tmp/liberty_runtime_dump.zip_unpack/logs/messages.log:[1/27/23, 17:44:17:635 EST] 00000001 com.ibm.ws.kernel.launch.internal.FrameworkManager           A CWWKE0001I: The server runtime has been launched.

[stendres@debug71]:isva_10.0.5.0_20230127-174557_bbxsywmt05.support_unpack $ 

----

Do you need additional diagnostic data to determine why the ATP are not working?","01/Feb/23 4:29 AM;5b15d94b6256d01ad54eb020;No I don’t need anything more since I see the same thing.  

Again, the original fix pack I mentioned doesn’t replace mesa_config and only edits the xml file.   That will get them working for now.","01/Feb/23 7:01 AM;5bac25a37de8532e315430c5;[~accountid:5b15d94b6256d01ad54eb020] I’m being told that this is a critical issue for RBC, and are looking at escalating this.","01/Feb/23 7:05 AM;5b15d94b6256d01ad54eb020;Tell them this will not take weeks.  Since I can recreate the problem,  I can debug it but it will take a few days.

Quick update:   I spent a lot of time yesterday  looking into this and didn’t see it.  I took another look today and I think I see the problem.   Because I have several high priority items at once this week it will take me a few days to confirm it.",01/Feb/23 11:23 AM;5bac25a37de8532e315430c5;updt_server_xml_jdbc_1040_v3.fixpack will not apply to ISVA 10.0.5.0. Is there a release-independent version?,01/Feb/23 10:54 PM;5b15d94b6256d01ad54eb020; It’s not version dependent but they changed the signing in 10.05 so I need to build a new one.,"01/Feb/23 11:36 PM;5b15d94b6256d01ad54eb020;The code change I made to mesa_config  worked. So I just need to build a fix pack to install it.  

I revised  my last comment:

updt_server_xml_jdbc_1040_v3.fixpack  is version specific so I’m glad that didn’t install,  that would have caused problems.  The one I said to use was updt_server_xml_jdbc_v1  because it does not install mesa_config and only edits the xml file.  I need to rebuild it for 10.0.5 because of the signing anyway.","02/Feb/23 12:28 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a37de8532e315430c5]  I added two 10.0.5.0  fix packs to   [https://cloudidentity.atlassian.net/browse/ISAMSUP-4761|https://cloudidentity.atlassian.net/browse/ISAMSUP-4761|smart-link]   

I built and tested  the change to mesa_config  and confirmed that it worked.   I also updated the fix pack that only changes the server.xml in case you want that.

I have another high priority issue I need to work on so L2 needs to test these fix packs before distributing them.   You need a db2 connection defined to confirm that it works.     You don’t need to test  the  other tuning parameter.

the name of the parameter is  definitely    isam_cluster.db2.aes_encrypt  for the config   hvdb  connection.","02/Feb/23 9:53 PM;5ac57757d9a96536d1f0daa9;[~accountid:5bac25a37de8532e315430c5] [~accountid:5b15d94b6256d01ad54eb020] our customer has provided us with the following update in the case - 

+++++

Installed updt_server_xml_bin_1050_v1.fixpack , ""isam_cluster.db2.aes_encrypt = true"" ATP and rebooted the appliance. The DB2 error is not present after reboot.

1). Is there a restriction about this fixpack that it has to be the last one installed? 

2). If we need to install another fixpack, do we need first to rollback updt_server_xml_bin_1050_v1.fixpack, apply the new fixpack and then updt_server_xml_bin_1050_v1.fixpack again? That was the case with updt_server_xml_jdbc_1040_v3.fixpack in 10.0.4.

+++++

From this I believe that the fixes has resolved the identified issue but he has a couple of questions that he needs answers for. 

If we can please have these updated first thing your morning it would be appreciated as I have a call with the customer at 09:00 EST. 

Appreciate the support to move our customer forwards. ",07/Feb/23 12:18 AM;5b15d94b6256d01ad54eb020;updt_server_xml_bin_1050_v1.fixpack  replaces the mesa_config binary.  The only restriction is that if you have another  problem that requires a fixpack that also replaces mesa_config  we need to be sure to include this fix.   The earlier versions of  the fix pack were mainly scripting so I think that something to do with the ordering.  ,"24/Feb/23 7:36 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e2d9de38dff81e5866925a37a45187ef1e8ccb8b
   * description: Update config_isam_cluster.cpp

Relocated  check for tuning parameter so it would be properly parsed.  APAR IJ42740 ISAMSUP-4712

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85416920.


This build has not been published as the commit is not currently within a branch (ISAMSUP-4712) which we publish.","24/Feb/23 10:16 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e7f8a0156b2a159d19c24eff995168743b6f056f
   * description: Merge pull request #5710 from ISAM/ISAMSUP-4712

Update config_isam_cluster.cpp

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85427412.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230224001317-e7f8a015.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","24/Feb/23 11:33 AM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: e7f8a0156b2a159d19c24eff995168743b6f056f
   * description: Merge pull request #5710 from ISAM/ISAMSUP-4712

Update config_isam_cluster.cpp

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/85431027.


This build has not been published as the commit is not currently within a branch (20230224001317-e7f8a015) which we publish.",16/Mar/23 1:06 AM;5b15d94b6256d01ad54eb020;[~accountid:5bac25a37de8532e315430c5]   can this be closed?,22/Mar/23 6:19 AM;5b15d94b6256d01ad54eb020;Case closed. Closing Jira.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
pdmgrd will not start on the Primary Master of the cluster,ISAMSUP-5146,307285,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 1,Done,Bhavan Kasivajjula,5b15d954b0d76456f36daf33,Charles David Hooks,5b15d9936d76184b7d989c82,Charles David Hooks,5b15d9936d76184b7d989c82,18/Jun/23 1:28 PM,21/Jun/23 8:43 AM,14/Jul/23 2:47 PM,21/Jun/23 8:43 AM,,,17/Jun/23 12:00 AM,0,,,,"SF Case: TS013328395

Env: ISVA 10.0.3.1 (data points at a historical mix with 10.0.5)

Problem:

----

customer opened the case late on June 14th US time… Adarsh worked with the customer towards recovery, and the case was closed on the 15th…  the customer re-opened late afternoon today, US time…  the pdmgrd process on the primary master fails to start… there are core dumps for the process, but the pdmgrd msg log shows the problem:

2023-06-17-18:53:11.553-04:00I----- 0x1005B1C5 pdmgrd ERROR acl acldb daMgmtDomain.cpp 1157 0x7f6285aaab80

HPDAC0453E Authorization policy database version is incompatible with the server version (4101,4099) and will be automatically replaced.

2023-06-17-18:53:11.554-04:00I----- 0x14C010A4 pdmgrd FATAL mgr general ivmgrd.cpp 264 0x7f6285aaab80

HPDMG0164E The Policy Server could not be started (0x1005b1c5).

Nick has been working with me this evening on the issue… eval recently rendered to the customer was as follows:



# Based on the support files we see a 3 node cluster with [a2avpisam01.bankhq.exim.gov|https://a2avpisam01.bankhq.exim.gov/] showing as the Primary... members are 10.77.13.177, [a2avpisam01.bankhq.exim.gov|https://a2avpisam01.bankhq.exim.gov/], and [a2avzisam02.bankhq.exim.gov|https://a2avzisam02.bankhq.exim.gov/]
# The content of support file for [a2avpisam02.bankhq.exim.gov|https://a2avpisam02.bankhq.exim.gov/] agrees with the above as well.
# 10.77.13.177 is down.
# At some point  [*a2avpisam01.bankhq.exim.gov*|http://a2avpisam01.bankhq.exim.gov/] received a 1050 master_authzn.db while being a node in a 1050 cluster.
# Now while trying to start pdmgrd on the Primary while at 1031, it cannot use a 1050 master_authzb.db file (causing pdmgrd to crash).
# You'll need to recover with appliance snapshots or VM snapshots.



customer provided the further info from earlier this evening:

[*a2avpisam01.bankhq.exim.gov*|https://a2avpisam01.bankhq.exim.gov/] is supposed to be the current primary master -Yes

*10.77.13.177* - Completely down which we cannot bring back.

[*a2avzisam02.bankhq.exim.gov*|https://a2avzisam02.bankhq.exim.gov/] *- Tertiary node where we hosted Webseals in DMZ.*



support file from the primary master:

/ecurep/sf/TS013/328/TS013328395/2023-06-18/isva_10.0.3.1_20230617-212243_a2avpisam01.bankhq.exim.gov.support_unpack/

pdmgrd msg log from that host:

/ecurep/sf/TS013/328/TS013328395/2023-06-18/isva_10.0.3.1_20230617-212243_a2avpisam01.bankhq.exim.gov.support_unpack/

support file from secondary master:

/ecurep/sf/TS013/328/TS013328395/2023-06-18/isva_10.0.3.1_20230617-223545_a2avzisam02.bankhq.exim.gov.support_unpack/",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013328395,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Charles David Hooks,5b15d9936d76184b7d989c82,,,,EXPORT IMPORT BANK,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,{},,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"/ecurep/sf/TS013/328/TS013328395/2023-06-18/isva_10.0.3.1_20230617-212243_a2avpisam01.bankhq.exim.gov.support_unpack/

pdmgrd msg log from that host:

/ecurep/sf/TS013/328/TS013328395/2023-06-18/isva_10.0.3.1_20230617-212243_a2avpisam01.bankhq.exim.gov.support_unpack/

support file from secondary master:

/ecurep/sf/TS013/328/TS013328395/2023-06-18/isva_10.0.3.1_20230617-223545_a2avzisam02.bankhq.exim.gov.support_unpack/",,,,,,,,,,,,,,,,,,,,,,,0|i1ct7z:,,,,,,,,,,,,L2,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.3.1,,,,,,,,,,,,,2023-06-19 08:13:21.649,,,,,"19/Jun/23 6:13 PM;5b15d954b0d76456f36daf33;Based on the last few updates in the case, the focus is now on upgrading all nodes to 10.0.5.0 version. Let us know if the original issue is still a problem after the upgrade.","20/Jun/23 3:08 AM;5b15d9936d76184b7d989c82;Bhavan, I meant to update this Jira further… and should have set the response back to L2… we broke off efforts at midnight US time Saturday, then started back in on Sunday evening, and Adarsh found the last piece of the puzzle for the follow-on upgrade issue (it looks like it was due to the name string of the fixpack file having been changed after local download to include special characters in the string name)… prior to that, the pdmgrd runtime process was not coming up on the secondary master (with the primary down) due to having a 10.0.5 authzn db on a 10.0.3.1 system… the primary master was brought back online late Saturday, and we confirmed that the pdmgrd process would start on that system (since it was running at 10.0.5, which matched the authzn db version)… we are still working with the customer on other issues for the same env today, but should be OK on this specific issue for now… we will request confirmation from the customer… ",21/Jun/23 8:43 AM;5b15d954b0d76456f36daf33;Looks like the policy server not starting issue is resolved but there are still others to resolve.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
Failover cookies stops populating groups when the source cred is an external user. ,ISAMSUP-5117,304638,Support,Done,ISAMSUP,ISAM Support,software,tonyferg,5ac57757d9a96536d1f0daa9,,,Sev 1,Done,Asha Shivalingaiah,5af4ad7d4dd24c579110120b,Brandon Garay,60e721f12d49fd00698bb49d,Brandon Garay,60e721f12d49fd00698bb49d,03/Jun/23 5:51 AM,04/Jul/23 9:15 AM,14/Jul/23 2:38 PM,04/Jul/23 9:15 AM,10.0.7,Support,02/Jun/23 12:00 AM,0,escalated,,,"The customer has a flow where a SAML assertion is processed, passed to AAC rule that passes back extuser and extgroup headers.   The flow then uses a failover cookie to another WebSEAL.    In 10.0.3.1 the failover cookie was consumed in such a way that the groups would be populated into the resulting credential.   Due to the changes in [https://cloudidentity.atlassian.net/browse/ISAMDEV-6791|https://cloudidentity.atlassian.net/browse/ISAMDEV-6791|smart-link] this failover SSO flow has stopped working as the customer expects.



ISAMDEV-6791 does more than just add OIDC support, it also changed how an external user is handled for both the generation and consumption of the failover cookie.   A noticeable change from  ivauthn_authenticate to ivauthn_authenticate4 but always passes either an empty non-NULL string or a NULL for the last extUserGroups parameter.

ivauthn_authenticate4 passes the extgroups param to azn_id_get_creds_i_ which calls azn_id_get_creds__ which documents:

{noformat}@param extUserGroups If NULL on input, idicates that this is for a normal 
         ISAM user. If non-NULL, indicates that this is for an external 
         user.  When non-NULL, the contents of the string is the comma 
         separated list of ISAM groups the external user should be a 
         member of in the output creds.{noformat}

 The change in ISAMDEV-67691 breaks the previous behavior where if the failover cookie had an external user the (ext) groups would get populated into the credential.    

 It is unclear to me why the code was written to pass in an empty string rather than generating a comma separated list of the groups from AZN_CRED_GROUPS since this was known and set for an external user.    Unless a failover cookie doesn't send the groups?   

This is breaking issue for the customer as what they had working in 10.0.3.1 with AAC returning an external user and groups value that generates a credential [https://ecurep.mainz.de.ibm.com/ae5/#id=TS013194902&path=TS013194902%2F2023-06-02%2F&filepath=TS013194902%2F2023-06-02%2FSAML_WebSEAL_Conf_1031.txt|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013194902&path=TS013194902%2F2023-06-02%2F&filepath=TS013194902%2F2023-06-02%2FSAML_WebSEAL_Conf_1031.txt] which then uses failover cookies to SSO to another WebSEAL where they are expecting the credential to be built with the groups.  

After the SSO they are calling an OIDC flow that has an access_policy that expects to see groups.

 They used below snippet to get groups from context.

{noformat}    var user = context.getUser();
    var groupIterator = user.getGroups().iterator();
    var groupIterator_failover = getUserGroups(""att_usergroups"");
    IDMappingExtUtils.traceString("" context ---""+context);   // returns object
    IDMappingExtUtils.traceString("" user ---""+user.getUsername());  // returns sub
    IDMappingExtUtils.traceString("" groups ---""+user.getGroups());    // return [] - but user belongs some groups. {noformat}

The issue appears to be that the prior to the change the failover info did not have separate processing for an external user flag. This flag is set in the generator of the failover cookie which is what the customer calls the SAML stack.

So it worked when 

SAML STACK -- 10.0.3.1
OIDC STACK -- 10.0.3.1

and 

SAML STACK -- 10.0.3.1
OIDC STACK -- 10.0.5.0



But fails when 

SAML STACK -- 10.0.5.0
OIDC STACK -- 10.0.5.0



If they change the Point of contact (POC) to Access Manager Username and extended attributes, then the flow starts to work without any issues.  (due to it no longer being flagged as an external user)



Differences between both the POCs are listed below.



*Pre-pend PartnerID Macro + Non-Access Manager Username Access Manager groups and extended attributes*

[fim.user.response.header.name|https://fim.user.response.header.name/] : am-eai-ext-user-id

[fim.groups.response.header.name|https://fim.groups.response.header.name/] : am-eai-ext-user-groups

authentication.macros : %PARTNERID%,%FEDID%



*Access Manager Username and extended attributes*

[fim.user.response.header.name|https://fim.user.response.header.name/] : am-eai-user-id



L2 reviewed the data and traces:

From SAML trace.log

{noformat}[6/2/23, 10:29:06:539 EDT] 000001d8 id=00000000 com.tivoli.am.fim.fedmgr2.msg.BrowserResponseImpl            3 logResponse Header[am-eai-ext-user-id] value[0] = 1234567890
[6/2/23, 10:29:06:539 EDT] 000001d8 id=00000000 com.tivoli.am.fim.fedmgr2.msg.BrowserResponseImpl            3 logResponse Header[att_mobile] has 1 values
[6/2/23, 10:29:06:539 EDT] 000001d8 id=00000000 com.tivoli.am.fim.fedmgr2.msg.BrowserResponseImpl            3 logResponse Header[att_mobile] value[0] = 1234567899
[6/2/23, 10:29:06:539 EDT] 000001d8 id=00000000 com.tivoli.am.fim.fedmgr2.msg.BrowserResponseImpl            3 logResponse Header[am-eai-xattrs] has 1 values
[6/2/23, 10:29:06:539 EDT] 000001d8 id=00000000 com.tivoli.am.fim.fedmgr2.msg.BrowserResponseImpl            3 logResponse Header[am-eai-xattrs] value[0] = att_guid,att_hSessID,att_sn,att_mfa_required,att_fed_id,att_SFDeviceList,att_uid,att_lastLogin,att_idpuserid,att_acr,att_mail,authenticationTypes,att_usergroups,att_remember_me,authenticationMechanismTypes,att_amr,att_orgid,att_cn,att_bioOptIn,att_idpattrs,att_mobile,att_FnetCJIS,att_auth_time
[6/2/23, 10:29:06:539 EDT] 000001d8 id=00000000 com.tivoli.am.fim.fedmgr2.msg.BrowserResponseImpl            3 logResponse Header[att_guid] has 1 values
[6/2/23, 10:29:06:539 EDT] 000001d8 id=00000000 com.tivoli.am.fim.fedmgr2.msg.BrowserResponseImpl            3 logResponse Header[att_guid] value[0] = 1234567890
[6/2/23, 10:29:06:539 EDT] 000001d8 id=00000000 com.tivoli.am.fim.fedmgr2.msg.BrowserResponseImpl            3 logResponse Header[am-eai-ext-user-groups] has 1 values
[6/2/23, 10:29:06:539 EDT] 000001d8 id=00000000 com.tivoli.am.fim.fedmgr2.msg.BrowserResponseImpl            3 logResponse Header[am-eai-ext-user-groups] value[0] = G_FN,G_FN_ADM,G_FN_CJ{noformat}

Then in the OIDC trace.log we see

{noformat}[6/2/23, 10:29:06:680 EDT] 000001c8 id=00000000 com.tivoli.am.fim.fedmgr2.servlet.SSOPSServletBase           3 logRequest Header[name=iv-groups,value=[]
[6/2/23, 10:29:06:680 EDT] 000001c8 id=00000000 com.tivoli.am.fim.fedmgr2.servlet.SSOPSServletBase           3 logRequest Header[name=iv-remote-address,value=[135.28.27.59]
[6/2/23, 10:29:06:680 EDT] 000001c8 id=00000000 com.tivoli.am.fim.fedmgr2.servlet.SSOPSServletBase           3 logRequest Header[name=iv-user,value=[1234567890]{noformat}

Which means that the Federation server appears to be sending the header back, but something is getting lost in the WebSEAL credential to failover cookie generation/consume portion..

Credential Info using the Credential Viewer Application on the SAML stack seems to be good.
[https://ecurep.mainz.de.ibm.com/ae5/#id=TS013194902&path=TS013194902%2F2023-06-02%2F&filepath=TS013194902%2F2023-06-02%2FSAML_WebSEAL_Conf_1031.txt|https://ecurep.mainz.de.ibm.com/ae5/#id=TS013194902&path=TS013194902%2F2023-06-02%2F&filepath=TS013194902%2F2023-06-02%2FSAML_WebSEAL_Conf_1031.txt] 



They use failover cookie PD-ID-FN-TEST to retrieve the session on OIDC OP



Talking with Nick and Annelise , this might be an issue with the failover cookie.

Considering [ISAMDEV-6791|https://cloudidentity.atlassian.net/browse/ISAMDEV-6791], which is related to external users and failover-cookies, it seems that the change in how they were processed might have affected the way groups were handled. This explanation also clarifies why setting the POC to return it as a normal non-external user resolves the issue.

It seems like the change from ivauthn_authenticate to ivauthn_authenticate4 is the culprit, the last arg is the ext groups and in that change they are just passing in either an empty string or a null. We believe that should be pulling the the ext groups not just a empty value.

This is holding up their deployment , so it’s currently a Severity 1.",,Bhavan Kasivajjula,Brandon Garay,David Hayes,khansen,Nick Lloyd,tonyferg,Tushar Prasad,,,,,,,,,5b15d954b0d76456f36daf33,60e721f12d49fd00698bb49d,5b232b2fd85e5b59b066f57f,5b15d901fa615349cb01778b,5b15d9e6dda5f94d06b985b4,5ac57757d9a96536d1f0daa9,5c53d3ac23f5bf672621c868,,,,,,,,,,,,,,,,,,,,,ISAMSUP-5119,,,,,,,,,,,,,,,,,,,,,IJ47436,,,,,,,,,,,SRE,,,,,,,,,,,,,,,,,,,,TS013194902,,,,TFIM,,,,,,"Choose/update:
---------------
- No major impact. In-flight transactions will fail.
- No impact.
- Training for Ops is required
- Documentation update required
- Failover required
- Other:
",,,,,,0.0,,,,,,,,,,,,,Brandon Garay,60e721f12d49fd00698bb49d,,,,A T & T SERVICES INC,,,,,,,,,,,,,Farzana Sedillo,557058:0f06124f-7f85-4590-8904-718c7b5dd63a,,,"{repository={count=4, dataType=repository}, json={""cachedValue"":{""errors"":[],""summary"":{""repository"":{""overall"":{""count"":4,""lastUpdated"":""2023-06-21T14:40:03.000+1000"",""dataType"":""repository""},""byInstanceType"":{""githube"":{""count"":4,""name"":""GitHub Enterprise""}}}}},""isStale"":true}}",,,Under Review,,,,,,Non-Production,,,,,,,,,,,N/A,,,,,,,,,,,,,,,,,,,,,,,"Windows Path: S:\ecurep\sf\TS013\194\TS013194902\2023-06-02\

Citrix Path: S:\sf\TS013\194\TS013194902\2023-06-02\",,,,,,,,,,,,,,,,,,,,,,,0|i1cd1j:,,,,,,,,,,,,L3,,,Medium,,,,,,,,,,,,"h3. Appscan

|| Severity || Number||
| High | |
| Medium | |
| Low | |

h3. Twistlock

h4. (a) Fixed Issues


h4. (b) Outstanding Issues",,,,,,1,,Customer,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,ISVA 10.0.5.0,,,,,,,,,,,,,2023-06-04 22:08:07.473,,,,,03/Jun/23 7:35 AM;60e721f12d49fd00698bb49d;FYI. Customer is hoping a quick resolution for this by mid of next week. This is a Sev1 as it’s delaying their upgrade of Production deployment timelines.,"05/Jun/23 8:08 AM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b] assigning this one to you to complete the initial assessment of the customers issue. Please note that this has been raised as a Sev1 as this is a potential blocker for our customers PROD deployment. The customer has asked for us to try and have a resolution for this by mid-week so we need to make this our top priority. Please let me know if you need any support during your assessment of this item. 

[~accountid:5b232b2fd85e5b59b066f57f] [~accountid:5b15d954b0d76456f36daf33] as there is escalated lets all get in and help Asha to resolve this in the coming days. ","05/Jun/23 1:23 PM;5af4ad7d4dd24c579110120b;<Notes>

{noformat}To check - 

 azn_creds.cpp 
 isExternalUser = true;
rc = ivBuildPrincipalForExtUser(local_domain,authzn_id,
                                                    extUserGroups,&prin,
                                                    &user_dn,registryIDs);

 azncommon.cpp 
rc = ivBuildPrincipalForExtUser(local_domain,authzn_id,
                                                    extUserGroups,&prin,
                                                    &user_dn,registryIDs);


azn_id_get_creds__(
                 unsigned int  version, /* in */ // CMVC 52255
     

rc = azn_id_get_creds_i_(domain,
                              (azn_string_t) mech_id,
                              (azn_buffer_t) &buf,
                              creds, extUserGroups);

ivauthn_authenticate4(authn_method, authn_info, creds, username, rc, &creds_rc,
 2207                            extUserGroups);

 pdweb_authenticate2((char*)IVAUTHN_METH_EAI, &authn_info, &creds, NULL, 
 1317                          status, lgroups);

nvlist_lookup(eai_auth_data, (char*)EAI_EXT_USER_GROUPS, &lgroups);
{noformat}

{noformat}On IDP - iv groups doesnt get updated for SP

2023-06-05-12:31:15.851+10:00I----- thread(20) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- PD ===> BackEnd -----------------
Thread 20; fd 258; local 127.0.0.1:29058; remote 127.0.0.1:443
POST /sps/oauth/oauth20/authorize HTTP/1.1
accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
accept-language: en-US,en;q=0.5
connection: close
content-length: 88
content-type: application/x-www-form-urlencoded
host: localhost
iv-creds: Version=1, BAKs3DCCBiIMADCCBhwwggYYAgIQAzBgMCowHgIEOA0H6AICAzICAhHuAgIAlgICAIoEBvoWPoDCfgwIdGVzdHVzZXIwMjAwMB0CBFe9cpACAgMxAgIR7gICAIICARYEBvoWPoDCfgwPd2Vic2VhbC1zZXJ2ZXJzAgEBMIIFqzCCBacwIgwUQVVUSEVOVElDQVRJT05fTEVWRUwwCjAIAgEEDAExBAAwMQwXQVpOX0NSRURfQVVUSE5NRUNIX0lORk8wFjAUAgEEDA1MREFQIFJlZ2lzdHJ5BAAwMwwSQVpOX0NSRURfQVVUSFpOX0lEMB0wGwIBBAwUY249dGVzdHVzZXIsZGM9aXN3Z2EEADAvDBhBWk5fQ1JFRF9BVVRIX0VQT0NIX1RJTUUwEzARAgEEDAoxNjg1OTMyMjcyBAAwKQwUQVpOX0NSRURfQVVUSF9NRVRIT0QwETAPAgEEDAhwYXNzd29yZAQAMHYMFUFaTl9DUkVEX0JST1dTRVJfSU5GTzBdMFsCAQQMVE1vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwLjE1OyBydjoxMDkuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMTMuMAQAMCsMD0FaTl9DUkVEX0dST1VQUzAYMBYCAQQMD3dlYnNlYWwtc2VydmVycwQAMGEMG0FaTl9DUkVEX0dST1VQX1JFR0lTVFJZX0lEUzBCMEACAQQMOWNuPXdlYnNlYWwtc2VydmVycyxjbj1TZWN1cml0eUdyb3VwcyxzZWNBdXRob3JpdHk9RGVmYXVsdAQAMEUMFEFaTl9DUkVEX0dST1VQX1VVSURTMC0wKwIBBAwkNTdiZDcyOTAtMDMzMS0xMWVlLTgyMTYtZmExNjNlODBjMjdlBAAwJgwSQVpOX0NSRURfSVBfRkFNSUxZMBAwDgIBBAwHQUZfSU5FVAQAMCkMEEFaTl9DUkVEX01FQ0hfSUQwFTATAgEEDAxJVl9MREFQX1YzLjAEADAzDBxBWk5fQ1JFRF9ORVRXT1JLX0FERFJFU1NfQklOMBMwEQIBBAwKMHgwYWE2MDEwNgQAMDMMHEFaTl9DUkVEX05FVFdPUktfQUREUkVTU19TVFIwEzARAgEEDAoxMC4xNjYuMS42BAAwLQwZQVpOX0NSRURfUFJJTkNJUEFMX0RPTUFJTjAQMA4CAQQMB0RlZmF1bHQEADAsDBdBWk5fQ1JFRF9QUklOQ0lQQUxfTkFNRTARMA8CAQQMCHRlc3R1c2VyBAAwSAwXQVpOX0NSRURfUFJJTkNJUEFMX1VVSUQwLTArAgEEDCQzODBkMDdlOC0wMzMyLTExZWUtOTY4YS1mYTE2M2U4MGMyN2UEADAtDBFBWk5fQ1JFRF9RT1BfSU5GTzAYMBYCAQQMD1NTSzogVExTVjEyOiAyRgQAMDUMFEFaTl9DUkVEX1JFR0lTVFJZX0lEMB0wGwIBBAwUY249dGVzdHVzZXIsZGM9aXN3Z2EEADAfDBJBWk5fQ1JFRF9VU0VSX0lORk8wCTAHAgEEDAAEADAnDBBBWk5fQ1JFRF9WRVJTSU9OMBMwEQIBBAwKMHgwMDAwMTAwMwQAMC0MGHRhZ3ZhbHVlX2xvZ2luX3VzZXJfbmFtZTARMA8CAQQMCHRlc3R1c2VyBAAwNgwkdGFndmFsdWVfbWF4X2NvbmN1cnJlbnRfd2ViX3Nlc3Npb25zMA4wDAIBBAwFdW5zZXQEADBHDBZ0YWd2YWx1ZV9zZXNzaW9uX2luZGV4MC0wKwIBBAwkMDY3OTExZTItMDM0OS0xMWVlLTk0MjItZmExNjNlODBjMjdlBAAwgakMGHRhZ3ZhbHVlX3VzZXJfc2Vzc2lvbl9pZDCBjDCBiQIBBAyBgWJHOWpZV3hvYjNOMExXUmxabUYxYkhRQV9aSDFJOEFBQUFBSUFBQUF3OEVoOVpQaTdGRnhYZndBQU4xTlFSamRLVkZSRVdsUnVSV2RrY1ZwMU4zaE1iMkkwU0VsMGFHaFVkRlJ5YnpaTVpHcG5NemhIWWxveVVIcHE6ZGVmYXVsdAQA
iv-groups: ""webseal-servers""
iv-remote-address: 10.166.1.6
iv-user: testuser
referer: https://www.myidp.ibm.com/oidc/sps/auth
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/113.0
via: HTTP/1.1 www.myidp.ibm.com:443
origin: https://www.myidp.ibm.com
user_session_id: bG9jYWxob3N0LWRlZmF1bHQA_ZH1I8AAAAAIAAAAw8Eh9ZPi7FFxXfwAAN1NQRjdKVFREWlRuRWdkcVp1N3hMb2I0SEl0aGhUdFRybzZMZGpnMzhHYloyUHpq:default
upgrade-insecure-requests: 1
sec-fetch-site: same-origin
iv_server_name: default-webseald-localhost
sec-fetch-dest: document
dnt: 1
sec-fetch-user: ?1
sec-fetch-mode: navigate
Cookie: JSESSIONID=0000txv4vxaPYVDOw5F-81ZvZyJ:0dfdce7d-2b52-4160-b108-150282324883; PD-S-SESSION-ID=1_2_1_7SPF7JTTDZTnEgdqZu7xLob4HIthhTtTro6Ldjg38GbZ2Pzj; PD-ID-FN-STAGE=PD-ID=r9PdXbIV+3BwOVOopE2HgXVq4Y9wEG55AI1i60wwzBVw0atU7wYxyDIytHPtNadjULUJYleXPfrjn1Nhnt9090iC4zMygdtAT4YOWFm6oda1PJ7qI4mxxV4/noMWgMTQUc3TQiK7HFeDaE7FregkKAgZ/ERQyiPdRAKtoMbQl5pV3PdfBipAD9yfdPbSua3mqp1wQgOeys+s28CtbzzmombxgS8QqND8tJjejxCSadhmk4I5EA0jdxxG2XJQPPk/rlo2RbocSmKarmy7OFkRq6RbpDZExLjptHVLfw6CblQ=; IV_JCT=%2Foidc{noformat}

{noformat}On SP - iv groups doesnt get updated for SP

2023-06-05-12:40:02.575+10:00I----- thread(12) trace.pdweb.debug:2 /build/isam/src/i4w/pdweb/webseald/ras/trace/debug_log.cpp:235: ----------------- PD ===> BackEnd -----------------
Thread 12; fd 257; local 127.0.0.1:28746; remote 127.0.0.1:443
POST /sps/ac/43cfb086-48fa-4e0b-be67-1982229b7765 HTTP/1.1
accept: */*
accept-language: en-US,en;q=0.5
connection: close
content-length: 357
content-type: application/json
host: localhost
iv-creds: Version=1, BAKs3DCCA2IMADCCA1wwggNYAgIGIjBIMEQwHgIEiWz7AAICAYgCAhJ4AgIAqQICAMIEBrn4KrMaPwwiaHR0cHM6Ly93d3cubXlpZHAuaWJtLmNvbS90ZXN0dXNlcjAAAgEBMIIDAzCCAv8wRgwXQVpOX0NSRURfUFJJTkNJUEFMX05BTUUwKzApAgEEDCJodHRwczovL3d3dy5teWlkcC5pYm0uY29tL3Rlc3R1c2VyBAAwSAwXQVpOX0NSRURfUFJJTkNJUEFMX1VVSUQwLTArAgEEDCQ4OTZjZmIwMC0wMTg4LTEyNzgtYTljMi1iOWY4MmFiMzFhM2YEADAzDBdBWk5fQ1JFRF9BVVRITk1FQ0hfSU5GTzAYMBYCAQQMD0ZlZGVyYXRlZCB0cnVzdAQAMCYMFEFaTl9DUkVEX0FVVEhfTUVUSE9EMA4wDAIBBAwFdHJ1c3QEADAoDBBBWk5fQ1JFRF9NRUNIX0lEMBQwEgIBBAwLSVRGSU1fdHJ1c3QEADAnDBBBWk5fQ1JFRF9WRVJTSU9OMBMwEQIBBAwKMHgwMDAwMDYyMgQAMDUMFEFaTl9DUkVEX0NSRUFURV9USU1FMB0wGwIBBAwUMjAyMy0wNi0wNVQwMjo0MDowMFoEADAbDApleHBpcmVzX2luMA0wCwIBBAwEMzU5OQQAMCkMDGFjY2Vzc190b2tlbjAZMBcCAQQMEFZsZGJMNUxoejhwblpzc1MEADBHDBh0YWd2YWx1ZV9sb2dpbl91c2VyX25hbWUwKzApAgEEDCJodHRwczovL3d3dy5teWlkcC5pYm0uY29tL3Rlc3R1c2VyBAAwRwwWdGFndmFsdWVfc2Vzc2lvbl9pbmRleDAtMCsCAQQMJDQwNzljZjNlLTAzNGEtMTFlZS1hMjNlLWZhMTYzZTA4Y2VhYQQAMIGpDBh0YWd2YWx1ZV91c2VyX3Nlc3Npb25faWQwgYwwgYkCAQQMgYFiRzlqWVd4b2IzTjBMV1JsWm1GMWJIUUFfWkgxTEFBQUFBQUlBQUFBd0FFdDlaTGg0Qzl5Y2Z3QUFNa1V4WlhWeGIzcFpkM05HZGxKdk1XNVNSVUp6TVhwR2RrRjZWREZCU1ZrM2VuWkpaVEJZT0ZoVVIySnlXRFozOmRlZmF1bHQEAA==
iv-groups: 
iv-user: https://www.myidp.ibm.com/testuser
referer: https://www.mysp.ibm.com/isam/mobile-demo/diag/
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/113.0
via: HTTP/1.1 www.mysp.ibm.com:443
origin: https://www.mysp.ibm.com
user_session_id: bG9jYWxob3N0LWRlZmF1bHQA_ZH1LAAAAAAIAAAAwAEt9ZLh4C9ycfwAAMkUxZXVxb3pZd3NGdlJvMW5SRUJzMXpGdkF6VDFBSVk3enZJZTBYOFhUR2JyWDZ3:default
sec-fetch-site: same-origin
iv_server_name: default-webseald-localhost
sec-fetch-dest: empty
dnt: 1
sec-fetch-mode: cors
Cookie: PD-S-SESSION-ID=1_2_1_2E1euqozYwsFvRo1nREBs1zFvAzT1AIY7zvIe0X8XTGbrX6w; PD_STATEFUL_4e8b6758-0332-11ee-b5d4-fa163e08ceaa=%2Fisam; IV_JCT=%2Fisam; JSESSIONID=00007XLd_mYWgPrGfzZGd4VrVlT:739ef44d-2ada-4b3a-a018-df477ad9419b; ac.uuid=43cfb086-48fa-4e0b-be67-1982229b7765; ac.uuid=43cfb086-48fa-4e0b-be67-1982229b7765{noformat}","05/Jun/23 2:25 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

In the support logs I did not see any RP instances, debug logs or azn logs - Can we get the debug logs from RP? 

pdweb.debug
pdweb.snoop
pdweb.azn 

In addition - 

On 10031 - I have tried the following - 
I have fail-over cookie set 
[https://www.mysp.ibm.com/isam/mobile-demo/|https://www.mysp.ibm.com/isam/mobile-demo/] 
POC set to - Non-Access Manager Username, Access Manager groups and extended attributes 
I have a testuser in some group but the group info does not get populated for iv-user.

<trace in the previous comment>

Have you attempted a recreate? Am I missing any config to recreate the issue? 
","06/Jun/23 4:57 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5af4ad7d4dd24c579110120b] 

I can see pdweb.debug and pdweb.snoop on *isva_10.0.5.0_20230602-120827_zlt13281.enaf.vci.att.com_SAML.support*

Location: S:\sf\TS013\194\TS013194902\2023-06-02\isva_10.0.5.0_20230602-120827_zlt13281.enaf.vci.att.com_SAML.support_unpack\var\pdweb\fnetsp\trace\



I asked them to recreate the scenario while collecting a new set of traces including the pdweb.azn.","06/Jun/23 7:50 AM;60e721f12d49fd00698bb49d;Customer uploaded a new set of traces while recreating the issue around 4:21 PM CST.

I did not see any data being logged under pdweb.azn 

*These can be accesed via ECURep : S:\sf\TS013\194\TS013194902\2023-06-05\*","06/Jun/23 8:48 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

Here is a test fixpack for 10050 that they can try in their environment to see if it makes a difference and send the support logs -

[https://cloudidentity.atlassian.net/browse/ISAMSUP-5119|https://cloudidentity.atlassian.net/browse/ISAMSUP-5119|smart-link] 

Ill review the logs.
Any note on how to recreate the issue, did you have a chance to attempt a recreate? ","07/Jun/23 3:51 AM;60e721f12d49fd00698bb49d;Hi [~accountid:5af4ad7d4dd24c579110120b] .

I have provided the fixpack to customer.  I’ll let you know the outputs.

I haven’t had the chance to recreate the issue tbh with you.",09/Jun/23 1:38 PM;5b232b2fd85e5b59b066f57f;[~accountid:5af4ad7d4dd24c579110120b] - customer has closed case with the comment that your fix-pack resolved the issue. Is there anything further for us to do here or can we close the WI? Do we want / need to APAR this and get into a future release?,"09/Jun/23 1:39 PM;5af4ad7d4dd24c579110120b;[~accountid:5b232b2fd85e5b59b066f57f] 

I need get the APAR in and merge the changes to dev stream.
I’ll close it when I am done with the APAR","09/Jun/23 1:40 PM;5af4ad7d4dd24c579110120b;[~accountid:60e721f12d49fd00698bb49d] 

Could you please log an APAR","09/Jun/23 3:35 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: fde788f5cc5835bd3aefba691454bdc2b4af79eb
   * description: ISAMSUP-5117 Update oidc fail over cookie call

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1160575.


This build has not been published as the commit is not currently within a branch (ISAMSUp-5117) which we publish.",15/Jun/23 10:03 PM;5ac57757d9a96536d1f0daa9;[~accountid:5af4ad7d4dd24c579110120b]the case associated with this Jira item is closed. Is there any work remaining for this? If not can we please look at closing this item out? ,"16/Jun/23 7:15 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:5ac57757d9a96536d1f0daa9] 

* The pull requested associated is still not merged into dev stream, waiting for review and merge.
* It is also waiting on L2 to create APAR , I have pinged Brandon Garay to create an APAR.","21/Jun/23 1:24 PM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

Please create an APAR for this to be tracked.
Thanks","21/Jun/23 2:40 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: db2b59503144212c777e58cd4e6f368c73361ad8
   * description: Merge pull request #5983 from ISAM/ISAMSUp-5117

ISAMSUP-5117 Update oidc fail over cookie call

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1575673.

The GitHub release reference is: 
* https://github.ibm.com/ISAM/isam/releases/tag/20230621043710-db2b5950.

We only keep the most recent 5 builds in GitHub and so if the GitHub reference does not match a current release in GitHub the changes associated with the commit should be available in more recent builds.","21/Jun/23 3:54 PM;5b501b2adc42b22bc590c539;*Build Information* 
A build has been generated for the following commit: 
   * id: db2b59503144212c777e58cd4e6f368c73361ad8
   * description: Merge pull request #5983 from ISAM/ISAMSUp-5117

ISAMSUP-5117 Update oidc fail over cookie call

The travis build reference is: 
* https://travis.ibm.com/ISAM/isam/builds/1576720.


This build has not been published as the commit is not currently within a branch (20230621043710-db2b5950) which we publish.","26/Jun/23 11:39 AM;5af4ad7d4dd24c579110120b;Hi [~accountid:60e721f12d49fd00698bb49d] 

Can you please create an APAR for this to be tracked.","27/Jun/23 7:50 AM;60e721f12d49fd00698bb49d;Hi Asha.

I’ll create an APAR tomorrow. Will provide the APAR number here once I have it.",30/Jun/23 10:51 AM;5ac57757d9a96536d1f0daa9;[~accountid:60e721f12d49fd00698bb49d] did you end up getting the APAR number assigned for this item?,04/Jul/23 3:20 AM;60e721f12d49fd00698bb49d;APAR *IJ47436* has been created.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,Done
